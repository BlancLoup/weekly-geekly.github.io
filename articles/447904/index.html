<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Positive Technologies Experts Revealed Attempts to Mass Exploit Critical Threats to Confluence</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Image: Knownsec 404 Team 

 Information security researchers from Knownsec 404 Team studied the patch for the vulnerability discovered in March in Con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Positive Technologies Experts Revealed Attempts to Mass Exploit Critical Threats to Confluence</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habr.com/ru/company/pt/blog/447904/"><img src="https://habrastorage.org/getpro/habr/post_images/3aa/d10/fd1/3aad10fd101917a19dfc47eaa822b87e.png" alt="image"></a> <br><br>  <i>Image: <a href="https://paper.seebug.org/886/">Knownsec 404 Team</a></i> <br><br>  Information security researchers from Knownsec 404 Team studied the patch for the vulnerability discovered in March in Confluence and <a href="https://paper.seebug.org/886/">published the</a> code for its operation.  Using this security error allows attackers to be able to execute any commands on the Confluence server and download malware. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Shortly after the publication of the exploit to vulnerability, experts PT ESC found a massive attempt to exploit it.  We tell you what the problem is and how to defend yourself. <a name="habracut"></a><br><br><h2>  What is the problem </h2><br>  Vulnerability CVE-2019-3396 arose due to an error in the code for the Widget Connector module in the Confluence Server.  With its help, an attacker can force vulnerable Confluence to download a malicious template from his server and execute any commands.  The attack does not require authorization on the server. <br><br>  In a <a href="https://confluence.atlassian.com/doc/confluence-security-advisory-2019-03-20-966660264.html">security bulletin</a> published by the developers of Confluence from Atlassian, the vulnerability is described as follows: <br><br><blockquote>  An attacker can exploit a vulnerability to inject patterns on the service side, bypass the path and execute code remotely on systems with vulnerable Confluence Server and Data Server. </blockquote><br>  In addition, researchers from Assetnote and DEVCORE discovered a CVE-2019-3395 vulnerability in the WebDAV plugin.  It allows server-side forgery (Server Side Request Forgery, SSRF).  Hackers can send random HTTP and WebDAV requests from vulnerable Confluence Server and Data Server instances. <br><br>  Vulnerable software versions: <br><br><ul><li>  All versions 1.xx, 2.xx, 3.xx, 4.xx and 5.xx </li><li>  All versions 6.0.x, 6.1.x, 6.2.x, 6.3.x, 6.4.x, and 6.5.x </li><li>  All versions 6.6.x to 6.6.12 </li><li>  All versions 6.7.x, 6.8.x, 6.9.x, 6.10.x and 6.11.x </li><li>  All versions 6.12.x to 6.12.3 </li><li>  All versions 6.13.x to 6.13.3 </li><li>  All versions 6.14.x to 6.14.2 </li></ul><br>  Bug fixed: <br><br><ul><li>  In version 6.6.12 and later versions 6.6.x </li><li>  In version 6.12.3 and later versions 6.12.x </li><li>  In version 6.13.3 and later versions 6.13.x </li><li>  In version 6.14.2 and higher. </li></ul><br><br><h2>  Exploitation </h2><br>  Details of the vulnerability were published on April 10, and the next day, experts from Positive Technologies ESC discovered a massive scan of 8090 ports on the Internet - this is the standard port for the Confluence server. <br><br>  It is easy to detect attempted attacks: it will always be accompanied by incoming POST requests to the URL / rest / tinymce / 1 / macro / preview and, in the case of a server hacking, outgoing requests to the attacker's FTP server to download the file with the .vm extension.  According to the ZoomEye search service, at least 60,000 Confluence servers are available on the Internet. <br><br>  In addition, experts have witnessed infection of Confluence servers by the Linux Spike Trojan malware, formerly known as MrBlack.  It is an ELF file and is mainly intended for DDoS attacks. <br><br>  When entering the system, the malware is fixed with the help of the rc.local file and starts each time the infected computer starts.  After launch, in a separate thread and in an infinite loop, it collects information about the system and sends it to the server controlled by the attacking C2.  Data collected includes information about the processor, network interfaces, and running processes.  After that, an endless loop starts in a separate stream, in which it sends the string ‚ÄúVERSONEX: 1 | 1 | 1 | 1 | 1 | Hacker‚Äù to the server, and waits for a command in response. <br><br>  The commands that can run the malware: <br><br><ul><li>  execute the command through the shell </li><li>  start DDOS </li><li>  to finish work </li></ul><br>  The DDOS command contains the AES encrypted addresses of the servers to which the attack should be launched.  The malware decrypts using a stitched key. <br><br>  Available DDOS attack options: <br><br><ul><li>  SYN flood </li><li>  LSYN flood </li><li>  UDP flood </li><li>  UDPS flood </li><li>  TCP flood </li><li>  CC flood </li></ul><br><h2>  How to protect </h2><br>  Vulnerability CVE-2019-3396 was fixed on March 20, 2019.  On the Atlassian website there is a <a href="https://confluence.atlassian.com/doc/confluence-security-advisory-2019-03-20-966660264.html">security bulletin</a> with its description and a list of versions with a fix.  To fix the vulnerability, users need to upgrade the system to the versions included in the patch. <br><br>  Also, to detect attempts to exploit the CVE-2019-3396 vulnerability and Linux Spike activity, we developed rules for Suricata IDS: <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1116726740250955776"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div></div><p>Source: <a href="https://habr.com/ru/post/447904/">https://habr.com/ru/post/447904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447892/index.html">Two new PHDays contests: IDS bypass and factory hacking</a></li>
<li><a href="../447894/index.html">MODX Digest # 3 (March 25 - April 8, 2019)</a></li>
<li><a href="../447896/index.html">Photos from rough sketches: how exactly does the NVIDIA GauGAN neural network work?</a></li>
<li><a href="../447900/index.html">Close contacts of ADL degree</a></li>
<li><a href="../447902/index.html">GitHub has completely ‚Äúdeleted‚Äù the utility repository for circumventing locks and the entire creator account.</a></li>
<li><a href="../447906/index.html">Actual innovation: what to expect from the data center market in 2019?</a></li>
<li><a href="../447908/index.html">Two ways to collect awards for advertising in mobile games, or robots should work</a></li>
<li><a href="../447910/index.html">The "oil" of the modern economy and the war for personnel</a></li>
<li><a href="../447912/index.html">How and why I wrote a parser for the site Tradingview. Automate DIY trade</a></li>
<li><a href="../447914/index.html">5 ways to leave work stress at work</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>