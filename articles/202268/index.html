<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Features reinstall preinstalled Windows 8</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="... or how to create a problem for yourself, and then heroically overcome it. 

 I want to share my experience so that you can avoid my mistakes and s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Features reinstall preinstalled Windows 8</h1><div class="post__text post__text-html js-mediator-article">  <b>... or how to create a problem for yourself, and then heroically overcome it.</b> <br><br>  I want to share my experience so that you can avoid my mistakes and save yourself time, energy, and most importantly - nerves.  A lot of nerves.  They brought me yesterday to service the ultrabook of the latest series, a two-letter company, with the description ‚Äúit terribly slows down, browsers do not work‚Äù.  The initial scan showed infection with a pair of Trojans, the inoperability of none of the four browsers installed by users in the system, the general system <s>littering</s> with utilities from the category ‚Äúput me - <s>increase your</s> computer‚Äôs speed‚Äù and some damage caused by utilities to ‚Äúclean‚Äù the registry set by users in the hope defeat the problems.  After the inspection, I decided (holy naivety) that it would be easier to reinstall the system in a clean way than to heal and restore it all, good, as I thought, due to the recovery partition stored on the hard disk with native software, this will be a matter of minutes.  The following story will show how cruel I was wrong about that. <br><br>  In total, we have an ultrabook with Windows 8, a working recovery partition and the absence of any disks in the package (this moment is important).  Beech as a start-up software has UEFI, which in principle is logical for use with Windows 8, and even it would be convenient if it were not for one thing - the key for installing the system is sewn into the ACPI data table in the MSDM table.  At that time I did not know this yet, and did not think that I would need it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  In general, I reboot it, get into the launch settings (if someone doesn‚Äôt know how to do it on beeches with UEFI fresh episodes - press ESC right from the very beginning of the launch) and turn off the Secure Boot (it is necessary to start the recovery system), native system recovery system.  <b>As it turned out, I turned off Secure Boot and switched the system to Legacy Mode in vain - it was these actions that caused such a strange behavior of the native recovery system, which is further discussed below.</b>  I specify to restore the system to its original state with the deletion of all user data (the data was copied in advance).  And here begins the adventure.  The recovery process, starting, displays the first stage of execution - formatting the partition for Windows.  The stage reaches the end, after which the recovery process stops, giving an unintelligible error with the digital code, and the ultrabook restarts, only to give me a message that the system was not found on the disk.  Logically, I think, we just cleaned out its partition, and again press the System Recovery key to try to continue the recovery process.  And here the first surprise was waiting for me: I get the same message about the absence of the system.  As it turned out, <b>the System Recovery system self-destructed along with the cleaned system</b> .  Now I had an ultrabook on my hands without a system, without a recovery image on a hard disk and without recovery disks. <br><br>  There was only one option - to reinstall the system from scratch.  What would seem to be the problem?  Reinstall everything.  However, do not rush, not everything is as simple as it seems.  In order not to spend too much time on upgrading the system to 8.1, I decided to immediately install a clean 8.1.  Said and done, I download a fresh Windows 8.1 image from MSDN, I make a bootable USB flash drive using <a href="http://go.microsoft.com/fwlink/%3FLinkID%3D221699">Windows 7 USB - DVD tool</a> , I launch the installation.  The first problem - I still do not know the key, but it, unfortunately, is required to continue the installation.  Why was it so done, it is not clear to me, Windows 7 allowed the step of entering the key to skip.  A short search on the Internet gives the answer - you need to use generic keys, opened by Microsoft itself - they allow you to install the system, but not activate it, to activate, you need to replace this key with a fully functional one after installation.  I enter the generic key, I continue the installation.  I would stop and think at this moment (key request), but I missed this moment.  The fact is that <b>if the system key that is wired into UEFI is like installing this version of Windows, then the system should not ask it when installing.</b>  <b>Generally</b> .  She in this case uses it automatically.  If you asked for a key, this is a sign that either the key from UEFI cannot be counted, or you are using an unsuitable version of the distribution kit for this key.  However, at that time I still did not know about it, so this did not cause me any questions.  So, the system is installed and started.  Now it was necessary to activate it, and for this purpose - to somehow remove the key from UEFI.  As it turned out, this is not a difficult task at all.  To do this, you can use the <a href="http://www.chip.de/downloads/Windows-8-Product-Key-Viewer_58663752.html">PKeyUI</a> utility ‚Äî you just need to launch it and put a tick in the ‚ÄúMSDM‚Äù field - the utility will display the key saved in UEFI.  If the ‚ÄúMSDM‚Äù field does not appear when the utility is started, then either there is no key in the firmware, or it is not readable.  So, I got the key.  Then I tried to activate the system with him, and here I also had a problem waiting for me - the activation system stated that the key was not working.  Having remembered the methods of OEM distribution of Windows, I decided that I apparently needed an image of the system intended for OEM builders.  Well, no problem.  After some searches, the distribution of the original image of the system for OEM suppliers version 8.1 was found on torrent trackers.  I downloaded, created the installation flash drive again, tried to install and activate again.  However, I received the same error again.  Searches for information on the topic gave a method (as it turned out later, not working) - it was necessary to remove the old key using the slmgr script, install a new one and then activate the system normally.  I tried it, however when I tried to set the system‚Äôs native key I always received an error: <br><br>  <b>0xC004F069</b> <br><br>  Which, normally, is associated with the desynchronization of time between the target PC and the key server.  Having lamented a little and having spent another half an hour searching for methods of correcting this problem, I came to the conclusion that it is worth, perhaps, turning to the original source, that is, to Microsoft Corporation.  The call to technical support with a description of the problem cleared everything up: it turns out that I made the main mistake when I tried to use the Windows 8.1 image!  As it turned out, the Windows 8.1 image is categorically unsuitable for a clean installation on a PC that came with Windows 8 preinstalled, and even bypassing the problem using the generic key will not work, because the OEM keys from Windows 8 are not suitable for activating the clean installed Windows 8.1 OEM, although they are valid.  The only way to install on a PC with Windows 8 preinstalled version 8.1 is to upgrade the system through the Microsoft Store - just like that and nothing else.  Thanking the support, I went to download a clean OEM version of Windows 8. <br><br>  But this was not the end of my troubles, everything was not so simple.  A pure OEM version was categorically refused to be installed ‚Äî immediately after pressing the ‚ÄúInstall‚Äù button, she reported that the specified (in UEFI) key did not fit into any of the detected system images.  After a short googling, it turned out that it was necessary, among other things, to create marker files on the installation flash drive, with the correct version of the system and key.  Well, go to the sources folder on the installation flash drive and create two files there: ei.cfg and pid.txt <br><br>  Content of ei.cfg: <br><br>  [EditionID] <br>  Core <br>  [Channel] <br>  OEM <br>  [Vl] <br>  0 <br><br>  here <br>  EditionID is a system edition, sometimes Core or Professional, <br>  Channel is a distribution channel, OEM or Retail, <br>  VL is a sign of the corp.  version, it is 0 or 1. <br><br>  The above example is the norm for laptops, the basic Windows Windows, not corporate. <br><br>  Content pid.txt: <br><br>  [PID] <br>  Value = XXXXX-XXXXX-XXXXX-XXXXX-XXXXX <br><br>  Instead of XXXXX, enter the key that you received via pkeyui.  As a result of these actions, we get a bootable USB flash drive, with which Windows 8 will still be installed.  But my joy was premature - it was established, but somehow mysteriously wrote down to myself some completely outrageous key, which had nothing to do with what I scored in pid.txt (the original one from UEFI).  An attempt to change this left key to an adequate one succeeded, but when trying to activate the system, it produced the same notorious error that the key does not correspond to the edition of the system!  It turned out that there is another nuance - distributions, in addition to revisions and the licensing method, are also divided by SKU, and laptop collectors are usually put up for CoreSingleLanguage or CoreCountrySpecific.  And I needed the image of CoreSingleLanguage, because for all types of SKU - installation keys are different.  Why, in this case, the system allows you to continue the installation, it is absolutely not clear to me - it does not make any sense, since the key still does not fit and I personally did not find a way to change the SKU of the already installed system.  Quietly swearing, I went to look for an OEM distribution with SKU "CoreSingleLanguage".  And I finally found it, it lies on many trackers, so as not to give references to potentially dangerous resources, I‚Äôll just give MD5 of the required distribution: <br><br>  <b>2F3EC4EA9F604DF608AC0B1EE4C53CF1</b> <br><br>  I processed the found distribution, created the marker files and hoped that everything - my problems were solved and after the 4th reinstallation in a row, Windows 8 finally not only installed, but also allowed itself to be activated.  It was not there!  The processed distribution after clicking the ‚ÄúInstall‚Äù button gave me an error that I had already seen before: that the specified (in UEFI) key does not fit into any of the detected system images!  Swearing, I tried to simply delete the ei.cfg and pid.txt files created from the flash drive.  I start from it and ... the system takes the key and is installed!  After installation, the system status is activated! <br><br>  Bingo!  Then there was the routine - upgrading to 8.1 through the Microsoft Store, installing the basic set of free software, etc. <br><br>  Plus, throughout the process, I derived an algorithm, which, I think, should be followed in this procedure: <br><br><ul><li> If the laptop was simply Windows 8, then we just take Windows 8 and not Windows 8.1 - even if we install 8.1, we cannot activate it! </li><li>  Finding out the Windows key using the pkeyui utility - we run it on a live system, set the MSDM checkbox and write the key. </li><li>  We call Microsoft technical support, briefly explain the situation and ask to check the validity and ownership of the extracted key.  The techsapp guys without any problems will check the key and will tell you what type of distribution it fits - basic or professional, OEM or retail and what its SKU is CoreSingleLanguage or CoreCountrySpecific or otherwise. </li><li>  We are looking for and download the <b>image of the system strictly corresponding to the key</b> .  If this is a laptop, then most likely you will need an OEM and in most cases CoreSingleLanguage </li><li>  Download the disk image and make a bootable USB flash drive using the Windows 7 USB / DVD download tool (or manually <a href="http://www.intowindows.com/how-to-install-windows-7vista-from-usb-drive-detailed-100-working-guide/">like this</a> ‚Äî it doesn't want to work with some Windows 7 USB / DVD images).  So far, after this, nothing extra with a flash drive is not doing.  Alternatively, you can (and it will be even better) make a bootable UEFI flash drive using <a href="http://rufus.akeo.ie/">Rufus</a> . </li><li>  Reboot, immediately after the start, quickly press Esc.  If the USB flash drive was made using the Windows 7 USB / DVD download tool, then select BIOS Setup, in the BIOS settings, you must turn off the Secure Boot and turn on the Legacy Boot - otherwise we will not boot from the USB flash drive.  <b>If you made a UEFI flash drive using Rufus, you should not do this.</b>  Now we insert the USB stick. </li><li>  Reboot, immediately after the start, quickly press Esc.  Select the choice of boot devices, choose your flash drive and begin to install the system.  If everything is done as it should - the system will be installed without asking for any keys at all. </li><li>  If it does not work and the system either does not accept the key at all or is put but then does not want to be activated, go to the sources folder on the installation flash drive and create two files there: ei.cfg and pid.txt, adjusting their contents as described above.  We are trying to install the system from a flash drive with the created marker files. </li><li>  After installation, activate the system - if activated, then everything is fine, if not - you picked up the wrong distribution. </li></ul><br><br>  The result of the foregoing are a few rhetorical questions to the laptop manufacturer and to Microsoft.  To the manufacturer the main question is why did the recovery system work as a self-destruct system?  Habrovchane, anyone else this came across?  And to Microsoft - well, why such paranoid software protection measures?  What are they for?  Indeed, in this case, there was a completely legitimate process of banal reinstallation of the destroyed OS.  In fact, we have a situation where a user whose OS has collapsed in no way, absolutely no way, will not be able to reinstall it on his own - this requires remarkable skills.  In general, to understand this confusing installation system, I had to reinstall the system four times.  Why create such difficulties?  After all, in the end, if you count all possible modifications of distributions with different types of licenses, it turns out that there are almost 30 of them.  Is this such a specific additional protection against piracy?  The rest is science: be careful and don‚Äôt believe the articles on the Internet.  The very widely-used ‚Äúworking‚Äù method of installing clean Windows 8.1 everywhere, followed by activation with a native key, turned out to be completely unworkable and took me about five hours of time, which could be spent with much greater benefit.  Well, at least I now know almost all the features of licensing and activating Win 8. I hope this story will be useful for you. </div><p>Source: <a href="https://habr.com/ru/post/202268/">https://habr.com/ru/post/202268/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../202254/index.html">Google BBS Terminal - how google could look like in the 80s</a></li>
<li><a href="../202258/index.html">How to invest $ 100,000 in your own karma (part 1)</a></li>
<li><a href="../202260/index.html">4 billion years of Mars history in two minutes</a></li>
<li><a href="../202262/index.html">iPad Air with LTE support from MegaFon goes on sale</a></li>
<li><a href="../202264/index.html">Search for solutions in logic games on the example of Gomoku</a></li>
<li><a href="../202272/index.html">iCity is a virtual city that nobody cares about. Post Mortem to an internal startup</a></li>
<li><a href="../202274/index.html">Width of table columns or when browsers lie</a></li>
<li><a href="../202276/index.html">In-ear headphones: all about them</a></li>
<li><a href="../202278/index.html">Video surveillance in the countryside via 3G Internet</a></li>
<li><a href="../202280/index.html">Clustering web applications hosted by Amazon Web Services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>