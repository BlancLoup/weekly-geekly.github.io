<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MongoDB: Creating, updating and deleting documents</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As part of my reading of the book â€œMongoDB: The Definitive Guideâ€, Kristina Chodorow and Michael Dirolf decided to write out the main points from the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">ğŸ”</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">ğŸ“œ</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">â¬†ï¸</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">â¬‡ï¸</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MongoDB: Creating, updating and deleting documents</h1><div class="post__text post__text-html js-mediator-article">  As part of my reading of the book â€œMongoDB: The Definitive Guideâ€, Kristina Chodorow and Michael Dirolf decided to write out the main points from the chapters for better mastering the material.  Perhaps someone will be useful too. <br><br><h4>  Insert </h4><br><br>  Insert is the base method for adding information to MongoDB.  To add a document to the collection, do this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>&gt; db.foo.insert( { â€œbarâ€ : â€œbazâ€ } );</code> <br> <br>  In such situations, when you need to add several documents, for faster insertion, it is desirable to use the so-called batch insert (group insert) <br><br> <code>&gt; db.foo.insert( { â€œarrâ€ : [ { a : 1 , b : 1 } , { a : 2 , b : 2 } ] } );</code> <br> <br>  Roughly speaking, we simply insert an array. <br><a name="habracut"></a><br><h4>  Remove </h4><br><br>  All information from the collection can be deleted like this: <br><br> <code>&gt; db.users.remove();</code> <br> <br>  This does not remove the collection itself or any indexes from it. <br>  You can delete an object by some parameter like this: <br><br> <code>&gt; db.users.remove( { â€œnameâ€ : â€œVasyaâ€ } );</code> <br> <br>  Deleting is fast enough, but if you want to clear a collection, it will often be faster to delete the collection itself (drop) and re-create the indexes. <br><br> <code>&gt; db.drop_collection( â€œbarâ€ );</code> <br> <br><h4>  Update </h4><br><br>  The simplest type of update is a complete replacement of matched documents.  There was such a document: <br><br> <code>} <br> "_id" : ObjectId("4b2b9f67a1f631733d917a7a"), <br> "name" : "joe", <br> "age" : 18 <br> }</code> <br> <br>  If we do this, the whole document will be replaced: <br><br> <code>&gt; db.users.update( { â€œnameâ€ : â€joeâ€ } , { â€œnameâ€ : â€œvasyaâ€ } );</code> <br> <br>  those.  will be <br><br> <code>} <br> "_id" : ObjectId("4b2b9f67a1f631733d917a7a"), <br> "name" : "vasya" <br> }</code> <br> <br>  After this request, only the first found document will be updated, about multi-apdete below. <br><br><h5>  Modifiers </h5><br><br>  If we want to increment some field, we use the $ inc modifier.  To increase age by 2 years we do this: <br><br> <code>&gt; db.users.update( { name: â€œjoeâ€ } , { $inc : { age: 2 } } );</code> <br> <br>  If you need to set the value of a key, use the $ set modifier <br><br> <code>&gt; db.users.update( { name:â€joeâ€ } , { $set: { age: 25 } } );</code> <br> <br>  It finds a document where the name is joe and sets age to 25. It is important that if there is no age key, then it will be created. <br><br>  If you need to remove the key, there is a modifier $ unset <br><br> <code>&gt; db.users.update( { name: â€joeâ€ } , { $unset: { age : 1 } } );</code> <br> <br><h5>  Array Modifiers </h5><br><br>  You can add an element to an array using $ push.  Suppose this joe still has a list of his friends, something like this: <br> <code>} <br> "_id" : ObjectId("4b2b9f67a1f631733d917a7a"), <br> "name" : "joe", <br> "age" : 18, <br> â€œfriendsâ€: [ <br> {name: â€œjohnâ€}, <br> {name: â€œhelenâ€} <br> ] <br> }</code> <br> <br>  We want to add more peter'a to friends <br><br> <code>&gt; db.users.update( { name: â€œjoeâ€ } , { $push: { friends: { name: â€œpeterâ€ } } } );</code> <br> <br>  Such a thing will add peter'a to the end of joe's array of friends. <br>  If there is $ push, then there must be $ pop: <br><br> <code>&gt; db.users.update( { name: â€joeâ€ } , { $pop: { friends: 1 } } );</code> <br> <br>  This will remove the array element from the end, and this from the beginning. <br><br> <code>&gt; db.users.update( { name: â€joeâ€ }, { $pop: { friends: -1 } } );</code> <br> <br>  There is also a useful thing $ addToSet - works by analogy with $ push, but with a check for uniqueness. <br><br>  Sometimes you need to remove an array element by some criterion, then the $ pull modifier is used: <br><br> <code>&gt; db.users.update( { }, { $pull: { friends: { name: â€œjohnâ€ } } } );</code> <br> <br>  This will remove john's friends. <br><br><h5>  Positional Array Modifiers </h5><br><br>  There are 2 ways to manipulate values â€‹â€‹in an array: by a specific position or by using a positional operator ($ symbol). <br><br>  For example, in the list of friends joe stores not only their names of friends, but also their age, and we want to increase the age of a friend with the index 0 by 3 years: <br><br> <code>&gt; db.users.update( { name: â€œjoeâ€ } , { $inc: { â€œfriends.0.ageâ€ : 3 } } );</code> <br> <br>  If we want to increase the age of a particular friend, for example, john, but we donâ€™t know by what index it is in the array, we do this: <br><br> <code>&gt; db.users.update( { â€œfriends.nameâ€: â€œjohnâ€ } , { $inc: { â€œfriends.$.ageâ€ : 3 } } );</code> <br> <br><h5>  Upserts </h5><br><br>  Upsert is a special type of update.  If it is used, if the document on the requested criteria is not found, it will be created, if it is found, then it will be updated, as usual.  To use upsert, you just need to add in the update command a third parameter equal to true, like this: <br><br> <code>&gt; db.users.update( { name: â€œhelenâ€ } , { $set: { age: 23 } } , true );</code> <br> <br>  If there is no document in our collection with the name â€œhelenâ€, then it will be created together with the age: 23 field. <br><br><h5>  Multiple Update </h5><br><br>  All previous examples using the update command found the first document and updated it.  In order to perform a multiple update, add a fourth parameter to the update with the value true: <br><br> <code>&gt; db.users.update( { age: 18 } , { $inc: { age: 1 } } , false, true );</code> <br> <br>  This query will find everyone who is 18 years old and will increase it by 1. <br><br>  In general this is all.  These are not all modifiers, only basic ones. <br>  There will be time, there will be a continuation. </div><p>Source: <a href="https://habr.com/ru/post/134524/">https://habr.com/ru/post/134524/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134518/index.html">Critical error in the method of processing SMS messages in Windows Phone 7</a></li>
<li><a href="../134520/index.html">Co-ownership and domain management</a></li>
<li><a href="../134521/index.html">We decorate the desktop with random wallpapers with GoodFon</a></li>
<li><a href="../134522/index.html">HTC Titan - all-aluminum shell</a></li>
<li><a href="../134523/index.html">"Protect" mp3 files on amazon.com</a></li>
<li><a href="../134525/index.html">Firefox does not fit in 32-bit address space</a></li>
<li><a href="../134526/index.html">Arduino in production *</a></li>
<li><a href="../134527/index.html">Belarus Startup'2011</a></li>
<li><a href="../134528/index.html">WordPress 3.3 â€œSonnyâ€</a></li>
<li><a href="../134532/index.html">TechCrunch Interview with Jessica Powell, CMO Badoo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>