<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>And again, history repeats itself ... Spam with viruses, act two</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, Habrochitatel! 

 Not long ago, I wrote a post about spamming (and I did not write one warning). It seemed like the story was over ... Howev...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>And again, history repeats itself ... Spam with viruses, act two</h1><div class="post__text post__text-html js-mediator-article">  Good day, Habrochitatel! <br><br>  Not long ago, I <a href="http://habrahabr.ru/blogs/virus/81629/">wrote a post</a> about spamming (and I did not write one warning).  It seemed like the story was over ... However, no!  And again a letter of a similar nature came to me. <a name="habracut"></a><br><br><blockquote>  Good day. <br>  Web Design Studio "INTINITY" announces the recruitment of freelancers <br>  by specialties: <br>  designers, web designers, <br>  foreign language translators, <br>  copywriters, rewriters, <br>  photographers, artists (knowledge of photoshop) <br>  We also invite to cooperation agencies and studios. <br>  we guarantee decent pay for your work, <br>  task can be downloaded here;  <s><a href="http://narod.ru/disk/17519876000/T3.rar.html">narod.ru/disk/17519876000/T3.rar.html</a></s> <br>  our website <a href="http://www.intinity.org/">www.intinity.org</a> <br>  Design Studio "INTINITY" </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As expected, almost nothing has changed: <br><br><blockquote>  From - Tue Feb 02 21:12:02 2010 <br>  X-Account-Key: account1 <br>  X-UIDL: 1265134310870 <br>  X-Mozilla-Status: 0001 <br>  X-Mozilla-Status2: 00000000 <br>  X-Mozilla-Keys: <br>  Return-path: &lt;spravka@intinity.org&gt; <br>  Received: from [206.190.52.176] (port = 26921 helo = smtp107.biz.mail.re2.yahoo.com) <br>  by mx20.mail.ru with esmtp <br>  id 1NcNE5-000NiP-00 <br>  for XXX@mail.ru;  Tue, 02 Feb 2010 21:11:49 +0300 <br>  Received-SPF: none (mx20.mail.ru: 206.190.52.176) client-ip = 206.190.52.176;  envelope-from=spravka@intinity.org;  helo = smtp107.biz.mail.re2.yahoo.com; <br>  X-Mru-BL: 0: 4: 0 <br>  X-Mru-PTR: off <br>  X-Mru-NR: 1 <br>  X-Mru-OF: unknown (ethernet / modem) <br>  X-Mru-RC: US <br>  Received: (qmail 68778 invoked from network);  2 Feb 2010 18:11:47 -0000 <br>  Received: from d54C3F021.access.telenet.be (spravka@84.195.240.33 with login) <br>  by smtp107.biz.mail.re2.yahoo.com with SMTP;  02 Feb 2010 10:11:46 -0800 PST <br>  X-Yahoo-SMTP: OGyL7BeswBAyEJCfyh3zpU0Ux00x <br>  X-YMail-OSG: Z2tGzJUVM1kYtCxOkf2SYY50vDvMU0C6IGaK4cVfIg_cxKJM7Hk1YGKLpn_BnIZo5WKYIk86JSB.UuZoCkugEGVeRy8CGIbg_gltmyjOgzZy5lgKdyKkqXrUQR5QcBBWfeShmMw7mMZSO8hYNZhaGCrvj_aWYFB7AJ1bJQ48NKUs_ByHw4XtN5Y9ZemsZNr0kmZ3DKuPEIFdvv6GSugwxtNbii9LkIrM1_6U0kV_JzhSnzU5odZ_ezmiJ_FAkdr18N_eKDxGB1.diT61FJz7mnxYppQeYWJtQNMwt9KB7oQU5xFn_aFYXEYQczvdRg.Al3GdHatGBxB7Rgdll5.u3PMM.YCXh9Ek.QOCmZru4JZsYE6EEUa.x1bcyxefY4_z9ZethmvaRBQ97m76C.a1tNDpp3yKegdC7RAMMEcv6xb5pTCThzzY1DaTwhhq53F8jvl0vBN.6m60GbbFJettinZ90jha2bBotn8Ny2u2qIpCudretLjemC_SqAIsBU1uGt0W5A6x <br>  X-Yahoo-Newman-Property: ymail-3 <br>  Message-ID: &lt;00de97b9-40211-0e898831779861 @ user&gt; <br>  Reply-To: ‚ÄúStudio \‚Äù INTINITY \ "" &lt;spravka@intinity.org&gt; <br>  From: ‚ÄúStudio \‚Äù INTINITY \ "" &lt;spravka@intinity.org&gt; <br>  To: XXXX@mail.ru <br>  Subject: Studio "INTINITY" <br>  Date: Tue, Feb 2, 2010 21:11:47 +0300 <br>  MIME-Version: 1.0 <br>  Content-Type: text / plain <br>  Content-Transfer-Encoding: 8bit <br>  X-Priority: 3 <br>  X-Mailer: Power Sending Sockets v5.1 <br>  X-Spam: Not detected <br>  X-Mras: OK <br><br>  Good day. <br>  Web Design Studio "INTINITY" announces the recruitment of freelancers <br>  by specialties: <br>  designers, web designers, <br>  foreign language translators, <br>  copywriters, rewriters, <br>  photographers, artists (knowledge of photoshop) <br>  We also invite to cooperation agencies and studios. <br>  we guarantee decent pay for your work, <br>  task can be downloaded here;  <s><a href="http://narod.ru/disk/17519876000/T3.rar.html">narod.ru/disk/17519876000/T3.rar.html</a></s> <br>  our website <a href="http://www.intinity.org/">www.intinity.org</a> <br>  Design Studio "INTINITY" <br><br>  . <br></blockquote><br><br>  Yandex, as it turned out, decided to contribute to the malicious spammers in everything and friendly reports that there is nothing dangerous there.  Like an antivirus program found nothing. <br><br><img src="http://zzet.org/sites/default/files/images/step1.png"><br><br>  However, the already proven <a href="http://www.virustotal.com/ru/analisis/d2f1ce08ae54d9314f9e973cfec16902314cf6b2d322ed5d71510b60e6f8630d-1265135129">virustotal.com</a> reports that the Trojan is waiting for us.  And then the trojan is narrowly targeted ... <br><br><img src="http://zzet.org/sites/default/files/images/step2.png"><br><br>  Judging by the information from the network: <br><br>  <strong>Trojan-PSW.Win32.WebMoner.j</strong> <br><br>  <em>Rootkit: No</em> <br>  <em>Visible manifestations: Foreign process in memory</em> <br>  <em>Substitution of numbers of WebMoney and Yandex wallet purses in the clipboard</em> <br>  <em>Synonyms: Trojan.PWS.Webmonier (DrWEB)</em> <br><br>  The Trojan program, written in Basic, is not compressed or encrypted, is 28,672 bytes in size.  The icon and the copyright of the file are fake to be masked as a TWAIN Windows component.  In the case of launch, it secretly performs the following operations: <br>  1. Creates a copy of its executable file in the WINDOWS folder.  The name of the executable file corresponds to the name under which the trojan ball is launched on the user's computer <br>  2. It is registered in autorun, CurrentVersion \ Run key, System parameter <br>  3. After launch, it remains secretly in memory and polls the contents of the clipboard by timer.  If the WebMoney purse number is detected in the exchange buffer (a text string starting with Z, E, R, U and 12 digits after the letter), the Trojan program replaces this number with the number of the intruder‚Äôs purse.  In order to make this change, the corresponding numbers of Z, E, R and U purses are set in plain text in the body of the Trojan.  In addition, if a number is detected in the buffer, starting with ‚Äú4‚Äù and containing 13‚Äì14 characters, the Trojan program replaces it with the number specified in the program.  It is easy to see that the Yandex.Money wallet numbers have a similar format. <br>  Thus, the principle of the Trojan program is based on the fact that when making a payment, often the purse numbers are copied via the clipboard and the user usually does not check the multi-digit number after inserting it.  The Trojan program replaces the number, and the user copies the correct purse number to the buffer, and inserts the purse number of the creator of the Trojan program from the buffer and sends him money accordingly. <br><br>  <strong>Protection technique</strong> <br>  The method of protection is quite simple - you should always control the payment details before making a payment via the Internet.  Such control will protect against various methods of falsification and substitution of the wallet number in the process of entering or copying it through the clipboard. <br><br>  UPD: <br><br>  Yandex and Webmoney have sent letters describing what it is (I‚Äôm talking about the file and its activity) and asking for action. <br><br>  UPD2: <br><br>  by <a href="http://habrahabr.ru/users/lmaster/" class="user_link">lmaster</a> <br>  The executable file is a dropper (Delphi) and drops into% TEMP% the Trojan itself, packed with UPX, launching it for execution. <br>  Trojan itself is written in Delphi, has a weight of 796 KB. <br>  The malware collects information from the victim‚Äôs computer and sends it to the gate: <br>  maerb.hmsite.net/upload.php <br><br>  Functional Trojan-PSW.Win32.WebMoner.nl: <br><br>  1) The program records all keystrokes (keylogger) <br>  2) The malware steals data for authorization from the following programs: <br>  - QIP <br>  - Mail.ru Agent <br>  - Total Commander <br>  - SmartFTP <br>  - OutLook <br>  - ICQ <br>  - The BAT! <br>  - WebMoney <br>  - FireFox <br>  - IE <br>  - Opera <br>  3) All this program sends to the sites: maerb.hmsite.net/upload.php <br><br>  From me: As you can see, nothing has changed ... Everything works as before.  <a href="http://habrahabr.ru/blogs/virus/81629/">In the same way.</a> </div><p>Source: <a href="https://habr.com/ru/post/82910/">https://habr.com/ru/post/82910/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../82887/index.html">"Amazing, incredible" - Apple reduced</a></li>
<li><a href="../82894/index.html">Unparalleled online newspaper graph. ads "AdNotice.net"</a></li>
<li><a href="../82903/index.html">Ethernet clocks always show the exact time</a></li>
<li><a href="../82906/index.html">Anchor navigation on jQuery (graceful degradation)</a></li>
<li><a href="../82907/index.html">"Tanchiki" on your mobile for nostalgic</a></li>
<li><a href="../82913/index.html">What is the global torrent traffic?</a></li>
<li><a href="../82915/index.html">The first site in the zone. RF opened ... and does not work</a></li>
<li><a href="../82916/index.html">N Building: QR code building</a></li>
<li><a href="../82917/index.html">Is Intel LGA775 Platform Dead? From SLI to Intel X48 - hardly!</a></li>
<li><a href="../82919/index.html">Mutt, ssmtp and sending reports</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>