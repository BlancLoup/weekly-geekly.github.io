<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Connecting the Grandstream GXW4104 FXO Gateway to 3CX</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 The latest 3CX v15.5 Update 6 update adds support for Grandstream FXO gateways. Currently, only one GXW4104 model is supported - a gate...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Connecting the Grandstream GXW4104 FXO Gateway to 3CX</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/750/846/592/750846592fe776e95b8058f2f6be1bdc.png"></div><br><h3>  Introduction </h3><br>  The latest 3CX v15.5 Update 6 update adds support for Grandstream FXO gateways.  Currently, only one GXW4104 model is supported - a gateway to which you can connect 4 "copper" analog lines from a telephone operator.  This is convenient if you are switching to IP telephony, but for some reason you cannot receive SIP lines and are forced to use analog lines.  Another case - you need to maintain a backup communication channel in case of disconnection of the Internet and SIP services.  And the third example - you need to combine the old analog PBX and 3CX.  Then part of the additional lines of analog PBX (Ext) can be connected to the gateway ports (the merging process is not considered in this article). <br><br>  In the article we will consider the most common case - connecting to 3CX analog lines from a telecom operator.  For this purpose, a special gateway autotuning pattern is included in 3CX, which essentially simplifies the task. <br><br>  It is important to note that the template is designed to connect the gateway within the local network, or from a directly routed network, including VPN links.  In other words, the template is not designed to connect an FXO gateway to 3CX directly via the Internet. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Preparing the FXO gateway </h3><br>  Connect the gateway to the network via the WAN interface.  Be sure to reset the gateway to the default settings - hold the reset button on the case for 10 s.  at the time of turning on the device.  Then wait a couple of minutes for it to reset and restart. <br><br>  Now you need to determine the IP and MAC address of the gateway.  Run the <a href="http://www.grandstream.com/support/tools">Grandstream IP Discovery Tool</a> utility and choose to listen to the interface that is on the common network with the gateway WAN port (if you have several interfaces on your PC). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b85/a50/c21/b85a50c218357c84d3737f6977de6966.png"></div><br>  Turn off the gateway, click the Listen button and turn on the gateway.  After a few seconds, it will be detected by the utility. <br><br>  In the gateway interface (default password is admin), go to the Status - System section and make sure that the firmware version is at least 1.4.1.5.  If below, you should upgrade the firmware.  In the Maintenance - Upgrade / Provisioning section, in the Firmware Server Path field, specify the HTTP URL of the firmware download of the firmware.grandstream.com gateway.  It is also recommended to set the Always Check for New Firmware option. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/32d/a24/13e/32da2413ed3f8ca08ff0c143a061bab3.png"><br><br>  Installing the firmware takes a few minutes - wait until the gateway is completely ready! <br><br><h3>  Configure Gateway in 3CX </h3><br>  In the 3CX interface, go to the SIP trunks section and click Add SIP Gateway.  Specify the Grandstream manufacturer and model GXW-4104.  Set the number of ports - 4 (we specify the number of physical ports of the device, and not the number of ports used).  As the main number, specify the number to which calls come in first and foremost - usually it is the most important number of the four. <br><img src="https://habrastorage.org/getpro/habr/post_images/1f2/6fb/370/1f26fb3706ada59b9fb02257df97834b.png"><br>  When the gateway settings page opens, go to the General tab.  Here, enter the IP address of the 3CX server and copy the autotune URL - you'll need it later. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c5a/ad2/534/c5aad2534ff560754a45c23ce834a460.png"><br><br>  Go to Settings - SIP Gateway Settings.  Here you should specify: <br><br><ul><li>  MAC address of the gateway, which is listed on the device case (WAN port) or visible in the Grandstream Discovery Tool utility <br></li><li>  Fax transmission mode.  FAX in T.38 Relay Mode is recommended for reliable transmission.  But if users have analog fax machines integrated with the phone, you may have to use FAX in G.711 Passthrough Mode </li><li>  Caller ID Scheme - this parameter should be found out from the telecom operator or set experimentally.  Often, Caller ID is transmitted in ETSI-DTMF during ringing mode. <br></li><li>  Dial Tone, Ringback Tone, Busy Tone, Reorder Tone - are determined by the <a href="https://www.itu.int/ITU-T/inr/forms/files/tones-0203.pdf">standards of your country</a> .  For countries b.  The USSR value is only the parameter Busy Tone, which is set like this: ch1-4: f1 = 425 @ -11, f2 = 0 @ -11, c = 35/35; <br></li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/ea8/911/285/ea891128572ad7d937f3cbc4ba676ca1.png"><br><br><h3>  Configure inbound and outbound rules in 3CX </h3><br>  From the FXO gateway, the 3CX server receives only the number from which it was called (Caller ID), but not the number to which it was called (DID).  Therefore, you need to manually add DID numbers to the FXO gateway parameters in order to create the <a href="https://www.3cx.ru/docs/manual/inbound-rules/">rules for routing incoming calls</a> from a specific FXO port to the desired Group, Queue or extension. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4d8/949/259/4d8949259930b36d3b9af266f2fbc1a7.png"><br><br>  Outbound rules for calls through the gateway are also generated by the <a href="https://www.3cx.ru/docs/manual/outbound-rules/">3CX documentation</a> . <br><br><h3>  FXO Gateway Setup </h3><br>  Go to the Maintenance - Upgrade / Provisioning section and in the Config Server Path field, specify the gateway auto-configuration link from the 3CX interface, copied above.  The remaining parameters are set as shown in the figure. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/77b/8ee/3c2/77b8ee3c2cc7f9257f9eae1f94b50418.png"><br>  After clicking Save and Reboot, the gateway will reboot, load the configuration from the server, and connect to 3CX. <br><br>  This completes connecting the Grandstream GXW4104 FXO Gateway to 3CX. </div><p>Source: <a href="https://habr.com/ru/post/424177/">https://habr.com/ru/post/424177/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../424161/index.html">Forensic resistance 1 or Last ActivityView. Data on user activity in Windows 10 and how to remove them</a></li>
<li><a href="../424163/index.html">Secrets of karma</a></li>
<li><a href="../424167/index.html">Reading Room: articles about radio, streaming and podcasts</a></li>
<li><a href="../424169/index.html">Carnegie Mellon University saves old programs from oblivion</a></li>
<li><a href="../424175/index.html">Digital events in Moscow from September 24 to September 30</a></li>
<li><a href="../424183/index.html">October 4, Moscow - Backend Stories 2.0</a></li>
<li><a href="../424185/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ331 (September 17 - 23, 2018)</a></li>
<li><a href="../424187/index.html">Conference DEFCON 22. Adrian Crenshaw. What can ‚Äúburn‚Äù users TOR</a></li>
<li><a href="../424189/index.html">Smart House? Or not smart ???</a></li>
<li><a href="../424191/index.html">Mobile watchman on Raspberry pi (h.264)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>