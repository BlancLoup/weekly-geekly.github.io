<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to make an office scanner network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lyrical digression 
 In one small organization (~ 10 computers) it was necessary to organize a backup of information. To do this, it was decided to in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to make an office scanner network</h1><div class="post__text post__text-html js-mediator-article"><h4>  Lyrical digression </h4><br>  In one small organization (~ 10 computers) it was necessary to organize a backup of information.  To do this, it was decided to install a computer with a large hard drive and Ubuntu inside, and on users' computers - Cobian backup. <br><br>  An inquisitive reader will ask: ‚ÄúWhy do you write this, the author?  And what have some kind of scanner? ‚Äù <br>  The fact is that in this organization there was only one opportunity to scan the document - ask the Samsung SCX-4200, the happy owner of the MFP, to do it (the name, of course, not important, but it all happened because of this device). <br>  During the installation of Ubuntu on the ‚Äúserver for backup‚Äù, the idea arose: ‚ÄúAnd if you connect this MFP here, leave the keyboard connected, and by pressing certain keys force the scanner to scan, saving the result in a shared folder?  After all, then a person will not be distracted from work to scan other people's documents! ‚Äù <br>  Of course, first of all, ready-made scripts were searched.  This one seemed the most interesting - <a href="http://www.opennet.ru/base/sys/net_scanner.txt.html">www.opennet.ru/base/sys/net_scanner.txt.html</a> <br>  However, upon closer inspection, he was not so good, because  I have no desire to recompile the program to change the scanner settings, to teach users to convert images and create .pdf-files. <br>  I'll try to write my own, good ... <br><a name="habracut"></a><br><br><h4>  So, the task is set </h4><br>  1. Connect to the Ubuntu MFP, make the printer shared, configure the scanner. <br>  2. Write a script that will wait for pressing a key on the keyboard <br>  Esc - cancel scanning in progress <br>  1 - scan color mode <br>  2 - scan mode in grayscale <br>  0 - save the scanned file (jpg, if one page was scanned or pdf, if several) <br>  Enter - scan the page. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Decision </h4><br>  Point 1 was dropped by itself.  Connecting the printer happened unexpectedly simply and did not cause a single question.  It was enough to simply connect the USB cable to the computer, and after a few seconds, Ubuntu announced that the printer should print.  Sent a test page - really typing! <br>  Now the fun part. <br>  Let's see which scanners we have in the system: <br>  scanimage -L <br>  If the system cannot find this command, it means that you need to install the sane-utils package: <br>  sudo apt-get install sane-utils <br><br>  The program found a device with the name `xerox_mfp: libusb: 001: 002` <br>  If the scanner is the only one in the system, then the ‚Äúdevice name‚Äù parameter can be omitted;  scanimage will scan the only possible scanner. <br><br>  Let's try to scan the page: <br>  scanimage -d ‚Äúxerox_mfp: libusb: 001: 002‚Äù --resolution 150 --mode Color --format = tiff&gt; test.tif <br>  The resolution of 150 dpi is chosen because of the desire to reduce the scan time and the size of the output file, but leave the user the ability to print a document with readable text.  If you ever need text recognition or scanning photos, then additional options will appear. <br>  So, we have tiff.  Either one or several (scanned a multi-page document).  It is clear that users in 90% of cases scan documents for sending by e-mail, and tiff is not a compact format.  So, you need to convert the result to .jpg or .pdf. <br><br>  Put the package for editing / converting raster images: <br>  sudo apt-get install imagemagick <br><br>  Squeeze a single image: <br>  convert -quality 60% test.tif test.jpg <br><br>  Or all at once: <br>  convert -compress jpeg -quality 60% * .tif all.pdf <br><br>  Only one moment remained.  I am not going to leave a monitor connected to this computer - it means that the user is left without feedback.  Well, let's make a computer talking. <br>  Make a list of sounds that should be played in response to pressing a key on the keyboard, take the microphone and record our mini-phrases.  They are as short as possible, because the goal of the whole action is not listening to mp3, but scanning. <br>  1. Waiting for the command (waitcommand.mp3) <br>  2. Color scanning (color.mp3) <br>  3. Black and white scanning (bw.mp3) <br>  4. Scan page (scanpage.mp3) <br>  5. Save the result (saveresult.mp3) <br><br>  Oh yeah, because we have a ‚Äúclean‚Äù system that cannot play mp3 from the console ... <br>  We correct the situation: <br>  sudo apt-get install mpg321 <br>  Enjoying: <br>  mpg123 -q waitcommand.mp3 <br><br><h4>  Now it seems everything is ready </h4><br>  Writing a script /mnt/2tb/scan.sh <br><br> <code>#!/bin/bash <br> <br> # ================================================== <br> #  <br> <br> scannerdevice="xerox_mfp:libusb:001:002" #scanimage -L <br> workdir="/tmp/scanworkdir" <br> destdir="/mnt/2tb/Share/1Scanner" <br> dpi="150" <br> jpegquality="60%" <br> <br> # ================================================== <br> #   <br> <br> sleep 10s <br> <br> mkdir -p $workdir <br> rm $workdir/*.* 2&gt;/dev/null <br> numpages=0 <br> color="Gray" <br> mpg123 -q waitcommand.mp3 <br> <br> while true <br> do <br> #  <br> read -sn 1 Keypress <br> <br> case "$Keypress" in <br> $'\e') <br> #  <br> rm $workdir/*.* 2&gt;/dev/null <br> numpages=0 <br> color="Gray" <br> mpg123 -q waitcommand.mp3 <br> ;; <br> <br> $'1') <br> # <br> color="Color" <br> mpg123 -q color.mp3 <br> ;; <br> <br> $'2') <br> #/ <br> color="Gray" <br> mpg123 -q bw.mp3 <br> ;; <br> <br> $'0') <br> #  <br> mpg123 -q saveresult.mp3 <br> filename=`date +%Y%m%d-%H%M%S` <br> if [ $numpages = 1 ]; then <br> convert -quality $jpegquality $workdir/1.tif $destdir/$filename.jpg <br> fi <br> if [ $numpages \&gt; 1 ]; then <br> convert -compress jpeg -quality $jpegquality $workdir/*.tif $destdir/$filename.pdf <br> fi <br> rm $workdir/*.* 2&gt;/dev/null <br> numpages=0 <br> color="Gray" <br> mpg123 -q waitcommand.mp3 <br> ;; <br> <br> $'') <br> #  <br> mpg123 -q scanpage.mp3 <br> let "numpages=numpages+1" <br> scanimage -d $scannerdevice --resolution $dpi --mode $color --format=tiff &gt;$workdir/$numpages.tif <br> mpg123 -q waitcommand.mp3 <br> ;; <br> esac <br> <br> done</code> <br> <br>  We speak <br>  chmod + x /mnt/2tb/scan.sh <br><br><h4>  Run </h4><br>  Yes, everything works as expected.  Now go to the menu Ubuntu System -&gt; Options -&gt; Running applications, Add, Browse, select the file with the script.  Restarting the computer, and ... the scanner starts to scan something continuously, no sounds are played. <br>  Okay, I press Ctrl + C, I read once again what I wrote ... <br>  With sounds, everything is trivial - they are not in the folder from which the script is called.  Continuous scanning is apparently due to $ '') inside the case. <br><br>  I did not begin to deal with this in detail, but simply changed the autorun command to <br>  / usr / bin / gnome-terminal -e /mnt/2tb/scan.sh --working-directory / mnt / 2tb <br>  Once again I restart the computer - everything works, users are happy. </div><p>Source: <a href="https://habr.com/ru/post/110905/">https://habr.com/ru/post/110905/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../110898/index.html">Launch SMS service "on the knee"</a></li>
<li><a href="../110899/index.html">Upgrade "soapbox" to the microscope</a></li>
<li><a href="../110900/index.html">Would you participate in the acquisition of the domain sawmill. Rf and the creation of the appropriate startup?</a></li>
<li><a href="../110901/index.html">Data storage in Google App Engine</a></li>
<li><a href="../110904/index.html">What young people should know about the past century</a></li>
<li><a href="../110906/index.html">audio.js - listen to music in any browser</a></li>
<li><a href="../110907/index.html">AppAdmin - Android Application Manager</a></li>
<li><a href="../110909/index.html">Unit Testing - Personal Experience</a></li>
<li><a href="../110910/index.html">Stack of web developer in a virtual machine with FreeBSD</a></li>
<li><a href="../110911/index.html">A small quest on WEB 2.0</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>