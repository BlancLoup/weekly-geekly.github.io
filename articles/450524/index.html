<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Computer control via Telegram</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Hi, Habr! 

 Recently I wanted to install a mouse control application on my computer, but I had problems connecting the phone and I had...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Computer control via Telegram</h1><div class="post__text post__text-html js-mediator-article"><h2>  Introduction </h2><br>  Hi, Habr! <br><br>  Recently I wanted to install a mouse control application on my computer, but I had problems connecting the phone and I had an idea to do something similar myself, but how?  After going through a few options, I remembered about the telegram bots that may well be appropriate to do something similar in the text version, for example, you write the bot <b>"/ open chrome"</b> and you have Chrome on your computer. <br><a name="habracut"></a><br><h2>  What do we need? </h2><br>  I will write a bot in Python and I will use the following libraries: flask, pyngrok, requests, win32com.client, os, subprocess.  Further in the article I will tell why what library we need.  We also need a Telegram on the phone, tablet, or even on another computer.  And we also need a telegram bot to which we will write how you can create it yourself, because there are already enough such articles on Habr√©! <br><br><h2>  How will it all work? </h2><br>  When we write to our bot, it will send a post-request with data about the message and about the user who sent it to our url address, after which our python script depending on the text will perform certain actions such as launching applications, entering text or even shutdown computer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Implementation </h2><br>  First, create our python file, which I‚Äôll call main.py, import all the libraries we need (but first you need to install them via pip): <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask, request <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyngrok <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ngrok <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> subprocess <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> win32com.client</code> </pre> <br>  Now, to receive requests from the bot, we need to start Flask and then start Pyngrok to access our site not only on the local network: <br><br><pre> <code class="python hljs">app = Flask(__name__) <span class="hljs-comment"><span class="hljs-comment"># flask ngrok_url = ngrok.connect(port=5000).replace('http','https') # ngrok</span></span></code> </pre><br>  Now we‚Äôll do the bot setup - we‚Äôll make the requests come to our server: <br><br><pre> <code class="python hljs">token = <span class="hljs-string"><span class="hljs-string">'token       BotFather'</span></span> <span class="hljs-comment"><span class="hljs-comment">#token  URL = 'https://api.telegram.org/bot'+token+'/' requests.get(URL+'setWebhook?url='+ngrok_url) # url  webhook   shell = win32com.client.Dispatch("WScript.Shell") #        </span></span></code> </pre><br>  Let's create a function so that the bot can respond to our messages: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(chat_id,text)</span></span></span><span class="hljs-function">:</span></span> url = URL+<span class="hljs-string"><span class="hljs-string">"sendMessage?chat_id="</span></span>+str(chat_id)+<span class="hljs-string"><span class="hljs-string">"&amp;text="</span></span>+str(text) requests.get(url)</code> </pre><br>  Now go to the function that will process the messages from the bot and execute the commands: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@app.route('/', methods=['POST','GET']) #          index def index(): if request.method=='POST': #   post  r = request.get_json() # json chat_id = r["message"]["chat"]["id"] #   id      username = r["message"]["from"]["username"] # username     text = r["message"]["text"] #   msg = text.split() #       cmd = msg[0] #    l = len(msg) #  if username==' username': #     if cmd=='/cmd' and l&gt;1: #  /cmd proc = subprocess.Popen(text[5:], shell=True, stdout=subprocess.PIPE).communicate() #      /cmd sendMessage(chat_id, proc[0].decode('cp866')) #     Telegram elif cmd=='/ntp': #  /ntp os.system('notepad.exe') #  elif cmd=='/off': #  /off os.system('shutdown -p') #  elif cmd=='/p': #  /p shell.SendKeys(text[3:]) #      return 'Hello World!' # -   ngrok_url    </span></span></code> </pre><br>  And you need to add a few lines in order for Flask to start working: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__==<span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: app.run()</code> </pre><br><h2>  A few more words from the author </h2><br>  Perhaps this script will not be able to completely replace computer management, but you can come up with a lot of commands from turning on the music and running your development environment.  Thank you all for reading this!  If you have any problems or have any questions, write in the comments, and I have it all! </div><p>Source: <a href="https://habr.com/ru/post/450524/">https://habr.com/ru/post/450524/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../4505/index.html">Tut.By demonstrates Internet censorship in Belarusian</a></li>
<li><a href="../450506/index.html">How to make an application out of the site and put it on Google Play in a few hours. Part 2/2: Trusted Web Activity</a></li>
<li><a href="../450518/index.html">Arduino and Processing. How to control the microcontroller on the COM port. Bilateral communication</a></li>
<li><a href="../450520/index.html">Creating a reliable and verifiable AI: Compliance with specifications, reliable training and formal verification</a></li>
<li><a href="../450522/index.html">Internet history: decay, part 1</a></li>
<li><a href="../450530/index.html">What's new in the cloud: 15 materials on standards, tools and regulation</a></li>
<li><a href="../450532/index.html">How I became PMP and how it is better not to do</a></li>
<li><a href="../45054/index.html">USB flash drive with eSATA</a></li>
<li><a href="../450546/index.html">The speaking prefix to the washing machine which is not breaking a guarantee</a></li>
<li><a href="../450548/index.html">‚ÄúIsolation of the Runet‚Äù or ‚ÄúSovereign Internet‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>