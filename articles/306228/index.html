<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Migrating and deploying SharePoint 2013 workflows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When developing SharePoint solutions, you must be able to migrate workflows both within the farm and from one SharePoint farm to another. A typical sc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Migrating and deploying SharePoint 2013 workflows</h1><div class="post__text post__text-html js-mediator-article">  When developing SharePoint solutions, you must be able to migrate workflows both within the farm and from one SharePoint farm to another.  A typical scenario is the transfer to a production environment of a workflow created in a test environment. <br><br>  Consider various approaches to solving this problem. <br><a name="habracut"></a><br><h3>  Workflow Development in Visual Studio </h3><br>  This option places workflows in SharePoint solution files (* .wsp).  This approach provides greater flexibility and ability to configure workflows, but in some cases using solutions like the Farm Solution can be unsafe in terms of the health and performance of the SharePoint farm. <br>  Details on the development of workflows in Visual Studio can be found <a href="https://msdn.microsoft.com/ru-ru/library/office/jj163199.aspx">here</a> . <br><br><h3>  Create a package containing a workflow in SharePoint Designer 2013 </h3><br>  The SharePoint Designer 2013 tool provides the ability to save a workflow to a template file.  Saving a workflow to a template file is called a workflow packaging.  The resulting template file can be imported to the target SharePoint server, eliminating the need to re-develop the workflow on the target server.  Keep in mind the restrictions on the types of workflows that can be exported as a template: <br><ul><li>  All types of workflows of the SharePoint Workflow 2013 platform </li><li>  Only reusable workflows of the SharePoint Workflow 2010 platform. </li></ul><br>  Since we do not plan to use an outdated model of workflows, this restriction is not fundamental for us.  However, the resulting template file is the same * .wsp solution package as the package generated by Visual Studio, which means this approach has the same drawbacks as the previous one, if you deploy the packaged workflow directly. <br>  Instead of direct deployment, we will use a template file to extract the metadata (workflow.xaml file) describing the workflow.  We will be able to use this metadata to deploy the workflow using the alternatives described below. <br><div class="spoiler">  <b class="spoiler_title">Export workflow.xaml using SharePoint Designer</b> <div class="spoiler_text"><ol><li>  Use SharePoint Designer to open the site where the workflow to be migrated is deployed. </li><li>  In the Site Objects sidebar, select the Workflows menu item. </li><li>  Select the desired workflow in the list and click on the ‚ÄúSave As Template‚Äù ribbon item located in the ‚ÄúManagement‚Äù group.  The message: "The template is saved in the library" Site Assets ".". </li><li>  Select the menu item "All files" in the sidebar "Site Objects".  In the list in the main viewing area, select an item named ‚ÄúSite Assets‚Äù.  Press F5 to refresh the view. </li><li>  Select the item named "&lt;workflow name&gt; .wsp" and click on the "File Export" tape item located in the "Manage" group.  Select the path to save the file. </li><li>  Open in Explorer (or another file manager) the folder where the * .wsp file was saved.  Rename the file by changing the extension from ‚Äúwsp‚Äù to ‚Äúcab‚Äù. </li><li>  Open the file after renaming.  Extract the file ‚Äúworkflow.xaml‚Äù from the contents of the archive.  This can be done by simply dragging and dropping the file into the directory for extraction. </li></ol><br></div></div><br><h3>  Using Provision Frameworks </h3><br>  Typical tasks associated with the migration and deployment of SharePoint development artifacts have led the developer community to create convenient tools for automating them.  One such tool is the <a href="http://docs.subpointsolutions.com/spmeta2/">SPMeta2</a> framework.  It is a powerful tool for solving the deployment of SharePoint development artifacts, allowing you to use C # code writing instead of declarative description (XML).  SPMeta2 supports many <a href="http://docs.subpointsolutions.com/spmeta2/scenarios/">work scenarios</a> , including workflow scenarios. <br>  The disadvantages of deploying through the framework include the need to create a separate project to use it even in simple cases where you can get by with PowerShell scripts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Migrating workflows using PowerShell scripts </h3><br>  The PowerShell command console allows you to solve an extensive class of tasks related to the administration of SharePoint.  Moreover: some tasks can be solved exclusively with the help of this tool. <br><br>  To transfer the workflows of the list, a PowerShell script has been developed, accessible by <a href="">reference</a> .  The script uses the object of the <a href="https://msdn.microsoft.com/en-us/library/microsoft.sharepoint.workflowservices.workflowservicesmanager.aspx">WorkflowServicesManager</a> class to perform operations on workflows. <br><br>  To deploy a workflow using a script, you need to get the file <i>workflow.xaml</i> , which contains a description of the workflow.  Above, we described a method for obtaining a <i>workflow.xml</i> file using SharePoint Designer.  However, it is easier to do this using the <b>ExtractWorkflowXaml</b> function defined in the script.  Function parameters: <br><table><tbody><tr><th>  Parameter </th><th>  Description </th></tr><tr><td>  $ url </td><td>  The URL of the node associated with the Workflow service that contains the workflow </td></tr><tr><td>  $ wf_displayname </td><td>  Workflow Name </td></tr><tr><td>  $ workflow_xaml_path </td><td>  File path to save </td></tr></tbody></table><br>  Example of using the function: <br> <code>ExtractWorkflowXaml "http://mysp.com/source" "Test workflow" "C:\spmetadata\workflow.xaml" <br></code> <br>  To deploy a workflow, you must call the <b>DeployListWorkflow</b> function.  Function parameters: <br><table><tbody><tr><th>  Parameter </th><th>  Description </th></tr><tr><td>  $ workflow_xaml </td><td>  Path to the .xaml file </td></tr><tr><td>  $ url </td><td>  URL of the node associated with the Workflow service for which you want to create a workflow </td></tr><tr><td>  $ list_name </td><td>  The name of the list with which the workflow should be associated. </td></tr><tr><td>  $ wf_displayname </td><td>  Workflow Name </td></tr><tr><td>  $ overwrite </td><td>  Sign of the need to rewrite the workflow definition if it already exists </td></tr></tbody></table><br>  Example of using the function: <br> <code>DeployListWorkflow "C:\spmetadata\workflow.xaml" "http://mysp.com/sandbox" "Test Workflow List" "My New Workflow" $true <br></code> <br>  Migrating workflows using PowerShell scripts allows you to accomplish a task without using third-party tools. <br>  <b>Advantages of this solution:</b> <br><ul><li>  You do not need to create a project in Visual Studio and write code that calls the framework for deployment, simply calling the function of the PowerShell script. </li><li>  Ability to extract workflow metadata by simply calling the functions of the PowerShell script. </li><li>  Logging actions during the deployment process makes it easy to localize and fix the error. </li></ul><br>  <b>Cons of this solution:</b> <br><ul><li>  The script uses the SharePoint Server Object Model (SSOM), which means it must run on the server in the SharePoint farm.  The script needs to be modified for the script to work using the client object model. </li><li>  The script adjusts only the basic attributes of the workflow necessary for its operation.  To work with additional attributes, the script needs to be modified. </li><li>  In the current version, the script is designed to expand the workflow list.  To work with other types of workflows, script modification is required. </li></ul><br>  The script is made the most simple in order to demonstrate the ability to deploy workflows through PowerShell.  In the future we plan to expand the functionality of the described script. <br><habracut></habracut></div><p>Source: <a href="https://habr.com/ru/post/306228/">https://habr.com/ru/post/306228/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../306214/index.html">What are behavior trees and how are they used?</a></li>
<li><a href="../306216/index.html">‚ÄúThe Sun hasn't Set yet‚Äù: Is it worth forcing programmers to work 80 hours a week</a></li>
<li><a href="../306218/index.html">Laser communications on the example of Facebook technologies</a></li>
<li><a href="../306220/index.html">Machine Learning: Potential and Opportunities</a></li>
<li><a href="../306222/index.html">Minimal "hello world" telegram bot</a></li>
<li><a href="../306230/index.html">Lync SDK 2013. Experience in developing your own Lync-based instant messenger (Skype for Business)</a></li>
<li><a href="../306234/index.html">Stackoverflow launches Documentation section</a></li>
<li><a href="../306236/index.html">How to set up an extensible system for regression testing on phones: the experience of mobile Mail.Ru Mail</a></li>
<li><a href="../306238/index.html">5 cool things in the processes of the American company</a></li>
<li><a href="../306240/index.html">Mobile Help: Aruba Mobile Engagement</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>