<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Query optimization in SQLite. Use rowid</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During the recent optimization of database queries, I came across a description of how SQLite works with rowid. In short: each table has an int64 rowi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Query optimization in SQLite. Use rowid</h1><div class="post__text post__text-html js-mediator-article">  During the recent optimization of database queries, I came across a description of how SQLite works with rowid.  In short: each table has an int64 rowid column, the value of which is unique for each record in the table.  You can see the value by the name ‚Äúrowid‚Äù and it is not shown in the query *. <br><br>  Records are stored as B-tree by rowid.  And it makes a very fast search and selection by rowid.  Two times faster than the primary key or indexed field.  As I understand it, a search on an indexed column is a search on a B-tree, as a result of which we find a rowid.  And already having rowid - we look for the necessary record. <br><br>  This begs the obvious question: how to make the rowid and our PRIMARY KEY match? <a name="habracut"></a>  It's very simple, maybe they already coincide with you, but you do not know about it.  :) It is enough to declare your PRIMARY KEY field in one of the following ways: <br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> t(x <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span> PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span>, y, z); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> t(x <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span>, y, z, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>(x <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> t(x <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span>, y, z, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>(x <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>));</code> </pre> <br>  There are cases when logic dictates that PRIMARY KEY and rowid should match, and this is not the case.  For example: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> t(x <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span> PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>, y, z); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> t(x <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>, y, z);</code> </pre><br>  The second case is especially interesting, since  INT is considered an alias for INTEGER and the behavior must be the same, but it was not there.  I'm on this error and got caught.  :) If you started to doubt if you have the same PRIMARY KEY and rowid values, you can just check this: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rowid</span></span>, x <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> t;</code> </pre><br>  SQLite in column names will write x, x (2), i.e.  instead of rowid, the name of the column with which rowid is associated will be specified.  Values, if any, in the table will be the same for these columns.  Another thing to mention is that if there is already a column in the table with the name ‚Äúrowid‚Äù - this does not guarantee associations, you simply lose the ability to query the value of the system column rowid. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Nice optimization. </div><p>Source: <a href="https://habr.com/ru/post/160861/">https://habr.com/ru/post/160861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../160849/index.html">Yandex.Amnestia</a></li>
<li><a href="../160851/index.html">Convert menu to drop-down list on small screens</a></li>
<li><a href="../160853/index.html">Angry Citizen</a></li>
<li><a href="../160855/index.html">6400mAh High Capacity Battery for Samsung Galaxy Note II [HLI-N7100XL]</a></li>
<li><a href="../160859/index.html">Friday post good: good Samsung affairs in Brazil and Vietnam</a></li>
<li><a href="../160863/index.html">Project Engineer's Diaries: challenge accepted!</a></li>
<li><a href="../160865/index.html">Microsoft added 121 terabytes of satellite and aerial images to Bing Maps</a></li>
<li><a href="../160867/index.html">The Living Dead Skinvertizing</a></li>
<li><a href="../160869/index.html">About two-dimensional packaging: online algorithms</a></li>
<li><a href="../160871/index.html">Do I need to study at university?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>