<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The Basics of Native Extension in Java for AIR</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello dear habrachiteli. My story as you can see from the title of the theme will go about the basis and features of creating an adobe native extensio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The Basics of Native Extension in Java for AIR</h1><div class="post__text post__text-html js-mediator-article">  Hello dear habrachiteli.  My story as you can see from the title of the theme will go about the basis and features of creating an adobe native extension (hereinafter ANE) for Adobe AIR, in my case I will write extensions in java, to extend the functionality of AIR, on the Android platform.  And so with your permission begin. <br><br><h4>  Introduction </h4><br>  What is ANE?  This tool, which appeared with Adobe AIR 3.0 and higher, allows you to extract and execute pieces of native code from the AIR environment, conditionally we can run any native code.  The extension looks like a compiled library file with the extension .ane. <br><br><a name="habracut"></a><br><h4>  What you need to work </h4><br>  To get started, we need: <br>  1. As IDE Eclipse. <br>  2. Flash Builder 4.6 plugin <br>  3. ADT plugin. <br>  4. Adobe AIR SDK. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How to start all this and write the code I will not explain because this topic goes beyond the limits of this article, by default the article assumes that you have all these subtleties .. <br><br><h4>  About programming extensions to JAVA. </h4><br>  First, let's create an Android project, having previously marked it as a library and most importantly, let's not forget the name of the package, this name will be described in the extension description file a little later. <br>  The main extension class essentially implements the FREExtension interface ... this interface, like many other classes, comes from a separate library from adobe, where do we find this library?  It can be found inside the AIR SDK, at lib / android /.  Libraries are called FlashRuntimeExtensions with jar and so extensions.  We write on java according to this we need a jar, take our library and connect it to our project.  And so let's create the main class of our extension, it should have the following structure: <br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> FREContext </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createContext</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String arg0)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispose</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br><br>  As we can see, the structure of our class is pretty simple, three mandatory methods, with the dispose and initialize methods, I think, and so everything is clearly invoked during initialization and destruction of the extension.  The createContext method is interesting.  Conventionally, an extension has its own context that will describe the functionality of our extension, as we understand the class of our future context should extend the FREContext class.  Let's create a class of our context, the class should have the following structure: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Map&lt;String, FREFunction&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFunctions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispose</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre><br><br>  Here you should pay attention to the getFunctions () method.  In essence, this method returns the maps, the key of which is the name of the method that we use when calling from as3, and the value is the function that implements the FREFunction interface, in which all the functionality of the called method of our extension is enclosed.  The function class should have the following structure: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> FREObject </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FREContext context, FREObject[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre><br><br>  As you can see here we have only one mandatory method.  Access to the activity of the current application can be obtained through an instance of the FREContext class, which we receive as a parameter in our function, using the completely logical getActivity () method and having a native Androdovsk activity one can do with it everything your heart desires.  Also, an instance of the FREContext class has the dispatchStatusEventAsync method, which allows you to make a callback in as3, the results of which can be heard by using the StatusEvent.STATUS event.  The second parameter of the method is an array of FREObject classes, these are all parameters that will be passed to our context from as3.  An instance of the FREObject class has a set of methods for converting to the corresponding data type. <br>  This concludes the java part and proceeds to as3. <br><br><h4>  About programming extensions on AS3. </h4><br>  To create a library, let's create a Flex library project, while not forgetting to import the AIR classes, and the class package must be identical to the one in java. <br>  The main class on as3 can extend anything, just create a class and in it create an instance of the ExtensionContext class, it is created as follows: <br><br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> extContext:ExtensionContext = ExtensionContext.createExtensionContext(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>);</code> </pre><br><br>  now we have an instance of the context of our extension, you can listen to it as we wrote above, as follows <br><pre> <code class="actionscript hljs">extContext.addEventListener(StatusEvent.STATUS, onStatus);</code> </pre><br><br>  You can also call the method we described in the context in java as follows: <br><pre> <code class="actionscript hljs">extContext.call(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, ...<span class="hljs-string"><span class="hljs-string">"    )</span></span></code> </pre><br><br>  Everything is quite simple, now let's try to collect our ane. <br><br><h4>  Build ane. </h4><br>  And so, after all our labors, we should have swc from our flex project and jar from our android project. <br>  Let's create a separate directory, and inside it we will organize the following hierarchy: <br><br><img src="https://habrastorage.org/storage2/a13/2e9/47c/a132e947cbd37050f05f35b2cebc7962.png"><br><br>  Inside the android folder should be our jar library, in cases if you are developing ane for ios or something else like that, the directory should correspond to its name.  Another important one before compiling is to pull out the library.swf file from the swc library (open your swc file with help, for example, the winrar archiver) and drop it into each directory.  Approximately the android directory will have two files and look like this: <br><br><img src="https://habrastorage.org/storage2/018/351/5c2/0183515c2f0d8935cabbbcb8128e066d.png"><br><br>  And the default directory will contain only the library.swf file. <br>  Now we need to describe our extension in the descriptor of this file extension.xml, in our case it will look something like this: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extension</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://ns.adobe.com/air/extension/3.1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">versionNumber</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">versionNumber</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">platforms</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">platform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Android-ARM"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">applicationDeployment</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nativeLibrary</span></span></span><span class="hljs-tag">&gt;</span></span>test.jar<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nativeLibrary</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">initializer</span></span></span><span class="hljs-tag">&gt;</span></span>      java  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">initializer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">applicationDeployment</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">platform</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">platform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">applicationDeployment</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">platform</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">platforms</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extension</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Well, now everything is almost ready for us. It‚Äôs just left to build our library, for this we execute from the console (do not forget to set the path to the Adobe AIR binaries in the environment variables): <br><br><pre> <code class="bash hljs">adt -package -target ane extension.ane extension.xml -swc test.swc -platform Android-ARM -C android . -platform default -C default .</code> </pre><br><br>  Where extension.ane is our ane to be created, and test.swc is our flex library.  You will end up with an ane file that you can use. <br><br>  On this, I guess I'll finish with the basics.  Thank you for your time and patience, and if anyone is interested, wait for the continuation. </div><p>Source: <a href="https://habr.com/ru/post/176767/">https://habr.com/ru/post/176767/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../176749/index.html">Programmatic placement of coefficients in chemical equations</a></li>
<li><a href="../176751/index.html">Nontrivial task with callback + DID in Asterisk</a></li>
<li><a href="../176759/index.html">Small storage for small files</a></li>
<li><a href="../176763/index.html">Class methods in ruby</a></li>
<li><a href="../176765/index.html">A brief introduction to the MOAI Framework</a></li>
<li><a href="../176769/index.html">Live broadcast: a practical course on the font. Lecture cycle. Lecture number 2</a></li>
<li><a href="../176771/index.html">Terevaka - a high level framework on Lua for mobile platforms</a></li>
<li><a href="../176775/index.html">The meaning and quality of life of the programmer</a></li>
<li><a href="../176779/index.html">Esboza - vector editor online & framework (Part Two)</a></li>
<li><a href="../176785/index.html">A simple client for tracking habr / freelance for OS X</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>