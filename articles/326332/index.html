<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Results of the first round of the Russian Code Cup 2017</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Sword of Midnight by Mischeviouslittleelf 


 On April 2, the first qualifying round of the Russian Code Cup 2017 was held , at which attendance r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Results of the first round of the Russian Code Cup 2017</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/316/2e3/18e/3162e318e625415e94de7d950bc116b1.jpg" alt="image"><br>  <a href="http://mischeviouslittleelf.deviantart.com/art/The-Sword-of-Midnight-447614715">The Sword of Midnight</a> by Mischeviouslittleelf </p><br><p>  On April 2, the first qualifying round of the <a href="http://www.russiancodecup.ru/ru/">Russian Code Cup 2017 was held</a> , at which attendance records for the past three years were broken.  We offer you a few figures and analysis of the tasks of the round: </p><br><p>  A. <a href="https://habr.com/ru/company/mailru/blog/326332/">Martian Volleyball</a> <br>  B. <a href="https://habr.com/ru/company/mailru/blog/326332/">Coloring the wall</a> <br>  C. <a href="https://habr.com/ru/company/mailru/blog/326332/">Magic artifact</a> <br>  D. <a href="https://habr.com/ru/company/mailru/blog/326332/">Memory Manager</a> <br>  E. <a href="https://habr.com/ru/company/mailru/blog/326332/">FOX</a> </p><br><p>  4552 participants registered for the round, of which 1001 are newcomers who discovered RCC for themselves only this year.  This time there were twice as many active participants as in 2015 and 2016!  A total of 6586 solutions were sent to us.  As usual, the most popular is C ++ in different variations (2346 solutions - C ++ 14, 1425 on the pluses of the 11th version and approximately 500 solutions from GNU C ++ 6.2 and Visual C ++ 2013).  The second most popular place is Java 8.0 (649), and the third is Python (402 in Python 3.5 + 60 solutions based on PyPy 2.4.0).  The most unpopular for sports programming were Perl, D and Haskell (the latter wrote exactly one solution for the whole round).  A list of all the languages ‚Äã‚Äãwe support can be found <a href="http://www.russiancodecup.ru/ru/rules/">here</a> . </p><a name="habracut"></a><br><p>  Following the results of the round, 200 participants passed the qualification and got into the qualifying round, which will be held on May 14.  But only eight of them solved all five tasks.  You can see the general results <a href="http://www.russiancodecup.ru/ru/championship/result/61/">here</a> , but we will list those five who seriously broke away from the rest of the top in terms of the accumulated penalty time: </p><br><ol><li>  Evgeny Kapun, St. Petersburg </li><li>  Stanislav Ershov, St. Petersburg </li><li>  Petr Mitrichev, Zurich, Switzerland </li><li>  Makoto Soejima, Tokyo, Japan </li><li>  Maxim Finyutin, Tolyatti </li></ol><br><p>  We congratulate all qualified.  We wish everyone else good luck in the second qualifying round, which will take place this Sunday, April 16, <a href="https://www.timeanddate.com/worldclock/fixedtime.html%3Fmsg%3DRussian%2BCode%2BCup%2BQual%2B2%26iso%3D20170416T12%26p1%3D166%26ah%3D2">from 12:00 to 14:00</a> Moscow time. </p><br><h2 id="a-marsianskiy-voleybol">  A. Martian Volleyball </h2><br><p>  Time limit - 2 seconds <br>  Memory limit - 256 megabytes </p><br><p>  A volleyball match on Mars is played by two teams with up to <em>k</em> points, while at the same time there should be at least 2 points for winning.  For each ball, one of the teams gets exactly 1 point. </p><br><p>  For the current match, the score of the first team is <em>x</em> , and the score of the second team is <em>y</em> .  What is the minimum number of balls to be played before the end of the match? </p><br><p>  <strong>Input data</strong> </p><br><p>  The input contains several test cases.  The first line contains the number of tests <em>t</em> (1 ‚â§ <em>t</em> ‚â§ 5000). </p><br><p>  Each test case is described in one line containing three integers separated by spaces: <em>k</em> , <em>x</em> and <em>y</em> (1 ‚â§ <em>k</em> ‚â§ 100; 0 ‚â§ <em>x</em> , <em>y</em> ‚â§ 100). </p><br><p>  It is guaranteed that the score could be obtained with the correct unfinished game. </p><br><p>  <strong>Output</strong> </p><br><p>  For each test in a separate line print the answer to it - the minimum number of balls that will be played before the end of the match. </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  The first observation that needs to be made: to minimize the duration of the game, only the team with the highest score should receive points.  Consider the condition of victory of one of the teams.  It is necessary to score at least <em>k</em> points and overtake the losing team by at least 2 points. </p><br><p>  The final answer is <em>max</em> ( <em>k</em> , <em>min</em> ( <em>x</em> , <em>y</em> ) + 2) - <em>max</em> ( <em>x</em> , <em>y</em> ). </p></div></div><br><h2 id="b-raskraska-steny">  B. Coloring the wall </h2><br><p>  Time limit - 2 seconds <br>  Memory limit - 256 megabytes </p><br><p>  Girl Masha looks at the wall in her room.  The wall is lined with square tiles, but lamps have been installed in place of some tiles.  Thus, one can imagine that the wall is a checkered rectangle of size <em>n</em> √ó <em>m</em> , in some cells of which there are lamps. </p><br><p>  Masha has paints of <em>k</em> different colors.  Masha wants to paint all the tiles on the wall so that on any vertical or horizontal piece of tiles, bounded at each end by the edge of the wall or lamp, the colors do not repeat.  At the same time, Masha‚Äôs lamps, without a trace, will not be painted.  Masha does not need to use all the colors. </p><br><p>  Masha asks you to figure out how to paint the wall. </p><br><p>  <strong>Input data</strong> </p><br><p>  The input contains several test cases.  The first line contains the number of tests <em>t</em> . </p><br><p>  Each of the tests is described as follows: the first line of the test description contains three numbers <em>n</em> , <em>m</em> , <em>k</em> (1 ‚â§ <em>n</em> , <em>m</em> ‚â§ 100, 1 ‚â§ <em>k</em> ‚â§ <em>max</em> ( <em>n</em> , <em>m</em> )) - the dimensions of the wall and the number of different colors of Masha. </p><br><p>  The following n lines contain <em>m</em> numbers <em>a <sub>ij</sub></em> each: </p><br><ul><li>  <em>a <sub>ij</sub></em> = 0 if the lamp is in position ( <em>i</em> , <em>j</em> ); </li><li>  <em>a <sub>ij</sub></em> = 1 if the tile is in position ( <em>i</em> , <em>j</em> ). </li></ul><br><p>  The total number of tiles and lamps for all tests does not exceed 10 <sup>5</sup> . </p><br><p>  <strong>Output</strong> </p><br><p>  For each test in a separate line, first print the answer to it: </p><br><ul><li>  NO, if there is no way to paint the wall as Masha wants. </li><li>  YES, if there is a way to repaint.  In this case, in the next <em>n</em> lines output <em>m</em> numbers <em>b <sub>ij</sub></em> - the color of the tile at position ( <em>i</em> , <em>j</em> ) or 0, if the lamp is at this position.  If there are several suitable colorings, output any of them. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  To solve the problem, find out how many minimum colors are needed for the conditions to be fulfilled.  To do this, we find the longest continuous segment of tiles vertically or horizontally.  Let the length of this segment be <em>L.</em> </p><br><p>  Then we represent the square <em>L</em> √ó <em>L</em> , where the first line is a sequence of numbers from 1 to <em>L</em> , and each next one is obtained by cyclic shift of the previous one by one to the right.  We square our original rectangle with such squares, throwing away the excess and not forgetting about the lamps.  For example, if <em>L</em> = 4, the paving will start like this: </p><br><p>  1 2 3 4 1 2 3 4 1 2 <br>  2 3 4 1 2 3 4 1 2 3 <br>  3 4 1 2 3 4 1 2 3 4 <br>  ... </p><br><p>  This tiling will satisfy the condition of the problem, since for any horizontal and vertical segment of length <em>L it is</em> satisfied that all colors are different in it, which means that for smaller lengths too. </p><br><p>  If Masha has less flowers than <em>L</em> , then there is no answer. </p></div></div><br><h2 id="c-magicheskiy-artefakt">  C. Magic artifact </h2><br><p>  Time limit - 2 seconds <br>  Memory limit - 256 megabytes </p><br><p>  Maxim is playing a computer game.  It consists of <em>n</em> levels, which are numbered from 1 to <em>n</em> .  They can be passed in any order, for <em>i-</em> th level Maxim spends <em>a <sub>i</sub></em> seconds. </p><br><p>  In addition, Maxim can find a magical artifact that will strengthen his character.  There is exactly one artifact in the game, and its location is unknown for sure - on the <em>i-</em> th level it is with probability <em>p <sub>i</sub></em> .  After receiving the artifact, it becomes much easier to play - with him, Maxim passes the <em>i-</em> th level in <em>b <sub>i</sub></em> seconds ( <em>b <sub>i</sub></em> ‚â§ <em>a <sub>i</sub></em> ).  Please note that the artifact does not work at the level at which Maxim found it. </p><br><p>  Maxim wants to complete levels in such a way as to minimize the expectation of playing time.  Help him figure out what minimum expectation he can achieve by choosing a certain order of passing levels.  Maxim chooses the order of levels in advance; this order should not depend on what level the artifact will be on. </p><br><p>  The mathematical expectation of a random variable is the sum over all possible outcomes of the product of the probability of this outcome by the value of the quantity.  In this case, the outcomes correspond to what level the artifact will be at, and the magnitude of the value will indicate the transit time if the artifact is on this level, and Maxim passes the levels in the chosen order. </p><br><p>  <strong>Input data</strong> </p><br><p>  The input contains several test cases.  The first line contains one number <em>t</em> - the number of tests (1 ‚â§ <em>t</em> ‚â§ 1000). </p><br><p>  Each of the tests is described as follows: the first line contains the number <em>n</em> - the number of levels (1 ‚â§ <em>n</em> ‚â§ 10 <sup>5</sup> ). </p><br><p>  The following <em>n</em> lines describe the levels.  Each of them is given by three integers: <em>a <sub>i</sub></em> , <em>b <sub>i</sub></em> , <em>x <sub>i</sub></em> is the time it takes for the level to pass before and after finding the artifact and the value that helps to calculate the probability of finding the artifact at that level.  The probability is calculated by the formula <em>p <sub>i</sub></em> = <em>x <sub>i</sub></em> / 10 <sup>7</sup> (1 ‚â§ <em>b <sub>i</sub></em> ‚â§ <em>a <sub>i</sub></em> ‚â§ 10 <sup>5</sup> ; 0 ‚â§ <em>x <sub>i</sub></em> ‚â§ 10 <sup>7</sup> ; the sum of all <em>x <sub>i</sub></em> is equal to 10 <sup>7</sup> ). </p><br><p>  The sum <em>n</em> for all tests does not exceed 5 ¬∑ 10 <sup>5</sup> . </p><br><p>  <strong>Output</strong> </p><br><p>  For each test, output one number - the expected time of the game with the optimal choice of the order of passing levels.  The answer will be considered correct if its absolute or relative error does not exceed 10 <sup>- 6</sup> . </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  Let us designate as <em>c <sub>i the</sub></em> time gain that Maxim receives from the artifact at the <em>i</em> -th level: <em>c <sub>i</sub></em> = <em>a <sub>i</sub></em> - <em>b <sub>i</sub></em> . </p><br><p>  Let the levels be passed in the order 1, 2, ..., <em>n</em> .  If the artifact was found at the <em>i</em> -th level, the travel time is equal to the sum of the values ‚Äã‚Äãof <em>b <sub>j</sub></em> plus <em>c <sub>1</sub></em> + ... + <em>c <sub>i</sub></em> .  Then the expectation of the passage time is: <br>  <em>b <sub>1</sub></em> + ... + <em>b <sub>n</sub></em> + <em>p <sub>1</sub></em> ¬∑ <em>c <sub>1</sub></em> + <em>p <sub>2</sub></em> ¬∑ ( <em>c <sub>1</sub></em> + <em>c <sub>2</sub></em> ) + ... + <em>p <sub>n</sub></em> ¬∑ ( <em>c <sub>1</sub></em> + ... + <em>c <sub>n</sub></em> ). </p><br><p>  <em>b <sub>1</sub></em> + ... + <em>b <sub>n</sub></em> does not depend on the order of the levels, so we will strive to reduce the remaining amount.  If you open the brackets, you can see that it is equal to the sum <em>c <sub>i</sub></em> ¬∑ <em>p <sub>k</sub></em> over all pairs <em>i</em> , <em>k</em> , such that <em>i</em> ‚â§ <em>k</em> . </p><br><p>  Let's see how the sum changes if you swap levels of <em>i</em> and <em>i</em> + 1. Among the terms <em>c <sub>i</sub></em> ¬∑ <em>p <sub>k,</sub></em> only <em>c <sub>i</sub></em> ¬∑ <em>p <sub>i</sub></em> + 1 changes - it changes to <em>c <sub>i</sub></em> + 1 ¬∑ <em>p <sub>i</sub></em> .  If the order of the levels is optimal, then <em>c <sub>i</sub></em> ¬∑ <em>p <sub>i</sub></em> + 1 ‚â§ <em>c <sub>i</sub></em> + 1 ¬∑ <em>p <sub>i</sub></em> (otherwise they could be swapped and improved the answer).  Let's transform this inequality: <br>  <em>c <sub>i</sub></em> / <em>p <sub>i</sub></em> ‚â§ <em>c <sub>i</sub></em> + 1 / <em>p <sub>i</sub></em> + 1. </p><br><p>  In the optimal answer for all <em>i</em> from 1 to <em>n</em> - 1, this inequality is true.  Hence, in the optimal answer, the levels are sorted by <em>c <sub>i</sub></em> / <em>p <sub>i</sub></em> , and in order to get it, you need to sort them.  Note that if <em>p <sub>i</sub></em> = 0, then we can assume that <em>c <sub>i</sub></em> / <em>p <sub>i</sub></em> = ‚àû. </p><br><p>  Sort by <em>c <sub>i</sub></em> / <em>p <sub>i</sub></em> must be careful.  If you make a division in floating-point numbers, then in the case when <em>c <sub>i</sub></em> = <em>p <sub>i</sub></em> = 0, you get <em>NaN</em> , which will lead to an error.  If we compare fractions <em>c <sub>i</sub></em> / <em>p <sub>i</sub></em> and <em>c <sub>k</sub></em> / <em>p <sub>k</sub></em> using the comparator <em>c <sub>i</sub></em> ¬∑ <em>p <sub>k</sub></em> &lt; <em>c <sub>k</sub></em> ¬∑ <em>p <sub>i</sub></em> , then in the case when <em>c <sub>i</sub></em> = <em>p <sub>i</sub></em> = 0, the result will always be <em>false</em> , which will also lead to wrong sorting.  Therefore, the levels with <em>c <sub>i</sub></em> = <em>p <sub>i</sub></em> = 0 need to be processed separately.  These levels can be completed at any time: it is easy to see that they do not contribute anything to the answer, except for the fixed terms <em>b <sub>i</sub></em> .  They can be placed, for example, at the very end. </p><br><p>  After sorting you need to calculate the desired expected value.  It is calculated using the above formula using the prefix sums <em>c <sub>i</sub></em> . </p></div></div><br><h2 id="d-menedzher-pamyati">  D. Memory Manager </h2><br><p>  Time limit - 3 seconds <br>  Memory limit - 256 megabytes </p><br><p>  Petya is actively developing his own MEM 2.0 memory manager for storage based on 7D magnetic blocks.  However, he was faced with the problem of optimal delivery of data from the repository to users. </p><br><p> In total, the Petit Manager stores <em>n</em> blocks with data numbered from 1 to <em>n</em> , and there are <em>q</em> requests for issuing data from one or more of them.  Requests must be processed in the order in which they arrived. </p><br><p>  Petya has <em>k</em> pointers for outputting data, each of which points to one of the blocks.  Initially, Peter can put pointers to any set of blocks. </p><br><p>  Petin manager can instantly output data from any number of blocks, if at least one pointer points to each of them.  If this is not the case, the manager first rearranges the pointers so that the condition is fulfilled, and then gives the data ‚Äî the execution time for this <em>i-</em> th query is <em>s <sub>i</sub></em> milliseconds, you can rearrange any number of pointers. </p><br><p>  Petya wants to implement the pointer relocation in the manager so that the total response time to all user requests is minimal.  Requests must be processed in the order in which they are received; requests cannot be interchanged.  Help him. </p><br><p>  Consider the tests given in the example. </p><br><p>  In the first test, Petya initially can put pointers to blocks 1, 2 and 4 - after that, the first two requests will be executed instantly.  Before the third request for <em>s <sub>3</sub></em> = 1 millisecond, he can put pointers to blocks 2, 3 and 5, and before the fourth request for <em>s <sub>4</sub></em> = 1 millisecond he can put pointers to blocks 1, 3 and 5. The total time for all requests will be <em>s <sub>3</sub></em> + <em>s <sub>4</sub></em> = 2 milliseconds. </p><br><p>  In the second test, Petya is unprofitable to execute the first two queries instantly (putting pointers to blocks 1, 2 and 4 initially), because then he will have to spend 10 milliseconds to put pointers to other blocks.  Therefore, the optimal strategy for Petit is to initially put pointers to blocks 1, 2 and 3, before the second request for blocks 1, 3, 4 for <em>s <sub>2</sub></em> = 1 millisecond, and before the last request to put pointers to blocks 1, 3 and 5 for <em>s <sub>4</sub></em> = 3 milliseconds.  Total cumulative response time to requests <em>s <sub>2</sub></em> + <em>s <sub>4</sub></em> = 4 milliseconds. </p><br><p>  <strong>Input data</strong> </p><br><p>  The input contains several test cases.  The first line contains the number of tests <em>t</em> (1 ‚â§ <em>t</em> ‚â§ 1000). </p><br><p>  Each of the following <em>t</em> tests is described as follows: the first line of the test description contains three numbers <em>n</em> , <em>k</em> , <em>q</em> - the number of blocks in the manager, the number of pointers and the number of user queries, respectively (1 ‚â§ <em>k</em> ‚â§ <em>n</em> ‚â§ 10 <sup>5</sup> , 1 ‚â§ <em>q</em> ‚â§ 10 <sup>6</sup> ). </p><br><p>  The next line contains <em>q</em> integers <em>s <sub>i</sub></em> - the time required for interchanging pointers when responding to the <em>i-</em> th query (1 ‚â§ <em>s <sub>i</sub></em> ‚â§ 10 <sup>4</sup> ). </p><br><p>  The following <em>q</em> lines contain the description of user requests, the <em>i-</em> th request is described in one line, where the first number <em>c <sub>i</sub></em> describes the number of data blocks the user wants to receive (1 ‚â§ <em>c <sub>i</sub></em> ‚â§ <em>k</em> ), and the next <em>c <sub>i</sub></em> numbers describe the numbers of these blocks <em>b <sub>i</sub></em> , <em>j</em> in ascending order (1 ‚â§ <em>b <sub>i</sub></em> , <em>j</em> ‚â§ <em>n</em> ). </p><br><p>  It is guaranteed that the sum n in all tests of one input data does not exceed 10 <sup>5</sup> , and the sum <em>c <sub>i</sub></em> in all tests of one input data does not exceed 10 <sup>6</sup> . </p><br><p>  <strong>Output</strong> </p><br><p>  For each test, output the answer to it - the minimum total response time to all user requests. </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  To begin with, for each query <em>q <sub>i,</sub></em> we find <em>go <sub>i</sub></em> - the minimum <em>j</em> , such that among <em>q <sub>j</sub></em> , <em>q <sub>j</sub></em> + 1, ..., <em>q <sub>i there are</sub></em> at most <em>k</em> different numbers: this will mean that before the <em>jth</em> query you can put pointers that <em>j</em> , <em>j</em> + 1, ..., <em>i</em> requests are executed instantly.  This is done in <em>O</em> ( <em>sum</em> (| <em>q <sub>i</sub></em> |)), for example, by two pointers, if you go from the end of the query array. </p><br><p>  Now we will use dynamic programming, we calculate the values <em>dp <sub>i</sub></em> - the minimum time during which the first <em>i</em> requests can be executed.  If <em>go <sub>i</sub></em> = 0, then <em>dp <sub>i</sub></em> = 0. If not, then it is easy to see that <em>dp <sub>i</sub></em> = <em>min <sub>j = go <sub>i</sub></sub></em> .. <em>i</em> ( <em>dp <sub>j</sub></em> - 1 + <em>s <sub>j</sub></em> ) - we choose query <em>j</em> , before which we will change pointers, and pay the corresponding cost.  Since <em>go <sub>i</sub></em> does not decrease, this value can be calculated either by supporting the <em>set</em> values ‚Äã‚Äãof <em>dp <sub>j</sub></em> - 1 + <em>s <sub>j</sub></em> , or by using the queue with the operation "minimum". </p></div></div><br><h2 id="e-lisa">  E. FOX </h2><br><p>  Time limit - 3 seconds <br>  Memory limit - 256 megabytes </p><br><p>  Ilya works in the Laboratory for Learning String Algorithms (LISA).  Now he is trying to solve this problem. </p><br><p>  An array of strings <em>s <sub>1</sub></em> , <em>s <sub>2</sub></em> , ..., <em>s <sub>n</sub></em> and <em>q</em> queries is specified.  Each query is characterized by two integers <em>l <sub>i</sub></em> and <em>r <sub>i</sub></em> (1 ‚â§ <em>l <sub>i</sub></em> ‚â§ <em>r <sub>i</sub></em> ‚â§ <em>n</em> ).  To answer the request, do the following.  We call a string representable if it can be obtained as follows: choose two strings <em>s <sub>x</sub></em> and <em>s <sub>y</sub></em> , where <em>l <sub>i</sub></em> ‚â§ <em>x</em> , <em>y</em> ‚â§ <em>r <sub>i</sub></em> , choose a non-empty prefix of the string <em>s <sub>x</sub></em> and a non-empty suffix of the string <em>s <sub>y</sub></em> , take their concatenation.  The answer to the request is the number of different representable lines for the given <em>l <sub>i</sub></em> and <em>r <sub>i</sub></em> . </p><br><p>  For example, let <em>s</em> = [ <em>abc</em> , <em>ab</em> , <em>ac</em> , <em>bcac</em> ], choose <em>l <sub>i</sub></em> = 2, <em>r <sub>i</sub></em> = 3. The strings are representable: </p><br><p>  <em>x</em> = 2, <em>y</em> = 2: <em>ab</em> = <em>a</em> + <em>b,</em> aab <em>=</em> a <em>+</em> ab <em>,</em> abb <em>=</em> ab <em>+</em> b <em>,</em> abab <em>=</em> ab <em>+</em> ab *. </p><br><p>  <em>x</em> = 2, <em>y</em> = 3: <em>ac</em> = <em>a</em> + <em>c</em> , <em>aac</em> = <em>a</em> + <em>ac</em> , <em>abc</em> = <em>ab</em> + <em>c</em> , <em>abac</em> = <em>ab</em> + <em>ac</em> . </p><br><p>  <em>x</em> = 3, <em>y</em> = 2: <em>ab</em> = <em>a</em> + <em>b</em> , <em>aab</em> = <em>a</em> + <em>ab</em> , <em>acb</em> = <em>ac</em> + <em>b</em> , <em>acab</em> = <em>ac</em> + <em>ab</em> . </p><br><p>  <em>x</em> = 3, <em>y</em> = 3: <em>ac</em> = <em>a</em> + <em>c</em> , <em>aac</em> = <em>a</em> + <em>ac</em> , <em>acc</em> = <em>ac</em> + <em>c</em> , <em>acac</em> = <em>ac</em> + <em>ac</em> . </p><br><p>  A total of 12 different representable lines. </p><br><p>  Help Ilya solve the problem fairly quickly. </p><br><p>  <strong>Input data</strong> </p><br><p>  The first line contains two integers <em>n</em> and <em>q</em> - the number of words and queries, respectively (1 ‚â§ <em>n</em> , <em>q</em> ‚â§ 10 <sup>5</sup> ). </p><br><p>  Each of the following n lines contains non-empty words <em>s <sub>i</sub></em> consisting of lowercase Latin letters.  The total length of all words does not exceed 10 <sup>5</sup> . </p><br><p>  The next <em>q</em> lines contain pairs of numbers <em>l <sub>i</sub></em> , <em>r <sub>i</sub></em> (1 ‚â§ <em>l <sub>i</sub></em> ‚â§ <em>r <sub>i</sub></em> ‚â§ <em>n</em> ) - the left and right border of the <em>i</em> -th query, respectively. </p><br><p>  <strong>Output</strong> </p><br><p>  Print <em>q</em> lines, the <em>i</em> -th of them should contain a single integer - the answer to the <em>i-</em> th query. </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  We first consider the problem for two specific lines: calculate the number of occurrences of each letter in the first line and each letter in the second line, we will not take into account the first letter in the first line and the last letter in the second line, which must be taken in any case.  To get the answer, it is necessary to calculate the product of the lengths of the lines and subtract from this value the sum of cnt1 [letter] * cnt2 [letter] for all letters.  Proof of the statement will be left as an exercise, such a task was proposed at the northern quarterfinal - 2015 ( <a href="http://neerc.ifmo.ru/archive/2015/northern/north-2015-statements.pdf">http://neerc.ifmo.ru/archive/2015/northern/north-2015-statements.pdf</a> , task C).  A wide range of participants could solve it at the Cup of three quarterfinals. </p><br><p>  For <em>n</em> lines, the problem is solved in a similar way: add all the lines to the prefix boron, add all the lines to the suffix boron, count the number of vertices in the first boron and in the second boron (except the root), multiply these two numbers - we can generate so many lines by applying the path in the prefix boron to the suffix boron path.  Now you need to subtract the repetition, it is done in the same way: in the prefix boron, the number of each letter on the edges, except the letter on the edges of the root, is calculated, these values ‚Äã‚Äãare multiplied, this amount is subtracted from the product of the number of vertices in the forests. </p><br><p>  It remains to learn how to respond to requests on the segment.  We will use sqrt-decomposition, we will break lines in groups on the sum of lengths.  Let's greedily type lines into a group until the total length in the group is greater than the root of the sum of lengths, the last line can be quite large. </p><br><p>  Now we use the Mo algorithm, sort the requests by the block of the left border with an equal block by the right border, then between changes of the block of the left border the right border will move only to the right.  To add a line to a boron or remove it from a boron, we will recalculate the number of vertices in a subtree and, accordingly, the number of occurrences of letters in a boron. </p></div></div><br><h2 id="vse-na-vtoroy-raund">  All for the second round! </h2><br><p>  We remind you: the second round is this Sunday, from 12:00 Moscow time.  At the time of writing, more than 4,600 participants have already registered, it will be interesting.  <a href="http://www.russiancodecup.ru/ru/">Join now</a> ! </p><br><p>  In addition, we decided to try to open in the telegram group dedicated to RCC and sports programming in general.  <a href="https://t.me/mrgrcc">Welcome!</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/326332/">https://habr.com/ru/post/326332/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326320/index.html">(Not) for protothreads lovers dedicated to: High-level functions for working with 1-Wire</a></li>
<li><a href="../326322/index.html">5 stages of implementation of a CRM system. Fascinating about the important</a></li>
<li><a href="../326324/index.html">Implement a custom UI element for timing. Part 1</a></li>
<li><a href="../326328/index.html">Bash scripts, part 3: command line options and keys</a></li>
<li><a href="../326330/index.html">First steps to the web SCADA-system. We animate the mnemonic in the browser using AngularJS</a></li>
<li><a href="../326334/index.html">The logic of consciousness. Part 12. The search for patterns. Combinatorial space</a></li>
<li><a href="../326336/index.html">Antifraud. Law. Cellular: my questions</a></li>
<li><a href="../326338/index.html">Data Visualization: Oracle BI Data Discovery</a></li>
<li><a href="../326340/index.html">‚ÄúWhat are they eating?‚Äù: What is a blockchain?</a></li>
<li><a href="../326342/index.html">Stanford Courses CS193P Winter 2017: Developing iOS 10 Applications with Swift</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>