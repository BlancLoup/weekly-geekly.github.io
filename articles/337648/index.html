<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A curious feature of the Java language and insidious errors that it may cause</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! I present to your attention the translation of the Sub article Bug article by Lukas Eder. 

 Visibility rules in Java can sometimes be sligh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A curious feature of the Java language and insidious errors that it may cause</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  I present to your attention the translation of the Sub article Bug article by Lukas Eder. <br><br>  Visibility rules in Java can sometimes be slightly confusing and incomprehensible.  What do you think will be displayed after running this code? <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> p; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> pAx; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String x = <span class="hljs-string"><span class="hljs-string">"Ax"</span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">B</span></span></span><span class="hljs-class"> </span></span>{ String x = <span class="hljs-string"><span class="hljs-string">"Bx"</span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C</span></span></span><span class="hljs-class"> </span></span>{ String x = <span class="hljs-string"><span class="hljs-string">"Cx"</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">D</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">B</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">m</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(x); } } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> C().new D().m(); } }</code> </pre> <br>  It will be displayed: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="java hljs">Bx</code> </pre> <br>  Because: <br><br><pre> <code class="java hljs">  B      C, ,   ,     A.</code> </pre> <br><h3>  How can all this lead to errors? </h3><br><a name="habracut"></a>  The problem is not that the above code example is cleverly written by itself.  Not.  Just when you write according to this logic, everything will work exactly as expected.  But what happens if we change something?  Well, for example, if you change the access modifier of a member of a superclass to <i>private</i> : <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> p; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> pAx; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String x = <span class="hljs-string"><span class="hljs-string">"Ax"</span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">B</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String x = <span class="hljs-string"><span class="hljs-string">"Bx"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     } class C { String x = "Cx"; class D extends B { void m() { System.out.println(x); } } } public class X { public static void main(String[] args) { new C().new D().m(); } }</span></span></code> </pre><br>  Now, oddly enough, Bx is no longer visible for the m () method, in this case another rule applies.  Namely: <br><br><pre> <code class="java hljs">  ()   </code> </pre> <br>  And in the end we get the following result: <br><br><pre> <code class="java hljs">Cx</code> </pre> <br>  Of course, we can make some changes again and get the following code: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> p; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> pAx; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String x = <span class="hljs-string"><span class="hljs-string">"Ax"</span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">B</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String x = <span class="hljs-string"><span class="hljs-string">"Bx"</span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C</span></span></span><span class="hljs-class"> </span></span>{ String xOld = <span class="hljs-string"><span class="hljs-string">"Cx"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    class D extends B { void m() { System.out.println(x); } } } public class X { public static void main(String[] args) { new C().new D().m(); } }</span></span></code> </pre><br>  As we all know, 50% of the variables that will no longer be used are renamed and receive the prefix ‚Äúold‚Äù. <br><br>  In this final version of the code, the only possible x value remains in the m () method call and this is a statically imported Ax. Thus, the output will be as follows: <br><br><pre> <code class="java hljs">Ax</code> </pre> <br><h3>  Subtleties that should be considered when working with large software codes </h3><br>  This refactoring showed us that limiting the visibility of an existing element is dangerous enough, since the work of a subclass could depend on it, but by coincidence, the code has another, "less important" and more visible member, having the same name that is included into work and does not give you a compile error. <br><br>  The same thing happens when you expand the scope of a member of a class that previously had private access modifier.  Because of this, he may be in the scope of all his subclasses, although you might not want to. <br><br>  With static imports, you may also encounter a similar problem.  When your code depends on a static import, which suddenly turns out to be hidden by another member with an identical name, for example, a member of a superclass.  The author of the changes made may not even notice this, because when making changes, most likely, he will not take into account the presence of subclasses. <br><br><h3>  Conclusion </h3><br>  In conclusion, I would like to once again note that you should not create subtypes too often.  If you can declare the classes to be created as <i>final</i> , then no one can inherit from them and, as a result, receive a sudden "surprise" when you add new members to the superclass.  In addition, every time you make a change in the scope of existing members of a class, be extremely careful and remember the potential possibility of having members with the same names as the one being changed. </div><p>Source: <a href="https://habr.com/ru/post/337648/">https://habr.com/ru/post/337648/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337636/index.html">We have nothing to hide - everything is fair in the HPE 3PAR Data Reduction Guarantee</a></li>
<li><a href="../337640/index.html">Survey: Does the creator of the product need additional study in order to conduct user research?</a></li>
<li><a href="../337642/index.html">Learn OpenGL. Lesson 2.5 - Light Sources</a></li>
<li><a href="../337644/index.html">tig - we improve productivity of work with git</a></li>
<li><a href="../337646/index.html">Technocup 2017-2018</a></li>
<li><a href="../337652/index.html">Platform for collecting donations in two weeks - the results of anti-hacking</a></li>
<li><a href="../337654/index.html">Read user input (digits) in the 3CX Call Flow Designer application</a></li>
<li><a href="../337656/index.html">This is not an article - just food for thought about how to write it.</a></li>
<li><a href="../337658/index.html">How we built our mini data center. Part 5 - experience, breaks, heat</a></li>
<li><a href="../337660/index.html">Why is a site audit useless for 99% of small businesses?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>