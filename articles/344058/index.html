<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mac OS High Sierra, is there a remote ‚Äúpasswordless root‚Äù? (Yes, but unlikely)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Immediately after it became known that it was possible to get root without a password, I wondered if it could be done remotely. 

 After much experime...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mac OS High Sierra, is there a remote ‚Äúpasswordless root‚Äù? (Yes, but unlikely)</h1><div class="post__text post__text-html js-mediator-article">  Immediately after it became known that it was possible to get root without a password, I wondered if it could be done remotely. <br><br>  After much experimentation, the next unlikely, but still feasible, scenario turned out.  First I will describe how to reproduce it, and then why each of the points is important. <br><a name="habracut"></a><br>  <b>Circumstances should be such that:</b> <br><br><ol><li>  The victim uses the vulnerable version 10.13.1 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/68d/4d1/5d6/68d4d15d6eb3a6e0be56e3041d179ce5.png" alt="image" width="300"></a> </li><li>  The victim has Screen Sharing enabled. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/35e/165/c44/35e165c4451bf8b7f9401a647256aaed.png" alt="image" width="300"></a> </li><li>  The victim is wired to the network (with Internet access or not - it does not matter). <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/4bf/6b1/841/4bf6b18415e1f1de5f852ad61c3a471a.png" alt="image" width="300"></a> </li><li>  The victim read on the Internet about the existence of a vulnerability, tried it on her Mac, and did not take any action to eliminate it. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/9a0/082/c9f/9a0082c9f8a871a153371e326212a5d0.png" alt="image" width="200"></a> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b3e/693/d81/b3e693d81f2db373373cc000f41e4343.png" alt="image" width="200"></a> </li><li>  The attacker must know the victim's ip address or find it in the list of devices on the network. </li></ol><br>  <b>The attack looks like this:</b> <br><br><ol><li>  Attacker connects via VNC (Finder ‚Üí Cmd + K ‚Üí vnc: // victim ‚Üí root without password) <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/7ce/25e/75e/7ce25e75ed41bdf42ed61c4edf611a9b.png" alt="image" width="100"></a> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/d3d/f7d/af7/d3df7daf7e55aec7229fecece094ba23.png" alt="image" width="100"></a> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b2c/27b/20e/b2c27b20e8c6ae49f3c44ec53c24da87.png" alt="image" width="100"></a> </li><li>  Attacking the Login Screen of the victim chooses Other ... <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/45d/ec9/390/45dec93907ce3e9db6c221400f5e6a32.png" alt="image" width="400"></a> </li><li>  The attacker enters root without a password. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/abd/66c/429/abd66c429a09f850f30b680ac27fb718.png" alt="image" width="400"></a> </li><li>  Is done. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/547/688/c20/547688c20f26067039997b69e738b403.png" alt="image" width="400"></a> </li></ol><br>  <b>Now we analyze why everything is so difficult.</b> <br><br><ol><li>  This is obvious. </li><li>  Screen sharing allows access via vnc.  By default, it is turned off, but the probability that the user once used it and left it on is still there. </li><li>  Wire connection is important.  By Wifi VNC, the connection is terminated at the moment when the root user is just starting to log in.  Apparently, this is due to the fact that root does not have access to the keychain of the normal admin.  For some reason, the already working Wifi connection terminates the root connection, but it cannot reconnect.  The wire does not break the connection. </li><li>  The most unlikely.  It is necessary that a login for root-a be available on the victim's computer.  And without a password.  This effect, at the moment you can achieve the only way I know - to exploit that very, original vulnerability.  It is necessary that the victim at least once opened the very ‚Äúlock‚Äù of the root with an empty password. </li><li>  The attacker's Mac will find the victim himself with Screen Sharing turned on in his subnet.  However, the usual methods of detecting an open vnc port will also work.  nmap you help. <br><br>  During a root attack, an empty password essentially works twice.  The first time vnc connection is just established.  Second time on the Login Screen of the victim. </li></ol><br>  <b>Finally:</b> <br><br><ul><li>  The victim sees an indicator that Screen Sharing is active and can disable the attacker at any time.  Although this is unlikely to help her. </li><li>  If you try to rotate the attack via wifi, the root of the victim will remain on the victim's Mac.  It will need to be unlocked for later reboot or shutdown. </li><li>  At the logged root, the ‚Äúlock‚Äù is immediately open and does not want to close at all. </li><li>  When establishing a VNC connection, there is an option ‚ÄúAsk the screen of the current user‚Äù.  The user can put you behind your screen.  What to do with it - think for yourself. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/344058/">https://habr.com/ru/post/344058/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344048/index.html">What is virtualization and how does a virtual server work?</a></li>
<li><a href="../344050/index.html">What's new in WebStorm 2017.3</a></li>
<li><a href="../344052/index.html">Short shoulder match</a></li>
<li><a href="../344054/index.html">Practical use of multiple bounds generic in Java</a></li>
<li><a href="../344056/index.html">Recover Huffman Tables in Intel ME 11.x</a></li>
<li><a href="../344060/index.html">Tale of how SQL saves time</a></li>
<li><a href="../344062/index.html">The evolution of solid-state drives: from the first models of the 70s to the present day</a></li>
<li><a href="../344064/index.html">GDPR - new rules for the processing of personal data in Europe for the international IT market</a></li>
<li><a href="../344066/index.html">[Translation of the article] 7 basic rules for protection against phishing</a></li>
<li><a href="../344068/index.html">Instructions for use sysadmin in small business</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>