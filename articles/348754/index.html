<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Backblaze statistics, a scientific approach to analyzing drive reliability</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The firm Backblaze regularly publishes statistics on the failures of its hard drives, and even laid out in free access the full archov with the SMART ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Backblaze statistics, a scientific approach to analyzing drive reliability</h1><div class="post__text post__text-html js-mediator-article"><p>  The firm Backblaze regularly publishes <a href="https://www.backblaze.com/blog/hard-drive-stats-for-2017/">statistics</a> on the failures of its hard drives, and even laid out in free access the full archov with the SMART <a href="https://www.backblaze.com/b2/hard-drive-test-data.html">statistics of the</a> parameters of all their drives. </p><br><p>  In this article I will show how using with <del>  scrap and some mother </del>  using scientific methods to calculate the reliability of drives. </p><a name="habracut"></a><br><h2 id="analiz-vyzhivaemosti">  Survival Analysis </h2><br><p>  In statistics, a section called <a href="https://en.wikipedia.org/wiki/Survival_analysis"><em>‚Äúsurvival analysis‚Äù</em></a> deals with survival or reliability <a href="https://en.wikipedia.org/wiki/Survival_analysis"><em>analysis</em></a> . </p><br><p>  In short, this is a set of methods that allow comparing and counting how various factors affect life expectancy (in medicine), time between failures (in mechanics), etc.  In general, this is an analysis of the time before the onset of some event.  That is, to answer the question, such as: ‚ÄúWhat will be the proportion of survivors among patients some time after the applied treatment technician?‚Äù Or ‚ÄúWhat percentage of accumulators will fail next year?‚Äù. </p><br><p>  At the same time, the answers to such questions must be sought when the time of observation of the patients (or accumulators) is limited and it is not possible to determine the lifetime of all patients. </p><br><p>  <strong>Terms</strong> </p><br><ul><li>  <em>‚ÄúEvent‚Äù</em> - the death of the patient, the first failure, etc., the time to which we can or want to measure </li><li>  <em>‚ÄúTime‚Äù</em> is actually the time from the beginning of the observation until the occurrence of the event, or until the moment when we are not able to continue the observation (the patient left, the drive was turned off, etc.) </li><li>  <em>‚ÄúCensoring‚Äù</em> - stopping the observation of the patient before the occurrence of the ‚ÄúEvent‚Äù.  Not relevant to the system of state supervision over the content and dissemination of information. </li><li>  <em>‚ÄúSurvival function‚Äù</em> , usually denoted as S (t) - the probability that the patient lives to time t, it is usually assumed that S (0) = 100% and the function does not increase over time. </li><li>  <em>The ‚Äúrisk function‚Äù (‚ÄúHazard function‚Äù)</em> - h (t) is the probability that the patient will die at time t, per unit of time.  That is, the first derivative of the survival function with a minus sign. </li></ul><br><h2 id="dannye">  Data </h2><br><p> Backblaze laid out in open access <a href="https://www.backblaze.com/b2/hard-drive-test-data.html">a database</a> with all the SMART parameters of all its hard drives, in <code>.csv</code> format, divided into files by day.  If all these files are imported into the database (they offer their own scripts for importing into sqlite3), then we get a table with 90126570 entries, it takes about <em>19 GB</em> and describes <em>122619</em> drives.  I made a small script that pulls the following data about each drive into one table: manufacturer, model, serial number, capacity, service start date, operation time either until the end of the observation (SMART 9 parameter), or before the event and an indication of the event.  A CSV file with this information can be <a href="">downloaded here</a> : </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6b4/b64/e99/6b4b64e99c066f2f6e65bd5b169e087d.png" alt="image"><br>  <em><strong>Schedule 0</strong> : Distribution of drives by volume and date of commissioning.</em> </p><br><h2 id="statistika">  Statistics </h2><br><p>  For processing, I will use <code>R</code> with <code>tidyverse, survival, survminer, zoo</code> packages <br>  To begin with, an example of how to represent the function of survival: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/61d/67c/d41/61d67cd41f25adbba4cbb5e0f08b238b.png" alt="image"><br>  <em><strong>Graph 1</strong> : The survival function for the ST31500341AS drive.</em> </p><br><p>  We look at schedule 1: This is an example of a survival schedule according to the Kaplan-Meier methodology, the percentages of surviving devices are plotted on the vertical axis, and the number of days on the horizontal axis.  Crosses show censored devices (i.e., they have survived at least until X, and then traces are lost).  Dotted lines indicate 95% confidence intervals.  The <em>Kaplan-Meier</em> methodology ( <strong>KM</strong> ) appeared back in the year 58 and has since been actively used to describe the survival function, it should be noted that this is a non-parametric method, and uses a piecewise linear function to approximate the survival function (that is, with a small amount of data are clearly visible steps).  In the survival package, this is done as follows: </p><br><pre> <code class="hljs lisp">survfit(<span class="hljs-name"><span class="hljs-name">Surv</span></span>(<span class="hljs-name"><span class="hljs-name">age_days</span></span>, status) ~ <span class="hljs-number"><span class="hljs-number">1</span></span>, ...)</code> </pre> <br><p>  Where as an argument first comes the formula where on the left a special function Surv shows that we are dealing with data and events, and then the data source: age_days - time, status - the code for the event (1 - events occurred, 0 - data rationalized).  The result can be beautifully drawn using the <code>survminer</code> . </p><br><p>  The KM method allows you to compare the survival functions with each other to determine if there is a statistically significant difference between them, for example, you took data on two drive models: ST31500341AS and ST31500541AS: </p><br><pre> <code class="hljs lisp">survfit(<span class="hljs-name"><span class="hljs-name">Surv</span></span>(<span class="hljs-name"><span class="hljs-name">age_days</span></span>, status) ~ model, ...)</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/6f4/24b/dba/6f424bdba049f602c125f8b28e1c689a.png" alt="image"><br>  <em><strong>Chart 2</strong> : Survival functions for ST31500341AS and ST31500541AS drives</em> </p><br><p>  For comparison of distributions we use the survdiff function: </p><br><pre> <code class="hljs erlang"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">survdiff</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Surv(age_days, status)</span></span></span><span class="hljs-function"> ~ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">model</span></span></span><span class="hljs-function">, ...) N O</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bserved</span></span></span><span class="hljs-function"> E</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xpected</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OE)</span></span></span><span class="hljs-function">^2/E </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OE)</span></span></span><span class="hljs-function">^2/V </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">model</span></span></span><span class="hljs-function">=ST31500341AS 787 216 125 66.4 84.3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">model</span></span></span><span class="hljs-function">=ST31500541AS 2188 397 488 17.0 84.3 C</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hisq</span></span></span><span class="hljs-function">= 84.3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on</span></span></span><span class="hljs-function"> 1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">degrees</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">freedom</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function">= 0</span></span></code> </pre> <br><p>  For us, the most important thing is the last line, with the value of p, it shows the probability that the distributions are not significantly different, in this case it is even evident that this cannot be. </p><br><p>  It is worth noting that in this way you can only say - is there a difference or not, that is, it is not possible to say that strata A dies XX% faster than strata B. </p><br><p>  Another interesting graph, let's see how the vitality of the most popular backblaze drive (ST4000DM000) changed with the installation time: </p><br><pre> <code class="hljs lisp">survdiff(<span class="hljs-name"><span class="hljs-name">Surv</span></span>(<span class="hljs-name"><span class="hljs-name">age_days</span></span>, status) ~ start_quarter, ...)</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/5f1/42c/cba/5f142ccbad7759f2371adc2c697205e4.png" alt="image"><br>  <em><strong>Chart 3</strong> : Survival functions for ST4000DM000 drives, depending on the start date.</em> </p><br><p>  It can be seen that there is a difference (p &lt;0.0001) but it is interesting to know how big it is. </p><br><h2 id="model-proporcionalnyh-riskov-koksa">  Cox proportional hazards model </h2><br><p>  And here Cox‚Äôs proportional risk <a href="https://en.wikipedia.org/wiki/Proportional_hazards_model">model</a> comes to our aid; it allows us to estimate the relative risks between different strata, but proceeds from the assumption that they all differ from each other in a strictly proportional manner. </p><br><p>  For the calculation, the coxph function is used: </p><br><pre> <code class="hljs lisp">model_coxph&lt;-coxph(<span class="hljs-name"><span class="hljs-name">Surv</span></span>(<span class="hljs-name"><span class="hljs-name">age_days</span></span>, status) ~ make + capacity + year, ...)</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/6be/60f/472/6be60f47285e9f9bab5f7a77a831c23b.png" alt="image"><br>  <em><strong>Chart 4</strong> : Relative risk factors (i.e. dying rate) for ST4000DM000 depending on the installation quarter.</em>  <em>Asterisks show quarters when the speed of dying differs significantly from the base (in the first quarter of 2013).</em> </p><br><p>  Now let's compare the 4 most popular models of large drives: 8Tb: ST8000NM0055, ST8000DM002 10Tb ST10000NM0086 and 12Tb ST12000NM0007 </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/984/59f/ca9/98459fca96b9a46fc0d31d527f5d4f7a.png" alt="image"><br>  <em><strong>Chart 5</strong> : Survival functions for large drives.</em> </p><br><p>  The KM method shows that there is no difference between them, despite the strange leap for the model ST12000NM0007 </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/370/045/329/3700453295b9e0ae729561dfd45b2ba8.png" alt="image"><br>  <em><strong>Chart 6</strong> : Coke model for large drives, there is no statistical difference.</em> </p><br><p>  If we want to compare the ten most popular drives, we get the following picture: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b6a/37f/efd/b6a37fefdafecb69de8181db63eaa0a9.png" alt="image"><br>  <em><strong>Chart 7</strong> : Survival Functions for the Top 10 Drives</em> </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/deb/ce4/1c4/debce41c430ca14810d82e9b0cb1f517.png" alt="image"><br>  <em><strong>Chart 8</strong> : Coke model for the 10 most popular drives</em> </p><br><p>  The most reliable: HDS5C3030ALA630, HMS5C4040ALE640, HDS5C4040ALE630, HDS722020ALA330, HMS5C4040BLE640, you can make a pairwise comparison (pairwise_survdiff function, if you are interested, is there a difference between them. </p><br><h2 id="parametricheskie-modeli">  Parametric models </h2><br><p>  If it is interesting for us not just to compare different models of drives, but to answer a more specific question of the type: after what period of time one of the twenty disks in my file server will fail, then parametric models come to the rescue. </p><br><p>  The simplest case is a model with constant risk; it assumes that throughout the life of the accumulator, the chance to die in a given period of time is approximately the same.  For example, this model describes the process of decay of radioisotopes.  In the literature, it is called the exponential model, because the survival function is described by the formula </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>S</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>t</mi><mo>&amp;#x2217;</mo><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>d</mi><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.471ex" height="2.66ex" viewBox="0 -832 12688.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-28" x="645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-74" x="1035" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-29" x="1396" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-3D" x="2063" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-31" x="3120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-2212" x="3842" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-65" x="4843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-78" x="5310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-70" x="5882" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-28" x="6386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-2212" x="6775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-74" x="7554" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-2217" x="8137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-6C" x="9110" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-61" x="9408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-6D" x="9938" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-62" x="10816" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-64" x="11246" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-61" x="11769" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-29" x="12299" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>‚àí</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>‚àí</mo><mi>t</mi><mo>‚àó</mo><mtext>&nbsp;</mtext><mi>l</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>d</mi><mi>a</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> S (t) = 1-exp (-t * \ lambda) </script></p><br>  When you calculate the% failure rate of drives for a year, then you use this model in an implicit way. <br><p>  In practice, it is known that mechanical systems are better described by the <em>Weibull</em> function, with the formula </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>S</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>&amp;#x2217;</mo><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>d</mi><mi>a</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>p</mi></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.34ex" height="2.66ex" viewBox="0 -832 13924 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-28" x="645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-74" x="1035" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-29" x="1396" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-3D" x="2063" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-31" x="3120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-2212" x="3842" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-65" x="4843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-78" x="5310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-70" x="5882" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-28" x="6386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-2212" x="6775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-28" x="7554" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-74" x="7943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-2217" x="8527" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-6C" x="9499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-61" x="9798" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-6D" x="10327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-62" x="11206" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-64" x="11635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-61" x="12159" y="0"></use><g transform="translate(12688,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMATHI-70" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/348754/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjFZfDyVOX2ZIQVRohCtTMD0JnoLg#MJMAIN-29" x="13534" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>‚àí</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>‚àí</mo><mo stretchy="false">(</mo><mi>t</mi><mo>‚àó</mo><mtext>&nbsp;</mtext><mi>l</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>d</mi><mi>a</mi><msup><mo stretchy="false">)</mo><mi>p</mi></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> S (t) = 1-exp (- (t * \ lambda) ^ p) </script></p><br>  if p &lt;1, then the probability of failures decreases with time, p = 1 - we have an exponential model and p&gt; 1 - the probability of failures increases with time. <br><p>  The survival package uses the <code>survreg</code> function to build this model: <br>  For example, let's try building a Weibull model for 10 popular drives: </p><br><pre> <code class="hljs lisp">fit_model_weibull&lt;-survreg(<span class="hljs-name"><span class="hljs-name">Surv</span></span>(<span class="hljs-name"><span class="hljs-name">age_days</span></span>, status) ~ model, data=hdd_common)</code> </pre> <br><p>  Compare with the exponential model </p><br><pre> <code class="hljs lisp">fit_model_exp&lt;-survreg(<span class="hljs-name"><span class="hljs-name">Surv</span></span>(<span class="hljs-name"><span class="hljs-name">age_days</span></span>, status) ~ model, data=hdd_common,dist='exponential')</code> </pre> <br><p>  And let's see how the predicted distribution function coincides with the non-parametric KM, using the example of <em>ST4000DM000</em> . </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a7a/95f/906/a7a95f906163103820df16cc4760780d.png" alt="image"><br>  <strong>Chart 9</strong> : Comparison of two parametric models with non-parametric models using the example of <em>ST4000DM000</em> </p><br><p>  It can be seen that the Weibull model better describes the process of drive failure. <br>  Models can be compared statistically using the Akaike information criterion: </p><br><pre> <code class="hljs lisp"> AIC(<span class="hljs-name"><span class="hljs-name">fit_model_weibull</span></span>,fit_model_exp) df AIC fit_model_weibull <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">112208.8</span></span> fit_model_exp <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">112951.3</span></span></code> </pre> <br><p>  A model with a lower AIC value ‚Äî better describes the observed data. </p><br><p>  And let's see the expected time of failure of 10% of drives: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/642/9d2/34c/6429d234cdfdb5e19bc2efd342c7ab9f.png" alt="image"><br>  <em><strong>Chart 10</strong> : Estimation of the failure time of the 10 most popular drives</em> </p><br><p>  On the assessment it is clear that the Weibul model gives an earlier estimate of the output of drives.  By the way, if you simply calculate %% of the output of the drives out of operation every year, you get an approximation of an exponential model, which in this case gives an overestimated result. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  So, with the help of freely laid out data on drive failures, you can predict future spending on disk replacement. </p><br><p>  In the dataset from backblaze there is a lot of interesting information, for example, you can see how the temperature mode (parameter SMART 194) during drive operation affected its lifespan, or how the number of write cycles (parameter 241) </p><br><p>  Scripts and .csv file for calculations <a href="https://github.com/vfonov/hdd_survival_backblaze">is available on github</a> . </p><br><p>  If you are interested, you can download the sqlite database somewhere with the entire backblaze database (2.7GB after XZ packaging) </p><br><h2 id="ispolzovannaya-literatura">  References </h2><br><ul><li>  <a href="https://en.wikipedia.org/wiki/Survival_analysis">Wikipedia: Survival analysis</a> </li><li>  survminer: <a href="http://www.sthda.com/english/rpkgs/survminer/">Survival Analysis and Visualization</a> </li><li>  Michael J. Crawley.  The R Book, 2nd edition ISBN: 978-0-470-97392-9 </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/348754/">https://habr.com/ru/post/348754/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348744/index.html">Web development as an incentive or in pursuit of a dream</a></li>
<li><a href="../348746/index.html">Issue # 10: IT training - current issues and challenges from leading companies</a></li>
<li><a href="../348748/index.html">Programming Training: Finger Painting and Killing Zombies</a></li>
<li><a href="../348750/index.html">Open lesson on the topic ‚ÄúAudit of advertising campaigns in Yandex. Direct ¬ª</a></li>
<li><a href="../348752/index.html">How the virtual infrastructure will develop: 4 main trends</a></li>
<li><a href="../348756/index.html">Automatic vectorization of satellite images: one model - the first two places</a></li>
<li><a href="../348758/index.html">When the experience of the 25k + team is included in the lecture: how EPAM collaborates with universities in Belarus</a></li>
<li><a href="../348760/index.html">Shadow ban and what it eats</a></li>
<li><a href="../348766/index.html">Gesturizer: 3D-touch and gestures in iOS apps</a></li>
<li><a href="../348770/index.html">Richard Hamming: Chapter 1. Orientation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>