<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Development of business applications 1C + Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear. 


 In this article I want to introduce you to the new product ‚ÄúFBA Toolkit‚Äù, which greatly simplifies the process of developing a corpor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Development of business applications 1C + Android</h1><div class="post__text post__text-html js-mediator-article">  Hello, dear. <br><br><img align="left" src="https://habrastorage.org/storage2/d6d/96e/599/d6d96e599d5607ecd90d5b674d21de33.png"><br>  In this article I want to introduce you to the new product ‚ÄúFBA Toolkit‚Äù, which greatly simplifies the process of developing a corporate mobile application on 1C + Android. <br>  ‚ÄúFBA Toolkit‚Äù is: <br>  - development of a ‚Äúnative‚Äù Android application in its native IDE in Java; <br>  - 1C: Enterprise 8.1 (8.2) as a data source, corporate information system. <br><br>  First of all, the framework will be useful for 1C programmers who would like to start developing business applications for Android, but have difficulty mastering a new platform for them.  To begin developing, initial knowledge of Java will suffice.  Next, I'll show you how to create a working prototype of a client-server application in just a couple of hours. <br><a name="habracut"></a><br><h4>  We prepare the workplace </h4><br>  Before you begin the development process itself, you need to prepare a developer workplace.  Would need: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1. Install and configure: <br>  - Java SDK + Eclipse + Android SDK; <br>  - Web server (IIS or Apache); <br>  - 1C: Enterprise 8.1 (8.2) <br><br>  2. For Eclipse, import two library projects: <a href="http://actionbarsherlock.com/">ActionBarSherlock</a> and <a href="https://xp-dev.com/svn/fba_toolkit_public/ru_profi1c_fba/">ru_profu1c_fba</a> from the SVN repository. <br><br>  3. Install the ‚ÄúFBA‚Äù configuration distribution kit and combine it with your application solution based on 1C. <br><br>  In detail the whole process of pre-setting is described in the articles: <br>  <a href="http://profi1c.ru/products/fba_toolkit/podgotovka-rabochego-mesta-razrabotchika.html">Preparation of a workplace of the developer</a> <br>  <a href="http://profi1c.ru/products/fba_toolkit/ustanovka-distributiva-konfiguratsii-fba.html">Installing the ‚ÄúFBA‚Äù configuration distribution</a> <br>  <a href="http://profi1c.ru/products/fba_toolkit/obedinenie-konfiguratsii-fba-s-prikladnyim-resheniem-i-publikatsiya-na-web-servere.html">Combining the ‚ÄúFBA‚Äù configuration with the application solution and publishing it on a web server</a> <br><br>  Setup should not take a lot of time, and most likely, some of the necessary software is already installed. <br><br><h4>  Application Description </h4><br>  Create a mobile application "Report to the head", designed to regularly inform the head of the state of affairs in the enterprise.  The application will consist of 3 screens: <br><ol><li>  ‚ÄúLogin‚Äù - user authorization when starting the program. </li><li>  ‚ÄúList of reports‚Äù is the main screen of our application.  A list of available reports is displayed with the ability to view and update data from the 1C database. </li><li>  ‚ÄúProgram Settings‚Äù - here the user sets the authorization parameters and the address of the 1C server, sets up a schedule of automatic exchange with the 1C server. </li></ol><br><img src="https://habrastorage.org/storage2/2c1/b00/cd5/2c1b00cd57be8a58aa0fa55bfb7e316f.png"><img src="https://habrastorage.org/storage2/227/5f0/98a/2275f098ad38f94e79e5ee798fd47b57.png"><img src="https://habrastorage.org/storage2/09c/759/c79/09c759c79d1c1e822ae781482564e66b.png"><br><br>  The application will implement 2 options for receiving data from 1C server: <br><ol><li>  Report "Goods in warehouses."  It is generated on the server and compiled as an HTML document, simply displayed in the mobile application.  The simplest option, the report form is fixed and can not be changed. </li><li>  Report "Financial indicators".  Here, the initial data for the report are obtained in the form of a table, on which the report is then built.  Advantages of this option: arbitrary report output, incl.  in the form of graphs and charts;  installation of selections and sorting is possible. </li></ol><br><h4>  Creating a mobile application template in 1C </h4><br>  Mobile application development begins in 1C, as it is not surprising.  Here you are determined with the composition of the metadata, configure the exchange scheme and regenerate the template of your future mobile application. <br><br>  Create a new item in the Mobile Applications directory with the name Report to Manager and the identifier <b>SAMPLE_REPORT_HEAD</b> . <br><br>  Select the group <b>‚ÄúExternal data‚Äù</b> in the ‚ÄúMetadata‚Äù list and click the ‚ÄúAdd‚Äù button on the toolbar.  Fill in the parameters of the new table as shown in the picture: <br><br><img src="https://habrastorage.org/storage2/0f4/77f/e11/0f477fe11803204388fa27c46bc079be.png"><br><br>  <b>‚ÄúIndicator‚Äù</b> - test presentation of the report indicator, line (250) <br>  <b>"Value"</b> - the numeric value of the indicator, the number (15.2) <br>  The names of the columns and the table itself, as a rule, are set in Russian, they will be used to fill the table with data using the tools of the embedded language 1C.  Click OK, the table will be added to the metadata tree, for the mobile application the names are automatically translated into Latin. <br><br>  Thus, we have prepared the structure of the table of values ‚Äã‚Äã(in terms of 1C) in which we will transmit data for the Financial Indicators report.  For the second report ‚ÄúGoods in warehouses‚Äù the data will be transmitted as an external file. <br><br>  On the ‚ÄúExchange Scheme‚Äù tab, check that the ‚ÄúUpload‚Äù flag is checked.  The flag "Download" is not important, because  we are not going to process the resulting changes to this table from the mobile application in 1C. <br><br><img src="https://habrastorage.org/storage2/8e4/6a7/70d/8e46a770d5dee77d5bb25fb76443ba1e.png"><br><br>  Save the changes.  Click on the ‚ÄúMobile Application Template‚Äù button on the toolbar, set the parameters of your mobile application <br><br><img src="https://habrastorage.org/storage2/550/f26/ab2/550f26ab21fab567d3479d78ec84a7e6.png"><br><br>  Template Catalog is the path to the directory in which the generated mobile application template files will be saved. <br><br>  On the ‚ÄúBasic‚Äù tab, specify the name of the package, it must be a unique identifier.  If you have a website, use it to generate a prefix.  In this example, I indicated <b>ru.profi1c.samples.report.head</b> <br><br>  The ‚ÄúWeb service‚Äù tab contains the IP address 10.0.2.2, the default is the address of your computer when accessing from the Android emulator.  In the fields ‚ÄúWeb service name‚Äù and ‚ÄúApplication subdirectory‚Äù, enter the data that was specified when publishing the web service. <br><br><img src="https://habrastorage.org/storage2/fbc/3e1/913/fbc3e19138cc85e76fd0ca02483388dd.png"><br><br>  Please note that for 1C 8.2, most likely, you will have the application subdirectory with an additional subdirectory <b>/ ws</b> , ie demoFba / ws, see <a href="http://profi1c.ru/products/fba_toolkit/obedinenie-konfiguratsii-fba-s-prikladnyim-resheniem-i-publikatsiya-na-web-servere.html/3">here</a> for more details. <br>  Click <b>Create</b> , the Android project template will be generated. <br><br><h4>  Preparation of source data for reports in 1C </h4><br>  Open the <b>fba subscription to events</b> module in the 1C configurator and add the following code to the procedure <b>Before Sending an External Table</b> : <br><br><pre><code class="1c hljs"><span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-built_in"><span class="hljs-built_in"></span></span>(.) = <span class="hljs-string"><span class="hljs-string">"SAMPLE_REPORT_HEAD"</span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-comment"><span class="hljs-comment">//    = fba.(" ,   ,  , , , ");  =  (123456789);        = .(); . = .; . = .(0,999999) + Sin(.(0,999)); ; ; </span></span></code> </pre> <br>  In this example, the table is filled with dummy data; in a real application, you can transfer here an arbitrary number of report indicators. <br>  With the data for the first report sorted out, it remains to prepare for the second.  In the same module, fbaSubscribing for Events, add the following code to the PrepareBinaryData for Sending procedure: <br><br><pre> <code class="1c hljs"> = <span class="hljs-literal"><span class="hljs-literal"></span></span>; <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-built_in"><span class="hljs-built_in"></span></span>(.) = <span class="hljs-string"><span class="hljs-string">"SAMPLE_REPORT_HEAD"</span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  = <span class="hljs-string"><span class="hljs-string">"REPORT_PRODUCTS_IN_STOK"</span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  = <span class="hljs-built_in"><span class="hljs-built_in"></span></span>(<span class="hljs-string"><span class="hljs-string">"html"</span></span>);  = <span class="hljs-built_in"><span class="hljs-built_in"></span></span>..(); <span class="hljs-keyword"><span class="hljs-keyword"></span></span> .HTML() <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  = <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-type"><span class="hljs-type"></span></span>(); <span class="hljs-built_in"><span class="hljs-built_in"></span></span>(); <span class="hljs-keyword"><span class="hljs-keyword"></span></span>; <span class="hljs-keyword"><span class="hljs-keyword"></span></span>; <span class="hljs-keyword"><span class="hljs-keyword"></span></span>; <span class="hljs-keyword"><span class="hljs-keyword"></span></span> ;</code> </pre><br>  I will comment on the code.  When a mobile application requests arbitrary data (as a file) with the identifier "REPORT_PRODUCTS_IN_STOK", a report is executed in 1C and the result is stored in a temporary file.  This temporary file is then read as binary data and transferred to the mobile application.  The temporary file is deleted. <br><br>  As in this case, the generated html file is not important for us.  You can use the standard 1C mechanism for saving a tabular document as HTML or generate HTML manually.  You can see an example of the output in the FBA demo configuration, the report ‚ÄúGoods in warehouses‚Äù. <br><br>  With 1C everything, we proceed to the development of a mobile application on Android. <br><br><h4>  Design Android - applications </h4><br>  The template of the Android project created in 1C is imported into the Eclipse workspace. <br><br>  Launch Eclipse and import the project: <b>File&gt; Import ...</b> In the Android group, select the item <b>‚ÄúExists Android Code Into Workspace‚Äù</b> click <b>Next</b> , specify the path to the directory of the Android project template and click <b>Finish</b> , the new project will be added to the workspace.  If there are difficulties, see <a href="http://profi1c.ru/products/fba_toolkit/primer-1-zadachi-dlya-mobilnogo-sotrudnika-chast-1.html/2">here</a> , the process is described in pictures. <br><br>  1. Create a report "Financial indicators", the data source for which is a table of values ‚Äã‚Äãobtained from 1C.  To do this, add a new class ToChiefReport.java, here is the full source code: <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *         sqlite.  *     ¬´ ¬ª * */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToChiefReport</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleMapHtmlReport</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getResIdIcon</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> R.drawable.report_01; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getResIdTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> R.string.report_name_to_chief; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, IReportBuilderResult builderResult)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { makeReport(context); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (SQLException e) { e.printStackTrace(); setHeader1(<span class="hljs-string"><span class="hljs-string">",   !"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.build(context, builderResult); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeReport</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException </span></span>{ DBHelper helper = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DBHelper(context); <span class="hljs-comment"><span class="hljs-comment">//     setHeader2(" "); setTableHeader(" ", ", ."); //       Map&lt;Object, Object&gt; mapData = new LinkedHashMap&lt;Object, Object&gt;(); //       sqlite,   // ¬´ ¬ª ExTableRaportRukovoditelyuDao dao = helper .getDao(ExTableRaportRukovoditelyu.class); List&lt;ExTableRaportRukovoditelyu&gt; rows = dao.select(); for (ExTableRaportRukovoditelyu row : rows) { mapData.put(row.pokazatel, row.znachenie); } setTableData(mapData); } }</span></span></code> </pre><br>  I will comment on the code.  The abstract class SimpleMapHtmlReport, from which it is inherited, is intended for building a simple HTML report with a two-column table. <br>  The first 2 methods getResIdIcon () and getResIdTitle () return the icon and the name of our report to display in the list.  In the event handler of the ‚Äúbuild‚Äù event, the makeReport method is called, in which our implementation of the report compilation. <br>  When building a report, first the report header and table are set, then all records from the local sqlite table are read as rows of the report table.  Finally, in the setTableData () method, set the data for the report table.  <s>Ugh, how difficult it is to comment on obvious things.</s> <br></div></div><br>  2. We create the second report, it is still easier here: <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *   ,   Html .    *     1        * */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductsInStokReport</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleCompiledHtmlReport</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ,       1 (.   // MyExchangeTask) public static final String REPORT_FILE_NAME = "products_in_stok.html"; public ProductsInStokReport(File file) { super(file); } @Override public int getResIdIcon() { return R.drawable.report_02; } @Override public int getResIdTitle() { return R.string.report_name_products_in_stok; } }</span></span></code> </pre></div></div><br>  3. Expand the predefined exchange procedure with the 1C server, i.e.  Let's add one more step to it - receiving data for our second report in the form of a compiled file.  Add the class MyExchangeTask from ExchangeTask: <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *      . *      ‚Äì . * */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyExchangeTask</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExchangeTask</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//       1 private static final String ID_REPORT_PRODUCTS_IN_STOK = "REPORT_PRODUCTS_IN_STOK"; public MyExchangeTask(ExchangeVariant exchangeVariant, WSHelper wsrvHelper, DBOpenHelper dbOpenHelper) { super(exchangeVariant, wsrvHelper, dbOpenHelper); } @Override protected boolean doExecute() throws Exception { //       boolean success = super.doExecute(); if (success) { //    -  2-  onStepInfo(" ‚Ä¶"); String fPath = appSettings.getCacheDir().getAbsolutePath() + "/" + ProductsInStokReport.REPORT_FILE_NAME; File f = wsHelper.getLargeData(ID_REPORT_PRODUCTS_IN_STOK, null, "", fPath); success = (f != null); } return success; } }</span></span></code> </pre><br>  To retrieve the report data, the <b>getLargeData</b> web service <b>method is used</b> , which, if successful, saves the result to a file at the specified path.  Pay attention to the ID_REPORT_PRODUCTS_IN_STOK, it should be the same as in 1C in the method Prepare Binary Data For Sending. <br></div></div><br>  4. Listing reports on the main form.  Open the <b>res \ activity_main.xml</b> file and add a listView which will display the list of reports: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:context</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MainActivity"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:id/list"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListView</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In MainActtiviy.java add: <br><br>  a) local variable for the list <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ListView list;</code> </pre><br>  b) initialization method <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ list = (ListView) findViewById(android.R.id.list); <span class="hljs-comment"><span class="hljs-comment">//       ReportListAdapter adapter = new ReportListAdapter(this,createReportList()); list.setAdapter(adapter); list.setOnItemClickListener(new OnItemClickListener() { @Override public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) { //         IReport report = (IReport) list.getItemAtPosition(position); report.onShow(MainActivity.this); } }); }</span></span></code> </pre><br>  and call it in onCreate () after setting the form layout <br><pre> <code class="java hljs">setContentView(R.layout.activity_main); init();</code> </pre><br>  c) method of initializing the list of reports <br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/* *    */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> List&lt;IReport&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createReportList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ List&lt;IReport&gt; lst = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;IReport&gt;(); <span class="hljs-comment"><span class="hljs-comment">//   ,        //  IReport report = new ProductsInStokReport(new File(getAppSettings() .getCacheDir(), ProductsInStokReport.REPORT_FILE_NAME)); lst.add(report); //        lst.add(new ToChiefReport()); }</span></span></code> </pre><br>  d) the procedure for launching the exchange according to your rules <br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/* *     .  ,    * ( )      */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startExchangeMyRules</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ExchangeVariant variant,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cancelable)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     web- WSHelper wsHelper = new WSHelper(getExchangeSettings()); MyExchangeTask task = new MyExchangeTask(variant, wsHelper, getHelper()); startExchange(task, cancelable); }</span></span></code> </pre><br>  And we change the call to the startExchange exchange procedure (ExchangeVariant.FULL, true) in the onOptionsItemSelected handler to startExchangeMyRules (ExchangeVariant.FULL, true). <br><br>  <b>The application is ready</b> , authorization forms and program settings will be created automatically, we will not change them. <br>  Let's check it on the emulator.  If you are not mistaken anywhere, the application will start.  However, instead of the authorization window, the settings window will be displayed immediately, since the authorization data (user name and password) are not specified. <br><br>  Enter username: <b>ivanov</b> <br>  And password: <b>123456</b> <br><br>  Start the base 1C and open the directory "Mobile employees".  As a mobile device, select the predefined item ‚ÄúDevice Emulator‚Äù, add the ‚ÄúReport to the Manager‚Äù application in the table section ‚ÄúMobile Applications‚Äù and set the same user name and password. <br><br><img src="https://habrastorage.org/storage2/c0e/33a/34b/c0e33a34b474c1e9abd9e98df8f19f7b.png"><br><br>  Run the exchange procedure on the emulator (the button with the ‚ÄúUp‚Äù arrow in the panel on the right) <br><img src="https://habrastorage.org/storage2/9a4/d2a/7a6/9a4d2a7a6aae7a3b5cf43a2fa2225fce.png"><br><br>  The result of the exchange is displayed in the notification: <br><img src="https://habrastorage.org/storage2/ce3/2aa/cc8/ce32aacc87f5a04d2d69e8ca1ea72119.png"><br><br>  Click on it to launch your application (or to view detailed information about the error, if the exchange failed). <br><br>  Check what happened.  Click the report in the list: <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/a4c/d03/f94/a4cd03f944611e636cdac0cd6787126b.png"><img src="https://habrastorage.org/storage2/007/2d2/efb/0072d2efb75e2a05235cc24a39acf944.png"><br>  Fine!  Reports are displayed, you can zoom by button or gestures. <br></div></div><br>  The application is ready, it turned out quite functional and easily expandable.  Adding other reports is easy. <br>  You can transfer documents in various formats, for example * .doc or * .pdf and use external applications to view them.  See the source code of the example, there are 3 more reports: <br><ul><li>  chart using <a href="https://developers.google.com/chart/%3Fhl%3Dru">Google Chart Tools</a> </li><li>  graph using jQuery plugin <a href="http://www.flotcharts.org/">Plot</a> </li><li>  PDF output by external application (PdfReport.java) </li></ul><br>  I will not describe in detail, and so the article turned out great.  If you have any questions, ready to answer in the comments.  Here is the output: <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/25c/037/135/25c037135d5beb682fc49baff9b1d01c.png"><img src="https://habrastorage.org/storage2/e04/07a/aee/e0407aaeee1a17ac5ec9933f471b7a65.png"></div></div><br>  You can download the full code of the sample at <a href="https://xp-dev.com/svn/fba_toolkit_public/samples/fbaSample4ReportHead/">https://xp-dev.com/svn/fba_toolkit_public/samples/fbaSample4ReportHead/</a> <br><br>  Using HTML to build reports allows you to create a variety of reports, including  and with interactive elements.  For example, in one of our projects the following report is used: <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/f76/700/067/f76700067f8a65de2affdeaafb9a28b0.png"><br><br><ul><li>  for the field ‚ÄúDebt‚Äù conditional color design is used depending on the amount; </li><li>  The full list of unpaid invoices is opened only when you click on the ‚ÄúAll‚Äù marker, by default, only the last 4 are displayed. </li></ul></div></div><br>  And of course, you are not limited by anything; you can use third-party libraries to display reports and charts, for example <a href="http://code.google.com/p/achartengine/">achartengine,</a> or create your own graph / chart yourself (full examples, including those in the Android SDK). <br><br>  That's all, with other examples you can find on the site <a href="http://profi1c.ru/">http://profi1c.ru</a> . <br>  In the near future we plan to add lessons on interactive elements and adapters of the FBA library, as well as show how to work with offline <a href="http://code.google.com/p/mapsforge/">mapsforge</a> maps. <br><br><h4>  A spoon of tar </h4><br>  The product ‚ÄúFBA Toolkit‚Äù is planned to be distributed on a commercial basis, now it is in the status of ‚Äúdemo version‚Äù.  You are free to use it for testing and study. <br>  Limitations: <br><ul><li>  the program stops working when the demo license expires  after 12/31/13; </li><li>  When starting, a notification is displayed: </li></ul><br><img src="https://habrastorage.org/storage2/80c/e12/c4e/80ce12c4e696718da58d4cf7e8a37885.png"><br><br>  In the near future (no more than a month) there will be a commercial version, we will add information on the cost and licensing procedure to our site. <br><br>  Thank you for reading to the end.  Ready to answer your questions in the comments on both 1C and Android. </div><p>Source: <a href="https://habr.com/ru/post/176371/">https://habr.com/ru/post/176371/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../176357/index.html">Wiren Board - embedded computer with Wi-Fi, GPRS, GPS, NFC and Ethernet out of the box</a></li>
<li><a href="../176363/index.html">Processing and classification of requests. Part Two: Navigation Queries</a></li>
<li><a href="../176365/index.html">CamTouch project will take part in the final of Microsoft Imagine Cup 2013 from Ukraine</a></li>
<li><a href="../176367/index.html">4G on smartphones: in Russia from 04/10/2013</a></li>
<li><a href="../176369/index.html">Configuring RAID1 + LVM (for file system snapshots) in Hetzner and ServerLoft</a></li>
<li><a href="../176373/index.html">Overview of digital terrestrial television in Ukraine (T2)</a></li>
<li><a href="../176375/index.html">UX / UI. Foreign design experience VS Russia</a></li>
<li><a href="../176381/index.html">The researcher demonstrated the interception of control of the aircraft using an Android application</a></li>
<li><a href="../176383/index.html">E-commerce of the future - ‚ÄúJapanese face‚Äù</a></li>
<li><a href="../176387/index.html">Future productivity growth: long-term perspectives</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>