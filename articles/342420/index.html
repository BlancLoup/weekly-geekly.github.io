<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A new Alina has been detected - a malware for POS terminals.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The presence of recorded data on thousands of bank cards makes POS-terminals a critical system, and therefore it is not surprising that they are becom...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A new Alina has been detected - a malware for POS terminals.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ia/6a/od/ia6aodnkpgqsvvzgekfkfx2h624.jpeg"><br><br>  The presence of recorded data on thousands of bank cards makes POS-terminals a critical system, and therefore it is not surprising that they are becoming an increasingly popular target by cyber-criminals.  Attacking such devices anonymously from the Internet is relatively simple, and selling data on the black market is very profitable. <br><br>  Recently, the PandaLabs anti-virus laboratory detected infections in a large number of bars and restaurants in the USA, whose POS-terminals were attacked by two types of malicious program designed to steal data from bank cards. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The following malware samples were analyzed (the MD5 file is shown in brackets): <br><br>  1. Epson.exe (69E361AC1C3F7BCCE844DE43310E5259) <br>  2. Wnhelp.exe (D4A646841663AAC2C35AAB69BEB9CFB3) <br><br>  Epson.exe is an error certificate: <br><br><img src="https://habrastorage.org/webt/is/ij/vz/isijvzam1kn6nfr_5_2dj1dxhzu.png"><br><br>  Both samples were compiled using Microsoft Visual C ++ 8, and they are not packaged or encrypted.  As soon as the malicious program is launched in the system, it starts analyzing various system processes for searching information on bank cards. <br><br>  Below we can see how they ‚Äúpass‚Äù through various processes, searching for only those processes that may contain data on bank cards in memory: <br><br><img src="https://habrastorage.org/webt/ce/ey/-o/ceey-ocgbd4c0gi63x5vxb20yle.png"><br><br>  In the case of the sample ‚ÄúEpson.exe‚Äù, this program searches for data on bank cards in the following processes: <br><br><img src="https://habrastorage.org/webt/jh/9n/zi/jh9nzicki7pvxx5q6qbvga1mrpe.png"><br><br><table><tbody><tr><td>  <b>The name of the program</b> </td><td>  <b>Description</b> </td></tr><tr><td>  <b>notepad ++. exe</b> </td><td>  Text editor </td></tr><tr><td>  <b>CreditCardService.exe</b> </td><td>  Microsoft </td></tr><tr><td>  <b>DSICardnetIP_Term.exe</b> </td><td>  NETePay for Mercury </td></tr><tr><td>  <b>DSIMercuryIP_Dial.exe</b> </td><td>  NETePay for Mercury </td></tr><tr><td>  <b>EdcSvr.exe</b> </td><td>  Aloha Electronic Draft Capture (EDC) </td></tr><tr><td>  <b>fpos.exe</b> </td><td>  Future POS </td></tr><tr><td>  <b>mxSlipStream4 / mxSlipStream5 / mxSlipStream.exe / mxSwipeSVC.exe</b> </td><td>  SlipStream POS System Transaction Processor by mXpress </td></tr><tr><td>  <b>NisSrv.exe</b> </td><td>  Windows 8 </td></tr><tr><td>  <b>spcwin.exe / Spcwin.exe / SPCWIN.exe / SPCWIN.EXE</b> </td><td>  POSitouch (POS-system for the food industry and fast food) </td></tr></tbody></table><br>  On the other hand, the sample ‚ÄúWnhelp.exe‚Äù contains a list that is used to select processes that should not be analyzed.  Those.  if the name of the process coincides with the name of the object in this list, then such a process will not be analyzed when searching for data on bank cards: <br><br><img src="https://habrastorage.org/webt/j6/nq/al/j6nqaldzp3jjtb3eyeybdwspp1k.png"><br><br>  Excluded processes: <br><br>  explorer.exe <br>  chrome.exe <br>  firefox.exe <br>  iexplore.exe <br>  svchost.exe <br>  smss.exe <br>  csrss.exe <br>  wininit.exe <br>  steam.exe <br>  devenv.exe <br>  thunderbird.exe <br>  skype.exe <br>  pidgin.exe <br>  services.exe <br>  winlogon.exe <br>  alg.exe <br>  wscntfy.exe <br>  taskmgr.exe <br>  spoolsv.exe <br>  QML.exe <br>  AKW.exe <br>  OneDrive.exe <br>  VsHub.exe <br>  Microsoft.VsHub.Server.HttpHost.exe <br>  vcpkgsrv.exe <br>  dwm.exe <br>  dllhost.exe <br>  jusched.exe <br>  jucheck.exe <br>  lsass.exe <br><br>  In both samples, as soon as a process is received that needs to be analyzed (because it was contained in the list, as in the case of Epson.exe, or because it was ‚Äúdropped‚Äù, as in the case of Wnhelp.exe), a new thread is created : <br><br><img src="https://habrastorage.org/webt/df/dv/na/dfdvnaqgkfmsmldxu_gzuzktum0.png"><br><br>  And then a memory analysis is performed using an algorithm specially designed to check whether the information found is data on bank cards: <br><br><img src="https://habrastorage.org/webt/8l/9v/bf/8l9vbfh7pxp4nziaikpiu-8uhm4.png"><br><br>  The sample Wnhelp.exe is executed by attackers using the ‚Äúinstall‚Äù command, and in such a way that a service is created to ensure its ‚Äúsurvivability‚Äù in the system: <br><br><img src="https://habrastorage.org/webt/j-/wg/5_/j-wg5_fpevlec-ftprh6qkbr4v4.png"><br><br>  The service is called ‚ÄúWindows Error Reporting Service Log‚Äù. <br><br><img src="https://habrastorage.org/webt/fj/fn/fy/fjfnfymserslskx6_iyf1xkxmqi.png"><br><br>  The Epson.exe sample works in the same way, although attackers can customize the name of the service as they like, using certain parameters: <br><br>  install [Service name] [Service description] [Third parameter] <br><br>  Each option connects to its management server (C &amp; C): <br><br><table><tbody><tr><td>  <b>Epson.exe</b> </td><td>  <b>dropalien.com/wp-admin/gate1.php</b> </td></tr><tr><td>  <b>Wnhelp.exe</b> </td><td>  <a href="http://www.rdvaer.com/">www.rdvaer.com</a> wp-admin / gate1.php </td></tr></tbody></table><br>  Then they can receive various tasks from hackers: <br><br><table><tbody><tr><td>  <b>Teams</b> </td><td>  <b>Description</b> </td></tr><tr><td>  update = [URL] </td><td>  Malware Update </td></tr><tr><td>  dlex = [URL] </td><td>  Download and upload file </td></tr><tr><td>  chk = [CRC_Checksum] </td><td>  Updates file checksum </td></tr></tbody></table><br>  To connect to the control panel, they use the following UserAgent: <br><br>  ‚ÄúMozilla / 5.0 (Windows NT 6.2; WOW64) AppleWebKit / 537.22 (KHTML, like Gecko) Chrome / 25.0.1364.152 Safari / 537.22‚Äù <br><br>  Communications are done over SSL.  The malicious program modifies the Internet connection configuration to ignore unknown CA (Certificate Authorities), with the help of which it is possible to use its own certificate. <br><br>  First, the Internet security flags are received via the InternetQueryOptionA API with the third argument set to the INTERNET_OPTION_SECURITY_FLAGS (31) value.  After that, a binary file is executed with the SECURITY_FLAG_IGNORE_UNKNOWN_CA (100h) flag. <br><br>  <b>Conclusion: How to counter POS-attack</b> <br><br>  Attacks to POS terminals remain very popular, especially in countries such as the USA, where the use of Chip &amp; PIN is not mandatory.  Many of these attacks are aimed at enterprises that do not have specialized personnel in the field of IT, especially in the field of information security, and therefore hackers use such opportunities. <br><br>  POS terminals are computers that handle critical data, and therefore must be protected at the highest possible level.  <a href="https://habrahabr.ru/company/panda/blog/325710/">Cloud solutions with EDR technology</a> help ensure there are no malicious processes on such terminals.  Therefore, there is no need to hire experts with special knowledge, because such solutions are serviced by our own development experts, who are responsible for ensuring that all executable processes are safe. </div><p>Source: <a href="https://habr.com/ru/post/342420/">https://habr.com/ru/post/342420/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342404/index.html">Javascript: the path to code clarity</a></li>
<li><a href="../342406/index.html">Kali Linux: packages modification, kernel build, and ISO image creation exercises</a></li>
<li><a href="../342408/index.html">Russian AI Cup 2017 - beta test report, start of the championship. StarCraft wanted, got weird Total War</a></li>
<li><a href="../342410/index.html">Writing x86-64 JIT compiler from scratch in stock Python</a></li>
<li><a href="../342412/index.html">Kubernetes success stories in production. Part 5: Monzo Digital Bank</a></li>
<li><a href="../342424/index.html">Atmega328p + ENC28J60 = Bridge between UART and Ethernet</a></li>
<li><a href="../342426/index.html">How to create graphics for VR - Google recommendations</a></li>
<li><a href="../342428/index.html">1000 ++ way to run commands on a remote computer</a></li>
<li><a href="../342430/index.html">Interns</a></li>
<li><a href="../342432/index.html">Do I need the OPTIONS method in REST services?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>