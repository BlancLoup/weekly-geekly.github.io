<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Perfect shuffle</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have always been attracted to elementary algorithms with which you can create complex patterns. There is something fundamental in such algorithms. O...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Perfect shuffle</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/f0/a5/59f0a58e22ba0685844423.png"></div><br>  I have always been attracted to elementary algorithms with which you can create complex patterns.  There is something fundamental in such algorithms.  One of these algorithms is Perfect Shuffle.  Let's look at its unusual properties, and also try to draw some impressive fractals using this algorithm. <br><br>  Further there are a lot of pictures, gif-animations and some music. <br><a name="habracut"></a><br>  Perfect Shuffle is known among gamblers-magicians.  They call it Faro Shuffle.  Recently, I also wanted to learn how to show card tricks.  How do tricks begin?  With the development of manual dexterity.  After turning the pack of cards for a week, I mastered the basic ways of shuffling - ‚ÄúRiffle Shuffle‚Äù, ‚ÄúFaro Shuffle‚Äù, ‚ÄúCharlier Pass‚Äù.  While practicing Faro Shuffle, I once arranged the deck so that all black suits are at the beginning of the deck, and the red suits are at the end.  Having made Faro Shuffle several times, he paid attention to the unusual order of cards in the deck.  Card postponed and sat down to program. <br><br>  This algorithm changes the order of the elements in the array (shuffles the array).  This algorithm is elementary: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1. We divide the array into two equal parts. <br>  2. Elements from the first half of the array are placed in even positions.  From the second - on the odd. <br><br>  Clearly: <br><br><img src="https://habrastorage.org/webt/59/f0/c2/59f0c258689be693972011.png"><br><br>  Even clearer: <br><br><div class="spoiler">  <b class="spoiler_title">Javascript:</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shuffle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">array</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> half=array.length/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       var temparray=[]; for(var i=0;i&lt;half;i++){ temparray[i*2]=array[i+half]; //     temparray[i*2+1]=array[i]; } return temparray; } var array=[1, 2, 3, 4, 5, 6, 7, 8]; array=shuffle(array); console.log(array); // [5, 1, 6, 2, 7, 3, 8, 4]</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Small lyrical digression</b> <div class="spoiler_text">  This option is the Perfect Shuffle gamblers called "in-shuffle".  There is another option (‚Äúout-shuffle‚Äù) - elements from the first half of the array are placed in odd positions: <br><br><img src="https://habrastorage.org/webt/59/f0/c6/59f0c6f0c9e5a145424353.png"><br><br>  As you can see, the extreme elements remain in their positions, and the middle of the array is mixed with the same in-shuffle.  Option out-shuffle is not considered further. <br><br>  In addition, we do not consider the option when the number of elements in the array is odd - the last element in the array remains in its position. <br></div></div><br>  The algorithm has several noteworthy properties.  If you mix the array several times - after n iterations, all elements will return to their original position!  It is obvious.  The algorithm is deterministic.  For each next state of the array, there is only one unique previous state.  The number of all possible states is limited by the length of the array.  If we mix the array iteratively, sooner or later we will exhaust the possible states and go through the second circle.  In fact, it will happen much earlier.  The number of iterations required to return the array to its initial state is less (or equal) to the number of elements in the array.  ‚ÄúLess or equal‚Äù - all that can be said about the number of iterations. <br><br>  For an array of 12 elements, 12 iterations will suffice: <br><br><img src="https://habrastorage.org/webt/59/f0/ce/59f0ce4d7da57797540724.png"><br><br>  For an array of 14 elements, only 4 iterations will suffice: <br><br><img src="https://habrastorage.org/webt/59/f0/cf/59f0cf10e3b2b972779140.png"><br><br>  In the picture below (clickable) we mix arrays with lengths from 2 elements to 20: <br><br> <a href=""><img src="https://habrastorage.org/webt/59/f0/cf/59f0cf7b94d08581254571.png"></a> <br>  <i>(unshuffle)</i> <br><br>  The listed arrays are returned to their original state on <br>  2, 4, 3, 6, 10, 12, 4, 8, 18, 6 <br>  iterations.  Sequence <a href="https://oeis.org/A002326">A002326</a> <br><br><div class="spoiler">  <b class="spoiler_title">Javascript</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a002326</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>{ a*=<span class="hljs-number"><span class="hljs-number">2</span></span>; a%=<span class="hljs-number"><span class="hljs-number">2</span></span>*n+<span class="hljs-number"><span class="hljs-number">1</span></span>; m++; }<span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(a&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n=<span class="hljs-number"><span class="hljs-number">1</span></span>;n&lt;<span class="hljs-number"><span class="hljs-number">11</span></span>;n++){ m=a002326(n); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(m); }</code> </pre> </div></div><br>  Build a graph!  On the graph on the <b>X</b> axis, we note the number of elements in the array (divided by 2).  <b>Y</b> axis - the number of iterations.  White dots denote the initial states of the arrays (the origin is the upper left corner): <br><br><img src="https://habrastorage.org/webt/59/f0/d9/59f0d9103a7c0197965270.png"><br><br>  Agree, the points on the chart are placed chaotically. <br><br>  Another unusual property of Perfect Shuffle is that after a certain number of iterations, the order of the elements in the array may be reversed.  Above in the picture we mixed an array of 12 elements.  The order of the elements is reversed at the 6th iteration.  Let's draw one more graph on which we will mark arrays with the reverse order of elements: <br><br><img src="https://habrastorage.org/webt/59/f0/d9/59f0d91e71a5b042472770.png"><br><br>  Again, the placement of points is no less chaotic. <br><br>  It is very interesting to watch the movement of elements in the array!  As elements from the first half of the array in the aggregate, and a specific (first) element in particular. <br><br>  Fill the first half of the array with zeros, the second with units (hereafter, zeroes in the pictures are black pixels, ones are white).  In the pictures below, each line ( <b>X</b> ) is an array state.  <b>Y</b> - iteration. <br><br>  Several arrays (142-150 elements): <br><br> <a href=""><img src="https://habrastorage.org/webt/59/f0/e1/59f0e173e6e1a494534941.png"></a> <a href=""><img src="https://habrastorage.org/webt/59/f0/e1/59f0e173c464f688553413.png"></a> <a href=""><img src="https://habrastorage.org/webt/59/f0/e1/59f0e174184c2603824511.png"></a> <a href=""><img src="https://habrastorage.org/webt/59/f0/e1/59f0e1742b63f526546037.png"></a> <a href=""><img src="https://habrastorage.org/webt/59/f0/e1/59f0e1744be7d263918027.png"></a> <br>  <i>Pictures are clickable</i> <br><br>  288 elements (144 * 2): <br><br><img src="https://habrastorage.org/webt/pm/a1/52/pma152yulqsic1o1yh5utxasy1w.png"><br><br>  610 items: <br><br><img src="https://habrastorage.org/webt/59/f0/e2/59f0e2bc835d5519613640.png"><br><br><div class="spoiler">  <b class="spoiler_title">For other array lengths</b> <div class="spoiler_text">  A small <a href="http://xcont.com/perfectshuffle/">script</a> that draws such wonderful pictures.  We drive in the size of the array (half of the array), click "Draw". <br></div></div><br><div class="spoiler">  <b class="spoiler_title">By the way</b> <div class="spoiler_text">  He described one remarkable method of visualizing binary sequences in <a href="https://habrahabr.ru/post/194406/">his first article.</a> <br>  An array of 142 elements at the 55th iteration looks like this: <br>  0011001100011001100011001100011001100111001100111001100111001100111001100110001100110001100110001100110001100110011100110011100110011100110011 <br>  This sequence can be driven <a href="http://xcont.com/prch/1102.php">here</a> and look at this array more clearly: <br><br><img src="https://habrastorage.org/webt/59/f0/f6/59f0f6880c577205936187.png"><br><br><div class="spoiler">  <b class="spoiler_title">A cellular automata as a wonderful look!</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/59/f0/f7/59f0f7ccd69fa378697603.gif"><img src="https://habrastorage.org/webt/59/f0/f7/59f0f75b3de36134900032.gif"><br><img src="https://habrastorage.org/webt/59/f0/f7/59f0f7dd7375e097917897.gif"><img src="https://habrastorage.org/webt/59/f0/f7/59f0f7ea68276921388521.gif"><br><br><img src="https://habrastorage.org/webt/59/f0/f7/59f0f79c62c54484148352.gif"><br></div></div></div></div><br>  As you can see, here too we have total chaos.  Let's observe a separate element and its trajectory in the array. <br><br>  An array of 610 elements.  Only the first item is filled: <br><br><img src="https://habrastorage.org/webt/qv/2-/_o/qv2-_ocjwjhxsd9ycdpdi4px7us.png"><br><br>  In general, for a single element, it is not necessary to mix the entire array.  The position of a specific element at the next iteration can be calculated by the formula: <br><br><img src="https://habrastorage.org/webt/59/f0/ec/59f0ec4c976a8443465742.png"><br>  <i>( <b>Y</b> is the length of the array)</i> <br><br>  The first arrays (with lengths from 2 to 22): <br><br><img src="https://habrastorage.org/webt/59/f0/ec/59f0ecd767eef711696414.png"><br><br>  In the picture above: in the upper part of the picture is the array and the position of the element at each iteration, in the lower part of the line - all possible positions of the element.  As you can see, the trajectory of the element inside the array is also not obvious.  To finally verify this - from these lines we will make one more graph, adding them up as follows: <br><br> <a href=""><img src="https://habrastorage.org/webt/59/f0/ee/59f0eea06b61f948107810.png"></a> <br>  <i>Clickable</i> <br><br>  Black pixels are those positions in the array that the first element does not fall into when mixed. <br><br>  We could stop at this, but we will go even further!  Observe the movement of all elements in the array.  For this we go to the matrices. <br><br>  But before moving on to the mixing of matrices, I will show two more foci with arrays. <br><br>  In the second half of the array, we reverse the order of the elements (at each iteration): <br><br><img src="https://habrastorage.org/webt/sh/v4/rv/shv4rv9ndqahddzzsfa5nvoilfo.png"><br><br>  In the second half we invert the elements: <br><br><img src="https://habrastorage.org/webt/tt/aq/bp/ttaqbpjhamr8b8hounz8bopsou0.png"><br><br>  These two operations will still be useful to us. <br><br>  Let's go to the matrices! <br><br>  Fill in the matrix, in the first row - the first element, in the second - the second, etc.  In other words, draw a diagonal: <br><br><img src="https://habrastorage.org/webt/ab/dp/qv/abdpqvrpxkmq2vhznxfxhr4ybbc.png"><br><br>  Shuffle the columns in the matrix using Perfect Shuffle.  So we can see where all the elements fall after mixing.  Matrix 80x80: <br><br><img src="https://habrastorage.org/webt/jm/xl/_d/jmxl_dhks_bpv9zoe_xqfy8thc4.png"><br><br>  There is clearly lacking another diagonal: <br><br><img src="https://habrastorage.org/webt/0k/2x/vm/0k2xvmwoscfbkydtr6lhbce42j0.png"><br><br>  A very curious moire is obtained.  Matrix 242x242 from 27 to 35 iteration: <br><br><img src="https://habrastorage.org/webt/un/iq/au/uniqauubhq29j5fswfzzaknchr4.png"><br><br>  Well, if you have already started to mix columns in the matrix using Perfect Shuffle - why not mix the lines? <br><br>  We modify our function a bit: <br><br><div class="spoiler">  <b class="spoiler_title">A function that mixes rows and columns in a matrix.</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shufflecr</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">array</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> half=array.length/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> temparray=[]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x=<span class="hljs-number"><span class="hljs-number">0</span></span>;x&lt;half;x++){ temparray[x*<span class="hljs-number"><span class="hljs-number">2</span></span>]=[]; temparray[x*<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>]=[]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y=<span class="hljs-number"><span class="hljs-number">0</span></span>;y&lt;half;y++){ temparray[x*<span class="hljs-number"><span class="hljs-number">2</span></span>][y*<span class="hljs-number"><span class="hljs-number">2</span></span>]=array[x+half][y+half]; temparray[x*<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>][y*<span class="hljs-number"><span class="hljs-number">2</span></span>]=array[x][y+half]; temparray[x*<span class="hljs-number"><span class="hljs-number">2</span></span>][y*<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>]=array[x+half][y]; temparray[x*<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>][y*<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>]=array[x][y]; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> temparray; }</code> </pre> </div></div><br>  We divide the matrix into 4 parts.  Mix the columns.  Mix the strings.  We get a new matrix.  Clearly: <br><br><img src="https://habrastorage.org/webt/pp/bh/yx/ppbhyxplwevxxxwt-su0huevam0.png"><br><br>  The diagonals shuffle are pretty boring: <br><br><img src="https://habrastorage.org/webt/ze/su/jl/zesujlcvnudroby5epr489gvqic.png"><br><br>  It may even seem that in the function somewhere an error and the matrix is ‚Äã‚Äãnot mixed.  Shift the diagonals one pixel to the right: <br><br><img src="https://habrastorage.org/webt/rr/us/oe/rrusoebgkrccvbohxipj93_1oqa.png"><br><br>  Wonderful.  The function works, the matrix is ‚Äã‚Äãmixed.  True, again quite boring.  Let's try to fill the matrix with some kind of pattern.  In a random place draw a square: <br><br><img src="https://habrastorage.org/webt/ck/m9/nt/ckm9ntdv8rpbcyhsbvry9h2omxs.png"><br>  <i>The size of the matrix 80x80 was not chosen by chance.</i>  <i>When mixing an array of 80 elements in length, at the 27th iteration, the order of the elements is reversed.</i> <br><br>  Let's move this square! <br><br><img src="https://habrastorage.org/webt/2o/m_/et/2om_etw_lvse2qiuonuiq4dsl6o.gif"><br><br>  Here you can see one very interesting property, but even better this property is visible if you draw a circle: <br><br><img src="https://habrastorage.org/webt/nh/nb/lr/nhnblrexjqxj9xtjbmvbfmzvcfq.png"><br><br>  Pay attention to edge effects.  Our matrix collapses into a torus!  This is clearly seen in the second iteration. <br><br>  Move: <br><br><img src="https://habrastorage.org/webt/xt/fs/dt/xtfsdtyrmcpmq3tnels51ns6tgs.gif"><br><br><div class="spoiler">  <b class="spoiler_title">By the way</b> <div class="spoiler_text">  Perfect Shuffle has a curious connection with trigonometry. <br><br>  Above, we mixed the array and got some great pictures.  One of them (144 * 2): <br><br><img src="https://habrastorage.org/webt/pm/a1/52/pma152yulqsic1o1yh5utxasy1w.png"><br><br>  We also write it in the matrix and mix: <br><br><img src="https://habrastorage.org/webt/aq/et/vk/aqetvkqhofx_ixqcb5zbpjvldl4.png"><br><br>  Or even so.  Take the original pattern: <br><br><img src="https://habrastorage.org/webt/pm/a1/52/pma152yulqsic1o1yh5utxasy1w.png"><br><br>  And leave pixels on it with coordinates x * 4 + i, y * 4 + j.  For i = 2, j = 2: <br><br><img src="https://habrastorage.org/webt/5m/iq/bj/5miqbjm1amxkl3sjfovlms3zvi4.png"><br><br>  Remove empty columns and rows: <br><br><img src="https://habrastorage.org/webt/h_/v3/fg/h_v3fg3ezvdqkydyjb3lb5gpkha.png"><br><br>  For other i and j (actually made perfect unshuffle - divided the matrix into 16 parts): <br><br><img src="https://habrastorage.org/webt/5l/wz/xh/5lwzxhzjd_1m3b4liemosbpdtpw.png"><br><br>  Familiar patterns!  Similar patterns can be drawn using the <a href="http://xcont.com/trigonometry/sin0.html">z = sin (n * x / y)</a> and <a href="http://xcont.com/trigonometry/sin1.html">z = sin (n * x * y)</a> trigonometric functions. <br><br>  Graph of the function z = sin (3 * x * y).  If z&gt; = 0 - white pixel.  If z &lt;0 is black: <br><br><img src="https://habrastorage.org/webt/zw/qm/y0/zwqmy0qfm2pifvyjomy30ui4lnq.png"><br><br>  z = sin (13 * x * y): <br><br><img src="https://habrastorage.org/webt/nj/9_/da/nj9_dafjz4qyrcgjrdaf_d97rza.png"></div></div><br>  One of the interesting patterns: <br><br><img src="https://habrastorage.org/webt/sk/id/eg/skidegavrihwhif97yiwujyuwco.png"><br><br>  We can make a fill to highlight closed areas: <br><br><img src="https://habrastorage.org/webt/44/qi/aq/44qiaq8ds5ntnd-89b1nohil2sa.png"><br><br><div class="spoiler">  <b class="spoiler_title">By the way</b> <div class="spoiler_text">  The old, kind and well-loved donkey (Internet Explorer) does not use any clever image reduction algorithms.  It simply takes and throws out every nth column and nth row of pixels from the image.  If we don‚Äôt throw them away, but put them into separate matrices, we get the process (unshuffle) of the inverse Perfect Shuffle (with n = 2). <br>  Actually, it's pretty cool!  We can take this pattern: <br><br><img src="https://habrastorage.org/webt/90/c9/ag/90c9agzzn3i8vy3luiirmfxj7o0.png"><br><br>  And a little squeeze it a donkey: <br><br><img src="https://habrastorage.org/webt/77/od/iu/77odiue49osnkynohspek5jmnfe.png"><br><br>  Got a familiar pattern. <br><br>  You can play with other templates: <br><br><img src="https://habrastorage.org/webt/pb/0x/yc/pb0xycdd9g8om8gxxohcol7ib8a.png"><br><br>  Squeezed a donkey: <br><br><img src="https://habrastorage.org/webt/xp/nk/2r/xpnk2rr3qdxclhlpmk-c4icdyz0.png"></div></div><br><br>  Recall the tricks (reversing the order of elements and invert). <br><br>  Changing the order of the elements gives very interesting patterns!  One of them: <br><br><img src="https://habrastorage.org/webt/cq/v_/ja/cqv_jab4-xggakyb6lcwqwwuuak.png"><br><br>  With fill: <br><br><img src="https://habrastorage.org/webt/lf/ur/lk/lfurlk105yxr7zywdajxw54zcaq.png"><br><br>  Other patterns are no less interesting, but we will not dwell on them.  It is much more interesting to watch the inversion. <br><br>  For this experiment, we have enough of an empty matrix.  Divide it into 4 parts.  Two of them are inverted.  Stir.  At the first iteration, nothing unusual: <br><br><img src="https://habrastorage.org/webt/0q/cp/hv/0qcphvhl8rhamsnc-gzi7pprj1e.png"><br><br>  But further curious patterns appear: <br><br><img src="https://habrastorage.org/webt/kd/ss/k8/kdssk8zj6atdn2jq04tkwt7yloc.png"><br><br>  To figure out where these patterns come from, let us go back to the arrays again.  Before that, we used matrices and arrays of fixed length.  Let's try to change the approach a little - we will gradually increase the length: <br><br>  1. Create an array of n elements. <br>  2. Make a copy of it. <br>  3. Shuffle the copy with the original using Perfect Shuffle.  Got an array of n * 2 elements. <br>  4. Return to step 2. <br>  We will invert the copy each time. <br><br>  Let's start with an array of two elements - 1 and 0 <br>  10 - source array <br>  10, 01 - array and inverted copy <br>  0110 - mixed <br>  0110, 1001 - array and inverted copy <br>  10010110 <br>  10010110, 01101001 <br>  0110100110010110 <br>  ‚Ä¶ etc. <br><br>  Received Morse-Thue sequence ( <a href="https://oeis.org/A010060">A010060</a> ) - the simplest fractal! <br><br>  And back to the matrices.  This is where pure art begins.  Before that, we divided the matrix into 4 parts and mixed these parts.  Let's try to copy the matrix, perform some elementary actions on copies and mix the original with copies. <br><br>  With matrices we can produce 15 elementary actions.  Action 0 - no change matrix.  Steps 1-7 are different ways to rotate the matrix.  Steps 8-15 are invert.  Clearly: <br><br><img src="https://habrastorage.org/webt/rf/gj/q2/rfgjq2sw8ebx_nb0ikvavc1-ip8.png"><br><br>  As an example, we perform 0, 0, 7, 7 actions on copies. Step 7 - rotate the matrix by 90 ¬∞. <br><br><img src="https://habrastorage.org/webt/yb/3v/th/yb3vthmiu2szo9a2tkxahhlbn7u.png"><br><br>  Next iteration: <br><br><img src="https://habrastorage.org/webt/dn/wd/9g/dnwd9guwkansr8b0jo6-6mzklg8.png"><br><br>  ... the eighth iteration: <br><br><img src="https://habrastorage.org/webt/nm/p7/5b/nmp75bmugmw8exgocddxt6o1pd0.png"><br><br>  A very unusual fractal turned out. <br><br><div class="spoiler">  <b class="spoiler_title">By the way</b> <div class="spoiler_text">  A similar way to draw fractals came up as a student.  Perform the same actions, but without mixing the matrix using Perfect Shuffle. <br><br>  Actions 0, 0, 7, 7. First iteration: <br><br><img src="https://habrastorage.org/webt/vf/xu/ic/vfxuicqpiye2pc0z3yf6iqnbowm.png"><br><br>  Second iteration: <br><br><img src="https://habrastorage.org/webt/rk/u6/n3/rku6n3oxtwupj1nyko8zuic6cms.png"><br><br>  Eighth: <br><br><img src="https://habrastorage.org/webt/zq/il/_b/zqil_bvfuphntjojvcz9bpgmz4o.png"><br><br>  And now two focus. <br><br>  We put on top of the copy of the image with transparent white pixels, rotate the copy by 90 ¬∞: <br><br><img src="https://habrastorage.org/webt/0h/dy/ad/0hdyadhdvzmyz2dijljaso-5gbm.png"><br><br>  The copy is rotated vertically: <br><br><img src="https://habrastorage.org/webt/zu/ur/f-/zuurf-4wu1jq57yp4pbu1eoejki.png"></div></div><br><br>  By combining the listed actions, you can draw 16 ^ 4 = 65536 fractals.  Some of them: <br><br>  <i>Drawn in 6 iterations.</i>  <i>Pictures are clickable (8 iterations).</i> <br> <a href=""><img src="https://habrastorage.org/webt/45/2g/_z/452g_z0phqdequkra4cqzuh3o5c.png"></a> <a href=""><img src="https://habrastorage.org/webt/rs/ls/0i/rsls0ixru2tldujzgwszgc6yy98.png"></a> <a href=""><img src="https://habrastorage.org/webt/wu/kt/fz/wuktfzwq9822m005qlwxe1si2za.png"></a> <a href=""><img src="https://habrastorage.org/webt/uc/uc/cn/ucuccndnvjxua52nbzu9jkgofqm.png"></a> <a href=""><img src="https://habrastorage.org/webt/ro/ta/bx/rotabxrfv8hcsmarbb-eesxjo-s.png"></a> <br> <a href=""><img src="https://habrastorage.org/webt/su/ew/sy/suewsy-h6flnzbs37lixsjzldvc.png"></a> <a href=""><img src="https://habrastorage.org/webt/f0/ed/fq/f0edfqys01iswv2h6ehqtuhzm4s.png"></a> <a href=""><img src="https://habrastorage.org/webt/7j/sd/aw/7jsdawzc-824g-wskief5kt76cw.png"></a> <a href=""><img src="https://habrastorage.org/webt/eo/qy/id/eoqyidd8clkdshf3cbmpunh-xdu.png"></a> <a href=""><img src="https://habrastorage.org/webt/lm/zp/6x/lmzp6xy_rhzah8zzufaokaozexo.png"></a> <br> <a href=""><img src="https://habrastorage.org/webt/f1/w6/7b/f1w67bje8_b0j1gqnxzqhixwesk.png"></a> <a href=""><img src="https://habrastorage.org/webt/f5/oe/ui/f5oeuixf2icezstjb6ultje9ii0.png"></a> <a href=""><img src="https://habrastorage.org/webt/d1/rl/uv/d1rluvog-0a7oglfr3kchvnohm0.png"></a> <a href=""><img src="https://habrastorage.org/webt/jf/_w/gx/jf_wgxjgx2bf270pm_wyw69jfza.png"></a> <a href=""><img src="https://habrastorage.org/webt/e6/pv/pj/e6pvpjrzwrjtkcwiz3m3yqh5ris.png"></a> <br> <a href=""><img src="https://habrastorage.org/webt/yw/gu/br/ywgubre3eeoxl34_o2d4p8_bk1a.png"></a> <a href=""><img src="https://habrastorage.org/webt/ro/os/nu/roosnuu2oowjunsaj81pvj8f2hm.png"></a> <a href=""><img src="https://habrastorage.org/webt/wt/zv/-d/wtzv-deqsexmwuu3_mws_fkizhy.png"></a> <a href=""><img src="https://habrastorage.org/webt/xd/cp/pc/xdcppcwnki4m1dmfmdn-upwr2ae.png"></a> <a href=""><img src="https://habrastorage.org/webt/85/cb/c4/85cbc449h_xdszy7bbahczg22ci.png"></a> <br> <a href=""><img src="https://habrastorage.org/webt/4h/pu/mn/4hpumnz7v7hkyryoq-etxgpl1lk.png"></a> <a href=""><img src="https://habrastorage.org/webt/dg/d8/yv/dgd8yvxfvvty7zvdrp1zr61gwqw.png"></a> <a href=""><img src="https://habrastorage.org/webt/pd/hl/t-/pdhlt-9icdflnwmpxkxz38_1uba.png"></a> <a href=""><img src="https://habrastorage.org/webt/rs/_e/ux/rs_eux9ydpyp8vzcijstl4lei64.png"></a> <a href=""><img src="https://habrastorage.org/webt/4c/p2/qj/4cp2qj8a2mcsejd68zv94wu96oy.png"></a> <br> <a href=""><img src="https://habrastorage.org/webt/s8/ur/ie/s8uriexfllt6b0a5x9o17nqgl7g.png"></a> <a href=""><img src="https://habrastorage.org/webt/g6/w3/ov/g6w3ovaa8g1zudlpn-voaazyeay.png"></a> <a href=""><img src="https://habrastorage.org/webt/ax/k-/9h/axk-9hlvan8yk650eij7q9cpomo.png"></a> <a href=""><img src="https://habrastorage.org/webt/xw/ld/co/xwldcoqo0svunpflwusv-vz-6_8.png"></a> <a href=""><img src="https://habrastorage.org/webt/71/jc/_s/71jc_svyynnjhwc96ha4167rx4g.png"></a> <br> <a href=""><img src="https://habrastorage.org/webt/5q/pk/fj/5qpkfjgnvcwmzx-wlpzzfwvm7w0.png"></a> <a href=""><img src="https://habrastorage.org/webt/ww/5f/f7/ww5ff7haxfuxmmrvytc9ilbbo_m.png"></a> <br><br>  But these pull on the masterpiece: <br><br>  15, 5, 9, 5: <br><img src="https://habrastorage.org/webt/qf/k9/j1/qfk9j1tiqgyijnktucujk1w7-kg.png"><br><br>  3, 5, 9, 5: <br><img src="https://habrastorage.org/webt/x7/7y/nk/x77ynkviekxi1ukvp18jtbbj7li.png"><br><br>  13, 7, 11, 11: <br><img src="https://habrastorage.org/webt/tr/m4/pn/trm4pnv7ibwj9qqsqb1mx9vwt-c.png"><br><br>  0, 0, 7, 13: <br><img src="https://habrastorage.org/webt/0-/s3/qm/0-s3qm0qbepfgguh7tu5g-spumg.png"><br><br>  1, 1, 4, 14: <br><img src="https://habrastorage.org/webt/tx/gd/eq/txgdeqkttxbfx0jjdz0xkmaq6ty.png"><br><br>  Other fractals can be drawn <a href="http://fractal.xcont.com/permutations.html">here.</a> <br><br>  These are the "card tricks" turned out.  I think this can be temporarily stopped (you can mix three-dimensional matrix, but more on that another time). <br><br><div class="spoiler">  <b class="spoiler_title">For those who read to this place</b> <div class="spoiler_text">  I tried to write a generator of melodies based on a genetic algorithm.  Each tune consists of note-genes.  If the genes of descendants mix randomly - it turns out cacophony.  But if you mix them using Perfect Shuffle, you get curious melodies.  One of them: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><div class="spoiler">  <b class="spoiler_title">By the way</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ne/2l/8b/ne2l8bj3pvdxnnizsknt_y0_0dk.png"><br><br><img src="https://habrastorage.org/webt/r9/mz/pn/r9mzpnfraq7vcnmqmbmgjeosufu.jpeg"><br><br><img src="https://habrastorage.org/webt/bz/qo/mw/bzqomwmsaepoix293assixe_4tm.jpeg"></div></div></div><p>Source: <a href="https://habr.com/ru/post/340964/">https://habr.com/ru/post/340964/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340954/index.html">Cisco Sales Associate Program</a></li>
<li><a href="../340956/index.html">Requirements analysis</a></li>
<li><a href="../340958/index.html">How to apply neurotechnology in practice: hakaton Neuromedia-2017</a></li>
<li><a href="../340960/index.html">IdM implementation. Part 2. How to determine what is worth thinking about the implementation of IdM?</a></li>
<li><a href="../340962/index.html">Lenovo solutions for data centers. Part 2</a></li>
<li><a href="../340966/index.html">High-quality image reduction in constant time</a></li>
<li><a href="../340968/index.html">Window shop in Vivaldi 1.13.997.3</a></li>
<li><a href="../340972/index.html">10 most simple and frequent mistakes on sites</a></li>
<li><a href="../340974/index.html">Student supercomputer competitions: instructions for use</a></li>
<li><a href="../340976/index.html">Photo storage and upload architecture in Badoo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>