<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>TestMace. Fast start</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. We slowly step out of the shadows and continue the series of articles about our product. After the previous review article we received a lot of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>TestMace. Fast start</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/yo/d3/vp/yod3vplmpqyuhmz0bskb7bnuzaa.png"></p><br><p>  Hello.  We slowly step out of the shadows and continue the series of articles about our product.  After the <a href="https://habr.com/ru/post/458372/">previous</a> review article we received a lot of feedback (mostly positive), suggestions and bug reports.  Today we will show <a href="https://client.testmace.com/">TestMace</a> in action and you will be able to appreciate some of the features of our application.  For a more complete immersion, I advise you to refer to our documentation at <a href="http://docs-ru.testmace.com/">http://docs-ru.testmace.com</a> .  So, let's go! </p><a name="habracut"></a><br><h1 id="ustanovka">  Installation </h1><br><p>  Let's start with the trivial.  The application is available and actually tested on three platforms - Linux, Windows, MacOS.  You can download the installer for the OS of interest from <a href="https://client.testmace.com/">our site</a> .  For Linux users it is possible to install a <a href="https://snapcraft.io/testmace">snap package</a> .  We really hope that hands will soon reach Microsoft Store and the App Store (Is it necessary? What do you think?). </p><br><h1 id="podopytnyy-scenariy">  Experimental scenario </h1><br><p>  As a test subject, we chose the following standard scenario: </p><br><ul><li>  log in: user - admin, password - password </li><li>  add new record </li><li>  check correct entry </li></ul><br><p>  We will test on <a href="https://testmace-quick-start.herokuapp.com/">https://testmace-quick-start.herokuapp.com/</a> .  This is a regular <a href="https://github.com/typicode/json-server">json-server</a> , great for testing such applications.  We just added a token authorization to all json-server routes and made a login method to get this token.  We will move progressively, gradually improving our project. </p><br><h2 id="sozdanie-proekta-i-popytka-sozdat-suschnost-bez-avtorizacii">  Creating a project and trying to create an entity without authorization </h2><br><p>  First, create a new project ( <strong>File</strong> -&gt; <strong>New project</strong> ).  If you are launching the application for the first time, the new project will open automatically.  To begin, let's try to make a request to create a new record (all of a sudden the creation of records is available without authorization).  Select <strong>Add node</strong> -&gt; <strong>RequestStep</strong> from the node's context menu.  We specify <strong>create-post</strong> as the host name.  As a result, a new node will be created in the tree and the tab of this node will open.  We set the following query parameters: </p><br><ul><li>  Request Type: POST </li><li>  url: <a href="https://testmace-quick-start.herokuapp.com/posts">https://testmace-quick-start.herokuapp.com/posts</a> </li><li> Request body: json with value <code>{"title": "New testmace quick start post"}</code> <br>  If you did everything correctly, the interface will look like this: </li></ul><br><p><img src="https://habrastorage.org/webt/lw/-x/yc/lw-xyc0el0cogukda4cqpfxcwts.png"></p><br><p>  However, if we try to execute the request, the server will return 401 code and without authorization, nothing shines on this server.  Well, in general, it is expected). </p><br><h2 id="dobavlyaem-zapros-na-avtorizaciyu">  Add authorization request </h2><br><p>  As already mentioned, we have POST endpoint <code>/login</code> , which accepts json as the request body: <code>{"username": "&lt;username&gt;", "password": "&lt;password&gt;"}</code> , where <code>username</code> and <code>password</code> (again similarly, from the input above) have the values <code>admin</code> and <code>password</code> respectively.  In response, this endpoint returns json of the form <code>{"token": "&lt;token&gt;"}</code> .  We use it for authorization.  Create a <strong>RequestStep</strong> node with the name <strong>login</strong> , the <strong>Project</strong> node will be the ancestor.  Using drag-and-drop, move this node in the tree higher than the <strong>create-post</strong> node.  Let's set the newly created request with the following parameters: </p><br><ul><li>  Request Type: POST </li><li>  url: <a href="https://testmace-quick-start.herokuapp.com/login">https://testmace-quick-start.herokuapp.com/login</a> </li><li>  Request body: json with the value <code>{"username": "admin", "password": "password"}</code> </li></ul><br><p>  Execute the query and get the 200th code with the token in the response.  Something like this: </p><br><p><img src="https://habrastorage.org/webt/zd/_o/fs/zd_ofsbzdf-_unlqtpxe3rsaf_i.png"></p><br><h2 id="refaktoring-ubiraem-dublirovanie-domena">  Refactoring: removing domain duplication </h2><br><p>  While requests are not connected in a single script.  But this is not the only drawback.  If you look closely, you will notice that at least the domain is duplicated in both requests.  Not good.  It's time to refactor this part of the future scenario and the variables will help us in this. </p><br><p>  In the first approximation, variables perform the same role as in other similar tools and programming languages ‚Äã‚Äã‚Äî eliminating duplication, increasing readability, etc.  Read more about variables in <a href="https://docs-ru.testmace.com/variables/user-variables">our documentation</a> .  In this case, we need user variables. </p><br><p>  At the Project node level, we define a <code>domain</code> variable with the value <code>https://testmace-quick-start.herokuapp.com</code> .  For this you need </p><br><ul><li>  Open the tab with this node and click on the calculator icon in the upper right. </li><li>  Click on <strong>+ ADD VARIABLE</strong> </li><li>  Enter variable name and value <br>  In our case, the dialog with the added variable will look like this: </li></ul><br><p><img src="https://habrastorage.org/webt/0o/wl/zu/0owlzuvsic-o0zwyn5nomsfhz-m.png"></p><br><p>  OK.  Now, due to inheritance, we can use this variable in descendants of any nesting level.  In our case, these are the <strong>login</strong> and <strong>create-post</strong> nodes.  In order to use a variable in the text field, you need to write <code>${&lt;variable_name&gt;}</code> .  For example, the url for the login is converted to <code>${domain}/login</code> , respectively, for the <strong>create-post</strong> node the url will look like <code>${domain}/posts</code> . </p><br><p>  Thus, guided by the principle of DRY, we have slightly improved the script. </p><br><h2 id="sohranyaem-token-v-peremennuyu">  Save the token to the variable </h2><br><p>  Since the conversation about variables has come, let's develop this topic a little.  At the moment, in case of a successful login, we receive from the server an authorization token, which we will need in subsequent requests.  Let's save this token to a variable.  Because  the value of the variable will be determined during the execution of the script, we use for this a special mechanism - <a href="https://docs-ru.testmace.com/variables/user-variables/dynamic-variables">dynamic variables</a> . </p><br><p>  To begin with we will execute request for login.  In the <strong>Parsed</strong> tab of the answer, move the cursor to the token and in the context menu (which is called either by right-clicking or pressing the button ...) select <strong>Assign to variable</strong> .  A dialog will appear with the following fields: </p><br><ul><li>  <strong>Path</strong> - which piece of the answer is taken (in our case, this is <code>body.token</code> ) </li><li>  <strong>Current value</strong> - what value lies along the Path (in our case this is the value of the token) </li><li>  <strong>Variable name</strong> - the name of the variable where the <strong>Current value</strong> will be stored.  In our case it will be <code>token</code> </li><li>  <strong>Node</strong> - in which of the ancestors the variable <strong>Variable name</strong> will be created.  Choose Project </li></ul><br><p>  The completed dialog looks like this: </p><br><p><img src="https://habrastorage.org/webt/mt/ze/9a/mtze9ag3g3coxxyuv9xc_xow-sm.png"></p><br><p>  Now each time the <strong>login</strong> node <strong>runs, the</strong> dynamic variable <code>token</code> will be updated with the new value from the response.  And this variable will be stored in the <strong>Project</strong> node and due to inheritance will be available to descendants. </p><br><p>  In order to access dynamic variables, you must use the <a href="https://docs-ru.testmace.com/variables/variables">built-in variable</a> <code>$dynamicVar</code> .  For example, to reach a saved token, you need to call <code>${$dynamicVar.token}</code> . </p><br><h2 id="prokidyvaem-avtorizacionnyy-token-v-zaprosy">  Throw authorization token in requests </h2><br><p>  In the previous steps, we received an authorization token and all we need to do is add the <code>Authorization</code> header with the <code>Bearer &lt;tokenValue&gt;</code> value to all requests that require authorization, including the <strong>create-post</strong> .  There are several ways to do this: </p><br><ol><li>  Manually copy the token and add the authorization header to the requests of interest.  The way is working, but its use is limited only by requests of the form "made and thrown out".  For multiple scripts will not work </li><li>  Use the <a href="https://docs-ru.testmace.com/work-with/authorization">authorization</a> feature. </li><li>  Use <a href="http-headers">default headers</a> </li></ol><br><p>  Using the second method seems obvious, but in the context of this article this approach ... is not interesting.  Well, in fact: the authorization mechanism, plus or minus, is familiar to you from other tools (even if we have things like <a href="https://docs-ru.testmace.com/work-with/authorization">inheritance of authorizations</a> ) and is unlikely to cause questions. </p><br><p>  Another thing is the default headers!  If in a nutshell, the default headers are the HTTP headers that are inherited from the ancestors, which are added by default to the request unless explicitly disabled.  Using this functionality, you can, for example, implement custom authorization or just get rid of duplication in scripts.  Apply this feature to prokidydka token in the headers. </p><br><p>  Previously, we prudently saved the token to the dynamic variable <code>$dynamicVar.token</code> at the level of the Project node.  It remains to do the following: </p><br><ol><li>  Define a default <code>Authorization</code> header with a <code>Bearer ${$dynamicVar.token}</code> at the Project node level.  To do this, in the interface of the Project node you need to open a dialog with default headers (the <strong>Headers</strong> button in the upper right corner) and add the appropriate header.  The dialog with the filled values ‚Äã‚Äãwill look as follows: <br><img src="https://habrastorage.org/webt/a9/it/so/a9itsohct79f71scqkhn9j9_-p4.png"></li><li>  Disable this header from the login request.  This is understandable: at the time of login, we still do not have a token and we will install it with this request.  Therefore, in the login request interface in the <strong>Headers</strong> tab in the <strong>Inherited area,</strong> remove the tick from the Authorization header. </li></ol><br><p>  That's all.  Now the authorization header will be added to all requests that are descendants of the Project node, except for the login node.  It turns out that at this stage we have a script ready and we can only run it.  You can run the script by selecting the <strong>Run</strong> item in the context menu of the Project node. </p><br><h2 id="proveryaem-korrektnost-sozdaniya-posta">  Check the correctness of the post creation </h2><br><p>  At this stage, our script can log in and, using an authorization token, create a post.  However, we need to make sure that the newly created post has the correct name.  That is, in essence, it remains to do the following: </p><br><ul><li>  Send a request for a post by id, </li><li>  Check that the name that came from the server matches the name given when creating the post. </li></ul><br><p>  Consider the first step.  Once the id value is determined during the execution of the script, it is necessary to create a dynamic variable (let's call it <code>postId</code> ) from the <strong>create-post</strong> node at the Project level.  How to do this, we already know, it‚Äôs enough to refer to the <strong>Save Token To Variable</strong> section.  It remains only to create a request for a post on this id.  To do this, create a RequestStep <strong>get-post</strong> with the following parameters: </p><br><ul><li>  Request Type: GET </li><li>  URL: $ {domain} / posts / $ {$ dynamicVar.postId} </li></ul><br><p>  To implement the second step, we need to get acquainted with the <a href="https://docs-ru.testmace.com/node-types/assertion">Assertion</a> node.  The assertion node is a node that allows you to write checks for specific queries.  Each Assertion node can contain several statements (checks).  You can read more about all types of assertion from our <a href="https://docs-ru.testmace.com/node-types/assertion">documentation</a> .  We will use <code>Compare</code> assertion with the <code>equal</code> operator.  There are several ways to create assertions: </p><br><ol><li>  Long.  Manually from the context menu of the RequestStep node create an Assertion node.  In the node created by Assertion add the required assertion and fill in the fields. </li><li>  Fast.  Create an Assertion node together with an assertion from the Request Request response of the node using the context menu </li></ol><br><p>  We use the second method.  Here is how it will look for our case. </p><br><p><img src="https://habrastorage.org/webt/4a/3c/na/4a3cnaugji8gije_wdf74vy1ecc.gif"></p><br><p>  For those who do not understand, the following happens here: </p><br><ol><li>  Make a request in the <strong>get-post</strong> site </li><li>  In the <strong>Parsed</strong> tab of the response, call the context menu and select <strong>Create assertion</strong> -&gt; <strong>Compare</strong> -&gt; <strong>Equal</strong> </li></ol><br><p>  Congratulations, we created the first test!  Simple, isn't it?  Now you can run the script completely and enjoy the result.  It remains just a bit to refactor and make the <code>title</code> in a separate variable.  But we will leave it to you as a homework) </p><br><h1 id="zaklyuchenie">  Conclusion </h1><br><p>  In this guide, we created a complete script and at the same time reviewed some of the features of our product.  Of course, we have used far from all the functionality and in the following articles we will conduct a detailed review of TestMace features.  Stay tuned! </p><br><p>  PS For those who are too lazy to reproduce all the steps, we kindly filed a <a href="https://github.com/TestMace/testmace-quick-start-project">repository</a> with a project from the article.  You can open it using <strong>File</strong> -&gt; <strong>Open project</strong> and select the Project folder. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/458964/">https://habr.com/ru/post/458964/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../458954/index.html">What types of detection are useful in video surveillance. Mechanisms and functions</a></li>
<li><a href="../458956/index.html">Machine Learning vs. analytical approach</a></li>
<li><a href="../45896/index.html">Do not allocate Bold</a></li>
<li><a href="../458960/index.html">Corporate Quest</a></li>
<li><a href="../458962/index.html">Let's transform the image into a sound - what can be heard?</a></li>
<li><a href="../458966/index.html">Scientists and heads of technology corporations consider the withdrawal of industrial enterprises into space a reality</a></li>
<li><a href="../45897/index.html">How to connect PC and smartphone via WiFi Ad-Hoc</a></li>
<li><a href="../458970/index.html">Use UIViewPropertyAnimator to create custom animations</a></li>
<li><a href="../458972/index.html">News of the week: Yandex and Western intelligence agencies, FAS is fighting online casinos, the Ministry of Transport regulates the work of BlaBlaCar</a></li>
<li><a href="../45898/index.html">Netbooks are no longer cheap?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>