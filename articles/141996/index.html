<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cache + jQuery. Fast start</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article shows how jQuery can be used to work with the Cach√© database, which results in a simple functionality for inserting and deleting data in t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cache + jQuery. Fast start</h1><div class="post__text post__text-html js-mediator-article">  The article shows how jQuery can be used to work with the Cach√© database, which results in a simple functionality for inserting and deleting data in the ajax web application. <br><br>  It is assumed that the reader has an average level of knowledge of HTML, CSS and Javascript and has minimal experience with Intersystems Cache.  Download the latest version of Cach√© <a href="http://www.intersystems.ru/cache/downloads/index.html">here</a> .  Initial experience with Cach√© can be found <a href="http://intersystems.ru/cache/education/docs/objectqs.pdf">here</a> . <br><a name="habracut"></a><br><br><h5>  Why do you need jQuery in a CSP application? </h5><br>  <a href="">CSP (Zen)</a> is the basic technology offered by Cach√© to quickly create ajax web applications that work with the Cach√© database. <br>  How can jQuery help your CSP (ZEN) application? <br><h6>  1. Convenient access to any element of the html page </h6><br>  The jQuery framework allows you to access elements using the <a href="http://api.jquery.com/category/selectors/">CSS selector</a> syntax, implementing this functionality in the most preferred way for each browser. <br><h6>  2. Cross-browser compatibility </h6><br>  Cross-browser compatibility is an essential requirement for a modern Web application.  The developers of the framework claim that the code developed using jQuery will function uniformly in browsers - IE 6.0+, FF 3.6+, Safari 5.0+, Opera, Chrome. <br><h6>  Plugins </h6><br>  jQuery provides a convenient way to extend its functionality with plugins.  Since the creation of the framework (in 2006), <a href="http://ideaforweb.ru/scripts/200-populyarnykh-plaginov-dlya-jquery">quite a few of</a> them have been written.  Special mention deserves the client interface library <a href="http://jqueryui.com/">jQueryUI</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  How to connect jQuery to your CSP (ZEN) page? </h5><br><br>  Download a compressed version of the library from the <a href="http://docs.jquery.com/Downloading_jQuery">official site</a> , place it in the CSP directory of the application, point to the csp (zen) page that the jQuery file of a specific version will be used. <br><br>  For example: <br>  CSP <br><pre><code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span> src=<span class="hljs-string"><span class="hljs-string">"jquery-1.7.1.min.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br> <code>ZEN <br> <br> Parameter JSINCLUDES As STRING="jquery-1.7.1.min.js" <br></code> <br>  CLS <br><br><pre> <code class="javascript hljs">w <span class="hljs-string"><span class="hljs-string">"&lt;script type='text/javascript' src='jquery-1.7.1.min.js'&gt;&lt;/script&gt;"</span></span></code> </pre><br>  <i>CSP, ZEN and CLS - three approaches to creating server pages in Cach√©.</i> <i><br></i>  <i>When compiling, each <a href="">CSP page is</a> converted into a standard class Cache ‚Äî a successor of the% CSP.Page class ‚Äî CSP.</i>  <i>From here follows the second method - code-oriented, it assumes the initial development of the page using the classes Cache, the heirs of the% CSP.Page class - CLS approach.</i>  <i>Read more about the differences <a href="">here</a> .</i> <i><br></i>  <i>The third method ‚Äî development using Zen ‚Äî combines these two methods ‚Äî using both Zen tags and object code.</i>  <i>In the examples given, the designations CSP, CLS, ZEN, denote the methods used to work out the page that was used to create the example.</i> <br><br>  For Internet applications, the preferred method would be to use content delivery networks (CDN).  In this case, the jQuery file will be located on the servers of one of the <a href="http://docs.jquery.com/Downloading_jQuery">listed networks</a> .  CDN connection example: <br><pre> <code class="javascript hljs">CSP: <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ZEN: Parameter JSINCLUDES As STRING=<span class="hljs-string"><span class="hljs-string">"http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"</span></span>; CLS: &amp;html&lt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &gt;</code> </pre><br><br><h5>  Using jQuery </h5><br><br>  The most used jQuery function is called jQuery (), but its most commonly used synonym is $ ().  The result of this function will depend on the type and number of arguments passed.  The main options for calling this function: <br>  1. The following string is passed as an argument: <br>  The method will try to interpret the string either as a jQuery selector (CSS) or as html code: <br><pre> <code class="javascript hljs">$( <span class="hljs-string"><span class="hljs-string">"div#1973"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">//   div   1973 $( ".doc td" ) //   &lt;td&gt;        doc $( "&lt;div&gt;Write less, do more&lt;/div&gt;" ) // *  </span></span></code> </pre><br>  2. As an argument, the page element is passed: <br><pre> <code class="javascript hljs">$( <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body ) <span class="hljs-comment"><span class="hljs-comment">//  body  ¬´¬ª   jQuery $( document.forms[0] ) //      ¬´¬ª   jQuery</span></span></code> </pre><br>  3. The function is passed as an argument: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ alert( <span class="hljs-string"><span class="hljs-string">" "</span></span> ); } $( loadHandler );</code> </pre>  or anonymous function: <br><pre> <code class="javascript hljs">$( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ alert( <span class="hljs-string"><span class="hljs-string">" "</span></span> ); } );</code> </pre><br>  The passed function will be executed upon the document loading event.  Such a call can be used instead of: <br><pre> <code class="javascript hljs">&lt;body onload=<span class="hljs-string"><span class="hljs-string">"loadHandler"</span></span>&gt;</code> </pre><br>  In addition to searching for elements on the page, jQuery contains methods for manipulating them.  List of frequently used functions: <br><pre> <code class="javascript hljs">html()    html- . val()       (input,select) attr()       append(), appendTo()    ,       remove()   bind(), unbind() ,   .     bind()    click(), keypress(), hover()  .. addClass(), removeClass(), toggleClass() , ,  ()  css()      show(), hide() ,   parents(),parent() children()     </code> </pre><br>  * Full list of features can be found <a href="http://api.jquery.com/">here.</a> <br><br>  It is necessary to note some rules implemented in jQuery: <br>  - the result of the query is packaged in a jQuery object; <br>  - Most functions return call context. <br><br>  Compliance with these rules makes the code "unobtrusive" and allows the use of "chained" syntax.  Sample code using jQuery that searches for an element and replaces its value: <br><br><pre> <code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span> src=<span class="hljs-string"><span class="hljs-string">"jquery-1.7.1.min.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span>&gt; $(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ $( <span class="hljs-string"><span class="hljs-string">".age38"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">//      age38 .val( "Write less, do more" ) //      .css( "font-size", "110%" ) //      .click( function(){ $(this).val(""); } ) //    //  ¬´¬ª     . }); &lt;/script&gt;</span></span></code> </pre><br><br>  "Unobtrusiveness" is that for the above code, if there are no elements on the page with the age38 class, no execution error occurs and the code execution is not interrupted <br><br>  Below is an example, javascript with similar functionality, but without jQuery <br><pre> <code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span>&gt; <span class="hljs-comment"><span class="hljs-comment">//          //  ""   window var page={}; // window.page=new Object(); //        //       page.getByClass=(document.getElementsByClassName) ? function(clnm){ // IE9, FireFox 3, Opera 9.5, Safari 3.1    return document.getElementsByClassName(clnm); } : function(clnm){ /// IE 6.0-IE 8.0    var arr=[]; ///        ///      var scanDown=function(obj,handler){ for (var child=obj.firstChild;child;child=child.nextSibling){ if (typeof(handler)=="function") handler(child); scanDown(child,handler); } }; ///       ///          var rgxp=new RegExp("(\\s|^)" + clnm + "(\\s|$)"); ///   var classSelect=function( obj ){ if ( ( !obj ) || ( !obj.className )) return; var cls=obj.className; if (!cls.match( rgxp )) return; arr[arr.length]=obj; /// -  }; scanDown( document, classSelect ); //  return arr; } ///  ‚Äú‚Äù    page.bind=(page.ie)? function(obj,evt,func){ obj.attachEvent("on"+evt,func); } : function(obj,evt,func){ obj.addEventListener(evt,func); }; ///      page.main=function(obj){ if (!obj) return; if (obj.nodeType!=1) return; //     obj.value="Write less, do more"; var FS="110%"; if (obj.style) { obj.style.fontSize=FS; } else { obj.style="font-size:"+FS; } page.bind(obj,"click",function(){ obj.value=""; }); }; ///    page.bind( window, "load", function() { var arr=page.getByClass("age38"); //  for (var i in arr){ page.main(arr[i]); //    } }); &lt;/script&gt;</span></span></code> </pre><br>  The resulting code is smaller than the jQuery library, but not as versatile and requires a lot of effort from the developer to create and maintain. <br><br><h5>  Cache + jQuery <br></h5><br><h6>  Using jQuery on a CSP page </h6><br>  Consider a small example of implementing a chat with minimal functionality and the following interface: <br><img src="http://dl.dropbox.com/u/25822386/imgweb/jchat.png" alt="image"><br><br>  Features of the example: <br>  - the interface is completely configured using jQuery <br>  - asynchronous calls to the #call () # server are used, which return a response through a function call on the client <br>  - data is stored in the global <br><br>  Page source: <br><pre> <code class="javascript hljs">&lt;!DOCTYPE html&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">head</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">title</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> jqChat√© </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">title</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">style</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="css"><span class="hljs-selector-class"><span class="xml"><span class="css"><span class="hljs-selector-class">.msg</span></span></span></span><span class="xml"><span class="css"> </span></span><span class="hljs-selector-tag"><span class="xml"><span class="css"><span class="hljs-selector-tag">span</span></span></span></span><span class="xml"><span class="css"> {</span></span><span class="hljs-attribute"><span class="xml"><span class="css"><span class="hljs-attribute">padding</span></span></span></span><span class="xml"><span class="css">: </span></span><span class="hljs-number"><span class="xml"><span class="css"><span class="hljs-number">0px</span></span></span></span><span class="xml"><span class="css"> </span></span><span class="hljs-number"><span class="xml"><span class="css"><span class="hljs-number">0px</span></span></span></span><span class="xml"><span class="css"> </span></span><span class="hljs-number"><span class="xml"><span class="css"><span class="hljs-number">0px</span></span></span></span><span class="xml"><span class="css"> </span></span><span class="hljs-number"><span class="xml"><span class="css"><span class="hljs-number">5px</span></span></span></span><span class="xml"><span class="css">}</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">style</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">head</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"><span class="xml"><span class="xml"> $( function(){ var USERNAME="#($USERNAME)#" //    Cache , box=$( "</span></span><span class="hljs-tag"><span class="xml"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="xml"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span></span><span class="xml"><span class="xml"><span class="hljs-tag">/&gt;</span></span></span></span><span class="xml"><span class="xml">" ).css("overflow","auto") // ,   .css("border","1px solid #ccc").width( 340 ).height( 280 ) // .appendTo( $(document.body) ) //    ; box.parent() //     body //  body input,      .append( $("</span></span><span class="hljs-tag"><span class="xml"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="xml"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span></span><span class="xml"><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span></span><span class="xml"><span class="xml">").css( "width",200 ) .attr("maxlength",50).before( USERNAME+": ") ) .append( //  $("</span></span><span class="hljs-tag"><span class="xml"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="xml"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span></span><span class="xml"><span class="xml"><span class="hljs-tag">/&gt;</span></span></span></span><span class="xml"><span class="xml">").text( "Send" ) //     .click( function(){ //    #call(..Add($(this).prev().val()))#; //    (input) $("input").val("").focus(); //textbox ,      }) ); var drawMsg=function(/*[id,time,user,msg]*/ array ){ //  var USER=2, MSG=3, SOFT="#999", BRIGHT="#339" // , msg = $( "</span></span><span class="hljs-tag"><span class="xml"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="xml"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span></span><span class="xml"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-tag"><span class="xml"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="xml"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span></span><span class="xml"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="xml"><span class="xml">" + array.join("</span></span><span class="hljs-tag"><span class="xml"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="xml"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span></span><span class="xml"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-tag"><span class="xml"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="xml"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span></span><span class="xml"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="xml"><span class="xml">") + "</span></span><span class="hljs-tag"><span class="xml"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="xml"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span></span><span class="xml"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-tag"><span class="xml"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="xml"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span></span><span class="xml"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="xml"><span class="xml">") //html  .appendTo( box ).hide() //   -    .addClass("msg") //  .children(":first").hide() //id -   .next().css("color", SOFT) //time //  .next().css("color", (USERNAME==array[USER]) ? SOFT : BRIGHT ).append(": ") .parent() //      msg ; if (array[MSG]!=="") { //    msg.show(); // var div=msg.get(0); //    html- if (div) div.scrollIntoView(); //    } }; //drawMsg window.chat=function(array){ //  if ( $.isArray(array) ) drawMsg( array ); //  -   //     -  ? setTimeout( //     jQuery function(){ #call(..GetNext($(".msg:last span:first").text()))# } , #($get(^chatSettings("timeout"),300))# ); //    }; //window.chat chat(); //  - }); </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script runat=<span class="hljs-string"><span class="hljs-string">"server"</span></span> method=<span class="hljs-string"><span class="hljs-string">"Add"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>=<span class="hljs-string"><span class="hljs-string">"msg:%String"</span></span> language=<span class="hljs-string"><span class="hljs-string">"cache"</span></span>&gt; #;    s ^chat($increment(^chat))=$listbuild( $zt( $now() ), $USERNAME, msg ) &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt; &lt;script runat="server" method="GetNext" arguments="lastMsg:%String" language="cache"&gt; #;  c   set lastMsg=$get(lastMsg), prevMsg=$order( ^chat(lastMsg),-1 ), isNewUser=( lastMsg = "" ) set callBack="window.parent.chat(" ; set isNewChat=( isNewUser &amp;&amp; (prevMsg="") ) if ( isNewChat ) write callBack,")" Quit if ( isNewUser ) write callBack,"[", prevMsg, ",'','',''])" Quit ; set nextMsg=$order( ^chat( lastMsg ) ) if ( nextMsg="" ) write callBack,")" Quit set stored=$get(^chat(nextMsg)) ;  write callBack,"[",nextMsg,", ", ..QuoteJS( $listget(stored,1) ) , ",", ..QuoteJS( $listget(stored,2) ) , ",", ..QuoteJS( ..EscapeHTML( $listget(stored,3 ))) , "])" &lt;/</span></span>script&gt;</code> </pre><br>  To play an example, open Studio in any area, create a new CSP page, paste the copied page code from the example.  Save the page with any name - select any existing CSP application.  Then compile the page (Ctrl + F7) and open it in the browser (F5). <br><br><h6>  Using jQuery on a Zen page <br></h6><br>  Using jQuery on a Zen page is completely similar to using CSP (searching and changing elements), but considering that Zen is a client-server framework that supports the same object model in the browser and on the Cache server.  Therefore it is necessary to consider the following points: <br>  - A Zen page model begins to form after a page load event. <br>  - To change the page model, it is preferable to use Zen methods <br>  - Zen forms markup with additional hidden elements <br><br>  A practical example of Cache + jQuery <br>  Let's take a more complex example using jQuery to create and delete objects of a stored class with the following interface: <br>  Features of the example: <br>  - The example works on Cache version 2010 and higher. <br>  - Dynamic binding of events is used, all javascript code is moved to a separate javascript file <br>  - Part of the page content is generated directly in the browser. <br>  - ‚ÄúHyper‚Äù events and ‚Äúdynamic‚Äù (generated on the fly) page method are not used. <br>  - The server generates responses in various data formats, depending on the request arguments. <br>  - Shows the output of the server object in XML format using% XML.Writer and parsing the server response in XML format on the client side using jQuery <br><br>  1. Create a stored class with test data in the User pane. <br> <code>///     <br> Class test.data Extends (%Persistent, %Populate, %XML.Adaptor) { <br> ///  <br> Property code As %String; <br> ///  <br> Property name As %String; <br> ///  "",        <br> Method %OnNew(ByRef args as %String="") As %Status [ Private, ServerOnly = 1 ] { <br> s ..code=$g(args("code",1)), ..name=$g(args("name",1)) <br> Quit $$$OK <br> } <br> }</code> <br> <br>  2. Create test data in test.data by running a class method call from the Cache terminal. <br> <code>USER&gt;d ##class(test.data).Populate()</code> <br> <br>  3. Create a class page: <br>  /// Page for working with test.data class instances <br><pre> <code class="javascript hljs">Class wui.testData Extends %CSP.Page { <span class="hljs-comment"><span class="hljs-comment">///   Parameter CHARSET="utf-8"; ///     ClassMethod OnPage() As %Status { #;       #; 1.   #; 2.    #; 3.    #;       &lt;var&gt;oper&lt;/var&gt; m args=%request.Data ;     if $d(args("oper")){ //   oper s oper=$g(args("oper",1)) //   Q:oper="add" ..Add(.args) //        Q:oper="del" ..Del(.args) //    } #;       &amp;html&lt;&lt;html&gt;&lt;head&gt;&lt;title&gt; test.data&lt;/title&gt; &lt;!--     CSS --&gt; &lt;style type="text/css"&gt; table {border-collapse: collapse; border: 1px solid #777;} td, th {border: 1px solid #777;} td {padding: 2px;} th {font-weight: normal; color:#fff;background-color:#aaa;} &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;table&gt;&lt;caption&gt;  test.data&lt;/caption&gt; &lt;thead&gt;&lt;tr&gt;&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;code&lt;/th&gt;&lt;th&gt;name&lt;/th&gt;&lt;th&gt;&lt;!----&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt; &lt;tbody&gt;&gt; #;       s sql="Select ID,code,name From test.data" s rs=##class(%SQL.Statement).%ExecDirect(.stm, sql) ;    Cache &gt; 2009 ? while rs.%Next() { w !,"&lt;tr id='",rs.ID,"'&gt;" , "&lt;th&gt;",rs.ID,"&lt;/th&gt;" ;   , "&lt;td&gt;",rs.code,"&lt;/td&gt;" , "&lt;td&gt;",rs.name,"&lt;/td&gt;" , "&lt;/tr&gt;" } &amp;html&lt;&lt;/tbody&gt;&lt;/table&gt; &lt;!-- jQuery--&gt; &lt;script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"&gt;&lt;/script&gt; &lt;!‚Äî      --&gt; &lt;script src="wui.testData.js"&gt;&lt;/script&gt; &lt;/body&gt;&lt;/html&gt;&gt; Quit $$$OK } ///          XML ClassMethod Add(ByRef args as %String="") as %Status{ #;     s obj=##class(test.data).%New(.args), sc=obj.%Save() #;         xml s wr=##class(%XML.Writer).%New() ;  xml d wr.RootElement("response") ; &lt;response , wr.WriteAttribute("id",obj.%Id()) ; id='' #;    xml d wr.Object(obj) ; &gt;&lt;data&gt;&lt;code&gt;123&lt;/code&gt;&lt;name&gt;Name&lt;/name&gt;&lt;/data&gt; if $$$ISERR(sc) { d wr.Element("error") ;&lt;error&gt; d wr.WriteChars($system.Status.GetOneErrorText(sc)) ;errorText d wr.EndElement() ;&lt;/error&gt; } d wr.EndRootElement() ;&lt;/response&gt; Q $$$OK } ///           ClassMethod Del(ByRef args as %String="") as %Status{ s id=$g(args("id",1)), sc=##class(test.data).%DeleteId(id) w $CASE(sc ,1: 1 , : $system.Status.GetOneErrorText(sc) ) Q $$$OK } }</span></span></code> </pre><br>  The following is the Javascript code that was rendered to the wui.testData.js file.  The file must be located in the csp-application directory.  For the USER area, the directory is in the [Cache installation directory] \ CSP \ USER \. <br><br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// document.ready //       var footer=[ //      "&lt;tfoot&gt;&lt;tr&gt;" ,"&lt;th&gt;*&lt;/th&gt;" // " " ,"&lt;th&gt;&lt;input /&gt;&lt;/th&gt;" // "" ,"&lt;th&gt;&lt;input /&gt;&lt;/th&gt;" // "" ,"&lt;th&gt;&lt;button&gt; + &lt;/button&gt;&lt;/th&gt;" //    ,"&lt;/tr&gt;&lt;/tfoot&gt;" ].join( "" ); //   (   ) //     $( footer ).appendTo( $( "table" ) ); //     //        $( "tfoot button" ).click( callAdd ); //     //  tr  tbody (   test.Data)    $("tbody tr").each( addDelBtn ); //   //        function addDelBtn (){ //       var $tr=$(this); //  (tr  tbody)  jQuery $( "&lt;th&gt;&lt;button class='bDel'&gt;&lt;/button&gt;&lt;/th&gt;" ) //  .appendTo( $tr ) //        .children( ".bDel" ) //   c  bDel .html( "X" ) //   .attr( "title", " " ) //   .css( "color", "#f00" ) //     .click( callDel ) //       ; }; //        function callDel(){ //  -   var $btnDel=$( this ).hide(); //       var $row=$button.parents( "tr" ); //   tr var id=$row.attr( "id" ); //   //        //  $.ajax- http://api.jquery.com/jQuery.ajax/ $.ajax({ //ajax options url: window.location //   - wui.testData.cls ,data: "oper=del&amp;id="+id //  ,dataType: "text" //    text ,success: function(txt){ //    if ( txt!="1" ) { //    $btnDel.show(); //    alert(txt); //  return; } $row.remove(); //    } }); //ajax() }; //      function callAdd(){ var values = [] //         , $inputs = $( "tfoot input" ) //   //     .each( function(){ values.push( //    $( this ).val() // input ) } //function ) //each ; //var //,    -  if ( values.join( "" ) == "" ){ alert( "    " ); return; }; //        var $addRow = $( "tfoot tr" ).hide(); //         // $.ajax- http://api.jquery.com/jQuery.ajax/ $.ajax( { //   url: window.location // - wui.testData.cls //,async: true //      , type: "POST" //   - POST  GET , data: { //       oper: "add" //  , code: values[0] //  , name: values[1] //  } , dataType: 'text' //    . //    , success: function( text ){ //  c    XML   // &lt;response id='newid'&gt; // &lt;data&gt;&lt;code&gt;Code&lt;/code&gt;&lt;name&gt;Name&lt;/name&gt;&lt;/data&gt; // &lt;error&gt;Error Text&lt;/error&gt; // &lt;/response&gt; //      jQuery var xml=$.parseXML(text) , $xml=$( xml ) //   jQuery , error=$xml .find("error") // node   .text() //   ; if ( error!=="" ){ //  alert(error); //  return; } //     var id=$xml.find("response").attr("id") , code=$xml.find("code").text() , name=$xml.find("name").text(); var tr=[ //     "&lt;tr id='",id,"'&gt;" , "&lt;th&gt;",id,"&lt;/th&gt;" , "&lt;td&gt;",code,"&lt;/td&gt;" , "&lt;td&gt;",name,"&lt;/td&gt;" ,"&lt;/tr&gt;" ].join( "" ); $( tr ) .appendTo( $("table tbody") ) //    //        .each( addDelBtn ) ; $inputs.val( "" ) //   .focus() //  ; } //success , error: function(err){ //     alert("Error: "+err); } // ,   success  error , complete: function(){ $addRow.show(); //    } } // ); //$.ajax }; //callAdd }); //document.ready</span></span></code> </pre><br><br>  Some results: <br><ul><li>  Using the jQuery library greatly simplifies the development of a web interface; </li><li>  jQuery allows you to conveniently separate the dynamic and static content of the page; </li><li>  in jQuery, it‚Äôs easy to bring most of the interface logic to the browser side, thereby reducing the load on the Cach√© server. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/141996/">https://habr.com/ru/post/141996/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141988/index.html">Guess the movie on the trailer</a></li>
<li><a href="../141989/index.html">Nginx module to combat DDoS, put a cookie through Flash</a></li>
<li><a href="../141991/index.html">Hide USB-Flash to 3.5 "diskette</a></li>
<li><a href="../141994/index.html">Webinar: How to write the first test on Selenium</a></li>
<li><a href="../141995/index.html">The Magic Repository: Integrating Spring Data-JPA and Google Guice</a></li>
<li><a href="../141997/index.html">Area for Moscow</a></li>
<li><a href="../141999/index.html">Building effective business systems. Chapter 1: Introduction</a></li>
<li><a href="../142002/index.html">Viva France! "The law on inaccessible books of the twentieth century"</a></li>
<li><a href="../142003/index.html">Unbiased rendering (rendering without assumptions)</a></li>
<li><a href="../142005/index.html">Personal experience with Jive SBS 5.0.2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>