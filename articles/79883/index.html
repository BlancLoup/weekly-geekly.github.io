<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>C # coprocessor programming? Yes!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Probably everyone knows about the existence of the FPU coprocessor. How to write code for it read on  . FPU - floating point unit - part of the CPU, s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>C # coprocessor programming? Yes!</h1><div class="post__text post__text-html js-mediator-article">  Probably everyone knows about the existence of the FPU coprocessor.  How to write code for it read on <a name="habracut"></a>  .  FPU - floating point unit - part of the CPU, specifically designed to work with data types that represent floating point numbers, or differently with float and double types.  This module as a part of processors was born after the birth of Intel 486DX (thank you for the amendment), and that's so long ago.  And since then it is he who performs the work of calculating various mathematical expressions, or rather, in the form of a code in assembly language.  In other words, the compiler does not convert all program code into a standard set of instructions of type mov, sub and others, but also in fld, fstp, fsub, fadd ..., if we are talking about calculations involving double types.  As you can see, the instructions for the FPU have the prefix ‚Äúf‚Äù, by which we can immediately distinguish the code intended for it.  All information on FPU you can find on the Internet, google it by name, also recommend the site wasm.ru - section "Processors".  A coprocessor is a very interesting thing and programming is a very interesting activity, I would even say exciting - I don‚Äôt know how you feel, but I was delighted when I managed to ‚Äújam‚Äù the code, giving commands directly to the processor without intermediary compilers, CLR- Wednesday and others. Why "conjure"?  More on this later. <br>  I borrowed the term ‚Äúconjure‚Äù from the author of the wonderful articles on the site.  This is a series of articles about "Spell Code", which I recommend you read after reading my article. <br>  Now I will show you how to write a simple code spell example for FPU.  I must immediately warn you that at least C # will be involved at the end, you need C ++ for the spell itself. <br>  Suppose we need to calculate the following expression: result = arg1 - arg2 + arg3. <br>  There are several options for compiling code.  In order not to complicate the understanding of what is happening, I will first show one, a little later I will show another. <br>  So, the first option looks like this: <br><br>  fld [arg1] <br>  fld [arg2] <br>  fsubp <br>  fld [arg3] <br>  faddp <br>  fstp [result] <br>  ret <br><br>  Now I will explain.  In square brackets we must indicate the addresses of the variables arg1, arg2, arg3, result. <br>  The fld instruction loads to the top of the stack (FPU works with the stack, and it has some special features) the value of the double variable, the address of which goes immediately after the instruction;  fsubp - subtracts the value lying 1 position in the stack below, the value lying on the top of the stack and freeing the top of the stack, thus the result is written in place of the value from which it is subtracted, the result is now on top of the stack;  faddp - works by analogy with fsubp, but does not subtract, but adds the values;  fstp - unloads the double value from the top of the stack, unloads it into the cell at the address specified below;  well, the ret instruction ‚Äî intuitively clear ‚Äî terminates the execution of the function and transfers control to the function that called it.  To make it clearer, I'll show the work of our code in pictures: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img title="Job code" src="https://habrastorage.org/getpro/habr/post_images/f2b/69f/032/f2b69f03215bceb90716210bb6da7dbb.jpg"><br><br>  The result is recorded in the memory cell, where it can be picked up.  I hope the instructions are clear.  Now let's see how we create such code from a C ++ program. <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">double</font> ExecuteMagic( <font color="#0000ff">double</font> arg1, <font color="#0000ff">double</font> arg2, <font color="#0000ff">double</font> arg3) <br> { <br> <font color="#0000ff">short</font> * code; <br> <font color="#0000ff">short</font> * code_cursor; <br> <font color="#0000ff">short</font> * code_end; <br> <font color="#0000ff">double</font> * data; <br> <font color="#0000ff">double</font> * data_cursor; <br> SYSTEM_INFO si; <br> GetSystemInfo(&amp;si); <br> DWORD region_size = si.dwAllocationGranularity; <br> <br> code = ( <font color="#0000ff">short</font> *)VirtualAlloc(NULL, region_size * 2, MEM_COMMIT, PAGE_EXECUTE_READWRITE); <br> code_cursor = code; <br> code_end = ( <font color="#0000ff">short</font> *)(( <font color="#0000ff">char</font> *)code + region_size); <br> data = ( <font color="#0000ff">double</font> *)code_end; <br> data_cursor = data; <br> <br> *data_cursor = arg1; <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0x05DDu; <font color="#008000">//fld</font> <br> *( <font color="#0000ff">int</font> *)code_cursor = ( <font color="#0000ff">int</font> )(INT_PTR)(data_cursor); <font color="#008000">//1.0</font> <br> code_cursor = ( <font color="#0000ff">short</font> *)(( <font color="#0000ff">char</font> *)code_cursor + <font color="#0000ff">sizeof</font> ( <font color="#0000ff">int</font> )); <font color="#008000">// </font> <br> data_cursor++; <br> <br> *data_cursor = arg2; <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0x05DDu; <font color="#008000">//fld</font> <br> *( <font color="#0000ff">int</font> *)code_cursor = ( <font color="#0000ff">int</font> )(INT_PTR)data_cursor++; <font color="#008000">//-2.0</font> <br> code_cursor = ( <font color="#0000ff">short</font> *)(( <font color="#0000ff">char</font> *)code_cursor + <font color="#0000ff">sizeof</font> ( <font color="#0000ff">int</font> )); <font color="#008000">// </font> <br> <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0xE9DEu; <font color="#008000">//fsubp</font> <br> <br> *data_cursor = arg3; <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0x05DDu; <font color="#008000">//fld</font> <br> *( <font color="#0000ff">int</font> *)code_cursor = ( <font color="#0000ff">int</font> )(INT_PTR)data_cursor++; <font color="#008000">//2.0</font> <br> code_cursor = ( <font color="#0000ff">short</font> *)(( <font color="#0000ff">char</font> *)code_cursor + <font color="#0000ff">sizeof</font> ( <font color="#0000ff">int</font> )); <font color="#008000">// </font> <br> <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0xC1DEu; <font color="#008000">//faddp</font> <br> <br> <font color="#0000ff">double</font> *result = data_cursor; <br> <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0x1DDDu; <font color="#008000">//fstp</font> <br> *( <font color="#0000ff">int</font> *)code_cursor = ( <font color="#0000ff">int</font> )(INT_PTR)data_cursor++; <font color="#008000">//</font> <br> code_cursor = ( <font color="#0000ff">short</font> *)(( <font color="#0000ff">char</font> *)code_cursor + <font color="#0000ff">sizeof</font> ( <font color="#0000ff">int</font> )); <font color="#008000">// </font> <br> <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0x90C3u; <font color="#008000">//ret</font> <br> <br> <font color="#0000ff">void</font> (*function)() = ( <font color="#0000ff">void</font> (*)())code; <br> <br> <font color="#008000">//1-(-2)+2=5</font> <br> function(); <br> <br> <font color="#0000ff">return</font> *result; <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now let's look at the most delicious here.  So, we use the VirtualAlloc function to allocate a certain amount of memory to our code (namely, according to the value of the structure <br>  SYSTEM_INFO.  dwAllocationGranularity, as if the system memory partitioning value);  Pay attention to what arguments the function accepts at the input, namely PAGE_EXECUTE_READWRITE - this parameter allows you to access the newly created memory section not only for read / write, but also for code execution, i.e.  we can transfer control to this section of memory and the processor will read further instructions from here. <br>  We allocate half of this created array for the code, the second half for the data is a kind of code segment and data segment.  All that remains is to fill these data segments with the necessary values.  To fill the array with code, it is necessary to simply write to this array opcodes (processor instructions) in hexadecimal.  Let's sort everything in order. <br>  The FLD instruction has an opcode DD / 0.  Yes, by the way, let me tell you right away that you can see the values ‚Äã‚Äãof opcodes and their mnemonic writing in the documentation on processor architecture.  Let's continue, FSTP also has the opcode DD, but already with the prefix / 3 it is an extension of the opcode - mod r / m bytes.  Here is a table of the mod r / m byte values ‚Äã‚Äã[http://www.sandpile.org/ia32/opc_rm32.htm] (Inquiring minds, in the presence of interest, can figure out all this, believe me).  Since the FLD and FSTP instructions can operate with different types of operands, i.e.  cells, processor registers, then for this there is an opcode extension.  We need an operand to see the address of the number double, so in that table we look at the value for [sdword].  For FLD, this value is 05h, for FSTP 1Dh.  We add these values ‚Äã‚Äãto the opcodes and get: FLD = DD05h, FSTP = DD1Dh.  The FSUBP instruction has the opcode DE / 5, and again we have to refer to the opcode extension table and look at the extension value for XMM1 (this is the link element of the FPU stack) and see that it is equal to E9h, i.e.  FSUBP = DEE9h.  FADDP, like FSUBP, has opcode DE, but already / 0, which is C1h for XMM1, i.e.  FADDP = DEC1h.  The RET instruction has an opcode C390h. <br>  It should be noted that the processor reads instructions from the end, so they should be written in reverse, taking into account the fact that they are 2 bytes and paired, i.e.  FLD = DD05h should be recorded not 50DDh, but 05DDh, this is important! <br>  Well, that's basically all opkodam.  C ++ code above shows how to fill an array with instructions.  We first write the instructions, then, if necessary, the address of the cells.  Note that the address is 4 bytes long (32 bits) for 32-bit systems, so after writing the address to the code array, you must move the pointer 4 bytes forward, instead of 2 bytes in the case of instructions. <br>  The culmination of this miracle is the execution of stored code.  How to execute code from our array?  For help we refer to the pointer to the function, here the C ++ language helps out.  Create a pointer to a function of type void with void parameters, then assign it a pointer to the beginning of the array of code.  Everything!  We run our function pointer, we get the result of the program working right in memory, the processor did everything exactly as we told it in our code array. <br>  Now I remind you that this is 1 way to transfer parameters and return the result.  The second way is to create a pointer to a function of type double (void), i.e.  so that the result was written to us not in memory and we pulled it out ourselves, and so that the result created by our dynamically returned function already returned to us.  To do this, simply change the code to: <br><br>  fld [arg1] <br>  fld [arg2] <br>  fsubp <br>  fld [arg3] <br>  faddp <br>  // fstp [result] <br>  ret <br><br>  Those.  just leave the result at the top of the stack.  And our function pointer will return the result from the top of the stack.  It's simple. <br><br>  From the middle of the article, the reader asks the question: ‚ÄúAnd what about C # ???  One C ++ and Assembler, incomprehensible numbers ... ".  Fair enough, but you have to be patient :). <br><br>  So, we all know that we can perform functions from C # written in C ++, Delphi, etc. <br>  This can be implemented using the extern keyword and the [DllImport ("*. Dll") attribute]. <br>  There is also an option and easier.  Programmers of the .NET platform were able to make friends managed and unmanaged.  Thus, we simply create a new class in C ++ using the aforementioned technique that implements code generation, a code spell.  Then we simply connect this library to a project using managed C # code and use it completely freely.  That's exactly what I did.  How glad I was when the result was not long in coming!  :) <br><br>  Here is what I did: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#include &lt;windows.h&gt; <br> <br> <font color="#0000ff">#pragma</font> once <br> <br> <font color="#0000ff">using</font> <font color="#0000ff">namespace</font> System; <br> <br> <font color="#0000ff">namespace</font> smallcodelib <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">ref</font> <font color="#0000ff">class</font> CodeMagics <br> { <br> <font color="#0000ff">public</font> : <br> <font color="#0000ff">static</font> <font color="#0000ff">double</font> ExecuteMagic( <font color="#0000ff">double</font> arg1, <font color="#0000ff">double</font> arg2, <font color="#0000ff">double</font> arg3) <br> { <br> <font color="#0000ff">short</font> * code; <br> <font color="#0000ff">short</font> * code_cursor; <br> <font color="#0000ff">short</font> * code_end; <br> <font color="#0000ff">double</font> * data; <br> <font color="#0000ff">double</font> * data_cursor; <br> SYSTEM_INFO si; <br> GetSystemInfo(&amp;si); <br> DWORD region_size = si.dwAllocationGranularity; <br> <br> code = ( <font color="#0000ff">short</font> *)VirtualAlloc(NULL, region_size * 2, MEM_COMMIT, PAGE_EXECUTE_READWRITE); <br> code_cursor = code; <br> code_end = ( <font color="#0000ff">short</font> *)(( <font color="#0000ff">char</font> *)code + region_size); <br> data = ( <font color="#0000ff">double</font> *)code_end; <br> data_cursor = data; <br> <br> *data_cursor = arg1; <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0x05DDu; <font color="#008000">//fld</font> <br> *( <font color="#0000ff">int</font> *)code_cursor = ( <font color="#0000ff">int</font> )(INT_PTR)(data_cursor); <font color="#008000">//1.0</font> <br> code_cursor = ( <font color="#0000ff">short</font> *)(( <font color="#0000ff">char</font> *)code_cursor + <font color="#0000ff">sizeof</font> ( <font color="#0000ff">int</font> )); <font color="#008000">// </font> <br> data_cursor++; <br> <br> *data_cursor = arg2; <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0x05DDu; <font color="#008000">//fld</font> <br> *( <font color="#0000ff">int</font> *)code_cursor = ( <font color="#0000ff">int</font> )(INT_PTR)data_cursor++; <font color="#008000">//-2.0</font> <br> code_cursor = ( <font color="#0000ff">short</font> *)(( <font color="#0000ff">char</font> *)code_cursor + <font color="#0000ff">sizeof</font> ( <font color="#0000ff">int</font> )); <font color="#008000">// </font> <br> <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0xE9DEu; <font color="#008000">//fsubp</font> <br> <br> *data_cursor = arg3; <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0x05DDu; <font color="#008000">//fld</font> <br> *( <font color="#0000ff">int</font> *)code_cursor = ( <font color="#0000ff">int</font> )(INT_PTR)data_cursor++; <font color="#008000">//2.0</font> <br> code_cursor = ( <font color="#0000ff">short</font> *)(( <font color="#0000ff">char</font> *)code_cursor + <font color="#0000ff">sizeof</font> ( <font color="#0000ff">int</font> )); <font color="#008000">// </font> <br> <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0xC1DEu; <font color="#008000">//faddp</font> <br> <br> <font color="#0000ff">double</font> *result = data_cursor; <br> <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0x1DDDu; <font color="#008000">//fstp</font> <br> *( <font color="#0000ff">int</font> *)code_cursor = ( <font color="#0000ff">int</font> )(INT_PTR)data_cursor++; <font color="#008000">//</font> <br> code_cursor = ( <font color="#0000ff">short</font> *)(( <font color="#0000ff">char</font> *)code_cursor + <font color="#0000ff">sizeof</font> ( <font color="#0000ff">int</font> )); <font color="#008000">// </font> <br> <br> *code_cursor++ = ( <font color="#0000ff">short</font> )0x90C3u; <font color="#008000">//ret</font> <br> <br> <font color="#0000ff">void</font> (*function)() = ( <font color="#0000ff">void</font> (*)())code; <br> <br> <font color="#008000">//1-(-2)+2=5</font> <br> function(); <br> <br> <font color="#0000ff">return</font> *result; <br> } <br> }; <br> } <br> <br>      ++. <br> <br> : <br> <br> <font color="#0000ff">using</font> System; <br> <font color="#0000ff">using</font> System.Collections. <font color="#2B91AF">Generic</font> ; <br> <font color="#0000ff">using</font> System.Linq; <br> <font color="#0000ff">using</font> System.Text; <br> <font color="#0000ff">using</font> System.Runtime.InteropServices; <br> <font color="#0000ff">using</font> smallcodelib; <br> <br> <font color="#0000ff">namespace</font> test_smallcodelib <br> { <br> <font color="#0000ff">class</font> Program <br> { <br> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Main( <font color="#0000ff">string</font> [] args) <br> { <br> <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">" ! (* )"</font> ); <br> <font color="#0000ff">while</font> (! <font color="#2B91AF">Console</font> .ReadLine().Equals( <font color="#A31515">"*"</font> )) <br> { <br> <font color="#0000ff">double</font> arg1; <br> <font color="#0000ff">double</font> arg2; <br> <font color="#0000ff">double</font> arg3; <br> <br> <font color="#2B91AF">Console</font> .Write( <font color="#A31515">"arg1?: "</font> ); arg1 = <font color="#2B91AF">Convert</font> .ToDouble( <font color="#2B91AF">Console</font> .ReadLine()); <br> <font color="#2B91AF">Console</font> .Write( <font color="#A31515">"arg2?: "</font> ); arg2 = <font color="#2B91AF">Convert</font> .ToDouble( <font color="#2B91AF">Console</font> .ReadLine()); <br> <font color="#2B91AF">Console</font> .Write( <font color="#A31515">"arg3?: "</font> ); arg3 = <font color="#2B91AF">Convert</font> .ToDouble( <font color="#2B91AF">Console</font> .ReadLine()); <br> <br> <font color="#0000ff">double</font> result = CodeMagics.ExecuteMagic(arg1, arg2, arg3); <br> <br> <font color="#2B91AF">Console</font> .WriteLine( <font color="#2B91AF">String</font> .Format( <font color="#A31515">"Result of arg1 - arg2 + arg3 = {0}"</font> , result)); <br> } <br> } <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  This is already in C #! <br><br>  Check it out!  Everything is working! <br><br>  It's clear that there is more code in C ++, but if interested people have a certain talent and interest to suffer in this area, then you can write some C ++ wrapper that will generate such code dynamically, and use this wrapper from C # , filling it with necessary variables and parameters, well, etc.  You can get a pretty interesting thing. <br><br>  Add a couple more amenities. <br>  The article is written with reference to the programming coprocessor.  In fact, you can write whatever your heart desires, for this you need to study the architecture of the memory and computer processor, instructions.  Technologically advanced programmers who know what SSE is (and it is almost 5 already) can write code using all the innovations of processor technologies and the most pleasant thing is to use it in C #.  Everything is limited to fantasy =).  Good luck in your endeavors! <br><br>  I want to express my deep gratitude to my friend Peter Kankovsky, who helped me in all this in due time!  He has his own wiki site, where he and his colleagues and friends discuss various ways to optimize code, etc. [http://www.strchr.com/] <br><br>  <b>UPD:</b> <a href="http://blogs.msdn.com/devinj/archive/2005/07/12/438323.aspx">Here</a> is a simple example of the same principle of generating native code, but completely in C #.  Thanks to lastmsu for the tip-off on Marshal.GetDelegateForFunctionPointer (). <br><br>  Thank you for attention!  Good luck! </div><p>Source: <a href="https://habr.com/ru/post/79883/">https://habr.com/ru/post/79883/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../79876/index.html">nginx + apache. Caching</a></li>
<li><a href="../79878/index.html">Doctrine, extending the capabilities of your favorite ORM framework! Part 1.a (I18n, quick access to translatable attributes)</a></li>
<li><a href="../79879/index.html">Get RSS / Atom feeds from any page</a></li>
<li><a href="../79880/index.html">Breaking "for an article"</a></li>
<li><a href="../79882/index.html">Notes on NLP (Part 5)</a></li>
<li><a href="../79884/index.html">Review of trackers of Ukraine</a></li>
<li><a href="../79888/index.html">Muscular computer interface</a></li>
<li><a href="../79890/index.html">On New Year's Eve, people sent greeting SMS to nowhere</a></li>
<li><a href="../79891/index.html">Easter egg from google</a></li>
<li><a href="../79892/index.html">SOHO and Apple</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>