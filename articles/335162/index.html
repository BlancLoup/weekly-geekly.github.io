<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Polymorphism and function pointers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Reading textbooks on programming, I am convinced that the perception of the material becomes much more complicated if the author submits himself to th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Polymorphism and function pointers</h1><div class="post__text post__text-html js-mediator-article">  Reading textbooks on programming, I am convinced that the perception of the material becomes much more complicated if the author submits himself to the concepts and tools, forgetting how important the context in which the material is revealed.  And, at the same time, how natural and easy the understanding comes when you feel the real convenience of using a new tool. <br><br>  In my opinion, function pointers are just such an example.  The fact is that the syntax for declaring and using function pointers is not very obvious, especially for not-so-experienced programmers, and if you immediately ‚Äúsprinkle‚Äù with details and syntactic possibilities, you won't see a forest behind the trees.  In this post, I want to share my vision of pointers to functions and give a simple example, which I dare to hope, will please me with its ease and kill another hare - it will demonstrate a terrible monster called ‚Äúpolymorphic challenge‚Äù. <br><a name="habracut"></a><br>  So, let us have an array of strings (although no one bothers it to be some other array) that needs to be sorted.  Sort, not sort.  That is, we plan to do this regularly and in different ways. <br><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n = <span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> cities[n] = { <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span> };</code> </pre> <br>  Suppose we need to be able to sort alphabetically (up / down) and along the length of the string (up / down).  In other cases it can be by height, by weight, by population, by salary.  Of course, we could implement some sorting method and replicate it with a change in the comparison method.  But, as we understand, there is duplication of the code with all the consequences arising from it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But how could it be otherwise if we cannot pass a function as an argument to a sorting function?  Or, after all, can we?  This is where pointers to functions come in.  This is exactly the tool that allows you to work with functions in the same way as with variables.  Well, or almost the same. <br><br>  So, here it is a function pointer.  Meet: <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>(*CompareFunction) (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j);</code> </pre> <br>  Do not try to understand the syntax.  Just know that after this command we can use the CompareFunction type to declare variable functions, albeit with a fixed signature.  In our case, these should be logical functions with two integer arguments.  As you might guess, these will be different ways of comparing.  Here they are: <br><br><pre> <code class="hljs matlab">bool compareUp(int <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>, int <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cities[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>] &lt; cities[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]; } bool compareDown(int <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>, int <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cities[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>] &gt; cities[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]; } bool compareLengthUp(int <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>, int <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cities[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">length</span></span>() &lt; cities[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">length</span></span>(); } bool compareLengthDown(int <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>, int <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cities[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">length</span></span>() &gt; cities[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">length</span></span>(); }</code> </pre><br>  Now put them in an array: <br><br><pre> <code class="hljs">CompareFunction compares[] = {compareUp, compareDown, compareLengthUp, compareLengthDown};</code> </pre> <br>  And then create a sort function: <br><br><pre> <code class="hljs matlab">void sortCities(CompareFunction compare) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> &lt; n - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>++) { int j_min = <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int <span class="hljs-built_in"><span class="hljs-built_in">j</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">j</span></span> &lt; n; <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (&lt;b&gt;compare(<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>, j_min)&lt;/b&gt;) { j_min = <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>; } } string temp = cities[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]; cities[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>] = cities[j_min]; cities[j_min] = temp; } }</code> </pre> <br>  And what is there bold?  This is a polymorphic call: the compare variable can be used to slip any comparison function, and the function being called will be determined dynamically, providing the required sorting method. <br><br>  And finally, we need some simple user interface to test everything. <br><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _tmain(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> argc, _TCHAR* argv[]) { setlocale(LC_ALL, <span class="hljs-string"><span class="hljs-string">"Russian"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (;;) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">choice</span></span>; cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">" : "</span></span>; cin &gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">choice</span></span>; sortCities(compares[<span class="hljs-keyword"><span class="hljs-keyword">choice</span></span>]); printCities(); } <span class="hljs-keyword"><span class="hljs-keyword">system</span></span>(<span class="hljs-string"><span class="hljs-string">"pause"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br>  Now everything is beautiful.  One programmer stamps logical functions, the second - optimizes the sorting algorithm, and the third - works on the user interface usability.  And no one bothers anyone - even duplication of code. <br><br>  PS The printCities () function is virtual, its implementation falls to the reader. </div><p>Source: <a href="https://habr.com/ru/post/335162/">https://habr.com/ru/post/335162/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335152/index.html">So who's back, bro?</a></li>
<li><a href="../335154/index.html">Mobile applications: how to avoid a ban from the advertising network?</a></li>
<li><a href="../335156/index.html">The digital economy should be digital</a></li>
<li><a href="../335158/index.html">Comparing REST and GraphQL</a></li>
<li><a href="../335160/index.html">Programming ‚â† computer science</a></li>
<li><a href="../335164/index.html">How to program a satellite photo? Problem solving Dstl Satellite Imagery Feature Detection</a></li>
<li><a href="../335166/index.html">Very easy monitoring system with Telegram and Consul</a></li>
<li><a href="../335168/index.html">How to set up backup to S3-compatible cloud from Commvault</a></li>
<li><a href="../335170/index.html">How we look for (and why we find) cool developers. HR experience and tips for job seekers</a></li>
<li><a href="../335172/index.html">Attack of the clones. How to deal with code duplication?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>