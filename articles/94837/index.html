<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to know that backup was successful</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings 

 Everyone knows that admins are divided into those who are not yet making backups and those who are already making backups. However, it is...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to know that backup was successful</h1><div class="post__text post__text-html js-mediator-article">  Greetings <br><br>  Everyone knows that admins are divided into those who are not yet making backups and those who are already making backups.  However, it is believed that there are also those who are piously convinced that backups are being made, but in reality this is not the case.  In this post I would like to tell a couple of real stories and (if possible) take stock, draw conclusions. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Disclaimer: all the stories are true, but in some places I cut off the edges, the image of the company and the admin are collective, all names are changed, faces are distorted beyond recognition, my first topic, blah blah blah, is one ... <br><br>  Introductory: let's imagine the company as a classic development company: it actively uses the version control system (subversion - in our case it is important), the version build system, well, into the load of the task-turn system and wiki.  The volumes are large, the loss of data costs a lot of money, everything should work ‚Äúlike a clock‚Äù and ‚Äúand if suddenly a fire‚Äù doesn‚Äôt bother anyone - you need to store the data!  We assume that backups after they are made automatically fall on the magnet.  tape / dvd in the safe general director / cell in a Swiss bank, so we have no problem with the availability of the last backup. <br><br><h4>  History number one </h4><br><br>  <strong>Preloch</strong> <br>  The admin writes a script that backs up the database and writes about it to the log. <br><br>  <strong>Drama</strong> <br><br><blockquote>  -Shef, it's all gone, chef! <br>  -Not a problem, we have backups!  Where is this our bearded bear? <br></blockquote><br>  The admin takes backups from backups that are neatly folded into daddies date_time and sees there that the dump files, starting with ‚Äúhalf a year ago,‚Äù are of zero size. <br><br>  <strong>After thunderstorm</strong> <br><br>  The mistake was at least amusing.  Instead <br><br> <code>mysqldump db &gt; db.sql &amp;2&gt;&gt; log.txt <br></code> <br><br>  was written <br><br> <code>mysqldump db &gt; db.sql &amp;&gt;&gt; log.txt <br></code> <br><br>  In fact, the fact that writing to the logs was added with the help of &gt;&gt; and saved the situation helped to avoid the worst, but this, of course, is a very big success.  When the error was found and the file log.txt, about ten gigabytes in size, was a matter of technique, finding the necessary lines near the end of the file and deploying the same dump. <br><br><h4>  Story number two </h4><br><br>  <strong>Preloch</strong> <br>  The admin writes a script that, with the help of svnadmin, dumps the entire repository and throws a copy on the backup server.  ‚ÄúAnd if something goes wrong?‚Äù Making the correct conclusions from the ‚Äúhistory number one time‚Äù Admin adds logging that a repository was saved for so many bytes on such and such a day. <br><br>  <strong>Drama</strong> <br>  In fact, the drama was avoided, but, again, lucky, everything could be much worse.  I wanted to make a second svn server, a kind of sandbox, a little bit later I wanted to roll the most recent dump on it once a day.  When solving this task, the Admin found out that the repository dump file, starting from some day, is broken.  At the same time, the size check was successfully passed - all revisions had been backed up to this critical one. <br><br>  <strong>After thunderstorm</strong> <br><br>  This time svnadmin was guilty, which makes a full backup iteratively, starting with the very first revision.  Some kind of revision in the middle was a bat, svnadmin reached it, broke, honestly reported it and left to itself.  <em>Unfortunately, I don‚Äôt know all the details from here, but they are not very important to us.</em>  It was not possible to fix the revision, it was also not possible to remove it (by the way, I do not know, again, how things are with this in the latest versions of subversion).  Therefore, a commanding decision was made to transfer the giant repository to the sandbox daily, using rsync. <br><br><h4>  Here it is necessary to sum up </h4><br><br>  What did I want to say to all of them?  What I personally think is very difficult to automate the process of deciding that the backup was successful.  Those.  successfully, for example, he went through, but how can he, without deploying this backup, verify that the data in it is all correct and relevant?  And, for example, new data, after some time will not begin to break the process of backup itself?  Moreover, errors leading to this can be as old as the world: <br><br><ol><li>  Human factor </li><li>  Unreliability of tools </li><li>  Errors in validation logic </li><li>  other </li></ol><br><br>  Personally, I do not know the answers to the questions voiced above.  If dear Habr know, forgive share experiences. <br>  In the meantime, I have long believed that the principle ‚Äúmade and forgotten‚Äù, at least in the case of backups, does not work.  And I advise you to deploy backup entirely on a stand-alone test server, if there is such an opportunity (here we kill two birds with the cost of writing time to deploy a backup).  Or write a separate script to check the integrity of backups.  Check to: <br><ol><li>  backup date </li><li>  file size </li><li>  file resizing relative to previous backup </li><li>  list of files in backup (or at least the number of unique ones) </li><li>  ... and send all this information with an accumulating letter to the mail once a day. </li></ol><br><br>  Thanks for attention. <br><br>  <em>UPD Thank you for your karma =&gt; transferred to the ‚Äúsystem administration‚Äù blog.</em> </div><p>Source: <a href="https://habr.com/ru/post/94837/">https://habr.com/ru/post/94837/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../94827/index.html">(Without) Competent newsletter</a></li>
<li><a href="../94831/index.html">Apple programmers are also no stranger to humor</a></li>
<li><a href="../94833/index.html">8-bit stop-motion</a></li>
<li><a href="../94834/index.html">Working with VKontakte Open API in the local development environment</a></li>
<li><a href="../94835/index.html">Review of the billing system BGBilling</a></li>
<li><a href="../94838/index.html">How I did an online naval battle with Silverlight 4</a></li>
<li><a href="../94839/index.html">Chrome OS designers about the future of the system</a></li>
<li><a href="../94841/index.html">iPad in United Kingdom May 28</a></li>
<li><a href="../94844/index.html">Using the Command Pattern to Organize RPC Calls in GWT</a></li>
<li><a href="../94846/index.html">Drush - command line for CMS Drupal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>