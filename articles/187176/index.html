<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Map with projections from Proj4js to Canvas</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Idea 
 I decided to write a post about the popular Canvas HTML5 now and about my dbCartajs project using it. Why Canvas? A bit of history. Before, to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Map with projections from Proj4js to Canvas</h1><div class="post__text post__text-html js-mediator-article"><h4>  Idea </h4><br>  I decided to write a post about the popular Canvas HTML5 now and about my dbCartajs project using it.  Why Canvas?  A bit of history.  Before, to create images that illustrate various computational models (for example, drawing a circle radially and centered in coordinates, drawing a polygon with the number of vertices N and area S, drawing a circle to a sphere, etc.), I and my colleagues at the Institute used various controls from different development environments: PictureBox, their VB6, QPainter and QCanvas from Qt, Canvas from Tk and, finally, creating images using the mapfile from MapServer.  Later, after exploring the possibilities of HTML5, I decided to switch to using Canvas and Web development with JavaScript.  Conveniently - only a browser is needed for debugging and development.  Having gathered strength and armed with documentation from W3C, I rewrote some of the functionality of the components that we use in our work, in JavaScript, having made it into the dbCartajs project on GitHub.  The code is implemented as a dbCarta object in order to use it as a widget on pages without copying parts of the source code. <br><img src="https://habrastorage.org/getpro/habr/post_images/00d/d7c/8f5/00dd7c8f53a6d19145192f9c112cf899.gif" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/403/5ff/4ea/4035ff4ea1146dd073577f91cbf56a70.gif" alt="image"><br>  Widgets with dbCarta <br><a name="habracut"></a><br>  Actually, ideally dbCartajs is ported from the dbCarta project to <a href="http://dbcarta.googlecode.com/">googlecode</a> implemented in Python and Tkinter. <br><br><h4>  How it works </h4><br>  dbCartajs uses Canvas to display objects by coordinates (longitude, latitude in degrees) or points.  The project includes the Proj4js library, which implements recalculations of map projections.  From it, several projections are set up for use - these are spherical nsper, ortho, laea and mercator (as in the popular Google Maps - Google Mercator).  By default, a canvas with a width-height ratio of 2: 1 is used, which corresponds to the flat projection of longlat from Proj4js.  If proj4js-combined.js is loaded, then other projections are available through the changeProject or initProj interfaces of the dbCarta object. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3fc/7bc/91b/3fc7bc91b6124065135d3cecc420aae4.jpg" alt="   dbCarta" title="World Cup 2014 will be held in Brazil"><br>  Projection Mercator 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Of course, not all the features of Canvas are implemented in dbCartajs, but I tried to pay attention to some.  The first is fonts.  When scaling, they do not change.  The second is the use of the isPointInPath method, which allows you to implement an analogue of using MAP, AREA and IMG elements.  And third, it is the possibility of combining objects from different projections.  In the StarrySky demo, the spherical projection nsper is used to derive the boundaries of the Earth, the contours of the continents, and the flat longlat projection is used to output stars and spacecraft orbits.  To change the projections, use the methods initProj (indicating the projection parameters for Proj4js) or changeProject (without parameters). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f6c/57f/28f/f6c57f28f73057fdd4800a7d9bd59485.jpg" alt="   StarrySky" title="Combining projections in StarrySky"><br>  The combination of projections in StarrySky. <br><br><h4>  About management </h4><br>  Moving around the map is available by clicking (a point within the map is centered by clicking).  The map is scaled via the scaleCarta interface or the ¬± buttons on the right.  In spherical projections, the globe is rotated via the initProj interface. <br><br><h4>  Where to look </h4><br>  Project examples can be viewed at <a href="http://dbcartajs.appspot.com/">dbcartajs.appspot.com</a> .  Sources are available in the GiHub project <a href="http://github.com/egaxegax/dbCartajs">dbCartajs</a> . <br><habracut></habracut></div><p>Source: <a href="https://habr.com/ru/post/187176/">https://habr.com/ru/post/187176/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../187164/index.html">HttpRequest - a library for easy work with the HTTP protocol</a></li>
<li><a href="../187166/index.html">Sound transmission through pictures in social networks</a></li>
<li><a href="../187168/index.html">Small office scan optimization</a></li>
<li><a href="../187170/index.html">Sony is preparing a camera that connects to the smartphone</a></li>
<li><a href="../187172/index.html">Simple Inter-Process Communication in C #</a></li>
<li><a href="../187178/index.html">Symfony2 subscribe to dynamic events</a></li>
<li><a href="../187182/index.html">Using XML on the example of offline work with documents</a></li>
<li><a href="../187184/index.html">A selection of useful for fans of Twitter Bootstrap</a></li>
<li><a href="../187186/index.html">Overview of the @to Music mobile app for the Android platform</a></li>
<li><a href="../187188/index.html">New Nokia Imaging SDK and Graphic Applications: Details</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>