<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>I wanted a beautiful piece of iron. Happened</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 1 >> Part 2 >> You are here 


 Once the beloved wife of friends in the country found a rainbow spring of a link. I remembered my childhood, walk...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>I wanted a beautiful piece of iron. Happened</h1><div class="post__text post__text-html js-mediator-article"><p>  <a href="https://habr.com/post/407581/" title="In which nothing really happened">Part 1</a> &gt;&gt; <a href="https://habr.com/post/408899/" title="In which Winnie the Pooh reflects on beautiful pieces of iron in general">Part 2</a> &gt;&gt; <a href="https://habr.com/post/423775/" title="Well, more beautiful">You are here</a> </p><br><p>  <em>Once the beloved wife of friends in the country found a rainbow spring of a link.</em>  <em>I remembered my childhood, walked up to the stairs and launched.</em>  <em>Miracle, but the spring from the first time ideally propruzhinil on each step.</em> <em><br></em>  <em>- Happened!</em>  <em>- with joyful surprise exclaimed everyone who was near.</em> <em><br></em>  <em>A three-year-old daughter also wanted to try.</em>  <em>She took the spring, climbed the stairs and launched it.</em>  <em>The spring flew over the stairs and fell sideways on the grass.</em> <em><br></em>  <em>- Happened!</em>  <em>- happily cried daughter.</em> </p><br><p>  A year has passed since the start of my fun project.  Happened!  That most beautiful piece of iron looks like this: <br><img src="https://habrastorage.org/webt/q8/r7/dt/q8r7dtlicz88928wpwny63sp6dw.png" alt="My darling"></p><br><p>  At first glance it may not be clear.  But suppose it is an ax.  And with this ax and a few parts at the end I will make porridge. <a name="habracut"></a></p><br><p>  And for a good porridge from the ax you need croup. </p><br><h1 id="wifi-slot">  WiFi slot </h1><br><p><img src="https://habrastorage.org/webt/5g/2-/le/5g2-led7lwkzbxjqlxzacvundjo.png"></p><br><p>  Everyone knows about ESP8266.  This board has several differences. </p><br><ol><li>  Troyka-modules are connected to it.  And there are a lot of them different. </li><li>  Such modules can be put there 4. </li><li>  It has 8 ADC channels, with a range measurement from 0 to 3.3 V. And for the bare ESP8266 this is not very typical. </li><li>  There are two power buses: power 5V, digital-analog 3.3 V. </li><li>  One into the other turns through DC / DC.  I personally zadolbali these boilers-regulators.  Hi high efficiency. </li><li>  This means that you can drive the motors straight from it.  And somehow I'll show you how. </li><li>  It supports Slot Connector.  And this is cool. </li></ol><br><p>  In short, I can stick 4 potentiometers into it, and it will look gorgeous.  After all, for the sake of steep onions, everything was started. </p><br><h1 id="i2cio">  i2cio </h1><br><p>  And here is my favorite STM32F030F4P6. </p><br><p><img src="https://habrastorage.org/webt/oc/by/rv/ocbyrvyuj1pn7ba3qom4gmycprm.png"><br><img src="https://habrastorage.org/webt/yb/tt/7-/ybtt7-tkdkvrs9w83lhuh8obqas.png"></p><br><p>  In the picture there are two boards with the same i2cio firmware.  This is an I / O port expander. <br>  9 control pins of this thing can: </p><br><ol><li>  12-bit ADC </li><li>  16-bit PWM, with a very cool adjustable frequency.  Although serfs hang there (DC / DC helps here), although the DC motors are all the same, although the sound is play. <br>  Also these 9 plus one more can digital input / output. </li></ol><br><p>  In addition, the Slot Expander supports Troyka connectors and power separation into power and analog parts. </p><br><p>  Ahhh ... I forgot.  Such extenders can be connected to the piece of iron a little more than 100 pieces.  And they are all sorted by I2C-addresses automatically, providing flat addressing pins.  That is, you can write </p><br><pre><code class="hljs objectivec">i2cio.digitalWrite(<span class="hljs-number"><span class="hljs-number">852</span></span>, HIGH); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tooMuchForAnalogPinNumber_areYouReallyShureQuestion = i2cio.analogRead(<span class="hljs-number"><span class="hljs-number">942</span></span>);</code> </pre> <br><p>  And at the same time everything will turn out. <br>  Well, it costs 33 rubles a stone.  And you can do with it, for example, a rider on the line with the world's largest number of grayscale sensors.  With 12-bit ADC and 16-bit sensitivity adjustment.  Without changing the firmware. </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><p>  That I will definitely show in the next series. </p></div></div><br><p>  We go further. </p><br><h1 id="ekshn">  Action </h1><br><p>  A friend asked me to make him a remote for Traktor - a favorite program of DJs.  I thought that if I could not do it quickly and beautifully, then I got the nonsense, and not a beautiful piece of hardware. </p><br><h2 id="skruchivaem-vsyo-vmeste">  Twist everything together </h2><br><p><img src="https://habrastorage.org/webt/p1/ao/lg/p1aolgxxxwwncvsyu9p8j2zksfm.jpeg"></p><br><p>  <em>Note: hereinafter it is understood that the text above has never been</em> </p><br><p>  To do this, I need a motherboard with esp8266 brains ( <em>left</em> ).  It differs from the others only in that it is square, has 8 ADC inputs and is powered from 5 V through a DC / DC converter.  And you can also connect to it the same square expansion card on my favorite stm32f030f4p6 ( <em>right</em> ) through a beautiful piece of iron ( <em>center</em> ). </p><br><h2 id="dobavim-kuchu-potenciometrov">  Add a bunch of potentiometers </h2><br><p>  One more feature of these pieces of iron - it is very simple to insert standard modules into them.  I have many different modules.  I took a bunch of potentiometers.  Because <em>everyone loves a bunch of potentiometers</em> (s). </p><br><p><img src="https://habrastorage.org/webt/gz/8_/-q/gz8_-qc9q_qzo2catvmrb17vehw.jpeg"></p><br><p>  More potentiometers to god potentiometers! </p><br><p><img src="https://habrastorage.org/webt/rj/mr/mo/rjmrmos5zqz3xubcnk3ua6pdx1k.jpeg"></p><br><h2 id="sol">  Salt </h2><br><p>  The longest assembly point.  If you want to do everything exactly like me, you need to do the following: </p><br><ol><li>  Buy in Leroy wooden corner with a side of 2 cm </li><li>  Take a saw and try to cut it off at 45 degrees </li><li>  Understand that it is not so easy.  Start running all over the place and look for the bar. </li><li>  Twist the bar out of the Soviet metal constructor. </li><li>  To cut almost the whole corner into a marriage, because it is not given to you, Vasily, to do something beautiful with your hands. </li><li>  Buy finally a bargain. </li><li>  GOTO 5. Because it is not given to you, Vasily.  Nothing to try. </li></ol><br><p>  Here's what happened: </p><br><p><img src="https://habrastorage.org/webt/4w/cv/wx/4wcvwxqkvqtnh71bqakrcuyx11w.jpeg"></p><br><h2 id="erunda-peredelat">  Nonsense, remake </h2><br><p>  A friend says: ‚ÄúWhat is this, a remote control for the tractor, yes?  It doesn't look like something. ‚Äù </p><br><p>  Good job.  Start over. </p><br><p>  Take another 4 expansion cards, fasten.  We take a bunch of moduli, and poke anywhere. </p><br><p>  It turned out this: <br><img src="https://habrastorage.org/webt/jq/gm/kw/jqgmkwsnlvp9khto6xipgd5l8-u.jpeg"></p><br><p>  Gently drill a hole for the Micro-USB connector to program the motherboard and, subsequently, charge the battery. </p><br><p><img src="https://habrastorage.org/webt/g5/7w/cf/g57wcfpyvkr0dv7n-sodjq2qtmi.jpeg"></p><br><p>  Oh, not given to you, Vasily, not given ... </p><br><h2 id="demonstraciya-raboty">  Demonstration of work </h2><br><p>  The result was a wireless remote for the tractor.  He controls the tractor over WiFi via Open Sound Control. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/FNeMSCDS_2M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2 id="ishodnyy-kod">  Source </h2><br><p>  Source code on <a href="https://github.com/acosinwork/WiFiSlot_OSC/tree/master/traktor_osc">gitHub</a> .  Filled the entire working folder, so as not to search for libraries all over the Internet. </p><br><h2 id="a-kak-voobsche-eto-rabotaet">  How does it work? </h2><br><p>  A beautiful piece of hardware is just a connector, which with the help of four bolts can transmit two signals and power.  The two signals are I2C.  The motherboard is able to scatter all expansion cards to successively running I2C addresses and, subsequently, to do something with them.  For example, read a 12-bit analog signal from (almost) each leg of the extender.  Or control the 16-bit PWM on each leg of the expander.  Well, or just use these legs as a digital input / output.  You can use these extenders if you simply do not have enough legs on your favorite microcontroller. </p><br><p>  Firmware stm32f030f4p6, installed on the expansion card is <a href="https://github.com/acosinwork/i2cio-firmware">here</a> . </p><br><p>  The library for working with port extenders in the Arduino IDE is <a href="https://github.com/acosinwork/I2cio">here</a> . </p><br><p>  If the respected habravchanam will be interesting, I will tell you more about it.  But not today. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/423775/">https://habr.com/ru/post/423775/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423765/index.html">Writing an application for remote control of the MPV player from RetroOrangePi</a></li>
<li><a href="../423767/index.html">Hackers attacked the airline British Airways: stolen data 380,000 customer bank cards</a></li>
<li><a href="../423769/index.html">Connect OpenSSL to Mono</a></li>
<li><a href="../423771/index.html">Once again, the PVS-Studio analyzer was more attentive than a human</a></li>
<li><a href="../423773/index.html">Roskomnadzor threatens to send a letter to Facebook</a></li>
<li><a href="../423777/index.html">Keystone Project: Trusted Environment for Running Applications Based on RISC-V</a></li>
<li><a href="../423779/index.html">Cloud-to-cloud backup: what it is and why it is needed</a></li>
<li><a href="../423781/index.html">Notes IoT provider. Case: we are making a LoRa network for TRK in Chelyabinsk</a></li>
<li><a href="../423783/index.html">Splunk: Machine learning to a new level</a></li>
<li><a href="../423785/index.html">Build a web-based server farm for Kubernetes using LTSP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>