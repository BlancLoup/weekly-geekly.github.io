<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The open project of the electric motor control module. Start</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The main purpose of the module is to control synchronous brushless motors (BLDC, BLAC, PMSM ...) with a trapezoidal or sinusoidal voltage, with speed-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The open project of the electric motor control module. Start</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/607/201/20f/60720120f55bfbe948b528a279741cd5.png"><br><br>  The main purpose of the module is to control <b>synchronous brushless motors</b> (BLDC, BLAC, PMSM ...) with a <b>trapezoidal</b> or <b>sinusoidal</b> voltage, <b>with</b> speed-position <b>sensors</b> or <b>without sensors</b> .  In addition, the module has small dimensions, a fairly wide range of supply voltages, various debugging channels, wired and wireless communications. <br><a name="habracut"></a><br>  The power of the motors controlled by the module can be within a few hundred watts and voltage up to 30V.  These are engines of various mechanisms and devices, such as: 3D printers, automatic doors, automatic shutters, autonomous pumps, fans, locks, power tools, position stabilizers, motors and RC servomechanisms of models, robots, and so on. <br><br>  But the use of the module is not limited to this.  It can be used with minor additions to control solenoids, stepper motors, to control lighting, as a powerful charger, as a voltage regulator, as a powerful source of audio signals, as a high-amp key with a current meter, and simply as a debugging platform. <br>  In short, such a module in the farm engineer can be very useful. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All these properties of the module are obtained thanks to the classical 3-phase half-bridge circuit with current and voltage sensors and a productive microcontroller. <br><br><div style="text-align:center;"><img width="574" src="https://habrastorage.org/getpro/geektimes/post_images/c45/7c6/a3e/c457c6a3e77b573a0e60a439689d80e5.png"></div><br clear="left">  <em>(Click to enlarge)</em> <br><br>  To speed up the process of developing a power circuit, one of the typical projects offered by TI was taken as a basis. <br><br>  I settled on the project board <a href="http://www.ti.com/tool/TIDA-00901">TIDA-00901</a> . <br><br><div style="text-align:center;"><img width="294" src="https://habrastorage.org/getpro/geektimes/post_images/b37/778/3a4/b377783a4f6a3045d11c180089a7eef8.png"></div>  <em>(Click to enlarge)</em> <br><br>  The board has good characteristics: current up to 20 A, engine power up to 200 W, rated voltage 12 V. Designed for use in a car. <br><br>  The <a href="http://www.ti.com/lit/ds/symlink/drv8305-q1.pdf">DRV8305</a> microcircuit is used as a power key <a href="http://www.ti.com/lit/ds/symlink/drv8305-q1.pdf">driver</a> .  Some searches led to the conclusion that this is one of the best driver ICs for such applications. <br><br>  A very useful development is the document <a href="http://www.ti.com/lit/ug/tidubp9/tidubp9.pdf">Automotive 12 V 200 W (20 A) BLDC Motor Drive Reference Design</a> . <br><br>  The board has a specific round shape, the C2000 LaunchPad controller is used as a control element.  Unfortunately, the software is provided not fully open in the part of the motor control libraries.  C2000 LaunchPad is made on the basis of DSP processor family F2802x Piccolo.  This family of processors is specialized for the development of simple energy converters, and is not distinguished by great versatility and volume of resources. <br><br><h2>  <b>Module architecture</b> <br></h2><br>  In this project, it was decided to execute the module in the form of a composite structure of 2 boards.  The main board contains the power driver, power subsystem and some peripheral functions.  A processor board is installed on the main board.  As the processor is selected <br>  <a href="https://geektimes.ru/post/274100/">K66BLEZ1</a> project <a href="https://geektimes.ru/post/274100/">board</a> (more articles on this project - <a href="https://geektimes.ru/post/274416/">1</a> , <a href="https://geektimes.ru/post/276098/">2</a> , <a href="https://geektimes.ru/post/276558/">3</a> , <a href="https://geektimes.ru/post/284248/">4</a> ) with a <a href="http://www.nxp.com/products/microcontrollers-and-processors/arm-processors/kinetis-cortex-m-mcus/k-series-performance-m4/k6x-ethernet/kinetis-k66-180-mhz-dual-high-speed-full-speed-usbs-2mb-flash-microcontrollers-mcus-based-on-arm-cortex-m4-core:K66_180">Kinetis</a> microcontroller from NXP family based on the <b>ARM Cortex-M4 core</b> .  ( <i>180 MHz, 2 MB of flash memory, 256 KB of RAM + micro SD card, real-time clock with autonomous power, USB device / host high speed, separate Bluetooth LE 4 / ZigBee chip</i> ) <br><br> <a href=""><img align="left" width="1040" src="https://habrastorage.org/getpro/geektimes/post_images/51b/ddb/5cf/51bddb5cf24465ca56fc6f64e578702b.png"><br clear="left"></a>  <a href=""><em>(Click to enlarge)</em></a> <br><br>  The module is powered in the voltage range <b>from 8.5 to 30 V.</b>  Several temperature sensors - in the microcontroller, near the power switches and one external protect the module and the motor from dangerous overheating.  The entire element base is selected for operation at <b>temperatures up to -40 degrees.</b>  <b>C.</b> <br><br>  Power motor control keys are designed for <b>pulse current up to 200 A.</b>  Current measurement is made by resistive shunts with a resistance of 0.001 Ohm.  Thanks to the adjustable amplifiers built into the DRV8305 driver chip, the module can <b>measure currents from 300 A to 0.1 A.</b> <br><br>  The CAN bus allows you to combine many of these modules into a common synchronized network. <br><br>  The <b>MPU-9250</b> microcircuit is useful in the case when the orientation of the module in space and inertial navigation is required, as well as for monitoring vibrations and impacts. <br><br>  The built-in DC-DC converter with an output voltage of 5V is designed for <b>currents up to 3.5 A.</b>  The module itself consumes no more than 150 mA from this converter, the rest of the current can be transferred to the external load from connector X4.  Connector X4 is convenient to use for connecting lighting and display elements, such as LED RGB tapes based on <b>WS2812B</b> chips and the like.  The processor hardware supports the generation of bit-coding protocol in digital outputs of the <b>WS2812B</b> format, as well as PPM, PCM, PWM coding.  Likewise, the module can accept PPM and PCM signals without any difficulty with minimal CPU usage. <br><br><h2>  Calculation of the maximum switching frequency and justification of the choice of power transistors </h2><br>  Recheck the comparison table of transistors proposed in the <a href="http://www.ti.com/lit/ug/tidubp9/tidubp9.pdf">document from TI</a> .  All parameters are rewritten from datasheets. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/fcb/926/b61/fcb926b6109d39da5b1a085fc9b6b591.png"></div><br><div style="text-align:center;"><img width="1011" src="https://habrastorage.org/getpro/geektimes/post_images/fef/a4f/df4/fefa4fdf49263b87979331d1edada666.png"></div><br>  <em>(Click to enlarge)</em> <br><br>  Here I, like the TI specialists, chose the CSD1854Q5B.  The maximum current is the best choice.  And the switching frequency of 122 kHz goes far beyond the reasonable limit achievable with control from the Kinetis family. <br><br><h2>  Calculation of the maximum current ripple and justification of the choice of filter capacitors </h2><br>  Current pulsations directly affect the heating and lifetime of capacitors, especially electrolytic ones.  Therefore, it is necessary to select capacitors by type and nominal, taking into account the estimated service life and maximum currents. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/cdc/578/0b3/cdc5780b3e15d8e6ad06c63051b524a2.png"></div><br>  Using this formula, you should check whether the module is able to control this motor without exceeding the maximum capacitor currents. <br><br>  As TI specialists calculated, with a capacitor indicated in the diagram, a module at a PWM frequency of 40 KHz can power a locked motor with a current through the windings of more than 80 A for a long time. <br><br><h2>  The circuit board of the module </h2><br><div style="text-align:center;"> <a href=""><img width="1020" src="https://habrastorage.org/getpro/geektimes/post_images/eb6/3c9/80a/eb63c980a0e740b1060a62e742b425be.png"></a> </div> <a href=""><br clear="left"></a>  <a href=""><em>(Click to enlarge)</em></a> <br><br><div style="text-align:center;"> <a href=""><img width="1024" src="https://habrastorage.org/getpro/geektimes/post_images/fb4/8cf/8c7/fb48cf8c73b142dedbf2db774bdfeff7.png"></a> </div> <a href=""><br></a>  <a href=""><em>(Click to enlarge)</em></a> <br><br><h2>  Connector locations </h2><br>  View of the main board from above: <br><br> <a href=""><img align="left" width="959" src="https://habrastorage.org/getpro/geektimes/post_images/78e/772/4ea/78e7724ea67bf2f33d59bdb7bcd69e01.png"><br clear="left"></a>  <a href=""><em>(Click to enlarge)</em></a> <br><br>  View of the main board below <br><br> <a href=""><img align="left" width="960" src="https://habrastorage.org/getpro/geektimes/post_images/98c/29f/375/98c29f3753343b885c412647b6aab132.png"><br clear="left"></a>  <a href=""><em>(Click to enlarge)</em></a> <br><br><h2>  Dimensions </h2><br><div style="text-align:center;"> <a href=""><img width="915" src="https://habrastorage.org/getpro/geektimes/post_images/c35/435/485/c35435485e2a9a6297f63e357b0887d0.png"></a> </div> <a href=""><br clear="left"></a>  <a href=""><em>(Click to enlarge)</em></a> <br><br><h2>  Project repository </h2><br>  All materials related to the project <a href="https://github.com/Indemsys/Universal3PHalfBridgeController">are stored here</a> . <br>  The circuit and the printed circuit board are developed in the Altium Designer 17.0.6 environment. <br>  In the repository you can find the <a href="">3D model of the</a> assembly in the STEP format. <br>  There is also <a href="">a calculation file</a> for the DC-DC converter on the A8586 in the Mathcad format. <br><br>  The software part of the project will be discussed in the next article. </div><p>Source: <a href="https://habr.com/ru/post/401873/">https://habr.com/ru/post/401873/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../401861/index.html">NASA is evaluating the possibility of a first SLS launch with astronauts aboard</a></li>
<li><a href="../401863/index.html">Google closes its Messenger Spaces</a></li>
<li><a href="../401865/index.html">Unexpected meeting. Chapter 7</a></li>
<li><a href="../401867/index.html">The video game industry opposes the rights of independent US companies to repair game consoles</a></li>
<li><a href="../401871/index.html">How a butterfly shoves, or the complexity of a simple extruder</a></li>
<li><a href="../401875/index.html">Vegetables for astronauts: how to grow fresh greens in NASA laboratories</a></li>
<li><a href="../401877/index.html">New audio projects: Hexagon player, stereo-transformer and adaptive music</a></li>
<li><a href="../401879/index.html">Phone thieves in Brazil began using phishing to steal iCloud data</a></li>
<li><a href="../401881/index.html">Evolution on the roof</a></li>
<li><a href="../401883/index.html">Enlightenment - the duty of each of us</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>