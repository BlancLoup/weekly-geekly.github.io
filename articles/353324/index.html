<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How is information security operational management center (SOC-center) built today?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In large companies, there are people who are engaged only in controlling the state of information security and waiting for problems to begin. This is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How is information security operational management center (SOC-center) built today?</h1><div class="post__text post__text-html js-mediator-article">  In large companies, there are people who are engaged only in controlling the state of information security and waiting for problems to begin.  This is not about security guards in front of monitors, but about selected people (at least one in a shift) in the information security department. <br><br><img src="https://habrastorage.org/webt/9c/lj/08/9clj08t9zgod3uqfjgcuq3wm-po.png"><br><br>  Most of the time the operator of the SOC center works with the SIEMs.  SIEM systems collect data from various sources throughout the network and, together with other solutions, compare events and assess the threat, both individually for each user and service, and in general for groups of users and network nodes.  As soon as someone starts to behave too suspiciously, the operator of the SOC-center receives a notification.  If the level of suspicion is overwhelming, the suspicious process or workplace is first isolated, and then a notification comes.  Next begins the investigation of the incident. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/r9/pa/jy/r9pajynrcsbwmkuqlauuaskpsr4.png"><br>  <b>Very simplifying, for each suspicious action the user receives penalty points.</b>  If the action is characteristic of him or his colleagues - there are few points.  If the action is not typical - there are a lot of points. <br><br>  For UBA systems (User Behavior Analytics), the sequence of actions also matters.  Separately, a sharp jump in traffic, connecting to a new IP or copying data from a file server happens from time to time.  But if the user first opened the letter, then he had an appeal to the newly registered domain, and then he began to search the neighboring machines and send strange encrypted traffic to the Internet - this is already a suspicion of an attack. <br><a name="habracut"></a><br><h3>  How do they usually work with information security? </h3><br>  Typically, at an average level of development of the information security department, a typical company has a set of protection systems - firewalls (often NGFW), streaming antiviruses, DDoS protection systems, a DLP system with agents at workstations, and so on.  But all this is rarely linked in a single information network, which compares events and finds unobvious correlations. <br><br>  "Still inexperienced" differ from "already experienced" lined up processes of work with the constantly changing infrastructure of the company.  That is, the system is dynamic, and the entire infrastructure is considered as a living organism, growing and continuously developing.  Based on this paradigm, all the rules of work, procedures and interaction rules within the existing ecosystem are set. <br><br>  If there is no such approach, even though the data is somehow collected, and the incidents are somehow recorded, we often see that those responsible do not know how to respond to certain situations.  I know you are ready to not believe me now.  But recently there was a vivid example.  When replacing the equipment, the state company did not have time to roll in the correct configs and caught the encryption virus.  They call and ask: ‚ÄúWhat should I do right now?‚Äù IT wants to block completely, clean up the network segment, reinstall all the operating systems, IB says that there is critical data and it‚Äôs not clear how the virus has reached - and doesn‚Äôt give permission to touch anything.  Time is running out. <br><br>  We advised to isolate the segment on the firewall, to make a complete snapshot of all the workstations of the segment and transfer it to us forignics.  While the analysis is being carried out, for encrypted stations, reinstall the OS from scratch, for the rest, check for a rootkit by running an antivirus from the LiveCD.  Then return the stations to the network, but continue to closely monitor the traffic on the proxy and NGFW for the spread of infection and conduct a security audit for key systems. <br><br>  As a result, the customer revised the IS risks and redid all protection to normal, with centralized control of the settings of workstations, servers and network equipment, centralized control system of applications being run, control of the integrity of key systems and more stringent settings on information protection tools. <br><br><h3>  How does building a SOC-center differ from the introduction of a SIEM system? </h3><br>  Well, first of all, the fact that SIEM-systems are reactive in nature.  They have a key advantage - they connect and unite a bunch of systems of different vendors.  That is, it is not necessary to change and redo the entire infrastructure from scratch - take your existing protection components and put a SIEM system on top of them.  The problem is that the SIEM system starts working only when the attacker has already penetrated the infrastructure.  Therefore, for an effective SOC-center, classic SIEM systems need to be supplemented with UBA class systems and Threat Intelligence data, which allow an attacker to be detected even at the early stages of an attack, ideally, at the stage of preparation for hacking. <br><br>  After a few weeks of learning the UBA-system, what is the incident, and what is the usual repetitive routine, there are about a dozen basic alarms a day.  Suppose, eight of them require quick analysis, but they end up banal - these are bugs, iron malfunctions, atypical, but allowed user activity.  Another is the situation when the script kiddie tries to break through the defense.  And the last - a real data leakage or targeted attack.  Such cases require a more detailed investigation, including a retrospective analysis of a large amount of data to a depth of about several months.  Here SOC-centers are well helped by data analysis systems built on the basis of technologies of the Big Data class. <br><br><img src="https://habrastorage.org/webt/sr/j2/yv/srj2yvrx-k4mud6ex8lsvyzupks.png"><br>  <i><b>Figure 1. Typical APT attack scenario</b></i> <br><br>  SIEM and UBA look at who did what, what changed and how, in order to understand whether a node or an employee has been compromised. <br><br>  Secondly, we need people who are engaged in the detection and investigation of security incidents.  That is, their task is not to support the infrastructure, but to actively participate in the rapid response to IS incidents.  A day at a large retail network is quite possible hundreds of potential security incidents.  Most of them are automatic attacks on web resources or unrecorded interactions with external systems, but some of them are quite real external APT attacks and internal fraud. <br><br>  Third, the regulations and procedures for the interaction of various units at the time of the attack, the so-called Play Book, according to which the IS incident is located and investigated, must be worked out.  In many situations, SOC employees must have high authority.  For example, they should have the right to immediately suspend the work of production if there is a massive data leak.  In the bank to cut food in such a situation - the limit of courage.  But if you think over everything in advance and fix the action plan in the regulations, you can choose the lesser evil in each specific situation.  All this is done in order to detect the incident as early as possible and minimize potential damage. <br><br><h3>  Practice </h3><br>  We have implemented our SOC-center, to which we have connected both our infrastructure and a number of our customers.  It is based on the SIEM-system, which we supplemented with our own development based on Big Data with machine learning for the detection of anomalies and APT attacks.  On the first line, we have a dedicated Helpdesk group - ‚Äúuniversal soldiers‚Äù, who will conduct basic troubleshooting and simple incidents can be closed.  The second line is analysts, information security specialists, who are involved in the investigation of complex incidents and deep forsensics.  And there is also a team of pentesters, which from time to time checks the perimeter of the network for strength.  All teams communicate with each other through HPSM for convenience and to support a single knowledge base. <br><br>  One of the most important pieces of behavioral analysis systems that are deployed within SOC-centers is training and calibration.  That is, those very assessments of the actions of users and nodes on a scale of potential danger generated in real time.  If a user's workstation is compromised, then its behavior in the system will be quite different from colleagues. <br><br>  It is important to localize on the basis of type behavior.  For example, if a person works as a networker in a large company and launches a bunch of weird tools, SIEM will see that he has five other people working next to him - that means all the rules.  But if the accountant begins to do something similar to the engineer frills - the alarm will be immediately. <br><br><img src="https://habrastorage.org/webt/w_/9i/tc/w_9itcaz6mvlflcd_kmkq9zpb8k.png"><br>  <i><b>Figure 2. Machine learning models for detecting abnormal network activity</b></i> <br><br>  In practice, during implementations during calibrations, we found: <br><ul><li>  Those who decided to remember cryptocurrency. </li><li>  Found an innumerable number of people who send files to their personal mail.  Set up auto-blocking filters - if there are many such files, mail is blocked. </li><li>  We caught a couple of people on a potential report leak, but it‚Äôs just that the bookkeeping was set in motion entirely and the system didn‚Äôt have time to learn. </li><li>  The customer somehow burned the first ‚Äúcombat‚Äù alarm - the https traffic wrapped through some strange IP.  It turned out that the financial department worked with bank clients who redirected the page to an external resource to assess browser compromise, and from there the traffic went to banking itself.  It looked really strange, but talked to the bank, this is the norm. </li><li>  In one of the branches of a large company, they found an admin who installed the ‚Äúleft‚Äù software on his workstation, disabling half of the information security systems.  And they burned him on the fact that he downloaded another crack with a virus and managed to start distributing it across the internal network segment.  The customer isolated the segment, and we did the forensics. </li><li>  Caught a couple of comrades who use their colleagues' accounts for their business.  A colleague in Irkutsk, and then hop - from the office working on his car.  Disorder.  Or, the account suddenly generated 10 thousand login attempts in a couple of minutes - some wrote a robot, but when changing passwords I forgot to feed him a new account. </li><li>  Well, we spotted several attacks.  The model looks like this: first, a letter came with a high suspicion of spam.  Then the user turned to the website with a fresh domain registration.  Next pause, everything is calm.  After 2 weeks at night, someone remotely connected and started downloading data from a file server.  At this point, an incident was created for manual processing, after 4 minutes filtering was turned on only on the ‚Äúwhite sheet‚Äù, then in the morning a full debriefing was done.  Full automation was not used - it requires caution, because if there is a system that blocks everything, then the attack itself can go for it. </li></ul><br><br><h3>  Another pair of chips </h3><br>  A very good thing is to evaluate the model and roll up a heap of incidents to the root cause.  For example, uplink failure between data centers is one big problem, not hundreds of mini-failures of workstations, servers and network equipment.  Operators must understand, so it‚Äôs done most often like this: <br><ul><li>  pre-determined key business processes; </li><li>  a catalog of IT services is created that support the work of business processes; </li><li>  for each IT service, its main components are determined: servers, network equipment, a set of application software; </li><li> a resource-service model is built, which is a hierarchical graph, the nodes of which are the key components, and the edges are the connections between them. </li></ul>  As a result, in the event of a failure, the operator has complete information on where the failure occurred and on what services and business processes it affects. <br><img src="https://habrastorage.org/webt/lu/mp/44/lump44kkg6zclpxtmuc_dlkpsea.png"><br>  <i><b>Figure 3. Formation of the resource-service model</b></i> <br><br>  A very good thing - the union of disparate incidents in a single killchain.  There are a number of stages through which a hacker goes through hacking infrastructure, ranging from preparing for scanning to ending with data theft and destroying logs.  Signs of such activity can be monitored for months and recorded in the user's ‚Äúcard‚Äù, which allows operators to quickly identify a ‚Äúzero patient‚Äù. <br><br><img src="https://habrastorage.org/webt/ka/e5/-v/kae5-vvu1_4rfjymeowlp1lkuug.png"><br>  <i><b>Figure 4. Example of killchain</b></i> <br><br><h3>  Evolution of the protection system </h3><br><img src="https://habrastorage.org/webt/gn/kf/q5/gnkfq5m2uyrjlb6lpwa-z8scn6w.png"><br><br><img src="https://habrastorage.org/webt/u_/fi/7a/u_fi7alrraswr1tntyb6a0ounas.png"><br><br>  In the end, it looks like this: <br><img src="https://habrastorage.org/webt/2u/dw/p_/2udwp_tafsdn6349wrcgp0p1sby.png"><br><br>  And this is an example of a set of security systems that are interconnected within the SOC and exchange data via the SIEM: <br><br><img src="https://habrastorage.org/webt/mt/5q/r8/mt5qr8i8zyip_tyybkyfuubfot8.png"><br><br>  By the way, if you are a novice specialist and have long wanted to work in the field of information security, we have something for you.  We are looking for a junior manager to promote information security solutions.  It will be necessary to understand both current solutions and vendors and their products.  Communicate with customers, make commercial offers and so on.  In general, it will not be boring.  For details, write me an email. <br><br><h3>  Links </h3><br><ul><li>  <a href="https://habrahabr.ru/company/croc/blog/352044/">We found a large company that has not been engaged in information security for 5 years and is still alive</a> </li><li>  <a href="https://habrahabr.ru/company/croc/blog/346902/">Safety of football stadiums: some implicit features</a> </li><li>  <a href="https://habrahabr.ru/company/croc/blog/328958/">Network microsegmentation in examples: how this cleverly twisted thing reacts to different attacks</a> </li><li>  <a href="https://habrahabr.ru/company/croc/blog/236411/">Directed IT attacks in the sphere of large business: how it happens in Russia</a> </li><li>  My mail is dberezin@croc.ru </li></ul></div><p>Source: <a href="https://habr.com/ru/post/353324/">https://habr.com/ru/post/353324/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353314/index.html">SOC for intermediate. We understand what we are protecting, or how to make an inventory of infrastructure</a></li>
<li><a href="../353316/index.html">How to set up various notifications about problems with the site</a></li>
<li><a href="../353318/index.html">State space in problems of designing optimal control systems</a></li>
<li><a href="../353320/index.html">Vulnerability found in Vesta CP hosting control panel</a></li>
<li><a href="../353322/index.html">Visualizing Process Connections in Linux</a></li>
<li><a href="../353328/index.html">How to use getDerivedStateFromProps in React 16.3 (py subtitles)</a></li>
<li><a href="../353332/index.html">Own validations of fields for Rules in one class</a></li>
<li><a href="../353334/index.html">How to use the geodata analysis to predict the number of emergency calls in different parts of the city?</a></li>
<li><a href="../353336/index.html">5 Differences technical product manager from business-oriented PM</a></li>
<li><a href="../353338/index.html">Binary tree numbering</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>