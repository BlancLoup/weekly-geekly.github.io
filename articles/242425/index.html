<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Jump Start in PowerShell (Part I)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Only automation. PowerShell only. 



 Foreword 
 As a hobby and given time, I teach students at UKIT (the former Moscow State College of Information ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Jump Start in PowerShell (Part I)</h1><div class="post__text post__text-html js-mediator-article">  Only automation.  PowerShell only. <br><br><img src="https://habrastorage.org/files/dc3/20a/c3a/dc320ac3ae3045afad6c394bce588cc2.png"><br><br><h4>  Foreword </h4><br>  As a hobby and given time, I teach students at UKIT (the former Moscow State College of Information Technology).  At the moment I have little time to devote him to a group of students, but it is enough to prepare a post here on Habr√©. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I work as a system administrator in a large non-IT company with a large focus on IT resources.  By the nature of the activity, it seems to solve a large number of similar tasks in user services. <br><br>  I became acquainted with PowerShell about two years ago, but I came to grips with it only a year later, not realizing at first its enormous possibilities.  In the article, first of all, I will focus on those who want to start working with PowerShell, but do not trust it yet or don‚Äôt know from which side to approach this miracle. <br><br>  <b>Warning: PowerShell is addictive.</b> <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  Wikipedia tells us: <br><blockquote>  <b>Windows PowerShell</b> is an extensible automation tool from <b>Microsoft</b> , consisting of a shell with a command line interface and a related scripting language. </blockquote><br>  PowerShell can look like the command line: <br><br><img src="https://habrastorage.org/files/2e9/440/76b/2e944076b4dc40b89429367ebfb80af8.png"><br>  <i>powershell.exe</i> <br><br>  Or in the form of an application: <br><br><img src="https://habrastorage.org/files/e5f/bec/a27/e5fbeca272e14f918aa13361c266ab27.png"><br>  <i>powershell_ise.exe</i> <br><br>  <b>Powershell_ise.exe</b> is called the integrated script environment - Windows PowerShell ISE.  Allows you to work with the language in a convenient environment with syntax highlighting, command constructor, autocomplete commands by pressing TAB and other delights.  Ideal for creating and testing scripts. <br><br>  To launch the <b>powershell.exe</b> or <b>powershell_ise.exe</b> environment, just type the same name in the line to execute. <br><br><img src="https://habrastorage.org/files/e09/624/761/e09624761ee9494d8cfb25dfb0a8d850.png"><br><br>  The PowerShell script file has the extension <b>.ps1</b> . <br><br><img src="https://habrastorage.org/files/82b/01b/c33/82b01bc332bd4295ab104b526890b6ff.png"><br><br>  The script will not work to run a double paint.  This is done specifically in order not to harm the system by accidentally running a script. <br><br>  To start, click on the RMB should choose "Run with PowerShell": <br><br><img src="https://habrastorage.org/files/53e/d1c/de6/53ed1cde616e4e10be00c98fd80a6a0f.png"><br><br>  In addition to the fact that there is a restriction on the launch of LKM scripts, by default execution of scripts in the system is prohibited, again, for the reason described above, do not harm the system.  To check the current execution policy, run the command: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ExecutionPolicy</code> </pre> <br><br><img src="https://habrastorage.org/files/46e/399/fc7/46e399fc77324041978b57310cfbc131.png"><br><br>  We will get one of the following values.  With a high probability, if this was the first launch, we will get <b>Restricted</b> . <br><br><ul><li>  <b>Restricted</b> - Scripts cannot be run; </li><li>  <b>AllSigned</b> - Only scripts signed by a trusted publisher can be run.  Before executing the trusted publisher script, confirmation will be requested; </li><li>  <b>RemoteSigned</b> - Allowed to execute scripts created by us and downloaded scripts signed by a trusted publisher; </li><li>  <b>Unrestricted</b> - No restrictions, all scripts can be run. </li></ul><br><br>  For execution and testing, we will lower the policy to <b>RemoteSigned by</b> running the command: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>-ExecutionPolicy RemoteSigned</code> </pre><br><br><img src="https://habrastorage.org/files/285/fa8/3be/285fa83be2c140b0ba27be283af09700.png"><br><br><h4>  Getting Started </h4><br><h5>  Cmdlet </h5><br><ul><li>  Cmdlets are PowerShell commands that have different functionality; </li><li>  Cmdlets can be either system or user-created; </li><li>  The cmdlets are named by the Verb-Noun rule, which makes memorization easier; </li><li>  The cmdlets display the results in the form of objects or their collections; </li><li>  Cmdlets can both receive data for processing and transmit data through the pipeline (about pipelines later); </li><li>  The cmdlets are not case sensitive (you can write get-process, and Get-Process, and GeT-pRoCeSs); </li><li>  After the cmdlets do not necessarily put " <b>;</b> ", except when we run several cmdlets on one line (Get-Process; Get-Services). </li></ul><br><br>  For example, to get the current processes, we run the command: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Process</code> </pre><br><br>  And we get the result: <br><br><img src="https://habrastorage.org/files/d44/79d/925/d4479d925d0d48789ebbd0b1ee6a987a.png"><br><br>  Try it yourself to do: <br><br><pre> <code class="hljs 1c">Get-Service <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword"></span></span></span><span class="hljs-meta">   ,   </span></span></code> </pre><br><br><pre> <code class="hljs tex">Get-Content C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span></span>32<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">drivers</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">etc</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hosts</span></span></span></span> #   .   ,  hosts</code> </pre><br><br>  It‚Äôs not necessary to know all the cmdlets by heart.  <b>Get-Help will</b> save the situation. <br>  Information on all available cmdlets can be obtained by typing the following command: <br><br><pre> <code class="hljs sql">Get-<span class="hljs-keyword"><span class="hljs-keyword">Help</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Category</span></span> cmdlet</code> </pre><br><br>  If we use PowerShell ISE, we facilitate the development process. <br>  Just enter the dash " <b>-</b> " after typing the cmdlet, and we will get all the possible options for the parameters and their types: <br><br><img src="https://habrastorage.org/files/c8f/6d3/a65/c8f6d3a653fd492381e743556039cc57.jpg"><br><br>  Try this: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Service -<span class="hljs-type"><span class="hljs-type">Name</span></span> p*</code> </pre><br><br>  If, nevertheless, we forget what properties a particular cmdlet has, run it through <b>Get-Member</b> : <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Process | <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Member # "|"  .   .</code> </pre><br><br><img src="https://habrastorage.org/files/06d/c52/510/06dc52510ac246059cfecd8cb3a7a540.png"><br><br>  Not enough information?  Refer to the help with the <b>-Examples option</b> : <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Help <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Process -Examples</code> </pre><br><br>  We <b>get a</b> description of <b>Get-Process</b> , and even with examples of use: <br><br><img src="https://habrastorage.org/files/a5f/103/2c6/a5f1032c6cc947c6b845432903ea191b.png"><br><br><ul><li>  Cmdlets can have abbreviated names - aliases.  For example, instead of <b>Get-Help,</b> you can simply use <b>Help</b> .  To get all the abbreviations, do <b>Get-Alias</b> . </li></ul><br><br>  Try this: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>-Process notepad</code> </pre><br><br>  What is similar to the recording: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">start</span></span> notepad</code> </pre><br><br>  Now stop the process: <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">Stop</span></span>-Process -<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> notepad</code> </pre><br><br>  Or so: <br><br><pre> <code class="hljs pgsql">spps -<span class="hljs-type"><span class="hljs-type">Name</span></span> notepad</code> </pre><br><br>  A little earlier, we said that cmdlets are referred to as Verb-Noun.  Clarify that the verb does not have to be <b>Get</b> .  In addition to what we can receive, we can set the <b>Set</b> (remember, Set-ExecutionPolicy), start <b>Start</b> , stop <b>Stop</b> , output <b>Out</b> , create <b>New</b> and many others.  The name of the cmdlet is not limited to anything, and when we create our own with you, we can name it as it pleases. <br><br>  Let's try to output to the file: <br><br><pre> <code class="hljs cmake"><span class="hljs-string"><span class="hljs-string">"Hello, Habr!"</span></span> | Out-<span class="hljs-keyword"><span class="hljs-keyword">File</span></span> C:\<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>.txt &amp; C:\<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>.txt</code> </pre><br><br>  By the way, you can write the same way: <br><br><pre> <code class="hljs cmake"><span class="hljs-string"><span class="hljs-string">"Hello, Habr!"</span></span> &gt; C:\<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>.txt &amp; C:\<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>.txt</code> </pre><br><br><h5>  Comments </h5><br>  We all know to use comments is good form. <br><br>  Comments in PowerShell are lowercase - <b>#</b> and block - <b>&lt;#</b> ... <b>#&gt;</b> : <br><br><img src="https://habrastorage.org/files/269/ade/007/269ade0072c34614bfeca0a16344822d.png"><br><br>  Let's pay attention to the code from the example: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-WmiObject -<span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Win32_OperatingSystem | <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> Caption</code> </pre><br><br>  For those who are familiar with <b>WMI</b> , who do it on good old VBScript, remember how much code you need to write? <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">On</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Resume</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> strComputer = <span class="hljs-string"><span class="hljs-string">"."</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objWMIService = <span class="hljs-built_in"><span class="hljs-built_in">GetObject</span></span>(<span class="hljs-string"><span class="hljs-string">"winmgmts:\\"</span></span> &amp; strComputer &amp; <span class="hljs-string"><span class="hljs-string">"\root\cimv2"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> colItems = objWMIService.ExecQuery(<span class="hljs-string"><span class="hljs-string">"Select * from Win32_OperatingSystem"</span></span>,,<span class="hljs-number"><span class="hljs-number">48</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> objItem <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> colItems Wscript.Echo <span class="hljs-string"><span class="hljs-string">"Caption: "</span></span> &amp; objItem.Caption <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span></code> </pre><br><br><h5>  Conveyor </h5><br>  Pipeline ( <b>|</b> ) - transmits the output of one command to the input data for processing by another command.  We used the pipeline earlier, getting all the properties of the object or, in the previous example, choosing from the data set only the Caption field. <br><br>  To understand the principle of the pipeline, let's run the code: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Service | Sort-<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span> -property Status</code> </pre><br><br>  What happens: we get all the services (Get-Service), pass all the received services to the sorting cmdlet Sort-Object and indicate that we want to sort them by the Status parameter.  At the output, we first get all the services with the status Stop, and then all the services with the status Running. <br><br>  In the example below, we first get all the services running.  After the first pipeline, we go through each element, select only those services for which the status is Running and on the second pipeline we choose what we want to see on the output only the displayname of services: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Service | <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> {$_.status -eq "Running"} | <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> displayname</code> </pre><br><br>  In the example, we use <b>$ _</b> .  This entry indicates the current item in the pipeline. <br><br><img src="https://habrastorage.org/files/d62/d85/714/d62d8571425c48b480b73a47fa6319a8.png"><br><br><h4>  Afterword </h4><br>  In this part, we learned how to run PowerShell, and figured out the script execution policy.  Understood what are cmdlets, we know how to pass them through the pipeline and how to get their properties.  If we forget something, be sure to get-help. <br><br>  All this knowledge is necessary to make the first leap into the language.  Believe me, many more interesting things! <br><br><h4>  To be continued... </h4><br><br><h4>  Additional Information </h4><br><br><ul><li>  <a href="http://habrahabr.ru/post/242445/">Jump Start in PowerShell (Part II)</a> ; </li><li>  <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D50395">Download PowerShell v.5 for free without registration</a> ; </li><li>  Wonderful course on MVA: <a href="http://www.microsoftvirtualacademy.com/training-courses/advanced-tools-and-scripting-with-powershell-3-jump-start-russian">Advanced features and scripting in PowerShell 3.0 (Jump Start)</a> .  My advice is to look at the first 3 blocks, plunge into the language, try to complete some tasks and see the remaining blocks after a week.  Russian subtitles; </li><li>  <a href="http://www.techdays.ru/videos/PowerShell">Video on the topic on TechDays;</a> <br>  <a href="https://gallery.technet.microsoft.com/scriptcenter/site/search%3Ff%255B0%255D.Type%3DProgrammingLanguage%26f%255B0%255D.Value%3DPowerShell%26f%255B0%255D.Text%3DPowerShell">Technet PowerShell Script Gallery</a> ; <br>  <a href="http://blogs.msdn.com/b/powershell/">PowerShell Developer Blog</a> . <br></li></ul></div><p>Source: <a href="https://habr.com/ru/post/242425/">https://habr.com/ru/post/242425/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../242409/index.html">LED control over the Internet using RaspberryPi</a></li>
<li><a href="../242411/index.html">Btree node deletion algorithm</a></li>
<li><a href="../242413/index.html">Tinkoff Bank at a performance conference in C #</a></li>
<li><a href="../242415/index.html">New WebStorm 9: just better. Support for Meteor, React and JSX, integration with Gulp, PhoneGap and more</a></li>
<li><a href="../242417/index.html">Otkrytie Mobile Bank: development from reverse</a></li>
<li><a href="../242427/index.html">We use AngularJS in Windows Phone 8.1 applications</a></li>
<li><a href="../242429/index.html">Seven principles for creating modern web applications</a></li>
<li><a href="../242433/index.html">View all keystrokes in Google Docs</a></li>
<li><a href="../242435/index.html">Opera Mini 9 for iOS</a></li>
<li><a href="../242439/index.html">Hackers hacked more than 3 million iTunes accounts?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>