<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Universal templating for Kohana 3.1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear residents of Habr. 

 For quite a long time, I worked with various engines, frameworks, and other self-written variants of the PHP progres...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Universal templating for Kohana 3.1</h1><div class="post__text post__text-html js-mediator-article"> Hello, dear residents of Habr. <br><br>  For quite a long time, I worked with various engines, frameworks, and other self-written variants of the PHP <s>progress</s> engine, as a result of which the brain, which was still young and eager for change, put down its own and, as is usually the case, very ambitious impression that everything should be done.  Here, absolutely everything. <br><br>  Delving into such monstrous pieces like Drupal or Joomla, I understood that yes, the abundance of a developed API and the presence of a large number of modules makes such engines indispensable for creating websites of almost any complexity, but moving to simpler things, like MVC CodeIgniter or Kohana frameworks (the latter essentially follows the concepts of HMVC), it was understood that it‚Äôs not always convenient to pound nuts with earth-to-earth missiles, and ease not only in handling the code, but also in the work of the site itself, which is called ‚Äúsolves‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the moment I am working on MVC (or HMVC, to be exact) Kohana framework, in particular, on the branches of versions 3.0 and 3.1, and, trying to find the most complete and elegant solution for an adequate template of the site, I was surprised to find that my Googling skills are morally obsolete, or the results are really summed up, but there is definitely no objective leader for my task. <br><br>  Having collected some of my thoughts and ideas, I decided to combine them into a convenient and intuitive template system. <br><a name="habracut"></a><br>  I say right away that I will not cite all the code, since it takes quite a few lines, plus, it includes not a description of not only the controller, but also some views, so I‚Äôll tell you the general principle of the template engine with small examples. <br><br>  At the core of templating is the controller <i>template.php</i> , which must be put in <b>APPPATH.classes / controller /</b> <br><br>  The controlling controller itself is described as follows: <br> <code><b>abstract class Controller_Template extends Controller</b></code> <br> <br>  Therefore, in order for your controller to use the capabilities of templating, it must be inherited from the manager, for example: <br> <code><b>class Controller_Welcome extends Controller_Template</b></code> <br> <br><h4>  General features template </h4><br><ul><li>  meta, script, style - add meta-tags, links to js scripts and css-files. </li><li>  Title - Set the page title. </li><li>  Bread crumbs - allows you to build a chain of bread crumbs of navigation based on those already created on the way. </li><li>  Content - ‚Äúblock‚Äù filling in the $ content key variable, which is the main content of the page. </li><li>  Regions - ‚Äúblock‚Äù filling in content variables for different places on a page, like header, footer, and so on. </li><li>  Pager - Simple generation of a link bar on a page based on the number of the current page and the total number of elements. </li><li>  Returning three different types of content depending on the request (HMVC, AJAX or normal). </li></ul><br><br>  In appearance, the number of functions is not particularly impressive, but I did not set myself the goal (at least for the first time) to create from this functionality at the level of phptemplate or something more cumbersome and comprehensive.  The above functions are enough to determine the central system of templating the site, and no longer suffer, and this is the main task that stood before me. <br><br>  Then I will give a brief description of the frauds in the controller. <br><br><h4>  Controller operation </h4><br>  In order for our controller, for which we enable templating, not to swear, it is necessary to specify the string <b>parent :: before ()</b> in its function <i>before</i> to initialize templating. <br><br>  During the initiation of the template engine and, accordingly, the automatic execution of its function before the following actions occur: <br>  - Download template config <br>  - Check and install the pager if the <i>page</i> argument is passed <br>  - Creating an ‚Äúempty‚Äù view and zeroing template variables <br><br>  After these actions, the template is ready for operation and can be launched even without setting any parameters.  The launch itself is carried out automatically, without calling any functions like <i>render ()</i> or others, which saves us from having to follow the process of content generation. <br><br>  However, our goal, on the contrary, was to provide us with the ability to easily control the template, right? <br><br>  To modify the page, you can use the following constructions anywhere in the controller functions: <br><br><h5>  List of functions provided </h5><br><ul><li>  <b>target ($ path)</b> - sets the path for the main view file on which the template will work.  If the path is not set, the standard one is taken from the template folder in the views. </li><li>  <b>Meta_name ($ title, $ content)</b> - sets a meta tag of the form <i>\ &lt;meta name = 'name' content = 'content' \&gt;</i> . </li><li>  <b>Meta_equiv ($ title, $ content)</b> - sets a meta tag of the form <i>\ &lt;meta http-equiv = 'name' content = 'content' \&gt;</i> . </li><li>  <b>breadcrumb ($ link, $ title, $ strict = false)</b> - installs <b>breadcrumbs</b> into an existing path.  With the $ strict option, the new path is glued to the existing path by default, otherwise an absolute link will be created. </li><li>  <b>title ($ title)</b> - sets the page title. </li><li>  <b>content ($ html, $ clear = false)</b> - adds a block to the content variable of the page.  By default, a VIEW class object ready for rendering is passed to the function, but if the <i>$ clear</i> flag is set, the content is understood as pure html. </li><li>  <b>region ($ region, $ html, $ clear = false)</b> - adds a block to one of the regional variables of the page.  It works by analogy with the <i>content</i> function, only requires you to specify the name of the region. </li><li>  <b>alias ($ region, $ alias = '')</b> - creates an alias for an already created page region.  By default, all regions are stored in the <i>$ regions</i> array, and this function allows you to specify a direct variable of the form <i>$ alias</i> </li><li>  <b>add_style ($ path)</b> - adds css file.  The path is taken relative to the media path specified in the template config file. </li><li>  <b>add_script ($ path)</b> - adds js file.  The path is taken relative to the media path specified in the template config file. </li><li>  <b>pager ($ all)</b> - creates a pager line based on the total number of any elements.  If the page is not set, and the function is called, the template engine generates a ruler for the first page. </li></ul><br><br><h5>  Minor remarks </h5><br>  The above functions work in any order and act as storage devices for information that is compiled and rendered after the user action has been completed, so there is no need to follow the correct pattern generation sequence. <br><br>  The functions of generating breadcrumbs, pager and content blocks and regions use my views stored in the template views folder by paths, respectively, <i>breadcrumbs</i> , <i>pager</i> and <i>blocks</i> . <br><br>  Depending on the type of request by which an <i>action</i> is called, the template engine returns different content.  For an HMVC request, this will only be the compiled and rendered content variable of the page, for the AJAX request it will be the same variable but wrapped in <i>json_encode</i> , and the usual request will render the entire page completely. <br><br><h4>  Total </h4><br><br>  Summing up, let me say once again that the template engine does not claim to be the best theme engine for Kohana, but is simply a convenient set of ideas for facilitating the management of the page's appearance.  I note that there is room to grow, for example, add the ability to render in html or xhtml, screw the unloading mechanism for css-styles and js-scripts into the corresponding style and script tags to display them as a result as text, and not as an AJAX reference or HMVC-request, and many other tasty buns, but it will be done as needed. <br><br>  Soon this branch will be uploaded to git so that anyone can easily download and update files as the functionality expands, but for the time being I apologize for the link to the <a href="http://zalil.ru/30740498">file</a> .  Modifications and modifications are welcome. <br><br>  I hope this template engine will help someone and get rid of unnecessary problems. <br><br>  Thank you all for your attention, I will be glad to hear constructive criticism and suggestions! </div><p>Source: <a href="https://habr.com/ru/post/116237/">https://habr.com/ru/post/116237/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116230/index.html">YouTube marks Earth Hour</a></li>
<li><a href="../116232/index.html">Inversion Control / Inversion of Control</a></li>
<li><a href="../116234/index.html">Full hiding of fields by properties in C #</a></li>
<li><a href="../116235/index.html">Bird twitter</a></li>
<li><a href="../116236/index.html">The task of finding the maximum on segments of fixed length</a></li>
<li><a href="../116239/index.html">Daily Twitter Twitter in London</a></li>
<li><a href="../116240/index.html">Erlang web</a></li>
<li><a href="../116241/index.html">New release of open hypervisor Xen 4.1</a></li>
<li><a href="../116242/index.html">People routers</a></li>
<li><a href="../116243/index.html">Do you visit sites with a mobile version from mobile phones?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>