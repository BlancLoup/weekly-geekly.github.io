<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CoreOS - Linux for minimalist clusters. Short</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is CoreOS? 

 CoreOS is a Linux-based operating system for building easily and flexibly scalable clusters. CoreOS is a minimalist distribution. T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CoreOS - Linux for minimalist clusters. Short</h1><div class="post__text post__text-html js-mediator-article"><h4>  What is CoreOS? </h4><br><br>  CoreOS is a Linux-based operating system for building easily and flexibly scalable clusters.  CoreOS is a minimalist distribution.  The installation ISO image is only 136 MB in size, and in the memory on the final machine after installation and start-up it will take only 114 MB.  CoreOS is based on ChromeOS, which in turn <a href="https://ru.wikipedia.org/wiki/Google_Chrome_OS">is based on Gentoo</a> . <br><br>  In fact, CoreOS can be divided into the following parts: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <a href="https://ru.wikipedia.org/wiki/Systemd">Systemd</a> - manages local services on cluster machines </li><li>  <a href="https://ru.wikipedia.org/wiki/Docker">Docker</a> - provides isolation of services, but its use, in principle, is not necessary </li><li>  <a href="https://github.com/coreos/etcd">Etcd</a> - Distributed Cluster Configuration </li><li>  <a href="https://coreos.com/docs/launching-containers/launching/launching-containers-fleet/">Fleet</a> - provides distributed service management ("add-on" above systemd) </li></ul><br><br>  CoreOS can run systemd services on the necessary cluster machines, monitor their status, and store their configuration. <br><br><a name="habracut"></a><br><br><h5>  Systemd </h5><br>  CoreOS uses the usual <a href="https://wiki.archlinux.org/index.php/Systemd_%2528%25D0%25A0%25D1%2583%25D1%2581%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9%2529">systemd</a> , which can now be found in many Linux distributions.  This is a local management system for Linux services. <br><br><h5>  Docker </h5><br>  About Docker more than once <a href="http://habrahabr.ru/search/%3Fq%3D%5Bdocker%5D%26target_type%3Dposts">wrote on Habr√©</a> .  In short and in a simple way - Docker takes the kernel of the Linux host operating system, mounts the file system image you specify to it and allows you to work inside this image as if you are in a virtualized environment. <br><br>  Please note that Docker does not use virtualization.  To isolate processes, <a href="https://ru.wikipedia.org/wiki/Cgroups">cgroups</a> and <a href="http://en.wikipedia.org/wiki/Cgroups">namespaces are used</a> , which makes it possible to get rid of a rather serious overhead project, which is provided by tools such as KVM.  Of course, Docker can be used both on Mac and Windows, but in this case the host operating system will have to work inside VirtualBox or any other virtualization system, since Docker needs the Linux kernel to work (see <a href="https://github.com/boot2docker/boot2docker">Boot2Docker</a> ) <br><br><h5>  Etcd </h5><br>  Etcd is a distributed <a href="http://en.wikipedia.org/wiki/NoSQL">Key-Value</a> storage that runs on each CoreOS cluster machine and provides general access to virtually all data across the entire cluster.  The etcd stores service settings, their current status, the configuration of the cluster itself, etc.  Etcd allows you to store data hierarchically (tree storage), subscribe to changes to keys or entire directories, set TTL values ‚Äã‚Äãfor keys and key directories (actually, "expose" them), atomically change or delete keys, store them in an orderly manner (which allows you to implement specific queues ).  Since the configuration of services running across the cluster is stored in etcd, you can learn about starting and stopping a service by simply subscribing to changes to the corresponding keys in the repository. <br><br>  Etcd supports REST HTTP interface, so curl is enough to work with it.  From the command line in CoreOS is controlled by the <i>etcdctl</i> utility. <br><br><h5>  Fleet </h5><br>  Fleet is an add-on over systemd that transfers service management from the local machine to the cluster level.  Fleet stores the configuration of services as systemd units (in etcd), automatically delivers it to local machines, starts, restarts (if necessary), and stops the services on the cluster machines.  Fleet is able to plan the launch of services based on the workload of specific cluster machines.  It can be said that a specific service needs to be run only on certain machines, etc. <br><br><h4>  CoreOS is very simple </h4><br>  In order to start the hello service in a CoreOS cluster, you just need to do the following: <br><br>  1. Login to any of the cluster servers via SSH (they are all equal) <br>  2. Create a text file with a description of the service.  For example, hello.service: <br><br><pre><code class="html hljs xml">[Unit] Description=My Service After=docker.service [Service] TimeoutStartSec=0 ExecStartPre=-/usr/bin/docker kill hello ExecStartPre=-/usr/bin/docker rm hello ExecStartPre=/usr/bin/docker pull busybox ExecStart=/usr/bin/docker run --name hello busybox /bin/sh -c "while true; do echo Hello World; sleep 1; done" ExecStop=/usr/bin/docker stop hello</code> </pre> <br><br>  3. Run the following commands: <br><br><pre> <code class="bash hljs">fleetctl submit hello.service fleetctl load hello.service fleetctl start hello.service</code> </pre><br><br>  4. Everything!  Having received the last command, fleet, because we did not give him any instructions on this matter, determine the least loaded cluster machine, take our unit file, transfer it to the selected machine, put it where systemd stores its services and asks systemd to start it.  And after the launch will monitor the status.  If the machine on which the service was performed suddenly ‚Äúcrashes,‚Äù fleet will restart our service on another machine. <br><br>  Consider our example in more detail. <br><br>  Service Configuration File: <br><br><pre> <code class="html hljs xml">[Unit] #    Description=My Service #       docker.service After=docker.service [Service] #       #    ,  docker         TimeoutStartSec=0 #       . #       ,      . ExecStartPre=-/usr/bin/docker kill hello ExecStartPre=-/usr/bin/docker rm hello #          docker    # fleet ,          ExecStartPre=/usr/bin/docker pull busybox #    .      Bash. ExecStart=/usr/bin/docker run --name hello busybox /bin/sh -c "while true; do echo Hello World; sleep 1; done" #     ExecStop=/usr/bin/docker stop hello</code> </pre><br><br>  Commands to execute: <br><br><pre> <code class="html hljs xml">#               fleetctl submit hello.service # ,             systemd    fleetctl load hello.service #   fleetctl start hello.service</code> </pre><br><br>  You can view the status of services using the <i>fleetctl list-unit-files</i> command (a short summary of all services) or fleetctl status hello.service (detailed information about the service). <br><br><h4>  Install CoreOS </h4><br>  CoreOS can be installed in <a href="https://coreos.com/docs">various ways</a> .  But if you decide to experiment, I recommend installing through Vagrant. <br><br>  1. Install <a href="http://git-scm.com/downloads">Git</a> , <a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a> , then the latest versions of <a href="https://www.vagrantup.com/downloads.html">Vagrant</a> . <br>  1a  Or, run in any folder <i>git clone <a href="">github.com/coreos/coreos-vagrant.git</a> &amp;&amp; cd coreos-vagrant</i> <br>  1b.  Or, if you didn‚Äôt want to download Git, unpack it somewhere. <br><br>  2. Go to the folder, rename the file <i>user-data.sample there</i> to <i>user-data</i> , <i>config.rb.sample</i> to <i>config.rb</i> .  Go to <a href="https://discovery.etcd.io/new">discovery.etcd.io/new</a> , copy the URL that appears in the buffer, uncomment the line with the discovery instruction in user-data and replace the URL there. <br><br>  3. Go to the folder and run <i>vagrant up there</i> <br>  4. Wait for the base image to download. <br>  5. Run vagrant ssh. <br><br>  You inside :) <br><br><h4>  CoreOS limitations, weaknesses and surprises </h4><br>  CoreOS does not provide anything except what it provides :) In other words, ‚Äúout of the box‚Äù, it doesn‚Äôt know anything except what we discussed.  And, if you are going to build clusters based on CoreOS, you will encounter at least the following problems: <br><br><h5>  Batch Manager and Updates </h5><br>  CoreOS is missing a batch manager.  And any system for building or installing additional software, too (except for wget and curl :)).  Alternatively, I can suggest using the <a href="https://coreos.com/docs/cluster-management/debugging/install-debugging-tools/">Docker integrated toolbox container</a> .  To activate it, simply run <i>/ usr / bin / toolbox</i> from the command line.  This will launch the privileged Fedora container, where you can access yum. <br><br>  CoreOS updates are performed for the entire OS using a system of active / passive partitions.  In fact, there are two system partitions in CoreOS.  Only one of them is active at each moment.  The update of the entire OS is installed on the second one, after which a reboot and a change of the active partition are performed.  The operating system is updated only as a whole.  Accordingly, it is quite easy to roll back to the previous version of the OS.  If you, like me;), have already wanted to have a package manager in CoreOS out of the box, read the <a href="https://coreos.com/docs/sdk-distributors/sdk/modifying-coreos/">Developer Documentation</a> . <br><br><h5>  Service discovery </h5><br>  The "trick" of CoreOS is that it easily transfers services between cluster machines, stopping and starting them on their own.  Roughly speaking, this means that your web server, initially running on machine X, in five minutes can easily end up on machine Y, which has a completely different IP address on the internal network.  Of course, with the help of special instructions for Fleet, you can easily ‚Äúchain‚Äù the service to a specific machine, but ... then why do you need CoreOS at all?  :) This creates an IP address resolution problem for your services.  In principle, it is easy enough to request etcd and find out which machine is currently running the service.  But this will not happen completely automatically.  Service Discovery is a serious question and for its solution <a href="http://stackoverflow.com/questions/18285212/how-to-scale-docker-containers-in-production">a huge amount of software is offered</a> , from which <a href="https://github.com/skynetservices/skydns">SkyDNS appeals to</a> me the most.  You can use SkyDNS with the help of <a href="">sidekick-units</a> . <br><br><h5>  Container persistence and data per se </h5><br>  If you notice, CoreOS is actually built around stateless docker containers that are easy to transfer to another machine and run there.  Indeed, it‚Äôs pretty easy to containerize, say, nginx and php-fpm.  Configuration files for them can also be distributed as a container.  Even the source code of your application can be distributed in the form of data-volume (this is a docker-container that contains only data) and connected to various services.  What do you want to do with databases? <br><br>  There are several outputs.  First, services like Flocker, which migrate data containers after the service containers that use this data.  Second, run DBMS-like services in cluster mode.  NoSQL solutions can do this very well, relational solutions are noticeably worse, but still it is possible.  Thirdly, it is possible to raise within a cluster any distributed file system like GlusterFS or Ceph.  However, such a solution needs to be assessed in terms of speed.  These issues were discussed <a href="https://github.com/coreos/fleet/issues/892">here</a> . <br><br><h4>  Conclusion </h4><br>  CoreOS is experiencing, I‚Äôm not afraid of these words, explosive growth.  Like the Docker, in general.  The number of different projects for CoreOS is increasing <a href="https://github.com/search%3Futf8%3D%25E2%259C%2593%26q%3DCoreOS">every day</a> .  So, if now you lack something for solving a specific task, tomorrow this opportunity may appear. <br><br>  As part of the CoreOS project, an alternative standard for containerization of <a href="https://coreos.com/blog/rocket/">Rocket</a> is being developed.  However ... for now, apparently, it is better to use Docker.  Moreover, CoreOS is not going to abandon Docker in the future. <br><br><h6>  What to read? </h6><br><br>  Of course, you can read the <a href="https://coreos.com/docs/">documentation</a> .  However, I really liked the <a href="https://www.digitalocean.com/community/tutorial_series/getting-started-with-coreos-2">series of articles on Digital Ocean about CoreOS</a> .  As a matter of fact, this article was written on its basis and under its influence :) </div><p>Source: <a href="https://habr.com/ru/post/244585/">https://habr.com/ru/post/244585/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244571/index.html">Consulo: ~ 1000 kommitov, or as the autumn passed</a></li>
<li><a href="../244573/index.html">Eggs.Variant - Part I</a></li>
<li><a href="../244575/index.html">Swift Error Handling - Sword and Magic</a></li>
<li><a href="../244577/index.html">What the team leader should know and how we made up the program for the second day of the Go conference</a></li>
<li><a href="../244579/index.html">Review of the most interesting materials on data analysis and machine learning ‚Ññ24 (November 24 - 30, 2014)</a></li>
<li><a href="../244587/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ136 (November 24 - 30, 2014)</a></li>
<li><a href="../244593/index.html">The fastest supercomputers in the world</a></li>
<li><a href="../244595/index.html">How does the transfer of a cell phone number to another operator work: FAQ and development experience</a></li>
<li><a href="../244597/index.html">5 of the most necessary additions to Laravel 4</a></li>
<li><a href="../244601/index.html">How to optimize your marketing content strategy to reach more potential customers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>