<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analyzing access logs using Splunk</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you have an Access Control System or, in other words, an ACS, but you do not know how you can get useful information from the data that this system...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analyzing access logs using Splunk</h1><div class="post__text post__text-html js-mediator-article">  If you have an Access Control System or, in other words, an ACS, but you do not know how you can get useful information from the data that this system generates, then this article will be useful to you. <br><br><img src="https://habrastorage.org/webt/xs/iy/cw/xsiycwisviszfufnghzuuvznym0.png"><br><br>  Today we will talk about how with the help of Splunk, which we <a href="https://habrahabr.ru/company/tssolution/blog/324136/">talked about earlier</a> , you can get analytics on the results of ACS activities, and also why it is needed. <br><a name="habracut"></a><br>  First, we will make a few comments on what the ACS is and where we are meeting with it.  ACS is a system for limiting and registering people‚Äôs entry and exit or transportation in a given area through all ‚Äúpoints of passage‚Äù, for example, doors, gates, turnstiles, checkpoints, and so on. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a result of each ‚Äúpassage‚Äù, the system is left with a record of who, when, where and where it went from.  We will load and process this data in Splunk. <br><br><h2>  Why Splunk? </h2><br>  Some ACSs write a fairly unstructured log, and with the help of Splunk it is possible even to sort such a log in automatic mode.  In addition, Splunk automatically collects and stores data, and also allows you to quickly get analytics in a mode close to real time. <br><br><h2>  Implementation </h2><br>  First, we will look at the visualization of the results, and then we will go deeper into how it was received and consider several queries. <br><br><h3>  Visualization </h3><br>  You can provide visualization in the context of the entire organization or in the context of each employee. <br><br>  This figure shows pie charts showing through which access points employees enter and exit. <br><br><img src="https://habrastorage.org/webt/8k/mx/ci/8kmxcidfx1sdqdvdwe2mic7theo.jpeg"><br><br>  Also, you can notice the anomalous behavior of employees, when in one day, one pass makes more inputs than exits or vice versa. <br><br><img src="https://habrastorage.org/webt/ld/je/hz/ldjehz1sclnevfoalcgacg0q4pk.jpeg"><br><br>  It is possible to build histograms of lateness and work beyond the schedule, i.e.  how many times the staff were late / processed a day in less than an hour, from an hour to two hours, from two to three, etc. <br><br><img src="https://habrastorage.org/webt/ij/xx/sv/ijxxsvphjnyl9znmhhxt3ce3azu.jpeg"><br><br>  The figure below shows the statistics for the departments: the average lateness of the staff of the department, the average time spent outside working hours.  As well as the duration (if the statistics for one day) or the average duration of each employee. <br><br><img src="https://habrastorage.org/webt/qd/u7/i_/qdu7i_jmqndsxj9zqd41mwaigts.jpeg"><br><br><h3>  Requests </h3><br><h4>  Counting Abnormal Cards </h4><br> <code>index="scud" | strcat surname " " name Name|search Name = "*" | eval last=mvindex(mv_type,-1) | eval check=if( type=""AND last="" AND count_mv_in==count_mv_out, "Normal","Anomaly")| stats count by check</code> <br> <br><img src="https://habrastorage.org/webt/tn/xk/vy/tnxkvyx94ac2r9cf5rpgmwdnhj0.jpeg"><br><br><h4>  Calculation of the duration of the working day of each employee </h4><br> <code>index="scud" | strcat surname " " name Name|search Name = "*" <br> | eval check=if( type=""AND mvindex(mv_type,-1)="" AND count_mv_in==count_mv_out, "Normal","Anomaly") <br> | search check=Normal <br> | eval sec_in=tonumber(substr(in,12,2))*3600 + tonumber(substr(in,15,2))*60+tonumber(substr(in,18,2)) <br> |eval sec_out=tonumber(substr(mvindex(mv_out,-1),12,2))*3600 + tonumber(substr(mvindex(mv_out,-1),15,2))*60+tonumber(substr(mvindex(mv_out,-1),18,2)) <br> | eval duration=round((sec_out-sec_in)/3600,2)| eval h=floor(duration)| eval m=(duration-h)*60| strcat h "  " m " " Duration | strcat surname " " name Name| <br> table Name Duration | sort - Duration <br></code> <br><br><img src="https://habrastorage.org/webt/9i/ms/wl/9imswllojoqi2kzefeerxalg31m.jpeg"><br><br><h2>  Conclusion </h2><br>  In general, it is possible to get a lot of useful information from the ACS data; what was presented above is just an example that can be customized to fit everyone‚Äôs needs.  As for the license for Splunk, since the amount of data per day is small, you can get by with a free license. <br><br>  We are happy to answer all your questions and comments on this topic.  Also, if you are interested in something specifically in this area, or in the field of machine data analysis in general, we are ready to refine the existing solutions for you, for your specific task.  To do this, you can write about it in the comments or simply send us a request through the form <a href="https://tssolution.ru/splunk/">on our website</a> . <br><br><h2>  PS </h2><br>  <b>On June 28, 2018,</b> ‚Äú <a href="http://tssolution.tilda.ws/study-splunk">Splunk Getting Started</a> ‚Äù will be taught <b>in Moscow</b> , where in 6 hours the participants will receive a theoretical base and practical skills for working in Splunk.  Learn more about learning and register at this <a href="http://tssolution.tilda.ws/study-splunk">link</a> . </div><p>Source: <a href="https://habr.com/ru/post/345412/">https://habr.com/ru/post/345412/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345396/index.html">NRF51822 in brief: Power saving and some peripherals</a></li>
<li><a href="../345402/index.html">Do not go to Fediverse, there you are in trouble. - Well, why not go there? They are waiting</a></li>
<li><a href="../345406/index.html">How and why we rethought the search input field of Yandex</a></li>
<li><a href="../345408/index.html">Who "goes to the clouds": Western IT startups that use virtual infrastructure</a></li>
<li><a href="../345410/index.html">Financial accounting for non-entrepreneurs</a></li>
<li><a href="../345416/index.html">10 main announcements of Microsoft in 2017</a></li>
<li><a href="../345418/index.html">LAN routing through transparent socks-proxy</a></li>
<li><a href="../345420/index.html">Derivation of the formula for the nth term for a recurrent sequence using the example of the task from the Amnesia quest</a></li>
<li><a href="../345422/index.html">The digest of interesting materials for the mobile developer # 235 (December 18 - December 24)</a></li>
<li><a href="../345424/index.html">Enterprise Architecture vs alchemy enterprises. Key myths</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>