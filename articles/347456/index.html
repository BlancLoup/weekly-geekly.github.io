<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Layer 7 DoS: Web Application Denial of Service Attacks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Distributed denial of service attacks that popular sites typically undergo with thousands and thousands of hacked devices. These attacks are mainly ai...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Layer 7 DoS: Web Application Denial of Service Attacks</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/0q/fv/jj/0qfvjjj3thmaky1-2ufoggylfxy.png"><br><p>  Distributed denial of service attacks that popular sites typically undergo with thousands and thousands of hacked devices.  These attacks are mainly aimed at suppressing the target system with large-scale traffic, clogging the communication channel.  These attacks relate to layer 3 (the network layer of the ISO / OSI model) DoS / DDoS and are characterized by a large number of packets with which the resource is attacked.  Layer 7 (ISO / OSI model application layer) DoS / DDoS is usually aimed at the weak points of the web application. </p><a name="habracut"></a><br><p>  To begin with, I‚Äôll give some statistics from the Incapsula <a href="https://www.incapsula.com/blog/q2-2017-global-ddos-threat-landscape-report.html">research</a> - starting from 2016, the DoS / DDoS attacks at the application level prevail over the classic denial-of-service attacks at the network level: </p><br><img src="https://www.incapsula.com/blog/wp-content/uploads/2017/10/number-of-ddos-attacks-q2-2017.jpg" alt="image"><br><p>  The difficulty in defining such attacks is that a web application cannot easily distinguish an attack from regular traffic.  There are many factors that contribute to this difficulty, but one of the most important is that for several reasons IP addresses may not be useful as identification data.  In a network attack, it is possible to distinguish illegitimate traffic and block attacking IP addresses; in the case of attacks on the application level, this is difficult to do: it is necessary to determine exactly the attacking signs without blocking legitimate users.  Also, the simple use of a resource (without attacks) can lead to the exhaustion of its resources - this can be known here to many Habraeffect. </p><br><h3>  The main types of DoS / DDoS attacks: </h3><br><p>  <b>Volumetric: Volumetric</b> attacks target the bandwidth overflow of the hosting infrastructure's web application, directing large amounts of network traffic.  Usually such traffic is represented by UDP / ICMP flood. </p><br><p>  <b>Layer 3:</b> These attacks target the weaknesses of the TCP protocol stack architecture.  The attacker sends packets designed to overflow, distort, or destroy connection state information, causing additional work for network processing functions on the target device and slowing down responses.  The most common vectors for such attacks are TCP SYN flood, TCP fragmentation, teardrop, etc. </p><br><p>  <b>Layer 7:</b> These attacks are focused on the logic of the web application and are aimed at the exhaustion of web server resources in the processing of "heavy" requests, intensive processing functions or memory. </p><br><h3>  Application resources </h3><br><p>  Most web servers can handle several hundred simultaneous users with normal resource usage.  The problem is that a single attacker can generate enough traffic from a single host to deny service to a web application.  Load balancing in this case does not help with the word "absolutely." </p><br><p>  The main problems are as follows: CPU utilization - using 99% of the CPU causes other critical processes to stop;  RAM - invalid memory allocation, leaks, memory exhaustion - a disadvantage for other critical processes;  processes and threads - deadlock (freezing of processes), forks, race condition;  disk - disk overflow. </p><br><h4>  One of the important resources of a web server is RAM.  The attacks on the exhaustion of this resource may be the following: </h4><br><p>  <strong>Recursion</strong>  Here is a good example of recursive code - include ('current_file.php').  PHP allocates new memory for each inclusion and repeats the process until there is no memory left.  This vulnerability can be detected as a classic LFI (local file inclusion). </p><br><p>  <strong>Zip bombs.</strong>  Web applications that allow downloading of compressed files and extracting content may be susceptible to such an attack, especially if the application (or library that processes decompression) does not perform proper file checking. </p><br><p>  <strong>XML bombs.</strong>  Named entities can be expanded not only in character strings, but also in a sequence of other entities.  Recursion is prohibited by the standard, but there are no restrictions on the allowed depth of nesting.  This allows you to achieve a compact representation of very long text lines (similar to how archivers do it) and forms the basis of the attack ‚Äúbillion laughs‚Äù. </p><br><p>  <strong>Deserealization.</strong>  A relatively new type of attack, but quite serious, that is introduced in OWASP TOP 10 2017 A8-Insecure Deserialization.  This is the process of restoring the initial state of the data structure from the bit sequence.  With inadequate control of user input can lead to resource exhaustion. </p><br><p>  <strong>File headers</strong>  The manipulation of file header values ‚Äã‚Äãmay lead to resource exhaustion.  If the calculation is performed in the input file, where the file size is in its header.  These can be images, video files, documents, etc.  Example - <a href="https://github.com/carrierwaveuploader/carrierwave/wiki/Denial-of-service-vulnerability-with-maliciously-crafted-JPEGs--(pixel-flood-attack)">pixel flood attack</a> . </p><br><p>  <strong>Reading infinite data streams.</strong>  Reading / dev / zero or / dev / urandom via LFI, using <a href="">1TB speedtest</a> , etc. </p><br><h4>  An important parameter of the web server is the CPU, attacks on the exhaustion of processor capacity can lead to the inoperability of the web application. </h4><br><p>  <strong>reDOS - Regular Expression Denial of Service.</strong>  A relatively new type of attack was first identified on Stackoverflow.  It was not an attack by the attacker, but by the actions of a user who included 20,000 whitespace characters in the code snippet.  The regular expression was written in such a way that it forced the system to check a string of 20,000 characters for 200.010.000 steps (20,000 + 19,000, + ... + 2 + 1).  If the web application allows the use of regular expressions, it is worth checking incoming data carefully. </p><br><p>  <strong>SQL injection.</strong>  Using SQL injection can significantly reduce the performance of a web application, especially when using functions like sleep, benchmark, etc. </p><br><p>  <strong>Fork bombs</strong>  Processes that are repeated again and again, using all the resources of the system.  The most famous is: () {: |: &amp;};:. </p><br><p>  <strong>Abuse of resources / functions.</strong>  An attacker can detect a resource-intensive operation on a web application and send a lot of resource exhaustion requests.  An example would be the abuse of password hashing functions. </p><br><p>  <strong>SSRF.</strong>  Operation of the server side request forgery of vulnerabilities could allow an attacker to exhaust the resources of the attacked web server. </p><br><h4>  Disk space is also a critical parameter of the web server. </h4><br><p>  <strong>Download large files.</strong>  The most obvious way to fill the system with data is to upload large files to the server.  If the application does not apply the proper restrictions, the attacker can upload data to the system until the web server has exhausted its resources. </p><br><p>  <strong>System log overflow.</strong>  In the absence of log rotation functions, an attacker can ‚Äúclog‚Äù the system logs or serve as a catalyst for creating a huge number of these logs, which will lead to the exhaustion of disk space resources. </p><br><h3>  Utilities for testing web applications: </h3><br><p>  I will deliberately not consider narrowly specialized utilities such as LOIC / HOIC, aimed, as a rule, at destabilizing the work of certain web applications. </p><br><p>  <strong>Malicious use of these tools is prohibited and may be prosecuted by the laws of the country where you are a resident.</strong>  <strong>Use these tools to test only your own servers, or servers that are legally agreed with their owner.</strong> </p><br><p>  <a href="https://github.com/llaera/slowloris.pl">Slowloris</a> is a fairly well-known testing utility.  There is an <a href="http-slowloris-check.html">nse script</a> for nmap. </p><br><p>  <a href="https://github.com/grafov/hulk">HULK</a> (HTTP Unbearable Load King) - generates a large stream of unique requests that maximize the use of web server resources.  To complicate the task of filtering the stream, HULK for each request substitutes a different user agent, obfusts the referrer, uses the no-cache and keep-alive attributes, as well as unique URLs. </p><br><p>  <a href="https://www.owasp.org/index.php/OWASP_HTTP_Post_Tool">OWASP DoS HTTP POST</a> is a utility from the OWASP consortium for generating "slow" http requests. </p><br><p>  <a href="https://github.com/jseidl/GoldenEye">GoldenEye</a> HTTP Denial of Service Tool - exploits HTTP Keep Alive + NoCache vectors. </p><br><h3>  Preventive measures </h3><br><p>  A good practice of preventive protection of a web application would be load testing a web resource.  To study the response time of the system at high or peak loads, "stress testing" is performed, at which the load generated on the system exceeds the normal usage scenarios. </p><br><p>  The main purpose of load testing is to create a certain expected load in the system (for example, through virtual users or their actions) to monitor system performance indicators.  This will allow you to identify and strengthen the bottlenecks / weaknesses of your web application and avoid possible risks of application unavailability in the future. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/347456/">https://habr.com/ru/post/347456/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347446/index.html">Mission Impossible or get a certificate</a></li>
<li><a href="../347448/index.html">‚ÄúCourse on hyperscale‚Äù: there are almost 400 hyper-scalable data centers in the world</a></li>
<li><a href="../347450/index.html">Flask Mega-Tutorial, Chapter 8: Subscribers, Contacts and Friends (Edition 2018)</a></li>
<li><a href="../347452/index.html">IT solutions architecture. Part 2. Architects</a></li>
<li><a href="../347454/index.html">Familiar faces: algorithms for creating a "typical" portrait</a></li>
<li><a href="../347458/index.html">Frequent difficulties in working with React.js</a></li>
<li><a href="../347460/index.html">Google Pay Integration</a></li>
<li><a href="../347464/index.html">How to return the domain, which forgot to renew</a></li>
<li><a href="../347466/index.html">How to import accounts from CSV to Zimbra</a></li>
<li><a href="../347468/index.html">5 myths about the leading developers, which makes me sad</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>