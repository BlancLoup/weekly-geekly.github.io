<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introduction to AOP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Programming paradigms 
 In the modern world of IT development, there are quite a lot of different approaches to writing programs. For example, someone...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introduction to AOP</h1><div class="post__text post__text-html js-mediator-article"><h2>  Programming paradigms </h2><br>  In the modern world of IT development, there are quite a lot of different approaches to writing programs.  For example, someone likes to present a program as a sequence of actions, and someone thinks that a program should be a multitude of objects that communicate with each other.  The combination of these ideas and concepts form a kind of writing program, which is commonly called <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B0%25D1%2580%25D0%25B0%25D0%25B4%25D0%25B8%25D0%25B3%25D0%25BC%25D0%25B0_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F">the programming paradigm</a> . <br><br>  Each paradigm has its own characteristics, however, the main factor distinguishing them is the concept of the basic unit of the program.  Here are the most popular ones: <br><ul><li>  instruction (imperative programming, FORTRAN / C / PHP), </li><li>  function (functional programming, Haskell / Lisp / F # / Scala), </li><li>  prototype (prototype programming, javascript), </li><li>  object (object-oriented programming, C ++ / Java), </li><li>  fact (logic programming, PROLOG). </li></ul><br>  It is worth noting that in the general case, the programming language definitely does not define the paradigm: you can write both imperative and object-oriented programs in the same PHP. <br><br>  In this article I want to talk about a relatively young, but extremely, in my opinion, useful programming paradigm - <a href="http://en.wikipedia.org/wiki/Aspect-oriented_programming">aspect-oriented programming</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h2>  Basics of AOP </h2><br>  Consider some spherical service in vacuum (for example, a web service) that implements the following method: <br><blockquote><code><font color="black"><font color="#0000ff">public</font> BookDTO getBook(Integer bookId) { <br> BookDTO book = bookDAO.readBook(bookId); <br> <font color="#0000ff">return</font> book; <br> }</font></code> </blockquote> <br>  The method is quite simple and obvious: reading information about a book by its identifier.  But let's think about what's missing here?  First of all, we should think about logging - without it, as you understand, the web-service is nowhere: <br><blockquote> <code><font color="black"><font color="#0000ff">public</font> BookDTO getBook(Integer bookId) { <br> <b>LOG.debug( <font color="#A31515">"Call method getBook with id "</font> + bookId);</b> <br> <br> BookDTO book = bookDAO.readBook(bookId); <br> <br> <b>LOG.debug( <font color="#A31515">"Book info is: "</font> + book.toString());</b> <br> <font color="#0000ff">return</font> book; <br> }</font></code> </blockquote> <br>  Next, you need to implement exception handling (so that the services layer returns the corresponding exceptions, hiding the exceptions of the underlying layers): <br><blockquote> <code><font color="black"><font color="#0000ff">public</font> BookDTO getBook(Integer bookId) <b>throws ServiceException</b> { <br> LOG.debug( <font color="#A31515">"Call method getBook with id "</font> + bookId); <br> BookDTO book = <font color="#0000ff">null</font> ; <br> <br> <b>try {</b> <br> book = bookDAO.readBook(bookId); <br> <b>} catch(SQLException e) { <br> throw new ServiceException(e); <br> }</b> <br> <br> LOG.debug( <font color="#A31515">"Book info is: "</font> + book.toString()); <br> <font color="#0000ff">return</font> book; <br> }</font></code> </blockquote> <br>  Also, do not forget about checking access rights: <br><blockquote> <code><font color="black"><font color="#0000ff">public</font> BookDTO getBook(Integer bookId) throws ServiceException, <b>AuthException</b> { <br> <b>if (!SecurityContext.getUser().hasRight("GetBook")) <br> throw new AuthException("Permission Denied");</b> <br> <br> LOG.debug( <font color="#A31515">"Call method getBook with id "</font> + bookId); <br> BookDTO book = <font color="#0000ff">null</font> ; <br> <br> <font color="#0000ff">try</font> { <br> book = bookDAO.readBook(bookId); <br> } <font color="#0000ff">catch</font> (SQLException e) { <br> <font color="#0000ff">throw</font> <font color="#0000ff">new</font> ServiceException(e); <br> } <br> <br> LOG.debug( <font color="#A31515">"Book info is: "</font> + book.toString()); <br> <font color="#0000ff">return</font> book; <br> }</font></code> </blockquote> <br>  In addition, it makes sense to cache the result of the work: <br><blockquote> <code><font color="black"><font color="#0000ff">public</font> BookDTO getBook(Integer bookId) throws ServiceException, AuthException { <br> <font color="#0000ff">if</font> (!SecurityContext.getUser().hasRight( <font color="#A31515">"GetBook"</font> )) <br> <font color="#0000ff">throw</font> <font color="#0000ff">new</font> AuthException( <font color="#A31515">"Permission Denied"</font> ); <br> <br> LOG.debug( <font color="#A31515">"Call method getBook with id "</font> + bookId); <br> BookDTO book = <font color="#0000ff">null</font> ; <br> <b>String cacheKey = "getBook:" + bookId;</b> <br> <br> <font color="#0000ff">try</font> { <br> <b>if (cache.contains(cacheKey)) { <br> book = (BookDTO) cache.get(cacheKey); <br> } else {</b> <br> book = bookDAO.readBook(bookId); <br> <b>cache.put(cacheKey, book); <br> }</b> <br> } <font color="#0000ff">catch</font> (SQLException e) { <br> <font color="#0000ff">throw</font> <font color="#0000ff">new</font> ServiceException(e); <br> } <br> <br> LOG.debug( <font color="#A31515">"Book info is: "</font> + book.toString()); <br> <font color="#0000ff">return</font> book; <br> }</font></code> </blockquote> <br>  You can continue to improve this method, but enough for a start.  In the course of our refinements, we obtained a method 10 times (from 2 to 20 LOC) exceeding the original size.  The most interesting thing is that the volume of business logic in it has not changed - it's all the same 1 line.  The rest of the code implements some common service functionality of the application: logging, error handling, access control, caching, and so on. <br><br>  In principle, the intertwining of business logic with official functionality is not as bad as your application is small.  However, the more complex the program becomes, the more carefully it should be approached to its architecture in general and the allocation of general functionality in particular.  That is why, watching the evolution of programming languages, we first see the emergence of functions, then modules, then objects.  However, practice shows that to distinguish some common functionality, the paradigms mentioned above are not enough.  This functionality is called ‚Äúend-to-end‚Äù or ‚Äúscattered‚Äù, since its implementation is really scattered across different parts of the application.  Examples of end-to-end functionality, as we have seen above, can be: <br><ul><li>  logging </li><li>  transaction processing </li><li>  error processing, </li><li>  authorization and verification of rights, </li><li>  caching </li><li>  elements of <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D0%25BD%25D1%2582%25D1%2580%25D0%25B0%25D0%25BA%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">contract programming</a> . </li></ul><br>  <b>The main task of aspect-oriented programming (AOP) is the modularization of end-to-end functionality, highlighting it into aspects</b> .  To do this, languages ‚Äã‚Äãthat support the concept of AOP, implement the following tools to highlight end-to-end functionality: <br><ul><li>  aspect is a module or class that implements end-to-end functionality.  The aspect changes the behavior of the rest of the code by applying the tip at the connection points defined by a certain slice.  The same aspect can be used to introduce functionality; </li><li>  advice (advice) - additional logic - the code that should be called from the connection point.  Advice can be performed before, after, or instead of the connection point; </li><li>  join point - a point in the executable program (method call, object creation, variable access), where the advice should be applied; </li><li>  cut (pointcut) - a set of connection points.  The slice determines whether a given join point matches a given tip; </li><li>  introduction - a change in the class structure and / or a change in the inheritance hierarchy to add aspect functionality to the foreign code; </li><li>  target (target) - the object to which the tips will be applied; </li><li>  interweaving (weaving) - linking objects with relevant aspects (possibly at the stage of compilation, loading or execution of a program). </li></ul><br><br><h2>  Usage Example (AspectJ) </h2><br>  <a href="http://www.eclipse.org/aspectj/">AspectJ</a> is an aspect-oriented extension / framework for the Java language.  At the moment this is probably the most popular and developing AOP engine. <br><br>  Consider the implementation of the aspect of logging with it: <br><blockquote> <code><font color="black">@Aspect <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WebServiceLogger { <br> <font color="#0000ff">private</font> final <font color="#0000ff">static</font> Logger LOG = <br> Logger.getLogger(WebServiceLogger. <font color="#0000ff">class</font> ); <br> <br> @Pointcut( <font color="#A31515">"execution(* example.WebService.*(..))"</font> ) <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> webServiceMethod() { } <br> <br> @Pointcut( <font color="#A31515">"@annotation(example.Loggable)"</font> ) <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> loggableMethod() { } <br> <br> @Around( <font color="#A31515">"webServiceMethod() &amp;&amp; loggableMethod()"</font> ) <br> public Object logWebServiceCall(ProceedingJoinPoint thisJoinPoint) { <br> <font color="#2B91AF">String</font> methodName = thisJoinPoint.getSignature().getName(); <br> Object[] methodArgs = thisJoinPoint.getArgs(); <br> <br> LOG.debug( <font color="#A31515">"Call method "</font> + methodName + <font color="#A31515">" with args "</font> + methodArgs); <br> <br> Object result = thisJoinPoint.proceed(); <br> <br> LOG.debug( <font color="#A31515">"Method "</font> + methodName + <font color="#A31515">" returns "</font> + result); <br> <br> <font color="#0000ff">return</font> result; <br> } <br> }</font></code> </blockquote> <br>  First of all, the aspect of service method logging is created - the WebServiceLogger class, marked with the <a href="https://habrahabr.ru/users/aspect/" class="user_link">Aspect</a> annotation.  Next, two slices of the connection points are defined: webServiceMethod (call to a method belonging to the class WebService) and loggableMethod (call to a method marked with the @Loggable annotation).  At the end, a tip is announced (the logWebServiceCall method), which is executed instead of ( <a href="https://habrahabr.ru/users/around/" class="user_link">Around</a> annotation) junction points that satisfy the slice (‚ÄúwebServiceMethod () &amp;&amp; loggableMethod ()‚Äù). <br><br>  The board code retrieves information about the current method (connection point), logs the start of the method execution, directly calls the requested method, logs and returns the result of the work. <br><br>  AspectJ has a fairly large amount of supported slices of connection points.  The following are the main ones: <br><ul><li>  execution (static * com.xyz .. *. * (..)) - execution of the code of any static method in the com.xyz package; </li><li>  call (void MyInterface. * (..)) - a call to any method that returns a void, MyInterface interface; </li><li>  initialization (MyClass || MyOtherClass) - initialization of the class MyClass or MyOtherClass; </li><li>  staticinitialization (MyClass + &amp;&amp;! MyClass) - static initialization of a class whose name begins with MyClass, but not MyClass itself; </li><li>  handler (ArrayOutOfBoundsException) - executing the exception handler ArrayOutOfBoundsException; </li><li>  get / set (static int MyClass.x) - read / write property x of the class MyClass; </li><li>  this / target (MyClass) - execution of a connection point corresponding to an object of type MyClass; </li><li>  args (Integer) - execution of a junction in which an Integer argument is available; </li><li>  if (thisJoinPoint.getKind (). equals ("call")) - matches all connection points where the given expression is true; </li><li>  within / withincode (MyClass) - coincides with all junction points encountered in the code of the specified class; </li><li>  cflow / cflowbelow (call (void MyClass.test ())) - coincides with all connection points encountered in the execution stream of the specified slice; </li><li>  @annotation (MyAnnotation) - the execution of a connection point, the purpose of which is marked with the annotation @MyAnnotation. </li></ul><br>  As for the tips, their number is much smaller, but they fully cover all the necessary set of situations: <br><ul><li>  before - launching the board before executing the junction, </li><li>  after returning - starting the board after the normal execution of the connection point, </li><li>  after throwing - starting the board after throwing an exception during the execution of the junction, </li><li>  after - launching the board after any variant of the junction, </li><li>  around - starting the board instead of executing the junction point (executing the junction point can be called inside the council) </li></ul><br>  More information about AspectJ constructions can be found in the corresponding section [ <a href="http://www.eclipse.org/aspectj/doc/released/progguide/semantics-pointcuts.html">1</a> , <a href="http://www.eclipse.org/aspectj/doc/released/progguide/quick.html">2</a> ] of <a href="http://www.eclipse.org/aspectj/doc/released/progguide/">official documentation</a> . <br><br>  In order to use aspects of AspectJ, they will have to be compiled and ‚Äú <a href="http://www.eclipse.org/aspectj/doc/released/devguide/ltw.html">stitched</a> ‚Äù into the main classes using a special <a href="http://www.eclipse.org/aspectj/doc/released/devguide/ajc-ref.html">AJC</a> compiler. <br><br>  The product is free.  Distributed under Eclipse License. <br><br><br><br><h2>  Usage Example (PostSharp) </h2><br>  <a href="http://www.sharpcrafters.com/postsharp">PostSharp</a> is an aspect-oriented framework for the .NET platform.  There are other AOP implementations for .NET, however, judging by <a href="http://www.sharpcrafters.com/postsharp/alternatives">comparisons</a> from the PostSharp site, it is he who takes the lead. <br><br>  Consider how to use it to describe the aspect of exception handling.  The first step is to create a class that extends the corresponding aspect: <br><br><blockquote> <code><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ExceptionDialogAttribute : OnExceptionAspect <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnException(MethodExecutionEventArgs eventArgs) <br> { <br> <font color="#0000ff">string</font> message = eventArgs.Exception.Message; <br> Window window = Window.GetWindow((DependencyObject)eventArgs.Instance); <br> MessageBox.Show(window, message, <font color="#A31515">"Exception"</font> ); <br> eventArgs.FlowBehavior = FlowBehavior.Continue; <br> } <br> }</font></code> </blockquote> <br><br>  Strictly speaking, aspects in PostSharp terminology are, as we can see, aspect and advice in AOP terminology. <br><br>  In order to specify the cut of intersection points for this aspect, the following line should be added to the assembly settings file (AssemblyInfo.cs): <br><br><blockquote> <code><font color="black">[assembly: ExceptionDialog ( AttributeTargetTypes= <font color="#A31515">"Example.WorkflowService.*"</font> , <br> AttributeTargetMemberAttributes = AttributeTargetElements.Public )]</font></code> </blockquote> <br><br>  Or explicitly mark the methods you are interested in with the ExceptionDialog attribute: <br><br><blockquote> <code><font color="black">[ExceptionDialog] <br> <font color="#0000ff">public</font> BookDTO GetBook(Integer bookId)</font></code> </blockquote> <br><br>  That's all: now all exceptions thrown in the corresponding methods will be handled by the created aspect. <br><br>  In view of the fact that PostSharp partially glues the concepts of advice and aspect, the latter it turns out quite a lot.  Details can be found in the <a href="http://doc.sharpcrafters.com/postsharp/2.0/">documentation</a> .  The following are the main ones: <br><ul><li>  OnMethodBoundary / OnMethodInvocation - a call to the method (start, end, exit, exit with an exception); </li><li>  OnFieldAccess - access to the property; </li><li>  OnException - exception handling; </li><li>  Composition - code injection; </li></ul><br>  PostSharp requires a compiler and a library to be connected to the project.  Aspect insertion is based on post-processing of bytecode during application assembly. <br><br>  Product paid.  There is a Community Edition. <br><br><br><br><h2>  From theory to practice </h2><br>  And so, we have just seen how beautifully and effectively it is possible to solve the problem of ‚Äúputting out‚Äù the end-to-end functionality in your application.  However, this is all theory.  In practice, everything, of course, is a little different :) <br><br>  First of all, in both cases, for compiling and ‚Äúweaving‚Äù aspects, you will have to use a special compiler and drag along with the project additional libraries.  It seems that this is not a problem: the compiler is easy to download and integrates into the environment (for example, using maven, the task will be reduced only to adding the aspectj-maven-plugin plug-in), and many dependencies are common, at least for Java applications (solved by the same maven'a).  However, the need to include in the project something that requires a separate compilation, but still does not have wide distribution, often scares off developers, despite all the potential advantages. <br><br>  In this case, the Spring Framework [ <a href="http://www.springsource.org/about">1</a> , <a href="http://www.springframework.net/">2</a> ] can be a solution.  This framework has many advantages, however, within the framework of this article, we are interested in its AOP component.  The Spring Framework implements limited <a href="http://static.springsource.org/spring/docs/3.1.0.M1/spring-framework-reference/html/aop.html">AOP functionality</a> on pure Java (C #) without using third-party libraries by creating proxy objects (JDK Dynamic Proxy, CGLIB).  In other words, in Spring AOP, you can use only ‚Äúexecute method‚Äù junction points.  However, as practice shows, this restriction does not play a significant role, since for solving most problems, it is necessary to connect points of this type. <br><br>  In addition, the Spring Framework supports application configuration using @AspectJ annotations, as well as integrating aspects compiled directly with AspectJ. <br><br>  We use Spring AOP in our company.  Considering the other merits of the Spring Framework, in my opinion, it is the most accessible and convenient platform for working with AOP, making a significant contribution to its popularization and development. <br><br><br><br><h2>  Summary </h2><br>  Summing up, I would like to highlight three main thoughts regarding AOP: <br><ul><li>  The main goal of AOP is to remove the ‚Äúcommon‚Äù (through) functionality ‚Äúbeyond the brackets‚Äù (modularization of the through functionality); </li><li>  For Java, AOP is available through the AspectJ project, for .NET through PostSharp; </li><li>  The most simple and proven implementation of AOP - Spring AOP. </li></ul><br><br><h2>  Related Links </h2><br><ul><li>  <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B0%25D1%2580%25D0%25B0%25D0%25B4%25D0%25B8%25D0%25B3%25D0%25BC%25D0%25B0_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F">Wikipedia: Programming Paradigm</a> </li><li>  <a href="http://ru.wikipedia.org/wiki/%25D0%2590%25D1%2581%25D0%25BF%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BD%25D0%25BE-%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">Wikipedia: Aspect-Oriented_Programming</a> </li><li>  <a href="http://www.eclipse.org/aspectj/">AspectJ site</a> </li><li>  <a href="http://www.sharpcrafters.com/postsharp">PostSharp website</a> </li><li>  <a href="http://static.springsource.org/spring/docs/current/reference/aop.html">Spring AOP Documentation</a> </li><li>  <a href="https://www.ibm.com/developerworks/ru/library/j-aopwork15/">AOP @ Work: Myths and Reality of AOP</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/114649/">https://habr.com/ru/post/114649/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../114644/index.html">Project Locker: the removal of data from social networks</a></li>
<li><a href="../114645/index.html">Root or not Root, that is the question</a></li>
<li><a href="../114646/index.html">A bit about private vlan</a></li>
<li><a href="../114647/index.html">Sound proof</a></li>
<li><a href="../114648/index.html">Choosing the name of the police</a></li>
<li><a href="../114654/index.html">How we began to live better with Google Apps</a></li>
<li><a href="../114655/index.html">Release Flare 0.11</a></li>
<li><a href="../114656/index.html">G'MIC for GIMP - an excellent set of presets and effects, got my PPA</a></li>
<li><a href="../114659/index.html">Opera, WebGL and hardware acceleration</a></li>
<li><a href="../114660/index.html">The developers presented a computer system with a volume of 1 cubic millimeter.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>