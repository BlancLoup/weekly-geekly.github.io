<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>LAN between houses using WiFI bridge</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is a need to make a local network between two nodes, remote from each other at a distance of 1.15 km. Since there is an experience of helping a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>LAN between houses using WiFI bridge</h1><div class="post__text post__text-html js-mediator-article">  There is a need to make a local network between two nodes, remote from each other at a distance of 1.15 km.  Since there is an experience of helping a friend and connecting his private house to the FTTB network of a nearby high-rise building through Mikrotik production routers, it was decided to implement them and connect.  The choice fell on RouterBOARD SXT Lite5 (please do not take it for advertising, but this is the best choice for this price). <br><br>  Characteristics and installation process, incl.  Video can be found on the site Mikrotik or dealers in Russia.  So far, the test bench has been assembled.  Stand parameters are the distance between points 1.15 km on Yandex maps.  One point is installed on the balcony of the 8th floor, the second in the apartment, also located on the 8th floor, is mounted on tripods for photo equipment. <br><a name="habracut"></a><br>  Wiring diagram <br><img src="https://habrastorage.org/files/311/b40/6c5/311b406c5b4d42d8a170491e925b6522.jpg"><br>  Explanation: <br>  10.1.1.0/30- addresses for eoip tunnels <br>  192.168.7.0/30- address to manage <br>  192.168.88.0/24- addresses from the side of the Bridge router <br>  192.168.78.0/24- addresses from the Station router <br>  192.168.3.1/32- loopback interface <br>  192.168.4.1/32- loopback interface <br><br>  Information about the router (I was in the old building): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">[admin@MikroTik] /system&gt; resource <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> uptime: 56m36s version: 6.18 build-time: Aug/01/2014 10:47:47 free-memory: 44.7MiB total-memory: 64.0MiB cpu: MIPS 24Kc V7.4 cpu-count: 1 cpu-frequency: 400MHz cpu-load: 1% free-hdd-space: 49.0MiB total-hdd-space: 64.0MiB write-sect-since-reboot: 409 write-sect-total: 123255 bad-blocks: 0% architecture-name: mipsbe board-name: RB711GA-5HnD platform: MikroTik</code> </pre> <br><br>  Firmware version: <br><pre> <code class="bash hljs">[admin@MikroTik] /system&gt; routerboard <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> routerboard: yes model: 711GA-5HnD serial-number: 38EB02618CAA current-firmware: 3.07 upgrade-firmware: 3.17</code> </pre><br><br>  Information about the distance (Rostov): <br><br><img src="https://habrastorage.org/files/698/31a/a37/69831aa37013490da3998c9c46df9ea5.jpg"><br><br>  This is how it looks from the camera lens: <br><br>  Frame 18 mm: <br><br><img src="https://habrastorage.org/files/440/72d/6d3/44072d6d3b3f4e229c81fb53bcd516b6.jpg"><br><br>  300mm frame: <br><br><img src="https://habrastorage.org/files/82c/a1d/707/82ca1d70709c4fa0ba6155dfef07dd1b.jpg"><br><br>  On this frame you can see the point on the second end: <br><br><img src="https://habrastorage.org/files/14c/39a/088/14c39a08897b46bc8f343f8d77986517.jpg"><br><br>  Well, the design of a close-up: <br><br><img src="https://habrastorage.org/files/bf7/61a/b89/bf761ab89bec46f194a2cb54c261f318.jpg"><br><br>  Configuring a router operating in the access point mode. <br><br>  1. It is necessary to configure the security of the point itself, there are quite a lot of manuals on the Internet.  On the bench glands, I missed this step. <br><br>  2. Creating bridge interfaces (here and in the future I try to give names with the same designation, like vlan30, bridge30 and eoip30): <br><br><pre> <code class="bash hljs">/interface bridge add name=bridge1 <span class="hljs-comment"><span class="hljs-comment">#  EoIP  add name=bridge30 #   add name=loopback1 #Loopback interface</span></span></code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Setup for winbox</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/3a6/d60/ba6/3a6d60ba6e1c45bbbeb223c4b98fce99.jpg"><br><br>  Click the Interface tab (1), then the "+" symbol (2) and Bridge (3). <br><br>  An example of adding Bridge30 (hereinafter I try to give numbers in an orderly manner Bridge30 corresponds to Vlan 30 and EoIP Tunnel 30): <br><br><img src="https://habrastorage.org/files/d5b/b9f/829/d5bb9f8295ab4c40b5cad261a9e55c11.jpg"></div></div><br><br>  3. Completed EoIP tunnels.  The tunnel ID must match on both routers. <br><pre> <code class="bash hljs">/interface eoip add clamp-tcp-mss=yes <span class="hljs-built_in"><span class="hljs-built_in">local</span></span>-address=10.1.1.1 mac-address=02:03:58:45:B9:21 mtu=\ 1500 name=eoip-tunnel1 remote-address=10.1.1.2 tunnel-id=1 add clamp-tcp-mss=yes <span class="hljs-built_in"><span class="hljs-built_in">local</span></span>-address=10.1.1.1 mac-address=02:3B:CD:AA:46:A2 mtu=\ 1500 name=eoip-tunnel30 remote-address=10.1.1.2 tunnel-id=30</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Setup for winbox</b> <div class="spoiler_text">  Creating tunnels is similar to creating bridges: <br><br><img src="https://habrastorage.org/files/541/1b1/0b1/5411b10b1d0e4895a4d2c44ea690cc1a.jpg"><br><br>  Tuning the eoip tunnel: <br><br><img src="https://habrastorage.org/files/ba7/257/295/ba7257295a4f4761959830a35476c583.jpg"></div></div><br><br>  4. Creating a VLAN.  You must add a VLAN to the WLAN interface. <br><pre> <code class="bash hljs">/interface vlan add interface=wlan1 name=vlan1 vlan-id=1 add interface=wlan1 name=vlan30 vlan-id=30</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Setup for winbox</b> <div class="spoiler_text">  It's simple: <br><br><img src="https://habrastorage.org/files/343/fe4/aa4/343fe4aa4110434b958f02f02988deb1.jpg"><br><br>  Configuring the VLAN itself: <br><br><img src="https://habrastorage.org/files/b54/c3c/634/b54c3c634a0b4a2f87e1c31c7360a217.jpg"><br><br>  After these operations will be the following result: <br><br><img src="https://habrastorage.org/files/6f6/14f/861/6f614f861c1c4e00bf9979d242ae3744.jpg"></div></div><br><br>  5. Combining bridge, eoip and vlan. <br>  Bridge1 combine with ether1, eoip1 <br>  Bridge30 combine with vlan30 <br><pre> <code class="bash hljs">/interface bridge port add bridge=bridge1 interface=ether1 add bridge=bridge1 interface=eoip-tunnel1 add bridge=bridge30 interface=vlan30</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Setup for winbox</b> <div class="spoiler_text">  Go to the Bridge menu (left) and then to the Ports tab <br><img src="https://habrastorage.org/files/a28/7f9/129/a287f912963a4eb2beefcc01ab1486c6.jpg"><br>  Click "+" and add ports to the appropriate bridge. <br><img src="https://habrastorage.org/files/bd2/c00/c47/bd2c00c47a324ad1b4b99c190db57a61.jpg"></div></div><br><br>  6. Assigning IP addresses. <br><pre> <code class="bash hljs">/ip address add address=192.168.88.1/24 comment=<span class="hljs-string"><span class="hljs-string">"default configuration"</span></span> interface=ether1 \ network=192.168.88.0 add address=10.1.1.1/30 interface=wlan1 network=10.1.1.0 add address=192.168.3.1/32 interface=loopback1 network=192.168.2.1 add address=192.168.7.1/30 interface=vlan30 network=192.168.7.0</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Setup for winbox</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/94b/977/2ac/94b9772ac9b44c41a86cf7c96bf2ff7b.jpg"><br><br>  Add the addresses according to the plan: <br><br><img src="https://habrastorage.org/files/449/dce/832/449dce832b104518b9a5fb939041a73c.jpg"></div></div><br><br>  7. Adding routes.  I did routes through the address, not the interface. <br><pre> <code class="bash hljs">/ip route add distance=1 dst-address=192.168.4.0/24 gateway=10.1.1.2 add distance=1 dst-address=192.168.78.0/24 gateway=10.1.1.2</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Setup for winbox</b> <div class="spoiler_text">  Adding does not cause difficulties.  Menu selection: <br><br><img src="https://habrastorage.org/files/969/112/001/9691120017ba4237b556b3f6119cd8f9.jpg"><br><br>  Result: <br><br><img src="https://habrastorage.org/files/c71/0fe/6e5/c710fe6e5af0446baaeb7e640704a636.jpg"></div></div><br><br>  8. Configure the WLAN interface. <br><pre> <code class="bash hljs">/interface wireless <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> [ find default-name=wlan1 ] band=5ghz<span class="hljs-_"><span class="hljs-_">-a</span></span>/n disabled=no frequency=5300 \ ht-rxchains=0,1 ht-txchains=0,1 l2mtu=2290 mode=ap-bridge radio-name=AP1 \ ssid=<span class="hljs-built_in"><span class="hljs-built_in">local</span></span> <span class="hljs-comment"><span class="hljs-comment"># -   ,     ap-bridge,  - station</span></span></code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Setup for winbox</b> <div class="spoiler_text">  You must select the Wireless menu, it is on the left and then select the wlan1 interface: <br><br><img src="https://habrastorage.org/files/42e/9b9/94d/42e9b994d5e24acab520d01c070e8bfe.jpg"><br><br>  Change Mode to ap-bridge.  Press the Advanced Mode button (on the screen it has changed to Simple Mode) and change the Radioname: <br><br><img src="https://habrastorage.org/files/89f/bdd/e82/89fbdde82bc246b5b3ed3dcdd3603bef.jpg"></div></div><br><br>  9. Security configuration. <br><pre> <code class="bash hljs">/interface wireless security-profiles <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> [ find default=yes ] authentication-types=wpa2-psk eap-methods=<span class="hljs-string"><span class="hljs-string">""</span></span> mode=\ dynamic-keys wpa2-pre-shared-key=password</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Setup for winbox</b> <div class="spoiler_text">  You need to return to the Wireless tab and select the Security Profile tab, I edited the default profile. <br><br><img src="https://habrastorage.org/files/0c7/92c/afb/0c792cafb28847fd8d685e44d46bb55f.jpg"><br><br>  Profile Setup Menu: <br><br><img src="https://habrastorage.org/files/365/0c8/b13/3650c8b136de4544a6d760604471b890.jpg"></div></div><br><br>  That's all.  On the second router, everything is configured in the same way, changing only the addresses and the mode of operation of the point.  At stage 8, select in Mode - Station: <br><br><img src="https://habrastorage.org/files/f41/e12/77c/f41e1277cc38412ba00e14e5da860be3.jpg"><br><br>  As a result, the second router will appear in the Registration tab of the Wireless menu, it is denoted by Radio Name AP2: <br><br><img src="https://habrastorage.org/files/c70/82a/1ba/c7082a1badeb479e9a601582a4385ff9.jpg"><br><br>  Test file transfer. <br>  Ping went: <br><br><img src="https://habrastorage.org/files/a50/54a/e2c/a5054ae2ceb54464a75ade5e183db768.jpg"><br><br>  To transfer the image of Centos: <br><br><img src="https://habrastorage.org/files/c2e/c23/5bb/c2ec235bb8fe44f18a578b07e02117fe.jpg"><br><br><img src="https://habrastorage.org/files/85b/105/a8f/85b105a8fce74d13ba489df00b59ea76.jpg"><br><br>  Interface indicators show transfer rates: <br><br><img src="https://habrastorage.org/files/d3a/5a7/fc7/d3a5a7fc73504662abde576c341f4431.jpg"><br><br>  Signal information: <br><br><img src="https://habrastorage.org/files/63b/a69/9bf/63ba699bfebb4810ab7f1ce6df3b3c28.jpg"><br><br>  Transmission Time: <br><br><img src="https://habrastorage.org/files/a43/7e0/66b/a437e066bbbd4de89db04739fd54a928.jpg"><br><br>  Well, the neighbors: <br><br><img src="https://habrastorage.org/files/2dc/a4d/2e3/2dca4d2e3c554f1b9a241f3175d63ef5.jpg"></div><p>Source: <a href="https://habr.com/ru/post/234469/">https://habr.com/ru/post/234469/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234459/index.html">Overview of the most interesting materials on data analysis and machine learning ‚Ññ10 (August 18 - 25, 2014)</a></li>
<li><a href="../234461/index.html">CA7CH: the world's smallest wireless stream camera</a></li>
<li><a href="../234463/index.html">FAQ about the design, construction and launch of power centers in Russia</a></li>
<li><a href="../234465/index.html">Technological singularity as an event inevitable</a></li>
<li><a href="../234467/index.html">Cuckoo - proprietary automated malware analysis lab</a></li>
<li><a href="../234471/index.html">Review WD My Cloud 2 Tb. NAS or cloud? Or maybe together?</a></li>
<li><a href="../234477/index.html">ATtiny13 firmware and programming with Arduino UPD 03/17/2016</a></li>
<li><a href="../234481/index.html">Setting up PostgreSQL monitoring in Zabbix</a></li>
<li><a href="../234483/index.html">TestLink - pain and tears tester or a panacea? Implementation experience</a></li>
<li><a href="../234487/index.html">About viruses for palm trees, ecosystems and continuity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>