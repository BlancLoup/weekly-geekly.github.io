<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>93-byte Snake Game</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="History of creation 
 "Snake" (Python, Boa) as it is called by the people is one of the first games of the digital (computer) mid-1970s. 

 At that ti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>93-byte Snake Game</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/eu/a6/az/eua6azciooxwzlooiu0cnzj617w.png" alt="image"></div><br><h2>  History of creation </h2><br>  "Snake" (Python, Boa) as it is called by the people is one of the first games of the digital (computer) mid-1970s. <br><br>  At that time, games were released on a separate gaming machine, for example, such games as ‚ÄúSpace Invaders‚Äù, ‚ÄúPac-Man‚Äù, ‚ÄúArkanoid‚Äù and others are known.  Usually, only one game was preinstalled on the arcade machines of that time, and the machine itself was styled as this game. <br><br>  "Snake" has a simple gameplay in which the player controls the moving line, depicting a snake.  The player can change the direction of movement of the snake "turning" by 90 degrees.  The goal of the game is to ‚Äúhit‚Äù a snake on the dots depicting rabbits.  Each rabbit eaten increases the length of the snake.  The difficulty lies in the fact that the snake can not cross itself. <br><a name="habracut"></a><br>  Since its introduction, "Snake" has experienced many incarnations on different devices.  For example, on some devices, instead of the line, the snake could appear as a string of characters due to technical limitations.  In other, more modern computers, the snake could turn at an arbitrary angle, and not just 90 degrees. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In other words, such a simple game and its idea was transferred to almost all possible computing equipment.  Including programmable microcalculators, and microcontrollers that control refrigerators and other household appliances. <br><br>  The idea of ‚Äã‚Äã"Snake" is popular and now - the recent "boom" fell on the reincarnation in the form of a multiplayer online game "slither.io". <br><br>  As an enthusiast of programming, I have met a lot of programming literature, where one of the training programs was the game Snake.  Also in the periodicals came across articles of a competitive nature, in which people offered their versions of "Snake", trying to meet the certain technical limitations of a particular computer. <br><br>  I, in turn, also practiced writing this game in different languages ‚Äã‚Äãand platforms.  One day, while reading the e-zine on the ZX-Spectrum, I came across an article whose author met the 256 bytes by programming the Snake.  At the end of the article, the author stated that it is unlikely that anyone will be able to write a game shorter than 256 bytes on the ZX-Spectrum platform.  But after a while there was a version of 121 bytes from another author.  True, while reducing the size of the code, the gameplay suffered. <br><br>  After some time, talking with one novice programmer, I advised him to write at least some finished project.  Then we are talking about the "Snake".  I remembered that this could be of a competitive nature and decided to stir up the interest of my interlocutor by telling him that I would write my implementation of the game with an emphasis on the minimum code size.  To complicate the problem, I decided to use the same ZX-Spectrum platform and Z80 processor assembler. <br><br>  I wrote the first version of the game in a couple of hours and it weighed a little more than 150 bytes.  Then I remembered an article in an electronic journal, and decided to break the record of 121 bytes.  So my next version already weighed 100 bytes.  Writing took 6 hours already.  After that, I did not return to this game for a long time. <br><br>  Later, when sorting out the folder with my projects and sources, I came across the source code of my Snake and realized that the code could be modified and shortened by a couple of bytes.  The optimization process took a whole day, and the code was reduced by only 5 bytes.  Nevertheless, the code of the game began to "weigh" a record 93 bytes. <br><br><h2>  Technical details </h2><br>  Technical details of the game 93-byte snake <br><br><ul><li>  58 lines of code without comment </li><li>  Full program relocability (placement to any address without recompilation) </li><li>  Unused stack </li><li>  Only the main set of registers is used: a, b, c, d, e, h, l and r as a generator of randomness </li><li>  Without the use of ROM procedures </li><li>  Fair screen and border initialization </li><li>  Classic key management: 6,7,8,9 (Sinclair Joystick) </li><li>  Each initialization of rabbits pseudo-randomly arranged </li></ul><br>  The code consists of 3 blocks <br><br><ul><li>  Initializing Variables and Screen </li><li>  Poll keys to press and change direction </li><li>  Handling game events </li></ul><br>  Registers are mainly used as named variables, as follows: <br><br><ul><li>  Register a - used by as an intermediate result and a manipulator with separate bits </li><li>  Register pair bc - this direction of movement takes only 4 values ‚Äã‚Äãfor the entire gameplay: # ffe0, # 0020, # 0001, #ffff </li><li>  Register pair de is the current array processing index (attribute) </li><li>  Register pair hl is the current coordinates of the snake head in the address attribute space </li></ul><br>  In the initialization block de and hl, swapped to reduce the logical distribution operation of rabbits <br><br>  The game uses two global cycles, from the beginning of the program to the end (full initialization) and the game cycle (after placing the rabbits) <br><br><h2>  Game code </h2><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ld de,#<span class="hljs-number"><span class="hljs-number">598</span></span>f;snake xy ld hl,#<span class="hljs-number"><span class="hljs-number">5</span></span>aff ld b,l ld c,l ;<span class="hljs-comment"><span class="hljs-comment">--- rabbit1 ld (hl),b ld a,r cp l jr z,rabbit2 inc (hl) rabbit2 dec hl bit 3,h jr nz,rabbit1 ex hl,de ;--- l1 xor a out (#fe),a clr ld (de),a dec de bit 6,d jr nz,clr ;--- ; xor a in a,(#fe) rra rra jr c,$+5 ld bc,#ffe0 rra jr c,$+5 ld bc,#0020 rra jr c,$+5 ld bc,#0001 rra jr c,$+4 ld b,e;ld bc,#ffff ld c,e ;--- ld (hl),33 ld d,#5a move1 ld a,(de) dec a cp 254 jr nc,move2 ld (de),a move2 jr nz,move3 dec (hl) move3 dec de bit 3,d jr nz,move1 ;--- ld a,(hl) and %00100000 add hl,bc or (hl) inc a cp 7 jr nc,begin ld a,h inc a and %00000011 jr z,begin jr l1</span></span></code> </pre> <br><br><h2>  Algorithm </h2><br>  The image on the screen in this case is available in memory as a one-dimensional array of 32 * 24.  Each cell occupies one byte of memory.  By changing the values ‚Äã‚Äãof these cells, you can set the color of each ‚Äúsquare‚Äù on the screen.  The format in bits is% FBPPPIII where: F-Flash ‚Äúflashing‚Äù bit once per second (ink-to-paper exchange), B-Bright high brightness, PPP-Paper 0 to 7, III-INK 0 to 7. <br><br><ul><li>  0 000 Black </li><li>  1 001 Blue </li><li>  2,010 Red </li><li>  3 011 Purple </li><li>  4 100 Green </li><li>  5 101 Blue </li><li>  6 110 Yellow </li><li>  7 111 White </li></ul><br>  Thus, Rabbits are encoded with a value of 255 (blinking, bright, white background, white color), empty space is encoded with a value of zero (black background, black color) <br><br>  Unlike other implementations, the storage of the "snake" is not allocated a separate array in memory, and it is immediately in the "screen" memory.  The length of the snake and the number of ‚Äúeaten rabbits‚Äù is stored in the form of head color, since the larger value looks ‚Äúbrighter‚Äù, simple arithmetic occurs, the entire array goes over and the number of rabbits adds up to the base color of the head.  The movement of the snake‚Äôs entire body occurs by processing the entire array where, each value is simply reduced by one to black. <br><br>  Handling game events is just a few logical branches "IF", when moving the head to the next array index, the previous value is checked, if there is not a rabbit and not empty space, then the snake has run into itself.  Another ‚ÄúIF‚Äù if the snake's head has the maximum color after checking the array, then all the rabbits are eaten. <br><br>  <b>UPD</b> Updated sources, as I was able to optimize from 95 bytes to 93 bytes, without losing functionality. <br>  <b>UPD2</b> Added section Algorithm. </div><p>Source: <a href="https://habr.com/ru/post/353206/">https://habr.com/ru/post/353206/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353196/index.html">Divan Vice President: how I work as a product director on a complete remote</a></li>
<li><a href="../353198/index.html">SelectelTechDay: how it was</a></li>
<li><a href="../353200/index.html">Episode 0. Hack vs Mac. Xcode build time</a></li>
<li><a href="../353202/index.html">Marvin Minsky "The Emotion Machine": Chapter 1 "How we control ourselves"</a></li>
<li><a href="../353204/index.html">About streams and tables in Kafka and Stream Processing, part 1</a></li>
<li><a href="../353208/index.html">Another boxed CMS or a worthy alternative?</a></li>
<li><a href="../353210/index.html">How do users teach Yandex to warn about phone spam</a></li>
<li><a href="../353212/index.html">Dockarize Socket.io, redis and php</a></li>
<li><a href="../353214/index.html">Why in 2018 I use the development method, which is already 30 years old</a></li>
<li><a href="../353216/index.html">Improve performance review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>