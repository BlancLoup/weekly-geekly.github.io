<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cryptolocker 2.0 or fake?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In a previous post on ransomware (ransomware), we pointed to the activation of the FileCoder family, which is used by cybercriminals to encrypt user f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cryptolocker 2.0 or fake?</h1><div class="post__text post__text-html js-mediator-article">  In a previous <a href="http://habrahabr.ru/company/eset/blog/195014/">post</a> on ransomware (ransomware), we pointed to the activation of the FileCoder family, which is used by cybercriminals to encrypt user files with the subsequent demand for ransom for decryption.  Already since July 2013, attackers have redoubled their efforts to spread this type of malware.  In addition, during this period of time, the appearance of a new modification of <a href="http://virusradar.com/en/Win32_Filecoder.BQ/description">Win32 / Filecoder.BQ</a> , which is better known as <a href="http://en.wikipedia.org/wiki/Cryptolocker">Cryptolocker</a> and is the most dangerous variant of the cryptographer, was recorded.  When infecting <a href="http://blog.emsisoft.com/2013/09/10/cryptolocker-a-new-ransomware-variant/">Cryptolocker, the</a> user either loses his data or is forced to pay attackers for decryption. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/65b/a88/ffc/65ba88ffcd6ba1880981f8c213056fc7.jpg"><br><br>  As can be seen in the statistics below, Cryptolocker is most active in the United States.  Obviously, this region is the most attractive for attackers due to the sufficient user consistency.  It is easier for attackers to make a profit this way, because many users are willing to pay the required amount only to regain access to the original files.  Not only Cryptolocker, but also such well-known banking malware tools as Zeus or SpyEye were also focused in their time primarily on the United States because of the most monetization. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><img src="https://habrastorage.org/getpro/habr/post_images/944/c21/61a/944c2161a101f29b30248a2e5a1e70d9.png"><br>  Fig.  Geography of distribution Cryptolocker. <br><br>  Last month, we discovered another Filecoder family that caught our attention because the name Cryptolocker 2.0 was present in the modification code.  This modification was added by our analysts like <b>MSIL / Filecoder.D</b> and <b>MSIL / Filecoder.E</b> . <br><br>  Analysis of the new version shows that both modifications (regular Cryptolocker and Cryptolocker 2.0) work in the same way.  After infecting the system, they search for certain file types (by extension) in the file system, encrypt them, and display a message to the user about the need to pay the ransom for decryption.  Both modifications use the RSA public key algorithm for encryption.  At the same time, there are certain differences between the two families. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/de5/cc2/af5/de5cc2af51679be766f741b163add3ca.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/09a/fa4/281/09afa42817aeb894a913df2231d25441.png"><br><br>  There are three visible differences between these families.  The first version uses RSA-2048, while the new version claims the use of a more robust RSA-4096 (although in fact it uses RSA-1024).  Another difference is that Cryptolocker 2.0 displays the amount of time left before the proposed deletion of the RSA private key (with which you can decrypt the key unique for each AES file, through which you can decrypt the file itself).  In addition, version 2.0 accepts ransom only in <a href="http://ru.wikipedia.org/wiki/%25D0%2591%25D0%25B8%25D1%2582%25D0%25BA%25D0%25BE%25D0%25B9%25D0%25BD">bitcoins</a> , while the first version also accepts MoneyPak and Ukash. <br><br>  There are other differences between these families, which were identified after the analysis of malicious code.  The most obvious is the programming language that the attackers used to develop these modifications.  A regular Cryptolocker is written in C ++, and a new one in C #.  The files and registry keys used by these modifications also differ, and the number of file extensions to be encrypted has also been increased in the new version; now it is also aimed at audio / video files and image files: .mp3, .mp4, .jpg, .png,. avi, .mpg. <br><br>  When the malware is launched on the system, it contacts the C &amp; C server manager and requests the unique RSA public key from there.  Then each file matching the encryption criterion is encrypted using a unique 3DES key, which is then in turn encrypted using an RSA public key that was received from the server.  This encrypted key will be written into the body of the auxiliary file, which will have the same name as the original one, but one more extension ‚Äú.k‚Äù (% filename%.% Fileext% .k) will be added to it. <br><br>  Thus, files can be decrypted if the RSA private key is known, which will help to decrypt the 3DES keys (AES in the case of the first version).  Another difference between the versions is that the first Cryptolocker stores the encrypted key at the end of the encrypted file, and not in a separate file. <br><br><img src="https://habrastorage.org/storage3/4a1/479/37f/4a147937f628cc0fac76a0e9bba64bab.png"><br><br>  In addition to Cryptolocker's main feature - file encryption, it contains additional features, for example, it displays windows on the desktop that mimic ‚Äúactivators‚Äù or shareware hackers software: Microsoft Windows, Office, Team Viewer, Adobe Photoshop or even ESET Smart Security. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/714/7eb/2f6/7147eb2f62818a3793e66ad9727eb214.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1c/708/cc3/d1c708cc3239d50ae8aff47fa528e6a5.png"><br><br>  Cryptolocker chooses which window to display to the user, depending on the name of the executable file from which it was launched.  Once launched, it is installed on the system and then begins to encrypt files.  This method of masking allows you to put down the vigilance of users who resort to the help of various hackers and use similar software to violate the integrity of proprietary programs. <br><br>  We note that Cryptolocker 2.0 has the ability to spread through removable media, overwriting the contents of the executable file on your body.  The new version also features the ability to steal Bitcoin wallets files, launch a legitimate BFGMiner Bitcoin generation application without the user's knowledge, or use the compromised system as a bot to organize DDoS attacks against certain servers. <br><br>  <b>findings</b> <br><br>  Taking into account all the above-mentioned differences between Cryptolocker and Cryptolocker 2.0, we cannot conclude that this is indeed a new version of this malicious program.  The attacker's move from C ++ to C # is a rather unexpected solution, but at the same time, none of the key differences can be considered a significant improvement in the capabilities of the malicious program. <br><br>  The malicious software Cryptolocker 2.0, which shows up as MSIL / Filecoder.D and MSIL / Filecoder.E, is really dangerous and can cause a lot of harm to users who do not back up their data.  In the case of Cryptolocker, backing up data is one of the best defenses against its destructive actions. <br><br>  We also recommend using the seventh version of ESET Smart Security and ESET NOD32 AV products, as they contain the special feature of extended memory scanning.  It helps improve the detection of already known or as yet unknown modifications of malicious programs, including Filecoder. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27e/2c3/000/27e2c30000a2a6ff571141180442ba17.png"></div><p>Source: <a href="https://habr.com/ru/post/207532/">https://habr.com/ru/post/207532/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../207518/index.html">Very small screen from a very old PDA</a></li>
<li><a href="../207524/index.html">Nanex: A nightmare on Elm Street for high-speed trading. Part 1</a></li>
<li><a href="../207526/index.html">Hard Trucker - unfulfilled dream</a></li>
<li><a href="../207528/index.html">Experience in developing a service-oriented system</a></li>
<li><a href="../207530/index.html">In 2014, the microservice segment will grow by 139%</a></li>
<li><a href="../207536/index.html">Stanislavsky for the robot. How to use the possibilities of emotional synthesis</a></li>
<li><a href="../207538/index.html">How Data Mining Company Lives: Tasks and Research</a></li>
<li><a href="../207540/index.html">NASA celebrates the anniversary of one of the most important photographs ever taken by man.</a></li>
<li><a href="../207542/index.html">IT books at a free price</a></li>
<li><a href="../207544/index.html">Crestron vs Savant, or how expensive home automation systems differ from cheap ones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>