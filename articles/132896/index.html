<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Objective-C MVC or Calculator for iOS 5</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 
 Inspired by the fact that in recent times I have stocked i devices, I decided to learn how to program for them. Of course, in my chosen w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Objective-C MVC or Calculator for iOS 5</h1><div class="post__text post__text-html js-mediator-article"><h4>  Prehistory </h4><br>  Inspired by the fact that in recent times I have stocked i devices, I decided to learn how to program for them.  Of course, in my chosen way of a web developer, this will not help much, but I have always been interested in new languages. <br><br>  The first thing that fell my gaze is the iTunesU virtual school.  Here I found the lectures of the CS 193P course conducted by the developers of the epl for students of Stanford University.  Lectures cover the basic features of the language and native frameworks quite well, however, there are one BUT lectures in English and there is no translation to them.  For me personally, it didn‚Äôt cause any problems, because Aple apparently chooses only candidates with a good speech for these lectures, and the 8 months in the US gave me the opportunity to watch original lectures and learn from "native speakers" (just kidding) . <br><br>  Since every year a new version of Xcode comes out, and Stanford's lectures in which the current version is being considered are becoming available late in the semester, I decided to write a series of articles that will cover the practical part (!) Of this course.  Since I listened to lectures from the fall of 2010, it would be practical for me to write a program in xcode 4.2 which was originally developed for the 3rd version.  Here I will not go deep into the features of ObjC, but will give bare practice. <br><a name="habracut"></a><br><h4>  So let's start </h4><br>  For work, I will use Xcode 4.2, iOS SDK 5 and all this will work under Mac OS X 10.7.2 Lion. <br>  As you say from the headline, I (read lecturer) will use the MVC data model.  In general, honestly, I don‚Äôt understand how I can code for iOS differently.  We write a program calculator.  A simple calculator that will add, subtract, multiply, divide and extract the square root of numbers. <br>  The program structure will be as follows: <br>  1. we will have calculator brains that will perform all actions (brain class) - model; <br>  2. we will have a controller that will handle button presses; <br>  3. we will have a View, in which new iOS coders always have problems.  More on this further. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  New project </h4><br>  So let's start by creating a project.  To do this, go File - New - New project.  Among the total set of templates, select "Single View Application".  I will call the application Calc.  It is also worth noting that when creating the project I removed the tick "Use Storyboard".  What it is for: in SDK 5 instead of the former .xib a new format .storyboard appeared.  I don‚Äôt understand how they differ, so I use xib files for IB in the old way (hereinafter Interface Builder). <br><br>  So we have a project.  It already has a controller and view.  To check the performance of the entire system, you can make a trial build.  If everything is ok, then an iPhone emulator will appear on the screen and our application with a gray screen will start. <br><br>  First we need the brains of a calculator (processor) that will perform all the operations.  Press CMD + N and select the Objective-C class and call it CalcBrain a subclass of the NSObject class so that our brains inherit the basic methods.  Now there are two more files in the project: CalcBrain.h and CalcBrain.m <br><br>  Let's go to ViewController.h.  There you will not see anything except the import of the standard UIKit library and the declaration of the controller itself.  Here we will need to declare the following things: <br><br>  - outlets: variables that will be pointed to certain Interface Builder elements; <br>  - actions: proper methods that will be called when certain elements are performed by IB elements. <br>  - we also need to declare the variable of our new class CalcBrain to make this whole thing work. <br><br>  So let's go. <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#import </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;UIKit/UIKit.h&gt; #import "CalcBrain.h" @interface ViewController : UIViewController { IBOutlet UILabel *display; CalcBrain *brain; } -(IBAction)digitPressed:(UIButton *)sender; //++ -(IBAction)operationPressed:(UIButton *)sender; //++ @end</span></span></span></span></code> </pre> <br><br>  Here I will not explain anything, because the code can be intuitively understood (if not - alas, I advise you first to read about OOP and other goodies of the programmer world). <br><br><h4>  Interface building </h4><br>  Now we digress a bit from the code and build the interface.  I think that Sach needs to focus all its attention, because in my experience a lot of novice coders without direct demonstration of actions just collapsed <br>  at this stage and lowered their hands.  Open ViewController.xib and see already existing objects: <br>  Files's Owner is an object pointing to the class to which this xib belongs (in our case, it is a ViewController, which means that we can only use actions and outlets of this controller only); <br>  First Responder; <br>  View is directly the view of our controller itself. <br><br>  First create the buttons.  Let's start with numbers. <br><br><img src="http://pandanet.ru/habr/1.png" alt="image"><br><br>  We create the first digit which in the future will be the seven. <br><br><img src="http://pandanet.ru/habr/2.png" alt="image"><br><br>  In order not to suffer any further, we will immediately tie digitPressed to our action button.  To do this, select our button and in the Connections Inspector take the cup that is opposite the Touch Down event and drag it to the File's Owner object. <br><br><img src="http://pandanet.ru/habr/4.png" alt="image"><br><br>  A window will appear in which you can select an action to which the controller will respond when the button is touched. <br><br><img src="http://pandanet.ru/habr/3.png" alt="image"><br><br>  We will need digitPressed. <br>  All we have left is to breed our "button template" with Alt (options) clamped.  Now you can set our label numbers.  This can be done either through the Attribute inspector or by double clicking on the button.  Also, do not forget that we have one button for separating the whole part from the fractional part (and this is done with the symbol "." And not "," as we do in Russia). <br><br><img src="http://pandanet.ru/habr/5.png" alt="image"><br><br>  In the same way, we will do the operation buttons.  We need addition, subtraction, division, multiplication and square root extraction.  And an equal sign that will display the result of our action.  Everything.  Now we have an input device.  By the output device, ie the display.  It is necessary to create a Label object, make it left justified, set the font to 26 and default text "0".  Nothing complicated. <br><br><img src="http://pandanet.ru/habr/6.png" alt="image"><br><img src="http://pandanet.ru/habr/7.png" alt="image"><br><br><h4>  We continue to code </h4><br>  We will not have more business with interfaces.  Remained clean code. <br>  By the way, if you're interested, you can start the application and see how it will look on the emulator. <br>  Let's start writing our brains.  They will work like this: <br>  1 The object will receive the first operand; <br>  2 The object receives the action; <br>  3 If the action is not square root, we are preparing to receive the next operand; <br>  4 If this is a root or equivalent result. <br><br>  CalcBrain.h text <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#import </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Foundation/Foundation.h&gt; @interface CalcBrain : NSObject { double operand; } -(void)setOperand:(double)aDouble; -(double)performOperation:(NSString *)operation; @end</span></span></span></span></code> </pre><br><br>  With the variable operand I hope there is no need to explain.  The class methods here are all just setOperand is the usual setter for the operand variable.  It would be possible to use @syntesuze but then a getter will be generated which is useless to us.  So we will manage also such crutch.  Now we will describe all our methods. <br><br><pre> <code class="cpp hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)setOperand:(<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)aDouble{ operand = aDouble; } - (<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)performOperation:(NSString *)operation{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([operation isEqual:@<span class="hljs-string"><span class="hljs-string">"sqrt"</span></span>]) { operand = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(operand); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> operand; }</code> </pre><br><br>  A little about the second method.  The second method will process our action (the operation request is actually called this).  For now, we are just processing the square root.  The input to this method will be the text from the operation button.  Now we will struggle with the fact that the brain needs to memorize the first operand and the pressed operation before starting to memorize the second operand. <br><br>  Let's add the class: <br><pre> <code class="cpp hljs">@interface CalcBrain : NSObject { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> operand; NSString *waitingOperation; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> waitingOperand; }</code> </pre> <br><br>  And the description: <br><br><pre> <code class="cpp hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)performOperation:(NSString *)operation{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([operation isEqual:@<span class="hljs-string"><span class="hljs-string">"sqrt"</span></span>]) { operand = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(operand); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { [self performWaitingOperation]; waitingOperation = operation; waitingOperand = operand; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> operand; }</code> </pre> <br><br>  The performWaitingOperation method will directly perform the action itself by the operands in the event that we have an action not on one operand (sqrt). <br><br><pre> <code class="cpp hljs">-(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)performWaitingOperation { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([@<span class="hljs-string"><span class="hljs-string">"+"</span></span> isEqual:waitingOperation]) { operand = waitingOperand + operand; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([@<span class="hljs-string"><span class="hljs-string">"*"</span></span> isEqual:waitingOperation]) { operand = waitingOperand * operand; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([@<span class="hljs-string"><span class="hljs-string">"-"</span></span> isEqual:waitingOperation]) { operand = waitingOperand - operand; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([@<span class="hljs-string"><span class="hljs-string">"/"</span></span> isEqual:waitingOperation]) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operand) { operand = waitingOperand / operand; } } }</code> </pre> <br><br>  Unforgettable to declare this method in CalcBrain.h <br><br><h4>  We program the controller </h4><br>  How proud it sounds.  But to go to our controller and specifically to the header file.  We begin to describe our already declared methods.  By the way, everything that Xcode created in the ViewController.m file can be erased.  Until.  For this application, we will not need them.  All we need is: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#import </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"ViewController.h"</span></span></span><span class="hljs-meta"> @implementation ViewController -(IBAction)digitPressed:(UIButton *)sender { } -(IBAction)operationPressed:(UIButton *)sender { } @end</span></span></code> </pre> <br><br>  Now let's go by the methods.  When you click on the operation, we need to get the text from the button.  This is done simply: the button drops to the method as an object with all the parameters: <br><br><pre> <code class="cpp hljs">-(IBAction)operationPressed:(UIButton *)sender { NSString *operation = [[sender titleLabel] text]; }</code> </pre> <br><br>  Now we need to request our brains to perform this operation.  But first, we need to create these brains.  We have identified the variable for them but have not yet announced: <br><br><pre> <code class="cpp hljs">-(CalcBrain *)brain { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!brain) brain = [[CalcBrain alloc] init]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> brain; }</code> </pre> <br><br>  And we will add a method of clicking on the operation, make a request for support and display the result on the display: <br><br><pre> <code class="cpp hljs">-(IBAction)operationPressed:(UIButton *)sender { NSString *operation = [[sender titleLabel] text]; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> result = [[self brain] performOperation:operation]; [display setText: [NSString stringWithFormat:@<span class="hljs-string"><span class="hljs-string">"%g"</span></span>, result]]; }</code> </pre> <br><br>  Now a logical problem arises- when the user presses "5", "5", then he means "55" and not "5" as our brains understand now.  Ie, we need a Boolean variable that will identify whether the user is in the input process or not. <br><br><pre> <code class="cpp hljs">@interface ViewController : UIViewController { IBOutlet UILabel *display; CalcBrain *brain; BOOL userIsInTheMiddleOfTypingANumber; }</code> </pre><br><br>  Now you can describe the operand declaration when you press the operation key: <br><br><pre> <code class="cpp hljs">-(IBAction)operationPressed:(UIButton *)sender { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (userIsInTheMiddleOfTypingANumber) { [[self brain] setOperand:[[display text] doubleValue]]; userIsInTheMiddleOfTypingANumber = NO; } NSString *operation = [[sender titleLabel] text]; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> result = [[self brain] performOperation:operation]; [display setText: [NSString stringWithFormat:@<span class="hljs-string"><span class="hljs-string">"%g"</span></span>, result]]; }</code> </pre> <br><br>  Now we describe the click on the number: <br><br><pre> <code class="cpp hljs">-(IBAction)digitPressed:(UIButton *)sender { NSString *digit = [[sender titleLabel] text]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (userIsInTheMiddleOfTypingANumber) { [display setText:[[display text] stringByAppendingString:digit]]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { [display setText:digit]; userIsInTheMiddleOfTypingANumber = YES; } }</code> </pre> <br><br>  Here the logic is simple: we get a digit from the label of the sender, if stringByAppendingString is true, then we need to append the entered digit to the display.  If not, just add a number to the display and flip the stringByAppendingString parameter. <br><br>  Now only Build and Run is left. <br><br><img src="http://pandanet.ru/habr/9.png" alt="image"><br><br><h4>  Homework </h4><br>  You can add three functions: <br>  The function ¬± which will turn the cislo from negative to positive; <br>  Result reset function (C); <br>  And the function to repeat the operation (when I did the operation and repeatedly pressed on = the last operation is repeated with the last operand); </div><p>Source: <a href="https://habr.com/ru/post/132896/">https://habr.com/ru/post/132896/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132888/index.html">Malefactors received remote control over water treatment system of one of the US water treatment plants</a></li>
<li><a href="../132890/index.html">Red Hat: Allow the OpenShift cloud to compile your Java applications.</a></li>
<li><a href="../132892/index.html">Electronic cigarette "I like Dark Passion" - what it consists of</a></li>
<li><a href="../132893/index.html">How scary to live: from viruses in QR codes to hacking industrial giants</a></li>
<li><a href="../132894/index.html">Time tracking system according to the method of A. A. Lyubishchev</a></li>
<li><a href="../132897/index.html">Facebook Open Graph in music services</a></li>
<li><a href="../132900/index.html">Nine examples of funny and illiterate advertising letters</a></li>
<li><a href="../132901/index.html">How to make a project presentation (pitch book)</a></li>
<li><a href="../132902/index.html">Setting up Database Mail in MS SQL Server 2005 and later</a></li>
<li><a href="../132903/index.html">Thiographic for Dyslexics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>