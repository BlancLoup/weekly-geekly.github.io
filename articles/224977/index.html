<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Android monster named FunLib</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, my name is Yura. And I, like many of you, are a programmer. As you know, programmers are not just software developers, but creators. But, unfortun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Android monster named FunLib</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://github.com/senneco/FunLib"><img src="https://habrastorage.org/getpro/habr/post_images/ffa/54e/0b8/ffa54e0b8d3c6bf535da84516987b7af.png" align="left"></a>  Hi, my name is Yura.  And I, like many of you, are a programmer.  As you know, programmers are not just software developers, but creators.  But, unfortunately, in everyday work it is difficult to create something new (especially when you are busy with mobile development).  And it often gives rise to the desire to collect your Frankenstein (well, or a bicycle, if you so desire), at least in your free time.  For example, I always wanted to make my Frankenstein, who would do the main routine work for me in an Android application. <br><br>  And now I have recently, finally, found some free time for this business ( <i>note by the author: here you can just be happy for me</i> )!  After reading various articles about what is now fashionable, or it became fashionable many years ago, I collected for myself an exemplary list of what my friend will consist of.  And this is what he <i>has</i> learned from me: <br><br><ul><li>  Walk!  He goes to the Internet, gets data from there, and brings to him </li><li>  Remember!  If necessary, he will remember what he took on the Internet, maybe even process this data first. </li><li>  And in general - to perform several tasks at the same time!  Moreover, do not bother about the fact that suddenly our monster decides, for example, to dig </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How many different elements I had to lump together so that my monster, named <a href="https://github.com/senneco/FunLib">FunLib,</a> came to life!  Here such stars as retrofit, eventbus, jobqueue gathered ... But let's be in order!  So, who is responsible for what in my brainchild: <br><a name="habracut"></a><br><h2>  Going <sub>to the Internet</sub> </h2><br>  We go to the Internet using <a href="http://square.github.io/retrofit/">Retrofit</a> + <a href="http/">OkHttp</a> .  This allows you to do all the work quickly, accurately and with the support of a large community.  Agree, it is very convenient to make a request for service in a similar way: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GithubApi</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"/search/repositories?sort=stars&amp;order=desc"</span></span>) <span class="hljs-function"><span class="hljs-function">SearchResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">search</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Query(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"q"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String query)</span></span>; }</code> </pre> <br><br>  And how cool it turns out, right for the Evangelist!  After all, the development is really not at the level of implementation, but, literally, at the interface level!  In general, a lot of things can be added to the request, customize it in different ways.  But since  this is not the essence of the article, I leave it to your independent study.  Well, or it would be great if someone wrote how he uses these libraries coolly, especially if his moves are not trivial and not covered in <a href="http://square.github.io/retrofit/">off.</a>  <a href="http://square.github.io/retrofit/">guide</a> <br><br><h2>  Memory <sub>in DB</sub> </h2><br>  <a href="http://ormlite.com/">ORMLite</a> is responsible for its <a href="http://ormlite.com/">memory</a> .  As they say, the taste and color of all the markers are different.  I like this solution the most.  Especially, to the advantages of this library, I attribute this: <br><br><ul><li>  From the database, you can get ready-made objects, and not a raw data set (even with data on secondary keys) </li><li>  You can get the cursor by performing an ORM request </li><li>  You can get the cursor by performing the usual sql query, with all the ensuing features </li><li>  This solution will surely be easily understood by <u>anyone</u> who will accompany / read your code in the future. </li></ul><br>  Here, as usual - annotate the necessary classes and fields like <code>@DatabaseTable</code> and <code>@DatabaseField</code> , respectively.  Then we can calmly add, or, if necessary, get the data in the database: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">saveRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Repository&gt; repositories)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException </span></span>{ Dao&lt;User, ?&gt; userDao = getDbHelper().getDao(User.class); Dao&lt;Repository, ?&gt; repositoryDao = getDbHelper().getDao(Repository.class); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Repository repository : repositories) { userDao.createOrUpdate(repository.getOwner()); repositoryDao.createOrUpdate(repository); } }</code> </pre><br><br>  PS: unfortunately, while FunLib is not able to comfortably notify loaders by URI ... Yes, and its activations with fragments do not provide functionality for convenient work with loaders, but everything is in <u>your</u> hands!  Pull-requisitions are waiting for you.  Well, or wait for me to do it: P <br><br><h2>  Brains <sub>for parallel work</sub> </h2><br>  For this important process, a tool called the <a href="https://github.com/path/android-priority-jobqueue">Priority Job Queue</a> was chosen.  Why haven't we made our own service?  Yes, everything is simple - I was interested to use this library =) Yes, and the manifest remains clean.  And, not least, this solution <s>quite</s> acceptably fits neatly into our Central Nervous System (a little below is said about it).  But FunLib and I sat down, thought, and decided that the Job, from which the Path team offers us to inherit, is too monstrous.  It will be hard for me to give my baby some commands.  Well, or he will not be so easy to understand them.  Therefore, there was made a toddler named <code>FunJob</code> , who can just do the work we need in the method <code>public abstract T doJob() throws Throwable</code> . <br><br><div class="spoiler">  <b class="spoiler_title">An example of work.</b>  <b class="spoiler_title">Attention!</b>  <b class="spoiler_title">Monster is dangerous!</b>  <b class="spoiler_title">Look only desperate brave!</b> <div class="spoiler_text"><pre> <code class="hljs scala">public <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchJob</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FunJob&lt;List&lt;Repository&gt;&gt;</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-type"><span class="hljs-type">String</span></span> mQuery; public <span class="hljs-type"><span class="hljs-type">SearchJob</span></span>(int id, <span class="hljs-type"><span class="hljs-type">String</span></span> query) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(id); mQuery = query; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> public <span class="hljs-type"><span class="hljs-type">List</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Repository</span></span>&gt; doJob() <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> <span class="hljs-type"><span class="hljs-type">Throwable</span></span> { <span class="hljs-type"><span class="hljs-type">SearchResult</span></span> searchResult = ((<span class="hljs-type"><span class="hljs-type">GithubApi</span></span>) getApi()).search(mQuery); <span class="hljs-type"><span class="hljs-type">List</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Repository</span></span>&gt; repositories = searchResult.getRepositories(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repositories; } }</code> </pre><br></div></div><br><br><h2>  Central Nervous System <sub>or simply DI</sub> </h2><br>  For such an important task as the delivery of the database, the Internet, and other information to the brain and back to the robot body, a component called <a href="http://square.github.io/dagger/">Dagger</a> , which implements the <a href="http://ru.wikipedia.org/wiki/%25D0%2592%25D0%25BD%25D0%25B5%25D0%25B4%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B7%25D0%25B0%25D0%25B2%25D0%25B8%25D1%2581%25D0%25B8%25D0%25BC%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">Dependency Injector</a> , was used.  Fortunately, our brains can do an injection in Job when Job is ready to be executed!  Therefore, FunJob, when it does its work, can confidently access the database, the API, and generally knows that it is him!  After all, it is so important to associate brains with the body! <br><br>  And to send the command from the brain to the body was used a thing called <a href="https://github.com/greenrobot/EventBus">EvenBus</a> .  Initially I wanted to use <a href="http://square.github.io/otto/">Otto</a> , but, for some unknown reason, FunLib disliked him, and I quickly refused it.  Do not worry - EventBus also copes with its task!  The body always gets the right commands on time! <br><br><h2>  Ready Steady Go! </h2><br>  At this point, I decided to take a halt, complete my story and get a fitback from you.  And after that I will continue to develop my crumbs further. <br><br>  In the <a href="https://github.com/senneco/FunLib/tree/master/FunLibSample/src/main">example,</a> you can clearly see how to manage the work of FunLib - all you need is: <br><br><ul><li>  inherit from FunApp, set the path to the API, the interface that works with the API, and your DbHelper class </li><li>  inherit from FunActivity / FunFragment, and there it is already convenient to start the work, get access to the API and the database </li><li>  do what you need!  ;) </li></ul><br><br><h2>  P.S </h2><br>  Perhaps, having read about loaders, you will think that I, at last, will decide to fasten to the ContentProvider application.  But no, I do not plan to do this, because  I think not casual off.  The guide <a href="http://developer.android.com/intl/ru/guide/topics/providers/content-providers.html">says</a> : you don‚Äôt  In my practice, I have not yet had to make such an application that would provide data to other applications.  And do not throw tomatoes at me because of this!  All of us come across different tasks. <br><br>  It is also sad that you need to independently monitor what kind of ID for the FunJob has been set.  But nothing - it will be corrected, and it will become another treat! <br><br>  Who missed the link to the repository, catch: <a href="https://github.com/senneco/FunLib">https://github.com/senneco/FunLib</a> <br><br>  See you in the comments and pull requests: D </div><p>Source: <a href="https://habr.com/ru/post/224977/">https://habr.com/ru/post/224977/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../224963/index.html">As we collected the flying robot</a></li>
<li><a href="../224965/index.html">R * -tree or geospatial indexing</a></li>
<li><a href="../224967/index.html">jsDelivr - an advanced, open and publicly available CDN</a></li>
<li><a href="../224971/index.html">ONYX BOOX i63ML Newton - the first reader with the newest screen E-Ink Carta</a></li>
<li><a href="../224975/index.html">Experience of offline / online courses in Ruby on Rails with mandatory RE</a></li>
<li><a href="../224979/index.html">VIM as an IDE for Python development</a></li>
<li><a href="../224981/index.html">Practical application of Master Data Services in MS SQL Server 2012</a></li>
<li><a href="../224983/index.html">WWDC 2014: iOS 8 and OS X Yosemite (10.10)</a></li>
<li><a href="../224987/index.html">New life old synthesizer. Part 2</a></li>
<li><a href="../224991/index.html">Yandex will place its shares on the Moscow Exchange</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>