<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Burn-in rutovy shell in Vesta IP cameras and not only</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It so happened that I faced the task of recording and storing video from IP cameras. The Vesta VC-6206 IR cameras were purchased and installed without...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Burn-in rutovy shell in Vesta IP cameras and not only</h1><div class="post__text post__text-html js-mediator-article">  It so happened that I faced the task of recording and storing video from IP cameras.  The Vesta VC-6206 IR cameras were purchased and installed without introducing an information system architecture based on them.  A very short period of operation showed that the cameras tend to hang and it would be nice to reboot them periodically.  <a href="http://ru.wikipedia.org/wiki/Nmap">nmap</a> showed that only telnet, http and rtsp are available on the camera.  It seemed to me a good solution to reboot the camera with a telnet over the krone, but the technical support refused to give the root password. <br><a name="habracut"></a><br><h4>  Briefly about the use of cameras </h4><br>  The customer‚Äôs plans were to make friends of these cameras with the zoneminder on the Linux server, but the zoneminder supports RTSP is not so good, it uses the external memory too heavily through external filters (with a resolution of 1920 * 1080).  Support reported that it does not support working with Linux.  As a result, it was decided to write video with <a href="">cvlc in</a> portions of 10 minutes with a small overlap.  Everything is fine, the video is written, the CPU is not loaded at all - so the stream arrives in H264 and you do not need to recode, but it just hangs often. <br><br><h4>  Authorities hide </h4><br>  Even the android and iphone do not give the user under root privileges, but in my case full access was reasonably necessary.  The fact that access via telnet is always open and support does not tell the password makes you wonder.  I downloaded the firmware, unpacked the zip that it was, saw the cramfs image inside: <br><blockquote>  # file VC-6206_V4.00.R10.20130129-WiFi.bin <br>  VC-6206_V4.00.R10.20130129-WiFi.bin: Zip archive data, at least v2.0 to extract <br>  # unzip VC-6206_V4.00.R10.20130129-WiFi.bin <br>  Archive: VC-6206_V4.00.R10.20130129-WiFi.bin <br>  inflating: Install <br>  inflating: web-x.cramfs.img <br>  inflating: custom-x.cramfs.img <br>  inflating: user-x.cramfs.img <br>  inflating: logo-x.cramfs.img <br>  inflating: romfs-x.cramfs.img <br>  inflating: InstallDesc </blockquote><br>  It really tastes like cramfs: <br><blockquote>  # file web-x.cramfs.img <br>  web-x.cramfs.img: u-boot legacy, Linux, Linux / ARM, Standalone Program (gzip), 1310656 bytes, Tue Jan 29 12:50:53 2013, Load Address: 0x023E0000, Entry Point: 0x02520000, Header CRC: 0xD2BAE056, Data CRC: 0x29F4363A </blockquote><br>  I tried to mount these images, but failed: <br><blockquote>  # mount -o loop -t cramfs romfs-x.cramfs.img / mnt <br>  mount: wrong fs type, bad option, bad superblock on / dev / loop5, <br>  missing codepage or helper program, or other error <br>  In some cases, useful in syslog - try <br>  dmesg |  tail or so <br>  root @ server: ~ / VC-6206_V4.00.R10.20130129-WiFi # dmesg |  tail -3 <br>  [168.201350] fuse init (API version 7.13) <br>  [171.240014] eth0: no IPv6 routers present <br>  [48915.272594] cramfs: wrong magic </blockquote><br>  Thanks to philpirj and his <a href="http://habrahabr.ru/post/147793/">post</a> , life has become better, life has become more cheerful: <br><pre><code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> *.img ; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> mkdir -p /mnt/fw/`basename <span class="hljs-variable"><span class="hljs-variable">$i</span></span> .img` ; dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=<span class="hljs-variable"><span class="hljs-variable">$i</span></span> of=<span class="hljs-variable"><span class="hljs-variable">$i</span></span>.cut bs=8 skip=8 ; mount -o loop -t cramfs <span class="hljs-variable"><span class="hljs-variable">$i</span></span>.cut /mnt/fw/`basename <span class="hljs-variable"><span class="hljs-variable">$i</span></span> .img` ; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre> <br>  In the image of the system itself (romfs-x.cramfs.img), I first noticed the telnetd packed with UPX.  I unpacked it, made strings for it, but did not find hard-coded passwords there and lost interest in it. <br>  I found this / etc / passwd: <br><pre> <code class="hljs ruby"><span class="hljs-symbol"><span class="hljs-symbol">root:</span></span><span class="hljs-symbol"><span class="hljs-symbol">absxcfbgXtb3o:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:root</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/bin/sh</span></span></code> </pre><br>  Conveniently.  John The Ripper from the package in debian went through DES128 with a speed of only 1800K c / s, after rebuilding it with OpenMP and sse2 it became 6300K c / s.  By the end of the day, john finished and I got a root password that fits all cameras with this firmware and sewn it tightly into it. <br><br><h4>  Success </h4><br>  The password came up, of course: <br><blockquote>  root @ server: /mnt/cramfs/user-x.cramfs# telnet 192.168.1.11 <br>  Trying 192.168.1.11 ... <br>  Connected to 192.168.1.11. <br>  Escape character is '^]'. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      LocalHost login: root <br>  Password: <br>  # cat / proc / cpuinfo <br>  Processor: ARM926EJ-S rev 5 (v5l) <br>  BogoMIPS: 148.27 <br>  Features: swp half thumb fastmult edsp java <br>  CPU implementer: 0x41 <br>  CPU architecture: 5TEJ <br>  CPU variant: 0x0 <br>  CPU part: 0x926 <br>  CPU revision: 5 <br>  Cache type: write-back <br>  Cache clean: cp15 c7 ops <br>  Cache lockdown: format C <br>  Cache format: Harvard <br>  I size: 16384 <br>  I assoc: 4 <br>  I line length: 32 <br>  I sets: 128 <br>  D size: 8192 <br>  D assoc: 4 <br>  D line length: 32 <br>  D sets: 64 <br><br>  Hardware: <br>  Revision: 3650000 <br>  Serial: 0000000000000000 <br>  # ps w <br>  PID Uid VSZ Stat Command <br>  1 root 3728 S init <br>  2 root SW [posix_cpu_timer] <br>  3 root SW [softirq-high / 0] <br>  4 root SW [softirq-timer / 0] <br>  5 root SW [softirq-net-tx /] <br>  6 root SW [softirq-net-rx /] <br>  7 root SW [softirq-block / 0] <br>  8 root SW [softirq-tasklet] <br>  9 root SW [softirq-hrtimer] <br>  10 root SW [softirq-rcu / 0] <br>  11 root SW &lt;[desched / 0] <br>  12 root SW &lt;[events / 0] <br>  13 root SW &lt;[khelper] <br>  14 root SW &lt;[kthread] <br>  26 root SW &lt;[kblockd / 0] <br>  27 root SW &lt;[kseriod] <br>  36 root SW &lt;[khubd] <br>  93 root SW [pdflush] <br>  94 root SW [pdflush] <br>  95 root SW &lt;[kswapd0] <br>  96 root SW &lt;[aio / 0] <br>  97 root SW &lt;[cifsoplockd] <br>  98 root SW &lt;[cifsdnotifyd] <br>  715 root SW [mtdblockd] <br>  750 root SW &lt;[kmmcd] <br>  797 root SWN [jffs2_gcd_mtd7] <br>  822 root 1576 S / sbin / syshelper 25 <br>  826 root 3732 S / sbin / telnetd <br>  828 root 2744 S / utils / upgraded <br>  829 root 3516 S / sbin / searchIp <br>  922 root 103628 S / usr / sbin / fvideoencoder -i 2 -s 6 -d 0 -o 1 -h 2 -g 2 -l 81 -t 8 -j 1 -a 3 -b 40 <br>  923 root 11596 S / usr / sbin / a1ewtest <br>  938 root 12772 S wlandaemon <br>  943 root 3728 S / bin / sh /usr/etc/dup_app.sh <br>  945 root 1396 S dupc / usr / bin / Sofia <br>  946 root 372884 S / usr / bin / Sofia <br>  1137 root 3732 S -sh <br>  1139 root 3732 R ps w <br>  # cat / mnt / mtd / Config / Account1 <br>  { <br>  "Groups": [ <br>  { <br>  "AuthorityList": [ <br>  "ShutDown", <br>  "ChannelTitle", <br>  "RecordConfig", <br>  "Backup", <br>  "StorageManager", <br>  "Account", <br>  "SysInfo", <br>  "QueryLog", <br>  "DelLog", <br>  "SysUpgrade", <br>  "AutoMaintain", <br>  "GeneralConfig", <br>  "EncodeConfig", <br>  CommConfig, <br>  "NetConfig", <br>  "AlarmConfig", <br>  "VideoConfig", <br>  "PtzConfig", <br>  "PTZControl", <br>  "DefaultConfig", <br>  "Talk_01", <br>  "Monitor_01", <br>  "Replay_01" <br>  ], <br>  "Memo": "administrator group", <br>  "Name": "admin" <br>  }, <br>  { <br>  "AuthorityList": ["Monitor_01", "Replay_01"], <br>  "Memo": "user group", <br>  "Name": "user" <br>  } <br>  ], <br>  "Users": [ <br>  { <br>  "AuthorityList": [ <br>  "ShutDown", <br>  "ChannelTitle", <br>  "RecordConfig", <br>  "Backup", <br>  "StorageManager", <br>  "Account", <br>  "SysInfo", <br>  "QueryLog", <br>  "DelLog", <br>  "SysUpgrade", <br>  "AutoMaintain", <br>  "GeneralConfig", <br>  "EncodeConfig", <br>  CommConfig, <br>  "NetConfig", <br>  "AlarmConfig", <br>  "VideoConfig", <br>  "PtzConfig", <br>  "PTZControl", <br>  "DefaultConfig", <br>  "Talk_01", <br>  "Monitor_01", <br>  "Replay_01" <br>  ], <br>  "Group": "admin", <br>  "Memo": "admin 's account", <br>  "Name": "admin", <br>  "Password": "QyZfVmgd", <br>  "Reserved": true <br>  "Sharable": true <br>  }, <br>  { <br>  "AuthorityList": ["Monitor_01", "Replay_01"], <br>  "Group": "user", <br>  "Memo": "guest's account", <br>  "Name": "guest", <br>  "Password": "tlJwpbo6", <br>  "Reserved": true <br>  "Sharable": true <br>  }, <br>  { <br>  "AuthorityList": ["Monitor_01"], <br>  "Group": "user", <br>  "Memo": "default account", <br>  "Name": "default", <br>  "Password": "OxhlwSG8", <br>  "Reserved": false, <br>  Sharable: false <br>  } <br>  ] <br>  } <br>  # <br></blockquote><br><br><h4>  Spread </h4><br>  First, I expected to quickly google something according to the firmware version and found out that the same firmware is used in <a href="http://www.jufenginfo.com/down_info.php%3F81">Feng</a> IP cameras at least.  Judging by the fact that the firmware has a bunch of modules for different cameras and wifi support, this firmware is common to several models.  Having already reached the config from the inside of the camera, I googled the default password passwords hashes and found a <a href="http://www.cctvforum.com/viewtopic.php%3Ff%3D3%26t%3D34425">post</a> on the <a href="http://www.cnmsecure.com/">third producer's</a> forum, where some guy shakes the same or similar cameras through a hole in the web interface.  I didn‚Äôt work with relative paths, but it looks like it‚Äôs just fixed.  Still, the post is left on the manufacturer's forum. <br><br>  PS This post does not pretend to the status of a serious research, in it I just tell you how I solve a practical task for me.  I considered that the post will be interesting to harabrachiteli as posts like <a href="http://habrahabr.ru/post/172799/">it</a> .  The decrypted password is available at this <u>link</u> .  (Every time it‚Äôs funny like the first time. Actually, the search will not take much time, the password is simple) </div><p>Source: <a href="https://habr.com/ru/post/173501/">https://habr.com/ru/post/173501/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../173483/index.html">Copyright from another galaxy</a></li>
<li><a href="../173485/index.html">Microsoft, Nokia and Oracle complained to Google - they want too many top-level domains</a></li>
<li><a href="../173493/index.html">The Internet Protection League will announce threats to the freedom of the Web, following the example of Batman</a></li>
<li><a href="../173495/index.html">MongoDB 2.4 release</a></li>
<li><a href="../173499/index.html">US Supreme Court ruled in favor of student selling textbooks on eBay</a></li>
<li><a href="../173503/index.html">The first attempt to state regulation of Bitcoin</a></li>
<li><a href="../173509/index.html">Grab - new interface for working with DOM-tree of HTML-document</a></li>
<li><a href="../173513/index.html">Configuring EMC VNX 5100 Storage</a></li>
<li><a href="../173517/index.html">Death of proprietary software</a></li>
<li><a href="../173519/index.html">Humble Weekly Sale: Bastion</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>