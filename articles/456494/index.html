<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In the States, GOSTs are also so-so. Fatal vulnerability in YubiKey FIPS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi% username%! 

 On June 13, 2019, Yubico, a manufacturer of devices for two-factor authentication, issued a security notice , which addresses the cr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In the States, GOSTs are also so-so. Fatal vulnerability in YubiKey FIPS</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ie/1s/bg/ie1sbgz1az7h_qjxfx-zc4b52wk.png"><br><br>  Hi% username%! <br><br>  On June 13, 2019, Yubico, a manufacturer of devices for two-factor authentication, issued <a href="https://www.yubico.com/support/security-advisories/ysa-2019-02/">a security notice</a> , which addresses the critical vulnerability of some Yubikey FIPS devices.  Let's see what this vulnerability is and how it could be prevented. <br><a name="habracut"></a><br><h3>  Foreword </h3><br>  The States also have their own GOST standards, called FIPS - Federal Information Processing Standard.  Hardware and software with which the state.  structures must comply with FIPS. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      According to colleagues we met at EuroCrypt 2019, FIPS certification is hell, to the point that FIPS experts come to you, launch your software in debug mode, change values ‚Äã‚Äãin memory and check if it falls down where it is intended. <br><br>  Despite this, it is possible to get certified and become FIPS compliant.  Therefore, there are many times more products and companies supplying services to the state than we do. <br><br><h3>  Ecdsa </h3><br>  Inside the usb token Yubico there is a storage for keys and an engine that implements, including  ECDSA.  Upon registration, the public key from the token is transmitted and saved to the server. <br><br>  And when logging in, the server sends the client a random string, which he signs along with the meta information, such as, for example, a domain. <br><br>  In a nutshell, how ECDSA or digital signature on elliptic curves works.  Some details are omitted for simplicity: <br><br><ol><li>  We consider the hash of the message and translate it into a number. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>e</mi><mo>=</mo><mi>H</mi><mi>A</mi><mi>S</mi><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.401ex" height="2.66ex" viewBox="0 -832 6631.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-3D" x="744" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-48" x="1800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-41" x="2689" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-53" x="3439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-48" x="4085" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-28" x="4973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6D" x="5363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-29" x="6241" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mo>=</mo><mi>H</mi><mi>A</mi><mi>S</mi><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> e = HASH (m) </script>  . </li><li>  We generate a <b>cryptographically stable</b> random number k. </li><li>  Calculate point <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>k</mi><mo>&amp;#x2217;</mo><mi>G</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.66ex" height="2.66ex" viewBox="0 -832 5881.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-78" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2C" x="962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-79" x="1407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-29" x="1904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-3D" x="2571" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6B" x="3628" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2217" x="4371" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-47" x="5094" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><mo>‚àó</mo><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> (x, y) = k * G </script>  where G is the base point of the curve, called the generator (constant) </li><li>  Calculate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>=</mo><mi>x</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.417ex" height="2.057ex" viewBox="0 -780.1 5346.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-3D" x="729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-78" x="1785" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6D" x="2608" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6F" x="3486" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-64" x="3972" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6E" x="4745" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mi>x</mi><mtext>&nbsp;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>&nbsp;</mtext><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> r = x ~ mod ~ n </script>  where n is the base point order (constant) </li><li>  Calculate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>e</mi><mo>+</mo><mi>r</mi><mo>&amp;#x2217;</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><mspace width=&quot;thinmathspace&quot; /><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>m</mi><mi>o</mi><mi>d</mi><mspace width=&quot;thinmathspace&quot; /><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.056ex" height="2.901ex" viewBox="0 -935.7 11218.7 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-3D" x="747" y="0"></use><g transform="translate(1803,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6B" x="0" y="0"></use><g transform="translate(521,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-31" x="778" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-28" x="3329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-65" x="3718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2B" x="4407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-72" x="5408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2217" x="6082" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-64" x="6804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-29" x="7328" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-62" x="8134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6D" x="8564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6F" x="9442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-64" x="9928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6E" x="10618" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>e</mi><mo>+</mo><mi>r</mi><mo>‚àó</mo><mi>d</mi><mo stretchy="false">)</mo><mspace width="thinmathspace"></mspace><mtext>&nbsp;</mtext><mi>b</mi><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="thinmathspace"></mspace><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> s = k ^ {- 1} (e + r * d) \, \ bmod \, n </script>  where d is the private key </li><li>  A digital signature consists of a pair of numbers r, s </li></ol><br>  It is crucial that the number k is not only secret, but always different.  Otherwise, it becomes possible to calculate the private key. <br><br>  For example, we have two signatures (r, s) and (r1, s1), which are obtained for different messages m and m1, but using the same secret k.  Let's calculate the private key. <br><br><ul><li>  The attacker computes e and e1. </li><li>  Insofar as <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>&amp;#x2212;</mo><mi>s</mi><mn>1</mn><mo>=</mo><msup><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>e</mi><mo>&amp;#x2212;</mo><mi>e</mi><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.805ex" height="2.901ex" viewBox="0 -935.7 8957.8 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2212" x="691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-73" x="1692" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-31" x="2161" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-3D" x="2940" y="0"></use><g transform="translate(3996,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6B" x="0" y="0"></use><g transform="translate(521,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-31" x="778" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-28" x="5522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-65" x="5911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2212" x="6600" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-65" x="7601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-31" x="8067" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-29" x="8568" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>‚àí</mo><mi>s</mi><mn>1</mn><mo>=</mo><msup><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>e</mi><mo>‚àí</mo><mi>e</mi><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5"> s - s1 = k ^ {- 1} (e - e1) </script>  , then you can learn k. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi><mo>&amp;#x2212;</mo><mi>e</mi><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>&amp;#x2212;</mo><mi>s</mi><mn>1</mn></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.808ex" height="2.419ex" viewBox="0 -780.1 9389.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-3D" x="799" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-66" x="2105" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-72" x="2656" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-61" x="3107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-63" x="3637" y="0"></use><g transform="translate(4070,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2212" x="688" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-65" x="1689" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-31" x="2155" y="0"></use></g><g transform="translate(6727,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2212" x="691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-73" x="1692" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-31" x="2161" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mo>‚àí</mo><mi>e</mi><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mo>‚àí</mo><mi>s</mi><mn>1</mn></mrow></math></span></span><script type="math/tex" id="MathJax-Element-6"> k = \ frac {e - e1} {s - s1} </script></li><li>  Insofar as <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>e</mi><mo>+</mo><mi>r</mi><mo>&amp;#x2217;</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.925ex" height="2.901ex" viewBox="0 -935.7 7717.8 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-3D" x="747" y="0"></use><g transform="translate(1803,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6B" x="0" y="0"></use><g transform="translate(521,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-31" x="778" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-28" x="3329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-65" x="3718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2B" x="4407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-72" x="5408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2217" x="6082" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-64" x="6804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-29" x="7328" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>e</mi><mo>+</mo><mi>r</mi><mo>‚àó</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> s = k ^ {- 1} (e + r * d) </script>  then one can calculate d. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>&amp;#x2217;</mo><mi>k</mi><mo>&amp;#x2212;</mo><mi>e</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.928ex" height="2.419ex" viewBox="0 -780.1 8149.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-3D" x="801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-66" x="2107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-72" x="2658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-61" x="3109" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-63" x="3639" y="0"></use><g transform="translate(4072,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2217" x="691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-6B" x="1414" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMAIN-2212" x="2158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-65" x="3158" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/virgilsecurity/blog/456494/&amp;xid=17259,15700002,15700021,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg2unvQIkf2k391qe4-D6UKScxIXg#MJMATHI-72" x="7697" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mo>‚àó</mo><mi>k</mi><mo>‚àí</mo><mi>e</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-8"> d = \ frac {s * k - e} {r} </script></li><li>  d - private key </li></ul><br>  If the numbers k are different, but <i>not quite</i> , then you can also calculate the private key, you just need to sort out a little.  By the way, in 2013 I already <a href="https://habr.com/ru/post/199356/">wrote</a> how the sloppy implemented (EC) DSA broke in PlayStation and other products, I highly recommend reading. <br><br><h3>  Yubico </h3><br>  So, in a number of Yubico FIPS products there was a bug in which the numbers k immediately after the token was turned on were not entirely random generated.  And there was a real opportunity to calculate the private key sewn inside.  Therefore, they withdrew the vulnerable devices and issued a notification. <br><br><h3>  What could be done? </h3><br>  Generally speaking, the problem has long been solved.  Since 2013, there has been <a href="https://tools.ietf.org/html/rfc6979">RFC 6979</a> , which describes <b>deterministic</b> ECDSA, derived from the usual way through several simple modifications.  Moreover, in 2014, when developing the U2F standard, it was precisely because of the potential problems with the RNG that FIPS openly <a href="https://jbp.io/2014/10/21/u2f-public-comments.html">suggested</a> switching to Deterministic ECDSA, but the proposal was rejected.  This is one of the reasons why FIPS is decoded as F * cked-up, Insecure, Persnickety Standards. <br><br>  Yubico could formally comply with the FIPS requirements for the randomness of the number k, but using workaround, generating k is deterministic, and then XOR-I with the fact that issued the RNG (or drove everything through KDF).  However, this was not done. <br><br><h3>  And what about us? </h3><br>  And we have all the same.  GOST R 34.10-2012 - essentially the same ECDSA, just with other curves.  The requirements for generating the number k remain the same as in the traditional ECDSA.  Does any of the manufacturers of our tokens make the above described workaround?  Does it use a deterministic version of ECDSA?  I doubt it. <br><br>  If there are representatives of Russian developers, it would be interesting to hear their opinion on this.  Or at least so they have it in mind. <br><br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/456494/">https://habr.com/ru/post/456494/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../45648/index.html">Rails. Rating system. Plugins</a></li>
<li><a href="../456482/index.html">Catch Me If You Can. King Version</a></li>
<li><a href="../456488/index.html">Fast logging</a></li>
<li><a href="../456490/index.html">Lectures on the brain, part 1. The evolution of the human brain. The functions of the brain at each stage of its development</a></li>
<li><a href="../456492/index.html">Troll Army</a></li>
<li><a href="../456498/index.html">Device Manager. Extend IIA to devices</a></li>
<li><a href="../4565/index.html">"Expert" will accelerate your site</a></li>
<li><a href="../45650/index.html">IPhone ads banned in UK</a></li>
<li><a href="../456502/index.html">The shortest scientific articles</a></li>
<li><a href="../456504/index.html">Dark mode will not solve problems with screens</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>