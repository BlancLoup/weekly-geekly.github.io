<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bad advice on setting up a backup and a few tales</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you set up a backup, did not score, did not save - it is already well done. But backup still needs to be able to cook properly. 

 Personally, I ha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bad advice on setting up a backup and a few tales</h1><div class="post__text post__text-html js-mediator-article">  If you set up a backup, did not score, did not save - it is already well done.  But backup still needs to be able to cook properly. <br><br>  Personally, I have a feeling that some administrators have done a special book with a bad advice on setting up a backup for optimists who do not believe in Murphy‚Äôs law. <br><br>  Today I decided to lay out my short hit parade with real stories that I had to deal with while working on the side of service providers and customers.  After each such case, the hero of the occasion feels keenly that he is no longer happy with the company, and he realizes that it‚Äôs time to update the summary on XX. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Read and shake on the mustache. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5e5/362/869/5e5362869c674350a0b43cab44b8d2a1.png"></div><a name="habracut"></a><br><h2>  Tip 1. Use RAID instead of backup. </h2><br>  Why backup when there is a RAID?  Do not bother with the deployment and configuration of the backup system, a separate infrastructure for it and a special person who will administer it.  You have the same RAID, which means there are two copies of the data or redundant data is stored. <br><br>  <b>Case of life.</b>  Client data was on the storage system.  For speed and reliability, it was created RAID-10 of more than 24 drives.  The storage system also had a number of spare disks.  When one of the disks in the mirror failed, the storage system replaced the fallen disk with a spare disk and began to restore the contents on it.  The remaining disk worked for two and actively gave the data to that new disk, but did not do it for long, literally 5 seconds.  Then the disk could not withstand the load, and the entire RAID failed.  As a result, data on all 24 disks was lost. <br><br>  <b>If serious.</b>  Mirroring, duplication of data that underlies the operation of RAID does not protect them.  RAID is needed so that the system does not stop due to every hard disk failure.  RAID is about availability, not about data integrity.  It will not help if a careless administrator or a virus has corrupted data.  He does not provide and versioning. <br>  In general, RAID is not for backup.  Do not confuse warm with soft. <br><br><h2>  Council 2. Put backups on the same storage where the source data is located </h2><br>  If you still decide to backup, do not spend on a separate backup storage.  Modern storage systems are very reliable and smart.  Take and allocate fast volumes for productive data, and for slow-add backups.  Forget about rule 3-2-1.  Those who speak about him simply do not know that this is possible. <br>  Use the power of storage to the end! <br><br>  <b>Case of life.</b>  There are many stories, because anything can happen to the storage system.  The end of these stories, however, is the same: storage failure and unavailability, and sometimes complete data loss.  My most favorite stories from the ‚Äúhuman factor‚Äù series: <br><br><ul><li>  the administrator has confused and deleted the productive LUN; </li><li>  A novice administrator stuck a large sticker on the air intake for the air intake with a detailed description of the purpose of the storage system, its IP addresses, brief instructions on switching on and off, contacts of the person in charge, etc. with very ‚Äúnecessary‚Äù information.  The storage system has overheated and failed. </li></ul><br>  Or just recently colleagues told: the storage system of the old model worked for a long time and died.  When the engineers saw her body, they realized that they only saw such a storage system in a museum.  There are no ideas how to restore it, especially - how to do it quickly. <br><br>  <b>If serious.</b>  Do not do this.  If you do, then be mentally prepared for the fact that you will be left without source data and without backups for an indefinite time. <br><br><h2>  Tip 3. Discard the backup server and backup system database. </h2><br>  Back up the server and backup database itself?  What for?  You already have backups, somehow recover.  If the backup server orders you to live a long time, then simply re-deploy everything, import backed-up files there.  Then wait until the system realizes what to do with all this farm and restores the database with information about tasks, schedules, backup objects and their location, storage location of backups.  It does not matter that at first you will spend time restoring the backup system and only then begin to revive the fallen infrastructure. <br><br>  <b>Case of life.</b>  On one LUN SHD were placed the original data and the backup server.  When the LUN became unavailable and it took to recover, it turned out that there is no backup of the server and the backup database.  Without the last, all backups turned into a suitcase without a handle.  The guys had to deploy a backup system from scratch.  The benefit of the solution used was the ability to recreate the base anew through the import of backups into the system.  But there was one caveat: the data for import was 100 TB.  To build a new database, the new system must go through them in detail and catalog all the data.  As a result, only 20% was processed in 1.5 days.  Then someone advised them to import only full backups (the largest files), and things went faster, but the victims have already lost a lot of time and nerves. <br><br>  <b>If serious.</b>  To be fully prepared when the backup server is lost, two things need to be considered: <br><br><ul><li>  backup server and database backup ( <s>backup backup</s> ).  In some solutions, it is enough to deploy the system again and import the backup files into it.  That is, having a database backup with tasks, backup objects, etc. is not so critical.  So, for example, arranged by Veeam. <br><br>  With others without a database can not do (Symantec).  If she did not back up, you will have to spend time on her recovery. <br><br>  For the third - after losing the database, it remains only to contact the vendor‚Äôs technical support (Commvault). <br><br></li><li>  Disaster Recovery pre-thought plan for backup server in case of primary server / site failure.  Many backup system vendors in the documentation offer options for organizing a Disaster Recovery backup server, for example: <a href="https://helpcenter.veeam.com/docs/backup/vsphere/restore_vbr.html%3Fver%3D95">Veeam</a> , <a href="https://documentation.commvault.com/commvault/v11/article%3Fp%3Dfeatures/disaster_recovery/c_dr_overview.htm">Commvault</a> . </li></ul><br><h2>  Tip 4. Do not test backup recovery. </h2><br>  Backup is not for recovery, but in order to just be and warm the administrator with the soul by its very existence.  The main thing is to set up a backup, and then everything will be backed up accurately so that you can easily restore the virtual machine, databases and applications.  In all cases, the recovered data will be consistent and unharmed. <br><br>  Until the ‚ÄúF-hour‚Äù the RTO will remain secret for the administrator and for the authorities.  But then for all there will be a surprise. <br><br>  Even better, no one except the administrator knows where the backups are, and the recovery script is only in his head.  Let colleagues try their hand at improvisation. <br><br>  <b>Cases from life.</b>  There are also many such stories, one of the most typical.  Once upon a time there was a database called prod.  The backup engineer properly put it on a backup.  One day, there was a crash, and the administrators restored the base next to the name prod1.  Productively accordingly began to live on prod1.  The backup engineer did not know anything about this, so I did not install prod1 on the backup.  The old prod database continues to back up.  When the need comes to recover from the backup, it turns out that it is not.  Data for the last 3 months is lost. <br><br>  A similar story happens when the database moves to a new disk or server.  The problem is largely organizational, but it can also be avoided if a test restore from a backup copy with the participation of the system owner is periodically held. <br><br>  <b>If serious.</b>  After setting up the backup system, perform a test recovery at least once.  The further test schedule depends on the backup object: how often it changes, its dimensions, etc. The owner of the system / application should participate in the verification. <br><br>  If you do not want to check everything manually, then most backup software has automation functions for checks (for example, Veeam Sure Backup has data integrity). <br><br>  In addition, many software have the ability to use scripts to check backups, allowing you to do some actions after recovery (download applications, connect to certain ports, create objects in the database, etc.). <br><br>  A test recovery will help to obtain a realistic estimate of the RTO (the calculated RTO may be very different from life).  It will also help identify gaps in the recovery regulations, if any. <br><br>  There are many reasons for testing backups, as well as recommendations for its organization.  I will tell about it in detail in one of the following articles. <br><br><h2>  Tip 5. No separate backup infrastructure </h2><br>  We do the backup system and the infrastructure for it as a residual.  When the product is already working, we also back up the same infrastructure and network.  Let everything go through the same channel.  Do not put restrictions on the bandwidth for backup jobs, let the backup eat as many resources as it wants. <br><br>  <b>Case of life.</b>  At the client, the product and the backup were shared by one network channel. <br><br>  Once a quarter, the company calculated a quarterly report.  The whole process took more than 15 hours, so the group (let's call it conditionally ‚Äúbusiness‚Äù) starts the report generation in the morning and receives a ready report the next morning.  One such beautiful morning turns out that the quarterly report was not formed.  The investigation revealed that the error occurred due to a disconnection from the database.  There were no visible technical reasons for this.  A week later, the guys re-launch the creation of a report, and everything works out.  But after six months, the problem repeats. <br><br>  It turned out that at about the same time another group (let's call it ‚ÄúIT‚Äù) is launching a task for a full backup of the database.  The task execution occupied the most part of the network band, loaded the database, as a result of which the connection between the system calculating the report and the database was interrupted.  The problem was solved after the failure of the backup on the day of the quarterly report. <br><br>  <b>If serious.</b>  Backup is a resource-intensive thing.  Ideally, it needs its own infrastructure and network on dedicated equipment.  Then the backup will not interfere with the product, and the backup and restore tasks will be completed in a reasonable time. <br><br>  Putting a separate infrastructure for backup is easiest at the planning stage of a productive stand. <br><br>  If you can‚Äôt separate flies from cutlets, you can try to set limits on the means of a backup system (Network Traffic Throttling) or limit the bandwidth using QoS on network equipment.  The main thing here is to keep a balance and not ‚Äúkill‚Äù the backup lane so that tasks will run for 24 hours. <br><br><h2>  Tip 6. Do not monitor </h2><br>  Why set up email notifications that the next backup task was successfully done or zafeillos?  There is enough spam in the box.  Moreover, you do not need to monitor the state of the server where the backup system works. <br><br>  The less you know the better you sleep. <br><br>  <b>Case of life.</b>  Veeam has one feature: after installing the update, you must go to the main server and run this updated Veeam.  It will check and issue a list of infrastructure servers that require updating.  If some of the components of the backup infrastructure remain un-upgraded, the main server will not be able to communicate with them, and an error will be displayed during the execution of tasks.  The administrator either forgot about this moment, or simply did not know, updated the main server and left with peace of mind for the weekend.  Notifications are not configured, so he found out about his mistake only on Monday, when he needed backups, which were not. <br><br>  <b>If serious.</b>  Customize alerts for completed tasks and errors.  So you will understand whether you have a backup at all or you have run out of disk space and have nowhere to put it.  In addition, you can customize weekly reports on tasks and errors, the amount of remaining space for backups. <br><br>  Monitor the availability of the backup server itself: at least ping. <br><br>  This list can be continued for a long time, but I will probably stop at this.  Share in the comments your bad tips and backup stories from the cycle ‚Äúit would be funny if it were not so sad.‚Äù </div><p>Source: <a href="https://habr.com/ru/post/326948/">https://habr.com/ru/post/326948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326936/index.html">Pseudo-toning of images: eleven algorithms and sources</a></li>
<li><a href="../326940/index.html">Development of a component for creating collages</a></li>
<li><a href="../326942/index.html">Connect to the webinar: "Azure Stack TP3 Technical Overview." Beginning April 27 at 11:00 (Moscow time)</a></li>
<li><a href="../326944/index.html">Video marketing in social networks: the most important indicators in 2017</a></li>
<li><a href="../326946/index.html">Microsoft and Rambus cool memory to cryogenic temperature</a></li>
<li><a href="../326952/index.html">Brainstorming for the lazy or Individual intellectual activity, or Basics of divergent thinking in practice</a></li>
<li><a href="../326954/index.html">Open broadcast of the main conference room Mobius 2017: Let's talk about the architecture of mobile applications and something else</a></li>
<li><a href="../326956/index.html">The uWSGI Spooler</a></li>
<li><a href="../326958/index.html">From weekly sysadmin: unpack NetApp FAS 9000</a></li>
<li><a href="../326960/index.html">Duck says ‚Äúquack-krya‚Äù, the cow says ‚Äúmu-mu‚Äù, ‚ÄúRunn Me!‚Äù - another PHP framework * tells us. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>