<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Forms should be simple and declarative.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many were faced with the choice of a particular library for working with forms in ReactJS. When I chose the right one for me, different libraries seem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Forms should be simple and declarative.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ip/gc/fs/ipgcfs05pveexjogtfdqudbtwvk.png"><br><br>  Many were faced with the choice of a particular library for working with forms in ReactJS.  When I chose the right one for me, different libraries seemed perfect BUT: a form in configs or callbacks in the onSubmit event, or asynchronous submit.  Why do the forms for the reactor <u>not correspond to the principles of the reactor</u> , why do they look like something special?  If these questions occurred to you, or you like forms, invite you to read the article. <br><a name="habracut"></a><br><h4>  Let's imagine the forms as they should be. </h4><br>  <b>The form in the reactor should:</b> <br><br><ul><li>  provide controllability of fields and events </li><li>  best fit html projection </li><li>  respect declarative and composition </li><li>  use typical methods of working with React components </li><li>  have predictable behavior </li></ul><br>  <b>The form in the reactor should not:</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  set the management model </li><li>  be redundant or require additional data </li><li>  require customization or mandatory use of helper functions </li></ul><br>  <b>Now we will try to describe the ideal form based on these rules:</b> <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Validation</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"firstName"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"lastName"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Transform</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"number"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"minSalary"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"number"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"maxSalary"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Transform</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Validation</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag">&gt;</span></span>Send<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  It looks almost like a regular html form, with the exception of <b>Field</b> instead of input and the unknown <b>Validation</b> and <b>Transform</b> .  You probably already guessed that the <b>Validation</b> tag should check the value of the fields and create error messages for them.  The <b>Transform</b> tag, in turn, is needed to calculate the minSalary and maxSalary fields. <br><br><h4>  Did I say something about React? </h4><br>  <b>Fast forward to the realities of the reactor and describe the same form:</b> <br><br><pre> <code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MySexyForm</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">model</span></span>: {} }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.validator = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">model, meta</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> errors = { ...meta.submitErrors }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(model.firstName &amp;&amp; model.firstName.length &gt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { errors = { <span class="hljs-attr"><span class="hljs-attr">firstName</span></span>: [<span class="hljs-string"><span class="hljs-string">"First name length must be at minimum 2"</span></span>] }; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(model.lastName &amp;&amp; model.lastName.length &gt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { errors = { ...errors, <span class="hljs-attr"><span class="hljs-attr">lastName</span></span>: [<span class="hljs-string"><span class="hljs-string">"Last name length must be at minimum 2"</span></span>] }; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> errors; }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.transformer = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">field, value, model</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (field) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"minSalary"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(value) &gt; <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(model.maxSalary)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">maxSalary</span></span>: value }; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"maxSalary"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(value) &lt; <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(model.minSalary)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">minSalary</span></span>: value }; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {}; }; } onSubmit = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) =&gt;</span></span> (model) =&gt; { event.preventDefault(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Form submitting:"</span></span>, model); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.sendSexyForm(model); <span class="hljs-comment"><span class="hljs-comment">//  action           submitErrors  } onModelChange = (model) =&gt; { console.log("Model was updated: ", model); this.setState({ model }); } render() { return ( &lt;Form action="/" method="post" onSubmit={this.onSubmit} onModelChange={this.onModelChange} values={this.state.model} initValues={this.props.initValues} &gt; &lt;Validation validator={this.validator} submitErrors={this.props.submitErrors}&gt; &lt;Field type="text" name="firstName"&gt; &lt;Field type="text" name="lastName"&gt; &lt;Transform transformer={this.transformer}&gt; &lt;Field type="number" name="minSalary"&gt; &lt;Field type="number" name="maxSalary"&gt; &lt;Transform&gt; &lt;Field type="email" name="email"&gt; &lt;/Validation&gt; &lt;button type="submit"&gt;Send&lt;button&gt; &lt;/Form&gt; ); } };</span></span></code> </pre><br><blockquote>  I will not consider the Field component in detail, let‚Äôs imagine that it renders input with the transmitted prop and additional value and onChange.  As well as error messages for this field. </blockquote>  It is necessary to explain the emergence of new fields initValues, values, onModelChange, onSubmit, validator, transformer. <br><br>  Let's start with the prop added to the <b>Form</b> . <br><br>  The <b>onSubmit</b> event handler allows <b>you</b> to intercept the form submission event, to access this event and to the current values ‚Äã‚Äãof the form fields through the model argument. <br><br>  The <b>onModelChange event</b> handler allows <b>you</b> to track changes in form fields. <br>  With the help of <b>values,</b> we can control the values ‚Äã‚Äãof the fields, and <b>initValues</b> allows <b>us</b> to set the initial values. <br><br>  This basic functionality provides the majority of libraries for working with forms in a reactor, nothing unusual, everything is as it should be. <br><br>  Consider the <b>Validation</b> tag, it has two prop. <br><br><ol><li>  validator - a function that returns validation errors based on the passed values ‚Äã‚Äãof form fields </li><li>  submitErrors is an additional rest field passed by the second argument to the validator function, in which we send the errors received from the server after the submission.  Essentially, all arguments passed to Validation with the exception of the validator are passed to rest. </li></ol><br>  Unfortunately, I have not seen a similar or similar implementation of validation, although it seems obvious: we have a validation function that receives data and returns errors based on them, no side effect logic, everything is as it should be in a reactor. <br><br>  Let's go to the <b>Transform</b> component.  It intercepts the changes from the nested fields and calls the transformer function, which takes three arguments: <br><br><ul><li>  field - the name of the field in which the change occurred </li><li>  value - new value of this field </li><li>  model - the current value of the form fields with the previous value of the changed field </li></ul><br>  It should return an object of the form {[field]: value} that will be used to update other form fields. <br><br>  Also an obvious implementation of calculated fields. <br><br><h4>  And ... what do we have in the end? </h4><br>  Since we initially used a declarative approach and a composition, we can combine the components of validation and transformation and use them for separate groups of fields. <br><br>  In the Form component, there are no extra props responsible for additional functionality (transformation and validation). <br><br>  Field gets its value, error information and callback functions by means of <a href="https://reactjs.org/docs/context.html">contexts</a> , which allows you to create additional components for working with the form and delegate responsibility.  The form itself has a form similar to html projection, which simplifies understanding. <br><br><h4>  react-painlessform </h4><br>  I have written my own library that helps to make forms simple and clear.  The code is available on <a href="https://github.com/Wroud/react-painlessform">Github</a> . <br><br>  And also see a <a href="https://codesandbox.io/s/1yl74031w3">live example</a> from the article. <br><br><h4>  Thanks for attention </h4><br>  Once you‚Äôve read it to the end, you love the forms a lot, or the article was interesting, I‚Äôll be happy to read the comments and hear your opinion about the forms in the reactor. </div><p>Source: <a href="https://habr.com/ru/post/354562/">https://habr.com/ru/post/354562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354550/index.html">Animations in the world of states</a></li>
<li><a href="../354552/index.html">Accelerating Angular Applications</a></li>
<li><a href="../354554/index.html">2nd generation Infortrend EonStor DS2024 storage system review and testing</a></li>
<li><a href="../354558/index.html">Can I trust my Chrome and Firefox synchronization passwords?</a></li>
<li><a href="../354560/index.html">Conference BLACK HAT USA. ‚ÄúHow the feds caught the Russian mega-carder Roman Seleznev‚Äù</a></li>
<li><a href="../354564/index.html">Matching problems and how to deal with them</a></li>
<li><a href="../354566/index.html">How Netflix evacuates from AWS in seven minutes</a></li>
<li><a href="../354568/index.html">TON: Telegram Open Network. Part 2: Blockchains, Sharding</a></li>
<li><a href="../354570/index.html">How IaaS helps companies in the field of trade: retail cases</a></li>
<li><a href="../354572/index.html">Optimum screen space utilization with WPF Data Triggers and Stack</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>