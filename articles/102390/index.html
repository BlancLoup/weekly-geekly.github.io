<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tools for working with XML in Visual Studio 2008</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="XML is used everywhere from web services, databases, configuration files, to office documents. This article will introduce you to the instrumental sup...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tools for working with XML in Visual Studio 2008</h1><div class="post__text post__text-html js-mediator-article"> XML is used everywhere from web services, databases, configuration files, to office documents.  This article will introduce you to the instrumental support offered by Visual Studio 2008, which facilitates working with XML.  This article covers editing XML files, working with XML schemas, debugging XSLT style sheets, and extending Visual Studio by writing your own XML designers. <br><a name="habracut"></a><br><br>  When you open an XML file in Visual Studio 2008 (for example, .xml, .xsd, .xslt, .svg, or .config), you launch the embedded XML editor.  The XML editor comes with the full range of features you would expect from a Visual Studio editor, including IntelliSense, code coloring, parenthesis highlighting, folding / expanding, and code formatting.  It provides complete XML 1.0 syntax checking, tag completion, as well as XML schema support with real-time validation. <br><br>  <b><u>Editing XML files</u></b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Admittedly, manual editing of XML files can be very tedious and time consuming.  To help this, XML editor Visual Studio 2008 comes with many features to improve performance.  One of these functions is an extensible library of XML code fragments ‚Äî XML files that contain configurable pieces of code that act as templates for use during document editing.  Visual Studio installs many XML snippets files that help developers write XML schemas and XSLT style pages.  To trigger a snippet while editing the XML file, select ‚ÄúInsert Snippet‚Äù from the ‚ÄúEdit&gt; IntelliSense‚Äù menu.  Once you have inserted a fragment, you can move between highlighted fields, which you can modify with the TAB key to enter data.  <b>Figure 1</b> shows an example of fragment insertion. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d1/424/09c/9d142409c05db05b8886ddcc6b5b5b14.jpg" alt="image"><br><br>  <b>Figure 1</b> : Calling an XML snippet in Visual Studio 2008. <br><br>  You can also record your own fragments.  If you want to create a simple snippet, follow these steps: <br><br>  Create an XML file and type in it: <br>  &lt;snippet <br>  Click <b>ESCAPE</b> to close the IntelliSense window. <br>  Click <b>TAB</b> . <br>  Enter value. <br>  Press <b>ENTER</b> to complete. <br><br>  For more details, I recommend publishing to the Visual Studio editor blog. <br>  <a href="http://blogs.msdn.com/vseditor/archive/2004/07/14/183189.aspx">Code Snippet - Schema Description</a> . <br><br>  What will you do when there are no ready-made pieces of XML code, and you need to create an XML file based on an existing schema?  The XML editor offers a wide range of possibilities with which you can associate your XML documents with XML schemas.  Schema-based IntelliSense, real-time validation, and error reporting are just a few of them.  In addition to this, the XML editor can dynamically generate code fragments based on an existing schema.  After you have provided the name of the element to be added, the XML editor can analyze the schema for the required information, generate a code snippet and insert it for you.  To call the functions of dynamic building of XML code fragments, all you need to do is type the name of the element in the same way as in the following example: <br><br> <code><font color="#660000">&lt;element_name</font> <br></code> <br><br>  and press the <b>TAB</b> key.  The XML editor will create a code snippet that will look very similar to what was already shown in <b>Figure 1</b> , except that you will not need to do anything in advance.  This is a very powerful feature, especially when you need to create documents with large content models. <br><br>  By default, the XML editor generates only the required content, but this behavior can be overridden using annotations in XML schemas.  You will find more information in MSDN under the heading ‚ÄúHow to: Generate an XML Snippet From an XML Schema‚Äù. <br><br>  <b><u>Schema Cache and Schema Catalogs</u></b> <br><br>  For advanced users, the XML editor offers such functions as schema cache directories for schema files.  The scheme cache is a folder that contains many well-known W3C schemes, as well as many schemes specifically created by Microsoft or related to their technologies.  It serves as a repository of widely used schemes, which usually do not change.  You will find the default schema locations in% vsinstalldir% \ xml \ schemas, where "% vsinstalldir%" is a variable representing the location where Visual Studio is installed.  When you declare one of the namespaces defined by these schemes in your XML files, the editor will automatically associate the relevant schemes from the cache location and quickly provide IntelliSense and validation for this scheme. <br><br>  The schema catalog is XML files located in the schema cache directory (catalog.xml file by default).  They give advanced users more precise control over the various namespaces that they will probably use.  For example, you can associate certain namespaces with external sources: <br><br> <code><font color="#660000">&lt;Schema <br> href="mylocation/myschema.xsd" <br> targetNamespace="http://myschema"/&gt;</font> <br></code> <br><br>  You can also use directory files to create associations between schema files and file extensions. This can sometimes be useful when the schema does not have a targetNamespace: <br><br> <code><font color="#660000">&lt;Association <br> extension="config" <br> schema="xml/schemas/dotNetConfig.xsd"/&gt;</font> <br></code> <br><br>  Innovation in Visual Studio 2008, you can also add conditions: <br><br> <code><font color="#660000">&lt;Association <br> extension="config" <br> schema="xml/schemas/dotNetConfig30.xsd" <br> condition="%TargetFrameworkVersion% = 3.0" /&gt;</font> <br></code> <br><br>  This condition means that the dotNetConfig30.xsd scheme should be associated only when the current project uses the .NET Framework version 3.0. <br><br>  Finally, you can create a chain from one directory file to another: <br><br> <code><font color="#660000">&lt;Catalog href="http://mycompany/catalog.xml"/&gt;</font> <br></code> <br><br>  <b><u>Work with large files</u></b> <br><br>  Another important editing function that I would like to point out is support for the XML editor for large files.  Although you could work with large files in previous versions, Visual Studio 2008 supports incremental analysis of XML documents.  Now, if you are working with a 10 MB file, you do not need to wait until Visual Studio analyzes the entire file every time you make changes.  The XML editor isolates edits and reanalyzes only those parts that are required, thus offering better performance and response. <br><br>  I have described just a few of the interesting features of the XML editor, but obviously you cannot see all of them here.  <b>Table 1</b> shows some of the features that are available to Visual Studio users. <br><br><table><tbody><tr><td>  <b>Function</b> <br></td><td>  <b>Support in Visual Studio 2008</b> <b><br></b> <br></td></tr><tr><td>  Auto-complete <br></td><td>  X <br></td></tr><tr><td>  Syntax highlighting <br></td><td>  X <br></td></tr><tr><td>  Minimize / Maximize code <br></td><td>  X <br></td></tr><tr><td>  Intellisense <br></td><td>  X <br></td></tr><tr><td>  Extensible code snippet library <br></td><td>  X <br></td></tr><tr><td>  Dynamic code snippets <br></td><td>  X <br></td></tr><tr><td>  Transition to Definition (from XML to XSD) <br></td><td>  X <br></td></tr><tr><td>  Navigation backward / forward <br></td><td>  X <br></td></tr><tr><td>  Project and user profile support <br></td><td>  X <br></td></tr><tr><td>  Real-time Validation <br></td><td>  X <br></td></tr><tr><td>  Full XSD support <br></td><td>  X <br></td></tr><tr><td>  Namespace support <br></td><td>  X <br></td></tr><tr><td>  DTD support <br></td><td>  X <br></td></tr><tr><td>  XSD generation over XML <br></td><td>  X <br></td></tr><tr><td>  DTD to XSD conversion <br></td><td>  X <br></td></tr><tr><td>  Unicode support <br></td><td>  X <br></td></tr><tr><td>  Large file support (10 MB +) <br></td><td>  X <br></td></tr></tbody></table><br><br>  <b><u>Debugging XSLT Style Sheets</u></b> <br><br>  XSLT is the standard transformation language approved by the W3C, which is very popular with a large group of developers.  Visual Studio Professional provides editing and debugging support for XSLT style sheets.  Editing XSLT files is similar to editing XML files.  When it comes to debugging XSLT, Visual Studio supports two main scenarios: <br><br>  Debugging a separate transformation, which is useful when your initial interest is an input document, the actual transformation and an output document. <br>  CLR-integrated debugging, which is useful for debugging transformations in the context of your CLR application. <br><br>  <b><u>Debugging individual transformations</u></b> <br><br>  <b>Figure 2</b> shows the debugging environment when you are working with XSLT transformations.  In the default configuration, you can see the XSLT file and tabs for document input types and document output.  You can also configure Visual Studio to display all three documents at the same time.  When you go through the transformation code, you can see the input data, the transformation that processes this input and the generation of the output file. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5d7/190/a77/5d7190a778e75ad94d366e4e039d5016.jpg" alt="image"><br><br>  <b>Figure 2</b> : Debugging individual XSLT transformations. <br><br>  If you are using the C # or Visual Basic debugging environment, you will notice that debugging XSLT looks very much like debugging other programs using the CLR language.  All controls and key combinations remain the same.  In <b>Figure 2,</b> you can also see the Locals window, which can display hidden XSLT variables (self, position, and last), just like the variables that are defined in your template.  You can also see the call stack window, which you can use to navigate to different XSLT templates at the top and bottom of the stack.  You can also use the XSLT debugger to set breakpoints in both XSLT code and XML documents. <br><br>  <b><u>CLR integrated debugging</u></b> <br><br>  Although debugging individual transformations is useful, sometimes you need to debug XSLT as part of your C # or Visual Basic application.  The XSLT debugger, which is tightly integrated with other CLR debuggers, allows you to seamlessly transition from C # to XSLT and then to Visual Basic while debugging an application.  The following example shows a C # code snippet that uses the XslCompiledTransform class to initialize the XSLT transformation: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">XslCompiledTransform xsltcmd = <br> <font color="#0000ff">new</font> XslCompiledTransform( <font color="#0000ff">true</font> ); <br> xsltcmd.Load(XSLTFile); <br> XmlUrlResolver resolver = <font color="#0000ff">new</font> XmlUrlResolver(); <br> XmlWriter writer = XmlWriter.Create(OutputFile); <br> <br> xsltcmd.Transform(XMLFile, writer);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  If you set a breakpoint on the method call and pass it, the debugger will show you the XSLT style sheet ( <b>Figure 3</b> ).  All the features described in the debug section of a separate style sheet are also applicable here.  The only exception is the ability to set breakpoints in data files.  This feature is not available when you switch from XSLT from another CLR program.  Everything else will behave exactly as described in the above. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dc0/0a3/5d2/dc00a35d2091d9534aaf0aa382196468.jpg" alt="image"><br><br>  <b>Figure 3</b> : Debugging XSLT transformations from a C # application. <br><br>  <b>Table 2</b> presents a summary of the various functions available during debugging of XSLT transformations. <br><br><table><tbody><tr><td>  <b>Feature</b> <b><br></b> <br></td><td>  <b>Visual Studio 2008 Support</b> <b><br></b> <br></td></tr><tr><td>  Browser view <br></td><td>  X <br></td></tr><tr><td>  Locals, watch, call stack <br></td><td>  X <br></td></tr><tr><td>  Viewing input XML, output, and XLST during debugging <br></td><td>  X <br></td></tr><tr><td>  Breakpoints in XML <br></td><td>  X <br></td></tr><tr><td>  Breakpoints in XSLT <br></td><td>  X <br></td></tr><tr><td>  CLR language debugger integration <br></td><td>  X <br></td></tr></tbody></table><br><br>  <b><u>XML tool extension</u></b> <br><br>  The XML editor provides a good basis for developers to create custom designers on top of it.  <b>Figure 4</b> as it was done in the previous version of Visual Studio (Visual Studio 2005).  Developers could build an extension on top of the XML Editor via shared buffer access.  They should create custom designers by sharing the IVsTextLines buffer and parse the XML using System.Xml.XmlReader or XmlDocument.  Don Demsak uses this method when creating XPathmania and XPath add-ons to Visual Studio (for more information about XPathmania, see <a href="http://www.donxml.com/">http://www.donxml.com</a> ).  However, since integration occurs at the buffer level, this method creates many large buffer revisions.  In addition to this, it has some limitations because the System.Xml parser accepts only valid XML while designers, by definition, must work with non-valid files. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a4f/87c/6b4/a4f87c6b43595bac1eeac380969a6a54.jpg" alt="image"><br><br>  <b>Figure 4</b> : The old way to create custom XML designers on top of an XML editor. <br><br>  On the other hand, the XML editor has its own error recovery analyzer.  It also creates its own analysis tree representing the contents of the buffer.  In Visual Studio 2008, Microsoft opened this LINQ to XML tree to third-party developers.  The new architecture is shown in Figure 5. The new API allows developers to create custom views on top of the XML editor's analysis tree, providing them with XML error recovery after the XML editor and a LINQ to XML analysis tree with update transactions, whose execution results appear in an integrated Visual Studio UndoManager buffer.  These changes make it easy for developers to create XML tools on top of Visual Studio 2008. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4df/a7b/684/4dfa7b68487fc28cc7244f0b9c5081bf.jpg" alt="image"><br><br>  <b>Figure 5</b> : The way to extend the XML editor in Visual Studio 2008. </div><p>Source: <a href="https://habr.com/ru/post/102390/">https://habr.com/ru/post/102390/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../102383/index.html">In Canada, created a "solar" toothbrush</a></li>
<li><a href="../102384/index.html">The Contexts Project</a></li>
<li><a href="../102385/index.html">Aptana IDE 2.0.5 + Django = in pictures</a></li>
<li><a href="../102386/index.html">IndiBoard (do-it-yourself dashboard dashboard)</a></li>
<li><a href="../102387/index.html">Adding and removing on the go SATA / SCSI devices</a></li>
<li><a href="../102391/index.html">Anonymus got access to the system of monitoring and archiving corporate and webmail FSO of Russia on the server gov.ru</a></li>
<li><a href="../102393/index.html">LED Desire Light: use the flash from the HTC Desire camera (or Evo 4G, or myTouch Slide) as a bright flashlight</a></li>
<li><a href="../102396/index.html">The unique selling proposition of SaaS services</a></li>
<li><a href="../102399/index.html">PDF price generation and automatic image linking</a></li>
<li><a href="../102400/index.html">SpiNNaker - neural computer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>