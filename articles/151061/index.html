<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Histone is a new open source cross-platform template engine.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 MegaFon is a dynamic technology company whose work is not limited solely to the provision of communication services. For example, among...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Histone is a new open source cross-platform template engine.</h1><div class="post__text post__text-html js-mediator-article"><h5>  Introduction </h5><br>  MegaFon is a dynamic technology company whose work is not limited solely to the provision of communication services.  For example, among our assets there are a large number of Internet sites where customers receive various information and services.  As part of a project to improve and develop our web projects, we, among other things, create products that can be useful to other developers.  Today we would like to present the first of them - Histone template engine, which is an opensource project distributed under the Apache Software License 2.0.  But first things first. <br><br><h5>  What is Histone? </h5><br>  Many of you use different template engines when creating web applications.  The situation when you need to generate some HTML code from a data set in a certain format using a template that sets transformation rules is ubiquitous.  Several years ago, template engines were actively used to generate HTML-code on the server ( <a href="http://www.smarty.net/">Smarty</a> , <a href="http://freemarker.sourceforge.net/">FreeMarker</a> , <a href="http://velocity.apache.org/">Velocity</a> ), today it is becoming more and more necessary to generate HTML-code directly in the browser.  Examples of such template engines include: <a href="http://code.google.com/p/trimpath/wiki/JavaScriptTemplates/">TrimPath templates</a> , <a href="http://mustache.github.com/">Mustache</a> , <a href="https://developers.google.com/closure/templates/">Google Closure Templates</a> , etc. <a name="habracut"></a><br><br>  With all the variety of solutions designed to work on different platforms, there are not so many template engines that could be run simultaneously on the server and in the web browser.  Each of them has its pluses and significant drawbacks.  Some of these disadvantages, in our opinion, are critical, which does not allow you to fully enjoy all the benefits of a template engine that works both on the server and in a web browser. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The project ‚ÄúHistone‚Äù is an attempt to create a new open-source cross-platform template engine in implementations for Java, JavaScript and PHP.  Before we started developing our own solution, we examined the advantages and disadvantages of the already existing cross-platform templating engines.  We analyzed only popular template engines that are widely used for building modern web applications, and did not consider solutions that do not have at least two of the three implementations of interest (Java, JavaScript, PHP). <br><table><tbody><tr><td></td><td>  <strong>pros</strong> </td><td>  <strong>Minuses</strong> </td></tr><tr><td>  <strong>Google Closure Templates</strong> </td><td>  - Template source code is compiled into JavaScript, <nobr>which speeds up its processing.</nobr> </td><td>  - To use the template, it is necessary to pre-process it using a special utility.  This greatly complicates the development of browser-based applications, since when you make any changes to the template, it must be recompiled. <br><br>  - Too complicated syntax of templates that will be clear to programmers, but will inevitably cause difficulties for template designers. <br><br>  - A complex mechanism for creating your extensions.  It does not allow to increase the functionality of the JavaScript version, which makes the extension mechanism inapplicable in the case of cross-platform use of templates. <br><br>  - No PHP version <br></td></tr><tr><td>  <strong>Mustache</strong> </td><td>  - Exists in all possible variations for a variety of programming languages. </td><td>  - Unconventional syntax, difficult to understand template designers. <br><br>  - The template language lacks a number of important constructions, which makes the use of this template system impossible (at least, non-trivial) in the context of some projects. <br><br>  - The extension mechanism is very poorly documented. <br></td></tr></tbody></table><br>  After analyzing the existing products, our team decided to create a new template engine that would have the best sides of the products listed above, as well as correct the disadvantages and shortcomings that are critical for us.  As a result, a list of the main ideas that formed the basis for the development was formed: <br><br><ul><li>  <strong>One template is a set of template implementations.</strong>  The syntax of the template is independent of the programming language used to process it.  This is necessary so that the same templates can be processed both on the server and in the browser and thus receive the same result. <br></li><li>  <strong>Traditional and intuitive syntax.</strong>  Constructions processed by the template engine are placed between the {{and}} delimiters, everything else falls into the result of processing the ‚Äúas is‚Äù template. <br></li><li>  <strong>The inability to execute code directly from the template.</strong>  Many template engines can execute the code of the corresponding programming language directly from the template.  This does not allow the use of such a template with code inserts of a specific language in implementations in other languages.  Therefore, this possibility in Histone is completely excluded. <br></li><li>  <strong>Easy to expand.</strong>  Regardless of the programming language used to process the template, the provided API allows you to add a new function or property to use it in the template in order to meet the needs of any project. <br></li><li>  <strong>The ability to use a single data source for templates processed on different platforms.</strong>  The universal data format, for which support in Histone there is everything you need, is JSON.  Regardless of what type of data type the implementation language has, the template language allows you to work with a subset of the data types defined for the JSON format. <br></li><li>  <strong>Providing the template with information about the environment in which it is running.</strong>  The template is provided with specific information about the platform on which it is processed.  For example, in the case of processing in the browser, the template is available information about the screen resolution or the size of the browser window, and in the case of processing on the server, the template can get information about the operating system or server request headers. <br></li><li>  <strong>Cross-platform and easy porting.</strong>  Implementations for JavaScript, Java, and PHP are available out of the box.  Eliminating the use of specific external libraries along with the logical organization of the code allows for porting the Histone implementation to any other programming language, for example, C ++, Ruby, Objective-C, ActionScript, etc. <br></li><li>  <strong>Performance.</strong>  Unlike Google Closure Templates, Histone does not convert the template code into the source code of the programming language in which it is planned to be processed.  Instead, it is possible to compile the template source code into a form that will be executed using the special utility included in the product, bypassing the parsing and parsing stage (the most expensive operation).  In addition, at this stage, those parts of the template that do not depend on functions, properties, and variables defined externally are executed. <br></li></ul><br><h5>  Architecture </h5><br>  As part of the template engine, three interrelated components can be distinguished: <br><br><ul><li>  <strong>Lexical analyzer.</strong>  Parses a template string into tokens (sequences of characters of the source string, combined into groups).  Created using the regular expression engine built into the implementation language. <br></li><li>  <strong>Syntactical analyzer.</strong>  Parses a template string, which results in an abstract syntax tree reflecting the syntactic structure of the input sequence.  Created using recursive descent algorithm. <br></li><li>  <strong>Interpreter.</strong>  Executes instructions of the abstract syntax tree, during which the result of template processing is generated.  The most important part of the template engine that performs arithmetic operations, function calls, reading properties, etc. <br></li></ul><br>  Obviously, the use of a lexical analyzer based on regular expressions and a recursive descent parser is not the most effective approach to building systems of this kind, but this is justified by the fact that our primary task was to ensure the maximum speed of the template interpretation process.  Since in real conditions, working with the source code of templates will occur only during the project development process, while a web application in public access may use abstract syntax trees of templates instead of their source code, thereby completely excluding lexical analysis and parsing. <br><br><h5>  Pattern Syntax </h5><br>  A template is a text document with inserts of special template tags, the contents of which will be executed by the template engine during template processing.  Template tags are constructs of the template language, enclosed between {{and}} characters.  Fragments of a text document outside these characters will be transferred to the result of the template processing without changes. <br><br>  <strong>Basics of syntax</strong> <br><table><tbody><tr><td>  <strong>Description</strong> </td><td>  <strong>Example</strong> </td></tr><tr><td>  Comments </td><td>  {{* comment *}} </td></tr><tr><td>  Preventing processing </td><td>  {{% {{2 * 2}}%}} </td></tr><tr><td>  Displaying property or variable values </td><td>  {{myValue}} <br>  {{myProp.foo.bar}} <br>  {{myObject ["foo"]. bar}} <br></td></tr><tr><td>  Calling Functions and Macros </td><td>  {{loadText ("file.txt")}} <br>  {{global.min (10, 20, 30)}} <br>  {{myMacro ("foo", "bar")}} <br></td></tr><tr><td>  Method call </td><td>  {{"String" .toUpperCase ()}} <br>  {{123.isNumber ()}} <br></td></tr></tbody></table><br>  <strong>Data types</strong> <br><table><tbody><tr><td>  <strong>Description</strong> </td><td>  <strong>Example</strong> </td></tr><tr><td>  Value not defined </td><td>  {{undefined}} </td></tr><tr><td>  No value </td><td>  {{null}} </td></tr><tr><td>  Boolean </td><td>  {{true}} <br>  {{false}} <br></td></tr><tr><td>  Numbers </td><td>  {{ten}} <br>  {{3.14}} <br>  {{12E-4}} <br></td></tr><tr><td>  Strings </td><td>  {{"String"}} <br>  {{'string'}} <br></td></tr><tr><td>  Arrays </td><td>  {{[1, 2, 3]}} <br>  {{["Foo": "bar"]}} <br></td></tr></tbody></table><br>  <strong>Operations</strong> <br><table><tbody><tr><td>  <strong>Description</strong> </td><td>  <strong>Example</strong> </td></tr><tr><td>  Addition </td><td>  {{10 + 2}} </td></tr><tr><td>  Subtraction </td><td>  {{10 - 2}} </td></tr><tr><td>  Multiplication </td><td>  {{10 * 2}} </td></tr><tr><td>  Division </td><td>  {{10/2}} </td></tr><tr><td>  Remainder of the division </td><td>  {{10 mod 2}} </td></tr><tr><td>  Unary minus </td><td>  {{-ten}} </td></tr><tr><td>  Equally </td><td>  {{10 is 10}} </td></tr><tr><td>  Not equal </td><td>  {{10 isNot 2}} </td></tr><tr><td>  More </td><td>  {{10&gt; 2}} </td></tr><tr><td>  Less </td><td>  {{2 &lt;10}} </td></tr><tr><td>  Greater than or equal to </td><td>  {{10&gt; = 2}} </td></tr><tr><td>  Less than or equal to </td><td>  {{2 &lt;= 10}} </td></tr><tr><td>  Logical "OR" </td><td>  {{true or false}} </td></tr><tr><td>  Logical "and" </td><td>  {{true and false}} </td></tr><tr><td>  Logical "NOT" </td><td>  {{not true}} </td></tr><tr><td>  Ternary operator </td><td>  {{true?  true: false}} </td></tr></tbody></table><br>  <strong>Constructions</strong> <br><table><tbody><tr><td>  <strong>Description</strong> </td><td>  <strong>Example</strong> </td></tr><tr><td>  Variable declaration </td><td>  {{var myVar = 10}} <br><br>  {{var myVar}} <br>  ... <br>  {{/ var}} <br></td></tr><tr><td>  Condition </td><td>  {{if true}} <br>  ... <br>  {{elseif 42}} <br>  ... <br>  {{else}} <br>  ... <br>  {{/ if}} <br></td></tr><tr><td>  Cycle </td><td>  {{for value in values}} <br>  ... <br>  {{/ for}} <br><br>  {{for key: value in values}} <br>  ... <br>  {{/ for}} <br></td></tr><tr><td>  Macros </td><td>  {{macro myMacro (arg1, arg2)}} <br>  ... <br>  {{/ macro}} <br></td></tr><tr><td>  Import template </td><td>  {{import "common.tpl"}} </td></tr><tr><td>  Calling a function or macro </td><td>  {{call myProc ("arg1", "arg2")}} <br>  arg3 <br>  {{/ call}} <br></td></tr></tbody></table><br><h5>  Conclusion </h5><br>  In this article we have tried to briefly describe the main features of the new cross-platform open source template engine.  You have become familiar with the internal structure and basic syntax of patterns.  If you are interested in a detailed description of the technologies on the basis of which Histone works, we will be able to tell it in the next post, in which we will look at how the lexical analyzer we use works. <br><br>  You can take an active part in the development of the project and apply it in your resources.  Our team will be happy to answer all your questions. <br><br><h5>  Links </h5><br><ul><li>  <a href="http://weblab.megafon.ru/histone/">Project website</a> </li><li>  <a href="http://weblab.megafon.ru/wiki/pages/viewpage.action%3FpageId%3D688223">Documentation</a> </li><li>  <a href="http://megafonweblab.github.com/histone-javascript/">Online console</a> </li><li>  <a href="https://github.com/MegafonWebLab">Source</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/151061/">https://habr.com/ru/post/151061/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151052/index.html">How to write call-to-action that will increase the conversion (with examples)</a></li>
<li><a href="../151055/index.html">200,000 corrupted files signal: backup strategies can be improved</a></li>
<li><a href="../151056/index.html">Terabyte is not the limit. Recovering data of extra-large volume on the example of a damaged Microsoft SQL Server database</a></li>
<li><a href="../151058/index.html">Bring robots to YaC 2012</a></li>
<li><a href="../151060/index.html">We read from the screen beautifully</a></li>
<li><a href="../151062/index.html">Should I pay for Apache Hadoop?</a></li>
<li><a href="../151064/index.html">Unix as IDE: Files</a></li>
<li><a href="../151065/index.html">Accident history: as one data center stood 8 hours</a></li>
<li><a href="../151066/index.html">Do you remember the conditions and prices of your tariff plan?</a></li>
<li><a href="../151069/index.html">Asus G55VW laptop video review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>