<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Netflix Best Practices for Moving from Oracle DB to Amazon SimpleDB</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is a partial translation of the Netflix article; it concerns only problematic transitions from Oracle DB to Amazon SimpleDB and how the company r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Netflix Best Practices for Moving from Oracle DB to Amazon SimpleDB</h1><div class="post__text post__text-html js-mediator-article">  <i>This is a partial translation of the Netflix article; it concerns only problematic transitions from Oracle DB to Amazon SimpleDB and how the company resolves them.</i> <i><br></i> <br>  Around the end of 2008, Netflix had only one data center.  And this DC has put before us a few questions.  As the only point of failure, for example, due to problems with electricity, it could lead to dissatisfaction of our users with the service.  In addition, with the simultaneous growth of streaming traffic and subscriptions to services, Netflix would soon outgrow this data center - we saw an inevitable need for electricity, better cooling, we needed more space and more equipment. <br><br>  Alternatively, it was possible to build new data centers.  However, besides the high costs, this effort would have resulted in our technical staff not being able to deal with new products, so they would be busy expanding the DC.  In addition, we understood that managing multiple data centers is a difficult task.  Building and maintaining multiple data centers seemed like a dangerous distraction from our core business. <br><br>  Instead of taking this path, we chose a more radical one.  We switched to the IAAS (Infrastructure as a Service) solution offered at that time by the Amazon web service.  With a multitude of data centers already operating, multiple redundancy levels of various services (such as S3 and SimpleDB), AWS promised better availability and scalability in a relatively short time. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Putting various networking and background tasks into outsourcing, Netflix focused on its core business, delivering movies and TV shows. <br><br>  In the process of transition to the AWS infrastructure, we formulated a set of best practices needed to work with <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B0_CAP">AP</a> systems such as SimpleDB. <br><a name="habracut"></a><br><h4>  Leaving the DBMS Behind </h4><br><h5>  Partial or no SQL support at all.  In general, SimpleDB supports submultiply SQL <br></h5><br><ul><li>  Use GROUP BY and JOIN operations at the application level. </li><li>  One way to avoid having to use a JOIN is to denormalize multiple tables into one logical SimpleDB domain. </li></ul><br><h5>  Lack of connections between domains <br></h5><br><ul><li>  Implement communication at the application level </li></ul><br><h5>  No transaction <br></h5><br><ul><li>  Use the SimpleDB API: ConditionalPut and Conditional Delete </li></ul><br><h5>  No triggers <br></h5><br><ul><li>  It is possible to do without them. </li></ul><br><h5>  There is no schema support ‚Äî and besides, this is not obvious.  A request with an invalid attribute name does not cause an error <br></h5><br><ul><li>  Implementing schema validation at the application data access level. </li></ul><br><h5>  Lack of sequence support <br></h5><br><h6>  Sequences are often used as primary keys. <br></h6><br><ul><li>  In this case, it is necessary to use a natural unique key, for example, in the customer contact domain, use the client‚Äôs mobile phone as the key. </li><li>  If there are no natural keys, you must use a UUID. </li></ul><br><h6>  Sequences are also often used for order numbers. <br></h6><br><ul><li>  Use a distributed sequence generator. </li></ul><br><h5>  No operations to work with time <br></h5><br><ul><li>  You can do without them </li></ul><br><h5>  There is no support for restrictions, in particular, there are no restrictions on the uniqueness of the field, no control of the foreign key, no restrictions on the integrity. <br></h5><br><ul><li>  The application can check the constraints at the time of reading the data and correct the problem after the fact.  This is called read-repair.  Read recovery should use the ConditionalPut or ConditionalDelete API to make the changes atomic. </li></ul><br><h4>  New challenges posed by SimpleDB </h4><br>  In addition, there were features that we encountered that were specific to SimpleDB.  Here are some of them: <br><br><h5>  SimpleDB domains provide the maximum write speed, if you split the data into several domains. <br></h5><br><ul><li>  All Netflix data with a significant write load was distributed across multiple domains. </li></ul><br><h5>  No support for native data types.  All data is stored and processed as strings. <br></h5><br><h6>  All comparisons (i.e. WHERE conditions) and sorting occur only with strings. <br></h6><br><ul><li>  Store all dates in ISO 8601 </li><li>  Add zeros in front of the numbers that are used when sorting and / or WHERE comparison. </li></ul><br><h5>  Two separate API calls for DeleteAtributes and PutAttributes. <br></h5><br><h6>  How to perform an atomic operation that requires both deleting one attribute and updating another attribute in the same line? <br></h6><br><ul><li>  The simplest option is to use pseudo zeros (for example, the word NULL) instead of the DeleteAttributes operation. </li><li>  This negates the optimization of the free space of the SimpleDB tables and leads to inflating data. </li></ul><br><h5>  Using case-sensitive domain names and attributes <br></h5><br><h6>  In many DBMS, the names of tables and columns are case-insensitive, and in SimpleDB, on the contrary, in this connection, the put, delete, and select operations may not work correctly without even reporting an error.  The programmer‚Äôs task is to detect all inconsistencies in the name register. <br></h6><br><ul><li>  Accept a convention whereby you can only use domain and attribute names in upper case. </li><li>  In the application at the level of data access it is necessary to provide automatic reduction to upper case. </li></ul><br><h5>  Operations with typos in select, put, or delete attribute names can end without error notification. <br></h5><br><h6>  Unlike case sensitivity, this problem occurs due to the lack of schema checking.  Simple DB is not only a sparse database, but also without schema support. <br></h6><br><ul><li>  Implement a single point of access to the layer data in the application and implement the verification there. </li></ul><br><h5>  If you forget to specify LIMIT in select, you may need several queries in order to get all the data. <br><br></h5><h6>  Multiple requests reduce the likelihood that the site will receive all the data for the required time interval. <br></h6><br><ul><li>  The name of the single point of access to data at the application level, you can install LIMIT directly in it. </li><li>  The maximum value can be changed at any time if Amazon increases the limit. </li></ul><br><h5>  It is also necessary to bear in mind the problems of ‚Äúintegrity ultimately‚Äù ( <a href="http://en.wikipedia.org/wiki/Eventual_consistency">eventual consistency</a> ). <br></h5><br><h5>  Anti-pattern reading should be avoided immediately after writing. <br></h5><br><ul><li>  Avoid reading directly after writing. </li><li>  If this is not possible use ConsistentRead </li></ul><br><h5>  Non-indexed queries can be very expensive. <br></h5><br><h6>  Anti-pattern: SELECT * FROM MY_DOMAIN WHERE MY_ATTR_1 IS NULL <br></h6><br><ul><li>  Use a separate flag attribute with the string value TRUE or FALSE instead of checking for NULL.  Thus, the query will use the index: SELECT * FROM MY_DOMAIN WHERE MY_ATTR_1 = 'FALSE' </li></ul><br><h5>  Some queries are slow, although indexed. <br></h5><br><h6>  Index selectivity affects speed just like other SQL engines. <br></h6><br><ul><li>  As in other databases, the performance of queries for sampling data is determined by the selectivity of the indices specified in WHERE.  Make sure that you understand the selectivity of your indexes and that your WHERE expression contains the best one. </li></ul><br><h5>  As with any other multi-user system, significant jumps in response time may appear. <br></h5><br><ul><li>  Protect the application against jumps in SimpleDB or S3 with a caching front-end, such as MemCached </li></ul><br>  Deciding to switch to SimpleDB and S3, Netflix very quickly migrated to the cloud infrastructure, fully armed with new aggressive product launch plans and traffic growth.  There were problems, but we coped with almost everyone. </div><p>Source: <a href="https://habr.com/ru/post/163961/">https://habr.com/ru/post/163961/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../163945/index.html">In the footsteps of MSI Master Overclocking Arena 2012</a></li>
<li><a href="../163947/index.html">Markdown markup in a RubyOnRails application</a></li>
<li><a href="../163951/index.html">Kid's Shell - a children's shell to run only authorized applications on your Android phone or tablet.</a></li>
<li><a href="../163955/index.html">Are you ready to move because of the new job?</a></li>
<li><a href="../163957/index.html">Experimental architecture of GPS trackers reduces power consumption by three orders of magnitude</a></li>
<li><a href="../163967/index.html">Creating Guest Access to the Internet with Web Authentication</a></li>
<li><a href="../163969/index.html">High-Load cluster organization with several nodes</a></li>
<li><a href="../163971/index.html">Review of the smartphone Meizu MX2</a></li>
<li><a href="../163973/index.html">Ahead of their time</a></li>
<li><a href="../163975/index.html">Solving a recursive logic puzzle in Oracle SQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>