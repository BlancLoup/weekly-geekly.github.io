<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Artisto: experience of launching neural networks in production</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Edward Tiantov ( Mail.ru Group ) 
 My name is Eduard Tiantov, I am engaged in machine learning in the company Mail.ru Group. I will tell you about the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Artisto: experience of launching neural networks in production</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/3e2/660/34e/3e266034ecd908a912c3425fbb1db92f.jpg"><br><br><h2>  Edward Tiantov ( <a href="https://habrahabr.ru/company/mailru/">Mail.ru Group</a> ) </h2><br>  My name is Eduard Tiantov, I am engaged in machine learning in the company Mail.ru Group.  I will tell you about the application of <strong>video styling using</strong> Artisto <strong>neural networks</strong> , about the technology that underlies this application. <br><br>  Let me give you a couple of facts about our application: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <strong>1st</strong> mobile video styling app in the world; </li><li>  Unique video stabilization technology; </li><li>  Application with technology developed for <strong>1 month</strong> . </li></ul><a name="habracut"></a><br>  Firstly, this is the very first video styling application in the world.  Before that, there were only startups like deepart.io - the company still exists and offers, for example, to convert 10 seconds.  video for 100 euros.  And we offer all users to do it absolutely free of charge online, unlike deepart.io, which do it offline. <br><br>  Secondly, we have a unique video stabilization technology.  We have been working on this for a very long time, because if we take technology for a photo and try to apply it for video, various problems arise that greatly degrade the quality of the video.  I will talk about this in detail. <br><br>  And third, we are just one month from the moment we sat down to develop the technology to the moment when the application came out in the stores.  It took only one month, which is quite fast. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b1/30c/f72/1b130cf7274df8100205b3b20d006ac6.png"><br><br>  Raise your hands, which of you are aware of convolutional neural networks?  Quite a lot of people, but still half, so I‚Äôll dwell on this in sufficient detail so that everyone can understand what is happening. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/60b/cf1/1b8/60bcf11b877c729a9b0cec7cd76f2f6c.png"><br><br>  A bit of history.  Scientists have been trying to understand how our brain works for quite a long time, and in the 60s they offered a mathematical model called ‚Äúmultilayer perceptron‚Äù, where neurons are combined into layers and all neurons are connected with adjacent layers by ‚Äúeach with each‚Äù connection.  Technically, learning such a network means defining these weights, and such a network can reproduce any dependencies between data. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/rZxUHU_xGmY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  In the 74th year, we learned how to train them more or less effectively by the method of back propagation of error.  This method is used to this day, naturally, with some improvements.  Its essence lies in the fact that we take at the output what our network gives, compare it with what should be, with the true value on the sample, and based on this difference, errors, we change the weights in the last layer.  And then we repeat this procedure layer by layer, as if spreading the error from the end of the network to the beginning.  So these networks are trained. <br><br>  In the 90s, Yang Li Kun (he is now the head of the Facebook FAIR research laboratory) was actively working on creating convolutional networks.  In 1998, he released a paper where he explained in detail how such networks could be used to recognize handwritten numbers on checks, and some banks in the USA applied this technology in practice.  But then this technology of convolutional networks did not receive much popularization due to the fact that it was necessary for a long time and it was difficult to train them, and a lot of calculations were needed.  The breakthrough happened much later, and I will tell about it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/005/db8/78e/005db878e30d9d4bf090ee836f452c4b.png"><br><br>  Let's discuss in detail what a convolution network is.  It got its name from the convolution operation, oddly enough.  Its meaning is as follows - we take an RGB image (or you can gray scale), these are 3 channels, 3 matrices.  We run these matrices through convolution.  The convolution, as shown below on the slide, is a 3 x 3 matrix in this case, which we move in the image and elementwise multiply the weights on this convolution by the corresponding numbers and add, we get the corresponding positions, certain numbers.  It turns out that we converted the input matrix to the output one.  This output matrix is ‚Äã‚Äãcalled feature maps.  And, if you say that the convolution graphically encodes, it encodes some signs on the image.  These can be, for example, sloping lines.  Then in the feature map we will have information on where, in which places this oblique line is on the image.  Naturally, in the convolutional neural networks of these convolutions are very, very many, thousands, and they encode various signs.  What is most remarkable about this is that we absolutely do not need to ask them, i.e.  they learn themselves in the process of learning. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/842/a2d/60c/842a2d60c8928882f79220a3c838ead3.png"><br><br>  The second important block is pooling or subsampling.  It is recognized to reduce the dimension of the input matrix, the input layer.  As shown in the figure, we take a 4 x 4 matrix and take 4 maximum elements each, i.e.  we obtain a matrix of 2 x 2. So  we essentially reduce, namely 4 times, all subsequent calculations.  This also, as a bonus, gives us some resistance to the movement of turns of objects in the picture, because in convolutional neural networks there are many pooling operations.  As a result, by the end of the network, the spatial coordinates are slightly lost, and some independence from the position is obtained. <br><br>  If we see what a convolutional network learns, it will turn out quite interesting.  This network studied on the faces: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f6/e6b/550/5f6e6b550ad14cd82c463c83c32167fd.png"><br><br>  And we can see that on the first convolutional layer the neural network learns the simplest primitives - various gradients, lines, often colors, i.e.  base primitives.  We know for sure at the moment that our visual cortex of the brain - visual cortex - works in the same way, respectively, the network emulates our brain. <br><br>  Further.  It turns out that as we move through the network, the signs that the network allocates become more complicated and more complicated.  Based on the first layer, the second layer already recognizes some parts of the face - eyes, ears, etc.  And already the last layer builds whole models of faces.  We get the hierarchy of features - the closer to the end of the network, the more complex the objects we can detect on the basis of simpler at first. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5af/7f7/511/5af7f7511099ea8f802dcd74aead7824.png"><br><br>  The main progress in computer vision occurred within the framework of the ImageNet Challenge.  ImageNet is such a base of photos, marked up by hands, there are about 10 million of them. It was specially created for researchers from all over the world to compete and progress in this computer vision. <br><br>  There is a popular challenge - since 2010, competitions are held annually, there are many different categories and the most popular is the classification into 1000 image classes.  Among the classes are many animals, different breeds of dogs, etc.  In 2012, for the first time in this competition, the convolutional network won, its author Krizhevsky (Krizhevsky A.) was able to put all the calculations on the GPU, there are quite a lot of them and because of this, he was able to train a 5-layer network.  At that time, it was a significant breakthrough, both for convolutional networks and computer vision, because it significantly reduced the error. <br><br>  The error there is measured by top 5, i.e.  the network gives 5 possible categories, which is depicted in the picture, and if at least one matches, it is considered a success.  What is very interesting - scientists have measured how many people are mistaken in this challenge.  They planted people, gave them the same markup data, and it turned out that the error was about 5%.  And modern convolutional networks have an error of about 3.5%.  This does not quite mean that neural networks work better than our brains, because they were sharpened specifically for these thousands of classes, and people do not always distinguish the breeds of dogs, and if you plant a person and teach these classes, then naturally it will be better but, nevertheless, the algorithm is very, very close. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d98/a7a/ebe/d98a7aebe222a81680a2832325431e09.png"><br><br>  Consider the popular architecture.  In this case, it is VGG.  This is one of the winners of 2014.  It is very popular, and popular because the followers trained it posted on the network, and everyone could use it.  It looks, it seems, difficult, but in fact it is just a block, each block is convolutional.  These are several layers of convolutions and then a pooling operation, i.e.  image reduction.  And this is how it repeats 5 times, 5 pooling happens.  At the end, our convolutions already see an image of 14 x 14, and the number of filters near the end increases.  Those.  if we first have 32 filters that recognize primitives, then at the end of the network we already have 512 filters that recognize some complex objects, maybe chairs, tables, animals, etc.  Further in this network are fully connected blocks that perform purely classification into these 1000 classes based on these features. <br><br>  This pre-trained network is used in many tasks, because these features that the network highlights can be used in many tasks in computer vision, including for styling photos. <br><br>  Let's go to this topic.  How to transfer the style to the photo? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b89/97c/fba/b8997cfba0f51cd9db14290e4db053e4.png"><br><br>  First, what do we want to be extremely clear?  We want to take a photo, in this case it‚Äôs a city, and take some style, for example, Van Gogh‚Äôs ‚ÄúDe sterrennacht‚Äù and try to redraw the original content image in this style.  And get a piece of art, as they say.  It seems incredible, but in the modern world it is possible.  Those.  we no longer need any artist for this, we can do it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b3b/a4c/07d/b3ba4c07dc3041dc2f4deb74eb1b69f3.png"><br><br>  A little bit of history.  In September 2015, Leon Gatis published an article in which he told how to do this, came up with.  Its only drawback was that this algorithm was quite slow, and because of this wide practical application for the end user at that time did not receive. <br><br>  In March 2016, two articles were published with the idea of ‚Äã‚Äãhow to speed up all this processing, and the first of them was our compatriot from Skoltech - Dmitry Ulyanov suggested how this can be done first. <br><br>  And then after a couple of months Prisma comes out, gets a resounding success, and after a month and a half Vinci is launched from Vkontakte for photo styling, and from us - Artisto for styling video exclusively at that time. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ac/c8f/18c/3acc8f18c5521e8db0bc51222595b3a7.png"><br><br>  How can all this be done?  Let's start with the first article Artistic Style.  How do we recover content?  Those.  we need to mix the content picture and the style one in some way.  First we need to try to restore the content.  What are we going to do for this?  We will take our VGG network, which I mentioned earlier, and use it as a feature extractor, i.e.  We will consider it as a way to extract features from the image.  We run the picture through this network and get at the output hierarchical information in these feature maps, which tells us that it is located on this image.  Accordingly, we can get rid of any other image, for example, noise, get some numbers, these feature maps, and we can already compare them to each other, i.e.  Now we can compare pictures numerically. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b3/b2c/721/8b3b2c72187b9dd45610a3db9793e8b1.png"><br><br>  What algorithm proposed Gatis.  He proposed such an optimization algorithm - we start with noise, this is our canvas, to which we try to draw a picture that will be similar to the content one.  We run it through the network, get the signs and compare how similar they are to the content features of our target image.  We measure the error.  Naturally, at first it is huge, because nothing worked there on the noise, there are no objects.  And this error by the reverse propagation of the error ‚Äî back propagation is driven by the algorithm over the network.  But we do not change the network ourselves, i.e.  it is fixed, and the error comes to us in the beginning, in the image.  And we replace on the basis of the error at the output the image itself, i.e.  redraw.  So we repeat n iterations. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/042/06e/d3b/04206ed3b0509672b17172bd01ad5fc0.png"><br><br>  And if you look after 1000 iterations, how the restoration takes place, then we see that quite well we were able to restore the original content image using this algorithm.  We see, of course, that the colors are lost. <br><br>  If you look at the last pictures, these are just the last layers, layer 4.2 was taken here, this is one of the last layers.  If you look closer, bring the picture closer, you can see that in addition to colors, some spatial coordinates are lost, i.e.  floated image borders. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/817/d27/1b2/817d271b25f169e055230a32202c29a3.png"><br><br>  This happened for obvious reasons, because we have pooling in our network, we compress and compress the image, and in the end we know that, for example, the house is located there, but we only approximately understand where it is located in the picture.  If you try to restore these layers, it will turn out so inaccurate. <br><br>  If, on the contrary, to take advantage of the early layers, then there is already almost no information is lost, and everything is restored very well.  Here you can figure out that in order to mix the style with the content, we better use the latest layers, which are not so precisely restored, because we don‚Äôt need to accurately restore the picture, we need to redraw it in the style. <br><br>  Moving on to the most interesting, how can you still transfer the style?  And what is style in general? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb1/099/aff/fb1099affa09a1dc0f53358a098589a8.png"><br><br>  It seems that style is such strokes, colors.  That is what I want to transfer.  If we take the exact same algorithm and try to restore the style, then we have objects that were in the style image, will be in the same places.  Accordingly, the first thing we need to do and, in fact, the only thing is to get rid of spatial coordinates.  Naturally, if we get rid of the coordinates, then we can somehow convey the style. <br><br><blockquote>  <font color="gray">By the way, we posted in open access the video of the last five years of the conference of developers of high-loaded systems <a href="http://www.highload.ru/">HighLoad ++</a> .</font>  <font color="gray">Watch, learn, share and subscribe to <a href="https://www.youtube.com/user/profyclub">the YouTube channel</a> .</font> </blockquote><br>  There are two options for how to do this.  More precisely, there are several, I will tell simple, to understand, and difficult. <br><br>  You can simply take the feature map.  We fixed some layer on which we want to restore the style, let's say, some earlier from the 2nd block.  We take and average the spatial coordinates.  Those.  Got such a vector mean.  How can this be understood?  Those.  it will really restore the style, we will see it now.  Why will it recover?  You can, for example, assume that some of the convolutions, for example, encodes the sign of the presence of a star in the image.  We have n stars on ‚ÄúDe sterrennacht‚Äù, say, 10. If we have only 2 stars in the optimization process, and there are 10 stars there, then comparing these means will help us understand that we need to draw another star, to make the sky more stellar . <br><br>  A more complicated way is to take and multiply all these feature maps between each other in pairs and get so-called.  covariance matrix.  This is such a generalization of the variance for the multidimensional case, i.e.  in the first case, we had an average, and this, we can assume that the variance.  And since  Since the dispersion contains information about the relationships between the filters, then experimentally it works better. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0d0/b32/27d/0d0b3227da2fe9763d119bd2385fafbb.png"><br><br>  And our algorithm does not change much, i.e.  we also fix some layer from which we want to restore the style, or layers.  We run our style image through the network.  We get some kind of feature map, from it we get a covariance matrix and do the same with our canvas, with noise and compare not the feature map, but these matrices.  And in the same way we drive the error back.  And it turns out well. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/58c/d20/00d/58cd2000dc18bdcc34824a0842635c7b.png"><br><br>  What do we see here?  This is Van Gogh-style noise.  Colors, strokes - everything passed. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2e6/e01/d47/2e6e01d4751e58307d20949b361a3777.png"><br><br>  If we play with different layers, we will see that for example, on the 1st layer there is still not enough information about the style, there are only colors: yellow, blue, black.  And the further we add layers, for example, if we add the 2nd and 3rd, then there, in principle, the style is very well conveyed.  If we add from the last layers that recognize objects, then we will start to get out all kinds of towers, images, but they completely lose their coordinates, of course.  But, nevertheless, it is obvious that it is preferable to take from the first layers, which convey precisely the style itself. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0f7/e85/840/0f7e858407f5202035345ae279d3a646.png"><br><br>  Now that we have 2 technologies for restoring style and content, we‚Äôd like to mix them up somehow to better mix these 2 images.  How do we do it?  Again, we fix the style, we get a covariance matrix from it, remember, right?  We take the content image, we retrieve from it feature map, we fix. <br><br>  And now our noise is chased away, we get both.  And in a certain proportion we compare.  Those.  we compared 2 covariance matrices, 2 feature map, we got some kind of error, we weigh it with some weights, for example, we say that the style is 10 times more important than the content, and we hope that the objects will remain on their places, but will be redrawn in the style we need. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ce/52b/68a/2ce52b68af023e52b0e9e5a8f5669198.png"><br><br>  And, about a miracle, it really happens, this picture from the article excited the entire public in deep learning.  It was a breakthrough.  And it allows you to stylize any image without an artist. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/723/1b9/7ec/7231b97ec6506f5bcdb4884bd06e1e1d.png"><br><br>  So, if to summarize, then this algorithm allows us to mix any 2 pictures, no matter what.  At least 2 photos.  It does not require any training, only optimization here, so you can experiment quickly enough, select the necessary parameters and, in general, get some kind of result very quickly.  The code on all popular libraries for deep learning is, you can choose any one that is most appropriate.  But the biggest fat minus is that all this is very long time calculated for online, i.e.  if it is 5 minutes on the CPU, if it is modern on the GPU, then it is about 10-15 seconds.  Another photo you can try to shove somehow online, for video - no. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/994/bcb/706/994bcb70695df65934cf3f62bda7b3fa.png"><br><br>  And Dmitry Ulyanov a little later suggests how this can all be greatly accelerated.  The idea is simple and elegant - just take and teach the network to stylize any image.  Do not engage in any optimization, but simply filed any picture, the network somehow digests it and produces a stylized image. <br><br>  It sounds easy.  How do we do this? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cd9/017/71e/cd901771ec5e4ea78fa0d30820ea03c8.png"><br><br>  Again, we fix the style image, the covariance matrix of it, the content image and its attributes, and now we have a difference here.  We need to stylize any image.  Accordingly, we take some dataset, we will train the network.  We take a dataset of some kind of photo.  It is desirable for our application to take photos that users will actually upload, and not some abstract ones.  For example, photos of people - users love to take pictures of people, themselves, there they must necessarily be, in order to be able to draw a network on them specifically.  After that, we take some image from this dataset, run it through our new network-generator, or transformational network, which we must style down the image.  Initially, when we initialize it, it gives out some noise, but over time it will be trained and produce some kind of stylized image.  Since  we need to train the network, we need to understand how well it stylizes.  We do it the same way - we run this stylized image through the network, get the data we need and compare it with the content and style we want.  Again, some proportions.  And we run this error back and no longer optimize the image, but we train the network itself.  And so we go on this dataset, and after tens of thousands of iterations the network learns to stylize the image. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8a8/cfa/155/8a8cfa1553e2764fca6f016782eb554d.png"><br><br>  This is an example from Ulyanov‚Äôs article of his network-generator.  Here, interestingly, the image is fed to the input of the network in several resolutions, then it is run through a set of convolutions, and we get that the network averages stylization at different resolutions.  Such an interesting idea. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2f/101/10a/e2f10110aac6394dcdf884665167d834.png"><br><br>  And if to summarize, a huge plus is that only 1 run through a trained network is required.  On a GPU, this is quite fast, in tens of ms this is measured, depending on the network itself or the input resolution of the picture.  This, of course, is not free.  We pay for it, because we need to train a separate network for each style, the networks are trained for a long time, but in this task it is still acceptable - several hours, because usually the networks, the same VGG, are trained, for example, a week.  Here we have to experiment, and they will need to be carried out a lot, we need a few hours on modern maps.  And at the time of how we were developing, the code was only from Ulyanov, it was on Torch, it was a Facebook library, it was on Lua, which is somewhat unusual for machine learning specialists, because everyone is used to Python, mostly.  And here a certain threshold is required. <br><br>  The theory we reviewed, everything seems to be great.  Everything should work out.    .  ,     . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/21c/77e/9ba/21c77e9baebc01cbd54f80a6131f0e4c.png"><br><br>      ,       ,               .    ,   ¬´¬ª    Google   ¬´¬ª.    ,        .   ‚Äì         ,        ,       HighLoad. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/81e/b22/3bc/81eb223bcb5a1e93c162570e94385d78.png"><br><br>        (..      )    ,    -    . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/594/d26/750/594d26750c182d0260ae8f3aa1f6fb17.png"><br><br>  Those.  ,  ,  -  ,    , .   , ,   .        ,       ,      ,      ,      . <br><br>         .     100   , ..            ,    .         ,  100  -   . :      . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b8d/ae4/96c/b8dae496c07fee12a665dd8328ee95ce.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next, we pin our hopes on the creation of Ulyanov - on the neural network, which immediately stylizes. What do we want to take? Take a photo of a girl, take a beautiful mosaic style and get excellent styling. These are our expectations. But they are broken about the harsh reality. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/81f/7c5/492/81f7c549207862aec512e3265c18b983.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We see that no matter how hard we twist the parameters, no matter how hard we try, the girl either bridges the entire texture, or she bugs the eye, or, in general, some cracks and wrinkles on the face. No matter how much we spin, these are still the best results, they were much worse, believe me.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/efb/497/4dd/efb4974dd08f03797ec3fc8895f5c586.png"><br><br>     , ..    , -, -      ,   .       .      ,       ‚Äì     ‚Äì     . , ,   .     ,   /,  ,  ,  .       ,  VGG,   , ,      -   ,    ,   ,     ,       ,  ,   ,  .      . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aa3/0e7/fb5/aa30e7fb5e87be47af2198c75d514119.png"><br><br> , ,       ,       ,   .         ,    ,  ,   . <br><br> -,     ,   -  ,    ‚Äì  1   ,     ,      ,       ‚Äì  .      ,      ,     . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea1/e52/9ea/ea1e529eaf868e5c2b4c6d33b90e8c70.png"><br><br>  ‚Äì     .     ,     ,  ,    ‚Äì    - .  ,       ,        ¬´¬ª  ,  ‚Äì  .       ‚Äì   . ,        ,  ,  ,     .       . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c54/210/21c/c5421021ccc177a309a841245a101477.png"><br><br>   ‚Äì  .    ,      ,      ,    ,         ‚Äì  ,  .    ,  , ,        .          -,   .    ,  , ,    loss, ..   ‚Äì   ,    .     .   ‚Äì   ,  - .  ,   loss,   ,     .        , ,     .    .     ,    . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b10/c4e/79c/b10c4e79c0836fe10e859f31e98bf62c.png"><br><br>     ‚Äì  .. heatmap loss.   -  layer,     - .   - . ,      512, ,  ,    ,         .    ,  ,    ,  ,    ,    .      ,   ,     ,      .     ,  ,      ,    ,    heatmap.        ,    loss   ,        ,    .    . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cd9/e8f/06c/cd9e8f06caa8ee9cc8f68dbad1811f8f.png"><br><br>  The second.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As it turned out, the developer of machine learning can spend a couple of days to bring this style that we need to the ideal, or you can take a designer, take a photoshop and start controlling the style by changing the style image itself.</font></font> Those.   ,  ,   .    ,    ,   ,     ,   ,      ,      ,        . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf8/96f/e56/bf896fe56ef2bf58128f10c22bf8f470.png"><br><br>  .     ,    ,    ,      ,    ,      .   ,     ,       ,   .      . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/741/137/240/741137240dab99cec201ec1f27d50fec.png"><br><br>  ‚Äì      ,     -     ‚Äì       ,      - . ,      ,      ,      90 , ,     ,        ,          ,    .        -,     ,  ,    , .   , ,          , ,      ,  .              ,   ,           ,      ,     .  So    .      . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c0/d91/49d/1c0d9149d56e75409eb9149fa53d432d.png"><br><br>  ,    ‚Äì  .. super-resolution.      ‚Äì   .     ,       ‚Äì  ‚Äì     , , waifu2x.      -,        .    ,  ,      ,    ,  ,    2   . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/687/e5c/f6d/687e5cf6d481619fd38da8eed5dde69a.png"><br><br> ,   ,  super-resolution,   waifu,  .   ,   ,   ,     waifu   ‚Äì     ,  ,  ,   ‚Äì   , ..    .      2  ‚Äì     ,   ,  , . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e53/fd9/8e9/e53fd98e94dcd56cb3cc426f16d43123.png"><br><br>     .    3  4-  ‚Äî  ,   , ..  ,     .      ,       -.  Forward. ( ). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6b0/b1b/d59/6b0b1bd59cf2db36eeba043fe31f69af.png"><br><br>    ,   ,     ,    ,   ,   ,    ,    ,         .      . <br><br>     ,    ,       . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c87/753/8f0/c877538f0e3b9a3d8640e03ed336925a.png"><br><br>    : -,  ,   .     , .   ,        ,    ,  ,    ,   .    ,   ,     .  ,    ,  ,  ,  -,     . ,    ‚Äì       loss'       .  -   loss' ,     ,     .    -  , ..    . <br><br>  e,     ,    ,     ,        ,     , : ¬´,   ¬ª,   : ¬´,    ,  ,     ,    ¬ª.  Those.  ,     . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce1/391/8ae/ce13918aee3db9cdc99e7d8cbcddecaa.png"><br><br>   .      ,   ,        .      FGLab  node.js,     - ,   .    ,  . <br><br>   ?     - ,   ,   ,        .     ,   -   - .      .      -,    ,       .  ,  -    ,     -      . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b32/28f/ae7/b3228fae7b5226f0251e08b3bac7b774.png"><br><br>   ,    -    ,     ‚Äì    . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/59f/6f5/ede/59f6f5ede1bda3b395890c0174160fbe.png"><br><br>     ?     ,    ,   .    -,     -      .     , ..    GPU.   - 20   ,  ..    ,       5. ..   -    .    Redbull ‚Äì            .       . <br><br>     .     ,        USA, ..  App Store  Play Market   2- ,  ¬´¬ª    2- . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ae/118/4c5/5ae1184c5f9762b4a903d86542da9a88.png"><br><br>   ,    .  Apple Store 1-    iTunes U ‚Äì  ,  Apple ¬´ ¬ª      ,      .    .      -      1- .     ,     ,      ,     ..       1- . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b21/f85/137/b21f851372d3c9ea2c510a559b41395d.png"><br><br>      ‚Äì PR- ‚Äì ,     nvidia      life-,      GPU Technology       .    ,      ,    PR. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f39/90b/bbe/f3990bbbe2834a85a43ba5a6298f99bb.png"><br><br>   user experience,   . -,     ,   .  Those.   - , -       ,       .       ,    ,      ,      .      ‚Äì  ,  ,  ,   ,   . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e57/2f7/b29/e572f7b29129958315f7f1af7520d4ef.png"><br><br>   ,      MSQRD  Snapchat        Artisto,      .    ICQ,  Mail.ru Group,    .          .        .  ,         , ,   ,    - ,          .         . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And in conclusion, I will say that now we live in a time when the computational power of the algorithm allows us to analyze data, train complex networks ‚Äî this is more and more penetrating into our lives. In deep learning, there is now a boom, this is a really new discovery, there is a lot of introduction of these technologies in the sphere of entertainment such as Artisto and others. But very soon it will be directly in our life in the form of manned vehicles. I‚Äôm really looking forward to medicine, when, for example, the network architectures we‚Äôve examined today can be used as is for analyzing MRI, for analyzing ultrasound, they also work fine there. Therefore, I think in the next 5 years, it will already be possible to replace expensive specialists, who are expensive and long to learn, and they are often wrong. Such technology will be able to replace.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you are interested in convolutional networks, then there is a very good Stanford course on this topic that can be read, everything is written briefly and clearly there. </font><font style="vertical-align: inherit;">So, if you want to experiment with styling, then you can drive Style Transfer into Google - there will be all the articles, all the code that you can install and try, how it works. </font><font style="vertical-align: inherit;">I am sure that as a result of my report, now you know for sure that behind these technologies of convolutional networks, in particular styling, there are fairly simple and understandable concepts, there is nothing cosmic, magic there. </font><font style="vertical-align: inherit;">All these technologies related to neural networks are very interesting to work with, fascinating and, as you saw during my presentation, it is very fun.</font></font><br><br>  Thank you very much! <br><br><h3>  Contacts </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬ª </font></font><a href="https://habrahabr.ru/company/mailru/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mail.Ru Group Blog</font></font></a> <br><br><blockquote> <font color="gray">  ‚Äî            <a href="http://www.highload.ru/%3Futm_source%3Dhabr%26utm_medium%3Dmedia%26utm_campaign%3Dhl.2017%26utm_content%3Dhl.nginx">HighLoad++</a> . <br><br>       2017- ‚Äî   HighLoad++ <br>  .        ‚Äî  ,     ! <br><br> ,        AI-,      .</font> </blockquote></div><p>Source: <a href="https://habr.com/ru/post/334530/">https://habr.com/ru/post/334530/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../334516/index.html">"Halfway": The five major news of the company ServiceNow for 2017</a></li>
<li><a href="../334518/index.html">"Pot, cook": 50 tools for managing development</a></li>
<li><a href="../334522/index.html">Introducing ITMO University: a digest of practical work</a></li>
<li><a href="../334524/index.html">What do site owners need to know in order not to lose their business?</a></li>
<li><a href="../334528/index.html">Overview Lokalise - a service for localizing applications and updating translations "by air"</a></li>
<li><a href="../334532/index.html">GeekUniversity opens a set of students to the department of Python-development</a></li>
<li><a href="../334534/index.html">Gigabit GOST VPN. Tss diamond</a></li>
<li><a href="../334536/index.html">Beginner's Guide to Progressive Web Applications and the Frontend</a></li>
<li><a href="../334538/index.html">Interview for a front-end JavaScript developer: best questions</a></li>
<li><a href="../334542/index.html">How to cross a hedgehog with a snake. We use GridView from Yii 2 in the project on Laravel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>