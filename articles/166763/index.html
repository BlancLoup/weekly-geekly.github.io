<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Solving tournament problems in Haskell</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all harazhiteli 
 Here is an article dedicated to the fairly well-known, but not very popular Haskell language. In it, I would like to sho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Solving tournament problems in Haskell</h1><div class="post__text post__text-html js-mediator-article">  Good day to all harazhiteli <br>  Here is an article dedicated to the fairly well-known, but not very popular Haskell language.  In it, I would like to show an example of solving a simple Haskell tournament problem.  I hope that this article will help novice Haskele programmers to take the first steps to writing a full-fledged program. <br><br><a name="habracut"></a><br><br>  As an example of a program, I selected a <a href="http://codeforces.ru/problemset/problem/267/A">task</a> from the Codeforces site.  This task is very simple, which means we can focus directly on the language we want to learn, in addition, Codeforces supports sending solutions in Haskell, which means that we can test our solution on their tests.  Let's start by reading the statement of the problem. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  Two numbers are given.  As long as they are both greater than zero, the same operation is performed with them: less is subtracted from a larger number.  If the numbers are equal, then another is subtracted from one.  For example, from a pair (4.17) in one operation a pair (4.13) is obtained, and from a pair (5.5) a pair (0.5). <br><br>  You are given a certain number of pairs (a <sub>i</sub> , b <sub>i</sub> ).  How many operations will be performed for each of them? <br></blockquote><br><br>  So, we need for each pair of numbers to count the number of operations on them to achieve the result.  This corresponds to the following function signature. <br><pre><code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">solve</span></span> :: <span class="hljs-type"><span class="hljs-type">Int</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> solve = undefined</code> </pre> <br>  I wrote down the implementation of the function as undefined, which will allow the program to check for compilation errors.  I leave the full implementation of the function to the readers as an exercise. <br><br>  Our program should read the input data.  The first line contains one number n, specifying the number of pairs of numbers for which you want to output an answer (calculate the value of the solve function).  Reading the number can be implemented as follows <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">main</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> nStr &lt;- getLine <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> n = (read nStr :: <span class="hljs-type"><span class="hljs-type">Int</span></span>)</code> </pre><br>  For simplicity, we will use do-notation (although <a href="http://www.haskell.org/haskellwiki/Do_notation_considered_harmful">it is considered harmful</a> ).  Those who are not familiar with this notation may still consider that it allows you to write a function in a style reminiscent of imperative.  First we read the string, then we convert it into a number and put it into the variable n.  This is an incomplete implementation of the main function, it has yet to finish writing. <br><br>  Next you need to read n lines, each of which contains a pair of numbers for which you want to output the value of the function solve.  Here it is necessary to repeat one action (count 2 numbers in a line, count the value of the function solve, display the result) n times.  To begin, we implement this action. <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">printSolution</span></span> :: <span class="hljs-type"><span class="hljs-type">IO</span></span> () printSolution = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> numsStr &lt;- getLine <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> nums = map (read :: <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span>) $ words numsStr print $ solve (nums!!<span class="hljs-number"><span class="hljs-number">0</span></span>) (nums!!<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br><blockquote>  @leventov suggested a beautiful way to read numbers using pattern matching <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">printSolution</span></span> :: <span class="hljs-type"><span class="hljs-type">IO</span></span> () printSolution = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> numsStr &lt;- getLine <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> [n1, n2] = map read $ words numsStr print $ solve n1 n2</code> </pre><br>  Notice that here I did not explicitly specify the type of the function read.  The system of Haskell types will be able to deduce it itself, since the solve function accepts parameters of the Int type, therefore it does not make much use of the code (thanks to <a href="https://habrahabr.ru/users/dima_mendeleev/" class="user_link">dima_mendeleev</a> ). <br></blockquote><br>  The function reads a line (getLine), breaks it up into parts (words), converts each part into a number (map (read :: String -&gt; Int)), and then prints the value of the solve function called with the read parameters (print $ solve (nums !! 0) (nums !! 1)).  I recommend memorizing the words and read functions, it is very convenient to use them for working with input, and indeed with strings. <br><br>  Then you need to implement a repetition of this action n times.  In imperative languages, this would be recorded in a cycle, but our language is functional, so we will resort to using recursion. <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">printNSolutions</span></span> :: <span class="hljs-type"><span class="hljs-type">Int</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">IO</span></span> () printNSolutions <span class="hljs-number"><span class="hljs-number">1</span></span> = printSolution printNSolutions n = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> printSolution printNSolutions (n<span class="hljs-number"><span class="hljs-number">-1</span></span>)</code> </pre><br>  Pass an Int type parameter to the function - the number of repetitions.  If the number is 1, then you just need to call printSolution once, but if it is greater than 1, then you need to call printSolution 1 time, and then repeat the call n-1 more times.  Values ‚Äã‚Äãof n less than 1 cannot be accessed by condition, so I do not do any additional checks on the input data either here or in other places where data entry is under way. <br><br>  All that is left to do is call the function `printNSolutions` with the argument n already read in the main function <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">main</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> nStr &lt;- getLine <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> n = (read nStr :: <span class="hljs-type"><span class="hljs-type">Int</span></span>) printNSolutions n</code> </pre><br>  Now the main function is added to the end, but you can make it a bit shorter (and again, the type of the read function can be clearly not written) <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">main</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> nStr &lt;- getLine printNSolutions $ read nStr</code> </pre><br>  Or completely abandon the do-notation <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">main</span></span> = getLine &gt;&gt;= (printNSolutions . read)</code> </pre><br><br>  That's it, we wrote a program in Haskell!  Finally, I will provide its full code (if you want to do an exercise, do not open the listing, but write the implementation yourself and test it in Codeforces) <br><div class="spoiler">  <b class="spoiler_title">Listing</b> <div class="spoiler_text"><pre> <code class="haskell hljs"><span class="hljs-keyword"><span class="hljs-keyword">module</span></span> Main <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> solve :: <span class="hljs-type"><span class="hljs-type">Int</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> solve <span class="hljs-number"><span class="hljs-number">0</span></span> _ = <span class="hljs-number"><span class="hljs-number">0</span></span> solve _ <span class="hljs-number"><span class="hljs-number">0</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> solve ab | a &gt;= b = (a `div` b) + solve b (a `mod` b) | otherwise = solve ba printSolution :: <span class="hljs-type"><span class="hljs-type">IO</span></span> () printSolution = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> numsStr &lt;- getLine <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> nums = map (read :: <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span>) $ words numsStr print $ solve (nums!!<span class="hljs-number"><span class="hljs-number">0</span></span>) (nums!!<span class="hljs-number"><span class="hljs-number">1</span></span>) printNSolutions :: <span class="hljs-type"><span class="hljs-type">Int</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">IO</span></span> () printNSolutions <span class="hljs-number"><span class="hljs-number">1</span></span> = printSolution printNSolutions n = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> printSolution printNSolutions (n<span class="hljs-number"><span class="hljs-number">-1</span></span>) main = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> nStr &lt;- getLine printNSolutions $ (read nStr :: <span class="hljs-type"><span class="hljs-type">Int</span></span>)</code> </pre><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/166763/">https://habr.com/ru/post/166763/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../166751/index.html">Lost documentation or transform: matrix3d ‚Äã‚Äã[translation]</a></li>
<li><a href="../166753/index.html">Hands-on experience of transferring resources from Flash to Unity 3D</a></li>
<li><a href="../166757/index.html">Announcement of the release of Windows Azure Media Services - cloud platform for media scenarios</a></li>
<li><a href="../166759/index.html">A competition of applications based on the Intel Perceptual SDK, with a prize pool of $ 1,000,000 (million dollars)!</a></li>
<li><a href="../166761/index.html">Digest of upcoming IT events for February 2013</a></li>
<li><a href="../166765/index.html">Video review of smartphones HTC Windows Phone 8X and HTC Windows Phone 8S</a></li>
<li><a href="../166767/index.html">Yahoo sends back parcels to former employees</a></li>
<li><a href="../166769/index.html">SVN revision number in 1C 7.7 code</a></li>
<li><a href="../166771/index.html">Print gateway based on CUPS for terminal server based on MS WS 2008 R2 and its clients based on MS Win 2k / XP with printers connected to them</a></li>
<li><a href="../166773/index.html">How to instagramm in black or watch for cookies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>