<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Android Development: Adding Text to the ProgressBar</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Standard ProgressBar , as is known, is an indicator of the performance of long processes. However, it is often used to visualize numerical values. Unf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Android Development: Adding Text to the ProgressBar</h1><div class="post__text post__text-html js-mediator-article">  Standard <a href="http://developer.android.com/reference/android/widget/ProgressBar.html">ProgressBar</a> , as is known, is an indicator of the performance of long processes.  However, it is often used to visualize numerical values.  Unfortunately, this element does not support the setText () method to put an inscription on it explaining the displayed value, which would save a lot of screen space.  Remember the address bar in a standard browser, where a green bar behind the URI displays the progress of the page loading.  How to implement this behavior? <br>  Under the cut - one of the solutions to this problem. <br><a name="habracut"></a><br>  So, setting the task: implement an element that would perform the functions of the ProgressBar with a horizontal style (style = "@ android: style / Widget.ProgressBar.Horizontal"), and would also have the ability to place text over oneself. <br><br>  Short plan of action: <br><ol><li>  Create Drawable, responsible for drawing the background. </li><li>  Create a class that extends TextView, and prescribe the necessary methods. </li><li>  Embed the created element in the Layout. </li><li>  Use item in Activity. </li></ol><br><h4>  Create Drawable </h4><br>  We need a two-layer Drawable, which will be responsible for the graphic content of the element. <br>  In the res / drawable folder, create the file background.xml with the following content: <br><br><pre><code class="java hljs">&lt;?xml version=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span> encoding=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>?&gt; &lt;layer-list xmlns:android=<span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span>&gt; &lt;item android:id=<span class="hljs-string"><span class="hljs-string">"@+id/bar_background"</span></span>&gt; &lt;shape&gt; &lt;corners android:radius=<span class="hljs-string"><span class="hljs-string">"2dp"</span></span> /&gt; &lt;gradient android:startColor=<span class="hljs-string"><span class="hljs-string">"#666666"</span></span> android:centerColor=<span class="hljs-string"><span class="hljs-string">"#111111"</span></span> android:endColor=<span class="hljs-string"><span class="hljs-string">"#555555"</span></span> android:centerY=<span class="hljs-string"><span class="hljs-string">"0.75"</span></span> android:angle=<span class="hljs-string"><span class="hljs-string">"270"</span></span> /&gt; &lt;/shape&gt; &lt;/item&gt; &lt;item android:id=<span class="hljs-string"><span class="hljs-string">"@+id/bar_value"</span></span>&gt; &lt;clip&gt; &lt;shape&gt; &lt;corners android:radius=<span class="hljs-string"><span class="hljs-string">"2dp"</span></span> /&gt; &lt;gradient android:startColor=<span class="hljs-string"><span class="hljs-string">"#cfb73f"</span></span> android:centerColor=<span class="hljs-string"><span class="hljs-string">"#635a30"</span></span> android:endColor=<span class="hljs-string"><span class="hljs-string">"#918030"</span></span> android:centerY=<span class="hljs-string"><span class="hljs-string">"0.75"</span></span> android:angle=<span class="hljs-string"><span class="hljs-string">"270"</span></span> /&gt; &lt;/shape&gt; &lt;/clip&gt; &lt;/item&gt; &lt;/layer-list&gt;</code> </pre> <br>  As can be seen from the code, the background consists of two layers: the first is responsible for the container of the scale being created, and the second is actually the scale that will characterize the displayed value.  Both are rounded rectangles filled with gray and yellow gradient.  However, the second shape is enclosed in the clip tag, which means that only part of it will be shown. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Class creation </h4><br>  The trick of the described method is that we will not extend the ProgressBar class, but the TextView class.  The key point is to create a method that draws a new background and installs a new label. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AdvancedTextView</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TextView</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    private int mMaxValue = 100; //  public AdvancedTextView(Context context, AttributeSet attrs, int defStyle) { super(context, attrs, defStyle); } public AdvancedTextView(Context context, AttributeSet attrs) { super(context, attrs); } public AdvancedTextView(Context context) { super(context); } //    public void setMaxValue(int maxValue){ mMaxValue = maxValue; } //   public synchronized void setValue(int value) { //    this.setText(String.valueOf(value)); // Drawable,    LayerDrawable background = (LayerDrawable) this.getBackground(); //  Clip,   ,   1 ClipDrawable barValue = (ClipDrawable) background.getDrawable(1); //    int newClipLevel = (int) (value * 10000 / mMaxValue); barValue.setLevel(newClipLevel); //    Drawable drawableStateChanged(); } }</span></span></code> </pre><br>  The setValue () method sets the text of an element label using the standard setText () function, and then changes the background image to match the new value.  To do this, use the setLevel () method, which is passed as a parameter from 0 (scale is not visible) to 10,000 (the scale covers 100% of the container). <br><br>  For convenience, the class also created the setMaxValue () method, which allows you to set the value corresponding to the full scale.  Thus, it is possible to determine the range of possible values ‚Äã‚Äãdisplayed by the element. <br><br><h4>  Editing Layout </h4><br>  In the res / layout folder, we modify the contents of the main.xml file, which is responsible for the appearance of the main Activity. <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ru.habrahabr.widgets.AdvancedTextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/advanced_text_view"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"160dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/background"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4dp"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Here we indicate that the background of the element will be the Drawable we created with the name background (described in background.xml), well, we don‚Äôt forget to set the id, which will be used to search it inside the Activity. <br><br>  Do not forget to correctly specify the namespace in which the AdvancedTextView class was created.  In this example, this is ru.habrahabr.widgets. <br><br><h4>  Using an item in an Activity </h4><br>  The introduction and use of an element in the program is simple and straightforward: <br><pre> <code class="java hljs">AdvancedTextView advancedTextView = (AdvancedTextView) findViewById(R.id.advanced_text_view); advancedTextView.setValue(<span class="hljs-number"><span class="hljs-number">42</span></span>);</code> </pre><br><br>  The result is this element: <br><img src="https://habrastorage.org/storage1/1b35600d/e620a0ca/0246446e/390e37b1.png" alt="image"><br><br><h4>  Conclusion </h4><br>  So, using our own Drawable to draw the background and a class that extends TextView, we were able to use the process progress bar with an explanatory inscription in the foreground. </div><p>Source: <a href="https://habr.com/ru/post/124708/">https://habr.com/ru/post/124708/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../124703/index.html">Until the Day of the system administrator - 7 days!</a></li>
<li><a href="../124704/index.html">Box2D - Physics movement cars do it yourself</a></li>
<li><a href="../124705/index.html">Logo marathon</a></li>
<li><a href="../124706/index.html">Job Digest: Development</a></li>
<li><a href="../124707/index.html">Developer Garage St. Petersburg, Ingria Business Incubator July 28, 2011</a></li>
<li><a href="../124710/index.html">From love to hate one push</a></li>
<li><a href="../124711/index.html">Business trip: getting ready (part 1)</a></li>
<li><a href="../124712/index.html">Best practices & foreign customers</a></li>
<li><a href="../124713/index.html">OS X Lion Up-to-Date Program or Free Lion</a></li>
<li><a href="../124715/index.html">Experiments on people? Why not</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>