<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>BEM layout in Ruby on Rails</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 In this article I would like to talk about the technique of layout for BEM in rail projects. I have not yet seen such manuals (except, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>BEM layout in Ruby on Rails</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  In this article I would like to talk about the technique of layout for BEM in rail projects.  I have not yet seen such manuals (except, perhaps, for <a href="http://habrahabr.ru/post/192972/">this</a> , but it is not very suitable as a guide and I will tell more about it further), so I decided to write this article.  In addition, I created a <a href="https://github.com/gkopylov/bem">gem</a> that will simplify the integration of BEM and the rail, about it and how to use it, I will write further. <br><a name="habracut"></a><br><h4>  Training </h4><br>  First you need to install the actual chop and rails.  I prefer <a href="https://rvm.io/">rvm</a> .  Follow the rvm installation instructions, and then install the rails via the command: <br><br><pre><code class="bash hljs">gem install rails</code> </pre> <br><br>  Well, or you can install rails <a href="http://railsinstaller.org/">from here</a> if you have Windows. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Then we create a new project through the command: <br><br><pre> <code class="bash hljs">rails new some_cool_project</code> </pre><br><br>  Next, add the bem gem to the Gemfile file, which is located in the root of the newly created project.  I also recommend that you add <a href="https://github.com/thoughtbot/high_voltage">high_voltage</a> and <a href="https://github.com/slim-template/slim-rails">slim-rails</a> gems.  The first will allow you to create typical pages for the typesetter without any special knowledge of rail and cut, the second - a great template engine that can significantly speed up the layout, as well as minimize the output html. <br><br>  Now we install the necessary files for the bem heme with the command: <br><br><pre> <code class="bash hljs">rails g bem:install</code> </pre><br><br>  The config / initializers / bem.rb config will be installed, in which you can change technologies (initially scss and js) and templates for generating files for each technology lib / bem / templates / scss.tt and lib / bem / templates / js.tt .  Suppose we want to use less in our project, then this technology should be entered into config / initializers / bem.rb config instead of scss: <br><br><pre> <code class="ruby hljs">BEM.configure <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|config|</span></span> config.technologies = [ { <span class="hljs-symbol"><span class="hljs-symbol">:group</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'stylesheets'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:extension</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'.less'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:name</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'less'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:css_directive</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'@import'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:css_prefix</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"'"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:css_postfix</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"';"</span></span> }, { <span class="hljs-symbol"><span class="hljs-symbol">:group</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'javascripts'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:extension</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'.js'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:name</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'js'</span></span> } ] <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br><br>  I also highly recommend installing the config for <a href="https://github.com/rails/spring">spring</a> through the command: <br><br><pre> <code class="bash hljs">rails g bem:spring</code> </pre><br><br>  This library will allow you to load the environment in the background, which allows you to quickly generate blocks. <br><br>  If you set the config for spring, then run the following command: <br><br><pre> <code class="bash hljs">spring stop</code> </pre><br><br>  This command is necessary for the subsequent reboot spring. <br><br>  Now you can begin to layout. <br><br><h4>  Layout </h4><br>  As an example for the layout, I chose the layout from <a href="http://habrahabr.ru/post/203440/">this</a> article. <br><br>  Blocks, levels and manifests are created using the bem create command.  This command accepts the following flags as input (the value of the flags must be indicated with a space after them): <br><br><ul><li>  -b creates or uses a block. </li><li>  -e creates or uses an element. </li><li>  -m creates a modifier. </li><li>  -v modifier value. </li><li>  -l creates or uses a level. </li><li>  -a creates or uses a manifest. </li><li>  -js flag to create javascripts technology files. </li><li>  -css flag for creating file stylesheets technologies. </li></ul><br><br>  You can also read information about flags and their use by running the command: <br><br><pre> <code class="bash hljs">bem <span class="hljs-built_in"><span class="hljs-built_in">help</span></span> create</code> </pre><br><br>  The create command will create the same file structure (as <a href="http://ru.bem.info/tools/bem/bem-tools/levels/">here</a> ). <br><br>  Next, create our future level in which our blocks and manifest will be connected via the command: <br><br><pre> <code class="bash hljs">spring bem create -l shared -a application</code> </pre><br><br>  It is possible and without spring: <br><br><pre> <code class="bash hljs">bem create -l shared -a application</code> </pre><br><br>  But, as I said, spring will keep Wednesday in the background, which will speed up the execution of subsequent commands. <br><br>  After executing this command, you will see messages in the terminal that levels and manifestos have been created for each of the technologies used.  In this case, shared is the level in which our blocks will be located, and application is the manifest. <br><br>  If you look in the manifest file, you will see that the shared level is connected to it by the string <br><pre> <code class="bash hljs">@import <span class="hljs-string"><span class="hljs-string">'shared/shared'</span></span>;</code> </pre><br>  There is a simple rule - levels are connected in manifests, blocks are connected in levels. <br><br>  Delete the last app / assets / application.css manifest, since we will now use the app / assets / application.less manifest <br><br>  Next, we create the blocks we need | elements | modifiers through similar commands: <br><br><pre> <code class="bash hljs">spring bem create -l shared -b clear --no-js spring bem create -l shared -b page --no-js spring bem create -l shared -b page -e head-line --no-js spring bem create -l shared -b page -e line --no-js spring bem create -l shared -b link -m menu -v active --no-js ...</code> </pre><br><br>  As you can see, I indicate the level of shared, in which the blocks will be located and the - no-js flag, since js files will not be used for these blocks. <br><br>  After executing these commands, templates will be created in which the css class we need is already registered and you just need to fill it with suitable properties. <br><br>  If you made a mistake and wrote the wrong class or included the block in the wrong level / manifest, you can always roll back by executing the reverse command to remove the block of the | modifier level element | via the bem destroy command.  It accepts all the same flags except --js and --css. <br><br>  Next, when we create the necessary modifiers | elements | we go to the html layout.  If you installed the high_voltage gem about which I already wrote, then it will be enough just to create a folder: <br><br><pre> <code class="bash hljs">mkdir app/views/pages</code> </pre><br><br>  In which will be located to us the view.  If you have read the documentation for this gem, then you will surely like the ease of connecting and displaying views.  For example, you need a layout for the ‚Äúwelcome‚Äù page.  Create the app / views / pages / welcome.html.slim view and set up the html we need there.  After launching the web server via the command <br><br><pre> <code class="bash hljs">rails s</code> </pre><br><br>  You can see the result at <a href="http://localhost:3000/pages/welcome">http: // localhost: 3000 / pages / welcome</a> <br><br>  We put all the pictures in the app / assets / images folder and replace all tags with rail helper image_tag.  We replace image addresses in less files with image-url (helper, which is provided by less-rails gems). <br><br>  Unfortunately, in the given example js is not used.  Nevertheless, the templates that are provided for it, make it easy to write the desired function and run it: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">your_function_name_initializer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// some code } $(function() { your_function_name_initializer(); }); $(window).bind('page:load', function() { your_function_name_initializer(); })</span></span></code> </pre><br><br>  Why is that?  The fact is that starting with version 4 of the rail, the turbolinks gem is used, which significantly speeds up the page display, but adds some features to the js initialization, so you have to arrange such initializations as functions and then call them on these two events. <br><br>  The final version of the transferred layout and the rail project itself can be viewed <a href="https://github.com/gkopylov/bem_with_rails_and_less_example_app">on the githaba</a> . <br><br><h4>  Alternatives </h4><br>  There are also <a href="https://github.com/verybigman/bem-on-rails">bem-on-rails gems</a> , about an article I spoke about at the beginning.  I already wanted to use it, but it has a lot of minuses at the moment, which forced me to write my gem.  Among the minuses - the inability to work normally with levels and manifests (I never managed to create two manifestos with my levels and scatter blocks on them), poorly readable code (about 4 spaces as a tab, somewhere two) and generally low quality code (there is not a single test, ugly architecture, it feels like the gem was done quite in a hurry and the code was simply thrown in there and I couldn‚Äôt run it on the rails of version 4.1 - I had to send a <a href="https://github.com/verybigman/bem-on-rails/pull/11">patch</a> ), bad documentation, and also helper of this heme then  ozhet receive such example (a simple footer): <br><br><pre> <code class="ruby hljs">= b <span class="hljs-string"><span class="hljs-string">'footer'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">content:</span></span> [{ <span class="hljs-symbol"><span class="hljs-symbol">elem:</span></span> <span class="hljs-string"><span class="hljs-string">'el'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">elemMods:</span></span> [<span class="hljs-string"><span class="hljs-string">'left'</span></span>], <span class="hljs-symbol"><span class="hljs-symbol">content:</span></span> [<span class="hljs-string"><span class="hljs-string">' ¬´¬ª'</span></span>] }, { <span class="hljs-symbol"><span class="hljs-symbol">elem:</span></span> <span class="hljs-string"><span class="hljs-string">'el'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">elemMods:</span></span> [<span class="hljs-string"><span class="hljs-string">'center'</span></span>], <span class="hljs-symbol"><span class="hljs-symbol">content:</span></span> [{ <span class="hljs-symbol"><span class="hljs-symbol">elem:</span></span> <span class="hljs-string"><span class="hljs-string">'nav-link'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">tag:</span></span> <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">content:</span></span> [<span class="hljs-string"><span class="hljs-string">''</span></span>] }, { <span class="hljs-symbol"><span class="hljs-symbol">elem:</span></span> <span class="hljs-string"><span class="hljs-string">'nav-link'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">tag:</span></span> <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">content:</span></span> [<span class="hljs-string"><span class="hljs-string">' '</span></span>]}, { <span class="hljs-symbol"><span class="hljs-symbol">elem:</span></span> <span class="hljs-string"><span class="hljs-string">'nav-link'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">tag:</span></span> <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">content:</span></span> [<span class="hljs-string"><span class="hljs-string">'  '</span></span>] }] }, { <span class="hljs-symbol"><span class="hljs-symbol">elem:</span></span> <span class="hljs-string"><span class="hljs-string">'el'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">elemMods:</span></span> [<span class="hljs-string"><span class="hljs-string">'right'</span></span>], <span class="hljs-symbol"><span class="hljs-symbol">content:</span></span> [<span class="hljs-string"><span class="hljs-string">'&lt;a href="http://ya.ru/"&gt; &lt;/a&gt;'</span></span>.html_safe] }]</code> </pre><br><br>  What clearly does not benefit readability and can confuse the typesetter. <br><br>  Nevertheless, I think that in general it is a good attempt to adapt the bem-tools to the rails. <br><br>  There are some other exotic options for embedding a node in the rails to use bem-tools natively via grunt, for example <a href="https://github.com/d-i/half-pipe/releases">half-pipe</a> .  But I considered this option very cumbersome and difficult, so I didn‚Äôt consider it seriously. <br><br>  And yet, you can, of course, use the bem-tools themselves in some separate repository, but the process of layout and transfer will be very complicated - you will need to write some (bash) script to automatically transfer and replace URLs, for example, constantly chasing the layout hither and thither.  Well, it's okay.  But worst of all, switching from branch to branch in these two repositories takes place - you need to make sure that you use the correct branch in the repository with the rails and in the repository with the layout, and then also watch which branch is running and merging its in another repository too.  Therefore, the solution is not the best. <br><br><h4>  Conclusion </h4><br>  So, the coder will simply need to rivet views and blocks with css | js without necessarily knowing what's going on inside.  And the backend developer will insert the necessary logic.  That is, the layout process is greatly simplified. <br><br>  The library (gem) bem, which I wrote, is completely open and uses the most democratic MIT license.  I wrote the library quite recently and I will be glad to receive your feedback and suggestions, as well as pullrequest to github. <br><br>  I wrote quite briefly about everything, for each item you can still write a lot of explanations and arguments, so if you have any questions, I will be happy to answer them in the comments. <br><br><h4>  Links </h4><br>  <a href="https://github.com/gkopylov/bem">https://github.com/gkopylov/bem</a> <br>  <a href="https://github.com/gkopylov/bem_with_rails_and_less_example_app">https://github.com/gkopylov/bem_with_rails_and_less_example_app</a> <br><br>  <b>PS</b> <br><br>  At the time of this writing, the bem gem version 1.0.0 was used.  At the moment, the version of this gem is 1.1.0 - it adds the ability to connect blocks of | elements of modifiers directly to the manifest.  This was done so that the coder could change the order of connecting styles directly in the manifest, instead of connecting levels there. <br><br>  To use this option, it is enough to add the -i flag to the generation command.  Thus, the created styles will be connected immediately to the manifest without creating styles for the level. <br><br>  I wanted to write a little more about the use of the import and require directives.  Both directives have their pros and cons.  Among the advantages of import: <br>  - you can connect mixins and variables <br>  - everything merges into one file and is faster given to the browser, instead of the many files that generate require (but this is a minus, see below) <br>  among the cons: <br>  - it is difficult to debug css - if a preprocessor error occurs, it will be difficult to find the place of this error <br>  - styles are not updated when changing embedded css files (in order to update styles you need to run the command rm -rf tmp / assets / * and restart the rails) <br>  Among the benefits include: <br>  - easier to debug, since for each require it compiles a separate file (in the development environment) <br>  - possibility of livereload injection (theoretically it is easier to do than with import) <br>  among the cons: <br>  - inability to use mixins or variables <br>  - compiled style files can be given to the browser for a long time if there are a lot of <br><br>  So the decision to use this or that directive should be taken deliberately and depending on the project. <br><br>  I wanted to write a little more why, in default, I decided to use scss.  The fact is that in the community the sass rail preprocessor is more popular and even by default when creating a new application, the heme is enabled with this preprocessor.  And also there (as, incidentally, <a href="http://habrahabr.ru/post/229121/">rightly noticed</a> <a href="https://habrahabr.ru/users/faost/" class="user_link">faost</a> and in less <a href="http://lesscss.org/features/">http://lesscss.org/features/#parent-selectors-feature</a> ) there is an excellent feature that is just suitable for BEM - this is the use of <a href="http://jonsuh.com/blog/sass-bem-selector-and-trailing-ampersand/">ampersand</a> .  Already, many in the BEM community move away from writing a separate file under the modifier (if it is small) and write the modifier directly in the file with the block, and with this sass ampersand you can just do such things right in the styles for the block. </div><p>Source: <a href="https://habr.com/ru/post/229121/">https://habr.com/ru/post/229121/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../229109/index.html">Headphone history</a></li>
<li><a href="../229111/index.html">Komodo Edit and Komodo IDE 8 Overview</a></li>
<li><a href="../229113/index.html">Network Storage "WD My Book Live" and its refinement</a></li>
<li><a href="../229115/index.html">How I got to google [translation]</a></li>
<li><a href="../229119/index.html">Training Course - Applied Project Management through the PMBOK Standard (5th Edition)</a></li>
<li><a href="../229125/index.html">Create a platformer in four evenings</a></li>
<li><a href="../229127/index.html">65% discount on the seminar ‚ÄúEffective network management and monitoring for HP ProLiant servers‚Äù</a></li>
<li><a href="../229129/index.html">Features of use of MongoDB</a></li>
<li><a href="../229133/index.html">Competition projects open online courses Stepic Challenge</a></li>
<li><a href="../229135/index.html">Analysis of tasks of the contest Hash Runner on PHDays IV</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>