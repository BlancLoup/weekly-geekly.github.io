<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Localization. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is a continuation of the Localization article . Start 

 Copper pipes 
 So, the first game is transferred, the money received as well as the sati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Localization. Part 1</h1><div class="post__text post__text-html js-mediator-article"> This is a continuation of the <a href="http://habrahabr.ru/blogs/games/61255/">Localization</a> article <a href="http://habrahabr.ru/blogs/games/61255/">.</a>  <a href="http://habrahabr.ru/blogs/games/61255/">Start</a> <br><br>  <b>Copper pipes</b> <br>  So, the first game is transferred, the money received as well as the satisfaction of the work done. <br>  What changes after that? <br><br>  After that, you start looking at the games in a completely different way.  As an architect, who can no longer fully enjoy the beauty of the house, as a designer, who sees the advertising poster not like everything ... and the poor localizer, already looks at the game quite differently, mentally sorting it out into pieces. <br><a name="habracut"></a><br>  Personally, I still have a habit.  Having installed a fresh game that I want to watch, I don‚Äôt launch it.  Not.  I go to the directory where it is recorded and see how the data is organized, what the video is recorded in, what the sound is, where the textures are, where the texts are ... This happens so mechanically that you don‚Äôt think about it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And only after all this, you start ... <br><br>  The following observation is associated with visiting places where they sell discs.  Here the copper pipes for the first time make you know: <br>  - Did you play ‚ÄúHostile Whirlwinds‚Äù?  (Warwind) <br>  - Not‚Ä¶ <br>  - On, play ... in Russian ... class! <br>  And inside wakes up pride for the deed, a happy smile creeps on the face itself ... <br>  Then the seller tries to sell you your transfer ... <br>  This seriously affects your motivation and work on future games.  And both in a positive and in a negative direction. <br><br>  <b>How we worked ...</b> <br>  However, let's continue and consider the stages of disassembling the game. <br>  For the programmer: <br>  - Install, climb into the directory to see what is where <br>  - Start the game, set up, remember some text, preferably not ‚ÄúNew Game‚Äù, but from the gameplay itself, ideally a piece of some briefing, or dialogue in text form <br>  - Play a little to understand approximately: is there any text on the textures, what sound, how much is it <br>  - Exit the game and search for text, in different DOS / WIN / UNICODE encodings, etc. <br>  - Cut the text to give translators with comments <br>  - Search for sound and cut it <br>  - Calculate the duration in minutes, tell the manager, let him think ‚Äúis it worth it?‚Äù <br>  - Having received a positive response, to decrypt the sound as necessary <br>  - Give sounds to translators <br>  - Engage in decoding fonts in pictures <br>  - Cut fonts into pictures and give to the artist <br>  - Draw a couple of letters in the texture itself with the font, and a couple of Russian letters in the text <br>  - Try to paste the texture with the font back <br>  - if you had to decode the sound, write the encoder :) <br>  - Try to insert your sound into the game. <br>  - Get the first texts from translators <br>  - Get texture from artist <br>  - Collect the first version, show the manager <br>  - If inaccuracies are noticed, write down in a piece of paper (this is important! Write down a piece of paper into a piece of paper! Otherwise it will be skipped) <br>  - Collect fonts from ready-made textures <br>  - Get all sound and text, collect <br>  - Show first version to people <br>  - Collect and show until you get bored, until comments and corrections run out or until it is decided, well enough, send ... <br>  ... <br>  Approximately such a work plan.  Slightly messy, of course, and not always everything happens that way, but mostly similar. <br><br>  So, we have four main areas of work: <br>  - Disassembly - assembly <br>  - Text translation;  Video translation and script writing for actors <br>  - Drawing <br>  - Sound engineering and sound cutting <br><br>  <b>Sound</b> <br>  <a href="http://habrahabr.ru/blogs/games/63059/">Here</a> mikeSP perfectly wrote about the sound. <br>  I'd add from myself that everything was much simpler. <br>  Storeroom / Toilet, many trays from under the eggs, copper wire with a stretched stocking (spittoon, ts :)) In order for the microphone not to record the sound of particles of saliva falling on it when you speak.  And finally a microphone for crazy money.  The sound was recorded in the presence of only a working actor and operator.  All the others went ‚Äúto the garden‚Äù, i.e.  work at home. <br><br>  Today I will try to tell you about the basic principles of disassembling the game into its component parts. <br><br>  <b>Break not build</b> <br>  Disassembly primarily requires a very good knowledge of various formats and file types.  Graphics, objects, sound, text, encodings, basic encryption methods.  What I am trying to figure out is whether the file is or not - you need to know how it looks, mostly in machine codes. <br><br>  If the developer was lazy / low paid - he just sketched the files in directories.  These cases are the most relaxing, here you do not need anything, just take it and copy it.  But it happens differently. <br>  If the data directory contains only files like: ‚Äútextures.dat‚Äù, ‚Äúsound.dat‚Äù, ‚Äúmusic.dat‚Äù, ‚Äúvideo.dat‚Äù, etc. <br>  There will have to make a utility that will be able to disassemble / assemble such files.  Such utilities are most often written for a specific game, because even the same person never writes the same programs. <br><br>  Most often, data is organized according to the principle <br>  - heading <br>  - table placement <br>  - data blocks <br><br>  For example, take some hypothetical file ‚Äúsound.dat‚Äù and open it with a simple (hehe) and handy hiew32.exe program.  The name itself suggests that there should be a sound.  The first thing you can look for in it is the abbreviation RIFF, i.e.  standard media header, and if found, then you can safely cut the file from the header to the header - lucky.  You can quickly cut the cutting program and listen to what and where, and if there is any sound, give it to the translator, let him sort and translate while you look for the table - the title to this / in this file to insert it later.  Without a title, almost never files are found.  I mean data files that are merged. <br><br>  What I'm getting at is that if you are sure that you have found the beginning of some file inside a large file, which is called respectively: ‚Äúdat‚Äù, ‚Äúdta‚Äù, etc.  - you can safely search in this file for a link to the initial offset of this piece, and with very high probability - this will be the table. <br><br>  So, our actions: <br>  - We are looking for familiar headers / identifiers of the beginning of files inside a large data file <br>  - remember the initial offset <br>  - read the file size by calculating "offset2" - "offset1" <br>  - look for the found numbers in this file <br>  - Analyze the found table structure.  We try to align values ‚Äã‚Äãby 4 bytes, by 8m. <br>  - We write a program that will parse the file on the basis of the table. <br><br>  Do not forget that everything is written in the reverse order, i.e.  the number 0x8FBD55 will be recorded in the file as 0x55BD8F.  Those.  from low byte to high (clever and frightening not familiar to him man the word little-endian :). <br>  Disassembling on the basis of the table, and not just like that, you need first to collect everything back later. <br>  The game should use the data we created and not suspect that they were changed, right? <br><br>  A self-respecting developer, is trying with all his might to complicate the process of data parsing. <br>  Sometimes the table is encrypted and hidden by all known methods.  But after all, SoftICE and other excellent programs were invented for this.  Working with these applications is another story.  :) <br><br>  It is necessary to add that lately a person who wants to organize data in his game and really does not need to write anything himself.  Written a bunch of libraries that just take it and use it, notifying the author, or no need for notification at all (gzip for example) <br><br>  Files created in this way can be easily understood with the help of utilities from the author of the method itself or with the utility already written by the wizards, which breaks the file into pieces. <br>  For example MPQ format from Blizzard.  Great job on writing your own file system with support for versions, localization and heaps of everything else.  If I'm not mistaken, gzip is also used as a component there. <br><br>  This is just a general principle of disassembly, which is known to me.  I am a translator after all ... <br><br>  And for a snack, the story about <b>Tomb Raider</b> . <br>  This was our next game. <br>  There was little text in it, the most difficult thing was to translate the video by ear, because the emphasis was present, especially in the passage, when the Gods of Atlantis judged Nuttle. <br>  The idea of ‚Äã‚Äãthe emblem on the passport was born by itself :) I just came home with a passport, put it next to the table and began to redraw pictures for the game, because  There were few of them, I myself redrawn, the artist was not hired.  And when I came across a picture of the passport, I could not resist. <br><br>  The sound was made by hired guys, they were voiced too. <br>  With an expression they were weak.  The phrase "Kill her" in one of the passages sounded somehow mundane, as if Nuttle says "Bring me a beer ...". <br>  But, nevertheless, the guys tried.  There is a moment when, during training, Lara emerges from the water and says, ‚ÄúOooh ... Ohhh ... Fresh air!‚Äù In the English version, this sounds like a simple joy with a little shortness of breath: ‚ÄúOh!  Fresh Air!  Let's .... ‚Äù  But in the Russian version, the poor girl‚Äôs mouth was squeezed so that she didn‚Äôt breathe at about the same time that the game was relegated to ‚Äúswim once‚Äù, brought the text and microphone, and then let go.  Selflessly, right? <br><br>  Testing was carried out completely, because by the time when the utilities for the assembly were ready, I had already translated and passed the last level for two days. <br><br>  This is the only game for which the parsing tools, for a reason already forgotten, were written in Assembler. <br>  Below, for example, a piece of code that gets sound data in a draft format from the first Tomb Raider's RPL files. <br><br>  The first piece is just reading / writing files, nothing interesting, just using the native 21e interrupt. <br>  I will give only a piece of code that actually decodes: <br> <code>;------------------------------------------------------------ <br> proc ctoh <br> <br> mov dword ptr cs:[string],'0000' ;        <br> mov dword ptr cs:[string+4],'0000' <br> mov cx,0 <br> ctoh1: cmp byte ptr [si],30h <br> jc ctoh2 <br> cmp byte ptr [si],3ah <br> jnc ctoh2 <br> inc si <br> inc cx <br> jmp ctoh1 <br> ctoh2: <br> mov di,offset cs:string+7 <br> push si <br> dec si <br> std <br> rep movsb <br> pop si <br> inc si <br> mov bx,offset cs:string+7 <br> mov edx,1 <br> mov cx,8 <br> mov dword ptr cs:[len],0 <br> ctoh_loop1: <br> mov eax,0 <br> mov al,byte ptr cs:[bx] <br> sub al,30h <br> imul eax,edx <br> add dword ptr cs:[len],eax <br> imul edx,10 <br> dec bx <br> loop ctoh_loop1 <br> ret <br> <br> ctoh endp <br></code> <br><br>  Thanks for attention. <br><br>  To be continued‚Ä¶ </div><p>Source: <a href="https://habr.com/ru/post/63362/">https://habr.com/ru/post/63362/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../63354/index.html">Mini-report on participation in ICFPC 2009</a></li>
<li><a href="../63357/index.html">VDS launch took place!</a></li>
<li><a href="../63358/index.html">Design audit on the example of the famous portal</a></li>
<li><a href="../63360/index.html">Get ready, humanity!</a></li>
<li><a href="../63361/index.html">PostgreSQL 8.4 Released</a></li>
<li><a href="../63364/index.html">Who will be the Internet president?</a></li>
<li><a href="../63366/index.html">New product Rambler - Virtual Communication Center Virtus</a></li>
<li><a href="../63367/index.html">How did you find out what you know?</a></li>
<li><a href="../63370/index.html">Execute can not be pardoned. On the system of punishment and re-education in Russia</a></li>
<li><a href="../63375/index.html">What should be file sharing in the instant messenger?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>