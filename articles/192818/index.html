<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simplify the life of the administrator, associate the user name and computer name in automatic mode in the AD directory</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, Habr! 
 Probably, all system administrators had a problem determining the user's computer name. That is, we know the name of the emplo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simplify the life of the administrator, associate the user name and computer name in automatic mode in the AD directory</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, Habr! <br>  Probably, all system administrators had a problem determining the user's computer name.  That is, we know the name of the employee, but what is his computer, without a clue.  And, often, trying to force a user to determine the name of a computer causes torture.  They instead call the username, mail, phone number, anything, but not the computer name.  And an attempt to explain to the user where the information on the system is located causes an employee‚Äôs batthert and fierce hatred.  You could, of course, write some utility that allows you to display the computer name on the desktop or anywhere else in a visible place, but for this you need to explain each time where this information is located.  Slightly simplifies the task, but does not solve it completely.  Moreover, I am inclined to think that the user and everything should not know the name of the computer on which he is sitting.  As a result, it was decided to make the definition of the computer name modern, convenient, correct and, most importantly, automatic. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/441/5f3/733/4415f373319fd72b0493e1122d50b16c.png" alt="image"><br>  Something like this might look like connecting to a computer.  With that, the snap-in does not even have to be opened with an administrative account.  For those who are interested in how it all works and how to do it in your infrastructure, welcome to Cat. <br>  To do this, you need to understand what AD is, understand at least roughly the structure of objects in AD, understand the work of scripts, and also love cats. <br><a name="habracut"></a><br><h4>  General principle </h4><br>  The script launched from under the user determines the name of the computer on which he runs, and on his own behalf of the current user writes the value of the attribute in itself in the AD directory.  Then the administrator is free to decide what to do with this attribute value.  In this article I will give an example of PowerShell scripts and an example of adding a context menu item to the <b>Active Directory Users and Computers</b> snap-in (hereinafter referred to as ADUC). <br><br><h4>  Create an attribute </h4><br>  Many did not go far and were not wise using publicly available for recording, for example, the user‚Äôs ‚ÄúWeb Page‚Äù option is available for writing by default.  However, I did not like this idea, I wanted to create a specialized attribute for a user who would not have a dual purpose and did not require a compromise.  And then who knows how the situation will develop in the future and will require the use of this attribute, and he is already busy ... <br>  So, in order to create a new attribute in the schema, you must first add a snap.  On a computer with the remote administration package installed, or on a domain controller, you need to run <i><b>regsvr32 schmmgmt.dll as a</b></i> local administrator.  It is difficult to say why this snap-in is not registered by default, apparently so that, because of ignorance, they did not screw it up.  Nevertheless, we can add it by registering a DLL.  After that, open the <b>Active Directory Schema</b> snap-in and go to the <b>Attributes</b> section.  Create a new attribute.  Here, of course, I have to warn that attributes are not a place for experiments and they are created once and for all, it is impossible to delete an attribute or rename.  This warning is in all places where an attribute is added, but still :) To add a new attribute, you also need the rights of the <i>Schema Administrator</i> .  If your administrative user has <i>Enterprise Administrator</i> rights, then this is more than enough. <br>  To add a new attribute, you will need to enter the OID.  This is a unique object identifier.  You can read about it in Google, I will not go deep, but I will say that it must be unique.  The intersection of OID is unacceptable and if it is driven in by anyone, then there is a possibility that there will be unsolvable problems in the future.  OID usually starts from 1.2.840.113556 and then tsiferki.  I especially did not bother, because  the third number (840) is the country code, and the fourth is the company code (Microsoft), I entered the non-existing country code 800 and generated 2 random numbers through a dot.  A list of countries can be found <a href="http://www.oid-info.com/doc/country-OIDs.htm">here</a> .  In fact, for good, in this case it is necessary to contact ITU-T and request a unique OID, but the answer never came to me and I did not get into the bottle and created it on the basis of random numbers.  Then I found a <a href="http://gallery.technet.microsoft.com/scriptcenter/56b78004-40d0-41cf-b95e-6e795b2e8a06">script</a> that generates a relatively unique identifier, but it was too late :)) <br><img src="https://habrastorage.org/getpro/habr/post_images/182/38f/acf/18238facfe075dc4affd4f28a262c1cb.png" alt="image"><br>  In general, with OID decided.  Next we need to specify the syntax attribute.  In my configuration, this is a <i>Unicode String</i> .  Also, of course, you need an attribute name.  In this example, I will use the name <b>LabelComputer</b> , in the working configuration it is better to come up with something better. <br>  After we have created an attribute, we need to add it to the class.  Select the <b>user</b> class and add our new attribute in the <b>Attributes</b> mortgage.  Now the user with the necessary rights will have the right to write this attribute in the user.  By default, these rights are owned by an <i>Account operator</i> or higher.  But we are interested in the situation when the user himself could edit this attribute.  For such purposes, there is a user named <b>SELF</b> , who personifies himself.  We need to give permissions for all users to the <b>SELF</b> user to write the <b>LabelComputer</b> attribute.  Since  inheritance has not been canceled yet, we go to as high as necessary and change the rights.  I propose to change the rights to the entire domain, for us it will be <b><i>dc = contoso, dc = com</i></b> , we enter the security settings of the domain object in the <b>ADUC</b> snap- <b>in</b> .  Enter the permission tab and click the <b>Advanced</b> button.  Add permissions for the <b>SELF</b> user and allow him to read and write the <b>LabelComputer</b> attribute.  The attribute in the list, by the way, does not appear immediately after its creation.  It takes some time from the creation of the attribute to the moment we can see it in the list of assignment of rights and in the properties of the attributes of the user. <br><img src="https://habrastorage.org/getpro/habr/post_images/ee0/788/151/ee07881515e2f87c87f92587e27641c7.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Marking </h4><br>  As a result, we created an attribute, rights assigned.  Go to the working stage, you need to add the computer name to the attribute value. <br>  VBscript is used for this.  As practice shows, Microsoft is not trying to make PowerShell a replacement for VBS.  It's a pity.  For such tasks, VBS is faster and more versatile. <br>  Script that writes data to the current user: <br><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">On</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Resume</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objSysInfo = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"ADSystemInfo"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objNetwork = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"WScript.Network"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objUser = <span class="hljs-built_in"><span class="hljs-built_in">GetObject</span></span>(<span class="hljs-string"><span class="hljs-string">"LDAP://"</span></span> &amp; objSysInfo.UserName) objUser.Put <span class="hljs-string"><span class="hljs-string">"LabelComputer"</span></span>, objNetwork.ComputerName objUser.SetInfo</code> </pre> <br>  The script is simple and primitive.  The script and the model, however, can be expanded, save not only the computer, but, for example, time for relevance, but in this example I will not touch this. <br>  The script using group policy is assigned to run during Logon.  But not only.  It is possible that a person is logged on two computers, I want the information to be relevant anyway, even in this case.  To do this, we add the execution of the script to the scheduler with the trigger on the computer unlock event. <br><img src="https://habrastorage.org/getpro/habr/post_images/122/206/ecf/122206ecfa66b4ea7741c934094f6760.png" alt="image"><br>  In this case, even if the login was executed on several computers, the last one that was unlocked will be recorded as actual.  There is only one disappointment.  This method works exclusively on Vista + computers.  That is, in XP it is impossible to put such a trigger in the scheduler.  And unfortunately, VBS also does not allow to determine whether the computer is locked or not.  Otherwise, it would be possible to run the script once every 15 minutes, checking whether the computer is locked or not.  In VBS, you can only determine by subjective signs, for example, by entries in the Security Security Event Log, but then, at a minimum, you will need to give a regular user rights to view this log.  This is inconvenient, poorly applicable, and in general XP is getting smaller, this group of computers can be ignored, the Logon script will be enough for them. <br>  Since  we want to mark not every input, but only the one that is local, we need to exclude the launch of the Logon script on terminal and other servers that are not related to local computers.  I achieved this by turning on the <a href="http://support.microsoft.com/kb/231287">closure of group policy</a> in the merge mode and applying the group policy object to the area of ‚Äã‚Äãpersonal computers, servers in which there is no.  The method, I agree, is bad enough and wasting resources, it is better to use the closure of group policy only when it is definitely necessary, and not for all computers.  But perhaps this will be the next stage of improvement.  Nevertheless, in this way we clearly limit on which computers the group policies we need are executed with a Logon script and scheduler settings. <br><br><h4>  Sample PowerShell script for data collection </h4><br>  The main task is completed.  We are starting to see that information about the current computer is starting to appear in users. <br><img src="https://habrastorage.org/getpro/habr/post_images/2d4/61d/b2e/2d461db2eec3de7886e61ac5ae7e3c86.png" alt="image"><br>  Now we need to do something with this data.  For example, make a convenient sign with which users are sitting on which computers.  Or see which users do not have the value in the attribute, despite the recent login to the system, to see if the group policies are executed in the system, for example, or the user for some reason lacks the rights to write the attribute value to his user.  This happens if the user has disabled rights inheritance, for example. <br><br>  I wrote 3 PowerShell scripts to help the work. <br><br><h5>  Search users without values </h5><br><pre> <code class="bash hljs">Import-Module ActiveDirectory Get-ADObject -filter {(sAMAccountType -eq <span class="hljs-string"><span class="hljs-string">"805306368"</span></span>) -and (LabelComputer -notlike <span class="hljs-string"><span class="hljs-string">"*"</span></span>)} -Properties DisplayName,GivenName,SN,LabelComputer,cn,sAMAccountName,lastLogonTimestamp, OperatingSystem -SearchBase <span class="hljs-string"><span class="hljs-string">"OU= ,DC=contoso,dc=com"</span></span> | Select-Object @{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.DisplayName};Label=<span class="hljs-string"><span class="hljs-string">" "</span></span>},@{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.sAMAccountName};Label=<span class="hljs-string"><span class="hljs-string">""</span></span>}, @{label=<span class="hljs-string"><span class="hljs-string">" "</span></span>;expression={[datetime]::FromFileTime(<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.lastLogonTimestamp)}} | Sort-Object <span class="hljs-string"><span class="hljs-string">" "</span></span>| Format-Table -Autosize Read-Host <span class="hljs-string"><span class="hljs-string">"      .     ..."</span></span></code> </pre><br><br>  This script makes a beautiful table in which only users will be displayed, the display name, login and last login date.  Here we can look at suspicious users and then try to understand why, despite the recent log-in, the computer name is still missing. <br><br><h5>  All computers are tagged </h5><br><pre> <code class="bash hljs">Import-Module ActiveDirectory Get-ADObject -filter {(sAMAccountType -eq <span class="hljs-string"><span class="hljs-string">"805306368"</span></span>) -and (LabelComputer -like <span class="hljs-string"><span class="hljs-string">"*"</span></span>)} -Properties DisplayName,GivenName,SN,LabelComputer,cn,sAMAccountName,lastLogon -SearchBase <span class="hljs-string"><span class="hljs-string">"OU= ,DC=contoso,dc=com"</span></span> | Select-Object @{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.DisplayName};Label=<span class="hljs-string"><span class="hljs-string">" "</span></span>},@{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.sAMAccountName};Label=<span class="hljs-string"><span class="hljs-string">""</span></span>}, @{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.<span class="hljs-string"><span class="hljs-string">"LabelComputer"</span></span>};Label=<span class="hljs-string"><span class="hljs-string">" "</span></span>},@{label=<span class="hljs-string"><span class="hljs-string">" "</span></span>;expression={[datetime]::FromFileTime(<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.lastLogon)}} | Sort-Object <span class="hljs-string"><span class="hljs-string">" "</span></span> | Format-Table -Autosize Read-Host <span class="hljs-string"><span class="hljs-string">"      .     ..."</span></span></code> </pre><br>  This script is similar to the previous one, but shows a list of tagged users.  Allows you to estimate the relative number of tagged users. <br><br><h5>  Search computer name by user </h5><br><pre> <code class="bash hljs">Import-Module ActiveDirectory <span class="hljs-variable"><span class="hljs-variable">$exit</span></span> = 0 <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { Write-Host <span class="hljs-string"><span class="hljs-string">"   : , ,  , ,  .     ."</span></span> <span class="hljs-variable"><span class="hljs-variable">$us</span></span> = Read-Host -Prompt <span class="hljs-string"><span class="hljs-string">"   "</span></span> <span class="hljs-variable"><span class="hljs-variable">$find</span></span> = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-variable"><span class="hljs-variable">$find</span></span> += <span class="hljs-string"><span class="hljs-string">'*'</span></span> + <span class="hljs-variable"><span class="hljs-variable">$us</span></span> + <span class="hljs-string"><span class="hljs-string">'*'</span></span> write-host = <span class="hljs-variable"><span class="hljs-variable">$find</span></span> Get-ADObject -filter {(sAMAccountType -eq <span class="hljs-string"><span class="hljs-string">"805306368"</span></span>) -and ((GivenName -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ) -or (sn -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ) -or (cn -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ) -or (DisplayName -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ) -or (LabelComputer -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ) -or (sAMAccountName -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ))} -Properties DisplayName,GivenName,SN,LabelComputer,cn,sAMAccountName | Select-Object @{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.DisplayName};Label=<span class="hljs-string"><span class="hljs-string">" "</span></span>},@{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.sAMAccountName};Label=<span class="hljs-string"><span class="hljs-string">""</span></span>},@{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.<span class="hljs-string"><span class="hljs-string">"LabelComputer"</span></span>};Label=<span class="hljs-string"><span class="hljs-string">" "</span></span>} | Format-Table -Autosize } While (<span class="hljs-variable"><span class="hljs-variable">$us</span></span> -ne <span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre><br><br>  Well and, directly, search.  Like search occurs on all the main parameters of the user.  Returns the table found. <br><br>  For all scripts, the output can be done not in the Format-Table, but in Export-CSV and create a CSV file right away and analyze it already in some spreadsheet editor. <br>  {{picture from Leonardo Di Caprio from the movie Start}} <br><br><h4>  Add item to snap </h4><br>  Scripts are beautiful, but I want more automation.  And I wanted to, when clicked on the context menu, an automatic connection to the computer by a program for remote control of <i>DameWare occurred</i> .  Of course, you can run any convenient program, you can thus remotely restart, for example, the machine, if necessary.  Nevertheless, consider the example of <i>DameWare</i> . <br>  The context menu settings of the <b>ADUC</b> snap- <b>in</b> are not locally, as it may first appear, but, again, in the AD directory.  In order to add a new item, you must use the AD configuration editor, <b>ADSI Edit</b> utility.  You must connect to an AD configuration. <br><img src="https://habrastorage.org/getpro/habr/post_images/eb8/a23/b9e/eb8a23b9e21899d99f0f808ac4bff831.png" alt="image"><br><br>  The required attribute to change is in the object. <br>  <b><i>CN = user-Display, CN = 419, CN = DisplaySpecifiers, CN = Configuration, DC = contoso, DC = com</i></b> .  Moreover, <b><i>CN = 419</i></b> is, as it is not difficult to guess, a language.  If you need to change the parameter for <b>ADUC</b> English-language equipment, then <i><b>CN = 419</b></i> must be changed to <i><b>CN = 409</b></i> . <br><img src="https://habrastorage.org/getpro/habr/post_images/b19/02a/94d/b1902a94d181e2935f4013c5465ef8c9.png" alt="image"><br>  Add <b><i>an</i></b> item to the <b><i>adminContextMenu</i></b> .  The first is, as far as I understand, the sorting number, the second is the name itself and the third is, in fact, the address of the object to be executed.  Parameters are separated by commas.  After restarting <b>ADUC</b> for <b>user</b> objects, the newly created item will appear in the context menu.  The script will run under the rights of the user on whose behalf the snap-in was launched.  In total, when the program is started from the context menu of the <b>ADUC,</b> 2 values ‚Äã‚Äãare passed to the script or program in the parameters, these are the object <b>DN</b> and the object type.  We are interested only in the first parameter, by which we find the user name in the script. <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">On</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Resume</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> WshShell = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"WScript.Shell"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> fs=<span class="hljs-built_in"><span class="hljs-built_in">createobject</span></span>(<span class="hljs-string"><span class="hljs-string">"Scripting.FileSystemObject"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> CompName <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> RunCMD <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> FilePath <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objAD = <span class="hljs-built_in"><span class="hljs-built_in">GetObject</span></span>(Wscript.arguments.Item(<span class="hljs-number"><span class="hljs-number">0</span></span>)) CompName = objAD.<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> (<span class="hljs-string"><span class="hljs-string">"LabelComputer"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> CompName = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> WScript.Echo <span class="hljs-string"><span class="hljs-string">"    "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> CompName = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> WScript.quit <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">MsgBox</span></span> (<span class="hljs-string"><span class="hljs-string">"   "</span></span> &amp; CompName &amp; <span class="hljs-string"><span class="hljs-string">"?"</span></span>,vbOKCancel+vbQuestion,<span class="hljs-string"><span class="hljs-string">"?"</span></span>) = vbCancel <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> WScript.quit <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> fs.FileExists (<span class="hljs-string"><span class="hljs-string">"C:\Program Files\DameWare\DameWare Mini Remote Control 7.5\DWRCC.exe"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> FilePath = <span class="hljs-string"><span class="hljs-string">"""C:\Program Files\DameWare\DameWare Mini Remote Control 7.5\DWRCC.exe"""</span></span> RunCMD = FilePath &amp;<span class="hljs-string"><span class="hljs-string">" -c: -h: -x: -m:"</span></span> &amp; CompName &amp; <span class="hljs-string"><span class="hljs-string">" -u:LocalAdmin -p:1072206713 -d:contoso"</span></span> RetCode = WshShell.Run (RunCMD,<span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre><br>  This script runs the Damware program with the credentials of contoso \ LocalAdmin.  This user was previously added to the list of local administrators on users' computers.  In fact, the parameters -u :, -p: and -d: can be excluded and then DameWare will run on behalf of the current user.  If you have local administrator rights on the user's computers, then it will be easier. <br><br>  In the future, I would like to develop this so that to transfer the telephony of the technical support department to software SIP phones and adapt the whole scheme of work for the program so that when an incoming call all the necessary selections are made and the employee immediately appears on the screen all the information about the caller.  And happiness will come! <br><br>  Despite the fact that no unique knowledge is described here, I hope that, at a minimum, examples of scripts will help novice administrators in understanding this area :) All this can be continued to improve, add new attributes, add a label not only to the user, but also to the computer to add the Timestamp , save the latest computers, etc.  Each company may have its own needs. </div><p>Source: <a href="https://habr.com/ru/post/192818/">https://habr.com/ru/post/192818/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../192800/index.html">OSSEC: Big Brother is watching you</a></li>
<li><a href="../192804/index.html">Samsung Mobile SDK and Samsung Smart App Challenge 2013 for GALAXY Note</a></li>
<li><a href="../192806/index.html">Does JavaScript need classes? part 2</a></li>
<li><a href="../192814/index.html">Welcome to the blog KamaGames Studio</a></li>
<li><a href="../192816/index.html">Review Tizen SDK. Native</a></li>
<li><a href="../192820/index.html">Unity3D + Kinect, or animation on the knee</a></li>
<li><a href="../192822/index.html">SecurityLab.ru launches online vulnerability notification service</a></li>
<li><a href="../192824/index.html">Something about edX Blades</a></li>
<li><a href="../192828/index.html">Continuous integration of .NET projects: NAnt and / or MSBuild?</a></li>
<li><a href="../192832/index.html">[NES] Writing level editor for Prince of Persia. Chapter Five Reflection</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>