<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to get PCI DSS certification: IT GRAD experience</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In one of the past posts, we noted that we had successfully re-certified our infrastructure using PCI DSS and talked about the types of PCI DSS hostin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to get PCI DSS certification: IT GRAD experience</h1><div class="post__text post__text-html js-mediator-article">  In one of the past posts, we <a href="https://habrahabr.ru/company/it-grad/blog/351182/">noted</a> that we had successfully re-certified our infrastructure using PCI DSS and talked about the types of PCI DSS hosting: co-location, IaaS Basic and IaaS Advanced.  Today we will talk more about the certification process and our own audit experience. <br><br> <a href="https://habrahabr.ru/company/it-grad/blog/351548/"><img src="https://habrastorage.org/webt/dg/m-/xk/dgm-xk5mwyrw6ma0cl_1h2uffvs.jpeg"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>/ photo <a href="https://www.flickr.com/photos/ntnu-trondheim/26651372056/">NTNU</a> <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC</a></i></font> <br><br><h2>  Who needs to be certified </h2><br>  The requirements of the standard apply to all enterprises that process, transmit or store data of at least one credit card.  In one of our previous materials, we provided a simple <a href="http://iaas-blog.it-grad.ru/bezopasnost/sertifikaciya-pci-dss-chasto-zadavaemye-voprosy/">flowchart to</a> help you understand who needs PCI DSS certification. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Its essence lies in the fact that the leadership of the organization is enough to answer these questions: <br><br><ol><li>  Does the company work with PD cardholders? </li><li>  Do the company's business processes affect the integrity and security of these cards? </li></ol><br>  If the answer to both of these questions is yes, then the company needs to be certified.  For non-compliance with the requirements of PCI DSS, the organization is obliged to pay a <a href="http://www.ussc.ru/user_files/tiny_doc/df1de4926f1a25cea0e5701116af4cac.pdf">fine</a> in the amount of 10 to 200 thousand dollars, depending on: <br><br><ul><li>  type of payment system (Visa or MasterCard); </li><li>  company status (member, service provider or trade organization); </li><li>  recurrence of violations (first, second and subsequent). </li></ul><br>  The first time we were <a href="http://iaas-blog.it-grad.ru/bezopasnost/kak-it-grad-sertificiroval-iaas-oblako-po-standartu-pci-dss-chast-1/">certified</a> by PCI DSS in 2015, becoming one of the first cloud providers that were audited for compliance with the requirements of the standard. <br><br>  Further we will tell how this process took place. <br><br><h2>  Stage 1: documentation preparation </h2><br>  Before being audited, the company must prepare regulatory and regulatory documents on information security (instructions, regulations, policies).  At the time of the first certification, most of them were already developed by us, but some still had to be finalized. <br><br>  For example, we had to edit a policy that contains goals, objectives and methods for ensuring information security in an enterprise.  We also adjusted the regulations governing the management of vulnerabilities and incidents.  For example, we have created the ‚ÄúInformation Access Control Regulations‚Äù - it describes the rules for working with access rights and the requirements for user credentials. <br><br>  Note that all documents need to be reviewed and adjusted annually.  Especially if there were changes in the IT structure of the company. <br><br><h2>  Stage 2: IT infrastructure building </h2><br>  The next stage is infrastructure preparation.  If the organization is being audited for the first time, then the management needs to determine the OSP to be certified, that is, to limit the individual infrastructure unit that will support all the processes to be certified.  This is necessary in order to avoid having to make any changes to the infrastructure with new tests for meeting the requirements of the standard. <br><br>  To do this, we had to organize a separate infrastructure with a dedicated network, deploy ESX, vSphere and vCenter servers, install switches and a firewall to prevent malicious attacks.  We have duplicated all this equipment, and then have made the schemes of services, networks and business processes. <br><br>  The certified infrastructure must be separated from other networks of the organization - access to it must be provided through an isolated interface.  To fulfill this requirement, we use a VPN with 2FA and isolate each client's segment. <br><br>  Inside the perimeter is an NTP server, logging services, antivirus, firewall, as well as solutions to prevent cyber attacks and control data integrity.  You can see the scheme of our network <a href="http://iaas-blog.it-grad.ru/bezopasnost/kak-it-grad-sertificiroval-iaas-oblako-po-standartu-pci-dss-chast-1/">here</a> . <br><br><h2>  Stage 3: Pentest </h2><br>  <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D1%2581%25D0%25BF%25D1%258B%25D1%2582%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25BD%25D0%25B0_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">Pentest</a> conducts a special team on behalf of the auditing company.  Auditors verify the work of solutions that are used to protect cardholder data and identify potential security holes. <br><br>  Before starting to check the infrastructure for penetration resistance, our team <a href="http://iaas-blog.it-grad.ru/bezopasnost/kak-it-grad-sertificiroval-iaas-oblako-po-standartu-pci-dss-chast-2/">prepared</a> two osprey.  The first with service services and applications involved in testing.  The second one was configured VM with OS, assigned the necessary rights to the appropriate accounts. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6m/ge/jt/6mgejtzmxbz1_rde7abmtjsbzcq.jpeg" width="500"></div><br>  <font color="#A9A9A9"><i>/ Osprey example with hosted services and applications</i></font> <br><br>  Pentest of our infrastructure was carried out in several stages. <br><br><h5>  Nmap scanning </h5><br>  The auditors checked the white IP addresses of our company.  They could not find open ports on machines with public IP addresses (only those responsible for the operation of our infrastructure were open). <br><br><h5>  VPN connection and internal network checking </h5><br>  The Pentest team attempted to gain access from an untrusted network.  The test results showed that it is impossible to penetrate into the infrastructure of "IT-GRAD" via VPN without 2FA.  Checking the internal network also revealed no violations. <br><br><h5>  Attempt to access the infrastructure connection account </h5><br>  On a <a href="http://iaas-blog.it-grad.ru/">third-party resource</a> (this resource was iaas-blog.it-grad.ru), the experts obtained the credentials of one of our colleagues.  This colleague also had accounting in the IT-GRAD testing infrastructure.  The auditors tried to log in using his account and password, but they did not succeed, because the network was rather segmented. <br><br>  In total, according to the results of the inspection, we found 7 vulnerabilities of varying degrees of criticality: one high and 3 medium and low levels of ‚Äúdanger‚Äù. <br><br>  Our most critical vulnerability - the improper operation of WAF - was due to the fact that the firewall in use could not cope with complex attacks.  In order to eliminate the vulnerability, we deployed an Apache web server with the Modsecurity module, and then updated the WAF signature database. <br><br>  There were three intermediate vulnerabilities.  The first is the included TRACE method, which attackers can use, for example, for <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D0%25B6%25D1%2581%25D0%25B0%25D0%25B9%25D1%2582%25D0%25BE%25D0%25B2%25D1%258B%25D0%25B9_%25D1%2581%25D0%25BA%25D1%2580%25D0%25B8%25D0%25BF%25D1%2582%25D0%25B8%25D0%25BD%25D0%25B3">cross-site scripting</a> .  To eliminate the vulnerability, we deactivate the TRACE method. <br><br>  The second discrepancy is the lack of secure HTTP headers.  Vulnerability can cause attackers to attack the user interface.  We solved this task by including secure headers on the corresponding application server. <br><br>  And the third vulnerability is software insecurity on one of the hosts (due to outdated software version).  To eliminate this vulnerability, we configured regular software updates on all nodes. <br><br>  Among the vulnerabilities of low criticality, auditors found test data with password hashes in the production environment.  We also pointed to unreliable passwords and unnecessary software.  We replaced vulnerable passwords with secure passwords and removed unused data and software.  After fixing all the vulnerabilities, we successfully passed the repeated pentest. <br><br><h2>  Stage 4: Final Audit </h2><br>  At the final stage of the audit, the auditor <a href="http://iaas-blog.it-grad.ru/bezopasnost/kak-it-grad-sertificiroval-iaas-oblako-po-standartu-pci-dss-chast-2/">assesses the</a> completeness and parameters of software and hardware, the network topology, the OS configuration, the isolation of infrastructure segments and other characteristics.  In addition, he can check the documentation and knowledge of employees, ask questions of an organizational or technical nature. <br><br>  If your company shows minor deviations from the requirements of the standard, they can be eliminated during the audit.  For example, we have found an inactive computer account in Active Directory, which we promptly deleted. <br><br>  If you needed to change something before or during the audit, this is also not a problem.  The main thing here is to make changes in the way that PCI DSS requires. <br><br>  For example, before the audit, in IT-GRAD, we needed to track the loading and unloading of files on an SFTP server.  To do this, we had to urgently write a decoder for the avusm server.  Without a decoder, the server did not save the necessary messages, since it could not ‚Äúparse‚Äù the logs and generate alerts. <br><br>  Ultimately, we received a certificate of compliance with the requirements of PCI DSS and became one of the first IaaS providers in Russia that provides the hosting service of PCI DSS. <br><br><hr><br>  PS Several materials on the topic from the First Corporate IaaS Blog: <br><br><ul><li>  <a href="http://iaas-blog.it-grad.ru/bezopasnost/oblachnaya-usluga-pci-dss-xosting/">Cloud service "PCI DSS hosting"</a> </li><li>  <a href="http://iaas-blog.it-grad.ru/bezopasnost/na-chto-obratit-vnimanie-pri-vybore-uslugi-oblachnogo-pci-dss-xostinga/">What to look for when choosing a cloud PCI DSS hosting service</a> </li><li>  <a href="http://iaas-blog.it-grad.ru/bezopasnost/podvodnye-kamni-pri-sertifikacii-po-pci-dss-cvv-i-zapis-telefonnyx-razgovorov/">Pitfalls for PCI DSS certification: CVV and telephone recording</a> </li><li>  <a href="http://iaas-blog.it-grad.ru/bezopasnost/podvodnye-kamni-pri-sertifikacii-po-pci-dss-cvv-i-zapis-telefonnyx-razgovorov/">Payment systems and gateways for PCI DSS certification, outsourcing and clouds</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/351548/">https://habr.com/ru/post/351548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351534/index.html">FastTrack Training. "Network Basics". "Security basics". Eddie Martin December 2012</a></li>
<li><a href="../351536/index.html">UI Autotests for Xamarin</a></li>
<li><a href="../351540/index.html">Analysis of performance tasks with JBreak (part 3)</a></li>
<li><a href="../351542/index.html">IBM Cloud Caf√© - Kubernetes meetup</a></li>
<li><a href="../351544/index.html">Katalon Recorder Review and Tutorial (Selenium IDE ++ for Chrome and Firefox)</a></li>
<li><a href="../351550/index.html">We accept payments by cryptocurrency using PayKassa aggregator</a></li>
<li><a href="../351554/index.html">Microsoft Announces DirectX Raytracing Ray Tracing API</a></li>
<li><a href="../351556/index.html">We implement our operator in the Entity Framework Core</a></li>
<li><a href="../351558/index.html">Jessica Livingston (Y Combinator): ‚ÄúThe Sound of Silence‚Äù</a></li>
<li><a href="../351562/index.html">From patches in the fight against malware to a holistic strategy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>