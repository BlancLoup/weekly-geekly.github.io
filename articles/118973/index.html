<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to display a page in UTF-8, despite windows-1251 in the HTTP header</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have an old site on Narod.Ru , and recently I threw in there several articles - as I do now in UTF-8. The encoding was specified in the meta tag, bu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to display a page in UTF-8, despite windows-1251 in the HTTP header</h1><div class="post__text post__text-html js-mediator-article"> I have an old site on <a href="http://narod.ru/">Narod.Ru</a> , and recently I threw in there several articles - as I do now in UTF-8.  The encoding was specified in the <code>meta</code> tag, but, looking at the pages, I saw the quacking: ‚Äú <code>¬ß‚Äö—ï-‚Äö—ï –É¬ª—ì‚Ä°¬ª—ï–É–ä.</code>  "It turns out, Folk.Ru sends an HTTP header <code>Content-Type: text/html; charset=windows-1251</code>  <code>Content-Type: text/html; charset=windows-1251</code> and it doesn‚Äôt turn off on it.  The user can get readable text - only if he guesses to manually switch the encoding in the browser. <br><br>  What to do?  Switch to another hosting?  Of course, but until the hands reached, I wanted to achieve a result here.  Recode texts?  It seemed more worthy and interesting to put Javascript- "patch". <br><br>  I did not find a way to switch the encoding from Javascript.  There was an option to transcode the text with the script launched on the event of the <code>onready</code> document. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, the browser receives the text in UTF-8, splits the UTF-sequence into groups of 8 bits and treats them as character codes in Windows-1251 encoding.  To restore the readability of the text, you need to get these codes, combine them in UTF-sequence, and from them - to restore the Unicode-codes of characters and return the latter through numeric HTML links to characters.  In this case, they showed up a little hasty. <br><br><a name="habracut"></a><br><br>  First, reading the text from the <code>innerHTML</code> property, we find in the place of the non-breaking space (0xA0) the HTML entity ‚Äú <code>&amp;nbsp;</code>  ".  It is necessary to replace it back to <code>0xA0</code> . <br><br>  Secondly, the function <code>charCodeAt</code> returns the character code in Unicode, and not in Windows-1251, it means that the first must be converted to the second.  Thirdly, there is no symbol with code <code>0x98</code> in Windows-1251, so this function returns <code>undefined</code> for it, it must be provided. <br><br>  Fourthly, Internet Explorer and Safari do not allow changing the title of the document through the DOM, only through the corresponding document property ‚Äî but you cannot write numeric HTML links there.  For this case, you can translate Unicode codes into hexadecimal number system, write them in the form of "% code" and pass through the <code>unescape</code> function. <br><br>  The resulting code is: <br><br><pre> <code class="hljs pgsql">bindReady( <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>(){ var Win1251 = { <span class="hljs-number"><span class="hljs-number">0x0</span></span>: <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x1</span></span>: <span class="hljs-number"><span class="hljs-number">0x1</span></span>, <span class="hljs-number"><span class="hljs-number">0x2</span></span>: <span class="hljs-number"><span class="hljs-number">0x2</span></span>, <span class="hljs-number"><span class="hljs-number">0x3</span></span>: <span class="hljs-number"><span class="hljs-number">0x3</span></span>, <span class="hljs-number"><span class="hljs-number">0x4</span></span>: <span class="hljs-number"><span class="hljs-number">0x4</span></span>, <span class="hljs-number"><span class="hljs-number">0x5</span></span>: <span class="hljs-number"><span class="hljs-number">0x5</span></span>, <span class="hljs-number"><span class="hljs-number">0x6</span></span>: <span class="hljs-number"><span class="hljs-number">0x6</span></span>, <span class="hljs-number"><span class="hljs-number">0x7</span></span>: <span class="hljs-number"><span class="hljs-number">0x7</span></span>, <span class="hljs-number"><span class="hljs-number">0x8</span></span>: <span class="hljs-number"><span class="hljs-number">0x8</span></span>, <span class="hljs-number"><span class="hljs-number">0x9</span></span>: <span class="hljs-number"><span class="hljs-number">0x9</span></span>, <span class="hljs-number"><span class="hljs-number">0xA</span></span>: <span class="hljs-number"><span class="hljs-number">0xA</span></span>, <span class="hljs-number"><span class="hljs-number">0xB</span></span>: <span class="hljs-number"><span class="hljs-number">0xB</span></span>, <span class="hljs-number"><span class="hljs-number">0xC</span></span>: <span class="hljs-number"><span class="hljs-number">0xC</span></span>, <span class="hljs-number"><span class="hljs-number">0xD</span></span>: <span class="hljs-number"><span class="hljs-number">0xD</span></span>, <span class="hljs-number"><span class="hljs-number">0xE</span></span>: <span class="hljs-number"><span class="hljs-number">0xE</span></span>, <span class="hljs-number"><span class="hljs-number">0xF</span></span>: <span class="hljs-number"><span class="hljs-number">0xF</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>: <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x11</span></span>: <span class="hljs-number"><span class="hljs-number">0x11</span></span>, <span class="hljs-number"><span class="hljs-number">0x12</span></span>: <span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0x13</span></span>: <span class="hljs-number"><span class="hljs-number">0x13</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>: <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0x15</span></span>: <span class="hljs-number"><span class="hljs-number">0x15</span></span>, <span class="hljs-number"><span class="hljs-number">0x16</span></span>: <span class="hljs-number"><span class="hljs-number">0x16</span></span>, <span class="hljs-number"><span class="hljs-number">0x17</span></span>: <span class="hljs-number"><span class="hljs-number">0x17</span></span>, <span class="hljs-number"><span class="hljs-number">0x18</span></span>: <span class="hljs-number"><span class="hljs-number">0x18</span></span>, <span class="hljs-number"><span class="hljs-number">0x19</span></span>: <span class="hljs-number"><span class="hljs-number">0x19</span></span>, <span class="hljs-number"><span class="hljs-number">0x1A</span></span>: <span class="hljs-number"><span class="hljs-number">0x1A</span></span>, <span class="hljs-number"><span class="hljs-number">0x1B</span></span>: <span class="hljs-number"><span class="hljs-number">0x1B</span></span>, <span class="hljs-number"><span class="hljs-number">0x1C</span></span>: <span class="hljs-number"><span class="hljs-number">0x1C</span></span>, <span class="hljs-number"><span class="hljs-number">0x1D</span></span>: <span class="hljs-number"><span class="hljs-number">0x1D</span></span>, <span class="hljs-number"><span class="hljs-number">0x1E</span></span>: <span class="hljs-number"><span class="hljs-number">0x1E</span></span>, <span class="hljs-number"><span class="hljs-number">0x1F</span></span>: <span class="hljs-number"><span class="hljs-number">0x1F</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>: <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x21</span></span>: <span class="hljs-number"><span class="hljs-number">0x21</span></span>, <span class="hljs-number"><span class="hljs-number">0x22</span></span>: <span class="hljs-number"><span class="hljs-number">0x22</span></span>, <span class="hljs-number"><span class="hljs-number">0x23</span></span>: <span class="hljs-number"><span class="hljs-number">0x23</span></span>, <span class="hljs-number"><span class="hljs-number">0x24</span></span>: <span class="hljs-number"><span class="hljs-number">0x24</span></span>, <span class="hljs-number"><span class="hljs-number">0x25</span></span>: <span class="hljs-number"><span class="hljs-number">0x25</span></span>, <span class="hljs-number"><span class="hljs-number">0x26</span></span>: <span class="hljs-number"><span class="hljs-number">0x26</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>: <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>: <span class="hljs-number"><span class="hljs-number">0x28</span></span>, <span class="hljs-number"><span class="hljs-number">0x29</span></span>: <span class="hljs-number"><span class="hljs-number">0x29</span></span>, <span class="hljs-number"><span class="hljs-number">0x2A</span></span>: <span class="hljs-number"><span class="hljs-number">0x2A</span></span>, <span class="hljs-number"><span class="hljs-number">0x2B</span></span>: <span class="hljs-number"><span class="hljs-number">0x2B</span></span>, <span class="hljs-number"><span class="hljs-number">0x2C</span></span>: <span class="hljs-number"><span class="hljs-number">0x2C</span></span>, <span class="hljs-number"><span class="hljs-number">0x2D</span></span>: <span class="hljs-number"><span class="hljs-number">0x2D</span></span>, <span class="hljs-number"><span class="hljs-number">0x2E</span></span>: <span class="hljs-number"><span class="hljs-number">0x2E</span></span>, <span class="hljs-number"><span class="hljs-number">0x2F</span></span>: <span class="hljs-number"><span class="hljs-number">0x2F</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>: <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0x31</span></span>: <span class="hljs-number"><span class="hljs-number">0x31</span></span>, <span class="hljs-number"><span class="hljs-number">0x32</span></span>: <span class="hljs-number"><span class="hljs-number">0x32</span></span>, <span class="hljs-number"><span class="hljs-number">0x33</span></span>: <span class="hljs-number"><span class="hljs-number">0x33</span></span>, <span class="hljs-number"><span class="hljs-number">0x34</span></span>: <span class="hljs-number"><span class="hljs-number">0x34</span></span>, <span class="hljs-number"><span class="hljs-number">0x35</span></span>: <span class="hljs-number"><span class="hljs-number">0x35</span></span>, <span class="hljs-number"><span class="hljs-number">0x36</span></span>: <span class="hljs-number"><span class="hljs-number">0x36</span></span>, <span class="hljs-number"><span class="hljs-number">0x37</span></span>: <span class="hljs-number"><span class="hljs-number">0x37</span></span>, <span class="hljs-number"><span class="hljs-number">0x38</span></span>: <span class="hljs-number"><span class="hljs-number">0x38</span></span>, <span class="hljs-number"><span class="hljs-number">0x39</span></span>: <span class="hljs-number"><span class="hljs-number">0x39</span></span>, <span class="hljs-number"><span class="hljs-number">0x3A</span></span>: <span class="hljs-number"><span class="hljs-number">0x3A</span></span>, <span class="hljs-number"><span class="hljs-number">0x3B</span></span>: <span class="hljs-number"><span class="hljs-number">0x3B</span></span>, <span class="hljs-number"><span class="hljs-number">0x3C</span></span>: <span class="hljs-number"><span class="hljs-number">0x3C</span></span>, <span class="hljs-number"><span class="hljs-number">0x3D</span></span>: <span class="hljs-number"><span class="hljs-number">0x3D</span></span>, <span class="hljs-number"><span class="hljs-number">0x3E</span></span>: <span class="hljs-number"><span class="hljs-number">0x3E</span></span>, <span class="hljs-number"><span class="hljs-number">0x3F</span></span>: <span class="hljs-number"><span class="hljs-number">0x3F</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>: <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x41</span></span>: <span class="hljs-number"><span class="hljs-number">0x41</span></span>, <span class="hljs-number"><span class="hljs-number">0x42</span></span>: <span class="hljs-number"><span class="hljs-number">0x42</span></span>, <span class="hljs-number"><span class="hljs-number">0x43</span></span>: <span class="hljs-number"><span class="hljs-number">0x43</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>: <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x45</span></span>: <span class="hljs-number"><span class="hljs-number">0x45</span></span>, <span class="hljs-number"><span class="hljs-number">0x46</span></span>: <span class="hljs-number"><span class="hljs-number">0x46</span></span>, <span class="hljs-number"><span class="hljs-number">0x47</span></span>: <span class="hljs-number"><span class="hljs-number">0x47</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>: <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>: <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>: <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0x4B</span></span>: <span class="hljs-number"><span class="hljs-number">0x4B</span></span>, <span class="hljs-number"><span class="hljs-number">0x4C</span></span>: <span class="hljs-number"><span class="hljs-number">0x4C</span></span>, <span class="hljs-number"><span class="hljs-number">0x4D</span></span>: <span class="hljs-number"><span class="hljs-number">0x4D</span></span>, <span class="hljs-number"><span class="hljs-number">0x4E</span></span>: <span class="hljs-number"><span class="hljs-number">0x4E</span></span>, <span class="hljs-number"><span class="hljs-number">0x4F</span></span>: <span class="hljs-number"><span class="hljs-number">0x4F</span></span>, <span class="hljs-number"><span class="hljs-number">0x50</span></span>: <span class="hljs-number"><span class="hljs-number">0x50</span></span>, <span class="hljs-number"><span class="hljs-number">0x51</span></span>: <span class="hljs-number"><span class="hljs-number">0x51</span></span>, <span class="hljs-number"><span class="hljs-number">0x52</span></span>: <span class="hljs-number"><span class="hljs-number">0x52</span></span>, <span class="hljs-number"><span class="hljs-number">0x53</span></span>: <span class="hljs-number"><span class="hljs-number">0x53</span></span>, <span class="hljs-number"><span class="hljs-number">0x54</span></span>: <span class="hljs-number"><span class="hljs-number">0x54</span></span>, <span class="hljs-number"><span class="hljs-number">0x55</span></span>: <span class="hljs-number"><span class="hljs-number">0x55</span></span>, <span class="hljs-number"><span class="hljs-number">0x56</span></span>: <span class="hljs-number"><span class="hljs-number">0x56</span></span>, <span class="hljs-number"><span class="hljs-number">0x57</span></span>: <span class="hljs-number"><span class="hljs-number">0x57</span></span>, <span class="hljs-number"><span class="hljs-number">0x58</span></span>: <span class="hljs-number"><span class="hljs-number">0x58</span></span>, <span class="hljs-number"><span class="hljs-number">0x59</span></span>: <span class="hljs-number"><span class="hljs-number">0x59</span></span>, <span class="hljs-number"><span class="hljs-number">0x5A</span></span>: <span class="hljs-number"><span class="hljs-number">0x5A</span></span>, <span class="hljs-number"><span class="hljs-number">0x5B</span></span>: <span class="hljs-number"><span class="hljs-number">0x5B</span></span>, <span class="hljs-number"><span class="hljs-number">0x5C</span></span>: <span class="hljs-number"><span class="hljs-number">0x5C</span></span>, <span class="hljs-number"><span class="hljs-number">0x5D</span></span>: <span class="hljs-number"><span class="hljs-number">0x5D</span></span>, <span class="hljs-number"><span class="hljs-number">0x5E</span></span>: <span class="hljs-number"><span class="hljs-number">0x5E</span></span>, <span class="hljs-number"><span class="hljs-number">0x5F</span></span>: <span class="hljs-number"><span class="hljs-number">0x5F</span></span>, <span class="hljs-number"><span class="hljs-number">0x60</span></span>: <span class="hljs-number"><span class="hljs-number">0x60</span></span>, <span class="hljs-number"><span class="hljs-number">0x61</span></span>: <span class="hljs-number"><span class="hljs-number">0x61</span></span>, <span class="hljs-number"><span class="hljs-number">0x62</span></span>: <span class="hljs-number"><span class="hljs-number">0x62</span></span>, <span class="hljs-number"><span class="hljs-number">0x63</span></span>: <span class="hljs-number"><span class="hljs-number">0x63</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>: <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>: <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x66</span></span>: <span class="hljs-number"><span class="hljs-number">0x66</span></span>, <span class="hljs-number"><span class="hljs-number">0x67</span></span>: <span class="hljs-number"><span class="hljs-number">0x67</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>: <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x69</span></span>: <span class="hljs-number"><span class="hljs-number">0x69</span></span>, <span class="hljs-number"><span class="hljs-number">0x6A</span></span>: <span class="hljs-number"><span class="hljs-number">0x6A</span></span>, <span class="hljs-number"><span class="hljs-number">0x6B</span></span>: <span class="hljs-number"><span class="hljs-number">0x6B</span></span>, <span class="hljs-number"><span class="hljs-number">0x6C</span></span>: <span class="hljs-number"><span class="hljs-number">0x6C</span></span>, <span class="hljs-number"><span class="hljs-number">0x6D</span></span>: <span class="hljs-number"><span class="hljs-number">0x6D</span></span>, <span class="hljs-number"><span class="hljs-number">0x6E</span></span>: <span class="hljs-number"><span class="hljs-number">0x6E</span></span>, <span class="hljs-number"><span class="hljs-number">0x6F</span></span>: <span class="hljs-number"><span class="hljs-number">0x6F</span></span>, <span class="hljs-number"><span class="hljs-number">0x70</span></span>: <span class="hljs-number"><span class="hljs-number">0x70</span></span>, <span class="hljs-number"><span class="hljs-number">0x71</span></span>: <span class="hljs-number"><span class="hljs-number">0x71</span></span>, <span class="hljs-number"><span class="hljs-number">0x72</span></span>: <span class="hljs-number"><span class="hljs-number">0x72</span></span>, <span class="hljs-number"><span class="hljs-number">0x73</span></span>: <span class="hljs-number"><span class="hljs-number">0x73</span></span>, <span class="hljs-number"><span class="hljs-number">0x74</span></span>: <span class="hljs-number"><span class="hljs-number">0x74</span></span>, <span class="hljs-number"><span class="hljs-number">0x75</span></span>: <span class="hljs-number"><span class="hljs-number">0x75</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>: <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0x77</span></span>: <span class="hljs-number"><span class="hljs-number">0x77</span></span>, <span class="hljs-number"><span class="hljs-number">0x78</span></span>: <span class="hljs-number"><span class="hljs-number">0x78</span></span>, <span class="hljs-number"><span class="hljs-number">0x79</span></span>: <span class="hljs-number"><span class="hljs-number">0x79</span></span>, <span class="hljs-number"><span class="hljs-number">0x7A</span></span>: <span class="hljs-number"><span class="hljs-number">0x7A</span></span>, <span class="hljs-number"><span class="hljs-number">0x7B</span></span>: <span class="hljs-number"><span class="hljs-number">0x7B</span></span>, <span class="hljs-number"><span class="hljs-number">0x7C</span></span>: <span class="hljs-number"><span class="hljs-number">0x7C</span></span>, <span class="hljs-number"><span class="hljs-number">0x7D</span></span>: <span class="hljs-number"><span class="hljs-number">0x7D</span></span>, <span class="hljs-number"><span class="hljs-number">0x7E</span></span>: <span class="hljs-number"><span class="hljs-number">0x7E</span></span>, <span class="hljs-number"><span class="hljs-number">0x7F</span></span>: <span class="hljs-number"><span class="hljs-number">0x7F</span></span>, <span class="hljs-number"><span class="hljs-number">0x402</span></span>: <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x403</span></span>: <span class="hljs-number"><span class="hljs-number">0x81</span></span>, <span class="hljs-number"><span class="hljs-number">0x201A</span></span>: <span class="hljs-number"><span class="hljs-number">0x82</span></span>, <span class="hljs-number"><span class="hljs-number">0x453</span></span>: <span class="hljs-number"><span class="hljs-number">0x83</span></span>, <span class="hljs-number"><span class="hljs-number">0x201E</span></span>: <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0x2026</span></span>: <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0x2020</span></span>: <span class="hljs-number"><span class="hljs-number">0x86</span></span>, <span class="hljs-number"><span class="hljs-number">0x2021</span></span>: <span class="hljs-number"><span class="hljs-number">0x87</span></span>, <span class="hljs-number"><span class="hljs-number">0x20AC</span></span>: <span class="hljs-number"><span class="hljs-number">0x88</span></span>, <span class="hljs-number"><span class="hljs-number">0x2030</span></span>: <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0x409</span></span>: <span class="hljs-number"><span class="hljs-number">0x8A</span></span>, <span class="hljs-number"><span class="hljs-number">0x2039</span></span>: <span class="hljs-number"><span class="hljs-number">0x8B</span></span>, <span class="hljs-number"><span class="hljs-number">0x40A</span></span>: <span class="hljs-number"><span class="hljs-number">0x8C</span></span>, <span class="hljs-number"><span class="hljs-number">0x40C</span></span>: <span class="hljs-number"><span class="hljs-number">0x8D</span></span>, <span class="hljs-number"><span class="hljs-number">0x40B</span></span>: <span class="hljs-number"><span class="hljs-number">0x8E</span></span>, <span class="hljs-number"><span class="hljs-number">0x40F</span></span>: <span class="hljs-number"><span class="hljs-number">0x8F</span></span>, <span class="hljs-number"><span class="hljs-number">0x452</span></span>: <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0x2018</span></span>: <span class="hljs-number"><span class="hljs-number">0x91</span></span>, <span class="hljs-number"><span class="hljs-number">0x2019</span></span>: <span class="hljs-number"><span class="hljs-number">0x92</span></span>, <span class="hljs-number"><span class="hljs-number">0x201C</span></span>: <span class="hljs-number"><span class="hljs-number">0x93</span></span>, <span class="hljs-number"><span class="hljs-number">0x201D</span></span>: <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x2022</span></span>: <span class="hljs-number"><span class="hljs-number">0x95</span></span>, <span class="hljs-number"><span class="hljs-number">0x2013</span></span>: <span class="hljs-number"><span class="hljs-number">0x96</span></span>, <span class="hljs-number"><span class="hljs-number">0x2014</span></span>: <span class="hljs-number"><span class="hljs-number">0x97</span></span>, <span class="hljs-number"><span class="hljs-number">0x2122</span></span>: <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0x459</span></span>: <span class="hljs-number"><span class="hljs-number">0x9A</span></span>, <span class="hljs-number"><span class="hljs-number">0x203A</span></span>: <span class="hljs-number"><span class="hljs-number">0x9B</span></span>, <span class="hljs-number"><span class="hljs-number">0x45A</span></span>: <span class="hljs-number"><span class="hljs-number">0x9C</span></span>, <span class="hljs-number"><span class="hljs-number">0x45C</span></span>: <span class="hljs-number"><span class="hljs-number">0x9D</span></span>, <span class="hljs-number"><span class="hljs-number">0x45B</span></span>: <span class="hljs-number"><span class="hljs-number">0x9E</span></span>, <span class="hljs-number"><span class="hljs-number">0x45F</span></span>: <span class="hljs-number"><span class="hljs-number">0x9F</span></span>, <span class="hljs-number"><span class="hljs-number">0xA0</span></span>: <span class="hljs-number"><span class="hljs-number">0xA0</span></span>, <span class="hljs-number"><span class="hljs-number">0x40E</span></span>: <span class="hljs-number"><span class="hljs-number">0xA1</span></span>, <span class="hljs-number"><span class="hljs-number">0x45E</span></span>: <span class="hljs-number"><span class="hljs-number">0xA2</span></span>, <span class="hljs-number"><span class="hljs-number">0x408</span></span>: <span class="hljs-number"><span class="hljs-number">0xA3</span></span>, <span class="hljs-number"><span class="hljs-number">0xA4</span></span>: <span class="hljs-number"><span class="hljs-number">0xA4</span></span>, <span class="hljs-number"><span class="hljs-number">0x490</span></span>: <span class="hljs-number"><span class="hljs-number">0xA5</span></span>, <span class="hljs-number"><span class="hljs-number">0xA6</span></span>: <span class="hljs-number"><span class="hljs-number">0xA6</span></span>, <span class="hljs-number"><span class="hljs-number">0xA7</span></span>: <span class="hljs-number"><span class="hljs-number">0xA7</span></span>, <span class="hljs-number"><span class="hljs-number">0x401</span></span>: <span class="hljs-number"><span class="hljs-number">0xA8</span></span>, <span class="hljs-number"><span class="hljs-number">0xA9</span></span>: <span class="hljs-number"><span class="hljs-number">0xA9</span></span>, <span class="hljs-number"><span class="hljs-number">0x404</span></span>: <span class="hljs-number"><span class="hljs-number">0xAA</span></span>, <span class="hljs-number"><span class="hljs-number">0xAB</span></span>: <span class="hljs-number"><span class="hljs-number">0xAB</span></span>, <span class="hljs-number"><span class="hljs-number">0xAC</span></span>: <span class="hljs-number"><span class="hljs-number">0xAC</span></span>, <span class="hljs-number"><span class="hljs-number">0xAD</span></span>: <span class="hljs-number"><span class="hljs-number">0xAD</span></span>, <span class="hljs-number"><span class="hljs-number">0xAE</span></span>: <span class="hljs-number"><span class="hljs-number">0xAE</span></span>, <span class="hljs-number"><span class="hljs-number">0x407</span></span>: <span class="hljs-number"><span class="hljs-number">0xAF</span></span>, <span class="hljs-number"><span class="hljs-number">0xB0</span></span>: <span class="hljs-number"><span class="hljs-number">0xB0</span></span>, <span class="hljs-number"><span class="hljs-number">0xB1</span></span>: <span class="hljs-number"><span class="hljs-number">0xB1</span></span>, <span class="hljs-number"><span class="hljs-number">0x406</span></span>: <span class="hljs-number"><span class="hljs-number">0xB2</span></span>, <span class="hljs-number"><span class="hljs-number">0x456</span></span>: <span class="hljs-number"><span class="hljs-number">0xB3</span></span>, <span class="hljs-number"><span class="hljs-number">0x491</span></span>: <span class="hljs-number"><span class="hljs-number">0xB4</span></span>, <span class="hljs-number"><span class="hljs-number">0xB5</span></span>: <span class="hljs-number"><span class="hljs-number">0xB5</span></span>, <span class="hljs-number"><span class="hljs-number">0xB6</span></span>: <span class="hljs-number"><span class="hljs-number">0xB6</span></span>, <span class="hljs-number"><span class="hljs-number">0xB7</span></span>: <span class="hljs-number"><span class="hljs-number">0xB7</span></span>, <span class="hljs-number"><span class="hljs-number">0x451</span></span>: <span class="hljs-number"><span class="hljs-number">0xB8</span></span>, <span class="hljs-number"><span class="hljs-number">0x2116</span></span>: <span class="hljs-number"><span class="hljs-number">0xB9</span></span>, <span class="hljs-number"><span class="hljs-number">0x454</span></span>: <span class="hljs-number"><span class="hljs-number">0xBA</span></span>, <span class="hljs-number"><span class="hljs-number">0xBB</span></span>: <span class="hljs-number"><span class="hljs-number">0xBB</span></span>, <span class="hljs-number"><span class="hljs-number">0x458</span></span>: <span class="hljs-number"><span class="hljs-number">0xBC</span></span>, <span class="hljs-number"><span class="hljs-number">0x405</span></span>: <span class="hljs-number"><span class="hljs-number">0xBD</span></span>, <span class="hljs-number"><span class="hljs-number">0x455</span></span>: <span class="hljs-number"><span class="hljs-number">0xBE</span></span>, <span class="hljs-number"><span class="hljs-number">0x457</span></span>: <span class="hljs-number"><span class="hljs-number">0xBF</span></span>, <span class="hljs-number"><span class="hljs-number">0x410</span></span>: <span class="hljs-number"><span class="hljs-number">0xC0</span></span>, <span class="hljs-number"><span class="hljs-number">0x411</span></span>: <span class="hljs-number"><span class="hljs-number">0xC1</span></span>, <span class="hljs-number"><span class="hljs-number">0x412</span></span>: <span class="hljs-number"><span class="hljs-number">0xC2</span></span>, <span class="hljs-number"><span class="hljs-number">0x413</span></span>: <span class="hljs-number"><span class="hljs-number">0xC3</span></span>, <span class="hljs-number"><span class="hljs-number">0x414</span></span>: <span class="hljs-number"><span class="hljs-number">0xC4</span></span>, <span class="hljs-number"><span class="hljs-number">0x415</span></span>: <span class="hljs-number"><span class="hljs-number">0xC5</span></span>, <span class="hljs-number"><span class="hljs-number">0x416</span></span>: <span class="hljs-number"><span class="hljs-number">0xC6</span></span>, <span class="hljs-number"><span class="hljs-number">0x417</span></span>: <span class="hljs-number"><span class="hljs-number">0xC7</span></span>, <span class="hljs-number"><span class="hljs-number">0x418</span></span>: <span class="hljs-number"><span class="hljs-number">0xC8</span></span>, <span class="hljs-number"><span class="hljs-number">0x419</span></span>: <span class="hljs-number"><span class="hljs-number">0xC9</span></span>, <span class="hljs-number"><span class="hljs-number">0x41A</span></span>: <span class="hljs-number"><span class="hljs-number">0xCA</span></span>, <span class="hljs-number"><span class="hljs-number">0x41B</span></span>: <span class="hljs-number"><span class="hljs-number">0xCB</span></span>, <span class="hljs-number"><span class="hljs-number">0x41C</span></span>: <span class="hljs-number"><span class="hljs-number">0xCC</span></span>, <span class="hljs-number"><span class="hljs-number">0x41D</span></span>: <span class="hljs-number"><span class="hljs-number">0xCD</span></span>, <span class="hljs-number"><span class="hljs-number">0x41E</span></span>: <span class="hljs-number"><span class="hljs-number">0xCE</span></span>, <span class="hljs-number"><span class="hljs-number">0x41F</span></span>: <span class="hljs-number"><span class="hljs-number">0xCF</span></span>, <span class="hljs-number"><span class="hljs-number">0x420</span></span>: <span class="hljs-number"><span class="hljs-number">0xD0</span></span>, <span class="hljs-number"><span class="hljs-number">0x421</span></span>: <span class="hljs-number"><span class="hljs-number">0xD1</span></span>, <span class="hljs-number"><span class="hljs-number">0x422</span></span>: <span class="hljs-number"><span class="hljs-number">0xD2</span></span>, <span class="hljs-number"><span class="hljs-number">0x423</span></span>: <span class="hljs-number"><span class="hljs-number">0xD3</span></span>, <span class="hljs-number"><span class="hljs-number">0x424</span></span>: <span class="hljs-number"><span class="hljs-number">0xD4</span></span>, <span class="hljs-number"><span class="hljs-number">0x425</span></span>: <span class="hljs-number"><span class="hljs-number">0xD5</span></span>, <span class="hljs-number"><span class="hljs-number">0x426</span></span>: <span class="hljs-number"><span class="hljs-number">0xD6</span></span>, <span class="hljs-number"><span class="hljs-number">0x427</span></span>: <span class="hljs-number"><span class="hljs-number">0xD7</span></span>, <span class="hljs-number"><span class="hljs-number">0x428</span></span>: <span class="hljs-number"><span class="hljs-number">0xD8</span></span>, <span class="hljs-number"><span class="hljs-number">0x429</span></span>: <span class="hljs-number"><span class="hljs-number">0xD9</span></span>, <span class="hljs-number"><span class="hljs-number">0x42A</span></span>: <span class="hljs-number"><span class="hljs-number">0xDA</span></span>, <span class="hljs-number"><span class="hljs-number">0x42B</span></span>: <span class="hljs-number"><span class="hljs-number">0xDB</span></span>, <span class="hljs-number"><span class="hljs-number">0x42C</span></span>: <span class="hljs-number"><span class="hljs-number">0xDC</span></span>, <span class="hljs-number"><span class="hljs-number">0x42D</span></span>: <span class="hljs-number"><span class="hljs-number">0xDD</span></span>, <span class="hljs-number"><span class="hljs-number">0x42E</span></span>: <span class="hljs-number"><span class="hljs-number">0xDE</span></span>, <span class="hljs-number"><span class="hljs-number">0x42F</span></span>: <span class="hljs-number"><span class="hljs-number">0xDF</span></span>, <span class="hljs-number"><span class="hljs-number">0x430</span></span>: <span class="hljs-number"><span class="hljs-number">0xE0</span></span>, <span class="hljs-number"><span class="hljs-number">0x431</span></span>: <span class="hljs-number"><span class="hljs-number">0xE1</span></span>, <span class="hljs-number"><span class="hljs-number">0x432</span></span>: <span class="hljs-number"><span class="hljs-number">0xE2</span></span>, <span class="hljs-number"><span class="hljs-number">0x433</span></span>: <span class="hljs-number"><span class="hljs-number">0xE3</span></span>, <span class="hljs-number"><span class="hljs-number">0x434</span></span>: <span class="hljs-number"><span class="hljs-number">0xE4</span></span>, <span class="hljs-number"><span class="hljs-number">0x435</span></span>: <span class="hljs-number"><span class="hljs-number">0xE5</span></span>, <span class="hljs-number"><span class="hljs-number">0x436</span></span>: <span class="hljs-number"><span class="hljs-number">0xE6</span></span>, <span class="hljs-number"><span class="hljs-number">0x437</span></span>: <span class="hljs-number"><span class="hljs-number">0xE7</span></span>, <span class="hljs-number"><span class="hljs-number">0x438</span></span>: <span class="hljs-number"><span class="hljs-number">0xE8</span></span>, <span class="hljs-number"><span class="hljs-number">0x439</span></span>: <span class="hljs-number"><span class="hljs-number">0xE9</span></span>, <span class="hljs-number"><span class="hljs-number">0x43A</span></span>: <span class="hljs-number"><span class="hljs-number">0xEA</span></span>, <span class="hljs-number"><span class="hljs-number">0x43B</span></span>: <span class="hljs-number"><span class="hljs-number">0xEB</span></span>, <span class="hljs-number"><span class="hljs-number">0x43C</span></span>: <span class="hljs-number"><span class="hljs-number">0xEC</span></span>, <span class="hljs-number"><span class="hljs-number">0x43D</span></span>: <span class="hljs-number"><span class="hljs-number">0xED</span></span>, <span class="hljs-number"><span class="hljs-number">0x43E</span></span>: <span class="hljs-number"><span class="hljs-number">0xEE</span></span>, <span class="hljs-number"><span class="hljs-number">0x43F</span></span>: <span class="hljs-number"><span class="hljs-number">0xEF</span></span>, <span class="hljs-number"><span class="hljs-number">0x440</span></span>: <span class="hljs-number"><span class="hljs-number">0xF0</span></span>, <span class="hljs-number"><span class="hljs-number">0x441</span></span>: <span class="hljs-number"><span class="hljs-number">0xF1</span></span>, <span class="hljs-number"><span class="hljs-number">0x442</span></span>: <span class="hljs-number"><span class="hljs-number">0xF2</span></span>, <span class="hljs-number"><span class="hljs-number">0x443</span></span>: <span class="hljs-number"><span class="hljs-number">0xF3</span></span>, <span class="hljs-number"><span class="hljs-number">0x444</span></span>: <span class="hljs-number"><span class="hljs-number">0xF4</span></span>, <span class="hljs-number"><span class="hljs-number">0x445</span></span>: <span class="hljs-number"><span class="hljs-number">0xF5</span></span>, <span class="hljs-number"><span class="hljs-number">0x446</span></span>: <span class="hljs-number"><span class="hljs-number">0xF6</span></span>, <span class="hljs-number"><span class="hljs-number">0x447</span></span>: <span class="hljs-number"><span class="hljs-number">0xF7</span></span>, <span class="hljs-number"><span class="hljs-number">0x448</span></span>: <span class="hljs-number"><span class="hljs-number">0xF8</span></span>, <span class="hljs-number"><span class="hljs-number">0x449</span></span>: <span class="hljs-number"><span class="hljs-number">0xF9</span></span>, <span class="hljs-number"><span class="hljs-number">0x44A</span></span>: <span class="hljs-number"><span class="hljs-number">0xFA</span></span>, <span class="hljs-number"><span class="hljs-number">0x44B</span></span>: <span class="hljs-number"><span class="hljs-number">0xFB</span></span>, <span class="hljs-number"><span class="hljs-number">0x44C</span></span>: <span class="hljs-number"><span class="hljs-number">0xFC</span></span>, <span class="hljs-number"><span class="hljs-number">0x44D</span></span>: <span class="hljs-number"><span class="hljs-number">0xFD</span></span>, <span class="hljs-number"><span class="hljs-number">0x44E</span></span>: <span class="hljs-number"><span class="hljs-number">0xFE</span></span>, <span class="hljs-number"><span class="hljs-number">0x44F</span></span>: <span class="hljs-number"><span class="hljs-number">0xFF</span></span> } String.prototype.Win1251_charCodeAt=<span class="hljs-keyword"><span class="hljs-keyword">function</span></span>(char_num){ var char_code=this.charCodeAt(char_num); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (char_code===undefined)?<span class="hljs-number"><span class="hljs-number">0x98</span></span>:Win1251[char_code]; } <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> utf8_decode(<span class="hljs-type"><span class="hljs-type">text</span></span>){ <span class="hljs-type"><span class="hljs-type">text</span></span>=<span class="hljs-type"><span class="hljs-type">text</span></span>.replace(/ /g,"\u00A0"); var char_code, char_code2, char_code3, char_code4; var result_str=<span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(var char_num=<span class="hljs-number"><span class="hljs-number">0</span></span>; char_num&lt;<span class="hljs-type"><span class="hljs-type">text</span></span>.length; char_num++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((char_code=<span class="hljs-type"><span class="hljs-type">text</span></span>.Win1251_charCodeAt(char_num))&lt;<span class="hljs-number"><span class="hljs-number">0x80</span></span> || char_code===<span class="hljs-type"><span class="hljs-type">text</span></span>.charCodeAt(char_num)) result_str+=<span class="hljs-type"><span class="hljs-type">text</span></span>.charAt(char_num);//<span class="hljs-number"><span class="hljs-number">0</span></span>zzzzzzz - <span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>zzzzzzz <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(char_code&gt;=<span class="hljs-number"><span class="hljs-number">0xC0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(char_code&lt;<span class="hljs-number"><span class="hljs-number">0xE0</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( (char_code2=<span class="hljs-type"><span class="hljs-type">text</span></span>.Win1251_charCodeAt(++char_num))&gt;=<span class="hljs-number"><span class="hljs-number">0x80</span></span> &amp;&amp; char_code2&lt;<span class="hljs-number"><span class="hljs-number">0xC0</span></span> )//<span class="hljs-number"><span class="hljs-number">110</span></span>yyyyy <span class="hljs-number"><span class="hljs-number">10</span></span>zzzzzz - <span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-number"><span class="hljs-number">00000</span></span>yyy yyzzzzzz result_str+="&amp;#"+((char_code<span class="hljs-number"><span class="hljs-number">-0xC0</span></span>)*<span class="hljs-number"><span class="hljs-number">0x40</span></span>+(char_code2<span class="hljs-number"><span class="hljs-number">-0x80</span></span>))+";"; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(char_code&lt;<span class="hljs-number"><span class="hljs-number">0xF0</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( (char_code2=<span class="hljs-type"><span class="hljs-type">text</span></span>.Win1251_charCodeAt(++char_num))&gt;=<span class="hljs-number"><span class="hljs-number">0x80</span></span> &amp;&amp; char_code2&lt;<span class="hljs-number"><span class="hljs-number">0xC0</span></span> &amp;&amp; (char_code3=<span class="hljs-type"><span class="hljs-type">text</span></span>.Win1251_charCodeAt(++char_num))&gt;=<span class="hljs-number"><span class="hljs-number">0x80</span></span> &amp;&amp; char_code3&lt;<span class="hljs-number"><span class="hljs-number">0xC0</span></span> )//<span class="hljs-number"><span class="hljs-number">1110</span></span>xxxx <span class="hljs-number"><span class="hljs-number">10</span></span>yyyyyy <span class="hljs-number"><span class="hljs-number">10</span></span>zzzzzz - <span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-number"><span class="hljs-number">00000000</span></span> xxxxyyyy yyzzzzzz result_str+="&amp;#"+((char_code<span class="hljs-number"><span class="hljs-number">-0xE0</span></span>)*<span class="hljs-number"><span class="hljs-number">0x1000</span></span>+(char_code2<span class="hljs-number"><span class="hljs-number">-0x80</span></span>)*<span class="hljs-number"><span class="hljs-number">0x40</span></span>+(char_code3<span class="hljs-number"><span class="hljs-number">-0x80</span></span>))+";"; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( char_code&lt;<span class="hljs-number"><span class="hljs-number">0xF8</span></span> &amp;&amp; (char_code2=<span class="hljs-type"><span class="hljs-type">text</span></span>.Win1251_charCodeAt(++char_num))&gt;=<span class="hljs-number"><span class="hljs-number">0x80</span></span> &amp;&amp; char_code2&lt;<span class="hljs-number"><span class="hljs-number">0xC0</span></span> &amp;&amp; (char_code3=<span class="hljs-type"><span class="hljs-type">text</span></span>.Win1251_charCodeAt(++char_num))&gt;=<span class="hljs-number"><span class="hljs-number">0x80</span></span> &amp;&amp; char_code3&lt;<span class="hljs-number"><span class="hljs-number">0xC0</span></span> &amp;&amp; (char_code4=<span class="hljs-type"><span class="hljs-type">text</span></span>.Win1251_charCodeAt(++char_num))&gt;=<span class="hljs-number"><span class="hljs-number">0x80</span></span> &amp;&amp; char_code4&lt;<span class="hljs-number"><span class="hljs-number">0xC0</span></span> )//<span class="hljs-number"><span class="hljs-number">11110</span></span>www <span class="hljs-number"><span class="hljs-number">10</span></span>xxxxxx <span class="hljs-number"><span class="hljs-number">10</span></span>yyyyyy <span class="hljs-number"><span class="hljs-number">10</span></span>zzzzzz - <span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-number"><span class="hljs-number">000</span></span>wwwxx xxxxyyyy yyzzzzzz result_str+="&amp;#"+((char_code<span class="hljs-number"><span class="hljs-number">-0xF0</span></span>)*<span class="hljs-number"><span class="hljs-number">0x40000</span></span>+(char_code2<span class="hljs-number"><span class="hljs-number">-0x80</span></span>)*<span class="hljs-number"><span class="hljs-number">0x1000</span></span>+(char_code3<span class="hljs-number"><span class="hljs-number">-0x80</span></span>)*<span class="hljs-number"><span class="hljs-number">0x40</span></span>+(char_code4<span class="hljs-number"><span class="hljs-number">-0x80</span></span>))+";"; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result_str; } <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> unescapeTitle(title){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> unescape( utf8_decode(document.title).replace( /&amp;#([<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-9</span></span>]+);/g, <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>(expression, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(isNaN(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>=parseInt(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NaN</span></span>; var i=<span class="hljs-number"><span class="hljs-number">0</span></span>, retval="", radix=<span class="hljs-number"><span class="hljs-number">16</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(i++&lt;<span class="hljs-number"><span class="hljs-number">4</span></span> || <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>){ retval=["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "A", "B", "C", "D", "E", "F"][<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>%radix]+retval; <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>=Math.floor(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>/radix); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> "%u"+retval; } ) ); } document.body.innerHTML=utf8_decode(document.body.innerHTML); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>("vendor" <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> navigator &amp;&amp; navigator.vendor.indexOf("Apple")&gt;<span class="hljs-number"><span class="hljs-number">-1</span></span>){ document.title=unescapeTitle(document.title); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/*@cc_on document.title=unescapeTitle(document.title); return; @*/</span></span> document.getElementsByTagName("title")[<span class="hljs-number"><span class="hljs-number">0</span></span>].innerHTML=utf8_decode(document.title); } );</code> </pre><br><br>  Tested in Firefox 3 and 4;  Opera 9, 10 and 11;  Internet Explorer 5.5, 6, 7, 8;  Google Chrome and Safari are the latest release versions. <br><br>  Of course, this is Kunshtyuk;  I figured out what UTF-8 is.  In an amicable way, the server should not harm its HTTP headers.  But then a philosophical question arises: who better to know the encoding of the document ‚Äî the server (the author .htaccess) or the HTML document itself (its author)?  Perhaps browsers have a good reason to believe the server, and not the <code>meta</code> tag in the document. <br><br></div><p>Source: <a href="https://habr.com/ru/post/118973/">https://habr.com/ru/post/118973/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../118964/index.html">Qt 5 thoughts</a></li>
<li><a href="../118966/index.html">How to become a system administrator - a guide for beginners (Part 2)</a></li>
<li><a href="../118967/index.html">Wanted.VC - Digest of Russian projects seeking investment</a></li>
<li><a href="../118969/index.html">Getting Started with Windows Azure Toolkit for iOS</a></li>
<li><a href="../118972/index.html">Screencast: static analysis of C ++ code</a></li>
<li><a href="../118975/index.html">Important note for free software supporters using Gmail</a></li>
<li><a href="../118976/index.html">Asterisk VoIP - how to fight off hackers or ‚Äúbloopers‚Äù in setting up gateways</a></li>
<li><a href="../118977/index.html">iLab will help the digital revolution in the field of intellectual property</a></li>
<li><a href="../118978/index.html">Friendly text column</a></li>
<li><a href="../118980/index.html">Why Microsoft buys Skype for $ 8.5 billion</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>