<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>RSA encryption in PHP (openssl), Android / Java, JavaScript and Go</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="RSA is a public key encryption algorithm. Public key encryption is a very useful thing. RSA allows you to create two keys: open and closed. Place the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>RSA encryption in PHP (openssl), Android / Java, JavaScript and Go</h1><div class="post__text post__text-html js-mediator-article">  RSA is a public key encryption algorithm.  Public key encryption is a very useful thing.  RSA allows you to create two keys: open and closed.  Place the public key somewhere and encrypt it, and only the owner of the private key can decrypt it. <br><br>  For example, we can make a web store on PCP, which will take orders with credit card data.  A PCP store will encrypt credit card data with an open key.  The php-shop itself will not be able to decrypt these encrypted data.  A good solution, a hacker unexpectedly hacks into a web store (written in PCP), and the cards are encrypted. <br><a name="habracut"></a><br>  But how will the site owner get access to the cards?  He needs to take the ciphertext, the private key and decrypt it.  You can imagine that the private key will be stored in the phone, and the phone can extract the ciphertext from the admin through the QR code.  But in different languages, the implementation of cryptography is slightly different, and my article is just about how to encrypt text in one programming language, and decipher it in another language. <br><br>  What are the differences? <br>  - how keys are stored; <br>  - how the ciphertext is stored: binary form or in base64 encoding; <br>  - padding. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First of all, we need keys.  I propose to create them using openssl <br><br><pre><code class="bash hljs">openssl genrsa -out private.pem 512 openssl rsa -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> private.pem -out public.pem -outform PEM -pubout</code> </pre> <br><br>  To save space on the screen I chose 512 bits, it is advisable to use 1024 or 2048 bits.  For example, SSL gitgub.com uses 2048. <br><br>  The key size also determines the maximum amount of data that you can encrypt, but given that we will use OPENSSL_PKCS1_PADDING (by default in PCP), we must subtract 11 bytes from the key size and we can encrypt 53 bytes with the 512-bit key.  Do not use padding at all is dangerous if you do not know why it is needed. <br><br>  Now we have private.pem and public.pem.  These keys are in text format, and they will be quite convenient to use in the examples.  I want each program to consist of one file, so it will be clearer. <br><br><div class="spoiler">  <b class="spoiler_title">private.pem</b> <div class="spoiler_text"><pre> <code class="bash hljs">-----BEGIN RSA PRIVATE KEY----- MIIBPQIBAAJBALqbHeRLCyOdykC5SDLqI49ArYGYG1mqaH9/GnWjGavZM02fos4l c2w6tCchcUBNtJvGqKwhC5JEnx3RYoSX2ucCAwEAAQJBAKn6O+tFFDt4MtBsNcDz GDsYDjQbCubNW+yvKbn4PJ0UZoEebwmvH1ouKaUuacJcsiQkKzTHleu4krYGUGO1 mEECIQD0dUhj71vb1rN1pmTOhQOGB9GN1mygcxaIFOWW8znLRwIhAMNqlfLijUs6 rY+h1pJa/3Fh1HTSOCCCCWA0NRFnMANhAiEAwddKGqxPO6goz26s2rHQlHQYr47K vgPkZu2jDCo7trsCIQC/PSfRsnSkEqCX18GtKPCjfSH10WSsK5YRWAY3KcyLAQIh AL70wdUu5jMm2ex5cZGkZLRB50yE6rBiHCd5W1WdTFoe -----END RSA PRIVATE KEY-----</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">public.pem</b> <div class="spoiler_text"><pre> <code class="bash hljs">-----BEGIN PUBLIC KEY----- MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALqbHeRLCyOdykC5SDLqI49ArYGYG1mq aH9/GnWjGavZM02fos4lc2w6tCchcUBNtJvGqKwhC5JEnx3RYoSX2ucCAwEAAQ== -----END PUBLIC KEY-----</code> </pre><br></div></div><br><h4>  Let's start with PCP </h4><br>  <b>encode.php</b> <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $pub = &lt;&lt;&lt;SOMEDATA777 -----BEGIN <span class="hljs-keyword"><span class="hljs-keyword">PUBLIC</span></span> KEY----- MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALqbHeRLCyOdykC5SDLqI49ArYGYG1mq aH9/GnWjGavZM02fos4lc2w6tCchcUBNtJvGqKwhC5JEnx3RYoSX2ucCAwEAAQ== -----END <span class="hljs-keyword"><span class="hljs-keyword">PUBLIC</span></span> KEY----- SOMEDATA777; $data = <span class="hljs-string"><span class="hljs-string">"PHP is my secret love."</span></span>; $pk = openssl_get_publickey($pub); openssl_public_encrypt($data, $encrypted, $pk); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> chunk_split(base64_encode($encrypted)); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  <a href="http://goo.gl/Xb7ayw">goo.gl/Xb7ayw</a> <br><br>  We get something of a type (you will receive a new unique ciphertext with each attempt to encrypt the text): <br><br><pre> <code class="bash hljs">JutBa0GLHzGrlygxwWr66cizw4W4za+DbzZweNM0iloCD7xEP9LclL013lcksJL5XhjW44U+oxpq cX1ZSLhWuA==</code> </pre><br>  <b>decode.php</b> <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $key = &lt;&lt;&lt;SOMEDATA777 -----BEGIN RSA <span class="hljs-keyword"><span class="hljs-keyword">PRIVATE</span></span> KEY----- MIIBPQIBAAJBALqbHeRLCyOdykC5SDLqI49ArYGYG1mqaH9/GnWjGavZM02fos4l c2w6tCchcUBNtJvGqKwhC5JEnx3RYoSX2ucCAwEAAQJBAKn6O+tFFDt4MtBsNcDz GDsYDjQbCubNW+yvKbn4PJ0UZoEebwmvH1ouKaUuacJcsiQkKzTHleu4krYGUGO1 mEECIQD0dUhj71vb1rN1pmTOhQOGB9GN1mygcxaIFOWW8znLRwIhAMNqlfLijUs6 rY+h1pJa/<span class="hljs-number"><span class="hljs-number">3</span></span>Fh1HTSOCCCCWA0NRFnMANhAiEAwddKGqxPO6goz26s2rHQlHQYr47K vgPkZu2jDCo7trsCIQC/PSfRsnSkEqCX18GtKPCjfSH10WSsK5YRWAY3KcyLAQIh AL70wdUu5jMm2ex5cZGkZLRB50yE6rBiHCd5W1WdTFoe -----END RSA <span class="hljs-keyword"><span class="hljs-keyword">PRIVATE</span></span> KEY----- SOMEDATA777; $data = <span class="hljs-string"><span class="hljs-string">"JutBa0GLHzGrlygxwWr66cizw4W4za+DbzZweNM0iloCD7xEP9LclL013lcksJL5XhjW44U+oxpq cX1ZSLhWuA=="</span></span>; $pk = openssl_get_privatekey($key); openssl_private_decrypt(base64_decode($data), $out, $pk); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $out; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  <a href="http://goo.gl/0CWTQ9">goo.gl/0CWTQ9</a> <br><br><h4>  Now on go </h4><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"crypto/rand"</span></span> <span class="hljs-string"><span class="hljs-string">"crypto/rsa"</span></span> <span class="hljs-string"><span class="hljs-string">"crypto/x509"</span></span> <span class="hljs-string"><span class="hljs-string">"encoding/base64"</span></span> <span class="hljs-string"><span class="hljs-string">"encoding/pem"</span></span> <span class="hljs-string"><span class="hljs-string">"errors"</span></span> <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"strings"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { b64 := <span class="hljs-string"><span class="hljs-string">`JutBa0GLHzGrlygxwWr66cizw4W4za+DbzZweNM0iloCD7xEP9LclL013lcksJL5XhjW44U+oxpq cX1ZSLhWuA== `</span></span> b1, err := Base64Dec(b64) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">panic</span></span>(err) } b2, err := RsaDecrypt(b1, privateKey) fmt.Println(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>(b2), err) b1, err = RsaEncrypt([]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>(<span class="hljs-string"><span class="hljs-string">"Go the best language"</span></span>), publicKey) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">panic</span></span>(err) } s1 := Base64Enc(b1) fmt.Println(s1) b1, err = Base64Dec(s1) b2, err = RsaDecrypt(b1, privateKey) fmt.Println(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>(b2), err) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Base64Enc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b1 []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { s1 := base64.StdEncoding.EncodeToString(b1) s2 := <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> LEN <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> = <span class="hljs-number"><span class="hljs-number">76</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(s1) &gt; <span class="hljs-number"><span class="hljs-number">76</span></span> { s2 = s2 + s1[:LEN] + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> s1 = s1[LEN:] } s2 = s2 + s1 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s2 } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Base64Dec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s1 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([]</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { s1 = strings.Replace(s1, <span class="hljs-string"><span class="hljs-string">"\n"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) s1 = strings.Replace(s1, <span class="hljs-string"><span class="hljs-string">"\r"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) s1 = strings.Replace(s1, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> base64.StdEncoding.DecodeString(s1) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RsaDecrypt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ciphertext []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([]</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { block, _ := pem.Decode(key) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> block == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, errors.New(<span class="hljs-string"><span class="hljs-string">"private key error!"</span></span>) } priv, err := x509.ParsePKCS1PrivateKey(block.Bytes) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, err } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rsa.DecryptPKCS1v15(rand.Reader, priv, ciphertext) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RsaEncrypt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(origData []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([]</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { block, _ := pem.Decode(key) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> block == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, errors.New(<span class="hljs-string"><span class="hljs-string">"public key error"</span></span>) } pubInterface, err := x509.ParsePKIXPublicKey(block.Bytes) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, err } pub := pubInterface.(*rsa.PublicKey) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rsa.EncryptPKCS1v15(rand.Reader, pub, origData) } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> publicKey = []<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>(<span class="hljs-string"><span class="hljs-string">` -----BEGIN PUBLIC KEY----- MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALqbHeRLCyOdykC5SDLqI49ArYGYG1mq aH9/GnWjGavZM02fos4lc2w6tCchcUBNtJvGqKwhC5JEnx3RYoSX2ucCAwEAAQ== -----END PUBLIC KEY----- `</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> privateKey = []<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>(<span class="hljs-string"><span class="hljs-string">` -----BEGIN RSA PRIVATE KEY----- MIIBPQIBAAJBALqbHeRLCyOdykC5SDLqI49ArYGYG1mqaH9/GnWjGavZM02fos4l c2w6tCchcUBNtJvGqKwhC5JEnx3RYoSX2ucCAwEAAQJBAKn6O+tFFDt4MtBsNcDz GDsYDjQbCubNW+yvKbn4PJ0UZoEebwmvH1ouKaUuacJcsiQkKzTHleu4krYGUGO1 mEECIQD0dUhj71vb1rN1pmTOhQOGB9GN1mygcxaIFOWW8znLRwIhAMNqlfLijUs6 rY+h1pJa/3Fh1HTSOCCCCWA0NRFnMANhAiEAwddKGqxPO6goz26s2rHQlHQYr47K vgPkZu2jDCo7trsCIQC/PSfRsnSkEqCX18GtKPCjfSH10WSsK5YRWAY3KcyLAQIh AL70wdUu5jMm2ex5cZGkZLRB50yE6rBiHCd5W1WdTFoe -----END RSA PRIVATE KEY----- `</span></span>)</code> </pre><br>  <a href="http://play.golang.org/p/nsyAw5kYDt">play.golang.org/p/nsyAw5kYDt</a> <br><br>  Go Playground always give the same random numbers and therefore the result: <br><br><pre> <code class="bash hljs">aOleRSXhBT1XR7Al9cxdmM/8KnM2CvQdnNqnvwtq1ivFJ1aITxJUCuTw8ZRB8mY+elhoiUmC4UjM mwyTKmjqQw==</code> </pre><br><h4>  Javascript encryption </h4><br>  I will encrypt using <a href="http://travistidwell.com/jsencrypt/">jsEncrypt</a> : <br><br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'#but'</span></span>).click(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pub = $(<span class="hljs-string"><span class="hljs-string">'#pub'</span></span>).val(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> crypt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSEncrypt(); crypt.setPublicKey(pub); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = $(<span class="hljs-string"><span class="hljs-string">'#data'</span></span>).val(); $(<span class="hljs-string"><span class="hljs-string">'#out'</span></span>).val(crypt.encrypt(data)); }); });</code> </pre><br>  <a href="http://cossackpyra.github.io/april14/html/encrypt.html">cossackpyra.github.io/april14/html/encrypt.html</a> <br><br>  And received: <br><br><pre> <code class="bash hljs">C2uWXwp6OsxLKnr3cXpJIf/RcPzgjlxNXj8IX2R47binEo2dLFhJISDnOioQaM8kAl/lqSSOCLdrYP12Tc/YXQ==</code> </pre><br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'#but'</span></span>).click(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key = $(<span class="hljs-string"><span class="hljs-string">'#key'</span></span>).val(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> crypt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSEncrypt(); crypt.setPrivateKey(key); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = $(<span class="hljs-string"><span class="hljs-string">'#data'</span></span>).val(); $(<span class="hljs-string"><span class="hljs-string">'#out'</span></span>).val(crypt.decrypt(data)); }); });</code> </pre><br>  <a href="http://cossackpyra.github.io/april14/html/decrypt.html">cossackpyra.github.io/april14/html/decrypt.html</a> <br><br><h4>  Android is not Java </h4><br>  Java is so much and there is no fig. <br><br>  Android has android.util.Base64, and Java 8 is java.util.Base64, and there is also org.apache.commons.codec.binary.Base64. <br><br>  Java does not know how to read certificates in the PEM format, which tasks and goals were set by the creators of java.security and javax.crypto - this is dark, but it‚Äôs not to save space on the disk. <br><br>  In Bouncy Castle there is a <a href="http://www.bouncycastle.org/docs/pkixdocs1.5on/org/bouncycastle/openssl/PEMParser.html">PEMParser</a> .  But Bouncy Castle cannot be picked up by the online editor, and in Android it is not clear what Bouncy Castle is used.  Therefore, there is <a href="https://rtyley.github.io/spongycastle/">Spongy Castle</a> , but this will be another graph in the implementation of cryptography in the form of ‚ÄúSupplement No.  5 to Part 742 ‚Äî Encryption Registration ‚Äùon items 6 and 7 you can‚Äôt say no, no. <br><br><div class="spoiler">  <b class="spoiler_title">SNAP-R</b> <div class="spoiler_text">  (6) What do you think about the products?  (If unsure, please explain.) <br><br>  No. <br><br>  (7) United States?  If yes, provide manufacturing locations.  (Insert ‚Äúnot applicable‚Äù, if you are a provider of encryption products.) <br><br>  No. </div></div><br><br>  Therefore, from private.pem you can remove the module, private and public exhibitors.  (This is valid, I initially created the keys using openssl.) <br><br><pre> <code class="bash hljs">openssl rsa -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> private.pem -text -noout Private-Key: (512 bit) modulus: 00:ba:9b:1d:e4:4b:0b:23:9d:ca:40:b9:48:32:ea: 23:8f:40:ad:81:98:1b:59:aa:68:7f:7f:1a:75:a3: 19:ab:d9:33:4d:9f:a2:ce:25:73:6c:3a:b4:27:21: 71:40:4d:b4:9b:c6:a8:ac:21:0b:92:44:9f:1d:d1: 62:84:97:da:e7 publicExponent: 65537 (0x10001) privateExponent: 00:a9:fa:3b:eb:45:14:3b:78:32:d0:6c:35:c0:f3: 18:3b:18:0e:34:1b:0a:e6:<span class="hljs-built_in"><span class="hljs-built_in">cd</span></span>:5b:ec:af:29:b9:f8: 3c:9d:14:66:81:1e:6f:09:af:1f:5a:2e:29:a5:2e: 69:c2:5c:b2:24:24:2b:34:c7:95:eb:b8:92:b6:06: 50:63:b5:98:41 prime1: 00:f4:75:48:63:ef:5b:db:d6:b3:75:a6:64:ce:85: 03:86:07:d1:8d:d6:6c:a0:73:16:88:14:e5:96:f3: 39:cb:47 prime2: 00:c3:6a:95:f2:e2:8d:4b:3a:ad:8f:a1:d6:92:5a: ff:71:61:d4:74:d2:38:20:82:09:60:34:35:11:67: 30:03:61 exponent1: 00:c1:d7:4a:1a:ac:4f:3b:a8:28:cf:6e:ac:da:b1: d0:94:74:18:af:8e:ca:be:03:e4:66:ed:a3:0c:2a: 3b:b6:bb exponent2: 00:bf:3d:27:d1:b2:74:a4:12:a0:97:d7:c1:ad:28: f0:a3:7d:21:f5:d1:64:ac:2b:96:11:58:06:37:29: cc:8b:01 coefficient: 00:be:f4:c1:d5:2e:e6:33:26:d9:ec:79:71:91:a4: 64:b4:41:e7:4c:84:ea:b0:62:1c:27:79:5b:55:9d: 4c:5a:1e</code> </pre><br>  In Java, it will look like this: <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Private key BigInteger modulus = new BigInteger( "BA9B1DE44B0B239DCA40B94832EA238F40AD81981B59AA687F7F1A75A319ABD9334D9FA2CE25736C3AB4272171404DB49BC6A8AC210B92449F1DD1628497DAE7", 16); BigInteger exp = new BigInteger( "00a9fa3beb45143b7832d06c35c0f3183b180e341b0ae6cd5becaf29b9f83c9d1466811e6f09af1f5a2e29a52e69c25cb224242b34c795ebb892b6065063b59841", 16); //Public Key BigInteger modulus = new BigInteger( "BA9B1DE44B0B239DCA40B94832EA238F40AD81981B59AA687F7F1A75A319ABD9334D9FA2CE25736C3AB4272171404DB49BC6A8AC210B92449F1DD1628497DAE7", 16); BigInteger pubExp = new BigInteger("010001", 16);</span></span></code> </pre><br>  The entire Java 8 program: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.UnsupportedEncodingException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.math.BigInteger; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.KeyFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.PrivateKey; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.PublicKey; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.spec.PKCS8EncodedKeySpec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.spec.RSAPrivateKeySpec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.spec.RSAPublicKeySpec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.spec.X509EncodedKeySpec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.crypto.Cipher; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Base64; <span class="hljs-comment"><span class="hljs-comment">//import javax.xml.bind.DatatypeConverter; public class HelloWorld { public static void main(String[] args) throws Exception { try { byte[] b1 = decrypt("JutBa0GLHzGrlygxwWr66cizw4W4za+DbzZweNM0iloCD7xEP9LclL013lcksJL5XhjW44\nU+oxpqcX1ZSLhWuA=="); String s1 = new String(b1, "UTF-8"); System.out.println(s1); byte[] b2 = encrypt("Java kills".getBytes("UTF-8")); String s2 = Base64.getEncoder().encodeToString(b2); System.out.println(s2); byte[] b3 = decrypt(s2); String s3 = new String(b3, "UTF-8"); System.out.println(s3); } catch (UnsupportedEncodingException e) { e.printStackTrace(); } catch (Exception e) { e.printStackTrace(); } } public static byte[] decrypt(String key) throws Exception { BigInteger modulus = new BigInteger( "BA9B1DE44B0B239DCA40B94832EA238F40AD81981B59AA687F7F1A75A319ABD9334D9FA2CE25736C3AB4272171404DB49BC6A8AC210B92449F1DD1628497DAE7", 16); BigInteger exp = new BigInteger( "00a9fa3beb45143b7832d06c35c0f3183b180e341b0ae6cd5becaf29b9f83c9d1466811e6f09af1f5a2e29a52e69c25cb224242b34c795ebb892b6065063b59841", 16); RSAPrivateKeySpec keySpec = new RSAPrivateKeySpec(modulus, exp); KeyFactory kf = KeyFactory.getInstance("RSA"); PrivateKey privKey = kf.generatePrivate(keySpec); Cipher cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding"); cipher.init(Cipher.DECRYPT_MODE, privKey); byte[] decodedStr = Base64.getDecoder().decode( key.replace("\n", "").replace("\r", "").replace(" ", "")); byte[] plainText = cipher.doFinal(decodedStr); return plainText; } private static byte[] encrypt(byte[] b1) throws Exception { BigInteger modulus = new BigInteger( "BA9B1DE44B0B239DCA40B94832EA238F40AD81981B59AA687F7F1A75A319ABD9334D9FA2CE25736C3AB4272171404DB49BC6A8AC210B92449F1DD1628497DAE7", 16); BigInteger pubExp = new BigInteger("010001", 16); RSAPublicKeySpec keySpec = new RSAPublicKeySpec(modulus, pubExp); KeyFactory kf = KeyFactory.getInstance("RSA"); PublicKey publicKey = kf.generatePublic(keySpec); Cipher cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding"); cipher.init(Cipher.ENCRYPT_MODE, publicKey); // byte[] decodedStr = Base64.decode(key, Base64.DEFAULT); byte[] plainText = cipher.doFinal(b1); return plainText; } }</span></span></code> </pre><br><br>  <a href="http://goo.gl/t27IWw">goo.gl/t27IWw</a> <br>  (You must click Compile, Execute) <br><pre> <code class="bash hljs">ik1Dvev7AffP+mOgxkbnYmpZrN9nGCKEzwCA4qsADcSKZFDYC/32B4uzUNSH8D+yCjBbrE5HUDL6vs6W5idG6Q==</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Android program</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.UnsupportedEncodingException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.math.BigInteger; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.KeyFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.PrivateKey; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.PublicKey; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.spec.RSAPrivateKeySpec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.spec.RSAPublicKeySpec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.crypto.Cipher; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Base64; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestX</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] decrypt(String key) <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> Exception { BigInteger modulus = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BigInteger( <span class="hljs-string"><span class="hljs-string">"BA9B1DE44B0B239DCA40B94832EA238F40AD81981B59AA687F7F1A75A319ABD9334D9FA2CE25736C3AB4272171404DB49BC6A8AC210B92449F1DD1628497DAE7"</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); BigInteger exp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BigInteger( <span class="hljs-string"><span class="hljs-string">"00a9fa3beb45143b7832d06c35c0f3183b180e341b0ae6cd5becaf29b9f83c9d1466811e6f09af1f5a2e29a52e69c25cb224242b34c795ebb892b6065063b59841"</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); RSAPrivateKeySpec keySpec = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RSAPrivateKeySpec(modulus, exp); KeyFactory kf = KeyFactory.getInstance(<span class="hljs-string"><span class="hljs-string">"RSA"</span></span>); PrivateKey privKey = kf.generatePrivate(keySpec); Cipher cipher = Cipher.getInstance(<span class="hljs-string"><span class="hljs-string">"RSA/ECB/PKCS1Padding"</span></span>); cipher.init(Cipher.DECRYPT_MODE, privKey); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] decodedStr = Base64.decode(key, Base64.DEFAULT); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] plainText = cipher.doFinal(decodedStr); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> plainText; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] b1 = decrypt(<span class="hljs-string"><span class="hljs-string">"JutBa0GLHzGrlygxwWr66cizw4W4za+DbzZweNM0iloCD7xEP9LclL013lcksJL5XhjW44U+oxpq\ncX1ZSLhWuA=="</span></span>); String s1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(b1, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); Log.i(<span class="hljs-string"><span class="hljs-string">"TEST"</span></span>, s1); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] b2 = encrypt(<span class="hljs-string"><span class="hljs-string">"Java kills"</span></span>.getBytes(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)); String s2 = Base64.encodeToString(b2, Base64.CRLF); Log.i(<span class="hljs-string"><span class="hljs-string">"TEST"</span></span>, s2); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] b3 = decrypt(s2); String s3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(b3, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); Log.i(<span class="hljs-string"><span class="hljs-string">"TEST"</span></span>, s3); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (UnsupportedEncodingException e) { e.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { e.printStackTrace(); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] encrypt(<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] b1) <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> Exception { BigInteger modulus = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BigInteger( <span class="hljs-string"><span class="hljs-string">"BA9B1DE44B0B239DCA40B94832EA238F40AD81981B59AA687F7F1A75A319ABD9334D9FA2CE25736C3AB4272171404DB49BC6A8AC210B92449F1DD1628497DAE7"</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); BigInteger pubExp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BigInteger(<span class="hljs-string"><span class="hljs-string">"010001"</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); RSAPublicKeySpec keySpec = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RSAPublicKeySpec(modulus, pubExp); KeyFactory kf = KeyFactory.getInstance(<span class="hljs-string"><span class="hljs-string">"RSA"</span></span>); PublicKey publicKey = kf.generatePublic(keySpec); Cipher cipher = Cipher.getInstance(<span class="hljs-string"><span class="hljs-string">"RSA/ECB/PKCS1Padding"</span></span>); cipher.init(Cipher.ENCRYPT_MODE, publicKey); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] plainText = cipher.doFinal(b1); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> plainText; } }</code> </pre></div></div><br><br>  KO: you can encrypt not the text, but the AES key. <br><br>  All spring and good luck. </div><p>Source: <a href="https://habr.com/ru/post/255799/">https://habr.com/ru/post/255799/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255785/index.html">Lumen - a new PHP microframe from the developer Laravel</a></li>
<li><a href="../255787/index.html">How to make a Laser Squad from XCOM: etude for GDB in OSX</a></li>
<li><a href="../255789/index.html">Analysis of external links in MegaIndex and updating the procurement algorithm</a></li>
<li><a href="../255791/index.html">Never Ending Story: a story in the MMORPG</a></li>
<li><a href="../255793/index.html">The results of a single rating web studios 2015</a></li>
<li><a href="../255801/index.html">Overview of malicious browser extensions</a></li>
<li><a href="../255803/index.html">How I did an English simulator, which is used not only by my mother</a></li>
<li><a href="../255805/index.html">MS Lync: Personal Call Identification</a></li>
<li><a href="../255807/index.html">Inno Setup: creating an installer using the example of deploying a C # application</a></li>
<li><a href="../255809/index.html">Localization of WPF pages</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>