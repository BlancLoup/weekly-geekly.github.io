<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Poisson process simulation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 One of the most important processes observed in nature is the Poisson point process. Therefore, it is important to understand how such ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Poisson process simulation</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  One of the most important processes observed in nature is the Poisson point process.  Therefore, it is important to understand how such processes can be modeled.  Modeling methods vary depending on the type of Poisson point process, i.e. the space in which the process proceeds and the homogeneity or heterogeneity of the process.  We will not be interested in the development of a Poisson point flow or with important applications of it in various fields.  To make this material interesting, the reader is strongly advised to read the relevant sections in Feller (1965) and Sinlar (1975) for the main theory and some sections in Trivedi (1982) for IT applications. <br><br>  In the first step, we define the Poisson process on [0; + ‚àû).  The process is completely determined by a family of random events that occur at certain random times 0 &lt;T1 &lt;T2 &lt;... These events can relate to a variety of things, such as bank robbery, the birth of five twins, and an accident involving a Montreal taxi.  If N (t1, t2) is the number of events that occurred during the time interval (t1, t2), then the following two conditions are often met: <br><a name="habracut"></a><br><ul><li>  For disjoint intervals (t1, t2) and (t3, t4), the random variables N (t1, t2) and N (t3, t4) are independent </li><li>  N (t1, t2) is distributed as well as N (0, t2-t1), i.e. the distribution of the number of events for a certain time depends only on the length of this interval. </li></ul><br><br>  The surprising fact is that these two conditions imply that all random variables N (t1, t2) are distributed according to the Poisson law and that there is a nonnegative constant Œª such that N (t, t + a) is distributed according to the law Po (Œªa ) for any non-negative t and a&gt; 0.  See, for example, Feller (1965).  Thus, the Poisson distribution occurs quite naturally. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The previous concept can be generalized to R <sup>d</sup> .  Let A be some subset of R <sup>d</sup> , and N a random variable taking only integer values.  Let X <sub>1</sub> , ... X <sub>N</sub> be a set of random vectors taking a value in A. Then we say that X <sub>i</sub> define a uniform or homogeneous Poisson process on A if <br><br><ul><li>  For any finite set of pairwise disjoint subsets of the set A  <sub>i of</sub> finite volume of the event N (A <sub>1</sub> ), ..., N (A <sub>k are</sub> independent </li><li>  For any Borel subset B of set A, the distribution N (B) depends only on the volume of set B </li></ul><br><br>  <i>Translator's note: It would be better to use the word "measure", but for those who are not keen on mathematics, then they would have to explain with a dozen pages, or even more.</i> <br><br>  Again, these assumptions imply that all N (B) are distributed according to the law P (ŒªVol (B)) for some non-negative Œª, which we call intensity, or intensity parameter of a homogeneous Poisson process on A. Examples of such processes in a multidimensional Euclidean space include bacteria on a petri dish and murder sites in Houston. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cca/c7a/b95/ccac7ab95d0f88b53ba0900d1c4b5262.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/58b/a12/8ba/58ba128bacc5d47ceac989a45718f6d5.png" alt="image"><br><br><h4>  Simulation of homogeneous Poisson processes </h4><br>  If we need to model a uniform Poisson process on a set A belonging to R <sub>d</sub> , then we need to generate a certain number of random vectors X <sub>i</sub> from A. By Theorem 1.1, this can be done as follows: <br><br> <code>    N   ŒªVol(A)</code> <br> <code>    X1,..,XN,    </code> <br> <code>RETURN 1,...,N</code> <br> <br>  To generate the value of N, it is useless to use an algorithm with an average complexity of O (1), since at the end of the algorithm, we will spend at least Œ© (n) operations.  Therefore, if this algorithm is used, it is strongly recommended to generate a Poisson random variable with a very simple algorithm (with an average time growing as O (Œª)).  For certain sets A, you can use other methods that do not require explicit generation of a Poisson random variable.  There are three cases that we use to illustrate this. <br><br><ol><li>  A = [0; + ‚àû) </li><li>  A - circle </li><li>  A - rectangle </li></ol><br><br>  To do this, we need an interesting connection between the Poisson process and the exponential distribution. <br><img src="https://habrastorage.org/getpro/habr/post_images/54b/648/7b8/54b6487b8de21737f1f61f9af69b249a.png" alt="image"><br><br>  Theorem 1.2 suggests the following method for simulating a uniform Poisson process on A = [0; + ‚àû) <br><br> <code>T = 0 (    "")</code> <br> <code>k = 0 (  )</code> <br> <code>REPEAT</code> <br> <code>    </code> <br> <code>k = k + 1</code> <br> <code>T = T + E/Œª</code> <br> <code>T[k] = T</code> <br> <code>UNTIL  (  ;      )</code> <br> <br>  This algorithm is easy to implement, since there is no need to generate Poisson random variables.  For other simple sets A, there are trivial generalizations of Theorem 1.2.  For example, when A = [0, t] x [0,1], where t can be equal to infinity, 0 &lt;T1 &lt;T2 &lt;... is a uniform Poisson process with intensity Œª and U1, U2, ... is a sequence of independent equally distributed uniformly on [0,1] of random variables, then (T1, U1), (T2, U2), ... determine the Poisson process with intensity Œª on A. <br><br><h5>  Example 1.1. </h5>  Uniform Poisson process on the unit circle <br>  If A is a circle with a unit radius, then different properties of the uniform Poisson process can be used to obtain several methods of generation (which are generalized to d-dimensional spheres).  Let Œª be the desired intensity. <br>  First, we could simply generate a random Poisson value N with the parameter ŒªœÄ, and then return a sequence of N independent identically distributed uniformly on the unit circles of vectors.  If we apply the order statistics method proposed by Theorem 1.2, then a Poisson random variable is obtained implicitly.  For example, going to the polar coordinates (R, œÜ), we note that for a uniform Poisson process, R and œÜ are independent, and the random variable R has a density of 2r, r varies from 0 to 1, and œÜ is uniformly distributed on [0; 2œÄ].  Thus, we can proceed as follows: Generate a uniform Poisson process 0 &lt;œÜ1 &lt;œÜ2 &lt;... &lt;œÜN with the intensity parameter Œª / (2œÄ) to [0; 2œÄ] by the exponential method and return (œÜ1, R1), ..., (œÜN, RN), where Ri are independent identically distributed random variables with a density of 2r on [0; 1], which can be generated by taking a maximum of two random variables uniformly distributed on [0; 1].  There is no special reason to apply the exponential method to the corners.  In the same way we could pick up the radii.  Unfortunately, ordinal radii do not form a one-dimensional uniform Poisson process on [0; 1].  However, they nonetheless form a non-uniform Poisson process, and the generation of such processes will be discussed in the next section. <br><br><h4>  Heterogeneous Poisson processes </h4><br>  There are situations when events occur at "random times", but some moments are more possible than others.  This is a case of arrivals at intensive care centers, job offers at computer centers and injuries to NHL players.  For these cases, a very good model is the model of the inhomogeneous Poisson process, defined here for the sake of convenience at [0; + ‚àû).  This is the most important case, since time is most often a ‚Äúrunning variable‚Äù. <br>  The inhomogeneous Poisson process on [0; + ‚àû) is determined by a nonnegatively defined intensity function Œõ (t), which can be considered as some kind of density with the difference that its integral over [0; + ‚àû) is not necessarily equal to 1 (usually, it diverges ).  The process is defined by the following property: for any finite collection of non-intersecting intervals A1, A2, ..., Ak, the number of events occurring in these intervals (N1, ..., Nk) are independent Poisson random variables with parameters <img height="50" src="https://habrastorage.org/getpro/habr/post_images/1a8/74b/b70/1a874bb7000caf95aeb54403561c7beb.png" alt="image"><br><br>  Now consider how such processes can be modeled.  In the simulation, we understand that the points in time when events occur, 0 &lt;T1 &lt;T2 &lt;... must be specified in ascending order.  Much work on modeling inhomogeneous Poisson processes was done by Lewis and Schedler (1979).  This entire section is a revised version of their work.  It is interesting to observe that the general principles of generation of continuous random variables can be extended: we will see that there are analogues by the method of inversion, deviation, and composition. <br>  The role of the distribution function will be taken by the integrated intensity function. <img height="50" src="http://s019.radikal.ru/i642/1401/fc/773c5e2f223d.png" alt="image"><br><br>  We begin by noting that if T <sub>n</sub> = T, then T <sub>n + 1</sub> -T <sub>n</sub> has a distribution function <img height="50" src="https://habrastorage.org/getpro/habr/post_images/f46/c23/133/f46c2313327540e82080c459b1bda86c.png" alt="image"><br><br>  if the function Œõ (t) increases unboundedly with increasing t.  This follows from the fact that <img src="https://habrastorage.org/getpro/habr/post_images/159/ca9/fee/159ca9fee121b0f23daf3368b2ae1282.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e08/9d3/dde/e089d3dde7e4a2180c77e88455772558.png" alt="image"><br><br>  In other words, we need to convert Œõ.  Formally, we have (see also Sinlar (1975) or Brettley, Fox and Schrage (1983)) an algorithm based on inverting the integral of the intensity function (inversion method) <br><br> <code>T = 0 ( )</code> <br> <code>k = 0 ()</code> <br> <code>REPEAT</code> <br> <code>    E</code> <br> <code>k = k+1</code> <br> <code>T = T + InvŒõ(E+Œõ(T)), (InvŒõ -    Œõ)</code> <br> <code>T[k] = T</code> <br> <code>UNTIL False</code> <br> <br><h5>  Example 1.2.  Homogeneous Poisson process </h5><br>  For the special case of Œª (t) = Œª, Œõ (t) = Œªt, it is easy to see that InvŒõ (E + Œõ (T)) = T + E / Œª, as a result of which we again obtain the exponential method. <br><br><h5>  Example 1.3. </h5><br>  To simulate the morning flow of cars before the rush hour, we can sometimes take Œª (t) = t, then Œõ (t) = t ^ 2/2 and get a step <img src="https://habrastorage.org/getpro/habr/post_images/ae9/b47/cb9/ae9b47cb9e976b363e2c1356b6caa787.png" alt="image"><br><br>  If the intensity function can be represented as the sum of the intensity functions, i.e. <img src="https://habrastorage.org/getpro/habr/post_images/4fd/7c0/91a/4fd7c091a44977f2ed92b83d35e6c0c3.png" alt="image">  , <br><br>  0 &lt;T <sub>i1</sub> &lt;T <sub>i2</sub> &lt;... T <sub>in</sub> are independent implementations of individual inhomogeneous Poisson processes, then the combined ordered sequence forms the implementation of a non-uniform Poisson process with intensity function Œª (t).  This refers to the composition method, but the difference now is that we need implementations of all the components of the process.  Decomposition can be used when there is a natural decomposition dictated by the analytical form Œª (t).  Since the main operation in merging processes is to take the minimum value of n processes, for large n, storage of points of time on an heap of n elements can give an advantage. <br><br>  As a result, we obtain the composition method: <br><br> <code> T[1,1],...,T[n,1]  n             </code> <br> <code>T = 0 ( )</code> <br> <code>k = 0</code> <br> <code>REPEAT</code> <br> <code>   T[i,j]     </code> <br> <code>k = k + 1</code> <br> <code>T[k] = T[i,j]</code> <br> <code> T[i,j+1]    </code> <br> <code>UNTIL False</code> <br> <br>  The third general principle is the principle of thinning (Lewis and Schedler, 1979).  Similarly to what happens in the deviation method, we assume that there is a light dominant intensity function Œª (t) &lt;= Œº (t) for any t. <br><br>  Then the idea is to generate a homogeneous Poisson process on a part of the positive half-plane between 0 and Œº (t), then consider a homogeneous Poisson process under Œª and, finally, return the x-components of events in this process.  This requires the following theorem. <br><br><img src="http://s006.radikal.ru/i214/1401/2b/ed6c6bbd8126.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/fdd/67f/c4b/fdd67fc4b62db3f6ec0f1b5ee3c88e38.png" alt="image"><br><br>  Now consider the thinning method of Lewis and Schedler: <br><br> <code>T = 0</code> <br> <code>k = 0</code> <br> <code>REPEAT</code> <br> <code> Z,          Œº,      T.  T = Z</code> <br> <code>    [0;1]   U</code> <br> <code>IF U &lt;= Œª(Z)/Œº(Z)</code> <br> <code>THEN k = k + 1, X[k] = T</code> <br> <code>UNTIL False</code> <br> <br>  It is argued that the sequence X <sub>k</sub> so generated forms an inhomogeneous Poisson process with an intensity function Œª.  Note that we took the inhomogeneous process 0 &lt;Y1 &lt;Y2 &lt;... with the intensity function Œº and removed some points.  As far as we know, (Y <sub>i</sub> , U <sub>i</sub> Œº (Y <sub>i</sub> ) is a homogeneous Poisson process with unit intensity on the curve, if U <sub>i is</sub> independent randomly distributed uniformly on [0; 1] random variables by virtue of Theorem 1.3. Thus, the subsequence on the curve Œª defines a homogeneous Poisson process with unit intensity on this curve (part 3. of Theorem 1.3). Finally, taking the x-coordinates of only this subsequence gives us a non-uniform Poisson process with an intensity function Œª. <br>  Inhomogeneous Poisson process with an intensity function Œº is usually modeled by the inversion method. <br><br><h5>  Example 1.4.  Cyclic intensity function </h5><br>  The following example also belongs to Lewis and Schedler (1979).  Consider a function with cyclic intensity Œª (t) = Œª (1 + cos (t)) with an obvious choice of the dominant function Œº = 2Œª. <br><br>  Then the simulation algorithm will take the form: <br><br> <code>T = 0</code> <br> <code>k = 0</code> <br> <code>REPEAT</code> <br> <code>    E c  1</code> <br> <code>T = T + E/(2Œª)</code> <br> <code>   [0;1]   U</code> <br> <code>IF U &lt;= (1+cos(T))/2</code> <br> <code>THEN k = k + 1, X[k] = T</code> <br> <code>UNTIL False</code> <br> <br>  Needless to say, we can use the two policemen theorem here to avoid calculating the cosine in most cases. <br><br>  The final word on the efficiency of the algorithm when a non-homogeneous Poisson process on the set [0, t] is modeled.  The average number of events that is necessary from the dominant process is equal to <img src="http://s020.radikal.ru/i708/1401/46/56682f37739a.png" alt="image">  while the average number of returned random variables is <img src="http://s017.radikal.ru/i426/1401/4c/deea5d9a0c4a.png" alt="image"><br>  The ratio of average values ‚Äã‚Äãcan be considered as an objective measure of efficiency, comparable in the spirit of the deviation constant in the standard deviation method.  Note that we cannot use the average value of the ratio, since, in general, it would be equal to infinity due to the positive probability that no value will return. </div><p>Source: <a href="https://habr.com/ru/post/210432/">https://habr.com/ru/post/210432/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../210420/index.html">We write monitoring the availability of tickets for Russian Railways</a></li>
<li><a href="../210422/index.html">We try Audio API on an example of writing a visualizer</a></li>
<li><a href="../210424/index.html">Post preparation for printing</a></li>
<li><a href="../210426/index.html">Convenient switching wifi in access point mode</a></li>
<li><a href="../210428/index.html">MassTransit. Rabbit Rabbit Server based messaging bus (MSMQ) for .Net</a></li>
<li><a href="../210434/index.html">Are you also looking for SQL dependencies manually? Then we go to you! SQL Dynamite, search in database objects</a></li>
<li><a href="../210436/index.html">The beginning of the preparation of the conference AI & BigData Lab</a></li>
<li><a href="../210438/index.html">New free courses of virtual academy of Microsoft Virtual Academy</a></li>
<li><a href="../210442/index.html">Twister: Windows version is available.</a></li>
<li><a href="../210444/index.html">Dungeons & Dragons turned 40 years old</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>