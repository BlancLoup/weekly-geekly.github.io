<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Resuscitation Tester Marcus</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Santa Claus put me under a Christmas tree tester of electronic components in the form of a Chinese clone of the widely known tester Marcus in narrow c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Resuscitation Tester Marcus</h1><div class="post__text post__text-html js-mediator-article">  Santa Claus put me under a Christmas tree tester of electronic components in the form of a Chinese clone of the widely known tester Marcus in narrow circles. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5a2/ec5/96c/5a2ec596ca3b2bf0df5a8b1b7de4cc08.jpg" alt="image"></div><br>  There should have been a picture of the included tester with the screen gleefully glowing with all the colors of the rainbow, but the hands from one place stuck a charged capacitor into it, the tester happily switched itself off, said ‚Äúoh!‚Äù And refused to work. <br><a name="habracut"></a><br>  Sorry, damn it.  Let's try to repair. <br><br>  1. Go to the <a href="https://yadi.sk/d/yW8xa5NJgUo5z">Yandex disk</a> with diagrams and firmware for all clones known to the <a href="http://vrtp.ru/index.php%3Fshowtopic%3D26994">community</a> .  Fortunately, clone "TS-1" is already there. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2. We study the circuit and the tester board, experimentally finding out that there is a short circuit (short circuit) on the + 5V bus. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/712/9c8/db5/7129c8db5ebfbbe904e37293094cdab7.jpg" alt="image"></div><br>  If the tester is self-powered when a capacitor is connected, then the power is applied to the bus either through the built-in reverse diodes at the inputs of the microcontroller or through the protective assembly DZ2. <br><br>  We unsolder the DZ2, the assembly is alive, the short circuit is in place.  So the most terrible thing happened, the microcontroller burned down. <br><br>  3. Order the Atmega644 microcontroller, TQFP-44 package, 2 pieces, in case something goes wrong. <br><br>  4. While Atmega is traveling from China, we are preparing the tools and are looking for a programmer. <br><br>  We will need: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06a/eeb/8a7/06aeeb8a7fb262ed0b011ca3092d5821.jpg" alt="image"></div><br>  4.1.  Soldering station, a set of tips for a soldering iron, a "third hand" with a magnifying glass, thin-thin tweezers, a good flux (Chinese, but liquid, which is better than rosin), a little bit of solder. <br><br>  Programmers (thanks to <a href="https://habr.com/ru/users/int_13h/" class="user_link">Int_13h</a> for donating the whole box of all sorts of different <a href="https://habr.com/ru/users/int_13h/" class="user_link">things</a> ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/946/2df/e24/9462dfe247aaa9ce25d0408341425611.jpg" alt="image"></div><br>  4.2.  USBasp without case for Atmega, with an adapter 10 pin to 6 pin ISP. <br><br>  4.3.  USB ISP in the case for Atmega (never guess which one is useful). <br><br>  4.4.  USB / UART 5V converter from a mobile phone for flashing the U4 power controller (STC15L104W). <br><br>  Since  controller loves 3.3V; on the montage we assemble the stabilizer 5-&gt; 3.3V on the basis of LM1117: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f99/e63/df7/f99e63df7e2a5939d1175ac5a2745e8e.jpg" alt="image"></div><br>  It turns out that the stabilizer without load does not work.  We hang on the output of a resistor, for example, 2.2 kŒ©.  We install at the output exactly 3.3 V with a voltmeter and a potentiometer. <br><br>  5. We finally got an envelope with microcontrollers. <br><br>  6. Disassemble the burned-out microcontroller with a hair dryer, clean the pads, lubricate with flux, solder a new one.  Thin sting, each leg.  But first in the corners.  They say you can and hairdryer, but there is no solder paste. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b68/156/d0d/b68156d0d0f1108d842f5c8bd9d55475.jpg" alt="image"></div><br>  For the first time, even pretty. <br><br>  At the same time solder the connector for in-circuit programming.  Make sure the wiring for the 10to6 adapter is correct, and solder the connector to the other side of the board. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc1/448/f05/fc1448f05d174508d61f3f041b9122de.jpg" alt="image"></div><br>  And of course we will provide a battery connector.  Total: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c95/6fd/4c0/c956fd4c05c84e32eb2e4917b1329ec2.jpg" alt="image"></div><br>  7. Getting ready to flash the U4 power controller.  Solder a USB-UART converter with a stabilizer to the board: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d8/9c1/076/8d89c1076ed671e7554fdba4f62725c2.jpg" alt="image"></div><br>  3.3V to 3.3V, Gnd to Gnd, Tx to P1, Rx to P2. <br><br>  8. We are looking for software stc-isp6.86.rar <a href="http://www.stcmicro.com/rjxz.html">on the manufacturer's website</a> . <br><br>  9. Connect the converter, wait for it to be detected by the system, start the software, select the com-port, select the firmware from the archive (item 1), set the frequency to 12 MHz, power on, the processor starts, does not go into boot mode, the programmer is not detected . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e39/c99/808/e39c99808f38c73c210abb6fcca2b4e4.png" alt="image"></div><br>  9.1.  We experiment with the order of power supply to the processor and pressing the buttons "Check MCU" &amp; "Download / Program". <br><br>  9.2.  We study the datasheet on U4, we find that the Test button of the tester is connected to the Reset pin.  We press "Check MCU", we press the Test button, the microcontroller resets and is detected.  In the same way, run the firmware, and finally flash U4. <br><br>  10. We study the abundance of software for Atmega firmware. <br><br>  10.1.  We install the powerful and convenient Atmel Studio 6.2, we find out that it does not support USBasp and USB ISP programmers.  Demolish <br><br>  10.2.  We are looking for Avrdude and a graphical shell to it.  Of all the abundance, we stop at the intuitive Avrdude_prog 3.3, which understands USBasp, understands * .hex and * .eep firmware, and is able to visually display selected fyuzy.  Connect, run: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/692/b1a/11d/692b1a11d8382671e34cc274f95c3c74.png" alt="image"></div><br>  Bummer-s, the programmer has too old firmware. <br><br>  10.3.  This is where USB ISP comes in handy, the software of which is not so friendly, but it is capable of inserting a programmer‚Äôs firmware.  And maybe the tester will flash it?  Alas: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5d1/af8/34d/5d1af834de5bfa36fcf8ab314a4875da.png" alt="image"></div><br>  10.4.  We are looking for a new firmware on USBasp, we connect USB ISP and USBasp with a loop, we close jumper J1 to USBasp, entering it into programming mode.  Fill the firmware.  Success! <br><br>  10.5.  Inspired with success, we are trying to flash USB ISP in USBasp.  Solder the jumper to the board by the method, first back up the firmware and fuses. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b58/382/143/b583821437b177b18dacb4622ac5e5c0.png" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc1/cff/8d8/dc1cff8d85587bd329d1b2505a67f762.png" alt="image"></div><br>  10.6.  We sew. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b01/d69/041/b01d69041aee244899ecce25e52074e6.png" alt="image"></div><br>  Solder jumper.  We connect the former USB ISP and computer and do not detect it with software.  Can confuse with fyuzami?  Then we'll figure it out.  Sorry!  But you have fulfilled your goal and you can rest in peace for the time being. <br><br>  10.7.  Goto 10.2.  But now our programmer is already sewing Atmega successfully. <br><br>  11. We worry about the success of the operation. <br><br>  12. Run the tester.  Bingo! <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/A1jE6GX5cuA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Measurements are underway, but there were some drawbacks as well - the tester almost instantly turns off after the measurement process, and you can‚Äôt have time to take readings. <br><br>  In the next series: attempts to make your firmware for the tester to eliminate the effect of instantaneous disconnection.  The firmware will be based on the <a href="https://www.mikrocontroller.net/svnbrowser/transistortester/Software/Markus/">source code of Marcus</a> .  And also, as I tried, but could not love the AVR. </div><p>Source: <a href="https://habr.com/ru/post/444152/">https://habr.com/ru/post/444152/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444136/index.html">Integration of AppCenter and GitLab</a></li>
<li><a href="../444138/index.html">3D scanners in the automotive industry: 4 advantages and 4 successful projects</a></li>
<li><a href="../444142/index.html">How to fail the introduction of CRM-system?</a></li>
<li><a href="../444144/index.html">XXH3: a new record for hashing speed</a></li>
<li><a href="../444148/index.html">BionicSoftHand - safe and flexible robotic arm with artificial intelligence from Festo</a></li>
<li><a href="../444156/index.html">Balanced site indicators. Part 4: External Optimization</a></li>
<li><a href="../444160/index.html">[Habr]: About the "glass ceiling"</a></li>
<li><a href="../444170/index.html">Publish iOS apps on the App Store with GitLab and fastlane</a></li>
<li><a href="../444174/index.html">GeekBrains invites beginner designers to an educational game.</a></li>
<li><a href="../444176/index.html">Basic ciphers in plain language</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>