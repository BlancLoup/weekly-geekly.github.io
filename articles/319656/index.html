<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CodeceptJS - modern end2end tests for NodeJS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the world of NodeJS, total chaos is created, new frameworks appear every day, the dependencies of the usual package.json grow by hundreds of megaby...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CodeceptJS - modern end2end tests for NodeJS</h1><div class="post__text post__text-html js-mediator-article"><p> <a href="http://codecept.io/"><img src="https://habrastorage.org/files/5b6/f7f/180/5b6f7f180bfc4fe79e9356a7c92dcef3.png" alt="image"></a> </p><br><p>  In the world of NodeJS, total chaos is created, new frameworks appear every day, the dependencies of the usual package.json grow by hundreds of megabytes, and the library that you added to the project yesterday, today is already obsolete.  And if in the world of frontend frameworks, there are already obvious favorites: AngularJS, React, Vue, Ember, then what is completely incomprehensible for acceptance testing.  Each framework provides its own syntax and cool features, and each has its own characteristic set of problems.  For example, each in its own way implements interaction with the browser, each struggling in different ways with asynchrony. </p><br><p>  Oh, this notorious asynchrony ... </p><a name="habracut"></a><br><p>  Yes, asynchrony is cool, but in the context of end-2-end acceptance testing, asynchrony is an eternal problem.  Tests should have a linear view, the sequence of commands: I open the page, I click the button, I want to see the text I need.  Each such command in the context of JS will be executed asynchronously, and therefore such a construction will be written down by a chain of calls: </p><br><pre><code class="hljs pgsql">client .url(<span class="hljs-string"><span class="hljs-string">'https://github.com/nightwatchjs/nightwatch'</span></span>) .waitForElementVisible(<span class="hljs-string"><span class="hljs-string">'body'</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.visible(<span class="hljs-string"><span class="hljs-string">'.container h1 strong a'</span></span>)</code> </pre> <br><p>  (all commands are mixed into one, it is difficult to understand which commands are available) </p><br><p>  or using multiple <em>yield</em> or <em>await</em> : </p><br><pre> <code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">*(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> browser.url(<span class="hljs-string"><span class="hljs-string">'http://google.com'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> browser.click(<span class="hljs-string"><span class="hljs-string">'#link'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> title = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> browser.getTitle() <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(title); }</code> </pre> <br><p>  (the excess of control structures makes the test less readable). </p><br><p>  A test is first of all a code, but it should not only work, it should be easy to read and easily updated. <br>  Ideally, even non-technical personnel, such as a manager or a business analyst, should understand what exactly is being tested in a project and how.  Describing the end2end tests at a low level, we deprive ourselves of this opportunity. </p><br><p>  To solve the problems described above (multi-instrumentality and asynchrony) <a href="http://codecept.io/"><strong>CodeceptJS</strong></a> appeared. </p><br><p>  This is a framework for describing high-level DSL tests.  The tests themselves will be performed by one of the popular libraries to choose from: <strong>webdriverio</strong> , <strong>Protractor</strong> , <strong>NightmareJS</strong> .  In most cases, you will not have to learn the syntax of each of the libraries, but use the ready-made universal API.  Here is a simple test in CodeceptJS: </p><br><pre> <code class="javascript hljs">Scenario(<span class="hljs-string"><span class="hljs-string">'search github'</span></span>, (I) =&gt; { I.amOnPage(<span class="hljs-string"><span class="hljs-string">'https://github.com/search'</span></span>); I.fillField(<span class="hljs-string"><span class="hljs-string">'Search GitHub'</span></span>, <span class="hljs-string"><span class="hljs-string">'CodeceptJS'</span></span>); I.pressKey(<span class="hljs-string"><span class="hljs-string">'Enter'</span></span>); I.see(<span class="hljs-string"><span class="hljs-string">'Codeception/CodeceptJS'</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>); }); Scenario(<span class="hljs-string"><span class="hljs-string">'register'</span></span>, (I) =&gt; { I.amOnPage(<span class="hljs-string"><span class="hljs-string">'https://github.com'</span></span>); within(<span class="hljs-string"><span class="hljs-string">'.js-signup-form'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ I.fillField(<span class="hljs-string"><span class="hljs-string">'user[login]'</span></span>, <span class="hljs-string"><span class="hljs-string">'User'</span></span>); I.fillField(<span class="hljs-string"><span class="hljs-string">'user[email]'</span></span>, <span class="hljs-string"><span class="hljs-string">'user@user.com'</span></span>); I.fillField(<span class="hljs-string"><span class="hljs-string">'user[password]'</span></span>, <span class="hljs-string"><span class="hljs-string">'user@user.com'</span></span>); I.click(<span class="hljs-string"><span class="hljs-string">'button'</span></span>); }); I.see(<span class="hljs-string"><span class="hljs-string">'There were problems creating your account.'</span></span>); });</code> </pre> <br><p>  How does CodeceptJS allow you to write linear scripts for tests?  I will reveal the secret: the global chain of promises is used everywhere, to which new and new teams are added.  Thus, CodeceptJS can easily implement the same <a href="http://codecept.io/pageobjects/">PageObjects</a> : </p><br><pre> <code class="javascript hljs">Scenario(<span class="hljs-string"><span class="hljs-string">'register'</span></span>, (I, RegisterPage) =&gt; { RegisterPage.open(); RegisterPage.register({<span class="hljs-attr"><span class="hljs-attr">login</span></span>: <span class="hljs-string"><span class="hljs-string">'User'</span></span>, <span class="hljs-attr"><span class="hljs-attr">email</span></span>: <span class="hljs-string"><span class="hljs-string">'user@user.com'</span></span>, <span class="hljs-attr"><span class="hljs-attr">password</span></span>: <span class="hljs-string"><span class="hljs-string">'123435'</span></span>}); I.see(<span class="hljs-string"><span class="hljs-string">'There were problems creating your account.'</span></span>); I.click(<span class="hljs-string"><span class="hljs-string">'Explore'</span></span>); });</code> </pre> <br><p>  Thus, we moved the commands from the previous example to the separately created class. </p><br><p>  And indeed, it turned out readable: all commands are described as actions from the first person, selectors minimally overload the code with technical information.  It would seem that you can do to make the test even more readable.  Let's <strong>write it in Russian</strong> ! </p><br><pre> <code class="hljs coffeescript">Scenario(<span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { ._(<span class="hljs-string"><span class="hljs-string">'http://yandex.ru/referats'</span></span>); .(<span class="hljs-string"><span class="hljs-string">"  "</span></span>); ._(<span class="hljs-string"><span class="hljs-string">''</span></span>); .(<span class="hljs-string"><span class="hljs-string">" "</span></span>); .(<span class="hljs-string"><span class="hljs-string">"  "</span></span>); });</code> </pre> <br><p>  Yes, this is a valid JS code that can be executed in NodeJS without any transpilers! </p><br><p>  As already mentioned in the configuration, you can easily choose the engine to complete the tests.  You want a stable and good webdriver API, use <a href="http://codecept.io/acceptance/">WebDriverIO</a> , work with Angulyar - <a href="http://codecept.io/angular/">turn on Protractor</a> , you want to <a href="http://codecept.io/nightmare/">speed up the tests 3 times</a> , abandon the webdriver, and launch the application inside Electron, use Nightmare. </p><br><p>  Of course, it is impossible to embrace the uncomfortable and write the full implementation of all available actions for all engines.  But CodeceptJS allows you to write your own extensions and complement the current functionality.  Yes, this way you will have to work a little with the low-level API of the same webdriverio, but by implementing the necessary functionality you can use it in scripts. </p><br><p>  What else is in CodeceptJS: </p><br><ul><li>  step by step passing tests </li><li>  interactive pause mode </li><li>  test generators, pageobjects, helpers </li><li>  Appium support coming soon </li></ul><br><p>  How to install CodeceptJS?  Not so difficult </p><br><pre> <code class="hljs swift">[sudo] npm install -g codeceptjs codeceptjs <span class="hljs-keyword"><span class="hljs-keyword">init</span></span></code> </pre> <br><p>  Then you will need to select one of the drivers to complete the tests (Protractor, webdriverio, Nightmare) and install the packages for them.  The <code>codeceptjs init</code> command will help you with this and tell you how to write the first test. </p><br><p>  The project has been around for almost a year now. CodeceptJS has been used in British and Brazilian state-owned companies.  It is free and free as MIT. <br>  If you have not tried it yet, you have a great opportunity!  If you already use - write your comments.  And also join the project development. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/319656/">https://habr.com/ru/post/319656/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319644/index.html">Creating Hexagon Grid</a></li>
<li><a href="../319646/index.html">Competition GraphHPC-2017 for the fastest implementation of the task of Betweenness Centrality</a></li>
<li><a href="../319648/index.html">Speed ‚Äã‚Äãreading How to memorize and understand more if you learn to read eight times faster</a></li>
<li><a href="../319652/index.html">Demeter's Law</a></li>
<li><a href="../319654/index.html">7 useful tips on protecting backups from encryption viruses</a></li>
<li><a href="../319658/index.html">PyNSK # 11 - the first meeting of the Pitonists of Novosibirsk in 2017</a></li>
<li><a href="../319660/index.html">The report on the results of "My Circle" for December 2016 and the most popular vacancies of the month</a></li>
<li><a href="../319662/index.html">How we re-opened TFS</a></li>
<li><a href="../319664/index.html">What to fix in the layout before release in production?</a></li>
<li><a href="../319666/index.html">About consumers and types of Threat Intelligence</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>