<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a JMS Application Emulator with JMeter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On Habr√©, there was already a publication devoted to load testing of speakers, interacting via JMS using JMeter. It describes the use of JMeter as a s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a JMS Application Emulator with JMeter</h1><div class="post__text post__text-html js-mediator-article">  On Habr√©, there was already a <a href="http://habrahabr.ru/post/248453/">publication</a> devoted to load testing of speakers, interacting via JMS using JMeter.  It describes the use of JMeter as a source of load, an external system that initiates a business process in our (tested) system.  But what if the process is initiated inside our system, it sends requests to the external system and waits for a response (that is, we need the external system stub)? <br><br>  We had to find the answer to this question during one of the load testing projects. <br><a name="habracut"></a><br>  At that time, we saw two solutions: <br><ol><li>  Writing your own JMS application that implements the simple logic necessary for testing; </li><li>  Using JMeter. </li></ol><br>  The first way promised uncertain labor costs (albeit relatively small) due to the fact that there was no experience in creating JMS applications (even simple ones). <br>  Given the fact that there was some experience with JMeter, thanks to elements like Aggregate Report, you can monitor the work of a future stub in real time, it was decided to stop at the second option. <br><br>  The first step was formulated requirements for our stub: <br><ol><li>  Read the message from the queue; </li><li>  Retrieve the CorrelationId and business data from it to select and send the appropriate response; </li><li>  Wait a certain time (for the emulation of the delay in response from the external system); </li><li>  Send a suitable response with some dynamic data. </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The initial configuration of JMeter is identical to that described in the publication <a href="http://habrahabr.ru/post/248453/">‚ÄúAutomated testing of services using the MQ protocol using JMeter‚Äù</a> , except that <a href="http://jmeter-plugins.org/">JMeter Plugins</a> (specifically, Dummy Sampler for debugging) were also used. <br><br>  As a Thread Group, the test plan was fairly standard (no special regulation of the number of threads during operation was required). <br><br>  Next, add the JMS Subscriber, which is responsible for reading the message from the queue.  The figure below shows the Subscriber settings. <br><br><img src="https://habrastorage.org/files/4a6/839/025/4a68390253fc47e38f92436135966609.PNG"><br><br>  After reading the message from the queue using the View Result Tree, you can see its properties.  An example of the properties of a message being read from the queue is shown below: <br><br><img src="https://habrastorage.org/files/288/92f/8d5/28892f8d58ff4c9997deb339884b9b9e.jpg"><br><br>  To retrieve the JMSCorrelationID (one of the message properties that will allow the queue manager and the application under test to understand which request the message sent by the stub is a response) and business dates (in our case, the value of one of the XML fields of the request that will allow you to select the appropriate answer) Regular Expression Extractor (example of use in the figure below): <br><br><img src="https://habrastorage.org/files/311/060/3f3/3110603f3bff4843959c66514cb9f0d0.PNG"><br><br>  Due to the fact that, according to the NT method, the response delay from the external system was fixed, for its emulation Constant Timer was used (see below), creating a fixed delay between successive requests.  If you need a variable delay during your tests, we recommend that you look at any of the Random Timers. <br><br><img src="https://habrastorage.org/files/e85/5c8/9d5/e855c89d5d8b4aaebf5da79e9063841e.PNG" alt="image"><br><br>  Now, based on the read message, we can choose the appropriate answer.  To do this, use the switch controller: <br><br><img src="https://habrastorage.org/files/367/fb6/acd/367fb6acd8504bea8e409f6b70b352d3.PNG"><br><br>  To send a response to the request inside the Switch controller, we enclose the JMS Publisher samplers with the names corresponding to the possible values ‚Äã‚Äãof the variable p_destination (which was extracted by a regular expression from the Subscriber). <br><br>  Inside the body (Text Message area) of JMS Publisher samplers we add dynamic data using JMeter variables (for example, timestamp, etc.). <br><br>  In the JMS Properties area of ‚Äã‚Äãthe JMS Publisher samplers, add the JMSCorrelationId with the ID value: $ {corrId}. <br><br><img src="https://habrastorage.org/files/8f8/c52/d47/8f8c52d47b4b48d1a6f47ab11322d908.PNG"><br><br>  To analyze the statistics of the work, you can add the Aggregate Report, which allows you to analyze the statistics of the stub in terms of the number of received and sent messages. <br><br>  To summarize, let us once again dwell on the advantages of creating a JMS stub using JMeter compared to self-development: <br><ol><li>  Fewer opportunities to shoot yourself in the foot (the amount of code you need to write is minimized, most of the logic can be implemented using JMeter elements); </li><li>  There is a graphical interface and Listener for collecting statistics on the work of the stub, which is not necessary to fasten to the stub yourself; </li><li>  No need to install any additional software to deploy the stub (Tomcat or Glassfish); </li><li>  Startup convenience (runs as a normal JMeter test). </li></ol></div><p>Source: <a href="https://habr.com/ru/post/261767/">https://habr.com/ru/post/261767/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../261753/index.html">Taming the antivirus interface</a></li>
<li><a href="../261755/index.html">Increase LVM disk in virtual machine on the fly</a></li>
<li><a href="../261761/index.html">Algorithmic Information Theory and Randomness of Individual Objects</a></li>
<li><a href="../261763/index.html">Antivirus adventure Vkontakte</a></li>
<li><a href="../261765/index.html">Trade Automation: A Service Engineer's View</a></li>
<li><a href="../261769/index.html">Puns on css</a></li>
<li><a href="../261773/index.html">The formula for calculating the number of days in the month</a></li>
<li><a href="../261775/index.html">Getting Started with Junos PyEZ</a></li>
<li><a href="../261777/index.html">Batcher's even-odd merge sort</a></li>
<li><a href="../261779/index.html">Express analysis of suspicious activity in the web server log</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>