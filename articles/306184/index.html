<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Top Machine Learning Packages in R, Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the most common questions faced by data processing and analysis specialists is ‚ÄúWhich programming language is best used for solving machine lea...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Top Machine Learning Packages in R, Part 2</h1><div class="post__text post__text-html js-mediator-article"> One of the most common questions faced by data processing and analysis specialists is ‚ÄúWhich programming language is best used for solving machine learning problems?‚Äù The answer to this question always leads to a difficult choice between R, Python and MATLAB.  Generally speaking, no one can give an objective answer, which programming language is better.  Of course, the language you choose for machine learning depends on the limitations of the specific task and data, the preferences of the specialist himself and those machine learning methods that need to be applied.  According to the survey about <a href="https://www.kaggle.com/">Kaggle</a> users' favorite tool, 543 out of 1714 prefer to solve R data analysis problems. <br><br>  Now in <a href="https://cran.r-project.org/">CRAN</a> 8341 package is available.  In addition to <a href="https://cran.r-project.org/">CRAN</a> , there are other repositories with a large number of packages.  The syntax for installing any of these is simple: <code>install.packages(‚ÄúName_Of_R_Package‚Äù)</code> . <br><br>  Here are a few packages that you can hardly do without as a data analyst: <code>dplyr, ggplot2, reshape2</code> .  Of course, this is not a complete list.  In this article we will focus more on the packages used in machine learning. <br><a name="habracut"></a><br><h4>  5. <code>randomForest</code> : collect a lot of trees in the forest </h4><br>  The random forest algorithm is one of the most widely used machine learning algorithms.  The randomForest package is used to create a large number of decision trees, after which each observed value is placed in the tree.  The result containing the largest number of values ‚Äã‚Äãis considered final.  To use the randomForest algorithm, you need to make sure that all variables are either numeric or factorial.  The factor can not have more than 32 levels if randomForest is used. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As you may know, the random forest algorithm takes random sets of variables and values ‚Äã‚Äãand builds many trees.  In the end, these trees are combined, and based on the best solution, the class of the dependent variable is determined. <br><br>  Let's take for example the iris data set to build a random forest using the randomForest package. <br><pre> <code class="python hljs">Rf_fit&lt;-randomForest(formula=Species~., data=iris)</code> </pre><br>  You need to execute a line of code similar to the other packages, and you can use a random forest algorithm.  Let's see how it works. <br><pre> <code class="python hljs">print(Rf_fit)</code> </pre><br><pre> <code class="diff hljs">Call: randomForest(formula = Species ~ ., data = iris) Type of random forest: classification Number of trees: 500 No. of variables tried at each split: 2 OOB estimate of error rate: 4.67% Confusion matrix: setosa versicolor virginica class.error setosa 50 0 0 0.00 versicolor 0 47 3 0.06 virginica 0 4 46 0.08</code> </pre><br><pre> <code class="python hljs">importance(Rf_fit)</code> </pre><br><pre> <code class="diff hljs"> MeanDecreaseGini Sepal.Length 10.200682 Sepal.Width 2.673111 Petal.Length 43.116951 Petal.Width 43.246585</code> </pre><br>  You may need to vary the different control parameters of randomForest, for example, the number of variables in each tree, the number of trees that need to be built, etc.  Typically, data analysts perform several iterations and select the best combination. <br><br><h4>  6. <code>nnet</code> : it's all about hidden levels </h4><br>  This is the most widely used and easy-to-read packet for working with neural networks, but its limitation is one level of nodes.  However, according to some studies, more is not required, since they not only do not add a performance model, but also increase the computation time and complexity of the model. <br><br>  This package does not provide any special methods for determining the number of nodes at the hidden level.  Therefore, when big data specialists use nnet, it is always assumed that you need to specify the value between the number of input and output nodes.  The nnet package provides an implementation of the Artificial Neural Networks (ANNs) algorithm, which is based on knowledge of how the human brain works, based on input and output signals.  ANNs are widely used for forecasting in aviation.  In particular, neural networks provide better prediction results using nnet functions than standard prediction methods such as exponential smoothing, regression, etc. <br><br>  R has many packages for building neural networks, for example, nnet, neuralnet, RSNNS.  Let's use the iris dataset for an example again (I suspect you're tired of it already).  Let's try to predict Species with nnet and see how it looks. <br><pre> <code class="python hljs">nnet_model &lt;- nnet(Species~., data=iris, size = <span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre><br><img src="http://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2016/06/Image-12.jpg" alt="image"><br>  In the output neural network, you can see 10 hidden layers, because  we set size = 10 when building a neural network. <br><br>  Unfortunately, there is no easy way to build the resulting neural network, but on github there are many special functions for this purpose.  For example, to build the network above, <a href="">this one</a> was used. <br><br><h4>  7. <code>e1071</code> : vectors as a support for your model </h4><br>  This is a very important package of the R language, in which there are special functions for implementing the naive Bayes classifier (conditional probability), the Support Vector Machines (SVM) method, Fourier transform, fuzzy clustering, etc.  Let's say the first implementation of SVM in R was exactly in the e1071 package.  Great for cases where, say, you need to determine what is the probability that the person who bought the iPhone 6S, also buys a case for it. <br><br>  This type of analysis is based on conditional probability, so data analysts use the package e1071, where there are functions that implement the naive Bayes classifier. <br><br>  The support vector method is useful if your dataset is not divided into the original dimension, and you need to bring the data to a higher dimension in order to use the classification or regression methods.  SVM uses kernel functions (to optimize mathematical operations) and maximizes the distance between the two classes. <br><br>  The syntax of functions implementing SVM is similar: <br><pre> <code class="python hljs">svm_model &lt;- svm(Species ~Sepal.Length + Sepal.Width, data=iris)</code> </pre><br>  To visualize SVM, we use the <code>plot()</code> function with the corresponding data: <br><pre> <code class="python hljs">plot(svm_model, data = iris[,c(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>)])</code> </pre><br><img src="http://i1.wp.com/www.r-bloggers.com/wp-content/uploads/2016/06/Image-13.jpg" alt="image"><br><br>  The graph above clearly shows the boundaries obtained after applying the SVM to the iris data. <br><br>  There are many parameters that you may need to change to get the best accuracy (kernel, cost, gamma, coefficients, etc.).  To get a good classification using SVM, you have to experiment with many of these parameters: let's say, the kernel can take on different values ‚Äã‚Äã- linear, Gaussian, Cosine. <br><br><h4>  8. <code>kernLab</code> : well packaged kernel </h4><br>  Kernlab takes advantage of the S4 object model in R so that data analysts can use kernel-based machine learning algorithms.  Kernlab has implementations of SVM, nuclear analysis, scalar product primitives, a ranking algorithm, Gaussian processes, and a spectral clustering algorithm.  Methods of machine learning based on nuclei are used when it is difficult to solve the problems of classification, clustering and regression in the observation results space. <br><br>  The Kernlab package is widely used as an SVM implementation that facilitates the task of pattern recognition.  There are many kernel functions, for example, tanhdot (hyperbolic tangent kernel function), polydot (polynomial kernel function), laplacedot (Laplace kernel function) and others used in pattern recognition. <br><br>  Kernfunction is extremely important for SVM.  This method would be impossible without them. <br><br>  SVM is not the only technique using kernels.  There are many other useful and well-known algorithms based on kernels, such as the random vortex method (RVM), nuclear analysis of the main components, dimension reduction, etc.  The kernLab package contains about 20 such algorithms.  KernLab has its own predefined kernels, but the user can create and use their own kernel functions. <br><br>  Let's initialize our own radial basic function with a rms value of 0.01. <br><pre> <code class="python hljs"> Myrbf &lt;- rbfdot(sigma = <span class="hljs-number"><span class="hljs-number">0.01</span></span>) Myrbf</code> </pre><br><pre> <code class="diff hljs">Gaussian Radial Basis kernel function. Hyperparameter : sigma = 0.01</code> </pre><br>  You can recognize the Myrbf class by simply applying the <code>class()</code> function to the newly created object. <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Myrbf)</span></span></span></span></code> </pre><br><pre> <code class="diff hljs">[1] "rbfkernel" attr(,"package") [1] "kernlab"</code> </pre><br>  Each core takes as input two vectors and returns their scalar product.  Let's define two vectors and see their scalar product. <br><pre> <code class="python hljs"> x&lt;-rnorm(<span class="hljs-number"><span class="hljs-number">10</span></span>) y&lt;-rnorm(<span class="hljs-number"><span class="hljs-number">10</span></span>) Myrbf(x,y)</code> </pre><br><pre> <code class="diff hljs"> [,1] [1,] 0.8443782</code> </pre><br>  We created two random, normally distributed variables, x and y, each with 10 values, and calculated their scalar product using the Myrbf kernel function. <br><br>  Let's take a look at SVM using the Myrbf kernel function.  Again, use the iris dataset to understand how SVM works with kernLab. <br><pre> <code class="python hljs"> Kernlab_svm &lt;- ksvm(Species ~ Sepal.Length + Sepal.Width, data = iris, kernel = Myrbf, C=<span class="hljs-number"><span class="hljs-number">4</span></span>) Kernlab_svm</code> </pre><br><pre> <code class="diff hljs">Support Vector Machine object of class "ksvm" SV type: C-svc (classification) parameter : cost C = 4 Gaussian Radial Basis kernel function. Hyperparameter : sigma = 0.01 Number of Support Vectors : 103 Objective Function Value : -95.3715 -70.6262 -291.6249 Training error : 0.2</code> </pre><br>  Let's use the newly built SVM to predict: <br><pre> <code class="python hljs"> predicted&lt;-predict(Kernlab_svm,iris) table(predicted = predicted, true = iris$Species)</code> </pre><br><pre> <code class="diff hljs"> true predicted setosa versicolor virginica setosa 49 0 0 versicolor 1 37 16 virginica 0 13 34</code> </pre><br><h4>  Conclusion </h4><br>  Each package or function in R has its own default values.  Before applying any algorithm, it makes sense to find out what options are available.  The default values ‚Äã‚Äãwill give you some result, but there is no certainty that it will be the most optimal or accurate. <br><br>  In <a href="https://cran.r-project.org/">CRAN</a> there are other packages for machine learning, for example, <code>igraph, glmnet, gbm, tree, CORElearn, mboost</code> and others. They are used in various fields to build the most efficient models.  You may encounter situations when changing one parameter completely changes the type of output data.  Therefore, you should not rely so much on the default values: examine your data and requirements before applying any algorithm. </div><p>Source: <a href="https://habr.com/ru/post/306184/">https://habr.com/ru/post/306184/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../306170/index.html">Mango CRM System Overview</a></li>
<li><a href="../306176/index.html">HTTPoxy vulnerability can redirect web application http requests</a></li>
<li><a href="../306178/index.html">Balancing two providers based on BGP and EEM</a></li>
<li><a href="../306180/index.html">Networks For The Littlest. Micro issue ‚Ññ6. MPLS L3VPN and Internet Access</a></li>
<li><a href="../306182/index.html">Safety of railways from open sources</a></li>
<li><a href="../306186/index.html">How to represent your own company</a></li>
<li><a href="../306188/index.html">Development for SailfishOS: Basics</a></li>
<li><a href="../306190/index.html">Security Week 29: Ubuntu forum leak, proxy vulnerability in PHP, Go and Python, 276 Oracle patches</a></li>
<li><a href="../306194/index.html">‚ÄúIs this your backup so tired?‚Äù *</a></li>
<li><a href="../306196/index.html">Asyncpg released - PostgreSQL client library for Python / asyncio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>