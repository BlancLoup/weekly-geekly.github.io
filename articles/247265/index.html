<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Evolution of Zeus. Part III</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The previous part is here . 


 Crusade 
 At the end of March 2012, Microsoft conducted a set of activities, codenamed Operation b71 , aimed at disabl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Evolution of Zeus. Part III</h1><div class="post__text post__text-html js-mediator-article">  The previous part is <a href="http://habrahabr.ru/post/161861/">here</a> . <br><img src="https://habrastorage.org/getpro/habr/post_images/145/026/8bb/1450268bbb2da3032d4444163897609d.png" alt="image"><br><a name="habracut"></a><br><h4>  <b>Crusade</b> </h4><br>  At the end of March 2012, Microsoft conducted a set of activities, codenamed <a href="http://xakep.ru/2012/03/27/58477/">Operation b71</a> , aimed at disabling some elements of the Zeus infrastructure, as well as SpyEye and Ice IX (a project based on the source code of Zeus).  As a result, the work of the command servers on two hosting sites was terminated: in the cities of Scranton (Pennsylvania) and Lombard (Illinois).  Also, two IP addresses and about 800 domains were removed from the botnet management structure. <br><br>  This operation has been heavily <a href="http://artemonsecurity.blogspot.com/2012/04/microsoft-zbot.html">criticized</a> by the IT security community.  In particular, Fox-IT specialists noted that Microsoft in its reporting documents not only disclosed information about suspects, including authors and individual users, but also completely unrelated persons.  At the same time, all these data were the property of the IT security community and were not subject to disclosure in connection with the conduct of operational search activities.  In addition, some domain names belonged to legal, but hacked resources.  Among other things, it was found that, despite the statement by Microsoft that a disconnection simply occurred for the domain names that were withdrawn, this was not the case and the syncholy process went at full speed, that is, during it not only the IP addresses of the victims were saved, but also recorded HTTP requests with all the headers, which, in fact, could include various confidential information, including user names, email addresses, passwords, etc. <br><br>  In addition, this operation almost did not affect the Zeus Gameover botnet.  This is how Microsoft works, a lot of PR plus a lot of its colleagues in the workshop for a minute of glory.  The materials feature Slavik and Gribodemon, to whose personalities we will return. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Nevertheless, while promoting the chain of links of cybercriminals, the experts also took the Trojan Citadel and its developer AquaBox under the scope.  He, clearly noticing close attention to his person, at the end of 2012 lay down and stopped the open sale of his product. <br><br>  The decisive impact on the infrastructure of Citadel was dealt in May-June 2013 during the <a href="http://xakep.ru/2013/06/06/60747/">Operation b54</a> event held jointly by Microsoft and the FBI.  The essence of the operation was to remove 4,000 domain names that were used by Citadel.  In fact, 1462 domain names were withdrawn, redirection to Microsoft servers for synchol was made for them.  According to experts of the whole Trojan, Citadel infected about 5 million computers, mainly in the USA, Europe, Hong Kong, Singapore, India and Australia. <br><br>  But here, Microsoft could not help but fix it.  As <a href="http://wwhois.ru/news-kompaniya-microsoft-po-oshibke-zahvatila-bolee-1000-chujih-domenov.html">it turned out</a> , about 1000 domain names belonged to other security companies and were used specifically for monitoring.  This circumstance was noticed by the owner of the tracker abuse.ch Roman H√ºssi, who simultaneously lost about 300 domain names used for syncholy. <br><br>  The ultimate goal of management interception is the distribution of specially configured Microsoft configuration files for Citadel, in which antivirus companies' websites were blocked.  This feature, redirect for sites from the black list, was distinctive for Citadel, it appeared in version 1.3.5.1 of the Rain Edition, it was not in the original Zeus.  And then a natural ethical question arises, and which other commands could potentially be given to Microsoft through ‚Äúits‚Äù config?  In general, it is strange that the Citadel developers have not implemented a digital signature mechanism for the configuration file. <br><br>  Meanwhile, Citadel developers continued closed sales.  In June 2013, Trend Micro experts <a href="http://securityblog.s21sec.com/2013/06/citadel-hasnt-gone.html">discovered</a> Citadel version 3.1.0.0, which had the function of distributing via USB devices.  And in July, there were <a href="http://www.computerworld.com/article/2484295/security0/citadel-malware-active-on-20-000-pcs-in-japan.html">reports</a> in the press that the banking systems of Japan were attacked with just this version.  Nine command servers were identified and accessed from about 20,000 unique IP addresses, with 96% of the infected systems located in Japan. <br><br><h4>  <b>Hype and confusion</b> </h4><br>  While the security men were struggling with numerous variations of Zeus version 2 (a small digression - information about the x64 version of Zeus 2 with C &amp; C on the TOR network from December 2013 <a href="http://securelist.ru/blog/sobytiya/15577/alyans-bogov-64-bitnyj-zevs-i-tor-v-pomoshh/">here</a> ), <a href="http://blog.fox-it.com/2013/07/25/analysis-of-the-kins-malware/">KINS</a> - Kasper Internet Non Security appeared on the underground scene.  According to Fox-IT, the private version of KINS, based almost entirely on Zeus source codes, has been used since December 2011 to attack the banking systems of Germany and the Netherlands.  And then some confusion begins.  The fact is that close attention to KINS was paid much later, in 2013. <br><br>  As already mentioned here, in 2012-2013, a wave of operations against banking Trojans took place.  In addition to Operation b71 and Operation b54, in 2012, mass arrests of cyber-group members using Carberp, which ended with the arrest of Carberp developers in Ukraine in March 2013, were made.  One way or another, the underground since 2012 has become an urgent need for another tool with appropriate support for bank robberies. <br><br>  Apparently, the name KINS later began to be used as a kind of brand, that is, in 2013 they released a relatively new product, which the security officers began to call after the old one - KINS.  However, it is more correct to call this version a PowerZeus or ZeusVM. <br><br>  Distinctive features of this version: <br><br><ul><li>  using VMProtect to obstruct its analysis (hence ZeusVM); </li><li>  Detection of the execution of your code in the environment of virtual machines and sandboxes; </li><li>  use SSL to communicate with the command center; </li><li>  deleting your startup key at startup and restoring before rebooting. </li></ul><br>  In addition, it is noticeable that the base for the dropper served as <a href="https://damagelab.org/index.php%3Fshowtopic%3D23875">PowerLoader 2</a> (hence the PowerZeus).  In fact, it uses the source code of the Zeus and SpyEye grabbers as a dll as modules.  The French researcher Xylitol conducted his KINS <a href="http://www.xylibox.com/2013/09/having-look-on-kins-toolkit.html">study</a> on the basis of source codes, and came to the conclusion that KINS = Zeus 2.0.8.9 + Power Loader 2.0 + SpyEye Plugins.  Interestingly, in the course of his research, Xylitol came out on the KINS developer, he got his Jabber from the hacked KINS test admin.  A rather interesting dialogue took place with the developer. <br><br>  During the dialogue, it turned out that he was hired to develop KINS, but then "something went wrong."  All his work was stolen during hacking, and that KINS source code, which was merged into the network, is a very raw alpha of the final product.  Anyway, the development and closed sale of KINS is underway, and KINS and ZeusVM have become forks being developed by different teams. <br><br>  ZeusVM, in particular, was used during the <a href="http://www.cert.pl/news/7649/langswitch_lang/en">attacks of the</a> Polish RB systems in the summer of 2013.  A distinctive feature of the attack was that the config with web injections was not downloaded from the Internet (although the URL to the config URL was), but was entirely contained inside one of the sections of the PE file. <br><br>  During the development of ZeusVM, additional features such as the <a href="http://www.xylibox.com/2014/04/zeusvm-and-steganography.html">use of steganography</a> (November 2013) were implemented, when the config after processing xor, rc4 and base64 was introduced into the jpg image, as well as the change of the hook installation mechanism (May 2014) borrowed from Carberp.  The last change, many rushed to announce, as another super cool Zeus and Carberp hybrid called <a href="http://community.websense.com/blogs/securitylabs/archive/2014/06/18/zberp-is-there-anything-to-fear.aspx">Zberp</a> , but in reality this is just another buggy. <br><br>  The current state of affairs shows that, for the most part, cybercriminals have switched from using Citadel to ZeusVM. <br><br><h4>  <b>End of the game?</b> </h4><br>  As you can see, several Zeus forks are developed in parallel by several teams of intruders.  Let's go back to the ‚Äúmain‚Äù Zeus branch called GameOver (aka Murofet).  In total, there are three versions of it: <br><ul><li>  Version 1, distributed since September 2011, first implemented P2P functionality, using DGA as a backup channel; </li><li>  version 2, discovered in February 2012, in this version both the DGA algorithm and the P2P mechanism were improved; </li><li>  version 3, began to spread in July 2014, its distinctive feature is the use of the Fast Flux algorithm for working with a command server, while the P2P functionality has been completely removed. </li></ul><br>  Version 3 appeared after another operation called ‚ÄúTovar‚Äù, conducted from April to June 2014 jointly by the FBI, Europol and a number of companies working in the field of information security, such as CrowdStrike, Dell SecureWorks, Symantec, Trend Micro and McAfee.  In the course of the investigation, it was <a href="http://mignews.com/news/disasters/world/030614_221554_20651.html">established</a> that Zeus GameOver was managed with the help of more than ten servers, which were located on the bulletproof site of one of the hosting providers in Odessa.  Thus, the main control center was deactivated. <br><br>  As a result of the disclosure of the hacker grouping Zeus GameOver, one of the alleged organizers was named - 30-year-old resident of Russia Yevgeny Bogachyov, he was put on the wanted list by the FBI.  He was <a href="http://www.kommersant.ru/doc/2485969">charged in absentia</a> on the basis of intercepted negotiations in one of the chats.  In them, Bogachev, writing under the nicknames Lucky12345 and Slavik, confesses to the interlocutor that he is the creator of the Zeus Trojan. <br><br>  By the way, in 2013, the US authorities announced the arrest of a Russian citizen Alexander Panin, who was detained on June 28 by Interpol officers and extradited from the Dominican Republic to the United States.  January 28, 2014 at the trial in Atlanta Panin admitted that he was one of the SpyEye developers and his pseudonym - Gribodemon.  How to know if it was not through Panin that the law enforcement agencies came to Bogachev? <br><br>  According to Interpol, more than 1 million computers worldwide have been infected with Zeus GameOver, the cumulative financial damage from theft from RBS systems is estimated at 75 million euros.  In addition, through Zeus GameOver, 234,000 computers were installed with the malicious software CryptoLocker, with which the ransom was collected in the amount of 27 million US dollars.  For distribution of Zeus GameOver, the power of the Cutwail botnet and the PonyLoader bootloader were used. <br><br>  In August 2013, experts at the Dell SecureWorks Counter Threat Unit discovered that in addition to the PonyLoader, cybercriminals use the new Upatre loader to distribute the Zeus GameOver.  Its file is small and extremely simple.  Upatre uses an SSL connection to download and run the necessary malicious file, whose URL is hard-coded inside the loader code.  Like the Pony Loader, Upatre was distributed via the Cutwail spam botnet as an attachment, which is a zip archive. <br><br>  Since the end of January, the scheme has been slightly improved, the Zeus GameOver executable file has been compressed, encrypted with the xor operation using a 32-bit key, and the resulting file has the extension .enc.  When decrypting, the updated version of Upatre reverses this process and gets the original executable file. <br><br>  Since February 2014, <a href="http://stopmalvertising.com/rootkits/analysis-of-zeus-gameover-with-necurs.html">Zeus GameOver has gotten a Necurs rootkit</a> to hide its presence.  The dropper contained x86 and x64 versions of the kernel mode driver.  To raise the privileges, if there are no administrator rights required to install the driver, use the CVE-2010-4398 exploit.  The x64 driver is signed, but since the certificate is not on the list of trusted ones, to bypass PathGuard, the regular bcdedit.exe utility is called to set the TESTSIGNING boot option. <br><br>  Anyway, after the operation ‚ÄúTovar‚Äù Zeus GameOver has not disappeared anywhere.  Its next <a href="http://blog.malcovery.com/blog/breaking-gameover-zeus-returns">version</a> , without P2P, Necurs and with Fast Flux support continues to spread by cybercriminals. <br><br><h4>  <b>New Spiral Coil</b> </h4><br>  In December 2014, Kaspersky Lab employees announced the discovery of a new version of Zeus, called <a href="http://securelist.ru/blog/virus-watch/24549/chthonic-novaya-modifikaciya-zeus">Chthonic</a> .  This version is a kind of hybrid bootloader <a href="https://blog.fortinet.com/post/a-good-look-at-the-andromeda-botnet">Andromeda</a> and ZeusVM.  Chthonic has a modular structure, the following modules have been discovered to date: <br><br><ul><li>  main - the main module (version 4.6.15.0 - v4.7.0.0); </li><li>  info - collection of information about the system; </li><li>  pony - a module to steal stored passwords; </li><li>  klog - keylogger; </li><li>  http - webinject and formgrabber module; </li><li>  vnc - remote access; </li><li>  socks - proxy; </li><li>  cam_recorder - webcam video recording. </li></ul><br>  By the version number you can see that the evolution of Zeus is in full swing.  Moreover, in the summer of 2014, new players in the field of banking Trojans - <a href="https://blogs.rsa.com/new-pandemiya-trojan-emerges-alternative-zeus-based-variants/">Pandemiya</a> and <a href="http://securityintelligence.com/the-father-of-zeus-kronos-malware-discovered">Kronos</a> (a little technical analysis <a href="http://www.lexsi-leblog.com/cert-en/overview-kronos-banking-malware-rootkit.html">here</a> ) appeared on the black market, not using the source codes of Zeus and Carberp. </div><p>Source: <a href="https://habr.com/ru/post/247265/">https://habr.com/ru/post/247265/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../247253/index.html">Java Check State</a></li>
<li><a href="../247255/index.html">How to be friends with STM32</a></li>
<li><a href="../247257/index.html">Fitts law or how to use it</a></li>
<li><a href="../247261/index.html">Integration of PayPal to the site as a payment system and the problem with https</a></li>
<li><a href="../247263/index.html">Dagaz: Factorial is easy!</a></li>
<li><a href="../247267/index.html">Win32 / Virlock - the first self-propagating extortionist</a></li>
<li><a href="../247269/index.html">Interesting on .Net hub for 2014</a></li>
<li><a href="../247271/index.html">PVS-Studio rummaged through the guts of Linux (3.18.1)</a></li>
<li><a href="../247273/index.html">Exploring Hyper-V internal mechanisms: Part 2</a></li>
<li><a href="../247275/index.html">Debugger for a penny: do ST-Link from Maple Mini</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>