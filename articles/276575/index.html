<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Forwarding large files. Automatically receive download links to email</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Users often have to deal with sending large files both within the local network and outside it. For example, Pierrot needs to send Malvina documentati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Forwarding large files. Automatically receive download links to email</h1><div class="post__text post__text-html js-mediator-article">  Users often have to deal with sending large files both within the local network and outside it.  For example, Pierrot needs to send Malvina documentation of 10 gigabytes.  Here corporate mail will not come to the rescue, as users usually do not want to bother with copying links, etc.  If they are in the same local network, then a shared folder will help, and if they are at different ends of the country ... As a rule, you have to use an FTP server, which is often not very convenient, or Internet services for sharing large files. <br><br>  So the idea came to create a convenient and controlled service for sending large files on the local network. <br><br>  Implementation on PowerShell, Windows platform. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Requirements:</b> <br><br><ul><li>  Web server published on the Internet. </li><li>  Share folder on a computer under Windows (to determine the owner of the file). </li><li>  Setting up on the server with the execution of the script on a schedule, once a minute. </li></ul><br>  <b>How it works:</b> <br><br><ul><li>  The user places the ZIP archive in the shared folder on the server. </li><li>  The script searches for ZIP files in the shared folder and moves them to the web server folder, then sends an email to the File <i>Owner</i> . </li><li>  The user receives an email with a link to download the file through your web server. </li><li>  The user sends an email with a link to download to the addressee. </li></ul><br><a name="habracut"></a><br>  <b>Description of the script:</b> <br><br><ul><li>  Delete everything in the target folder that does not have a ZIP extension. </li><li>  Get a list of zip files in the target folder. </li><li>  Search of ZIP files with processing of each file by the Send_URL function. </li><li>  The Send_URL function: determines the Owner of the file, processes the file name, moves the file under the new name to the web server folder, sends the link to the Owner and Administrator (for control) to the file downloading the file, deletes files in the web server folder older than a certain number of days.  For more detailed comments, see the script. </li><li>  Creating a file in a shared folder with the hint name "only ZIP archive, the rest is deleted. Txt". </li></ul><br>  Note: if the user is a member of the Administrators group on the server with a shared folder, then Owner = Administrators group, for this the administrative mailbox is specified in the script. <br><br>  <b>In the script, you need to change the following parameters to the ones you need:</b> <br><br><pre><code class="hljs tex"><span class="hljs-formula"><span class="hljs-formula">$path = "C:</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">UPLOAD</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">"</span></span></span></span></span><span class="hljs-formula"> #    $</span></span>path1 = "C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">inetpub</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wwwroot</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UPLOAD</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">"</span></span></span></span> #  -,  </code> </pre> <br>  <b>In the Send_URL function, change the parameters:</b> <br><br><pre> <code class="hljs mel">$day = <span class="hljs-number"><span class="hljs-number">-30</span></span> #      <span class="hljs-string"><span class="hljs-string">"+(-1*$day)+"</span></span> .      . $mail_domain = <span class="hljs-string"><span class="hljs-string">"@mydomain.com"</span></span> $owner_domain = <span class="hljs-string"><span class="hljs-string">"mydomain\\"</span></span> $mail_admin = <span class="hljs-string"><span class="hljs-string">"admin@mydomain.com"</span></span> $mail_server = <span class="hljs-string"><span class="hljs-string">"mail.mydomain.com"</span></span> $http = <span class="hljs-string"><span class="hljs-string">"http://web.mydomain.com/UPLOAD/"</span></span></code> </pre><br>  The correct definition of the owner of the file is possible only in the domain.  Without a domain, you will have to create user accounts on a computer with a shared folder and associate them with your users. <br><br>  <b>Code:</b> <br><br><pre> <code class="hljs smalltalk"># <span class="hljs-type"><span class="hljs-type">Func</span></span>.ps1 ################################### #    hars@bk.ru  <span class="hljs-number"><span class="hljs-number">2015</span></span>. <span class="hljs-type"><span class="hljs-type">Function</span></span> <span class="hljs-type"><span class="hljs-type">Send_URL</span></span>(<span class="hljs-string"><span class="hljs-string">$F</span></span>ile,<span class="hljs-string"><span class="hljs-string">$p</span></span>ath,<span class="hljs-string"><span class="hljs-string">$p</span></span>ath1){ ###       ################################################## <span class="hljs-string"><span class="hljs-string">$d</span></span>ay = <span class="hljs-number"><span class="hljs-number">-30</span></span> #      <span class="hljs-comment"><span class="hljs-comment">"+(-1*$day)+"</span></span> .      . <span class="hljs-string"><span class="hljs-string">$m</span></span>ail_domain = <span class="hljs-comment"><span class="hljs-comment">"@mydomain.com"</span></span> <span class="hljs-string"><span class="hljs-string">$o</span></span>wner_domain = <span class="hljs-comment"><span class="hljs-comment">"mydomain\\"</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>ail_admin = <span class="hljs-comment"><span class="hljs-comment">"admin@mydomain.com"</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>ail_server = <span class="hljs-comment"><span class="hljs-comment">"mail.mydomain.com"</span></span> <span class="hljs-string"><span class="hljs-string">$h</span></span>ttp = <span class="hljs-comment"><span class="hljs-comment">"http://web.mydomain.com/UPLOAD/"</span></span> ################################################## <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_nm = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile.<span class="hljs-type"><span class="hljs-type">Trim</span></span>() #           <span class="hljs-string"><span class="hljs-string">$F</span></span>ile = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile -replace <span class="hljs-string"><span class="hljs-string">'\[|\]'</span></span>,<span class="hljs-string"><span class="hljs-string">'`$0'</span></span> #  []    <span class="hljs-string"><span class="hljs-string">$o</span></span>wner = ( <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Acl</span></span> (<span class="hljs-string"><span class="hljs-string">$p</span></span>ath + <span class="hljs-string"><span class="hljs-string">$F</span></span>ile) ).<span class="hljs-type"><span class="hljs-type">Owner</span></span> #   ##############  email if( <span class="hljs-string"><span class="hljs-string">$o</span></span>wner -like <span class="hljs-comment"><span class="hljs-comment">"*dministrator*"</span></span> -or !<span class="hljs-string"><span class="hljs-string">$o</span></span>wner ){ <span class="hljs-string"><span class="hljs-string">$m</span></span>ail = <span class="hljs-string"><span class="hljs-string">$m</span></span>ail_admin }else{ <span class="hljs-string"><span class="hljs-string">$m</span></span>ail = (<span class="hljs-string"><span class="hljs-string">$o</span></span>wner -ireplace(<span class="hljs-string"><span class="hljs-string">$o</span></span>wner_domain,<span class="hljs-comment"><span class="hljs-comment">""</span></span>)) + <span class="hljs-string"><span class="hljs-string">$m</span></span>ail_domain } ###################################### #<span class="hljs-string"><span class="hljs-string">$m</span></span>d5 = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">FileHash</span></span> (<span class="hljs-string"><span class="hljs-string">$p</span></span>ath + <span class="hljs-string"><span class="hljs-string">$F</span></span>ile) -<span class="hljs-type"><span class="hljs-type">Algorithm</span></span> <span class="hljs-type"><span class="hljs-type">MD5</span></span> #<span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$m</span></span>d5.<span class="hljs-type"><span class="hljs-type">Hash</span></span> + <span class="hljs-comment"><span class="hljs-comment">".zip"</span></span> #<span class="hljs-string"><span class="hljs-string">$F</span></span>ile_new = <span class="hljs-string"><span class="hljs-string">$p</span></span>ath1 + <span class="hljs-string"><span class="hljs-string">$m</span></span>d5.<span class="hljs-type"><span class="hljs-type">Hash</span></span> + <span class="hljs-comment"><span class="hljs-comment">".zip"</span></span> #############     if(<span class="hljs-string"><span class="hljs-string">$F</span></span>ile_nm.length &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>){ <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_nm.<span class="hljs-type"><span class="hljs-type">Substring</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>) }else{ <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_nm } ############################################# #############   @!{}%<span class="hljs-string"><span class="hljs-string">$#</span></span><span class="hljs-string"><span class="hljs-string">''</span></span>&amp;` <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-comment"><span class="hljs-comment">"#"</span></span>,<span class="hljs-comment"><span class="hljs-comment">""</span></span>) <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-comment"><span class="hljs-comment">"%"</span></span>,<span class="hljs-comment"><span class="hljs-comment">""</span></span>) <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-comment"><span class="hljs-comment">"$"</span></span>,<span class="hljs-comment"><span class="hljs-comment">""</span></span>) <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-comment"><span class="hljs-comment">"&amp;"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"_"</span></span>) <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-comment"><span class="hljs-comment">"{"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"("</span></span>) <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-comment"><span class="hljs-comment">"}"</span></span>,<span class="hljs-comment"><span class="hljs-comment">")"</span></span>) <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-string"><span class="hljs-string">'`'</span></span>,<span class="hljs-comment"><span class="hljs-comment">""</span></span>) <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-string"><span class="hljs-string">'"'</span></span>,<span class="hljs-comment"><span class="hljs-comment">""</span></span>) <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-comment"><span class="hljs-comment">"'"</span></span>,<span class="hljs-comment"><span class="hljs-comment">""</span></span>) <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-comment"><span class="hljs-comment">"~"</span></span>,<span class="hljs-comment"><span class="hljs-comment">""</span></span>) <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url -ireplace(<span class="hljs-comment"><span class="hljs-comment">" "</span></span>,<span class="hljs-comment"><span class="hljs-comment">"_"</span></span>) ######################################### #        <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url = <span class="hljs-string"><span class="hljs-string">$m</span></span>ail + <span class="hljs-comment"><span class="hljs-comment">"_"</span></span> + <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url #    <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_new = <span class="hljs-string"><span class="hljs-string">$p</span></span>ath1 + <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url #    - <span class="hljs-type"><span class="hljs-type">Move</span></span>-<span class="hljs-type"><span class="hljs-type">Item</span></span> -path ( <span class="hljs-string"><span class="hljs-string">$p</span></span>ath + <span class="hljs-string"><span class="hljs-string">$F</span></span>ile ) -destination <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_new -force -<span class="hljs-type"><span class="hljs-type">EA</span></span> <span class="hljs-type"><span class="hljs-type">SilentlyContinue</span></span> #-whatif #             if( <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">ChildItem</span></span> <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_new -<span class="hljs-type"><span class="hljs-type">EA</span></span> <span class="hljs-type"><span class="hljs-type">SilentlyContinue</span></span>){ write-host <span class="hljs-comment"><span class="hljs-comment">"OK"</span></span> #  #     , #        , #    ,         <span class="hljs-string"><span class="hljs-string">$F</span></span> = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">ChildItem</span></span> <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_new <span class="hljs-string"><span class="hljs-string">$F</span></span>.<span class="hljs-type"><span class="hljs-type">LastWriteTime</span></span> = <span class="hljs-type"><span class="hljs-type">Get</span></span>-date }else{ write-host <span class="hljs-comment"><span class="hljs-comment">"NO"</span></span> #   break #   } #   <span class="hljs-string"><span class="hljs-string">$c</span></span>olItems = (<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">ChildItem</span></span> <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_new | <span class="hljs-type"><span class="hljs-type">Measure</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> -property length -sum) <span class="hljs-string"><span class="hljs-string">$c</span></span>olSize = <span class="hljs-comment"><span class="hljs-comment">"{0:N2}"</span></span> -f (<span class="hljs-string"><span class="hljs-string">$c</span></span>olItems.sum / <span class="hljs-number"><span class="hljs-number">1</span></span>MB) + <span class="hljs-comment"><span class="hljs-comment">" Mb"</span></span> ###################################### #  <span class="hljs-string"><span class="hljs-string">$B</span></span>ody = <span class="hljs-comment"><span class="hljs-comment">"&lt;b&gt;: &lt;/b&gt;&lt;a href='"</span></span> + <span class="hljs-string"><span class="hljs-string">$h</span></span>ttp + <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_url +<span class="hljs-comment"><span class="hljs-comment">"'&gt;"</span></span> + <span class="hljs-string"><span class="hljs-string">$F</span></span>ile_nm + <span class="hljs-comment"><span class="hljs-comment">" ("</span></span> + <span class="hljs-string"><span class="hljs-string">$c</span></span>olSize + <span class="hljs-comment"><span class="hljs-comment">")&lt;/a&gt;&lt;br/&gt;       "</span></span>+(<span class="hljs-number"><span class="hljs-number">-1</span></span>*<span class="hljs-string"><span class="hljs-string">$d</span></span>ay)+<span class="hljs-comment"><span class="hljs-comment">" .      ."</span></span> #  <span class="hljs-type"><span class="hljs-type">Send</span></span>-<span class="hljs-type"><span class="hljs-type">MailMessage</span></span> -to <span class="hljs-string"><span class="hljs-string">$m</span></span>ail -from <span class="hljs-string"><span class="hljs-string">$m</span></span>ail_admin -subject <span class="hljs-comment"><span class="hljs-comment">" "</span></span> -<span class="hljs-type"><span class="hljs-type">BodyAsHtml</span></span> <span class="hljs-string"><span class="hljs-string">$B</span></span>ody -<span class="hljs-type"><span class="hljs-type">Encoding</span></span> <span class="hljs-type"><span class="hljs-type">UTF8</span></span> -<span class="hljs-type"><span class="hljs-type">SmtpServer</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>ail_server #  ,   if(<span class="hljs-string"><span class="hljs-string">$m</span></span>ail -inotlike <span class="hljs-string"><span class="hljs-string">$m</span></span>ail_admin){ <span class="hljs-type"><span class="hljs-type">Send</span></span>-<span class="hljs-type"><span class="hljs-type">MailMessage</span></span> -to <span class="hljs-string"><span class="hljs-string">$m</span></span>ail_admin -from <span class="hljs-string"><span class="hljs-string">$m</span></span>ail -subject <span class="hljs-comment"><span class="hljs-comment">" "</span></span> -<span class="hljs-type"><span class="hljs-type">BodyAsHtml</span></span> <span class="hljs-string"><span class="hljs-string">$B</span></span>ody -<span class="hljs-type"><span class="hljs-type">Encoding</span></span> <span class="hljs-type"><span class="hljs-type">UTF8</span></span> -<span class="hljs-type"><span class="hljs-type">SmtpServer</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>ail_server } <span class="hljs-type"><span class="hljs-type">Write</span></span>-<span class="hljs-type"><span class="hljs-type">Host</span></span> <span class="hljs-string"><span class="hljs-string">$o</span></span>wner <span class="hljs-string"><span class="hljs-string">$m</span></span>ail <span class="hljs-string"><span class="hljs-string">$B</span></span>ody #       ###################################### #    -       get-childitem <span class="hljs-string"><span class="hljs-string">$p</span></span>ath1 *.zip | where {<span class="hljs-string"><span class="hljs-string">$_</span></span>.lastwritetime -le (get-date).adddays(<span class="hljs-string"><span class="hljs-string">$d</span></span>ay) } | del -<span class="hljs-type"><span class="hljs-type">Recurse</span></span> -<span class="hljs-type"><span class="hljs-type">Force</span></span> } ########################################################################################## ########################################################################################## ########################################################################################## ########################################################################################## ########################################################################################## # <span class="hljs-type"><span class="hljs-type">Send_URL</span></span>.ps1 ################################### #    hars@bk.ru  <span class="hljs-number"><span class="hljs-number">2015</span></span>. #        # powershell.exe <span class="hljs-comment"><span class="hljs-comment">"C:\Scripts\Send_URL.ps1"</span></span> -<span class="hljs-type"><span class="hljs-type">NoLogo</span></span> -<span class="hljs-type"><span class="hljs-type">NonInteractive</span></span> -<span class="hljs-type"><span class="hljs-type">WindowStyle</span></span> <span class="hljs-type"><span class="hljs-type">Hidden</span></span> &lt;# .<span class="hljs-comment"><span class="hljs-comment">"C:\scripts\Func.ps1"</span></span> #    .   (),  . #&gt; ###       ################################################## <span class="hljs-string"><span class="hljs-string">$p</span></span>ath = <span class="hljs-comment"><span class="hljs-comment">"C:\UPLOAD\"</span></span> #    <span class="hljs-string"><span class="hljs-string">$p</span></span>ath1 = <span class="hljs-comment"><span class="hljs-comment">"C:\inetpub\wwwroot\UPLOAD\"</span></span> #  -,   ################################################## #    <span class="hljs-type"><span class="hljs-type">ZIP</span></span>  <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">ChildItem</span></span> <span class="hljs-string"><span class="hljs-string">$p</span></span>ath -<span class="hljs-type"><span class="hljs-type">Recurse</span></span> -<span class="hljs-type"><span class="hljs-type">Exclude</span></span> *.zip | %{ <span class="hljs-type"><span class="hljs-type">Remove</span></span>-<span class="hljs-type"><span class="hljs-type">Item</span></span> <span class="hljs-string"><span class="hljs-string">$_</span></span> -<span class="hljs-type"><span class="hljs-type">Force</span></span> -<span class="hljs-type"><span class="hljs-type">Recurse</span></span> } #      <span class="hljs-string"><span class="hljs-string">$f</span></span>list = get-childitem <span class="hljs-string"><span class="hljs-string">$p</span></span>ath<span class="hljs-comment"><span class="hljs-comment">"*.zip"</span></span> #-recurse #  <span class="hljs-type"><span class="hljs-type">ZIP</span></span> ,         <span class="hljs-string"><span class="hljs-string">$f</span></span>list | <span class="hljs-type"><span class="hljs-type">ForEach</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span>{ <span class="hljs-type"><span class="hljs-type">Send_URL</span></span> <span class="hljs-string"><span class="hljs-string">$_</span></span>.<span class="hljs-type"><span class="hljs-type">PSChildName</span></span> <span class="hljs-string"><span class="hljs-string">$p</span></span>ath <span class="hljs-string"><span class="hljs-string">$p</span></span>ath1 } #   html    #  index.html  ,  <span class="hljs-comment"><span class="hljs-comment">""</span></span>     #&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=<span class="hljs-comment"><span class="hljs-comment">"refresh"</span></span> content=<span class="hljs-comment"><span class="hljs-comment">"0;url=http://www.yandex.ru"</span></span> /&gt;&lt;/head&gt;&lt;/html&gt; <span class="hljs-symbol"><span class="hljs-symbol">#copy</span></span> <span class="hljs-type"><span class="hljs-type">C</span></span>:\inetpub\wwwroot\index.html <span class="hljs-type"><span class="hljs-type">C</span></span>:\inetpub\wwwroot\<span class="hljs-type"><span class="hljs-type">UPLOAD</span></span>\index.html -<span class="hljs-type"><span class="hljs-type">Force</span></span> #    -,    <span class="hljs-type"><span class="hljs-type">New</span></span>-<span class="hljs-type"><span class="hljs-type">Item</span></span> <span class="hljs-string"><span class="hljs-string">$p</span></span>ath<span class="hljs-comment"><span class="hljs-comment">" ZIP ,  .txt"</span></span> -type file -<span class="hljs-type"><span class="hljs-type">Force</span></span> ################################### ################################### ################################### # <span class="hljs-type"><span class="hljs-type">DeleteOldFiles</span></span>.ps1 ################################### #  .     . #    hars@bk.ru  <span class="hljs-number"><span class="hljs-number">2015</span></span>. #        # powershell.exe <span class="hljs-comment"><span class="hljs-comment">"C:\Scripts\DeleteOldFiles.ps1"</span></span> -<span class="hljs-type"><span class="hljs-type">NoLogo</span></span> -<span class="hljs-type"><span class="hljs-type">NonInteractive</span></span> -<span class="hljs-type"><span class="hljs-type">WindowStyle</span></span> <span class="hljs-type"><span class="hljs-type">Hidden</span></span> ###       ################################################## <span class="hljs-string"><span class="hljs-string">$C</span></span>learFolder = <span class="hljs-comment"><span class="hljs-comment">"C:\inetpub\wwwroot\UPLOAD\"</span></span> #    <span class="hljs-string"><span class="hljs-string">$d</span></span>ay = <span class="hljs-number"><span class="hljs-number">-14</span></span> #        ################################################## # oldDel            #         <span class="hljs-number"><span class="hljs-number">14</span></span> ,    function oldDel(<span class="hljs-string"><span class="hljs-string">$f</span></span>older,<span class="hljs-string"><span class="hljs-string">$d</span></span>ay){ get-childitem <span class="hljs-string"><span class="hljs-string">$f</span></span>older * | where {<span class="hljs-string"><span class="hljs-string">$_</span></span>.lastwritetime -le (get-date).adddays(<span class="hljs-string"><span class="hljs-string">$d</span></span>ay) } | del -<span class="hljs-type"><span class="hljs-type">Recurse</span></span> -<span class="hljs-type"><span class="hljs-type">Force</span></span> #-<span class="hljs-type"><span class="hljs-type">WhatIf</span></span> } oldDel <span class="hljs-string"><span class="hljs-string">$C</span></span>learFolder <span class="hljs-string"><span class="hljs-string">$d</span></span>ay</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/276575/">https://habr.com/ru/post/276575/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276561/index.html">Automated access to SharePoint. How to facilitate the work of the administrator and to establish control over the distribution of rights</a></li>
<li><a href="../276563/index.html">Connectivity components in a dynamic graph in one pass</a></li>
<li><a href="../276565/index.html">You are not that paranoidÔºÅ (pre-friday post)</a></li>
<li><a href="../276567/index.html">Online audio advertising: everyone will be heard</a></li>
<li><a href="../276569/index.html">Acceleration of Python scripts without any mental effort</a></li>
<li><a href="../276579/index.html">Moscow Python Meetup ‚Ññ32</a></li>
<li><a href="../276581/index.html">Multi-source replication in MySQL5.7</a></li>
<li><a href="../276583/index.html">New leader in price-performance among storage systems?</a></li>
<li><a href="../276585/index.html">About using React with the canvas element</a></li>
<li><a href="../276587/index.html">Analysis of the current situation in the Russian BIM market in the field of civil engineering</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>