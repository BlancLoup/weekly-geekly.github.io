<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Node.js on Windows (with performance tests)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article we will discuss the most important questions for novice web programmers and those who are thinking about studying Node.js, namely: 


...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Node.js on Windows (with performance tests)</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/bfd60e56/943450aa/12de8980/87a55205.png"><br><br>  In this article we will discuss the most important questions for novice web programmers and those who are thinking about studying Node.js, namely: <br><ul><li>  how to install the Node.js work environment on your computer; </li><li>  how to write code; </li><li>  how to debug; </li><li>  how to deploy what happened on a remote server. </li></ul>  And the performance tests at the end of the article may give an answer to the question of why you may actually need to study Node.js. <br><a name="habracut"></a><br>  Node.js is an event-oriented Javascript framework for creating network applications.  The basic idea is that during the execution of the code, nothing is blocked - there are no operations that are waiting for something, such as transferring data, user input or establishing a connection.  Everything is built on events that occur at the moment of the onset of what synchronous operations are waiting for.  This gives a significant, sometimes tenfold, performance advantage compared to old synchronous systems.  Since version 0.6.0, which was released in November 2011, the Node.js build for Windows has been declared stable. <br><br><br><h2>  Install the working environment </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First you need to download and install the <a href="http://www.microsoft.com/web/downloads/platform.aspx">Web Platform Installer</a> , run it, click on ‚ÄúOptions‚Äù and in the ‚ÄúDisplay additional scenarios‚Äù field add a link to Helicon Zoo Feed: <a href="http://www.helicontech.com/zoo/feed/">http://www.helicontech.com/zoo/feed/</a> <br><br><br><img src="https://habrastorage.org/storage1/2083ea8e/28eb1a2b/41cb4695/a8308c32.png"><br><br>  After that, the Zoo tab will appear in the Web Platform Installer: <br><br><img src="https://habrastorage.org/storage1/7129b7e9/8d780b35/d17f2832/1988dc58.png"><br><br><br><br><h3>  Installing Node.js </h3><br><br>  On the <u>Zoo</u> tab <u>-&gt; Engines</u> there is a list of all available web engines, among them Node.js.  However, we recommend installing the Node.js package into which, besides the node itself, some other useful modules are included, so that <u>Zoo -&gt; Packages -&gt; Node.js Hosting Package</u> and click Add, Install. <br><br><img src="https://habrastorage.org/storage1/6716e6ee/41f930f0/0c30090f/581b9cde.png"><br><br>  You can see all currently available web frameworks and applications in the <a href="http://www.helicontech.com/zoo/gallery/">gallery Helicon Zoo</a> .  After you agree to the license agreements, the download and installation of IIS (if not already installed), the Helicon Zoo Module, as well as the node.exe for Windows itself will begin. <br><br>  An important component of the system is the Node Package Manager (npm) package manager, which you will need to install additional modules.  Unfortunately, the current version of npm on Windows is unstable.  But there is its analogue - the <a href="https://github.com/japj/ryppi">ryppi.py</a> utility, which can be used in the same way as npm.  ryppi.py is written in Python, so the Node.js Hosting Package installation will pull the python along with it.  In the future, if npm will work stably on Windows, we will replace ryppi.py with it, which will save 80mb of disk space on the python installation. <br><br><br><br><h3>  Installing WebMatrix Templates </h3><br><br>  So, we installed Node.js, now to start writing applications for it, you can use the templates for WebMatrix.  These templates allow you to create blank applications-blanks that can be used for further development. <br>  To install them, select <u>Zoo -&gt; Packages -&gt; WebMatrix Templates</u> . <br><br><img src="https://habrastorage.org/storage1/5f4722ee/e4093b07/8629b80b/d3764c30.png"><br><br>  If you do not have WebMatrix installed - it does not matter, it will be downloaded and installed automatically during the installation of templates for it.  After installation, run WebMatrix and select <u>Site from Template</u> on the main <u>page</u> : <br><br><img src="https://habrastorage.org/storage1/ca437ea7/c1984f27/38e65337/19f25cf6.png"><br><br>  As seen in the screenshot, Node.js is not the only framework for which WebMatrix templates are available. <br><br>  After creating Node.js Site, if you go to the specified URL or click "Run", you will see a simple "Hello, World!". <br><br><img src="https://habrastorage.org/storage1/211fc0e4/321f3d8d/f9764c13/2679d5c5.png"><br><br>  By default, the newly created website contains an <a href="http://expressjs.com/">express</a> framework for easier creation of web applications.  He himself and his dependencies are located in the node_modules directory under the site, which will be convenient for deploying the application on a remote server. <br><br>  The public directory is intended for storing static files.  Any file placed in this directory will be processed directly by IIS as a static file, without leading to the Node.js call.  This is especially important to avoid accidentally running client * .js files on the server. <br><br>  The web.config file contains in particular URL rewrite rules for static files.  Initially, any request is checked for the presence of such a static file in the public directory.  This is necessary for some web applications that like to mix static and dynamic resources in one directory, often the root.  If your application is not exposed to this, unambiguously vicious practice, then remove the rules for Microsoft URL Rewrite from the web.config file and refer to the static files, indicating the public directory explicitly. <br><br>  And the web.config file contains the configuration directives needed to run Node.js and the Helicon Zoo Module on this site. <br><br><br><br><h2>  We write the first application </h2><br><br>  One of the charms of Node.js is that JavaScript is a well-known language that is widely used in web development.  This means that you will not have problems with the choice of the editor.  In our case, the free WebMatrix is ‚Äã‚Äãquite suitable for a start. <br><br>  To demonstrate the capabilities of asynchronous web frameworks, chat is usually the first thing to do.  So the most famous demo application on Node.js is a chat on <a href="http://chat.nodejs.org/">http://chat.nodejs.org/</a> , its <a href="https://github.com/ry/node_chat">source codes</a> are available for study. <br><br>  We also decided to make the most simple chat, so that its source fully fit to the page of the habr.  There are no users, no sessions, no scrolling or formatting of messages, there is only the simplest asynchronous transfer of messages to demonstrate the work of long-polling. <br><br>  For work we will use the Node.js Site created by us earlier.  You will need to edit the server.js and index.html files. <br><br><img src="https://habrastorage.org/storage1/29cbfbce/8c65f6b1/d8ff1e1a/3c7da77c.png"><br><br>  Here are the sources for the server.js file: <br><br><pre><code class="hljs lua">var express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>); var callbacks = []; //     <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">appendMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span></span>{ var resp = {messages: [message]}; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (callbacks.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { callbacks.shift()(resp); } } //    express var app = module.exports = express.createServer(); app.use(express.bodyParser()); //   index.html app.get(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(req, res)</span></span></span></span>{ res.sendfile(<span class="hljs-string"><span class="hljs-string">'index.html'</span></span>); }); //     app.post(<span class="hljs-string"><span class="hljs-string">'/send'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(req, res)</span></span></span></span>{ var message = { nickname: req.param(<span class="hljs-string"><span class="hljs-string">'nickname'</span></span>, <span class="hljs-string"><span class="hljs-string">'Anonymous'</span></span>), text: req.param(<span class="hljs-string"><span class="hljs-string">'text'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) }; appendMessage(message); res.json({<span class="hljs-built_in"><span class="hljs-built_in">status</span></span>: <span class="hljs-string"><span class="hljs-string">'ok'</span></span>}); }); //    app.get(<span class="hljs-string"><span class="hljs-string">'/recv'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(req, res)</span></span></span></span>{ callbacks.push(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span></span>{ res.json(message); }); }); //   app.listen(process.env.PORT);</code> </pre> <br>  and index.html <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Node.js Zoo Chat<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-comment"><span class="actionscript"><span class="hljs-comment">//     $(document).ready(function(){ $('form#send').submit(onSend); longPoll(); $('#nickname').focus(); }); //   Submit     function onSend(eventData){ eventData.preventDefault(); var msgArr = $(this).serializeArray(); var message = { nickname : msgArr[0].value, text : msgArr[1].value }; $.post('/send', message, function (data){ $('#text').val('').focus(); }, 'json'); } //      function longPoll(data){ if (data &amp;&amp; data.messages) { for (var i = 0; i &lt; data.messages.length; i++) { var message = data.messages[i]; $('&lt;p&gt;&lt;b&gt;'+message.nickname+':&lt;/b&gt;&lt;span&gt;'+message.text+'&lt;/span&gt;&lt;/p&gt;').hide().prependTo('#messages').slideDown(); } } //  ,   $.ajax({ cache: false, type: "GET", url: "/recv", success: function(data){ longPoll(data); } }); } </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Node.js Zoo Chat<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/send"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"send"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nickname"</span></span></span><span class="hljs-tag">&gt;</span></span>Nickname:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nickname"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"10"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nickname"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag">&gt;</span></span>Message:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"40"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"messages"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  For the changes to take effect, you must click Restart and then Run: <br><br><img src="https://habrastorage.org/storage1/234ff080/acb90131/5b5f8ada/a3165d0c.png"><br><br>  Now you can make sure that the chat works by running it in two different browsers: <br><br><img src="https://habrastorage.org/storage1/930f928b/fcfca5c7/e1608952/dc27b0b8.png"><br><br><br><br><h3>  Module installation </h3><br><br>  For any web framework, perhaps the most important characteristic is the availability of various modules and the use of third-party technologies.  In the current implementation, the Node Package Manager (Node PackageManager) under Windows is unstable, although Windows support is already announced and the situation may change in the near future.  At the moment, you can use the package manager written in Python - ryppi.py.  Here you need to remember one subtlety - ryppi.py always installs the modules in the node_modules directory of the current directory where it is called.  Those.  to put the module under the site you need to go to the site directory and call the command there: <br><br><pre> <code class="html hljs xml">C:\&gt;cd "C:\My Web Sites\Node.js Site" C:\My Web Sites\Node.js Site&gt;ryppi.py install mongodb Installing http://registry.npmjs.org/mongodb/-/mongodb-0.9.7-0.tgz into .\node_modules\mongodb ... Checking dependencies for mongodb ... All done.</code> </pre><br>  It should also be noted that not all of the existing modules work under Windows.  So, for example, the great, in my opinion, <a href="https://github.com/0ctave/node-sync">node-sync</a> library, written <a href="http://habrahabr.ru/users/octave/" class="user_link">octave by the</a> habrow user, will not work under Windows.  The library allows in many cases to get rid of the bulky paradigm of callbacks, without losing the asynchronous nature of Node, but it is based on the implementation of <a href="https://github.com/laverdet/node-fibers">node-fibers</a> , which is not ported under Windows.  I hope that in the future support for the fibers (fibers) will be built into Node.js directly. <br>  And yet most of the modules will work stably on Windows. <br><br><br><br><h3>  CoffeScript </h3><br><br>  If you start writing a more or less large project on Node.js, sooner or later you will encounter the fact that JavaScript is not a very friendly language.  A swarm of curly braces, a mass of unnecessary constructions - all this does not add readability to the program and complicates further work on the code.  Fortunately, you are not the first to deal with this and the problem has already been solved.  So there are many derivative languages ‚Äã‚Äãbased on JavaScript or extending it.  Here, for example, a short list for review: <a href="http://altjs.org/">http://altjs.org/</a> <br><br>  You can take CoffeeScript, as the most popular at the moment.  Code written in CoffeeScript is simpler and easier to read.  Then this code is compiled into regular JavaScript and executed.  A JavaScript code, on the contrary, can be converted to CoffeeScript.  For example, the script server.js from our chat in CoffeeScript looks like this: <br><br><pre> <code class="javascript hljs">express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"express"</span></span>) callbacks = [] <span class="hljs-comment"><span class="hljs-comment">//     appendMessage = (message) -&gt; resp = messages: [ message ] callbacks.shift() resp while callbacks.length &gt; 0 //    express app = module.exports = express.createServer() app.use express.bodyParser() //   index.html app.get "/", (req, res) -&gt; res.sendfile "index.html" //     app.post "/send", (req, res) -&gt; message = nickname: req.param("nickname", "Anonymous") text: req.param("text", "") appendMessage message res.json status: "ok" //    app.get "/recv", (req, res) -&gt; callbacks.push (message) -&gt; res.json message //   app.listen process.env.PORT</span></span></code> </pre><br>  Learn more about CoffeeScript: <a href="http://jashkenas.github.com/coffee-script/">http://jashkenas.github.com/coffee-script/</a> <sub>(English)</sub> <br>  Install CoffeeScript: <u>rippy.py install coffe-script</u> <br><br><br><br><h2>  Debugging Node.js Applications </h2><br><br>  There is a good tool for debugging applications on Node.js - node-inspector.  It is already included in the node_modules directory, which is in the template of the Node.js site.  The node-inspector works like this: <br><ul><li>  the application to be debugged runs in debug mode (call node.exe with the --debug or --debug-brk parameter); </li><li>  runs node-inspector, which in essence also has a web application; </li><li>  using the WebSocket protocol, these two applications communicate with each other to transfer debug data; </li><li>  the browser opens the page with the debugged application; </li><li>  The node-inspector interface with debug information opens in a webkit-compatible browser, its interface is similar to the Web Inspector in Google Chrome or Safari. </li></ul><br>  In the root directory of the node.js site from the template there is a file start_debug.cmd, which starts debugging for the current application and opens pages in the browser for debugging. <br><br><img src="https://habrastorage.org/storage1/4035ec05/14fb6be5/2faaa6ae/18c36ddd.png"><br><br>  The debugger in the browser looks like this: <br><br><img src="https://habrastorage.org/storage1/05d8eba8/273ecbf8/e84c6b91/55cbdab3.png"><br><br><h2>  Deploy to server </h2><br><br>  So, we have written a web application and now we want to post it online.  To do this, we need a server, and now there is nothing easier than setting up a Windows server to work with Node.js.  We only need to repeat a few steps from the beginning of the article, which we did to deploy the working environment.  Namely: install the Microsoft Web Platform Installer, add the Helicon Zoo feed to it and install the Node.js Hosting Package from the Zoo repository.  All - the server is ready to accept our application.  From server platforms are supported Windows 2008 and 2008 R2, 32 and 64 bit versions. <br><br>  Now you only need to create an empty web site on the server using the IIS manager or hosting panel, if we are hosting, and copy our application to the site via FTP or WebDeploy.  In the case of WebDeploy, the necessary rights to the folders will also be distributed.  You can also use Git or another version control system, but this is outside the scope of this article. <br><br>  Helicon Zoo Module was originally developed with the calculation of configuring hosting solutions.  So all applications under it are divided and do not overlap.  The module itself with the default settings works in automatic mode, creating one worker (process handler) when the load is low or adding workers up to the number of cores to give maximum performance if the load on the application increases. <br><br>  In Helicon Zoo the concept of engines (engines) and applications (applications) is used.  So in the engines it is determined what to run and how, by what protocol and on which port, how many minimum and maximum workers are allowed and similar global settings that are set globally in the applicationHost.config file.  Then, already under the site, you can create an application that uses a specific engine and pass it the necessary parameters for the operation of this application.  This allows you to separate the work of the hosting administrator from customers, and customers from each other. <br><br><br><br><h2>  Node.js performance tests </h2><br><br>  Test machine as a server - Core 2 Quad 2.4 Ghz, 8 Gb RAM, gigabit network.  To generate the load, a more powerful computer and Apache Benchmark were used with the command ‚Äúab.exe -n 100000 -c 100 ‚Äìk‚Äù.  Ubuntu 11.04 Server x64 was used to test Apache and Nginx.  IIS 7 tests worked on Windows Server 2008 R2.  Any virtualok - honest iron. <br><br>  Three tests were performed.  In the first, Node.js should have just displayed the current time on the page in high resolution.  Time is needed to ensure that the answers do not come from the cache.  In the second test, read from the MySQL database, in the third record in the database. <br><br>  Here are the results (the value on the graphs - requests per second): <br><br><img src="https://habrastorage.org/storage1/50f655e6/bbc0af30/4b625a3b/36db3b61.png"><img src="https://habrastorage.org/storage1/fbe1a8ca/f73d654c/9f47c0a8/2fbcbefc.png"><img src="https://habrastorage.org/storage1/c1127ccc/0b79cf2e/bf06d84a/70b99268.png"><br><br>  Impressive, isn't it?  Now a few explanations of what these tests measure.  Calling them performance tests is probably not quite right, we are not measuring different processors.  The processor can have performance, while web servers are more likely to have the opposite result - how much processor time they spent on each request. <br><br>  Thus, in the first test, the net overhead costs of processing the request by each specific web server and their ability to use processor resources are measured.  Faster this bunch of technologies on this processor to return the answer is simply not able to.  In this test, Nginx is far behind on Windows because in this system Nginx opens a new connection with the backend on every request.  But on the contrary, Apache on Windows pleased me with pooling connections and real streams. <br><br>  The second and third tests show how the share of web server overhead for processing a request changes as the ‚Äúweight‚Äù of the request increases.  However, they are now more influenced by many other factors, such as the performance of the file system, database drivers, and the database itself.  For the experiment, we also tested a bunch of Windows + Zoo + MongoDB, just to see the difference with Mongo.  Her results - 6793 z / s for reading and 2906 z / s for writing.  Impressive, especially recording speed. <br><br>  Another interesting fact is that the hardware and software base used in these tests is the same as when testing Django in <a href="http://habrahabr.ru/company/microsoft/blog/127227/">this article</a> .  So the results of these tests can be compared.  Of course, the Node.js scripts are much more lightweight, we did not use templates, ORM, etc.  but still there is reason to think. <br><br><br>  At the request of readers lay out detailed graphics ab.  Only the first test was re-measured, where there is a simple time display, because the overhead of the web server itself is best seen on it.  Configuration files and test js scripts can be found <a href="">here</a> .  There only inkludy, everything else is by default.  Horizontal scale - requests, vertical - response time in milliseconds. <br><br>  Windows, IIS7 + Zoo, "time output": <br><img src="https://habrastorage.org/storage1/976bf1cd/290a3fe0/d8459c8b/a0ae2f78.png"><br><br>  Ubuntu, Apache, "time output": <br><img src="https://habrastorage.org/storage1/01515a79/55307686/524da747/5be5d649.png"><br><br>  Ubuntu, Nginx, "time output": <br><img src="https://habrastorage.org/storage1/a32677ef/8ff09fe5/4bc0c320/c69ae0bb.png"><br><br><br><br><h2>  findings </h2><br><br>  I think Node.js is a very promising technology.  It has impressive performance and flexibility.  It is especially nice that Node.js is equally good on both Unix and Windows, and uses the right technological solutions for each of these operating systems, which can be clearly seen from the test results. <br><br>  Soon we plan to add support for Erlang and Java in Helicon Zoo.  It will be interesting to compare the performance of these technologies.  In the meantime, Node.js is the clear leader in speed among the supported web frameworks. <br><br>  PS: <a href="http://habrahabr.ru/users/rukeba/" class="user_link">Special</a> thanks to <a href="http://habrahabr.ru/users/rukeba/" class="user_link">rukeba</a> and <a href="http://habrahabr.ru/users/xaoccps/" class="user_link">XaocCPS</a> for their help in publishing this article. </div><p>Source: <a href="https://habr.com/ru/post/132745/">https://habr.com/ru/post/132745/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132736/index.html">PHP Namespace</a></li>
<li><a href="../132738/index.html">Microsoft is attacking Android with ‚Äútrivial‚Äù patents</a></li>
<li><a href="../132742/index.html">Google vs Yandex or Why is Google looking better?</a></li>
<li><a href="../132743/index.html">MODx Revo, Login authorization setting. Basic setup</a></li>
<li><a href="../132744/index.html">Microsoft Search Server 2010 Express</a></li>
<li><a href="../132746/index.html">Updated Evernote extension for Chrome: parallel search in Yandex</a></li>
<li><a href="../132747/index.html">Conference system administrators "Steel Tambourine 5"</a></li>
<li><a href="../132752/index.html">Published HTML5 Camp program</a></li>
<li><a href="../132754/index.html">Requirements for electronic archives of project and design documentation</a></li>
<li><a href="../132755/index.html">Unified information environment in the university. Past and present</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>