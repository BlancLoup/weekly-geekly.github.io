<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ease of Being: Antiword, reST</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When preparing documents, avoid sluggish office packages, use your favorite text editor, separate content from presentation, ensure high readability a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ease of Being: Antiword, reST</h1><div class="post__text post__text-html js-mediator-article">  When preparing documents, avoid sluggish office packages, use your favorite text editor, separate content from presentation, ensure high readability and transparency of documents for VCS, easily compare versions of texts? <a name="habracut"></a><br><br>  Recently <a href="http://habrahabr.ru/blogs/open_source/110619/">commented</a> on the release of a new LibreOffice and decided that it was necessary to issue considerations more coherently. <br><br>  Imagine that we have received an e-mail document in MS Word format, we have to fill it in / correct it and print it out / forward.  Most likely, we will periodically send this document again and / or we will need to continue to prepare updated texts based on it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Problem number 1: on our GNU / Linux, of course, there is no MS Office, and OpenOffice and its heirs are terribly slow (especially if we are used to Vim and other lightweight programs). <br><br>  Problem number 2: very often the layout of incoming files is catastrophic (beating with spaces, formatting without styles, etc.), so you have to practically redo the entire document in order to make changes normally. <br><br>  Problem number 3: MS Word format is opaque, and OpenDocument conditionally transparent.  In other words, even an open format cannot be easily read by simple means: you need to unzip a bunch of files and parse XML.  So, for version control, such documents are opaque. <br><br>  What to do?  Unix-Wei comes to the rescue in the form of simple programs that work with simple text. <br><br><h2>  Instruments </h2><ul><li>  <a href="http://en.wikipedia.org/wiki/Antiword">Antiword</a> - utility to extract text from MS Word; </li><li>  <a href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> (reST) is a very simple and quite powerful semantic markup language for text; </li><li>  <a href="http://docutils.sourceforge.net/docs/user/tools.html">Docutils tools</a> (rst2latex, rst2html, rst2odt, rst2xml) and <a href="http://code.google.com/p/rst2pdf">rst2pdf</a> - utilities for exporting text from reST to common formats for layout, web and print; </li><li>  Bonus: <a href="http://rst2a.com/">rst2a</a> (online converter with API!) </li></ul><br><h2>  Workflow </h2><ol><li>  antiword reads .doc and prints plain text; </li><li>  edit the plain text; </li><li>  rst2 * utilities convert text from reST markup to arbitrary formats. </li></ol>  For example, we received a document in MSWord format, we want to quickly fix something in it and save ourselves a text / template for the future: <br><br><pre>  $ antiword estimate.doc&gt; estimate.txt
 $ vim estimate.txt
 $ rst2pdf estimate.txt -o estimate.pdf </pre><br>  Done, beautiful PDF can be viewed and printed.  By the way, it‚Äôs convenient to keep the PDF open, for example, in <a href="http://okular.kde.org/">Okular</a> , when editing the source code.  When exporting from reST to PDF (and this can be done automatically), Okular will immediately update the content without discarding the open page.  It turns out almost instant preview.  And in the same place (in Okular) you can print the document. <br><br>  I usually add another style file (the same one more or less fits all documents, can be expanded for a specific document).  Styles for rst2pdf are written in JSON (see the documentation). <br><br><h2>  results </h2><br>  Problem number 1 solved: used cross-platform, lightweight, quick and unobtrusive tools. <br><br>  Problem number 2 is solved: the nightmarish initial layout is killed immediately, instead of it we get the text itself, which can already be easily put into reST order.  If necessary, the result can be brought to LaTeX. <br><br>  Problem number 3 is solved: all documents (and styles) are completely transparent to VCS and can be read without any special means.  Just like the program code.  So, if something has changed in the official document, you will always have readable diffs for any dates.  For inbound, you can also store the original versions (preferably the output of antiword), in order to diffuse them and easily transfer only the changes to the correct reST files. <br><br><h2>  Notes </h2><ul><li>  The proposed utility stack does not plug all holes.  The beauty of Unix veya is that you can safely replace components. </li><li>  By the way, Antiword "is able to convert documents to plain text, to PostScript, to PDF and XML / DocBook", so in some cases you can even avoid reST. </li><li>  This note is written in reST and exported via rst2html.  ;-) </li><li>  UPD: thanks for <a href="https://habrahabr.ru/users/ingspree/" class="user_link">ingspree</a> for the amendment: reST is not correct, but reST :) </li></ul></div><p>Source: <a href="https://habr.com/ru/post/110716/">https://habr.com/ru/post/110716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../110704/index.html">Moscow igrodelov offices</a></li>
<li><a href="../110705/index.html">Christmas trouble, md5, books, gadgets, software</a></li>
<li><a href="../110709/index.html">In the near future, 3D food printers can cook festive dishes.</a></li>
<li><a href="../110711/index.html">A couple of plugins for jQuery Mobile</a></li>
<li><a href="../110712/index.html">WXHR: Good old XHR with Web Workers</a></li>
<li><a href="../110718/index.html">Another prototype of a solar reactor</a></li>
<li><a href="../110719/index.html">Author of the Facebook Disconnect extension resigned from Google</a></li>
<li><a href="../110720/index.html">10 most significant events in the global GIS market in 2010</a></li>
<li><a href="../110721/index.html">Home studio budget</a></li>
<li><a href="../110722/index.html">Architecture Adobe Flex 3 components for a beginner</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>