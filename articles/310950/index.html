<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The driver of the computer game Street Fighter V disables the built-in protection mechanism of Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Drivers of computer games that are used to protect the integrity of the game files, as well as the legitimacy of these players are not uncommon. Previ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The driver of the computer game Street Fighter V disables the built-in protection mechanism of Windows</h1><div class="post__text post__text-html js-mediator-article">  Drivers of computer games that are used to protect the integrity of the game files, as well as the legitimacy of these players are not uncommon.  Previously published several reviews of the most famous such drivers, for example, <a href="https://en.wikipedia.org/wiki/NProtect_GameGuard">nProtect GameGuard</a> and <a href="http://uninformed.org/%3Fv%3D9%26a%3D1">Blizzard Lockdown</a> .  Such drivers can use for their own purposes interceptions of API calls at the Windows kernel level, constant scanning of the virtual address space of processes, tracking access of operations to the system registry, etc. <br><br><img src="https://habrastorage.org/files/8b2/f99/a68/8b2f99a684ed4acf978e200ac3f67144.jpeg"><br><br>  A few days ago, Capcom <a href="https://steamcommunity.com/games/310950/announcements/detail/832427843307776226">notified</a> its users of an update to the anti-hack driver (Capcom.sys), which is used to monitor the integrity of the game files and prevents possible compromise of the contents of the game process‚Äôs memory in order to prevent cheating.  However, users in this update were in for an unpleasant surprise in one of the driver functions.  It allows you to disable the protective measure of the SMEP kernel and execute the code according to a pointer obtained from user mode. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  SMEP (Supervisor Mode Execution Prevention) is already a fairly well-known measure, about which several reviews have been <a href="http://j00ru.vexillium.org/%3Fp%3D783">written</a> .  It requires support from both the microprocessor and the OS (Windows 8+).  SMEP is used to block the operation of executing user mode code (Ring 3) in kernel mode (RIng 0).  However strange it may seem (the kernel mode code is the most privileged and has access to all the memory in the system), SMEP is a good measure to block the activity of LPE exploits, which often transfer control to the code block located in the user‚Äôs part of the virtual address space . <br><br>  Windows drivers are organized in such a way that to interact with the client from Ring 3, a special interface called IOCTL is used.  The driver registers a special handler in the Windows kernel, which can be used from the user mode by the well-known API function <i>DeviceIoControl</i> .  The application, when using this API, transmits the code of the required function, the set of arguments to the driver, and indicates the input and output memory buffers for passing arguments and getting the result. <br><br>  The new Capcom.sys update <a href="http://www.theregister.co.uk/2016/09/23/capcom_street_fighter_v/%3Fmt%3D1474792875563">uses</a> the IOCTL interface and two functions with codes 0xAA012044, 0xAA013044.  The peculiarity of these functions is that they allow the client of the user mode to execute code in the kernel mode according to the pointer received from there, and before this disables the SMEP.  After executing the function, the SMEP is turned back on by setting the corresponding bit of the CR4 register.  Obviously, disabling is used to execute code in kernel mode from user mode. <br><br><img src="https://habrastorage.org/files/04b/ef5/57a/04bef557a01c4078b86f70718338c9ae.jpg"><br>  Fig.  Capcom.sys function that executes the function specified in the IOCTL request with SMEP disabled. <br><br>  Obviously, since the computer game driver is digitally signed and provides such a potentially dangerous interface for access from user mode, it creates a backdoor in the system.  Third-party code can use this driver to execute its code in Ring 0. <br><br>  Capcom has already released a game update that closes the vulnerability. <br><br><blockquote>  If you are on the street, you‚Äôll have to go.  We will update you for a PC rollback solution soon. </blockquote></div><p>Source: <a href="https://habr.com/ru/post/310950/">https://habr.com/ru/post/310950/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../310930/index.html">Placement of the table of values ‚Äã‚Äãwith the help of additional requisite and expansion of the 1C configuration</a></li>
<li><a href="../310938/index.html">Laziness, impatience and self-conceit are the three main virtues of a programmer. Happy birthday, Larry Wall</a></li>
<li><a href="../310942/index.html">Ultralight BDD: Little Mechanization of Stand-Alone Tests</a></li>
<li><a href="../310944/index.html">After the biggest data theft in history on Yahoo! still ‚Äú33 misfortunes‚Äù</a></li>
<li><a href="../310946/index.html">Canvas Gauges 2.0</a></li>
<li><a href="../310952/index.html">React.js: build an isomorphic / universal application from scratch. Part 3: we add authorization and data exchange with API</a></li>
<li><a href="../310954/index.html">A few notes about MySQL</a></li>
<li><a href="../310956/index.html">Development of user interaction with mobile devices - key principles</a></li>
<li><a href="../310958/index.html">How to answer a maximum of questions with one report?</a></li>
<li><a href="../310960/index.html">The logic of consciousness. Part 7. Self-organization of the context space</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>