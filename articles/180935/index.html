<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing your template engine in Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Surely, many of you thought about how template engines are arranged, what is its internal structure and how is it converted into fragments of HTML-cod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing your template engine in Python</h1><div class="post__text post__text-html js-mediator-article">  Surely, many of you thought about how template engines are arranged, what is its internal structure and how is it converted into fragments of HTML-code, but did not guess about some features of its implementation.  Therefore, let's implement a simplified version of the template engine and demonstrate how it works ‚Äúunder the hood‚Äù. <br><a name="habracut"></a><br>  First, you need to decide on the syntax with which our engine will work.  In other words, language constructs that the template engine will understand and process them accordingly. <br><br><h4>  Language syntax </h4><br>  Although in our case the language will be greatly simplified, but for example, we will work with variables and blocks that will look something like this: <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">!‚Äî-</span></span></span><span class="hljs-tag">     `{{`  `}}` </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">--</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>{{my_var}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">!‚Äî-</span></span></span><span class="hljs-tag">    `{%`  `%}` </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">--</span></span></span><span class="hljs-tag">&gt;</span></span> {% each items %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>{{it}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% end %}</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Most blocks must be closed as in the example above and end with the <i>end</i> tag. <br>  Our templating engine will also support working with cycles and conditions.  Do not forget to add support for calls inside the blocks - this will be quite a handy thing that may come in handy. <br><br><h5>  Cycles </h5><br>  With their help, we will be able to bypass collections and get an element with which we will perform the necessary operations: <br><br><pre> <code class="html hljs xml">{% each people %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>{{it.name}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% end %} {% each [1, 2, 3] %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>{{it}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% end %} {% each records %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>{{..name}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% end %}</code> </pre><br><br>  In this example, <i>people</i> is a collection and <i>it</i> refers to an element from it.  Point, as a separator, allows you to refer to the fields of the object to extract the necessary information.  Using ".." will provide access to names located in the context of the parent. <br><br><h5>  Conditions </h5><br>  No need to present.  Our engine will support <i>if ... else constructions</i> , as well as operators: <i>==, &lt;=,&gt; =, =, is,&gt;, &lt;!</i>  . <br><br><pre> <code class="html hljs xml">{% if num &gt; 5 %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> 5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% else %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>   5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% end %}</code> </pre><br><br><h5>  Function calls </h5><br>  Calls must be specified inside the template.  Let's not forget, of course, support for named and positional parameters.  Blocks calling functions should not be closed. <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">!‚Äî-</span></span></span><span class="hljs-tag">   </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">--</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'date'</span></span></span><span class="hljs-tag">&gt;</span></span>{% call prettify date_created %}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ...   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>{% call log 'here' verbosity='debug' %}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><h4>  Theoretical part </h4><br>  Before delving into the details of the engine, which will be engaged in rendering templates, it is necessary to have an idea of ‚Äã‚Äãhow to present templates in memory. <br><br>  In our case, <a href="http://en.wikipedia.org/wiki/Abstract_syntax_tree">abstract syntax trees</a> will be used (hereinafter referred to as the ASD), so necessary for the presentation of data.  ASD is the result of the lexical analysis of the source code.  This structure has many advantages compared to the source code, one of which is the elimination of unnecessary text elements (for example, separators). <br><br>  We will parse the data and analyze the template, building the corresponding tree, which will represent a compiled template.  Rendering a template will be a simple tree walk, which will return tree elements formed into fragments of HTML code. <br><br><h4>  Syntax definition </h4><br>  The first step in our difficult business will be the separation of content into fragments.  Each fragment is an HTML tag.  For division of content, regular expressions will be used, as well as the <i>split ()</i> function. <br><br><pre> <code class="python hljs">VAR_TOKEN_START = <span class="hljs-string"><span class="hljs-string">'{{'</span></span> VAR_TOKEN_END = <span class="hljs-string"><span class="hljs-string">'}}'</span></span> BLOCK_TOKEN_START = <span class="hljs-string"><span class="hljs-string">'{%'</span></span> BLOCK_TOKEN_END = <span class="hljs-string"><span class="hljs-string">'%}'</span></span> TOK_REGEX = re.compile(<span class="hljs-string"><span class="hljs-string">r"(%s.*?%s|%s.*?%s)"</span></span> % ( VAR_TOKEN_START, VAR_TOKEN_END, BLOCK_TOKEN_START, BLOCK_TOKEN_END ))</code> </pre><br><br>  So let's analyze the TOK_REGEX.  In this regular expression, we have the choice between a variable or a block.  This has a definite meaning - we want to divide the content into variables or blocks.  The wrapper in the form of tags that have been specified in advance will help us identify the fragments that need to be processed.  The? Sign specified in a regular expression is not a greedy repetition.  This is necessary so that the regular expression is ‚Äúlazy‚Äù and stops at the first match, for example, when it is necessary to extract the variables specified inside the block.  By the way, <a href="http://www.regular-expressions.info/repeat.html">here</a> you can read about how to control the greed of regular expressions. <br><br>  Here is a simple example demonstrating the work of this regular season: <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>TOK_REGEX.split(<span class="hljs-string"><span class="hljs-string">'{% each vars %}&lt;i&gt;{{it}}&lt;/i&gt;{% endeach %}'</span></span>) [<span class="hljs-string"><span class="hljs-string">'{% each vars %}'</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;i&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'{{it}}'</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;/i&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'{% endeach %}'</span></span>]</code> </pre><br><br>  In addition, each processed fragment will have its own type, which will be taken into account when processing and compiling.  The fragments will be divided into four types: <br><br><pre> <code class="python hljs">VAR_FRAGMENT = <span class="hljs-number"><span class="hljs-number">0</span></span> OPEN_BLOCK_FRAGMENT = <span class="hljs-number"><span class="hljs-number">1</span></span> CLOSE_BLOCK_FRAGMENT = <span class="hljs-number"><span class="hljs-number">2</span></span> TEXT_FRAGMENT = <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre><br><br><h4>  Formation of ASD </h4><br>  After analyzing the regular expression of the source text of the HTML page containing fragments belonging to our template engine, it is necessary to build a tree based on elements that belong to our ‚Äúlanguage‚Äù.  We will have the class Node, which is the root of the tree and contains the child nodes, which are subclasses for each type of node.  Subclasses should contain the <i>process_fragment ()</i> and <i>render ()</i> methods: <br>  - <i>process_fragment () is</i> used to further analyze the content and necessary attributes of the Node object. <br>  - <i>render () is</i> needed to convert the corresponding fragment into HTML code <br><br>  Optionally implement the <i>enter_scope ()</i> and <i>exit_scope ()</i> methods, which are called during the compiler operation.  The first function, <i>enter_scope ()</i> , is called when the node creates a new area (more on this later), and <i>exit_scope ()</i> to leave the current area being processed when the area has finished processing. <br><br>  <b>Node</b> Base Class: <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_Node</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, fragment=None)</span></span></span><span class="hljs-function">:</span></span> self.children = [] self.creates_scope = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.process_fragment(fragment) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_fragment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, fragment)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enter_scope</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exit_scope</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render_children</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context, children=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> children <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: children = self.children <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render_child</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(child)</span></span></span><span class="hljs-function">:</span></span> child_html = child.render(context) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> child_html <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> str(child_html) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>.join(map(render_child, children))</code> </pre><br><br>  Here is an example of the <b>Variable</b> subclass: <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_Variable</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(_Node)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_fragment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, fragment)</span></span></span><span class="hljs-function">:</span></span> self.name = fragment <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> resolve_in_context(self.name, context)</code> </pre><br><br>  When determining the node, a fragment of the text will be analyzed, which will be shown to us by the type of this fragment (i.e. it is a variable, a bracket, etc.) <br>  Text and variables will be converted to their corresponding subclasses. <br>  If these are cycles, then their processing will take a little longer, because it means a whole series of commands that need to be executed.  It is quite simple to find out that this is a block of commands: it is only necessary to analyze a fragment of the text contained in ‚Äú{%‚Äù and ‚Äú%}‚Äù.  Here is a simple example: <br><pre> <code class="html hljs xml">{% each items %}</code> </pre><br>  Where <i>each</i> is the intended block of commands. <br><br>  The important point is that each node creates an area.  During the compilation process, we monitor the current region and the nodes that are added within this region.  If during the analysis the closing bracket is encountered, the formation of the current region is completed, and the transition to the next one takes place. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> root = _Root() scope_stack = [root] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fragment <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.each_fragment(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> scope_stack: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> TemplateError(<span class="hljs-string"><span class="hljs-string">'nesting issues'</span></span>) parent_scope = scope_stack[<span class="hljs-number"><span class="hljs-number">-1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> fragment.type == CLOSE_BLOCK_FRAGMENT: parent_scope.exit_scope() scope_stack.pop() <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> new_node = self.create_node(fragment) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> new_node: parent_scope.children.append(new_node) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> new_node.creates_scope: scope_stack.append(new_node) new_node.enter_scope() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> root</code> </pre><br><br><h4>  Rendering </h4><br>  The final step is the conversion of the SDA to HTML.  To do this, we visit all the nodes of the tree and call the render () method.  In the rendering process, it is necessary to take into account what is being done at the moment: with literals or with the context of the variable name.  To do this, use <a href="http://docs.python.org/2/library/ast.html">ast.literal_eval ()</a> , which safely allows you to analyze the string: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eval_expression</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(expr)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'literal'</span></span>, ast.literal_eval(expr) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> ValueError, SyntaxError: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'name'</span></span>, expr</code> </pre><br><br>  If we deal with the context of a variable name, then we analyze what is indicated with it: ‚Äú.‚Äù Or ‚Äú..‚Äù: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name, context)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> name.startswith(<span class="hljs-string"><span class="hljs-string">'..'</span></span>): context = context.get(<span class="hljs-string"><span class="hljs-string">'..'</span></span>, {}) name = name[<span class="hljs-number"><span class="hljs-number">2</span></span>:] <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tok <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> name.split(<span class="hljs-string"><span class="hljs-string">'.'</span></span>): context = context[tok] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> context <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> KeyError: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> TemplateContextError(name)</code> </pre><br><br><h4>  Conclusion </h4><br>  This article is a <a href="http://alexmic.net/building-a-template-engine/">translation</a> that allows you to give a general idea of ‚Äã‚Äãhow template engines work.  Although this is the simplest example of implementation, it can be used as a basis for building more complex template engines. <br><br>  Full source code, as well as examples of use can be found <a href="https://github.com/alexmic/microtemplates">here.</a> </div><p>Source: <a href="https://habr.com/ru/post/180935/">https://habr.com/ru/post/180935/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180925/index.html">Introduction to Wolfram Mathematica</a></li>
<li><a href="../180927/index.html">Server Visualization: NodeJS + D3.js + PhantomJS</a></li>
<li><a href="../180929/index.html">One of the six remaining in working condition Apple-1 computers sold for $ 671,400</a></li>
<li><a href="../180931/index.html">In open offices, employees are more often ill and worse off.</a></li>
<li><a href="../180933/index.html">Hiding the process in Windows Task Manager</a></li>
<li><a href="../180937/index.html">New look at old MS Ajax</a></li>
<li><a href="../180939/index.html">Decorators in PHP. Implementation of the extension</a></li>
<li><a href="../180941/index.html">Using RESTful Controllers for AngularJS Resources</a></li>
<li><a href="../180943/index.html">Microsoft has patented the achievement system for watching TV.</a></li>
<li><a href="../180949/index.html">The future of anonymity: What is it?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>