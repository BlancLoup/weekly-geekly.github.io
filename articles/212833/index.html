<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Lshell instead of chroot ssh</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Everyone often encounters the fact that, at times, the usual ftp developers are missing and you need to provide ssh access. Our clients sometimes ask ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Lshell instead of chroot ssh</h1><div class="post__text post__text-html js-mediator-article">  Everyone often encounters the fact that, at times, the usual ftp developers are missing and you need to provide ssh access.  <a href="http://centos-admin.ru/">Our</a> clients sometimes ask for limited ssh access.  We used to use chroot ssh, and setting it up is not the easiest task, but I recently met a great product, lshell. <br><a name="habracut"></a><br><h4>  <b>Lshell - limited shell</b> </h4><br>  User went, allowing you to easily and easily lock the user in the specified directories and limit the commands to be executed.  It is in the CentOS and Debian repositories, you can install it like this: <br><pre><code class="bash hljs">yum install lshell</code> </pre> <br><pre> <code class="bash hljs">apt-get install lshell</code> </pre><br>  If there is a need for the latest version: <br><pre> <code class="bash hljs">wget https://github.com/ghantoos/lshell/releases/download/0.9.16/lshell-0.9.16.tar.gz tar xvfz lshell-0.9.16.tar.gz <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> lshell-0.9.16 python setup.py install --no-compile --install-scripts=/usr/bin/</code> </pre><br>  then it was enough to add it to the user <br><blockquote>  user: x: 502: 502 :: / home / user: / usr / bin / lshell </blockquote><br><h6>  Configuration file </h6><br>  /etc/lshell.conf: <br><blockquote>  # lshell.py configuration file <br>  # <br>  # $ Id: lshell.conf, v 1.27 2010/10/18 19:05:17 ghantoos Exp $ <br><br>  [global] <br>  ## log directory (default / var / log / lshell /) <br>  logpath: / var / log / lshell / <br>  ## set log level to 0, 1, 2, 3 or 4 (0: no logs, 1: least verbose, <br>  ## 4: log all commands) <br>  loglevel: 2 <br>  ## configure log file name (default is% u ie username.log) <br>  #logfilename:% y% m% d-% u <br>  #logfilename: syslog <br><br>  ## in case you are using syslog, you can choose your logname <br>  #syslogname: myapp 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      [default] <br>  ## a PATH <br>  allowed: ['ls', 'echo', 'cd', 'll'] <br><br>  ## a list of forbidden character or commands <br>  forbidden: [';', '&amp;', '|', '' ','&gt; ',' &lt;',' $ (',' $ {'] <br><br>  ## a list of commands to use with sudo (8) <br>  #sudo_commands: ['ls', 'more'] <br><br>  ## number of warnings when user enters a forbidden value before getting <br>  ## exited from lshell, set to -1 to disable. <br>  warning_counter: 2 <br><br>  ## command aliases list (similar to bash's alias directive) <br>  aliases: {'ll': 'ls -l', 'vi': 'vim'} <br><br>  ## introduction text to print (when entering lshell) <br>  #intro: "== My personal intro == \ nWelcome to lshell \ nType '?'  or 'help' to get the list of allowed commands " <br><br>  ## configure your promt using% u or% h (default: username) <br>  #prompt: "% u @% h" <br><br>  ## a value in seconds for the session timer <br>  #timer: 5 <br><br>  ## list of the space <br>  #path: ['/ home / bla /', '/ etc'] <br><br>  ## set the home folder of your user.  If not specified the home_path is set to <br>  ## the $ HOME environment variable <br>  #home_path: '/ home / bla /' <br><br>  ## update the environment variable $ PATH of the user <br>  #env_path: ': / usr / local / bin: / usr / sbin' <br><br>  ## add environment variables <br>  #env_vars: {'foo': 1, 'bar': 'helloworld'} <br><br>  ## allow or forbid the use of scp (set to 1 or 0) <br>  #scp: 1 <br><br>  ## forbid scp upload <br>  #scp_upload: 0 <br><br>  ## forbid scp download <br>  #scp_download: 0 <br><br>  ## allow of forbid the use of sftp (set to 1 or 0) <br>  #sftp: 1 <br><br>  ## list of command allowed to execute over ssh (eg rsync, rdiff-backup, etc.) <br>  #overssh: ['ls', 'rsync'] <br><br>  ## logging strictness.  If set to 1, any unknown command is considered as <br>  ## forbidden, and user's warning counter is decreased.  If set to 0, command is <br>  ## considered as unknown, and user is only warned (ie *** unknown synthax) <br>  #strict: 1 <br><br>  ## force files scp sent to a specific directory <br>  #scpforce: '/ home / bla / uploads /' <br><br>  ## history file maximum size <br>  #history_size: 100 <br><br>  ## set history file name (default is /home/%u/.lhistory) <br>  #history_file: "/home/%u/.lshell_history" <br></blockquote><br>  As you can see, the default configuration file is divided into the global [global] section and the default section [default].  It is also possible to set the configuration for a specific user: [user] <br>  the settings specified in the user section have a higher priority compared to the [default] section <br>  Consider an example section for a user: <br><blockquote>  [user] <br>  allowed: ['ls', 'echo', 'cd', 'll', 'cp', 'mv'] <br>  strict: 1 <br>  warning_counter: 2 <br>  #timer: 5 <br>  path: ['/ var / www / site1', '/ var / www / site2'] <br>  #allowed_cmd_path: ['/ home / user / bin'] <br>  scp: 1 <br>  sftp: 1 <br>  overssh: ['ls', 'rsync'] </blockquote><br>  allowed - allowed commands <br>  warning_counter - the number of prohibited actions before the user is thrown out of the terminal (works if strict is only enabled) <br>  timer - timeout in seconds after which the user will be thrown out of the terminal <br>  path - directories that are allowed to visit the user, in addition to home <br>  allowed_cmd_path - directories in which the user is allowed to run executable files <br>  scp - disable or allow the user to use scp <br>  sftp - disable or allow sftp user <br>  overssh - List of allowed commands that the user is allowed to use by sending them via ssh <br><br>  The only significant flaw that I discovered is a bug in which the design: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> / &amp;&amp; &lt;&gt;</code> </pre><br>  gives an error message.  For example: <br><pre> <code class="bash hljs">user:~$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /home/user &amp;&amp; ls lshell: /home/user &amp;&amp; ls: No such file or directory</code> </pre><br>  The developer <a href="https://github.com/ghantoos/lshell/issues/67">promised to</a> fix this bug. <br><br><h4>  <b>References:</b> </h4><br>  <a href="https://github.com/ghantoos/lshell">Product page at github.com</a> </div><p>Source: <a href="https://habr.com/ru/post/212833/">https://habr.com/ru/post/212833/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../212817/index.html">Definer.js - simple modular system</a></li>
<li><a href="../212821/index.html">Adaptive letters? You are welcome!</a></li>
<li><a href="../212823/index.html">Rusty brains - go over the bridge. The Bridge by Ty Tailor</a></li>
<li><a href="../212825/index.html">Anti-rootkit for Userland-RootKit Azazel "on the knee"</a></li>
<li><a href="../212831/index.html"># 3dprintexpo: Russia's first exhibition of three-dimensional printing</a></li>
<li><a href="../212835/index.html">Tame ZoG (Part 3: Football of the Kumsk Valley)</a></li>
<li><a href="../212837/index.html">The basics of creating a 2D character in Godot. Part 2: compiling templates, a little about GDScript, movement and animation of the hero</a></li>
<li><a href="../212839/index.html">SIP Security Essay</a></li>
<li><a href="../212841/index.html">Portal migration from SharePoint 2010 to SharePoint 2013. What has changed and how to live with it</a></li>
<li><a href="../212843/index.html">Monthly digest of interesting IT-projects on Kickstarter ‚Ññ1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>