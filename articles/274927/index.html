<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Happiness chart with python, pandas and matplotlib</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Winter is truly a wonderful time of the year. But it is in winter that I always think about getting up and leaving for work, and then returning from w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Happiness chart with python, pandas and matplotlib</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/553/f10/7c5/553f107c5c7a414187e431f96fe456bf.png" alt="image"><br><br>  Winter is truly a wonderful time of the year.  But it is in winter that I always think about getting up and leaving for work, and then returning from work without seeing the sunlight.  Today I wanted to visualize the data on the rising and setting of the sun and correlate it with the routine of the day (working hours and waking time), which is so usual for many people.  For work we will use Python (pandas + matplotlib).  Let's see what came of it. <br><a name="habracut"></a><br>  First we need data that can be visualized.  I found a suitable set <a href="http://voshod-solnca.ru/">here</a> .  On the page we see two tables containing data on the date, sunrise and sunset, the zenith and the duration of daylight hours, as well as data on civilian, navigational and astronomical twilight.  For work, we need time of sunrise and sunset, information about civilian twilight, and, of course, the date that we can present on the timeline. <br><br>  For convenience, create a project folder / sumerki, inside it, create a folder / input and application script sumerki.py.  In the input folder, we put 2 files sumerki_1.txt and sumerki_2.txt, where we just copy the tables from the site.  The first rows of the tables look like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  January 1 09:00:39 12:33:54 16:07:09 07:06:29 +1: 16
 08:14:08 07:25:39 06:40:27 18:27:20 17:42:09 16:53:40 </pre><br><br>  Data from external sources is quite enough for us, now it remains to indicate wakefulness time and working time.  Without further ado, I decided to take the following time intervals: 07:00:00 - 20:00:00 to be awake and 09:00:00 - 18:00:00 work day. <br><br>  The structure is clear.  Let's now have some Python code. <br><br>  First, we will do all the necessary imports and make small adjustments. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.dates <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> mdates <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> matplotlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> rc <span class="hljs-comment"><span class="hljs-comment">#           def stn(dstr): return mdates.datestr2num(dstr.tolist()) #         matplotlib font = {'family': 'Verdana', 'weight': 'normal'} rc('font', **font) DIR = os.path.dirname('__File__')</span></span></code> </pre> <br>  Let's form data in pandas (at the output we get 2 data frames with which we will work - S, W): <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#               s1 = open(os.path.join(DIR, 'input', 'sumerki_1.txt'), 'r').read().split('\n') s2 = open(os.path.join(DIR, 'input', 'sumerki_2.txt'), 'r').read().split('\n') oday = datetime.datetime.strptime('01.01.2016', '%d.%m.%Y') dates = [oday + datetime.timedelta(days=dt) for dt in range(len(s1))] #            (0, 24) s = [[dates[i[0]]] + s1[i[0]].split('\t') + s2[i[0]].split('\t') + ['00:00:01', '23:59:59'] for i in enumerate(s1)] columns = ['datetime', 'date', 'voshod', 'zenit', 'zahod', 'dolgota', 'cng', 'sum1_from', 'sum2_from', 'sum3_from', 'sum3_to', 'sum2_to', 'sum1_to', '0', '24'] S = pd.DataFrame(s, columns=columns) #  ,      /   () w = [[dt, '07:00:00', '09:00:00', '18:00:00', '20:00:00'] for dt in dates] columns = ['datetime', 'life_from', 'work_from', 'work_to', 'life_to'] W = pd.DataFrame(w, columns=columns)</span></span></code> </pre><br>  Now we just have to display all the data obtained on the graph.  For convenience, I tried to pick colors - yellow for the daylight, orange for twilight, and bluish with the stars for the dark. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      fig, ax = plt.subplots() plt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%Y-%m')) plt.gca().xaxis.set_major_locator(mdates.MonthLocator()) plt.gcf().autofmt_xdate() #      l1, = ax.plot(S['datetime'], stn(S['voshod']), 'r-', label='') l2, = ax.plot(S['datetime'], stn(S['zahod']), 'b-', label='') l3, = ax.plot(S['datetime'], stn(S['sum1_from']), 'g-', label=' ()') l4, = ax.plot(S['datetime'], stn(S['sum1_to']), 'm-', label=' ()') l5, = ax.plot(W['datetime'], stn(W['work_from']), 'k-', label=' ') l6, = ax.plot(S['datetime'], stn(W['work_to']), 'k-', label=' ') l7, = ax.plot(S['datetime'], stn(W['life_from']), 'k-', label=' ') l8, = ax.plot(S['datetime'], stn(W['life_to']), 'k-', label=' ') #    # - plt.fill_between(S['datetime'].tolist(), stn(S['voshod']), stn(S['zahod']), alpha=0.4, color='yellow', hatch='.') # C plt.fill_between(S['datetime'].tolist(), stn(S['sum1_from']), stn(S['voshod']), alpha=0.4, color='orange', hatch='.') plt.fill_between(S['datetime'].tolist(), stn(S['zahod']), stn(S['sum1_to']), alpha=0.4, color='orange', hatch='.') #  plt.fill_between(S['datetime'].tolist(), stn(S['0']), stn(S['sum1_from']), alpha=0.4, color='blue', hatch='*') plt.fill_between(S['datetime'].tolist(), stn(S['sum1_to']), stn(S['24']), alpha=0.4, color='blue', hatch='*') #      plt.fill_between(W['datetime'].tolist(), stn(W['work_from']), stn(W['work_to']), alpha=0.1, color='blue', hatch='/') plt.fill_between(W['datetime'].tolist(), stn(W['life_from']), stn(W['life_to']), alpha=0.1, color='blue', hatch='/') # ,    ax.yaxis_date() ax.xaxis_date() ax.set_xlabel("") ax.set_ylabel("") plt.title('    ( )   .') plt.legend(handles=[l1, l2, l3, l4, l6, l8], loc=1, fontsize=11) fig.autofmt_xdate() #       plt.show()</span></span></code> </pre><br><br>  <b>UPD (01/13/2016)</b> <br>  At the request of <a href="http://habrahabr.ru/users/myxo/" class="user_link">myxo, I</a> cite several graphs for different latitudes.  In the original article schedule Moscow (UTC +3). <br><div class="spoiler">  <b class="spoiler_title">Kaliningrad (UTC + 2)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/67a/c1d/473/67ac1d4738264b1ebf98861113e16b66.png" alt="image"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">St. Petersburg (UTC + 3)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/5fa/357/4dd/5fa3574dd94f4b06911a06068914866a.png" alt="image"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Yekaterinburg (UTC + 5)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/051/8e1/0d7/0518e10d7db941429ddcbb81f3d825a9.png" alt="image"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Novosibirsk (UTC + 6)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/5e7/c90/2ab/5e7c902ab75247dc81390fef3d44a59f.png" alt="image"><br></div></div><br><br>  Looking through these graphs, the conclusions suggest themselves: <br><ul><li>  The east is the city, the earlier it gets light and darker before </li><li>  The north is the city, the more extended daylight </li></ul><br>  Along with the conclusions come and thoughts about which city is more suitable for a person.  For example, I am impressed by Yekaterinburg most of all - it‚Äôs very nice to get up during the whole year at the already bright time of the day, especially if you have a habit of getting up early, like mine.  St. Petersburg, beloved by me, has its own charm, which impresses me not only with its ‚Äúwhite nights‚Äù, but also with its atmosphere and its incomparable charm. <br><br>  Thank you for your attention and comments! </div><p>Source: <a href="https://habr.com/ru/post/274927/">https://habr.com/ru/post/274927/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274917/index.html">Gif inside</a></li>
<li><a href="../274919/index.html">Asterisk: ngrep, sipgrep, sngrep, protocol diagram</a></li>
<li><a href="../274921/index.html">Beeline Data School, holidays are over</a></li>
<li><a href="../274923/index.html">Farm IIS and Application Request Routing</a></li>
<li><a href="../274925/index.html">ActiveRecord's inheritance describing one table (single table inheritance pattern) in Yii2</a></li>
<li><a href="../274931/index.html">Django Single Sign-On and Microsoft Active Directory</a></li>
<li><a href="../274933/index.html">What does it cost us to build an ICC? We collect xRM on the pipeline</a></li>
<li><a href="../274935/index.html">Analysis of the decision taken by the second (so far) place in the Hola contest for programming mail filters on JavaScript</a></li>
<li><a href="../274937/index.html">Thematic cartography: one-dimensional maps</a></li>
<li><a href="../274939/index.html">Intel Skylake processor error causes computer to freeze during complex calculations</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>