<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Holivarny story about the linter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We all write code. Lots of code. Of course, there are errors. Sometimes it's just a curve code, and sometimes the cost of a mistake is a blown up spac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Holivarny story about the linter</h1><div class="post__text post__text-html js-mediator-article">  We all write code.  Lots of code.  Of course, there are errors.  Sometimes it's just a curve code, and sometimes the cost of a mistake is a blown up <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D1%2580%25D0%25B8%25D0%25BD%25D0%25B5%25D1%2580-1">spacecraft</a> .  Of course, no one makes intentional jambs, everyone tries to monitor quality to the best of their ability, but without static analysis tools one can hardly be sure that everything is perfect. <br><br>  Linters help lead the code to a single style and avoid mistakes.  However, only if you are ready for suffering, and do not eventually dismiss "pylint: disable", only so that it lags behind.  What a linter should be, and why Pylint should not do, Nikita Sobolev ( <a href="https://habr.com/ru/users/sobolevn/" class="user_link">sobolevn</a> ), who understands and loves linter so much that he even called his company so as not to upset them - wemake.services, knows. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/56f/5cb/946/56f5cb9466bea0d6fd71b319f5165c2a.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Below is the text version of the report on <a href="https://conf.python.ru/2019">Moscow Python Conf ++</a> about linters, how to do them correctly and how not to.  There was a lot of interactive, online and communication with the audience.  The speaker, along the way, conducted polls and tried to convince listeners: he looked at the trend and, like in debates, tried to equalize the ratio and change public opinion.  Some part of the polls fell into deciphering, but not all, so a video is attached to complete the picture. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/7IVCOzL41Lk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h2>  Why do we need linter? <br></h2><br>  The most important task of the linter is to <strong>bring the code to uniformity</strong> .  There are many options to write the same thing in Python: put a comma here or there, forget to close the brackets, or remember.  When people write code for a long time, it becomes similar to a patchwork of loose pieces sewn at different times.  Working with such a blanket is unpleasant, it discourages the desire to read the code, and this is very bad. <br><br>  <strong>Linter make life easier on review</strong> .  I come to the code review and think: ‚ÄúI don‚Äôt want to do this!  Now there will be extra spaces and other nonsense! ‚ÄùI would like someone else to prepare a good code, and after that I will appreciate the big conceptual things. <br><br>  Sometimes I look at the code and think that everything seems fine, and then I see in a function too many variables or an error that I didn‚Äôt pay attention to.  Automatics would find this error, and I looked through it.  In order not to fall into such situations - I use a <strong>linter</strong> - he <strong>finds everything that is hidden and difficult to find.</strong> <br><br><h2>  What are the linters? </h2><br>  <strong>The simplest ones check only the style</strong> , for example, <strong>Flake8</strong> .  To some extent, it‚Äôs also Black, but rather it‚Äôs an auto-formatter linter.  <strong>Linters are harder to check the semantics</strong> , and not just the style: what are you doing, why, and beat you in the hands if you write with errors.  A good example is <strong>Pylint</strong> , which we all know, use and love.  I call such linters <strong>Best practices</strong> .  The third type is <strong>Type checking</strong> , these linters are a bit apart.  Type checking in Python is a novelty; two competing platforms are doing it now: <strong>Mypy</strong> and <strong>Pyre</strong> . <br><br><h2>  How to use linters? </h2><br>  I do not claim that the linters are a panacea and a replacement for everything.  This is not true.  Linters - the first step of the pyramid, on which the code gets into production. <br><br>  There are three steps in the pyramid: <br><br><ul><li>  <strong>Run the linters</strong> .  It is very fast and does not need anything except the source code - no infrastructure, no settings.  Check: the first <strong>sanity check</strong> has passed - everything is fine, we are working further. </li><li>  <strong>Stage tests</strong> .  This process is more complicated and longer due to errors not related to the code.  We already need the correct and complete setup of the entire application. </li><li>  <strong>Stage Review</strong> . </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/77c/f40/e1c/77cf40e1cbfb54f312e98c7af63ac9d0.png"><br><br>  <b>These are necessary steps</b> to get the code into production.  If you did not pass one step, you forgot something or the reviewer said that it will not work like this, you will see the inscription: failed - the bad code does not get into production. <br><br><h3>  Do you use a linter at work? </h3><br>  If you ask developers from a harsh enterprise, in which they work 7 days a week, whether they use a linter, it turns out that at least a third of them use linters very strictly: <strong>CI drops, checks are harsh</strong> .  The rest are about equally used linters only <strong>to check the style</strong> , <strong>never</strong> and as a <strong>reporting system</strong> : launch the linter, generate a report and see how bad everything is.  Linters are used, and this is good.  In our company, everything is built very harshly: hard lintting, a lot of checks, a double code review. <br><br><h3>  Code Review <br></h3><br>  Problems arise just at this stage.  This is the top and most difficult stage of the pyramid: it will not be possible to automate the code review, and if possible, it will lead to the automation of writing code.  Then programmers will not be needed. <br><br>  The standard process looks like this: the code comes to the review, I find errors, and I don‚Äôt want to allow them anymore.  For example, I saw that a developer caught a BaseException: ‚ÄúDon't be so.  Please don't catch it! ‚Äù  10 days later the same.  Once again I remind: <br><br>  - <em>BaseException we do not catch.</em> <br>  - <em>Ok, I get it.</em> <br><br>  A year goes by - the same mistake.  A new person comes - the same mistake.  I think - how to automate everything so that the situation does not repeat, and only comes to mind: ‚Äú <strong>Let's flush our linter?</strong>  ¬ªLet's create an open package, put there all the rules that we use in our work and automate the checking of the rules, so that every time we don‚Äôt write hands on the code review.  We automate everything well and immediately! <br><br>  Naturally, you can say: ‚Äú <strong>Ready linters already exist,</strong> they work, everyone uses them - why make your own?‚Äù, And you will be absolutely right, because there are really linters.  Let's see which ones and what they do. <br><br><h3>  Pylint <br></h3><br>  On the air heading " <strong>Why not Pylint?</strong>  ‚ÄúI‚Äôve heard this question many times.  I will answer it softer.  Pylint is a great tool, a rock star for Python code, but it does have features that I don‚Äôt want to see in my linter. <br><br>  <strong>It mixes everything together: stylistic checks, Best practices and Type checking</strong> .  In Pylint Type checking is underdeveloped, because there is no information about the types: it tries to deduce it somehow, but it turns out not very.  Therefore, often, when I write <code>model_name.some_property</code> on Django, I can see the error: ‚ÄúSorry, there is no such property - you cannot use it!‚Äù I remember that there is a plugin, I put it, then I use Celery, it also starts with trouble, I put a plugin for Celery, I use some other magic library, and in the end I just write everywhere: ‚Äúpylint: disable‚Äù ... This is not what I want to get from the linter. <br><br>  Another feature hidden from the user is <strong>the Pylint own implementation of Abstract syntax tree in Python</strong> .  This is what the code looks like when you parse it and get information about the tree of nodes that make up the code.  I do not really trust my own implementations, because they are always wrong. <br><br>  In addition to Pylint, there are other linters who also do their job. <br><br><h3>  SonarQube <br></h3><br>  Beautiful, but a separate tool that lives somewhere near your project. <br><br><ul><li>  <strong>SonarQube will not be able to run frequently</strong> : it needs to be placed somewhere, watched, monitored, tuned. </li><li>  It is <strong>written in Java</strong> .  If you want to fix your linter for Python, then you will write code in Java.  I believe that conceptually this is wrong - a developer who can write in Python should be able to write code to test Python. </li></ul><br>  The company that develops the SonarQube specifically looks at the concept of product development.  This can be a problem. <br><br>  The advantage of SonarQube is that it has very cool checks that show the complexity, possible hidden errors and bugs.  I like checks, I would leave them, and I would change the platform. <br><br><h3>  Flake8 <br></h3><br>  A wonderful linter is very simple, but with one problem: <strong>there are few rules</strong> with which he checks how well the code is written.  At the same time, Flake8 has a lot of very simple plugins: the minimum plug-in is 2 methods that need to be implemented.  I thought - let's take Flake8 as a basis and write plugins, but with my own understanding of the benefits to the company.  And we did. <br><br><h3>  The most stringent linter in the world <br></h3><br>  We made a tool in which we collected everything that we consider correct for Python and called <a href="https://github.com/wemake-services/wemake-python-styleguide"><strong>wemake-python-styleguide</strong></a> .  The plugin was posted publicly, as I believe that <strong>Open Source by Default is a good practice</strong> .  I am deeply convinced that many tools will benefit if they are laid out in Open Source.  For our tool we came up with the slogan: <strong>‚ÄúThe most stringent linter in the world!‚Äù</strong> <br><br><blockquote>  The key word in our linter is strict, which means pain and suffering. </blockquote><br>  If you use a linter, and it doesn‚Äôt make you suffer so much that you grab your head: ‚ÄúWhat else you don‚Äôt like, damn you,‚Äù then this is a bad linter.  It skips errors, does not follow the quality of the code enough, and we do not need it.  We need the most stringent in the world, which checks a lot.  Now we have about <strong>250 different checks in both categories</strong> : stylistic and Best practices, but without Type checking.  Mypy does it, we don‚Äôt treat it in any way. <br><br>  Our linter has <strong>no compromise</strong> .  We have no rules of the category "I would not want to do it, but if you really want, then you can."  No, we always say harshly - we do not do it, because it is bad.  Then people come and say: ‚ÄúThere is 2.5 use case, where it is possible in principle!‚Äù.  If such cases, clearly write that here this line is permissible, so that the linter would ignore it, but explain why.  This should be a comment, why did you allow some strange practice and why do you do it.  This approach is also useful for documenting code. <br><br>  The most stringent linter <strong>does not require configuration (WIP)</strong> .  We still have the settings, but we want to get rid of them: having freedom, the user will surely adjust so that the linter will not work properly. <br><br><blockquote>  A good tool in the settings does not need - it has good default values. </blockquote><br>  With this approach, the code will be consistent and will work the same for everyone, at least in theory.  We are still working on this, and while there are settings, you can use our tool and customize it for yourself. <br><br><h2>  Who do you depend on? </h2><br>  From a large number of tools. <br><br><ul><li>  <strong>Flake8</strong> . </li><li>  <strong>Eradicate</strong> is a cool plugin that finds commented out snippets in the code and forces you to delete them, because storing dead code in a project is bad.  We do not allow to do so. </li><li>  <strong>Isort</strong> is a tool that makes sorting imports correctly: in order, indenting, beautiful quotes. </li><li>  <strong>Bandit</strong> is a great utility for checking code security statically.  Finds stitched passwords, clumsy uses of <code>assert</code> in the code, calls to <code>Popen</code> , <code>sys.exit</code> and says that all this cannot be used, and if you want to, it asks you to write a reason. </li><li>  And even more than <strong>20 plugins</strong> that check brackets, quotes and commas. </li></ul><br><h2>  What are we checking? </h2><br>  There are 4 groups of rules that we use and enforce. <br><br>  <strong>Difficulty</strong> is the biggest problem.  We do not know what complexity is and do not see it in the code.  We look at the code with which we work every day and it seems that it is not complicated - take, read, everything works.  This is not true.  Simple code is a familiar code.  Difficulty has clear criteria that we check.  About the criteria themselves - later.  If the code violates the criteria, then we say: "The code is complex, rewrite!" <br><br>  Variable <strong>names</strong> are an unsolved programming problem.  Who will read, when and in what context is not clear.  We try to make the names as consistent and understandable as possible, but although we are trying, the problem has not yet been fully resolved. <br><br>  For <strong>consistency</strong> , we have a simple rule - write the same everywhere.  If there is any approved approach, use it everywhere.  It doesn't matter if you like it or not, consistency is more important. <br><br>  We try to use only the <strong>best practices.</strong>  If we know that some practice is not very good, then we prohibit its use.  If a developer wants to use a prohibited practice, we expect an argument from him: why and why to apply.  Perhaps, during the description process, an understanding will come about why it is bad. <br><br><h3>  What is complexity? <br></h3><br>  Complexity has specific metrics that you can look at and say - difficult or not.  A lot of them. <br><br>  <strong>Cyclomatic Complexity</strong> - everyone's favorite cyclomatic complexity.  It finds a large number of nested <code>if</code> , <code>for</code> , other structures in the code, and indicates that the code is too extensive and difficult to read.  With the nested code, everything is bad: you read, you read, you read - you go back, you read, you read, you read - you jumped up, then in another cycle.  It is impossible to safely pass such a code from top to bottom. <br><br>  <strong>Arguments, Statements and Returns.</strong>  These are quantitative metrics: how many arguments are in a function or method, how many inside the body of this function or the statements and returns method. <br><br>  <strong>Cohesion and Coupling</strong> are popular metrics from the OOP world.  <strong>Cohesion</strong> shows the connectedness of the class inside.  For example, there is a class, and inside you use all the methods and properties - everything that you declared.  This is a good class with high cohesion inside.  <strong>Coupling</strong> is how much different parts of the system are connected: modules and classes.  We want to achieve maximum cohesion within the class and minimal coherence outside.  Then the system is easily maintained and works well. <br><br>  <strong>Jones Complexity</strong> - I borrowed this metric, but only because it is a bomb!  Jones Complexity determines the complexity of the line - the harder the line, the harder it is to understand, because short-term human memory can not process more than 5-9 objects at once.  This is the so-called <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D0%25B3%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B5_%25D1%2587%25D0%25B8%25D1%2581%25D0%25BB%25D0%25BE_%25D1%2581%25D0%25B5%25D0%25BC%25D1%258C_%25D0%25BF%25D0%25BB%25D1%258E%25D1%2581-%25D0%25BC%25D0%25B8%25D0%25BD%25D1%2583%25D1%2581_%25D0%25B4%25D0%25B2%25D0%25B0">"Miller's wallet"</a> . <br><br>  We look at these important metrics and some others, which are much more, and determine whether the code is suitable or not.  In our understanding, <strong>complexity is a waterfall</strong> . <br><br><h3>  Waterfall difficulty <br></h3><br>  The difficulty begins with the fact that we have written a line, and it is still good.  But then comes the business and says that prices have doubled, and we multiply by 2. At this point Jones Complexity goes crazy and says that now the line is too complicated - there is too much logic. <br><br>  Well, we get a new variable, and the function complexity analyzer says: <br><br>  - <em>No, this is impossible - now there are too many variables inside the function.</em> <br><br>  I will make a new <strong>method</strong> , and pass arguments to it.  Now checking the number of arguments of a function, or the number of methods inside a <strong>class</strong> says that this is also not possible - the class is too complex and should be split into two parts.  Smashed, highlighting another class.  Now there are more classes and everything is fine, but the <strong>module‚Äôs</strong> complexity check reports that the module is now too complex and needs to be refactored.  Why?! <br><br>  This is called suffering.  That is why I say that the linter must make suffer.  We started by multiplying by 2 in one line, and finished <strong>refactoring the entire system</strong> .  Adding a small piece of code leads to refactoring of whole modules, because complexity is spreading out like a waterfall and covers everything that is possible. <br><br>  <strong>‚ÄúNeed to refactor‚Äù</strong> - this thing forces you to refactor code.  You can not just sit out: "This code does not touch, like it works."  No, once you change the code in another place, and the waterfall of complexity will flood the module that did not touch and you will have to refactor it.  I believe that refactoring is good, and the more it is, the more stable and better your system works.  <strong>And everything else is subjective!</strong> <br><br>  Now let's talk about tastes.  This is a holivar and interactive part! <br><br><h2>  Holivar <br></h2><br>  Let's talk, comments are open.  First, let me remind you that names are a complex and unsolved problem.  You can fight because of how to name a variable, but we have some approaches that help at least not to make obvious mistakes. <br><br><h3>  Names <br></h3><br>  How do you like these: <strong>var, value, item, obj, data, result</strong> ?  What is <strong>data</strong> ?  Any data.  What is <strong>result</strong> ?  Some kind of result.  I often see the <strong>result</strong> variable and a call to a hell of a method in an incomprehensible class - and I think: ‚ÄúWhat is this result?  Why is he here? ‚Äù <br><br>  There are many developers who disagree with me, and they say that <strong>value</strong> is a normal variable name: <br><br>  - <em>I always use key and value!</em> <br>  - <em>Why not use key and value, but say that the key is the name and value is the last name?</em>  <em>Why it is impossible to name first_name and last_name - now there is a context.</em> <br><br>  Usually people agree, but they still argue.  This is a very holivar piece: at least 3 people spent an hour of their lives on me to argue with me about it. <br><br><h3>  To name variables in one letter is normal? <br></h3><br>  For example, <strong>q</strong> ?  We all know the classic case: <code>for i in some_iterable:</code>  What is <strong>i</strong> ?  In C, this is standard practice, and from it everything goes.  But in Python, collections and iterators.  In the collections are elements that have names - let's call them somehow differently. <br><br><blockquote>  Half of the developers think that calling variables i, x, y, z is normal. </blockquote><br>  I believe that it is impossible to give names in one letter.  I want more context and it‚Äôs good that the second half of the developers agree with me.  If in C this is somehow permissible due to historical heritage, then in Python this is a very big problem and you don‚Äôt need to do that. <br><br><h3>  Consistency <br></h3><br>  Let's just choose one of many ways, and say, "Let's do this."  Good or bad - no longer important - just consistently. <br><br>  We are talking only about Python 3, we don‚Äôt consider Legacy at all. <br><br>  I have an argument: when we are inherited from something, we should know from what it would be nice to see the name of the parent.  The funny thing is that we usually see the name of the parent, except when it is an <strong>object</strong> .  Therefore, I formulated a rule for myself: when I write a class, I inherit from something - I always write the name of the parent.  It doesn't matter what it will be - Model, object or something else. <br><br>  If there is a choice to write <code>Class Some(object)</code> or <code>class Some</code> , then I will choose the first one.  On the one hand, it shows that we obviously always write what we inherit from.  On the other hand, there is no particular <strong>verbosity in it</strong> : we do not lose anything from a few additional keystrokes. <br><br>  Two thirds of developers are more accustomed to the second option, and I even know why.  My hypothesis: all because we long migrated from the second version of Python to the third, and now we show that we write on the third Python.  I do not know how correct the hypothesis is, but it seems to me that this is so. <br><br><h3>  F-lines are terrible? <br></h3><br>  Variants of answers: <br><br><ul><li>  Yes: they lose context, thrust logic into a pattern and are not lazy - (38%). </li><li>  Not!  They are a miracle!  - (62%). </li></ul><br>  There is a hypothesis that f-lines are terrible.  They shove anything!  f-strings are not the same as <code>.format</code> , the differences are cardinal.  When we declare a template and then format it, we perform two actions separately: first, we define the template, and then we format it.  When we declare an f-string, we perform two actions at the same time: we immediately declare the template and format it at the same time. <br><br>  There are two problems with f-lines.  We declared the template for the f-string and everything works.  And then we decide to move the template 2 lines up or move it to another function - and everything breaks.  <strong>Now there is no context that allowed the formatting of strings</strong> , and we cannot process them correctly.  The second big problem with f-strings: they allow you to do the scary thing - <strong>thrust logic into a template</strong> .  Suppose there is a line in which we simply insert the username and the word ‚ÄúHello‚Äù - this is normal.  There is nothing particularly scary, but then we see that the username comes in capital letters, we decide to translate it into the Title case and write directly in the <code>username.title()</code> template.  Then conditions, cycles, imports appear in the template.  And all the other parts of php. <br><br>  All these problems make me say that <strong>f-lines are a bad topic</strong> , we don‚Äôt use them.  The funny thing is that we do not have a case in which only f-lines are suitable for us.  Any formatting is usually suitable, but we chose <code>.format</code> - everything else is impossible - neither <code>%</code> nor f-lines.  The work <code>.format</code> also linable because you can put curly quotes inside it and write either the name of the variable or its order. <br><br><blockquote>  During the report, the number of opponents of f-lines increased from 33 to 38% - this is a small, but a victory. </blockquote><br><h3>  Numbers <br></h3><br>  Do you like these numbers: <code>final_score = 69 * previous result / 3.14</code> .  It seems that this is a standard line of code, but what is 69?  Such questions often arise when I look at the code that I wrote some time ago, and the manager at that moment says: <br><br>  - <em>Please multiply by 147.</em> <br>  - <em>Why on 147?</em> <br>  - <em>We have such a tariff.</em> <br><br>  I multiplied and forgot, or for a long time picked up some value of the coefficient to make it work - and then I forget how I picked it up and why.  It turns out that an important research work remained hidden behind a number without a name.  I don‚Äôt even know what the number is, but I can only find, recall and restore from the commit only. <br><br>  Why not do it differently - all complex numbers should be put into their own variable with the name and documentation?  For example, for the number 69, write that this is an average in the market, and now the constant has a name and context.  I will write a comment that I took a constant on the site of such a study.  If the research changes in the future, then I‚Äôll come in and update the data. <br><br>  Thus, we guarantee that no magic numbers will get through our code and will not complicate it from the inside.  They make their way through checking the complexity of each line and say: ‚ÄúHere's the number 4766. What I mean, I don‚Äôt know, figure it out yourself!‚Äù For me, this was a great discovery. <br><br><blockquote>  As a result, we realized that this should be monitored, and we don‚Äôt miss any magic numbers in the code.  It's good that almost 100% of our colleagues agree with us, and they also do not use such numbers. </blockquote><br>  But there are exceptions - these are numbers from ‚àí10 to 10, numbers 100, 1000 and the like, simply because they are often found without them is difficult.  <strong>We are tough, but not sadists</strong> and think a little. <br><br><h3>  Do you use '@staticmethod'? <br></h3><br>  Let's think about what <strong>staticmethod is</strong> .  Have you ever wondered why it is in Python?  Me not.  I had a lovely pylint that said: <br><br>  - <em>Look, you do not use</em> <code>self</code> , <code>cls</code> - <em>make staticmethod!</em> <br>  - <em>Well, Pylint, I will do staticmethod.</em> <br><br>  Then I taught Python to beginners, and they asked what staticmethod is and why it is needed.  I did not know the answer and thought about whether it is possible to write the same function, or not to use <code>self</code> in a regular function, simply because it is such a class and something happens.  Why do we need staticmethod construction? <br><br>  I googled the question, and it turned out to be as deep as a rabbit hole.  There are many other programming languages ‚Äã‚Äãin which staticmethod also do not like.  And it is argued that staticmethod breaks the object model.  As a result, I realized that <strong>staticmethod is not the place</strong> , and we sawed it out.  Now, if we use the staticmethod decorator, the linter will say: ‚ÄúNo, sorry, refactor!‚Äù <br><br>  Most developers disagree with me, but about half still think that it is better to write instead of staticmethod either usual methods or ordinary functions. <br><br><h3>  Logic in __init __. Ru - good or bad? <br></h3><br>  This is my favorite topic.  Surely, when you create a new package and somehow call it - it creates __init __. Py and you think what to put in it?  What to put in __init __. Ru, and what - in files next to each other?  For me it was a non-trivial question, and I was always lost: probably something most important?  Then I thought, no, on the contrary, I would put the most important in the most understandable context.  If you put something in __init __. Ru, and then import it all, you get cyclical imports - also bad. <br><br>  I looked at various popular libraries, climbed their __init __. Py, and noticed that mostly there is either garbage or backward compatibility.  For me, this question has become acute, when I started creating large packages with a lot of subpackages - you get lost.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a result, we decided to bring all possible logic into separate modules, and it works. Nobody breaks Python, everything is fine, just as before, there is simply no logic in __init __. Py, and 90% of the surveyed colleagues agree with us. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You say - well, you changed the API, but you want users to still import what they want, and where they want from? Yes, you can, because the issue of compatibility is separate. We do not want to break the user API by refactoring internal code. Therefore, there are cases in which there may be some logic in __init __. Ru: imports, redefinitions of what you have deleted. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But there is a setting called</font></font><code>I_CONTROL_CODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- I control the code. </font><font style="vertical-align: inherit;">This is the case when it is justified. </font><font style="vertical-align: inherit;">When I control the code I use, there is no logic in __init __. Py - only documentation. </font><font style="vertical-align: inherit;">But if I don‚Äôt control the code, it is used by other people who download my library, do something, then you can put redefinitions and imports there.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The hasattr function often need you? </font></font><br></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How often </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">does the hasattr</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function </font><strong><font style="vertical-align: inherit;">need</font></strong><font style="vertical-align: inherit;"> ? It seems to me that often enough, because in Python dynamic typing is ducky. We sometimes need a hasattr to check for the presence of an argument or attribute on a class (provocation). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In fact, I believe that there is no need for hasattr, this function does not work the way you think. When I talked to developers and asked how hasattr works, they often answered that the function looks for the presence of an attribute. Due to the fact that Python is dynamically and type-typed, hasattr can do anything at all. Sometimes it may even go to the database, and you will not even know about it. Therefore, it is better to use </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getattr</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and the ‚ÄúBetter apologize than permission‚Äù approach. </font><font style="vertical-align: inherit;">With a combination of these two approaches, you abandon the hasattr function ‚Äî either getattr or </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exception</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At the conference, the hall divided 50 to 50 - perhaps it was the most persistent struggle of all the polls, but still my candidate lost the election.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What we want to add to our linter </font></font><br></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is not in our linter, but we really want a </font></font><a href="https://github.com/seddonym/layer_linter"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">layer-linter</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . What is he doing? You specify in a text format contracts: what can be imported and what is not, in which places you can import and in which not. You create a contract for how business code will be divided into layers within your code. Because of this, you get a great increase in quality without any gestures. Highly recommend. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I have already spoken about </font></font><a href="https://github.com/mschwager/cohesion"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cohesion</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . We do not have this plugin at the base, but we use it. Cohesion looks at how your class is connected inside. He has a lot of False Positive errors and cannot use it in production, but we use it for analytics - we see which classes are good and which are bad. </font><a href="https://github.com/jendrikseipp/vulture"><strong><font style="vertical-align: inherit;">Vulture</font></strong></a></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plugin</font></font><a href="https://github.com/jendrikseipp/vulture"><strong><font style="vertical-align: inherit;"></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uses the search for unused code in Python and allows you to delete it. </font><font style="vertical-align: inherit;">Due to the fact that Python is a very dynamic language, the plugin gives a lot of errors. </font><font style="vertical-align: inherit;">Therefore, we use it as a cohesion. </font></font><br><br> <a href="https://github.com/rubik/radon"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Radon</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> allows you to watch different metrics of your code, there are a lot of them: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halstead</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintainability Index</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cyclomatic complexity. </font><font style="vertical-align: inherit;">Try it, run the code and see its odds - that's cool.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Final type </font></font><br></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I love </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">final classes</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in python. </font><font style="vertical-align: inherit;">They were recently added to Typing Extensions, and before that I had my own package, which I wrote myself. </font><font style="vertical-align: inherit;">I believe that if you made a class, and it can no longer be inherited, this is good, because you just fixed the implementation. </font><font style="vertical-align: inherit;">If a person says that he still wants to change something, then why?</font></font> Do not.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use the composition. </font><font style="vertical-align: inherit;">If you change something - write the documentation, and then perhaps you can.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gratis </font></font><br></h2><br> <a href="https://github.com/wemake-services/wemake-python-styleguide"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Our linter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> appeared thanks to the work of many people, and I am very grateful to them. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b90/e6c/e5d/b90e6ce5dc2ef3c00c83e73fa162447e.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All linter contributors are on this slide to say a public thanks to them. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you want to contribute our linter, you can do it too. </font><font style="vertical-align: inherit;">Send pool requests, we will review them. </font><font style="vertical-align: inherit;">Together we will do a cool thing that will help our Python code to become much cleaner, better and more pleasant.</font></font><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By the way, Nikita Sobolev joined the </font></font><a href="https://conf.python.ru/2019/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moscow Python Conf ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> program committee </font><font style="vertical-align: inherit;">, and helps in preparing the classroom program. </font><font style="vertical-align: inherit;">The conference in two months, and we have already selected two thirds of the reports, you can study them </font></font><a href="https://conf.python.ru/2019/abstracts/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and decide to participate in our productive event for Python programmers.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And now let's light up some holivar through interactive. </font><font style="vertical-align: inherit;">Voting results during a speech under the spoiler. </font><font style="vertical-align: inherit;">Vote and check if the majority of developers do this, or check out the cheaters, and then drown for your option.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">View someone else's opinion</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/2fd/ed2/6fa/2fded26fa11ac61fb98e0b729b6bd0c6.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/01e/18a/d2d/01e18ad2d4184a42079552671a8957d8.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f87/653/af3/f87653af3f7b6c6baca449b3c81b564f.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1e/5a8/576/d1e5a8576f1a724683a57f2c2861950e.png"><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/433480/">https://habr.com/ru/post/433480/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../433466/index.html">Compare pages. Simple plugin for Atlassian Confluence</a></li>
<li><a href="../433468/index.html">Fault Injection: your system is unreliable if you have not tried to break it</a></li>
<li><a href="../433472/index.html">Unity 2018.3 has been released</a></li>
<li><a href="../433474/index.html">Pylint from the inside. How he does it</a></li>
<li><a href="../433476/index.html">50 shades of celery</a></li>
<li><a href="../433486/index.html">What's again? Reviving Non-Bank Debit Cards</a></li>
<li><a href="../433488/index.html">Christmas Scrum Meetup UPD Broadcast Mitap</a></li>
<li><a href="../433490/index.html">Creality CR-X 3D Printer Review</a></li>
<li><a href="../433494/index.html">10 English idioms, the value of which you will never guess</a></li>
<li><a href="../433496/index.html">State-owned companies are obliged to switch to domestic software by 2022</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>