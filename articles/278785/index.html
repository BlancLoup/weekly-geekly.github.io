<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Lessons from participation in the Dota Science hackathon in the framework of Data Fest 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="6 days ago around midnight, we, the EC.Dota2 team of four people ( ivankomarov , kolyanzzz , Sergei_Smetanin , AzZzone ), began working on the online ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Lessons from participation in the Dota Science hackathon in the framework of Data Fest 2</h1><div class="post__text post__text-html js-mediator-article"> 6 days ago around midnight, we, the EC.Dota2 team of four people ( <a href="https://habrahabr.ru/users/ivankomarov/" class="user_link">ivankomarov</a> , <a href="https://habrahabr.ru/users/kolyanzzz/" class="user_link">kolyanzzz</a> , <a href="https://habrahabr.ru/users/sergei_smetanin/" class="user_link">Sergei_Smetanin</a> , <a href="https://habrahabr.ru/users/azzzone/" class="user_link">AzZzone</a> ), began working on the online part of <a href="http://dotascience.com/">the Dota Science hackathon</a> .  None of us knew anything about the game Dota2. <br><br>  First, chronologically, about the first, ‚Äúonline‚Äù part.  There is a <a href="http://www.dota2.com.cn/theshanghaimajor/english/schedule">grid of</a> world finals of the <a href="http://www.dota2.com.cn/theshanghaimajor/english/schedule">game</a> ‚ÄúThe Shanghai Major 2016‚Äù.  It is necessary to predict its outcome before the match.  As time has shown (but not a description of the competition), it was necessary to predict the matches for March 3, 4, 5.  For training were given historical data about the matches in Dota2 for different past tournaments with aggregated information about each match.  From Wednesday I had to start getting enough sleep, because  all day work.  Two models were developed for the online stage. <br><br>  The following metric was used as an indicator of forecast quality: score = log2 (p_winner) +1, where p_winner is the predicted probability of winning the team that won as a result. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/ab8/cc2/a49/ab8cc2a49008417ea3062d71955a1719.jpg"><br><br>  Here it is worth saying a few words about the goals of the hackathon.  The purpose of the formal - to get the highest relative to other assessment of the quality of forecasts.  The goal of Data Fest is to build the best, relative to others, model for predicting the outcome of a match using machine learning methods. <br><br>  One Data Fest 2 speaker on the last day ( <a href="https://www.linkedin.com/in/natekin/ru">Nuker</a> ?) Correctly noted that ‚Äúthe problem of machine learning can always be solved without machine learning‚Äù (with its own neural networks in the head).  Who used models, who used expert experience, who just played by chance?  Unknown. <br><br>  The final assessment of the first stage is the average of all values ‚Äã‚Äãof the quality metric for the predicted probabilities.  As the <a href="http://alchemist.dotascience.com/leaderboard/">tournament table of the</a> first stage of the Hakaton shows, the number of predictions per ‚Äúteam‚Äù varied by 10‚Äì20 times. <a name="habracut"></a>  As we know, the missing data can, of course, be replaced by something, but here the key question is whether the person deliberately concluded that the probability is 0.5 or just overslept the moment of sending the forecast?  Probably overslept, just not sent.  Therefore, it would be better to simply not consider the commands in the table with the number of predictions less than, say, 10, because  too little information to evaluate the team model.  And the best strategy of the game in the final assessment is to make a good prediction and no longer play (send 0.5), which, of course, does not correspond to the meaning of Data Fest. <br><br>  Model online part number 1 "Nikolay" (machine learning).  The SVM algorithm predicts the victory of the first team in terms of the shares of the victories of the first team in all matches for the last 1, 2, ..., 12 months + the same for the second team.  When creating a model, an algorithm was selected and insignificant features were screened out. <br><br>  The feature set was selected as follows.  The share of team wins in previous matches is an indicator of team mastery.  Mastery can change over time, so it is important to consider dynamics.  Initially, we wanted to use the team wins for individual months, but there were too many gaps in the data.  Therefore, we moved to shares in the past few months.  Among the signs was the share of victories of the first team in all matches against the second team, but the importance of this sign turned out to be very low (presumably due to the large number of passes), so we eliminated this sign. <br><br>  There was also an idea to take into account the skill of the teams that were defeated by the first or the second team when calculating their skills, since a victory over a strong team should make a greater contribution to the skill index than a victory over a weak one.  However, there was no time to implement the idea. <br><br>  Model online part number 2 "Sergey Smetanin" (assumptions + data analysis).  We decided to consider matches only from 07/01/2015.  After analyzing the table of victories / losses / difference of victories and losses, we saw that sorting by victories most precisely groups the teams of the tournament ‚ÄúThe Shanghai Major 2016‚Äù: <br><br><img src="https://habrastorage.org/files/71d/427/ba1/71d427ba17bd4198b8b517ac97ed4987.jpg"><br><br>  Accordingly, as <i>ad hoc, the</i> probabilities of victory for the first team used a sum with identical weights of 0.5 two sizes: <br>  1) The ratio of the number of victories of the first team to the total number of victories of the first and second teams in all matches from 07/01/2015; <br>  2) The ratio of the number of victories of the first team to the total number of victories of the first and second teams in matches only between the first and second teams from 07/01/2015. <br><br>  Why?  Repeated from such assumptions: <br>  - teams and experience have greatly changed over time, so we will take only the latest information.  What is fresh?  We do not know.  For example, 07/01/2015. <br>  - the table of teams shows that victories most accurately group the teams ‚ÄúThe Shanghai Major‚Äù.  We will work with winnings. <br>  - it is probably important that the game was between two teams of interest.  We make a sign only for such matches.  (However, after the matches, the recalculation showed that it is better not to take this sign. Partly, therefore, we took into account all the teams in the second part of the hackathon.) <br>  - we look at the historical strength of the teams. <br>  - the force measured by the winnings already has all the information about the choice of strategy, players, etc.  Therefore, while we dwell on it. <br><br>  Model results: <br>  At first, Model 2 was in the lead, but the human factor played a role - they made a mistake when sending, one prediction was lost with probability 1. From the first place on March 3, they quickly gave up the palm of a steady ‚ÄúNikolay‚Äù, which would win 4th place of 42 at the end of the online part, if we consider at least 10 matches. <br><br>  Offline part officially began on March 5 at 20:00.  For building models, data was provided (at 0:30) on the course of matches of the tournament (the state of the game at different points in time during the match).  At 1:30 we received the latest missing information about who won in these matches.  By the beginning of the first match of the final (the match before the grand final) at 5:30 the model was ready. <br><br>  Input for model: <br>  - by player: xp_per_min, gold, net_worth, respawn_timer <br>  - by command: tower_state, barracks_state <br>  - for the match: duration <br><br>  Target variable: Radiant probability of winning <br><br>  Selected Model: Logistic Regression <br><br>  Selected predictors: team experience (xp), team total cost (net worth), experience ratio and team total cost (Radiant to Dire), respawn_timer (by heroes), level (by heroes), respawn_timer * level (by heroes). <br><br>  Training sample: data on the progress of all matches Shanghai Major 2016. <br><br>  <i>Note</i> : respawn_timer - the time until the revival of the killed hero. <br><br>  We took the product respawn_timer and level, because we assumed that the higher the level of the hero who temporarily left the game, the worse the team‚Äôs chances of winning. <br><br>  Since there were some doubts about the reliability of the model, we also displayed a graph of the difference in the experience of the teams in real time, so that if the chart shows who wins, and the model gives cautious predictions of about 0.5, send probabilities higher. <br><br>  The final surprised many when they defeated Liquid in a match against EG, with a negative difference in experience throughout the match (see chart).  EG was the favorite of our first Dota2 consultant. <br><br><img src="https://habrastorage.org/files/3c6/272/bf0/3c6272bf089b412db0b8755cf1e8ed99.jpg"><br><br>  There are rare strategies that work in this way, the second of two (sided) consultants, who played Dota1 professionally at the level of the Russian Championship, explained to us.  This did not fit into our logic of feature selection, since we were confident that excellence in experience was one of the most decisive factors for winning.  The first consultant (young enthusiast Dota2) was shocked by what he saw. <br><br>  Probably, such a deviation could be seen from the state of the towers, but such a strategy seems to be so rare that it is not clear how to identify it with machine learning methods without having experience playing Dota2.  Adding signs related to the state of the towers and barracks worsened the quality of the model on our test sample. <br><br><img src="https://habrastorage.org/files/998/692/5c0/9986925c0d35437c97cc10f729876e6c.jpg"><br><br>  The graph shows the importance of signs.  There are many interesting things here, for example, we are surprised that the level of the first hero R turned out to be significantly less important than the level of the second hero R. <br><br>  We approached the grand final, not too believing in the strength of our model.  The two who made the model and the script for drawing the difference graph in the experience of the teams in real time went to sleep, the two remained to send the model results for evaluation and, in general, ‚Äúact according to the situation‚Äù. <br><br>  We also thought about the strategy of sending probabilities, taking into account the model evaluation at the end of the match.  Probably, the advantage can be obtained by starting as early as possible to predict the highest probabilities.  We thought that we would not make such a strategy: we send 0.5 until we ‚Äúsee‚Äù the team‚Äôs victory and then we send 1. Looking ahead, we can say that many have used this strategy or its variants.  It would be interesting to investigate in more detail the question of the optimal strategy, but there was no time. <br><br>  And ... the final has begun!  We watched the game for the first time in our life.  The model suddenly ... fell.  The schedule went anyway, and we played on it, deciding to systematically increase the deviation of the sent probability from 0.5 in three game periods: start (10 min) ¬± 0.05, middle (20) ¬± 0.25, final (20+) ¬± 0.49. <br><br>  It was possible to send probabilities during the selection of heroes.  One could come up with another model, but decided to just send nothing. <br><br>  We played for 15th place out of 23, predicting the outcome of the match according to the sum of quality ratings correctly (the final assessment of the quality of forecasts for the entire match turned out to be positive).  The game was predicted easily and it seems that in that match the model would help us more than a person‚Äôs fear of the logarithm. <br><br>  Second game  Most interesting.  Liquid suddenly came to life after the defeat (he chose the heroes correctly, as consultant No. 2 said).  The model was repaired (woke up the creator).  We were not sure how it works (and it was obvious that it was proceeding from experience), and sometimes we took the wheel into our own hands.  The model gave a strong scatter, we decided to cool her ardor.  We climbed to the 14th place in the game. <br><br>  The third game.  What will happen?  Finished 15th place, I think because of the interventions rates before the start of the game on Liquid. <br><br>  Fourth game  Or pan or gone.  We decided not to go to the car.  Put on autopilot.  Result - 3rd place ( <a href="http://alchemist.dotascience.com/predictions/match/51/">results of the last match of the grand final</a> ) after extremely extreme and extremely confident teams, perhaps the best result of pure machine learning. <br><br>  Conclusion: Although the model seems harsh, but she is strong (she ... we congratulate her on March 8!).  Especially for matches that go with the advantage of one team.  The model did not waste time in vain, did not look at the recent past ... as we do.  Not looking for strategies as a consultant.  She simply said that from the place where we are now in the match, historically everything goes to such an outcome. <br><br>  In total, 10th place (according to <i>our</i> total calculations) of 23 teams who played in all 4 games of the grand final. <br><br><img src="https://habrastorage.org/files/fcb/ffe/e15/fcbffee1567648849de4db9eef2ed130.jpg"><br><br>  If we eliminate the "extreme" and "confident", then the place will be higher.  By the way, to play only algorithms, it would be useful for people to bet real money on the result.  Then it would be interesting to look at the last 5 teams for the sum of 4 games, which would be dropped from 9000 to 300000 rubles (at 1 ruble per metric unit).  I think then the winning team would think more carefully. <br><br>  Lessons: <br>  1) Hackathon is a cool thing with its tight time and an unknown topic that needs to be opened.  We will play <s>Dota2</s> hackathons on! <br>  2) We performed well, taking into account the tight deadlines and complete ignorance of Dota2. <br>  3) Trust the machine (but verify). <br>  4) Experts are needed to transfer knowledge that will be pulled out of the data for a long time and which the machine will then check.  In this hackathon, the ‚Äúmodels‚Äù of experts simultaneously had bias + variance, i.e.  they had a rough model ‚Äúput everything on this team‚Äù, and a large scatter (‚Äúno, no, now put on this‚Äù).  Perhaps symbiosis machine + expert is best. <br>  5) Do not go into combat with one tool.  Suddenly refuse?  We are grateful that we had a schedule that saved the first match of the grand final. <br>  6) For rare events (emissions in the form of very rare strategies) there are not enough observations to adequately take into account the contribution of such a strategy. </div><p>Source: <a href="https://habr.com/ru/post/278785/">https://habr.com/ru/post/278785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278775/index.html">We write on D for Raspberry Pi</a></li>
<li><a href="../278777/index.html">The digest of interesting materials for the mobile developer # 143 (February 29 - March 8)</a></li>
<li><a href="../278779/index.html">Why is ownership / borrowing in Rust so complicated?</a></li>
<li><a href="../278781/index.html">Adaptive Split View Controller and Popover in iOS 9 (Swift). Part 2</a></li>
<li><a href="../278783/index.html">Google fixed Android vulnerabilities</a></li>
<li><a href="../278787/index.html">√Öngstr√∂m Style System? The use of styles. S2</a></li>
<li><a href="../278789/index.html">Why I am NOT a TypeScript fan</a></li>
<li><a href="../278791/index.html">Microsoft ported SQL Server to Linux</a></li>
<li><a href="../278793/index.html">Do I need a JSON replacement? In the wake of an article about KTV</a></li>
<li><a href="../278797/index.html">In Google Summer of Code 2016 with KolibriOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>