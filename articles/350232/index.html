<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Oh, those modal windows or why I loved the render functions in VueJs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all! 
 My first posting went off with an unpleasant aftertaste. I promised to correct this misunderstanding and present your first article-le...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Oh, those modal windows or why I loved the render functions in VueJs</h1><div class="post__text post__text-html js-mediator-article">  Hello to all! <br><blockquote>  My first posting went off with an unpleasant aftertaste.  I promised to correct this misunderstanding and present your first article-lesson on <b>VueJs</b> to your court.  I hope it will be useful.  A lot of thoughts, a lot of experience too.  All my life I learn from other people's articles, lessons.  It's time to share knowledge too. <br></blockquote>  And we will create modal windows.  Yes, again they are.  But not as simple as described in my first (not my) publication. <br><br>  A lot of them already created for <b>Vue</b> .  Used everyones.  And apparently, when you reach a certain level of ownership of the instrument (in this case, <b>Vue</b> ), you immediately want to make a bicycle, but of course with your own bells and whistles, like, so much the coolest, etc.  And I did not become an exception to the rule. <br><br>  Of all the available modal components, I used mostly this one - <a href="https://github.com/javisperez/vuedals">Vuedals</a> . <br>  But I decided to upgrade it.  In principle, only the <b>EventBus</b> remains from the base and the interaction of events related to the opening-closing of windows.  The main component was rewritten and became a container wrapper and a new component was added - the modal window itself. <br>  But first things first.  And the article will turn out to be very rather big, who will master, that handsome :) <br><a name="habracut"></a><br>  Most modal windows in all examples are called in this style: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> @</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"visible = true"</span></span></span><span class="hljs-tag">&gt;</span></span>Show modal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modal</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"visible"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modal</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">export</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">default</span></span></span><span class="javascript"> { data() { </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">return</span></span></span><span class="javascript"> { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">visible</span></span></span><span class="javascript">: </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript"> } } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  It seems everything is beautiful.  But! <br><br>  What I see the disadvantages of this approach. <br><br>  First, the modal window template is located inside the parent component, where we call it.  And the window context is not isolated from the parent.  It is not always convenient and necessary for me. <br>  Secondly, if the same window is used in several places, it is necessary to duplicate the code.  What is not good! <br><br>  Thirdly, and that is probably the most important drawback - we can use the modal window only inside pages or other <b>Vue</b> components, but in places like <b>Vuex</b> , <b>Router</b> , and generally we cannot in any scripts.  For example, I need to call the modal login / registration window from the router or from the store at some event.  Examples are milen. <br><br>  Therefore, the approach used in <b>Vuedals</b> , when we open / close windows by calling a function with parameters and passing a ‚Äúraw‚Äù component, of the form - <br><br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'simple-modal'</span></span>, <span class="hljs-attr"><span class="hljs-attr">props</span></span>: [<span class="hljs-string"><span class="hljs-string">'test'</span></span>], <span class="hljs-attr"><span class="hljs-attr">template</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;div&gt;{{test}}&lt;/div&gt;"</span></span> }</code> </pre><br>  or full-fledged, which we imported from the outside, I was more to my liking. <br>  More control, reusability and call such a window can be almost anywhere. <br><br>  In general, it looks like this; we have the <b>ModalWrapper</b> component, which we import into the application and insert, for example, into the root App component.  Somewhere below. <br><br>  Then we call the this. $ Modals.open ({component: SimpleModal, title: 'Simple modal'}) method anywhere, where we pass the settings of our window and the component that we will show and see our modal window, which is rendered in <b>ModalWrapper</b> . <br><br>  There are a lot of events that occur during all manipulations with windows, these events are controlled using <b>EventBus</b> , and you can listen to them and somehow react. <br><br>  This is input data to make information easier to learn.  Basically, the article is more for newbies in Vue.  But I hope there will be a couple of interesting and sophisticated moments. <br><br>  I will throw pieces of code and comment on what is happening.  There is a link to examples and sources at the end. <br><br>  Well, and let's start with the main file - <br><br><div class="spoiler">  <b class="spoiler_title">index.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Bus <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./utils/bus'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ModalWrapper <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./modal-wrapper'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Modal <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./modal'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> VuModal = {} VuModal.install = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vue</span></span></span><span class="hljs-function">) =&gt;</span></span> { Vue.prototype.$modals = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vue({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'$modals'</span></span>, created() { Bus.$on(<span class="hljs-string"><span class="hljs-string">'opened'</span></span>, data =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$emit(<span class="hljs-string"><span class="hljs-string">'modals:opened'</span></span>, data); }); Bus.$on(<span class="hljs-string"><span class="hljs-string">'closed'</span></span>, data =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$emit(<span class="hljs-string"><span class="hljs-string">'modals:closed'</span></span>, data); }); Bus.$on(<span class="hljs-string"><span class="hljs-string">'destroyed'</span></span>, data =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$emit(<span class="hljs-string"><span class="hljs-string">'modals:destroyed'</span></span>, data); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'new'</span></span>, options =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.open(options); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, data =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.close(data); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'dismiss'</span></span>, index =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dismiss(index || <span class="hljs-literal"><span class="hljs-literal">null</span></span>); }); }, <span class="hljs-attr"><span class="hljs-attr">methods</span></span>: { open(options = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'new'</span></span>, options); }, close(data = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, data); }, dismiss(index = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'dismiss'</span></span>, index); } } }); Vue.mixin({ created() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'modals:new'</span></span>, options =&gt; { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'new'</span></span>, options); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'modals:close'</span></span>, data =&gt; { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, data); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'modals:dismiss'</span></span>, index =&gt; { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'dismiss'</span></span>, index); }); } }); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span> !== <span class="hljs-string"><span class="hljs-string">'undefined'</span></span> &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Vue) { <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Vue.use(VuModal); } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> VuModal; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { ModalWrapper, Modal, Bus }</code> </pre><br></div></div><br>  In it, we import the components used for our modal-pre-modal windows: <br><br><ol><li>  ModalWrapper.js - a generic wrapper for outputting our windows </li><li>  Modal.js is the modal window component itself.  It is not in the original <b>Vuedals</b> .  It is not necessary to use it directly.  He works in any case under the hood.  Further along the play you will see this trick with your ears and it will become clear why I added it. </li><li>  Bus.js - <b>EventBus</b> for communication between a wrapper component ( <b>ModalWrapper</b> ), modal windows ( <b>Modal</b> ) and our <b>VueJs</b> application. </li></ol><br>  Immediately bring the code Bus.js and describe what is happening there.  As mentioned earlier, <b>EventBus</b> left as it is in the original. <br><br><div class="spoiler">  <b class="spoiler_title">Bus.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> instance = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EventBus</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!instance) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.events = {}; instance = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> instance; } $emit(event, message) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.events[event]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> callbacks = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.events[event]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, l = callbacks.length; i &lt; l; i++) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> callback = callbacks[i]; callback.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, message); } } $on(event, callback) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.events[event]) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.events[event] = []; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.events[event].push(callback); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EventBus();</code> </pre><br></div></div><br>  Here we create a singleton instance of <b>EventBus</b> , which can subscribe to events ( <b>$ on</b> ) and trigger ( <b>$ emit</b> ) events.  I think there is nothing special to explain here.  <b>EventBus</b> collects callbacks and when they need to call.  Further along the way, it will be seen and understandable how it connects all our components. <br><br>  And now by index.js <br><br>  Here we export the default default function <b>install</b> - to connect our windows to the application (using <b>Vue.use ()</b> ) and the <b>ModalWrapper</b> , <b>Modal</b> and <b>Bus</b> components.  Well, when you connect <b>VueUniversalModal</b> via a script tag in the browser, activate our component if global <b>VueJs is connected</b> on the page. <br><br>  And in order: <br><br><div class="spoiler">  <b class="spoiler_title">$ modals</b> <div class="spoiler_text"><pre> <code class="javascript hljs">Vue.prototype.$modals = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vue({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'$modals'</span></span>, created() { Bus.$on(<span class="hljs-string"><span class="hljs-string">'opened'</span></span>, data =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$emit(<span class="hljs-string"><span class="hljs-string">'modals:opened'</span></span>, data); }); Bus.$on(<span class="hljs-string"><span class="hljs-string">'closed'</span></span>, data =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$emit(<span class="hljs-string"><span class="hljs-string">'modals:closed'</span></span>, data); }); Bus.$on(<span class="hljs-string"><span class="hljs-string">'destroyed'</span></span>, data =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$emit(<span class="hljs-string"><span class="hljs-string">'modals:destroyed'</span></span>, data); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'new'</span></span>, options =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.open(options); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, data =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.close(data); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'dismiss'</span></span>, index =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dismiss(index || <span class="hljs-literal"><span class="hljs-literal">null</span></span>); }); }, <span class="hljs-attr"><span class="hljs-attr">methods</span></span>: { open(options = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'new'</span></span>, options); }, close(data = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, data); }, dismiss(index = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'dismiss'</span></span>, index); } } });</code> </pre><br></div></div><br>  Here we hook to the global <b>VueJs</b> (via <b>prototype</b> ) instance of <b>Vue</b> under the name <b>$ modals</b> . <br><br>  In his <b>created</b> method (which will start immediately after launching the application), we sign our <b>EventBus</b> to the events <b>opened</b> (window opening), <b>closed</b> (window closing) and <b>destroyed</b> (no windows, remove <b>ModalWrapper</b> ).  When these events <b>occur, EventBus</b> will emit <b>modals: opened</b> , <b>modals: closed</b> and <b>modals: destroyed events</b> into the <b>$ modals</b> component.  We can listen to these events wherever <b>VueJs</b> is available. <br><br>  In general, I first wanted to throw half of these communications, as some are not at all obligatory, but I left it after thinking.  It may be useful to collect some statistics on modal windows, for example.  Yes, and beginners may understand something for themselves in this seemingly porridge from <b>$ on</b> , <b>$ emit</b> - calls. <br><br>  Next this. $ On ... <br><br>  Here we enable listening for <b>new</b> , <b>close</b> , <b>dismiss events</b> by the <b>$ modals</b> component <b>itself</b> .  When these events occur, the corresponding methods of the <b>$ modals</b> component are <b>called</b> .  Which in turn open ( <b>open</b> ), close ( <b>close</b> ) and cancel ( <b>dismiss</b> ) the window. <br><br>  As you can see, we have two ways to close the window - <b>dismiss</b> (cancel or bourgeois - cancel - from the same opera) and <b>close</b> .  The difference is that when you close a modal window through <b>close</b> , we can pass data to the <b>onClose</b> callback function (we will look at later), which we cling to the options of our new modal window. <br><br>  And the actual methods <b>open</b> , <b>close</b> and <b>dismiss</b> of the <b>$ modals</b> component.  We run them through <b>EventBus</b> , the events <b>new</b> , <b>close</b> and <b>dismiss</b> in our <b>ModalWrapper</b> .  There already will be all the magic. <br><br>  And the last thing to <b>install</b> is the index.js file. <br><br><pre> <code class="javascript hljs">Vue.mixin({ created() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'modals:new'</span></span>, options =&gt; { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'new'</span></span>, options); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'modals:close'</span></span>, data =&gt; { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, data); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$on(<span class="hljs-string"><span class="hljs-string">'modals:dismiss'</span></span>, index =&gt; { Bus.$emit(<span class="hljs-string"><span class="hljs-string">'dismiss'</span></span>, index); }); } });</code> </pre><br>  Here we extend the <b>created</b> method through <b>Vue</b> -mixin to all components of <b>Vue</b> , in which we start listening on components by the <b>modals: new</b> , <b>modals: close</b> and <b>modals: dismiss events</b> and when they are called, via <b>EventBus we</b> also trigger the corresponding events in <b>ModalWrapper</b> . <br><br>  All these hellish calls here are needed to manage our modal windows.  And they give us 4 options for running <b>open</b> , <b>close</b> and <b>dismiss events</b> . <br><br>  The first way to call our modal window in the application: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$modals.open(options)</code> </pre><br>  The second way: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$modals.$emit(<span class="hljs-string"><span class="hljs-string">'new'</span></span>, options)</code> </pre><br>  Third: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$emit(<span class="hljs-string"><span class="hljs-string">'modals:new'</span></span>, options)</code> </pre><br>  And the fourth (for this method we need to import Bus.js, but this gives us the opportunity to call the window not from the <b>Vue</b> component, but from any script): <br><br><pre> <code class="javascript hljs">Bus.$emit(<span class="hljs-string"><span class="hljs-string">'new'</span></span>, options)</code> </pre><br>  Well, <b>close</b> , <b>dismiss</b> by analogy. <br><br>  Here, as they say - "the taste and color." <br><br><h4>  The next patient is Modal.js or we are not looking for easy ways. </h4><br>  Then the code will go more fun.  Recently, in my components I use <b>render</b> -functions (both standard and in <b>jsx-</b> format).  I started using it everywhere when I realized that they provide more opportunities for rendering.  With <b>render</b> functions, all the power of <b>Javascript</b> plus the cool internal <b>VueJs</b> kitchen with <b>vNode</b> gives tangible bonuses.  At the moment of their appearance, I somehow looked at them obliquely, thought it was necessary and continued to draw the components in the <b>template template</b> .  But now I know where the dog is buried. <br><br>  <b>Modal</b> is a full-fledged component that renders the modal window itself.  He has a bunch of input parameters: <br><br><div class="spoiler">  <b class="spoiler_title">modal.js - props</b> <div class="spoiler_text"><pre> <code class="javascript hljs"> props: { <span class="hljs-attr"><span class="hljs-attr">title</span></span>: { <span class="hljs-comment"><span class="hljs-comment">//   type: String, default: '' }, className: { //  css-    type: String, default: '' }, isScroll: { //  ,   -       type: Boolean, default: false }, escapable: { // dismiss()    Esc- type: Boolean, default: false }, dismissable: { // dismiss()               () type: Boolean, default: true }, fullscreen: { //   type: Boolean, default: false }, isTop: { //      type: Boolean, default: false }, isBottom: { //      type: Boolean, default: false }, isLeft: { //       type: Boolean, default: false }, isRight: { //       type: Boolean, default: false }, center: { //    type: Boolean, default: false }, size: { //   () type: String, default: 'md' }, bodyPadding: { // padding-  body - ,     type: Boolean, default: true } },</span></span></code> </pre><br></div></div><br>  In the code I commented on all the parameters so that it would be more visible.  And I throw the code in the spoiler so that the footcloth does not turn out.  So a lot of text. <br><br>  Farther: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CloseIcon <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./close-icon'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'vu-modal'</span></span>, <span class="hljs-attr"><span class="hljs-attr">componentName</span></span>: <span class="hljs-string"><span class="hljs-string">'vu-modal'</span></span>, ... }</code> </pre><br>  First, we import the cross-icon as a functional component, which renders it in the <b>SVG</b> format. <br><br><div class="spoiler">  <b class="spoiler_title">close-icon.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'close-icon'</span></span>, <span class="hljs-attr"><span class="hljs-attr">functional</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, render(h) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> h(<span class="hljs-string"><span class="hljs-string">'svg'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">attrs</span></span>: { <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-string"><span class="hljs-string">'12px'</span></span>, <span class="hljs-attr"><span class="hljs-attr">height</span></span>: <span class="hljs-string"><span class="hljs-string">'12px'</span></span>, <span class="hljs-attr"><span class="hljs-attr">viewBox</span></span>: <span class="hljs-string"><span class="hljs-string">'0 0 12 12'</span></span>, <span class="hljs-attr"><span class="hljs-attr">xmlSpace</span></span>: <span class="hljs-string"><span class="hljs-string">'preserve'</span></span> } }, [ h(<span class="hljs-string"><span class="hljs-string">'line'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">attrs</span></span>: { <span class="hljs-attr"><span class="hljs-attr">x1</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">y1</span></span>: <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-attr"><span class="hljs-attr">x2</span></span>: <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-attr"><span class="hljs-attr">y2</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-attr"><span class="hljs-attr">style</span></span>: { <span class="hljs-attr"><span class="hljs-attr">strokeLinecap</span></span>: <span class="hljs-string"><span class="hljs-string">'round'</span></span>, <span class="hljs-attr"><span class="hljs-attr">strokeLinejoin</span></span>: <span class="hljs-string"><span class="hljs-string">'round'</span></span>, } }), h(<span class="hljs-string"><span class="hljs-string">'line'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">attrs</span></span>: { <span class="hljs-attr"><span class="hljs-attr">x1</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">y1</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">x2</span></span>: <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-attr"><span class="hljs-attr">y2</span></span>: <span class="hljs-number"><span class="hljs-number">11</span></span> }, <span class="hljs-attr"><span class="hljs-attr">style</span></span>: { <span class="hljs-attr"><span class="hljs-attr">strokeLinecap</span></span>: <span class="hljs-string"><span class="hljs-string">'round'</span></span>, <span class="hljs-attr"><span class="hljs-attr">strokeLinejoin</span></span>: <span class="hljs-string"><span class="hljs-string">'round'</span></span>, } }) ]) } }</code> </pre><br></div></div><br>  Why did I think so, I do not even know. <br><br>  Next parameter <b>name</b> - well, this is a standard move. <br><br>  But <b>componentName</b> is no <b>accident</b> here.  We will need it further, in <b>ModalWrapper</b> when rendering. <br><br>  And the <b>propsData</b> calculated parameter: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { ... computed: { propsData() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$parent.$vnode.data.props &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$parent.$vnode.data.props.vModal) ? <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$parent.$vnode.data.props.vModal : <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$props } } }</code> </pre><br>  Here is more difficult. <br><br>  And the thing is this.  In the original <b>Vuedals,</b> all windows are also invoked using the 4 methods described above.  In each of them we have to pass the component that we want to show in the window and the window parameters (they all now are in the incoming <b>Modal</b> parameters and plus some new ones are added).  And if we want to run the same window in different parts of the application, we each time pass the window parameters (dimensions, other settings).  Which again is a duplication.  Yes, and not confused for long.  And we, programmers, are extremely lazy creatures at their core.  Therefore, this component <b>Modal</b> was created. <br><br>  Now we can create a modal window component, for example, like this: <br><br><div class="spoiler">  <b class="spoiler_title">simple-modal.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs">&lt;template lang=<span class="hljs-string"><span class="hljs-string">"html"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">vu-modal</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Test modal"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:isScroll</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"p50"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:center</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:escapable</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">slot</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"header"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"display: flex; justify-content: left; align-items: center;"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">v-if</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"header"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"padding-left: 10px"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Simple modal</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quia consequuntur minus sint quidem ut tenetur dicta sunt voluptates numquam. Eum totam ex maxime aut recusandae quae laborum fugit ab autem.</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">slot</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"footer"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"uk-button uk-button-smaller uk-button-primary"</span></span></span></span><span class="xml"><span class="hljs-tag"> @</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">click</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"close"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Cancel</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">vu-modal</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">template</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script&gt; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'simple-modal'</span></span>, <span class="hljs-attr"><span class="hljs-attr">props</span></span>: { <span class="hljs-attr"><span class="hljs-attr">lorem</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span>, <span class="hljs-attr"><span class="hljs-attr">default</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } }; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br></div></div><br>  That is, the standard component.  Wrapped by our <b>Modal</b> ( <b>vu-modal</b> ).  To this <b>vu-modal</b> we pass the parameters we need.  They will be the default values ‚Äã‚Äãfor this window. <br><br>  And now we call this window like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SimpleModal <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./modals/simple'</span></span> ... this.$modals.open({ <span class="hljs-attr"><span class="hljs-attr">component</span></span>: SimpleModal })</code> </pre><br>  All the default settings for the window we need are taken from the same <b>SimpleModal</b> component taken from the <b>vu-modal</b> wrapper.  We once created a window component with the settings we need and then use it anywhere without worrying about the settings.  Moreover, if we need to reassign those default values, we specify the values ‚Äã‚Äãwe need when we call this window: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SimpleModal <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./modals/simple'</span></span> ... this.$modals.open({ <span class="hljs-attr"><span class="hljs-attr">component</span></span>: SimpleModal, <span class="hljs-attr"><span class="hljs-attr">center</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> })</code> </pre><br>  Now the <b>center</b> parameter will replace the default parameter specified in the window template - <b>SimpleModal</b> . <br><br>  That is, the priority is when merging (merging) parameters: <br><br><ul><li>  <b>props</b> (default values ‚Äã‚Äãin modal.js) </li><li>  <b>props</b> (in the component template wrapped by vu-modal) </li><li>  <b>options</b> (when calling the window) </li></ul><br>  The lower, the more important. <br><br>  So, the calculated <b>propsData</b> property in the <b>vu-modal</b> component returns us the correct <b>input</b> parameters ( <b>props</b> ), taking into account whether this instance of <b>vu-modal is a</b> wrapper in some component ( <b>SimpleModal</b> ) or not. <br>  To do this, when rendering a window in <b>ModalWrapper</b> , if the component of this window is wrapped in <b>vu-modal,</b> we will transmit the prompt <b>props</b> under the name <b>vModal</b> , otherwise we will transmit the usual <b>props</b> . <br><br>  But as in the case when the component is wrapped in <b>vu-modal</b> , when rendering the <b>props</b> will get into this parent component ( <b>SimpleModal</b> ), we check if the parent component has an input parameter named <b>vModal</b> .  If there is, then we take these values, otherwise the standard <b>props-</b> s. <br><br>  And we check not with <b>this. $ Parent. $ Options.propsData</b> , but with <b>this. $ Parent. $ Vnode.data.props</b> , because if the parent component does not have a <b>vModal</b> parameter in the <b>props</b> , then during rendering this <b>vModal</b> we can only see with <b>this. $ parent. $ vnode.data.props</b> .  This includes all the parameters we passed without exception.  And then it is filtered and superfluous discarded. <br><br>  I will cite once again this piece of code, it is small, so as not to knock it off with a thought. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { ... computed: { propsData() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$parent.$vnode.data.props &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$parent.$vnode.data.props.vModal) ? <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$parent.$vnode.data.props.vModal : <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$props } } }</code> </pre><br>  Now perhaps not quite everything is clear.  There is a lot of information, and not everything is standard, as in many lessons.  I am writing this kind of article for the first time; it‚Äôs not quite clear how to teach better.  In the <b>guts of Vue</b> many probably dig, but very few people write about it.  Himself for a long time looking for info on such moments.  I found something, the rest was picking myself.  And I want to talk about such things. <br><br>  But it will become more clear when we disassemble <b>ModalWrapper</b> .  There we will form and send all the <b>props to</b> our windows. <br><br>  Well, the <b>render</b> function of our <b>Modal</b> ( <b>vu-modal</b> ) component remains: <br><br><div class="spoiler">  <b class="spoiler_title">render (h) "</b> <div class="spoiler_text"><pre> <code class="javascript hljs">render(h) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { dismissable, title, isScroll, fullscreen, isTop, isBottom, isLeft, isRight, center, size, className, bodyPadding } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.propsData <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> closeBtn = dismissable ? h(<span class="hljs-string"><span class="hljs-string">'div'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">class</span></span>: <span class="hljs-string"><span class="hljs-string">'vu-modal__close-btn'</span></span>, <span class="hljs-attr"><span class="hljs-attr">on</span></span>: { <span class="hljs-attr"><span class="hljs-attr">click</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$modals.dismiss()} } }, [h(CloseIcon)]) : <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> headerContent = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$slots.header ? <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$slots.header : title ? h(<span class="hljs-string"><span class="hljs-string">'span'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">class</span></span>: [<span class="hljs-string"><span class="hljs-string">'vu-modal__cmp-header-title'</span></span>]}, title) : <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> header = headerContent ? h(<span class="hljs-string"><span class="hljs-string">'div'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">class</span></span>: [<span class="hljs-string"><span class="hljs-string">'vu-modal__cmp-header'</span></span>] }, [ headerContent ]) : <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> body = h(<span class="hljs-string"><span class="hljs-string">'div'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">class</span></span>: [<span class="hljs-string"><span class="hljs-string">'vu-modal__cmp-body'</span></span>], <span class="hljs-attr"><span class="hljs-attr">style</span></span>: { <span class="hljs-attr"><span class="hljs-attr">overflowY</span></span>: isScroll ? <span class="hljs-string"><span class="hljs-string">'auto'</span></span> : <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">padding</span></span>: bodyPadding ? <span class="hljs-string"><span class="hljs-string">'1em'</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> } }, [ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$slots.default ]) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> footer = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$slots.footer ? h(<span class="hljs-string"><span class="hljs-string">'div'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">class</span></span>: [<span class="hljs-string"><span class="hljs-string">'vu-modal__cmp-footer'</span></span>] }, [ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$slots.footer ]) : <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> style = {} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> translateX = <span class="hljs-string"><span class="hljs-string">'-50%'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> translateY = <span class="hljs-string"><span class="hljs-string">'0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(center) { translateX = <span class="hljs-string"><span class="hljs-string">'-50%'</span></span> translateY = <span class="hljs-string"><span class="hljs-string">'-50%'</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(isRight || isLeft) { translateX = <span class="hljs-string"><span class="hljs-string">'0%'</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">isTop || isBottom</span></span></span><span class="hljs-function">) &amp;&amp; !</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">isScroll</span></span></span><span class="hljs-function"> &amp;&amp; !</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">center</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">translateY</span></span></span><span class="hljs-function"> = '0%' } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">style</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">transform</span></span></span><span class="hljs-function"> = `</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">translate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">${translateX}, ${translateY}</span></span></span><span class="hljs-function">)` </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">h</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'div'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, { style, class: [</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vu-modal__cmp'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, { </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vu-modal__cmp--is-fullscreen'</span></span></span></span><span class="hljs-function"><span class="hljs-params">: fullscreen, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vu-modal__cmp--is-center'</span></span></span></span><span class="hljs-function"><span class="hljs-params">: center, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vu-modal__cmp--is-top'</span></span></span></span><span class="hljs-function"><span class="hljs-params">: isTop &amp;&amp; !isScroll &amp;&amp; !center, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vu-modal__cmp--is-bottom'</span></span></span></span><span class="hljs-function"><span class="hljs-params">: isBottom &amp;&amp; !isScroll &amp;&amp; !center, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vu-modal__cmp--is-left'</span></span></span></span><span class="hljs-function"><span class="hljs-params">: isLeft, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vu-modal__cmp--is-right'</span></span></span></span><span class="hljs-function"><span class="hljs-params">: isRight }, isScroll &amp;&amp; fullscreen &amp;&amp; </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vu-modal__cmp--is-scroll-fullscreen'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, isScroll &amp;&amp; !fullscreen &amp;&amp; </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vu-modal__cmp--is-scroll'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, !fullscreen &amp;&amp; </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">`vu-modal__cmp--</span></span></span><span class="hljs-subst"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string"><span class="hljs-subst">${size}</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">`</span></span></span></span><span class="hljs-function"><span class="hljs-params">, className ], on: {click: (event</span></span></span><span class="hljs-function">) =&gt;</span></span> {event.stopPropagation()}} }, [ closeBtn, header, body, footer ]) }</code> </pre><br></div></div><br>  There seems to be nothing unusual. <br><br>  First, we pull out all our parameters from the previously described computed <b>propsData</b> value. <br><br>  Display the cross-button, which causes the <b>dismiss</b> event (cancellation of the window) if the <b>dismissable</b> property is <b>true</b> . <br><br>  We form the <b>header</b> - if a slot with the name <b>header</b> ( <b>this. $ Slots.header</b> ) is transferred to our <b>vu-modal</b> , if we have the <b>title</b> property passed, we display it, otherwise we don‚Äôt show the <b>header</b> at all. <br><br>  We form the <b>body</b> block with the contents of the default slot ( <b>this. $ Slots.default</b> ). <br>  And after the <b>footer</b> - if the slot is passed to the <b>footer</b> ( <b>this. $ Slots.footer</b> ). <br>  Next, we define the correct values ‚Äã‚Äãfor the <b>css</b> property of the <b>transform: translate (x, y) of</b> our window.  Namely, the parameters <b>X</b> and <b>Y</b> , depending on the transferred properties to our window.  And then we render this <b>transform</b> when rendering to the main window <b>div</b> for correct positioning. <br><br>  Well and we render all this business, in passing calculating the necessary class. <br><br>  And plus we hang on the main <b>div.vu-modal__cmp</b> <b>onClick</b> handler, with <b>event.stopPropagation ()</b> , so that the click on the window does not pop up higher, so as not to activate the click on the <b>div</b> (mask), which wraps every window and that responds to the click and causes <b>dismiss</b> .  Otherwise, this <b>dismiss</b> event will work on the mask and our window will close. <br>  Ufff! <br><br><h4>  The final component is ModalWrapper </h4><br><div class="spoiler">  <b class="spoiler_title">Start modal-wrapper.js</b> <div class="spoiler_text"><br>  import './style.scss' <br>  import Bus from './utils/bus' <br>  import ModalCmp from './modal' <br><br>  export default { <br>  name: 'vu-modal-wrapper', <br>  data () { <br>  return { <br>  modals: [] <br>  } <br>  }, <br>  mounted () { <br>  if (typeof document! == 'undefined') { <br>  document.body.addEventListener ('keyup', this.handleEscapeKey) <br>  } <br>  }, <br>  destroyed () { <br>  if (typeof document! == 'undefined') { <br>  document.body.removeEventListener ('keyup', this.handleEscapeKey) <br>  } <br>  }, <br></div></div><br>  We connect our styles: <br><div class="spoiler">  <b class="spoiler_title">style.scss</b> <div class="spoiler_text"><pre> <code class="hljs mel">body.modals-open { overflow: hidden; } .vu-modal { &amp;__wrapper { position: fixed; top: <span class="hljs-number"><span class="hljs-number">0</span></span>; left: <span class="hljs-number"><span class="hljs-number">0</span></span>; right: <span class="hljs-number"><span class="hljs-number">0</span></span>; bottom: <span class="hljs-number"><span class="hljs-number">0</span></span>; z-index: <span class="hljs-number"><span class="hljs-number">5000</span></span>; overflow-x: hidden; overflow-y: auto; transition: opacity <span class="hljs-number"><span class="hljs-number">.4</span></span>s ease; } &amp;__mask { background-<span class="hljs-keyword"><span class="hljs-keyword">color</span></span>: rgba(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">.5</span></span>); position: absolute; width: <span class="hljs-number"><span class="hljs-number">100</span></span>%; height: <span class="hljs-number"><span class="hljs-number">100</span></span>%; overflow-y: scroll; &amp;--disabled { background-<span class="hljs-keyword"><span class="hljs-keyword">color</span></span>: rgba(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } } &amp;__cmp { display: flex; flex-direction: column; border-radius: <span class="hljs-number"><span class="hljs-number">0</span></span>px; background: #FFF; box-shadow: <span class="hljs-number"><span class="hljs-number">3</span></span>px <span class="hljs-number"><span class="hljs-number">5</span></span>px <span class="hljs-number"><span class="hljs-number">20</span></span>px #<span class="hljs-number"><span class="hljs-number">333</span></span>; margin: <span class="hljs-number"><span class="hljs-number">30</span></span>px auto; position: absolute; left: <span class="hljs-number"><span class="hljs-number">50</span></span>%; transform: translateX(<span class="hljs-number"><span class="hljs-number">-50</span></span>%); width: <span class="hljs-number"><span class="hljs-number">650</span></span>px; &amp;--is-center { margin: auto; top: <span class="hljs-number"><span class="hljs-number">50</span></span>%; } &amp;--is-scroll { <span class="hljs-keyword"><span class="hljs-keyword">max</span></span>-height: <span class="hljs-number"><span class="hljs-number">90</span></span>%; } &amp;--is-scroll-fullscreen { <span class="hljs-keyword"><span class="hljs-keyword">max</span></span>-height: <span class="hljs-number"><span class="hljs-number">100</span></span>%; } &amp;--is-fullscreen { width: <span class="hljs-number"><span class="hljs-number">100</span></span>%; <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>-height: <span class="hljs-number"><span class="hljs-number">100</span></span>%; margin: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } &amp;--is-bottom { bottom: <span class="hljs-number"><span class="hljs-number">0</span></span>; } &amp;--is-top { top: <span class="hljs-number"><span class="hljs-number">0</span></span>; } &amp;--is-right { right: <span class="hljs-number"><span class="hljs-number">0</span></span>; margin-right: <span class="hljs-number"><span class="hljs-number">30</span></span>px; } &amp;--is-left { left: <span class="hljs-number"><span class="hljs-number">0</span></span>; margin-left: <span class="hljs-number"><span class="hljs-number">30</span></span>px; } &amp;--xl { width: <span class="hljs-number"><span class="hljs-number">1024</span></span>px; } &amp;--lg { width: <span class="hljs-number"><span class="hljs-number">850</span></span>px; } &amp;--md { width: <span class="hljs-number"><span class="hljs-number">650</span></span>px; } &amp;--sm { width: <span class="hljs-number"><span class="hljs-number">550</span></span>px; } &amp;--xs { width: <span class="hljs-number"><span class="hljs-number">350</span></span>px; } &amp;--p50 { width: <span class="hljs-number"><span class="hljs-number">50</span></span>%; } &amp;--p70 { width: <span class="hljs-number"><span class="hljs-number">70</span></span>%; } &amp;--p90 { width: <span class="hljs-number"><span class="hljs-number">90</span></span>%; } &amp;-body { padding: <span class="hljs-number"><span class="hljs-number">1</span></span>em; &amp;::-webkit-scrollbar { width: <span class="hljs-number"><span class="hljs-number">6</span></span>px; } &amp;::-webkit-scrollbar-<span class="hljs-keyword"><span class="hljs-keyword">track</span></span> { -webkit-box-shadow: inset <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>px rgba(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0.3</span></span>); } &amp;::-webkit-scrollbar-thumb { background-<span class="hljs-keyword"><span class="hljs-keyword">color</span></span>: darkgrey; outline: <span class="hljs-number"><span class="hljs-number">1</span></span>px solid slategrey; } } &amp;-header { user-<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>: none; border-bottom: <span class="hljs-number"><span class="hljs-number">1</span></span>px solid #EEE; padding: <span class="hljs-number"><span class="hljs-number">1</span></span>em; <span class="hljs-keyword"><span class="hljs-keyword">text</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">align</span></span>: left; &amp;-title { font-<span class="hljs-keyword"><span class="hljs-keyword">size</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>px; font-weight: <span class="hljs-number"><span class="hljs-number">800</span></span>; } } &amp;-footer { border-top: solid <span class="hljs-number"><span class="hljs-number">1</span></span>px #EEE; user-<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>: none; padding: <span class="hljs-number"><span class="hljs-number">1</span></span>em; <span class="hljs-keyword"><span class="hljs-keyword">text</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">align</span></span>: right; } } &amp;__close-btn { user-<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>: none; position: absolute; right: <span class="hljs-number"><span class="hljs-number">12</span></span>px; top: <span class="hljs-number"><span class="hljs-number">5</span></span>px; line { <span class="hljs-keyword"><span class="hljs-keyword">stroke</span></span>: grey; <span class="hljs-keyword"><span class="hljs-keyword">stroke</span></span>-width: <span class="hljs-number"><span class="hljs-number">2</span></span>; } &amp;:hover { cursor: pointer; line { <span class="hljs-keyword"><span class="hljs-keyword">stroke</span></span>: black; } } } }</code> </pre><br></div></div><br>  In the <b>modals</b> array <b>,</b> we will store our windows that are currently active. <br><br>  Well, when mounting and removing our <b>ModalWrapper</b> component, we hang the <b>keyup</b> handler on the <b>window</b> (if the window is there), which runs the <b>handleEscapeKey</b> method: <br><br><div class="spoiler">  <b class="spoiler_title">handleEscapeKey</b> <div class="spoiler_text"><pre> <code class="javascript hljs">handleEscapeKey(e) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.keyCode === <span class="hljs-number"><span class="hljs-number">27</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.modals.length) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.modals.length) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current.options.escapable) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dismiss(); } }</code> </pre><br></div></div><br>  Which, in turn, if the <b>Esc key is</b> pressed and there is a window (a) and the <b>escapable</b> property of <b>true</b> (last launched) window, runs the <b>dismiss</b> method, which closes this current window itself. <br><br>  Well, perhaps the most interesting began.  I'll try to describe what is happening right in the code, maybe it will be better. <br><br>  When creating our <b>ModalWrapper, we enable</b> wiretapping of events from the <b>EventBus</b> .  The ones that run in the <b>$ modals</b> methods described earlier: <br><br><div class="spoiler">  <b class="spoiler_title">created ()</b> <div class="spoiler_text"><pre> <code class="javascript hljs">created() { Bus.$on(<span class="hljs-string"><span class="hljs-string">'new'</span></span>, options =&gt; { <span class="hljs-comment"><span class="hljs-comment">//  ,   const defaults = { //    ,      Modal title: '', dismissable: true, center: false, fullscreen: false, isTop: false, isBottom: false, isLeft: false, isRight: false, isScroll: false, className: '', size: 'md', escapable: false, bodyPadding: true }; //     ! //   props-   .    . // rendered     ,      options,   Modal (vu-modal)   let instance = {} // ,       modals let rendered if(options.component.template) { //    ""   template,   Modal    ,    .     .    .    . rendered = false } else { //    render  ,    componentOptions rendered = options.component.render.call(this, this.$createElement) } //             componentName  Modal.      'vu-modal',     Modal (vu-modal) if(rendered &amp;&amp; rendered.componentOptions &amp;&amp; rendered.componentOptions.Ctor.extendOptions.componentName === 'vu-modal') { //      props-,       template-  vu-modal const propsData = rendered.componentOptions.propsData instance = { isVmodal: true, //      ,      options: Object.assign(defaults, propsData, options) //       } } else { instance = { isVmodal: false, //       vu-modal options: Object.assign(defaults, options) //      } } rendered = null this.modals.push(instance); //   modals Bus.$emit('opened', { //       EventBus c    index: this.$last, //    ,  instance //   }); this.body &amp;&amp; this.body.classList.add('modals-open'); //    body    });</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Further events: </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">close and dismiss</font></font></b> <div class="spoiler_text"><pre> <code class="javascript hljs">Bus.$on(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, data =&gt; { <span class="hljs-comment"><span class="hljs-comment">// ,            close let index = null; if (data &amp;&amp; data.$index) index = data.$index; //      if (index === null) index = this.$last; //   ,    this.close(data, index); //   close     }); Bus.$on('dismiss', index =&gt; { //     dismiss,      if (index === null) index = this.$last; //  ,   this.dismiss(index); //   dismiss   });</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now the methods are: </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">splice</font></font></b> <div class="spoiler_text"><pre> <code class="javascript hljs">methods: { splice(index = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   ,    if (index === -1) return; if (!this.modals.length) return; if (index === null) //    ,    this.modals.pop(); else this.modals.splice(index, 1); if (!this.modals.length) { //    this.body &amp;&amp; this.body.classList.remove('modals-open'); //  body   'modals-open' Bus.$emit('destroyed'); //   ,  EventBus,  ,     } } }</span></span></code> </pre><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">close</font></font></b> <div class="spoiler_text"><pre> <code class="javascript hljs">doClose(index) { <span class="hljs-comment"><span class="hljs-comment">//      modals ,    splice,   if (!this.modals.length) return; if (!this.modals[index]) return; this.splice(index); }, // ,    ,  close.            close(data = null, index = null) { if (this.modals.length === 0) return; let localIndex = index; //   index  ,      ,           .      ,  -  if (index &amp;&amp; typeof index === 'function') { localIndex = index(data, this.modals); } if (typeof localIndex !== 'number') localIndex = this.$last; //     // , ,      callback- onClose,     ,    //     onClose - ,    false,     if (localIndex !== false &amp;&amp; this.modals[localIndex]) { if(this.modals[localIndex].options.onClose(data) === false) { return } } Bus.$emit('closed', { //   'closed'      index: localIndex, //   instance: this.modals[index], //   data //  ,   }); //  ,     ,     modals,     this.doClose(localIndex); },</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dismiss</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">, everything is similar to the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">close</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">:</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dismiss</font></font></b> <div class="spoiler_text"><pre> <code class="javascript hljs">dismiss(index = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> localIndex = index; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (index &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> index === <span class="hljs-string"><span class="hljs-string">'function'</span></span>) localIndex = index(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$last); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> localIndex !== <span class="hljs-string"><span class="hljs-string">'number'</span></span>) localIndex = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$last; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.modals[localIndex].options.onDismiss() === <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; Bus.$emit(<span class="hljs-string"><span class="hljs-string">'dismissed'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">index</span></span>: localIndex, <span class="hljs-attr"><span class="hljs-attr">instance</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.modals[localIndex] }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.doClose(localIndex); },</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Calculated properties: </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">computed</font></font></b> <div class="spoiler_text"><pre> <code class="javascript hljs">computed: { current() { <span class="hljs-comment"><span class="hljs-comment">//   return this.modals[this.$last]; }, $last() { //   ()  return this.modals.length - 1; }, body() { //  body,  ,  /  'modals-open' if (typeof document !== 'undefined') { return document.querySelector('body'); } } }</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Well, the last function, now my favorite: </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">render (h)</font></font></b> <div class="spoiler_text"><pre> <code class="javascript hljs">render(h) { <span class="hljs-comment"><span class="hljs-comment">//   ,    if(!this.modals.length) { return null }; //     let modals = this.modals.map((modal, index) =&gt; { //    let modalComponent //      if(modal.isVmodal) { //        Modal (vu-modal) //       props-,    vModal c    vu-modal   props-   ,    modalComponent = h(modal.options.component, { props: Object.assign({}, {vModal: modal.options}, modal.options.props) }) } else { //    Modal          ,     props-,  ,     modalComponent = h(ModalCmp, { props: modal.options }, [ h(modal.options.component, { props: modal.options.props }) ]) } //      ,     -    css //  dismissable   true,  ,   return h('div', { class: ['vu-modal__mask', {'vu-modal__mask--disabled': index != this.$last }], on: {click: () =&gt; {modal.options.dismissable &amp;&amp; this.dismiss()}}, key: index }, [ modalComponent //     ]) }) //        return h('div', { class: 'vu-modal__wrapper', }, [ modals ]) } // ! :)</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is a story. </font><font style="vertical-align: inherit;">Long story. </font><font style="vertical-align: inherit;">The next time I will try in short, if necessary. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Well, in the end, a sample code for opening a window so that the information is better understood.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$modals.open({ <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">'Modal with callbacks'</span></span>, <span class="hljs-attr"><span class="hljs-attr">component</span></span>: Example, <span class="hljs-attr"><span class="hljs-attr">props</span></span>: { <span class="hljs-attr"><span class="hljs-attr">lorem</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, onDismiss() { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Dismiss ok!'</span></span>) } onClose(data) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(data.ended) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Ok!'</span></span>) } })</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And we run </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">close</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , for example, by a button in our window, we transfer data there:</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$modals.close({ <span class="hljs-attr"><span class="hljs-attr">ended</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> })</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this case, our onclose </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">callback is</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> launched before closing </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By analogy, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onDismiss</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> works </font><font style="vertical-align: inherit;">. This callback starts when you click on the button-cross, window mask or directly in our window, for example, when clicking in the footer on the button 'Cancel':</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$modals.dismiss()</code> </pre><br>  And further.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Concerning </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">render-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> functions. They certainly do not look as presentable as the code in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">template</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . But they can do what is impossible in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">template</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , or perhaps, but with crutches and an order of magnitude more code than is obtained in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">render</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function. And if the paint components in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">render</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function which is very carefully modify them </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">props-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> properties from which render dependent, otherwise the risk to go into an endless cycle of updates ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the update</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) component. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Probably for now. And so a bunch of dashed off. But I wanted to describe the whole movement. The next couple of articles will be shorter. But, also with the nuances that I want to talk about.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And thanks to everyone who lived to this line! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS </font></font><a href="https://vunemesis.github.io/vue-universal-modal/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here are</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> examples of windows. </font><font style="vertical-align: inherit;">There is also a link to Github with sources. </font><font style="vertical-align: inherit;">I add documentation, in Russian too.</font></font></div><p>Source: <a href="https://habr.com/ru/post/350232/">https://habr.com/ru/post/350232/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350218/index.html">Russian storage systems from the company StoreQuant</a></li>
<li><a href="../350222/index.html">Getting command parameters from a human phrase</a></li>
<li><a href="../350224/index.html">Webpack 4 Legato released</a></li>
<li><a href="../350228/index.html">About threat modeling</a></li>
<li><a href="../350230/index.html">We summarize the animation tables in iOS applications</a></li>
<li><a href="../350234/index.html">SAML authorization bypass</a></li>
<li><a href="../350236/index.html">Installing the icecast2 server with SSL support for broadcasting over https protocol</a></li>
<li><a href="../350238/index.html">If you don't have a dog ...</a></li>
<li><a href="../350240/index.html">Nine questions about working with memory in V8</a></li>
<li><a href="../350246/index.html">Mikrotik vs Old PC, the problem of choice in a small business</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>