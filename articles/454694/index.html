<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÄúThick and thin‚Äù or how I mastered neural networks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 2 

 Part 1 is here . 
 Many thanks to the readers for the positive feedback. 

 Training 
 Well, everything is ready! Now you can start. Begin t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>‚ÄúThick and thin‚Äù or how I mastered neural networks</h1><div class="post__text post__text-html js-mediator-article">  Part 2 <br><br>  Part 1 is <a href="https://habr.com/ru/post/454350/">here</a> . <br>  Many thanks to the readers for the positive feedback. <br><br><h1>  Training </h1><br>  Well, everything is ready!  Now you can start.  Begin to train the neural network, and then reap the benefits of this training.  So I think at first, because of inexperience ... But back to the theory.  To the neuron device.  There are dendrites, there is a body of a neuron, there is an axon.  According to the dendrites, we transmit the input signals (height and weight), which have their weights W1 and W2, there is a neuron body (activation function) and there is an axon (output). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/iw/mx/mj/iwmxmjro9yutqrugfmx86ozzpx4.png" alt="image"><br><a name="habracut"></a><br>  What function to take as an activation?  - My choice fell on sigmoid (although, of course, other choices of activation function are possible). <br><br><img src="https://habrastorage.org/webt/d4/3v/uw/d43vuwkkt5pc15hectsx2p1muci.png" alt="image"><br><br>  The first problem I encountered was that a sigmoid gives too ‚Äúsmall‚Äù response, a signal level that does not exceed one, and the BMI values ‚Äã‚Äãare not that few, tens!  But this problem is solved quite easily by entering a scaling factor.  I took the ratio of 1/100. <br><br><img src="https://habrastorage.org/webt/tv/83/mq/tv83mqxpgoipxpneodci1pc9vds.png" alt="image"><br><br>  The next problem - a sigmoid gives values ‚Äã‚Äãfrom -0.5 to 0.5, and I have no negative values ‚Äã‚Äãin the BMI.  It is also solved quite simply - let's move the graph along the abscissa to the left by inputting a constant into the function (that is, so that X, equal to zero, gives Y, equal to "0", and not "0.5"). <br><br><img src="https://habrastorage.org/webt/ls/fe/dw/lsfedwqhidhvbuul5ohygb6tlra.png" alt="image"><br><br>  As a result, for the operation of our artificial neuron we have the following mathematical apparatus: <br><br>  X = X1 * W1 + X2 * W2 <br>  Y = sigm (X) - 0.5 <br><br>  Where, <br>  sigm is a sigmodal function: <br><br><img src="https://habrastorage.org/webt/xl/iq/zt/xliqztosdhqxuj7jiwblyxzrl1a.png" alt="image"><br><br>  Now go to the training.  - We take the function of back propagation of an error and ... - And where can I get it?  In addition to obscure "feint ears" in numerous articles under the heading: "Oh, yes, neural networks - it's easy!  Like two fingers on the asphalt! ‚ÄùThere was no useful information there.  It became clear that the book is needed.  Normal is such a ‚Äúhuman‚Äù book, where the author, without any extra ‚Äúbends of fingers‚Äù, goes from ‚Äúsimple to complex‚Äù in building a neural network and explains everything in detail.  And such a book was found.  This is Tariq Rashid‚Äôs book Create a Neural Network. <br><br><img src="https://habrastorage.org/webt/8w/xy/ib/8wxyibi6ptaxk8yoinyytkmskzu.png" alt="image"><br><br>  For two or three days I carefully studied it in search of an answer to the question: ‚ÄúWhat is the formula for adjusting the weights during the reverse propagation of an error ?!‚Äù, while checking the correctness of my constructions, comparing with the constructions of Tariq.  Tarik took the classic use of neural networks - ‚Äúcharacter recognition‚Äù and built his network to solve this problem (he has a two-layer network).  The program code in this book is written in Python, so I had to fluently study this language in order to understand the implementation (I decided to leave the good Python mastery ‚Äúfor later‚Äù, as it is not only the language, but also the development environment and the toolkit). <br><br>  Step by step, gradually I reached the chapter in which the error was evaluated and corrected.  The method of calculating the correction values ‚Äã‚Äãof the weights uses so-called.  the gradient descent method using the differential calculus machine (yes, the neural network is for you "didn't sneeze a sheep", these are clever people have invented). <br><br>  Important note: W1, W2 ... Wn weights are adjusted to the extent that they contribute to the error.  I.e: <br><br>  W new = Old - (dW * W old) <br><br>  dW is the calculated ‚Äúgeneral‚Äù weighting correction, which is then distributed over each weight. <br><br>  The book provided a formula for adjusting the weights for a two-layer network, I adapted it for a single-layer one.  I will not give this formula here, in the article, in essence, this is the very ‚Äúgolden coin‚Äù and the heart of the whole method, without which all talk of neural networks turns into idle talk and cheap populism of Internet articles telling to quickly ‚Äúmaster‚Äù neural networks and in half an hour to become an ‚Äúexpert‚Äù in them.  Agree, it is better, after all, "to be" than to "seem."  Therefore, if you are really interested in neural networks, I recommend that you study this book. <br><br><img src="https://habrastorage.org/webt/bj/xt/99/bjxt99owra-vgmzzsvzldzfupn4.png" alt="image"><br><br>  Wow!  - Now you can erase the sweat from your forehead and proceed to the actual training and testing of the network ... True, we still need a small toolkit to assess the quality of its work, but I will tell about this in 3 parts of the article. <br><br>  The end of the second part. </div><p>Source: <a href="https://habr.com/ru/post/454694/">https://habr.com/ru/post/454694/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454678/index.html">The idiomatic programming of a GPU on Rust: The Emu Library</a></li>
<li><a href="../45468/index.html">US Army buys new game</a></li>
<li><a href="../454682/index.html">iOS 13, watchOS 6, iPadOS and new Mac Pro. Apple presentation at WWDC 2019</a></li>
<li><a href="../454686/index.html">Israeli Aleph Farms, which develops technologies for the production of "test tube" meat, has raised $ 11.65 million</a></li>
<li><a href="../454690/index.html">Guidelines for completing the personal data operator's notice</a></li>
<li><a href="../454696/index.html">How to organize a hackathon as a student 101. Part one</a></li>
<li><a href="../454698/index.html">Acronis Design: Additional Designer Tools</a></li>
<li><a href="../4547/index.html">Fitzpatrick on Moscow Echo</a></li>
<li><a href="../454702/index.html">Zabbix: LLD-monitoring of SIM-cards Yeastar TG</a></li>
<li><a href="../454704/index.html">On the question of helicopter or how I spent the weekend</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>