<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Acronis True Image vs R.Saver, or "Two Fellows on a Dead Man's Hard Disk"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A tale about how not to save data from a half-dead hard drive 


 Recently brought the Samsung NP-N210 in poor condition. They were playing football o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Acronis True Image vs R.Saver, or "Two Fellows on a Dead Man's Hard Disk"</h1><div class="post__text post__text-html js-mediator-article"><h5>  A tale about how not to save data from a half-dead hard drive </h5><br><img src="https://habrastorage.org/files/5a3/5cb/97b/5a35cb97bd5e4a408c76cb319e73dceb.jpg" alt="Be gentle with hard drives!"><br><br>  Recently brought the Samsung NP-N210 in poor condition.  They were playing football or conducting military actions - the story is silent, but the German XP refused to be loaded on it flatly. <br><br>  The required result is ‚Äúat least family fotos to pick out of it.‚Äù <br><a name="habracut"></a><br><img src="https://habrastorage.org/files/4c7/64c/61a/4c764c61a8964e85b460fc0811ecb952.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Well, with the worked-out motion we spin the back of the laptop, remove the hard drive, connect it to the interface converter (pictured above), wait ... <br><br>  The disk was recognized, the sections are visible, the data is the same too, but ... The disk is covered with bad sectors, like a dog - with fleas.  Of course, a lot of system files got it, so the operating system can‚Äôt be saved anymore (citizens, have pity on the technique - if you hammer nails with it, then at least turn it off first!). <br><br>  Attempts to simply rewrite most of the "family fotochek" on the working disk systematically fail, and the only result of this approach is the dead hovering of the disk. <br><br>  After the disconnection, the partitions on the disk are no longer visible - apparently, the disk is on the last gasp.  We take out Acronis True Image Home (Trial) from wide <s>trousers of the</s> Internet, play it on a disk in the hope of reading sectors into an image and then working with the image. <br><br>  A hardworking True Image gets down to business ... A day passes ... The sector is still being read ... The second day ... Third ... And here it is - the error of the <s>resident of</s> your humble servant - the disk resource is not enough to tidy and hardworking, with many repeated attempts (hello to Acronis ) read <u>every bad sector</u> .  The disk tightly veils the system (and this is via USB!).  After the reboot, the patient finally stops giving any signs of life. <br><br>  Well, we have on hand a dead hard drive and a piece of TIB image - about 10 gigabytes.  Browsing in a hex editor inspires hope: <br><br><img src="https://habrastorage.org/files/77c/03d/ee9/77c03dee960b4b5f91438fac1d7282df.png" alt="image"><br><br>  Fortunately, the disk image was made complete, sector-wise and uncompressed, so the data can apparently be used (after all, optimists are happy people). <br><br>  We will not dwell on the numerous attempts to mount this <s>bit of</s> a file system fragment in order to read anything worthwhile from it.  True Image Home confidently said ‚Äúnot mine‚Äù, various third-party utilities did not see anything useful in the ten-gigabyte file either.  Search for a description of the TIB format on the Internet has not brought results. <br><br>  Isn't it time to remember the useful and sensible program - R.Saver from R.LAB?  We are inciting her on the archive, and - NOW-THAT ... Hope dies. <br><br><img src="https://habrastorage.org/files/4cd/f07/464/4cdf0746483846abb07906bdd705e6ee.png" alt="image"><br><br>  A few days have passed.  One morning, another enlightenment brought a fresh thought - to carry out the so-called "investigative experiment."  We uncover the main weapon - Windows XP Mode.  Who does not know - this is a virtual XP, closely integrated with the host Windows 7. <br><br>  We create a small 50 megabyte disk on this virtual machine (so that the experiment does not take an eternity), format it in NTFS, drop some files on it so that at least some sectors are not solid zeros.  Install on the same virtualku True Image Home and Disk Editor.  The first of them creates a tib file for us, the second - a complete sector-wide image without any headers and other excesses.  Then we install Beyond Compare, the first software creature that the authors claim is good at comparing binary files.  Well, check. <br><br><img src="https://habrastorage.org/files/b4a/195/bb3/b4a195bb366b4bfba23b6fc1b84f8641.png" alt="image"><br><br><img src="https://habrastorage.org/files/f9d/d2f/40c/f9dd2f40c5014db2813155b695ffc2b3.png" alt="image"><br><br>  The comparison immediately reveals the file header and some regular data blocks of 68 bytes, which are in the TIB and are missing in the sector image.  Here it is, the secret weapon of Acronis!  It is these blocks that break down the archive structure and prevent R.Saver from concentrating on finding leftover files.  I suppose that these blocks are something like a checksum or some markers, since  they are inserted after every 256 kilobytes (or 512 sectors).  It is unlikely that we will learn the truth from the creators of True Image, but if someone from respected readers can clarify what these data blocks are and why they are needed - you are welcome to comment. <br><br>  So, it makes sense to remove these blocks and the title, and offer what remains to the R.Saver program - in the hope of the best. <br><br>  It is well known that a normal person will just do, and the programmer will automate first.  In this case, automation makes sense, because  cut out from a ten-gigabyte archive blocks of 68 bytes, located every 256 kilobytes - an occupation for VERY patient - for a minute, about 40 thousand operations are obtained. <br><br>  Since the task itself, although very tedious, is very simple, the search for something already existing will take guaranteed more time than writing a modest bike. <br><br>  Stocking coffee ... In general, the coffee did not even have time to cool.  Actually, here is the entire listing: <br><br><div class="spoiler">  <b class="spoiler_title">My bike</b> <div class="spoiler_text"><pre><code class="hljs mel">#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #define BUFSIZE <span class="hljs-number"><span class="hljs-number">262144</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> main(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> argc, char* argv[]) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(argc &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { printf(<span class="hljs-string"><span class="hljs-string">"tibclean &lt;src&gt; &lt;trg&gt; &lt;protection record size&gt; &lt;header size&gt;"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } printf(<span class="hljs-string"><span class="hljs-string">"arg1==%s\targ2==%s\targ3==%s"</span></span>, argv[<span class="hljs-number"><span class="hljs-number">1</span></span>], argv[<span class="hljs-number"><span class="hljs-number">2</span></span>], argv[<span class="hljs-number"><span class="hljs-number">3</span></span>]); off64_t protectionRecSize = atoi(argv[<span class="hljs-number"><span class="hljs-number">3</span></span>]); off64_t headerSize = atoi(argv[<span class="hljs-number"><span class="hljs-number">4</span></span>]); FILE* sf = fopen64(argv[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-string"><span class="hljs-string">"rb"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(NULL==sf) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } FILE* df = fopen64(argv[<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">"wb"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(NULL==df) { <span class="hljs-keyword"><span class="hljs-keyword">fclose</span></span>(sf); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; } off64_t offs = headerSize; fseeko64(sf, offs, SEEK_SET); char fbuf[BUFSIZE]; unsigned <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> readbytes; unsigned <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> writtenbytes; off64_t divbuff; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> lastmbytes = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> mbytes = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!<span class="hljs-keyword"><span class="hljs-keyword">feof</span></span>(sf)) { fseeko64(sf, protectionRecSize, SEEK_CUR); readbytes = <span class="hljs-keyword"><span class="hljs-keyword">fread</span></span>(fbuf, <span class="hljs-number"><span class="hljs-number">1</span></span>, BUFSIZE, sf); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>==readbytes) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } writtenbytes = <span class="hljs-keyword"><span class="hljs-keyword">fwrite</span></span>(fbuf, <span class="hljs-number"><span class="hljs-number">1</span></span>, readbytes, df); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(writtenbytes!=BUFSIZE) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//reporting divbuff = ftello64(sf); divbuff = divbuff / 1048576; mbytes = (int)divbuff; if(mbytes!=lastmbytes) { printf("%d mbytes ready\n", mbytes); lastmbytes = mbytes; } } fclose(sf); fclose(df); return 0; }</span></span></code> </pre> <br></div></div><br><br>  The length of the header and the length of the block to be cut is set from the command line, since  in the test tib file and in the one that was inherited from the untimely dead hard drive, the size of the inserted block was different - 68 bytes in the test image, and, surprisingly, only 12 bytes - in the "inheritance". <br><br>  Well, we start our microutility: <br><br><pre> <code class="dos hljs">TIBClean.exe drive_c_full_b1_s1_v1.tib cleaned.img <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">28</span></span></code> </pre> <br><br>  Attempt number two - R.Saver eagerly snaps at a slightly thinner file, and - oh, a miracle - finds in it the file system, although it is damaged. <br><br><img src="https://habrastorage.org/files/fe3/b72/b48/fe3b72b48b524ef0807b67527de95c0c.png" alt="image"><br><br><img src="https://habrastorage.org/files/fbd/d26/74a/fbdd2674a0a14361bcc7398c2bc518f0.png" alt="image"><br><br>  Then everything is simple - select all the files of interest, and try to save them.  Unfortunately, 10 gigabytes is not all spaces of the former data section, so not a very large part of the family photo archive is restored, alas. <br><br><h5>  findings </h5><br>  Do not use Acronis True Image with disks on which there are A LOT of bad sectors - this wonderful utility is intended for other tasks!  Broken sectors immerse it in thought, which does not contribute to improving the health of a dying hard drive. <br><br>  For such cases, use R.Saver - the best of free programs designed specifically for emergency rescue of your data <s>acquired by overwork</s> if the remaining life of a disk is in hours. <br><br>  To prevent such cases, do not play laptops in football and tennis, and do not use them as a personal weapon. <br><br>  Make backup copies of your data. <br><br><h5>  Disclaimer </h5><br>  I am not an employee of R.LAB and have nothing to do with it.  Also, I am not a spiteful scandal or a competitor of Acronis, and I don‚Äôt blame anyone except myself for its product in this particular case. <br><br><h5>  Happy end </h5><br>  After a couple of weeks of rest, the "corpse" partially came to life in the drawer of the table - with terrible brakes, but it was detected in the system, although the sections on it were still not visible.  Taught by previous bitter experience, the author of this opus immediately used R. Saver <s>and the saving power of prayer</s> .  It was possible to save more than 80 percent of the ‚Äúfamily photo archive‚Äù of my friends who are interested in nailing with a laptop. </div><p>Source: <a href="https://habr.com/ru/post/362655/">https://habr.com/ru/post/362655/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../362645/index.html">Psychological transformation to which only astronauts are subject</a></li>
<li><a href="../362647/index.html">Serious problems with reading Samsung 840 Evo data and how to fix it</a></li>
<li><a href="../362649/index.html">In the regiment arrived. War Thunder is now available on Linux</a></li>
<li><a href="../362651/index.html">3D scanner Occipital Structure Sensor: digitize yourself (friend, wife, dog)</a></li>
<li><a href="../362653/index.html">Saga of LED lamps. Part 1 - History and Terminology</a></li>
<li><a href="../362657/index.html">Why is Zuckerberg wearing the same T-shirt?</a></li>
<li><a href="../362659/index.html">Walt Disney unveiled the title of the new Star Wars episode.</a></li>
<li><a href="../362661/index.html">Google actively promotes Google Drive for Geneticists</a></li>
<li><a href="../362663/index.html">New product from Amazon - Echo</a></li>
<li><a href="../362667/index.html">Little about nuclear power plants</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>