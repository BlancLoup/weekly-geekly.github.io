<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Webpack 4 and the separation of the configuration file into modules</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! Today I will tell you about Webpack 4 with the division of code into separate modules, as well as interesting solutions that will help you t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Webpack 4 and the separation of the configuration file into modules</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  Today I will tell you about Webpack 4 with the division of code into separate modules, as well as interesting solutions that will help you to quickly assemble the assembly on the webpack 4. In the end, I will provide my basic assembly on the webpack with the most necessary tools that you can later to expand.  This assembly will help you understand this material, and also possibly help you write your implementation faster and solve possible problems faster. <a name="habracut"></a><br><br>  The main ideology of this assembly is the correct separation of code inside the configuration file for ease of use, reading and cleanliness of webpack.config.js.  The required modules and plug-ins for the dev and prod versions (as well as for sharing functionality in the main file) will be located in a separate webpack folder and imported from it to connect to the main config. <br><br><h2>  Why do you need such an approach? </h2><br>  With the gradual increase in the number of modules, plug-ins, etc., that your build on the web pack grows with, the configuration file grows like a yeast.  Over time, this file becomes difficult to read, and to change it for a specific project, if some modules in it are not used, it becomes more difficult, but you want something universal.  Therefore, a clear code organization is required. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  What do we need? </h3><br>  We will use the <i>webpack-merge</i> plugin. <br><br>  Create a webpack folder and put all the individual modules into separate files.  For example, webpack / pug.js, webpack / scss.js and export these functions from them. <br><br>  <b>Pug.js file</b> <br><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">module</span></span>: { <span class="hljs-attr"><span class="hljs-attr">rules</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.pug$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'pug-loader'</span></span>, <span class="hljs-attr"><span class="hljs-attr">options</span></span>: { <span class="hljs-attr"><span class="hljs-attr">pretty</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }, }, ], }, }; };</code> </pre> <br>  <b>The webpack.config.js file</b> .  In this file we connect them, and with the help of this plugin we connect them quickly and easily. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> merge = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack-merge'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> pug = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./webpack/pug'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> common = merge([ { <span class="hljs-attr"><span class="hljs-attr">entry</span></span>: { <span class="hljs-string"><span class="hljs-string">'index'</span></span>: PATHS.source + <span class="hljs-string"><span class="hljs-string">'/pages/index/index.js'</span></span>, <span class="hljs-string"><span class="hljs-string">'blog'</span></span>: PATHS.source + <span class="hljs-string"><span class="hljs-string">'/pages/blog/blog.js'</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">output</span></span>: { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: PATHS.build, <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">'./js/[name].js'</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [‚Ä¶], <span class="hljs-attr"><span class="hljs-attr">optimization</span></span>: { ‚Ä¶ }, }, pug(), ]);</code> </pre><br>  Now, if we have a new task, for which we need a new module, a plugin, a loader, then we take it to the hotel module (file) and put it in the webpack folder, and then connect it to the main configuration file, keeping the config as clean as possible. <br><br><h3>  Settings for production and development </h3><br>  Now, with the help of the banal if, we will finish our separation, which we aspire to, and configure our webpack for these two types of development, thanks to which it will finally become convenient to use this tool, and also in the future we will be able to flexibly and simply customize it for any other project or expand in the current.  For export to the node (for the webpack itself) in webpack 4 we use the following construction: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">env, argv</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (argv.mode === <span class="hljs-string"><span class="hljs-string">'production'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> merge([ common, extractCSS(), favicon(), ]); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (argv.mode === <span class="hljs-string"><span class="hljs-string">'development'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> merge([ common, devserver(), sass(), css(), sourceMap(), ]); }</code> </pre><br>  In the common object, we connect what is used both in the prode and in development, and in the conditions we connect only those modules that are necessary in these cases. <br><br><h3>  Now I would like to talk about the main features of webpack 4 regarding webpack 3 </h3><br><ul><li>  For a quick start, webpack 4 does not need webpack.config.js, it now only needs an entry point (index.js) </li><li>  In the new version of the webpack command line interface is placed in a separate package and you need to install webpack-cli. </li><li>  To start webpack 4, it is necessary (otherwise it will be warning) in the scripts to specify mode (mode of operation) --mode production or --mode development, depending on the key, the operation of the webpack changes.  Development mode aims to speed up the build.  In the production version, everything is directed to the final code minification. </li><li>  In order to create common.js and common.css files, the CommonsChunkPlugin is no longer used, splitChunks are now responsible for this and use the following construction: <br><br><pre> <code class="javascript hljs"> optimization: { <span class="hljs-attr"><span class="hljs-attr">splitChunks</span></span>: { <span class="hljs-attr"><span class="hljs-attr">cacheGroups</span></span>: { <span class="hljs-string"><span class="hljs-string">'common'</span></span>: { <span class="hljs-attr"><span class="hljs-attr">minChunks</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">chunks</span></span>: <span class="hljs-string"><span class="hljs-string">'all'</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'common'</span></span>, <span class="hljs-attr"><span class="hljs-attr">priority</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">enforce</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }, }, }, },</code> </pre><br>  In webpack 3 - this would be the case in plugins: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.optimize.CommonsChunkPlugin({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'common '</span></span>, })</code> </pre> <br>  Accordingly, in the chunks in HtmlWebpackPlugin we connect (here without changes). <br><br><pre> <code class="javascript hljs">plugins: [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HtmlWebpackPlugin({ <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">'index.html'</span></span>, <span class="hljs-attr"><span class="hljs-attr">chunks</span></span>: [<span class="hljs-string"><span class="hljs-string">'index'</span></span>, <span class="hljs-string"><span class="hljs-string">'common'</span></span>], <span class="hljs-attr"><span class="hljs-attr">template</span></span>: PATHS.source + <span class="hljs-string"><span class="hljs-string">'/pages/index/index.pug'</span></span>, }), ],</code> </pre><br></li><li>  The next important point, in order to create a sourceMap, now we use the following approach - we create the sourceMap.js file in the webpack folder and connect it in version devs for example (as mentioned above): <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">devtool</span></span>: <span class="hljs-string"><span class="hljs-string">'eval-sourcemap'</span></span>, }; };</code> </pre></li></ul><br>  Now the approach with <i>plugins: [new webpack.optimize.UglifyJsPlugin ({})]</i> does not work. <br><br>  At this point, I would like to complete my story and provide my basic build - a <a href="https://github.com/anisov/webpack4/">link</a> to webpack 4, which may help you in your work and development.  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/422697/">https://habr.com/ru/post/422697/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../422685/index.html">Smart Watch Samsung Galaxy Watch: upgrade from Android Wear OS to Tizen OS - personal experience</a></li>
<li><a href="../422687/index.html">Messengers are in danger</a></li>
<li><a href="../422689/index.html">Determining the color of cars using neural networks and TensorFlow</a></li>
<li><a href="../422691/index.html">Hybrid camera and lidar improves robotic capabilities, complementing information about the outside world</a></li>
<li><a href="../422693/index.html">Plugin Team for Customizing JavaFX Components in a Desktop Application</a></li>
<li><a href="../422699/index.html">Closed loophole confirms the unreality of the quantum world</a></li>
<li><a href="../422701/index.html">Deep Learning and OpenVINO Toolkit. Ask an Intel Expert Question</a></li>
<li><a href="../422705/index.html">The book about the "Paragraph" on Habr√©. New chapter - about programmers-cooperators: "Beta"</a></li>
<li><a href="../422709/index.html">Scientists have found a part of the human brain responsible for the pitch of our speech</a></li>
<li><a href="../422711/index.html">Reading for the weekend: materials on working with the cloud and organization of IT infrastructure</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>