<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Large Hadron Collider and Classmates</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing the theme of contests on machine learning in Habr√©, we want to acquaint readers with two more platforms. They are certainly not as huge as ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Large Hadron Collider and Classmates</h1><div class="post__text post__text-html js-mediator-article"><p>  Continuing the theme of contests on machine learning in Habr√©, we want to acquaint readers with two more platforms.  They are certainly not as huge as kaggle, but they definitely deserve attention. </p><br><p><img src="https://habrastorage.org/webt/qk/ct/hb/qkcthbh7yt4xxwv33owwpxnoz5u.png"></p><br><p>  Personally, I don't like kaggle too much for several reasons: </p><br><ul><li>  firstly, competitions there often last several months, and for active participation one has to spend a lot of forces; </li><li>  secondly, public kernels (public solutions).  Adherents of kaggle advise to treat them with the tranquility of Tibetan monks, but in reality it is quite a shame when what you were walking for a month or two suddenly turns out to be laid out on a platter for everyone. </li></ul><br><p>  Fortunately, machine learning competitions are held on other platforms, and a couple of such competitions will be discussed. </p><a name="habracut"></a><br><table><thead><tr><th>  <a href="https://idao.world/">IDAO</a> </th><th>  <a href="https://snahackathon.org/">SNA Hackathon 2019</a> </th></tr></thead><tbody><tr><td>  Official language: English, <br>  Organizers: Yandex, Sberbank, HSE </td><td>  Official Russian language, <br>  Organizers: Mail.ru Group </td></tr><tr><td>  Online Round: Jan 15 - Feb 11, 2019; <br>  On-Site Final: Apr 4-6, 2019 </td><td>  online - from February 7 to March 15; <br>  offline from March 30 to April 1. </td></tr><tr><td>  For some set of data about a particle in a large hadron collider (about a trajectory, impulse, and other rather complex physical parameters) determine whether it is muon or not <br>  From this setting 2 tasks were highlighted: <br>  - in one you just had to send your prediction, <br>  - and in the other - the full code and model for the prediction, and the implementation of the imposed rather stringent restrictions on the time and memory usage </td><td>  For the SNA Hackathon competition, logs of content hits from open groups were collected in users' news feeds for February-March 2018.  The test set is hidden the last week and a half of March.  Each entry in the log contains information about what and to whom it was shown, as well as how the user reacted to this content: set ‚Äúclass‚Äù, commented, ignored or hidden from the tape. <br>  The essence of the tasks of SNA Hackathon is that for each user of the social network Odnoklassniki otranzhirovat his tape, as high as possible raising those posts that get the "class". <br>  At the online stage the task was divided into 3 parts: <br>  1. rank posts for various collaborative features <br>  2. rank posts by the images they contain <br>  3. rank posts by the text they contain </td></tr><tr><td>  Complex custom metric, something like ROC-AUC </td><td>  Average ROC-AUC by users </td></tr><tr><td>  Prizes for the first stage - T-shirts for N places, passage to the second stage, where accommodation and food were paid during the competition <br>  Second phase - ???  (For certain reasons, I was not present at the awards ceremony, and I could not find out what they ended up being for prizes).  They promised laptops to all members of the winning team. </td><td>  The prizes for the first stage are T-shirts for the 100 best participants, the passage to the second stage, where they paid for travel to Moscow, room and board during the competition.  Also closer to the end of the first stage, the prizes were announced the best in 3 tasks at stage 1: everyone won on the RTX 2080 TI video card! <br>  The second stage is a team one, in teams there were from 2 to 5 people, the prizes: <br>  1st place - 300 000 rubles <br>  2nd place - 200 000 rubles <br>  3rd place - 100 000 rubles <br>  Jury Prize - 100 000 rubles </td></tr><tr><td>  The official group in the telegram, ~ 190 participants, communication in English, the questions had to wait for an answer for several days </td><td>  Official group in the telegram, ~ 1500 participants, active discussion of tasks between participants and organizers </td></tr><tr><td>  The organizers provided two basic solutions, simple and advanced.  The idleness required less than 16 GB of RAM, and the advanced 16 did not fit.  At the same time, running a little ahead, the participants failed to significantly surpass the advanced solution.  Difficulties to launch these solutions were not.  It should be noted that in the advanced example there was a comment with a hint as to where to start improving the solution. </td><td>  Basic primitive solutions were provided for each of the tasks, easily surpassed by the participants.  In the first days of the contest, participants faced several difficulties: first, the data were given in the Apache Parquet format, and not all combinations of Python and the parquet package worked without errors.  The second difficulty was to download images from the mail cloud, at the moment there is no easy way to download a large amount of data at a time.  As a result, these problems delayed the participants for a couple of days. </td></tr></tbody></table><br><h1 id="idao-pervyy-etap">  IDAO.  First stage </h1><br><p>  The task was to classify the muon / non-muon particles according to their characteristics.  The key feature of this task was the presence in the training data of the weight column, which the organizers themselves interpreted as confidence in the answer for this line.  The problem was that quite a few lines contained negative weights. </p><br><p><img src="https://habrastorage.org/webt/nw/mf/lq/nwmflqq8ykdtftewaqplnijdldc.jpeg"></p><br><p>  Thinking a few minutes above the line with a hint (the hint just paid attention to this feature of the weight column) and plotting this graph, we decided to check 3 options: </p><br><p>  1) invert the target at the lines with negative weight (and weight, respectively) <br>  2) shift the weights to the minimum value, so that they start from 0 <br>  3) do not use weights for strings </p><br><p>  The third option was the worst, but the first two improved the result, the best option was number 1, which immediately brought us to the current second place in the first task and the first in the second. <br><img src="https://habrastorage.org/webt/m0/a1/in/m0a1inbbcohgff013poeufvoxto.jpeg"><br>  Our next step was to view the data for missing values.  The organizers gave us already combed data, where the missing values ‚Äã‚Äãwere quite small, and they were replaced by -9999. </p><br><p>  We found missing values ‚Äã‚Äãin the MatchedHit_ {X, Y, Z} [N] and MatchedHit_D {X, Y, Z} [N] columns, and only when N = 2 or 3. As we understood, some particles did not fly through all 4 detectors and stopped at either 3 or 4 plates.  The data also included Lextra_ {X, Y} [N] columns, which apparently describe the same as MatchedHit_ {X, Y, Z} [N], but using some kind of extrapolation.  These meager guesses suggested that instead of missing values ‚Äã‚Äãin MatchedHit_ {X, Y, Z} [N] you can substitute Lextra_ {X, Y} [N] (only for X and Y coordinates).  MatchedHit_Z [N] was well filled with a median.  These manipulations allowed us to reach 1 intermediate place for both tasks. </p><br><p><img src="https://habrastorage.org/webt/vc/dh/w-/vcdhw-yuolztwk7rlx_meegw0pc.jpeg"></p><br><p>  Considering that for the victory in the first stage nothing was given, it would be possible to dwell on this, but we continued, drew several beautiful pictures and came up with new features. </p><br><p><img src="https://habrastorage.org/webt/kn/wq/0_/knwq0_htdasf27lgckfo9pwocmk.jpeg"></p><br><p>  For example, we found that if we construct the intersection points of a particle from each of the four detector plates, then we can see that the points on each of the plates are grouped into 5 rectangles with a 4: 5 aspect ratio and center at the point (0,0), and the first rectangle has no points. </p><br><table><thead><tr><th>  Plate number / size of rectangles </th><th>  one </th><th>  2 </th><th>  3 </th><th>  four </th><th>  five </th></tr></thead><tbody><tr><td>  Plate 1 </td><td>  500x625 </td><td>  1000x1250 </td><td>  20002500 </td><td>  4000x5000 </td><td>  8000x10000 </td></tr><tr><td>  Plate 2 </td><td>  520x650 </td><td>  1040x1300 </td><td>  2080x2600 </td><td>  4160x5200 </td><td>  8320x10400 </td></tr><tr><td>  Plate 3 </td><td>  560x700 </td><td>  1120x1400 </td><td>  2240x2800 </td><td>  4480x5600 </td><td>  8960x11200 </td></tr><tr><td>  Plate 4 </td><td>  600x750 </td><td>  1200x1500 </td><td>  2400x3000 </td><td>  4800x6000 </td><td>  9600x12000 </td></tr></tbody></table><br><p>  Having determined these dimensions, we added 4 new categorical features for each particle ‚Äî the number of the rectangle in which it intersects each plate. </p><br><p><img src="https://habrastorage.org/webt/mc/qq/vc/mcqqvcuefppnxiuxh1h0wqgfka0.jpeg"></p><br><p>  We also noticed that the particles seemed to scatter to the side of the center, and an idea appeared to somehow evaluate the "quality" of this expansion.  Ideally, it would probably be possible to come up with some kind of ‚Äúideal‚Äù parabola depending on the point of the pole and estimate the deviation from it, but we limited ourselves to the ‚Äúideal‚Äù straight line.  By constructing such ideal straight lines for each entry point, we were able to calculate the standard deviation of the trajectory of each particle from this straight line.  Since the average deviation for target = 1 turned out to be 152, and for target = 0, it turned out 390, we previously rated this feature as good.  And indeed, this feature immediately hit the top of the most useful. </p><br><p>  We were delighted, and added the deviation of all 4 intersection points for each particle from the ideal straight line as additional 4 features (and they also worked well). </p><br><p>  References to scientific articles on the topic of the competition, given to us by the organizers, suggested that we are not the first to solve this problem and, perhaps, there is some specialized software.  Finding on github the repository where the methods IsMuonSimple, IsMuon, IsMuonLoose were implemented, we transferred them to us with a few modifications.  The methods themselves were very simple: for example, if the energy is less than a certain threshold, then this is not a muon, otherwise muon.  So simple signs obviously could not give a gain in the case of using gradient boosting, so we added another significant "distance" to the threshold.  These features also improved a bit.  Perhaps by analyzing existing techniques more thoroughly, it was possible to find more powerful methods and add them to the signs. </p><br><p>  At the end of the contest, we drew a little on the ‚Äúquick‚Äù solution for the second task, as a result it differed from the baseline in the following points: </p><br><ol><li>  Negative weight lines have inverted target. </li><li>  Fill in the missing values ‚Äã‚Äãin MatchedHit_ {X, Y, Z} [N] </li><li>  Reduced depth to 7 </li><li>  Reduced learning rate to 0.1 (it was 0.19) </li></ol><br><p>  As a result, we tried some more features (not very well), picked up the parameters and trained catboost, lightgbm and xgboost, tried different prediction blends, and before the discovery of private chat we confidently won the second task, and the first were among the leaders. </p><br><p> After the opening of the privat, we were in 10th place for 1 task and 3 for the second.  All the leaders mixed up, and the speed on the privat turned out to be higher than on the liberboard.  It seems that the data were poorly stratified (or, for example, there were no rows with negative weights in the private message) and this was a bit frustrating. </p><br><h1 id="sna-hackathon-2019---teksty-pervyy-etap">  SNA Hackathon 2019 - Texts.  First stage </h1><br><p>  The task was to rank the posts of the user in the social network Odnoklassniki according to the text contained in them, besides the text there were some more characteristics of the post (language, owner, date and time of creation, date and time of viewing). </p><br><p>  As a classic approach to working with text, I would highlight two options: </p><br><ol><li>  Mapping each word to an n-dimensional vector space, such that similar words have similar vectors (more details can be found in <a href="https://habr.com/ru/company/singularis/blog/358664/">our article</a> ), then either finding the average word for the text or using mechanisms that take into account the relative position of the words (CNN, LSTM / GRU) . </li><li>  Using models that immediately know how to work with whole sentences.  For example, Bert.  In theory, this approach should work better. </li></ol><br><p>  Since this was my first experience with texts, it would be wrong to teach someone, so I will teach myself.  These are the tips I would give myself at the beginning of the competition: </p><br><ol><li>  Before you run to train something, look at the data!  In addition to the texts directly, there were several columns in the data and much more could be squeezed out of them than I did.  The simplest is to make the mean target encoding for part of the columns. </li><li>  Don't learn from all the data!  There was a lot of data (about 17 million lines) and it was absolutely not necessary to use all of them to test hypotheses.  Training and preprocessing were very slow, and I clearly would have had time to test more interesting hypotheses. </li><li>  &lt; <em>Controversial tip</em> &gt; Do not look for a killer model.  I spent a long time dealing with Elmo and Bert, hoping that they would immediately lead me to a high place, and as a result I used the pre-trained FastText embeddings for the Russian language.  With Elmo, it was not possible to achieve a better ambush, and did not have time to figure it out with Bert. </li><li>  &lt; <em>Controversial tip</em> &gt; Do not look for one killer feature.  Looking at the data, I noticed that around 1 percent of the texts do not contain, in fact, the text!  But then there were links to some resources, and I wrote a simple parser that opened the site and pulled out the name and description.  It seems to be a good idea, but then I got carried away, decided to parse all the links for all the texts and again lost a lot of time.  All this did not give a significant improvement in the final result (although I figured out the stemming, for example). </li><li>  Classic features work.  We google, for example, "text features kaggle", read and add everything.  TF-IDF gave an improvement, statistical features, like text length, words, punctuation amounts, too. </li><li>  If there is a DateTime column, it is worthwhile to disassemble them into several separate features (hours, days of the week, etc.).  What features to select, it is necessary to analyze the graphs / some metrics.  Here, on a whim, I did everything correctly and selected the necessary features, but a normal analysis would not hurt (for example, as we did at the final). </li></ol><br><p><img src="https://habrastorage.org/webt/kx/bq/bx/kxbqbxhaawshownyztc6oq_uqmw.png"></p><br><p>  As a result of the competition, I trained one keras model with convolution by words, and another one - based on LSTM and GRU.  Both here and there, pre-trained FastText embeddings for the Russian language were used (I tried a number of other embeddings, but these were the ones that worked best).  Averaging the predictions, I finished 7th place out of 76 participants. </p><br><p>  Already after the first stage, an <a href="https://habr.com/ru/company/mailru/blog/445348/">article by Nikolai Anokhin</a> was published who took second place (he participated out of the competition), and his decision repeated mine until some stage, but he went further due to the query-key-value attention mechanism. </p><br><h1 id="vtoroy-etap-ok--idao">  Second stage OK &amp; IDAO </h1><br><p>  The second stages of the competitions took place almost in a row, so I decided to consider them together. </p><br><p>  At first, with the newly acquired team, I got into the impressive office of Mail.ru, where our task was to combine the models of the three tracks from the first stage - the text, the picture and the collage.  A little more than 2 days was allotted for this, which turned out to be very little.  In fact, we could only repeat our results of the first stage without receiving any gain from the merger.  As a result, we took the 5th place, but the text model could not be used.  Looking at the decisions of other participants, it seems that it was worth trying to cluster the texts and add them to the collab model.  A side effect of this stage was new impressions, acquaintances and communication with cool participants and organizers, as well as a strong lack of sleep, which may have affected the outcome of the final IDAO stage. </p><br><p>  The task at the IDAO 2019 Final internal stage was to predict the waiting time for Yandex taxi drivers at the airport.  At stage 2, 3 tasks = 3 airports were allocated.  For each airport, given per minute data on the number of taxi orders for six months.  And as the test data was given the next month and per-minute data on orders over the past 2 weeks.  There was little time (1.5 days), the task was quite specific, only one person came from the team to the competition - and as a result, a sad place near the end.  Of the interesting ideas were attempts to use external data: about weather, traffic jams and statistics of orders Yandex-taxi.  Although the organizers did not say what the airports were, many participants suggested that they were Sheremetyevo, Domodedovo and Vnukovo.  Although this suggestion was disproved after the competition, features, for example, with Moscow weather data, improved the result both on validation and on the leaderboard. </p><br><h1 id="zaklyuchenie">  Conclusion </h1><br><ol><li>  ML contests are cool and interesting!  Here there is an application of skills and data analysis, and tricky models and techniques, and just common sense is welcome. </li><li>  ML is already a huge layer of knowledge that seems to grow exponentially.  I set myself a goal to get acquainted with different areas (signals, pictures, tables, text) and I already understood how much to learn.  For example, after these contests I decided to study: clustering algorithms, advanced techniques for working with gradient boost libraries (in particular, working with CatBoost on the GPU), capsule networks, the query-key-value attention mechanism. </li><li>  Do not kaggle'om one!  There are many other contests where at least it is easier to get a t-shirt, and there are more chances for other prizes. </li><li>  Communicate!  In the field of machine learning and data analysis, there is already a large community, there are subject groups in telegram, slack, and serious people from Mail.ru, Yandex and other companies answer questions and help beginners and continue their way in this area of ‚Äã‚Äãknowledge. </li><li>  I advise <a href="https://datafest.ru/">everyone</a> visiting the previous paragraph to visit the <a href="https://datafest.ru/">datafest</a> - a large free conference in Moscow, which will be held on May 10-11. </li></ol></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/449430/">https://habr.com/ru/post/449430/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449422/index.html">Alarm! Alarm !: how fish warn their kin about danger</a></li>
<li><a href="../449424/index.html">3 Amigo - a way to communicate, to create a quality product</a></li>
<li><a href="../449426/index.html">Objectives and Key Results: instructions for use</a></li>
<li><a href="../449428/index.html">Ford will build an electric car using EV-startup Rivian's tech</a></li>
<li><a href="../44943/index.html">Customize Trackball Marble Trackball</a></li>
<li><a href="../449432/index.html">How an IT publishing company discovered a book about Kafka</a></li>
<li><a href="../449434/index.html">Startups "alternative food". Companies that develop what we all eat</a></li>
<li><a href="../449436/index.html">RHEL 8 Beta Workshop: Installing Microsoft SQL Server</a></li>
<li><a href="../449438/index.html">Synchronized security in Sophos Central</a></li>
<li><a href="../449440/index.html">DUMP conference | grep 'backend \ | devops'</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>