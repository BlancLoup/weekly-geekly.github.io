<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unobvious features of product sorting and "dance of reality"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As usual, we are trying to solve a complex math problem with minimal means and costs. The essence of the task is to sort the goods of the online store...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unobvious features of product sorting and "dance of reality"</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/c6e/1a8/459/c6e1a8459ace4a49a20c6a18cceb62f4.png"><br><br>  As usual, we are trying to solve a complex math problem with minimal means and costs.  The essence of the task is to <b>sort the goods of the</b> online store in such a way that it is most convenient for the buyer. <br><br>  <b>The easiest way is to set the order manually.</b>  In physical stores on the shelves, this is exactly what is done, and this is called ‚Äúdisplay.‚Äù  We have it done by sellers for planograms for each point (this is included in the training), and in the same large grocery - special merchandiser dudes who make sure that everything is ok.  On the Internet, of course, I want to do the same, but the method is good up to 50 positions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      On the other side of the scale are big data methods, when all the data about you, starting from the browser assembly, such as the device (more precisely, its prices) and the screen resolution, plus all the profile data and evaluation of your actions on the site, lead to an optimal result.  The easiest way to use such data is to build your profile in the first 20-30 seconds on the site and compare it with the profiles of the same people.  And, in the end, to offer you not the cheapest apartments and hotels, for example, but to start with the prices that will be acceptable to you.  You probably know this sorting, which for some reason is served in the press under the sauce "the most convenient for the client." <br><br>  According to my feelings, the most convenient for our customer is one that is understandable and controllable. <a name="habracut"></a><br><br>  If you look at how the goods are sorted in various online stores, you will see that there is definitely ordering by price, availability, and some other voodoo-type parameter like ‚Äúby popularity‚Äù, ‚Äúin ozonovski‚Äù and so on.  We will talk about this magic. <br><br><h3>  Where did we start </h3><br>  Made by hand.  Up to 50 products are the best way.  In fact, in similar layouts it was possible and without sorting - the goods are placed on 2-3 screens, and even navigation is not always needed.  You can dump everything in a heap, the user will be happy.  So we did. <br><br>  However, when a buyer cannot push all the products of a category (or a catalog in general) into RAM, sorting is nevertheless necessary.  When we reached about a hundred games, we needed the first functional tool - a ladder for the price.  In general, sorting by price is a very simple and straightforward thing.  You have a budget and you want to meet it.  Or do you want to compare several similar products.  Or you just want to take the "bottom" and "top" of the category in order to understand what to rely on when comparing products. <br><br><div class="spoiler">  <b class="spoiler_title">This sorting allows you to exploit a single thinking bug.</b> <div class="spoiler_text">  Many specifically enter into the category of expensive goods, which pushes the border of the fork up, and the ‚Äúgolden mean‚Äù becomes something more expensive than before.  In the absence of information about current prices, a person buys something that is not the cheapest (because he wants good), but also not the most expensive.  The scatter occurs within the segment approximately in the normal distribution.  The most famous documented experience is this (simplifying): 0.3, 0.5 and 0.7 beer was sold at the bar.  They took mostly 0.5.  Experimenters shifted the boundaries to 0.5, 0.7 and 0.9.  The people began to take 0.7, although before that the consumption rate was 0.5. </div></div><br><br>  Mechanically, it is implemented very simply - the prices are compared.  At the same prices, lucky to the product, which fell into the comparison array earlier (most likely, was previously added to the site). <br><br>  The first problem of sorting by price is that bestsellers will be buried pretty deep down.  The second - the goods are not in stock, which may be in the middle of the list.  The third - often there is a lot of garbage at the top, that is, all sorts of consumables, packaging, etc., which is cheap, but often has no direct relation to the goods for which the person came. <br><br>  Accordingly, as a tool, it is needed, but as an additional one.  The basic sorting should be different. <br><br>  We tried to sort by sales and at the same time began to collect estimates of goods on a scale from 1 to 5, in order to enter sorting by rating. <br><br>  <b>When sorting by sales</b> , not bestsellers, but cheap goods, which obviously (in pieces) take more than anything else, began to force their way upwards.  Any product with a price above the average has an underestimated chance of being at the top of such a sort.  Accordingly, you need to somehow balance it. <br><br>  We thought it would be a good idea to make an ensemble of models, and to use a rating as a second weighting function for the overall evaluation.  And not only, but more on that later. <br><br>  It turned out that one cannot simply take and unload a rating, because a product with 4.5 "stars" per 100 reviews is clearly better than a product by 5 stars, but with 1 review.  The solution is obvious - to change the weighting factor of the rating in the overall evaluation function depending on the number of reviews.  The variant was considered with the fact that it varies from 1% to 50% nonlinearly, for example, 200 reviews give 40% to weight, and 10 ratings give 15% to weight.  But we didn‚Äôt have enough time to play with the coefficients - there was a completely stupid sorting problem according to estimates. <br><br>  The fact is that the estimates were also set according to the normal distribution. <br><br>  The freaking Gaussian was shifted only one division from the bottom - after all, we mostly remember the school grading system, where, in fact, there is no one.  That is, most of the goods come in at 2-5 with an optimum somewhere around 3.5-4 points.  All hits were 4.5, all non-hits - 4. <br><br>  After some time, in general, all the goods became the same, and a separate sort of "rated" did not give anything good. <br><br>  Another problem was the old voting dilemma on the site: one must either authorize the user by mail or something similar (rather difficult to generate), or not do so and filter the markups.  Including slow and smooth.  I know this very well, because even when I was studying at the university, thanks to the ‚Äútesting of security‚Äù of the university‚Äôs website, which was supported by another group (we were mathematicians-system programmers, and they were information security), the university emblem was selected in passing.  At the vote.  On Saturday.  On Monday morning, before the administrator arrived, the rector slammed his fist on the table and said, ‚ÄúEnough to plant, get out, over the weekend 400 students voted, and take this emblem.‚Äù  The problem was that the most popular connection in the city is a dial-up, and we went without graphics.  And for which there was a vote, simply did not see.  Two years later, I told a little more details than you, the head of the university's IT service.  And after that he ran three blocks.  It was then that I realized with my feet the importance of protecting voting ballots. <br><br>  So here.  The product could be screwed, because logging in for the sake of evaluation is the wildest hemorrhoids.  Collecting estimates only from logged-in users (that is, after ordering, but before receiving it in most cases) seemed not a very sober idea. <br><br>  We turned off the collection of ratings and sorting by it and began to think further. <br><br><h3>  Second run </h3><br>  Comparing the popularity of products when selling in the physical world and through the site, we got the following conclusion - it‚Äôs not only the rating of the product that is important and not the rating of the product, but the number of evaluations to it.  That is, a product with hundreds of ratings is clearly better than a product with a dozen ratings, despite the fact that both are not knocked out strongly enough from the central area of ‚Äã‚Äãnormal distribution. <br><br>  It was possible to hang a weight coefficient on this part, but everything was decided much easier.  Just at the moment while I was thinking about this problem (by turning off sorting by rating, because it had already done very little), Facebook put its ‚ÄúLike‚Äù buttons on the Internet. <br><br>  Three buttons - Google, VKontakte and Facebook - solved the question.  We got a sort of "by rating", and the rating was determined by the sum of the indicators of likes.  And every vote in this system was taken into account for sure - thanks to the social networks and their authorization, we did not have to think about this problem. <br><br>  We again tried to cross the sorting by rating with the sorting by sales, but then there was the problem of availability of goods. <br><br><h3>  Availability </h3><br>  These were hard years, and we sold as we could.  The presence of real-time on the site seemed to us enough space technology, but it took.  The number of stores grew, the number of errors increased due to the fact that a person came, but there were no games, the number of negative reviews increased: ‚ÄúI compared three goods for half an hour, but not two,‚Äù and so on. <br><br>  Pretty quickly, but with a <a href="http://habrahabr.ru/company/mosigra/blog/237577/">lot of blood</a> we synchronized the base of each store in real time (well, almost, minus the cache) with the site. <br><br>  Let me remind you, we worked then not very long ago, so suddenly we understood one more thing: sorting by sales should be limited to a certain interval.  Because otherwise, new games will not have a chance to break through - because the old ones are in the top, and they have historically been sold more. <br><br>  Limited month. <br><br>  <b>Further, they made a volitional decision not to take into account the sorting of goods that are not present now.</b>  They simply stack up below the list under the list in the order of ‚Äúpast merit‚Äù, that is, the historical position in the same list.  This was done so that the person did not compare the goods, one of which cannot be bought right now. <br><br>  There was a problem.  There were only nine points in Moscow then, and it‚Äôs not a fact that the goods ended everywhere at the same time.  Plus an online store.  How to show the product on the site, which is not in the online store, but at the points it is? <br><br>  The method suggested by one of the retail chains of home appliances seemed correct - the user chooses either the store (closest to the house) when entering the site or decides to buy with delivery.  Until the general surfing.  And all the goods "dance" on the parameters of this store.  No there - sorted down and showed that there is only in the warehouse of the online store. <br><br>  Monitoring the behavior of our customers has shown that the idea is so-so.  Specifically, we have.  Why?  Everything is simple - shops on the ring line of the metro and nodes, and usually 1-2 minutes from the metro (or even in the metro building, like on Kurskaya, if you're lucky).  This meant that the buyer does not have a ‚Äúfavorite‚Äù store.  He calls in the one that is more convenient for him on the way between the house, office, bar and mistress. <br><br>  However, the sorting by sales for the last month by 80% solved the problem of availability only in certain stores - when the game is not sold throughout the network, its position begins to fall sharply. <br><br><img src="https://habrastorage.org/files/640/677/670/6406776705bf4ff4be9c1285af1f6407.png"><br><br><h3>  Current model </h3><br>  The next hypothesis was: what if the problems of selling a heap of small pieces were solved by equating one ‚Äúlarge‚Äù game with a pair of ‚Äúmedium‚Äù or a bunch of ‚Äúsmall‚Äù ones?  Then all the little things will not climb up the sort. <br><br>  The solution was found to be very simple - instead of sorting by the number of units sold per month, we began to sort by turnover per month. <br><br>  Then they also played with terms and shortened the period so that the current trends were reflected directly on the sorting. <br><br>  <b>Sorting of this type became the basis for launching promotion in the real world.</b>  That is, products that turn around better go to advertising.  This has already come from the physical principle of the calculation - the most wrapped product to the height of the chest, so that it is closer to the hands and eyes. <br><br>  The shorter the term - the more relevant is the game in the position of "top".  A longer interval is a greater impact of past sales.  Accordingly, we raised the degree of competition between goods.  Previously, the "old men" were sitting in the top, from where they could not be squeezed out.  Now every new well-selling game got a solid chance.  It was necessary to gain a foothold in the top - and now it sells well, not only on its own, but also thanks to the top.  But, of course, it was possible to gain a foothold only thanks to the current merits - that is, if the interest in the position faded away, it would go back to the ‚Äúbasement‚Äù.  It perfectly balanced seasonal goods - Small towns and Petank vigorously climbed up in the summer. <br><br>  The second sorting method is a collection of likes. <br><br><h3>  Current Model Issues </h3><br>  <b>First, we do not take into account in our basic sorting likes and the number of comments to the game</b> - this, of course, determines its popularity, but is made into a separate tool.  Why?  Just because we have reached the stage where ‚Äúwallet voting‚Äù gives more realistic data.  In theory, of course, you can include the speed and acceleration of a set of likes as weights, but this is a matter for the future. <br><br>  <b>Secondly, we do not take into account the "temperature" of the game.</b>  That is, new items are held on a common basis.  We do not have simultaneous launches due to geography (the furthest point is Yuzhno-Sakhalinsk, it flies there by plane; the longest points on the mainland are 3-4 weeks delivery).  Therefore, the game can not get the initial acceleration everywhere and immediately - and the effect of the "bright new" is smeared around the cities.  Probably, it will be correct to rank novice higher for the first 3-4 weeks at the expense of novelty. <br><br>  <b>Thirdly, we have quite a lot of games in which both children and adults can play.</b>  And almost every one is a good gift.  This automatically means that in 2-3 categories there will definitely be similar bestseller lists, that is, the ‚Äútop‚Äù of the sort will be the same.  In this case, it would be logical to take the sorting for each category, but this is still difficult to do - you need to know for whom each position is bought (this is already cool Data Mining, and we are slowly doing it, I'll tell you on occasion). <br><br>  <b>Fourth, yes, you can use the services of optimal product offers, issuing sorting from user actions on the site.</b>  Perhaps you know these.  The general principle is the analysis of input data (browser, screen, geography, etc.), behavior on the site (I went to ‚Äúchildren‚Äôs‚Äù, I looked at these two products) and profiling, and then overlay ‚Äî what people with the same profile bought like you, you have to show you.  The problem is that, firstly, with such a sorting, control is lost, and, secondly, we still tested it.  And they did not get any significant differences between the ‚Äúdance of reality‚Äù and their basic methods.  I note that one of the possible reasons is the fierce desire of the service of such recommendations to sell more by all means through ‚ÄúI do not want‚Äù, which affected the ‚Äúaggressiveness‚Äù of the proposals and algorithms.  Disabled. <br><br>  As a result, it became clear that the correct idea was to ‚Äúfeature‚Äù the game, that is, add the ‚Äúchoice of editor‚Äù to the usual sorting.  We tried to do this as part of testing for sexual holidays (February 14 and 23, March 8) this year.  Soon we will try again, but otherwise.  Most likely it will work. <br><br><img src="https://habrastorage.org/files/dfb/581/4bc/dfb5814bc8cd418bbca209826f346d2f.png" title="And yes, I know, the first product is Nefarius."><br>  <sup>This is how it will be in the new interface.</sup> <br><br>  That is, again, we have now described a <a href="http://habrahabr.ru/company/mosigra/blog/267597/">full circle</a> from fully manual sorting to smart automation, and then back to manual. <br><br>  And yes, the task is not completely solved, there is much to do.  In general, in retrospect, everything described above seems logical and simple, but believe me, when we started, it was not at all like that.  I hope you were interested in our historical rakes. </div><p>Source: <a href="https://habr.com/ru/post/270129/">https://habr.com/ru/post/270129/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270119/index.html">AllcountJS: Making a simple CRM with a web interface and REST API in 15 minutes</a></li>
<li><a href="../270121/index.html">Mastering the Coordinator Layout</a></li>
<li><a href="../270123/index.html">Amazon Web Services is now in the Github Students Development Pack</a></li>
<li><a href="../270125/index.html">Asterisk: We will provide VIP clients with the first place in the call queue, as well as we will connect the client with a specific operator for a specified time.</a></li>
<li><a href="../270127/index.html">On projects on open data, the search for funding for public projects and on open data on public finances</a></li>
<li><a href="../270131/index.html">Kaggle competition for analyzing population survey data</a></li>
<li><a href="../270133/index.html">Cocos2d-x - simple game development</a></li>
<li><a href="../270137/index.html">Start using Rust</a></li>
<li><a href="../270141/index.html">Online compilation on a static site, a recipe for beginners</a></li>
<li><a href="../270143/index.html">Pirate metrics: how to create an email campaign based on the AARRR principle. Part 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>