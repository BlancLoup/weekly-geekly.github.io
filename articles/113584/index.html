<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Testing Android Applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 

 I am sure that modern programmers do not need to be persuaded to use unit tests. And if, when developing applications for android, mod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Testing Android Applications</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/c4a/b03/e14/c4ab03e14d16e28a2e668c8ab8657298.png" alt="image"><br>  I am sure that modern programmers do not need to be persuaded to use unit tests.  And if, when developing applications for android, modules that are not related to it, we can test using JUnit, familiar to everyone (truth is not always <a href="http://code.google.com/p/android/issues/detail%3Fid%3D2271">without crutches</a> ), then how to test the user interface and the classes using it?  The tools of the <b>android.test</b> framework will help us in this. <br><br>  In this article we will write a small android application and test it.  To work, we will need the installed jdk, android sdk, Eclipse and ADT plugin. <br><a name="habracut"></a><br><h4>  Part one.  SpeedConverter. </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/684/8af/d32/6848afd3267ef0674866ab1932fcc16b.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/e16/58d/039/e1658d039b6293f6c3900d99e95e94d7.png" alt="image"><br><br>  Our primitive application will translate ‚Äúkilometers per hour‚Äù into ‚Äúmeters per second‚Äù and vice versa, as well as issue an Error! Message if the required value cannot be calculated.  The user will enter speed data in any EditText and in another get the result.  We will not dwell on it in more detail. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      XML layout forms: <br><blockquote>  <font color="black"><font color="#0000ff">&lt;?</font></font>  <font color="black"><font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">= "1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">= "utf-8"</font> ?</font>  <font color="black"><font color="#0000ff">&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">LinearLayout</font> <font color="#ff0000">xmlns: android</font> <font color="#0000ff">= " <a href="http://schemas.android.com/apk/res/android">schemas.android.com/apk/res/android</a> "</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: orientation</font> <font color="#0000ff">= "vertical"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: layout_width</font> <font color="#0000ff">= "fill_parent"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: layout_height</font> <font color="#0000ff">= "fill_parent"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: padding</font> <font color="#0000ff">= "12dp"</font> <font color="#0000ff">&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Textview</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: id</font> <font color="#0000ff">= "@ + id / textKmPerHour"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: text</font> <font color="#0000ff">= "@ string / kmh"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: layout_width</font> <font color="#0000ff">= "wrap_content"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: layout_height</font> <font color="#0000ff">= "wrap_content"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Edittext</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: id</font> <font color="#0000ff">= "@ + id / editKmPerHour"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: layout_height</font> <font color="#0000ff">= "wrap_content"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: layout_width</font> <font color="#0000ff">= "match_parent"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: inputType</font> <font color="#0000ff">= "numberDecimal"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: numeric</font> <font color="#0000ff">= "decimal"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Textview</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: id</font> <font color="#0000ff">= "@ + id / textMetersPerSec"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: text</font> <font color="#0000ff">= "@ string / ms"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: layout_width</font> <font color="#0000ff">= "wrap_content"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: layout_height</font> <font color="#0000ff">= "wrap_content"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: paddingTop</font> <font color="#0000ff">= "4dp"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Edittext</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: id</font> <font color="#0000ff">= "@ + id / editMetersPerSec"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: layout_height</font> <font color="#0000ff">= "wrap_content"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: layout_width</font> <font color="#0000ff">= "match_parent"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: inputType</font> <font color="#0000ff">= "numberDecimal"</font></font> <font color="black"><br></font>  <font color="black"><font color="#ff0000">android: numeric</font> <font color="#0000ff">= "decimal"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;/</font> <font color="#800000">LinearLayout</font> <font color="#0000ff">&gt;</font></font> <font color="black"><br></font> <br>  <font color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br>  Next, set the listener for Kilometers per hour EditText and when the event occurs, we calculate the speed.  The nuance that onKey () does not occur with the active software keyboard, we will take into account later in the tests.  The second EditText works by analogy. <br><br><blockquote>  <font color="black"><font color="#008000">// setup listener for Kilometers per hour EditText</font></font> <font color="black"><br></font>  <font color="black">editKmPerHour.setOnKeyListener ( <font color="#0000ff">new</font> OnKeyListener () {</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">public</font> boolean onKey (View v, <font color="#0000ff">int</font> keyCode, KeyEvent <font color="#0000ff">event</font> ) {</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">if</font> ( <font color="#0000ff">event</font> .getAction () == KeyEvent.ACTION_UP) {</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">try</font> {</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">double</font> kmPerHour = Double.parseDouble (editKmPerHour</font> <font color="black"><br></font>  <font color="black">.getText (). toString ());</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">double</font> meterPerSec = kmPerHour * 0.2777777777777778;</font> <font color="black"><br></font>  <font color="black">editMeterPerSec.setText ( <font color="#0000ff">new</font> Double (meterPerSec)</font> <font color="black"><br></font>  <font color="black">.toString ());</font> <font color="black"><br></font>  <font color="black">} <font color="#0000ff">catch</font> (NumberFormatException e) {</font> <font color="black"><br></font>  <font color="black">editMeterPerSec.setText (R. <font color="#0000ff">string</font> .errorMsg);</font> <font color="black"><br></font>  <font color="black">Log.d (LOG, <font color="#A31515">"e:"</font> + e);</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">return</font> <font color="#0000ff">true</font> ;</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">return</font> <font color="#0000ff">false</font> ;</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black">});</font> <font color="black"><br></font> <br>  <font color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br>  We now turn to testing. <br><br><h4>  Part two.  SpeedConverterTest. </h4><br><h5>  Android Test Project </h5><br>  In the first part, we created the SpeedConverter application.  Now for him we need to create a new test application.  Go to the menu eclipse'a: <b>File -&gt; New -&gt; Projects ...</b> in the window that appears, select <b>Android -&gt; Android Test Project</b> , click <b>Next</b> and see this window: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/636/629/4ce/6366294ce7dad3cb6a6a6842bf480205.png" alt="image"><br><br>  Set the following values: <br><ul><li>  Test Project Name: SpeedConverterTest </li><li>  Test Target: install ‚ÄúAn existing Android project‚Äù and select our project SpeedConverter </li><li>  Application name and Package name will be substituted automatically </li></ul>  And click Finish. <br><br><h5>  Creating a Test Case Class </h5><br>  In the <font color="#008000">src /</font> directory of our project we will create a new class <b>New&gt; Class</b> .  Let's call it SpeedConverterTest and specify as android.test.ActivityInstrumentationTestCase2 as a SuperClass.  Our dialogue will look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1dd/9bc/599/1dd9bc599f0b2250a5439b455275959b.png" alt="image"><br><br>  Now a little more about ActivityInstrumentationTestCase2.  This class is designed to test activities in the android application.  It can create an activity (using InstrumentationTestCase.launchActivity ()), run tests in the UI thread and allows us to send various mock Intents to our activity.  In the parameter we will need to send to SpeedConverter. <br><br>  Add a test case constructor that will be used by the testing framework.  As parameters, we will show which android application will be tested. <br><br><blockquote>  <font color="black"><font color="#0000ff">public</font> SpeedConverterTest () {</font> <font color="black"><br></font>  <font color="black">super ( <font color="#A31515">"com.pyjioh"</font> , SpeedConverter. <font color="#0000ff">class</font> );</font> <font color="black"><br></font>  <font color="black">}</font> </blockquote><br>  Further, the setUp () method familiar from JUnit, which is called before running the tests, will initialize the variables in it. <br><br><blockquote>  <font color="black">@Override</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">void</font> setUp () throws Exception {</font> <font color="black"><br></font>  <font color="black"><font color="#008000">// TODO Auto-generated method stub</font></font> <font color="black"><br></font>  <font color="black">super.setUp ();</font> <font color="black"><br></font>  <font color="black">activity = getActivity ();</font> <font color="black"><br></font>  <font color="black">editKmPerHour = (EditText) activity</font> <font color="black"><br></font>  <font color="black">.findViewById (com.pyjioh.R.id.editKmPerHour);</font> <font color="black"><br></font>  <font color="black">editMeterPerSec = (EditText) activity</font> <font color="black"><br></font>  <font color="black">.findViewById (com.pyjioh.R.id.editMetersPerSec);</font> <font color="black"><br></font>  <font color="black">}</font> </blockquote><br>  We are starting to add tests, they will be simple in order to show how to interact with the UI, the first one will check whether our SpeedConverter activity was created and started, and whether we have access to our controls. <br><br><blockquote>  <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">void</font> testControlsCreated () {</font> <font color="black"><br></font>  <font color="black">assertNotNull (activity);</font> <font color="black"><br></font>  <font color="black">assertNotNull (editKmPerHour);</font> <font color="black"><br></font>  <font color="black">assertNotNull (editMeterPerSec);</font> <font color="black"><br></font>  <font color="black">}</font> </blockquote><br>  Using the assertOnScreen () method from ViewAsserts, we check if our controls are visible. <br><br><blockquote>  <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">void</font> testControlsVisible () {</font> <font color="black"><br></font>  <font color="black">ViewAsserts.assertOnScreen (editKmPerHour.getRootView (), editMeterPerSec);</font> <font color="black"><br></font>  <font color="black">ViewAsserts.assertOnScreen (editMeterPerSec.getRootView (), editKmPerHour);</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font> </blockquote><br>  Whether the application starts with empty EditText'mi. <br><br><blockquote>  <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">void</font> testStartingEmpty () {</font> <font color="black"><br></font>  <font color="black">assertEquals ( <font color="#A31515">"editKmPerHour is not empty"</font> , <font color="#A31515">""</font> , editKmPerHour.getText ()</font> <font color="black"><br></font>  <font color="black">.toString ());</font> <font color="black"><br></font>  <font color="black">assertEquals ( <font color="#A31515">"editMeterPerSec is not empty"</font> , <font color="#A31515">""</font> , editMeterPerSec</font> <font color="black"><br></font>  <font color="black">.getText (). toString ());</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font> </blockquote><br>  Now add a test that verifies the correctness of the translation of km / s in m / s.  In it, we use TouchUtils.tapView (..) which simulates a touch on the control we need, and KeyEvent.KEYCODE_BACK removes the software keyboard.  The void testConvertMsToKmh ‚Äã‚Äã() method looks similar. <br><br><blockquote>  <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">void</font> testConvertKmhToMs () {</font> <font color="black"><br></font>  <font color="black">TouchUtils.tapView ( <font color="#0000ff">this</font> , editKmPerHour);</font> <font color="black"><br></font>  <font color="black">sendKeys (KeyEvent.KEYCODE_BACK, KeyEvent.KEYCODE_1, KeyEvent.KEYCODE_0,</font> <font color="black"><br></font>  <font color="black">KeyEvent.KEYCODE_0);</font> <font color="black"><br><br></font>  <font color="black"><font color="#0000ff">double</font> meterPerSec;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">try</font> {</font> <font color="black"><br></font>  <font color="black">meterPerSec = Double.parseDouble (editMeterPerSec.getText ()</font> <font color="black"><br></font>  <font color="black">.toString ());</font> <font color="black"><br></font>  <font color="black">} <font color="#0000ff">catch</font> (Exception e) {</font> <font color="black"><br></font>  <font color="black">meterPerSec = -1;</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br><br></font>  <font color="black">assertTrue ( <font color="#A31515">"100 km / h is not 27.778 m / s"</font> , meterPerSec&gt; 27.7</font> <font color="black"><br></font>  <font color="black">&amp;&amp; meterPerSec &lt;27.8);</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font> </blockquote><br>  The last test checks if we get an error message. <br><br><blockquote>  <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">void</font> testGetError () {</font> <font color="black"><br></font>  <font color="black">TouchUtils.tapView ( <font color="#0000ff">this</font> , editKmPerHour);</font> <font color="black"><br></font>  <font color="black">sendKeys (KeyEvent.KEYCODE_1, KeyEvent.KEYCODE_DEL);</font> <font color="black"><br><br></font>  <font color="black">assertEquals ( <font color="#A31515">"Must be Error!"</font> ,</font> <font color="black"><br></font>  <font color="black">activity.getString (com.pyjioh.R. <font color="#0000ff">string</font> .errorMsg),</font> <font color="black"><br></font>  <font color="black">editMeterPerSec.getText (). toString ());</font> <font color="black"><br></font>  <font color="black">}</font> </blockquote><br>  Run our test application: <b>Run As&gt; Android JUnit Test</b> .  The video below shows how it will look. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/K60mwg6So1E%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhi-y0EAZ44hGiedPgPZv1y5Bx6g9A" frameborder="0" allowfullscreen=""></iframe><br><br>  Thus, we tested the functionality of our frivolous application. <br><br><h4>  What else? </h4><br>  Yes, actually, everything else.  The possibilities of the <b>android.test</b> framework are much wider.  For example, the ActivityUnitTestCase class, unlike ActivityInstrumentationTestCase2, allows you to test an activity in isolation, using the mock Context or Application.  On the official website <a href="http://developer.android.com/">developer.android.com</a> you can get acquainted with all the testing tools. <br><br>  The source text of SpeedConverter and SpeedConverterTest lies on <a href="http://code.google.com/p/speed-convertor/">code.google.com</a> </div><p>Source: <a href="https://habr.com/ru/post/113584/">https://habr.com/ru/post/113584/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../113575/index.html">Transmission new release released - try it!</a></li>
<li><a href="../113577/index.html">Stephen Elop responded to "turkeys"</a></li>
<li><a href="../113579/index.html">Canobuvosti, 78th edition</a></li>
<li><a href="../113580/index.html">Nokia + Microsoft. Here we go!</a></li>
<li><a href="../113581/index.html">This site is not available from your country. Cyber ‚Äã‚ÄãPins Peter compiles the tractor</a></li>
<li><a href="../113585/index.html">Persistent Structures, Part 1: Persistent Stack</a></li>
<li><a href="../113586/index.html">Subtle moments of C #</a></li>
<li><a href="../113587/index.html">How to trade stocks on NASDAQ</a></li>
<li><a href="../113588/index.html">Wolfram Mathematica: Acquaintance</a></li>
<li><a href="../113589/index.html">On the eve of the MWC 2011</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>