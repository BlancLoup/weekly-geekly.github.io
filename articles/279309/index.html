<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Banking Android Trojan disguises as a Flash player and bypasses 2FA authentication</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Our experts have discovered a new malicious campaign to spread the banking Trojan for Android. Troyan specializes in compromising users of large banks...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Banking Android Trojan disguises as a Flash player and bypasses 2FA authentication</h1><div class="post__text post__text-html js-mediator-article">  Our experts have discovered a new malicious campaign to spread the banking Trojan for Android.  Troyan specializes in compromising users of large banks in Australia, New Zealand and Turkey by stealing account credentials of twenty mobile banking applications.  It is detected by our anti-virus products like <a href="http://www.virusradar.com/en/Android_Spy.Agent.SI/description">Android / Spy.Agent.SI</a> . <br><br><img src="https://habrastorage.org/files/2ec/ec2/66d/2ecec266dca7453b8faafe8c76e72e11.png"><br><br>  The list of banks for which the Trojan is designed to compromise users includes the largest banks of the aforementioned countries.  Thanks to the SMS interception feature, malware can bypass the two-factor authentication protection mechanism.  The Trojan application itself is disguised as a Flash Player, and uses the same icon for this. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  The trojan was available for download from several servers that were publicly registered at the end of January and February 2016. It is interesting to note that URL paths to malicious APK files are generated every hour, which postpones the possibility of their detection by antivirus products. <br><br><img src="https://habrastorage.org/files/656/ef5/52c/656ef552c3b84a529ed3bab863b69b5b.png"><br>  Fig.  1. Directory with malicious program files. <br><br><img src="https://habrastorage.org/files/84d/1ab/5ae/84d1ab5aeb7d423390dac961d38d33d2.png"><br>  Fig.  2. Directory with malicious program files (new link). <br><br>  As in some other cases of malware for Android, this banking Trojan asks to grant it administrator rights in the system during its installation.  This self-defense mechanism prevents attempts to remove malware from the device.  After successful installation into the system, the malware hides the Flash Player icon from the user's eyes, but continues to work in the background itself. <br><br>  Next, the malware interacts with its remote C &amp; C server.  To hide transmitted data from prying eyes, the bot and server use base64 encoding.  The malicious program sends to the server such device data as its model type, IMEI identifier, language, SDK version, and information about the activation time of device administrator rights in Android.  Such information is sent to the server every 25 seconds of the malware.  Then the trojan collects a list of applications installed on the device (including banking applications) and sends this list to a remote server.  If a bot is configured to compromise applications, the C &amp; C server sends it a list of 49 different applications that the attackers expect to compromise. <br><br>  Troyan fulfills its functions of stealing online banking data by creating a special window that overlaps the window of a legitimate application for working with a bank account.  Such phishing activity of the Trojan is similar to the activity of the extortionist, who blocks the screen of the user's device without being able to unlock it.  After receiving user input, the trojan sends them to a remote server.  The attackers are interested in obtaining not only the credentials of online banking accounts, but also data from Google accounts. <br><br>  The first versions of the Trojan looked quite simple, while its true goals could be calculated quickly.  Later versions of the malware received obfuscation and encryption mechanisms, which complicated their analysis. <br><br>  When an application of malicious attackers is launched on Android, the malicious program is activated and shows the user a fake window that overlaps the banking application window. <br><br><img src="https://habrastorage.org/files/5f6/e70/178/5f6e701784ce4796bb6647d9c85a467e.png"><br>  Fig.  3. Interaction of the malicious program with the C &amp; C server manager. <br><br>  After the user types in the fake window field the login and password of the bank account, the fake window of the Trojan is closed, which causes the window of the real banking application to appear.  As mentioned above, all the information sent between the bot and the server is base64 encoded, with the exception of stolen credentials, which are transmitted in clear text. <br><br><img src="https://habrastorage.org/files/c45/57d/938/c4557d93888c4dd19987345b51f5218d.png"><br>  Fig.  Trojan sends stolen credentials in clear text. <br><br>  The malicious program can also bypass two-factor 2FA authentication by sending text SMS messages received by the device to a remote server.  This allows attackers to intercept all messages from the bank in a timely manner and immediately delete them on the compromised device to hide malicious activity from the user. <br><br>  <b>Malware removal</b> <br><br>  When a user tries to remove a trojan from the system, two different scenarios are possible.  First, the user can deny admin rights for the application, and then remove the fake Flash Player from the device.  Deactivating admin rights for a trojan can be done in two ways.  The easiest is to use the built-in Android settings Settings-&gt; Security-&gt; Device Administrators-&gt; Flash Player-&gt; Deactivate, then ignore the Trojan window that appears and click OK. <br><br><img src="https://habrastorage.org/files/582/92a/b91/58292ab91b494cf183263158511743a0.png"><br>  Fig.  Disable device admin mode for trojan. <br><br>  After that, the user has the opportunity to remove the trojan through Settings-&gt; Application Manager-&gt; Flash Player-&gt; Delete. <br><br>  The removal procedure can be more complicated if the bot received from the server a command to prevent the deactivation of administrator rights on the device.  In this case, as soon as the user attempts to deactivate them, the malicious program will create a special overlapping window that will not allow the user to confirm the disabling of the rights. <br><br><img src="https://habrastorage.org/files/d91/05f/a79/d9105fa792e145198aaaea84f9592d79.png"><br>  Fig.  A special window that does not allow the user to confirm the revocation of administrator rights. <br><br>  Another way to safely deactivate administrator rights is to use Safe Mode.  When loading in safe mode, Android disables the download of third-party applications.  In this case, the user can safely disable them, as in the first case.  ESET antivirus products detect Trojans like <b>Android / Spy.Agent.SI</b> . <br><br>  Below are the layouts of fake windows banking applications that are used by the Trojan. <br><br><img src="https://habrastorage.org/files/623/06d/878/62306d878358482e9fd5c08870fc666b.png"><br><br><img src="https://habrastorage.org/files/685/2aa/c77/6852aac77de44d0e92dfbc0e9f6f5fb7.png"><br><br><img src="https://habrastorage.org/files/27a/7a1/e80/27a7a1e805194c0fbfef745fa687927f.png"><br><br><img src="https://habrastorage.org/files/733/912/852/73391285281f4b0e955e3ef5db21bb53.png"><br><br>  <b>Additional Information</b> <br><br>  ESET Detection: <br><br>  Android / Spy.Agent.SI. <br><br><img src="https://habrastorage.org/files/00a/376/090/00a376090c5345929213c5525fd7339e.png"><br><br><img src="https://habrastorage.org/files/ee0/9d8/242/ee09d8242abb4f03822eb0d8ff436c49.png"><br><br>  Banks whose Trojan targets compromise: <br><br>  Westpac, Bendigo Bank, Commonwealth Bank, St.  George Bank, National Bank of Australia, Bank of New Zealand, Bank of New Zealand, Bank of New Zealand, Wells Fargo, Halkbank, Bankruptcy Bank, Bankruptcy Bank, Bank of Aktau, Finansbank, T√ºrkiye ƒ∞≈ü Bankasƒ± and Ziraat Bankasƒ±. <br><br><img src="https://habrastorage.org/files/d63/b06/f72/d63b06f72b214f759516ec1a3fca8e2e.png"><br><br><img src="https://habrastorage.org/files/c77/a0f/919/c77a0f919f544f1cb4e4a0aa711e99d2.png"><br><br><img src="https://habrastorage.org/files/7f5/095/362/7f50953623094e2197208901db7cfe52.png"></div><p>Source: <a href="https://habr.com/ru/post/279309/">https://habr.com/ru/post/279309/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../279291/index.html">Web applications offline. ServiceWorker and CacheStorage</a></li>
<li><a href="../279293/index.html">Number written in Laravel 5</a></li>
<li><a href="../279295/index.html">How we wrote the code Netflix</a></li>
<li><a href="../279299/index.html">Dedicated servers and reviews about hosts</a></li>
<li><a href="../279307/index.html">Molecula - a new way to conduct group correspondence in Outlook</a></li>
<li><a href="../279313/index.html">Audio conferences for the poor and for the rich</a></li>
<li><a href="../279315/index.html">Curious case with root-access to mysql</a></li>
<li><a href="../279321/index.html">Finding inefficiencies: What you need to know about creating strategies for trading on the exchange</a></li>
<li><a href="../279323/index.html">Welcome to Moscow Python Meetup March 18</a></li>
<li><a href="../279325/index.html">Bounty program in Badoo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>