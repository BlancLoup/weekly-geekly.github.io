<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Crypto Solitaire</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The streaming encryption algorithm SOLlTAlRE (PASIANCE) was proposed by B. Schneier in 1999. The cipher is beautiful and I don‚Äôt understand why nobody...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Crypto Solitaire</h1><div class="post__text post__text-html js-mediator-article">  The streaming encryption algorithm SOLlTAlRE (PASIANCE) was proposed by B. Schneier in 1999. The cipher is beautiful and I don‚Äôt understand why nobody has illuminated it at Habr√©.  Did no one read Stevenson's Kryptonomicon?  Actually, after reading the book, I cannot pass by this miracle. <br><br>  From theory, this is a stream cipher with output feedback.  From the threading it follows that each symbol of the original sequence will correspond to an encrypted symbol.  For those who do not know, for example, there are still block ciphers, in which encryption occurs in blocks (several bytes or characters).  Further, there are many types of clutch blocks of text and the so-called gamma (some random secret sequence).  In this case, the output feedback is used, i.e.  each gamma symbol changes the gamma state. <br><img src="https://habrastorage.org/storage2/e58/53c/96c/e5853c96c61b00049b394c921ad02d19.jpg"><br><a name="habracut"></a><br><br><h4>  Encryption </h4><br>  Encryption is extremely easy.  There are 2 sequences: <br><ol><li>  DO NOT USE PC </li><li>  AD JEN MWD OI </li></ol><br>  1 - the text to be encrypted.  2 - gamma (about its generation below).  All that is needed is to translate the text into numbers and break the text into 5 letters (this is cryptographic etiquette).  If there are less letters, they are filled with a certain conditional symbol, for example, x. <br><ol><li>  4 | 15 | 14 | 15 | 20 21 | 19 | 5 | 16 | 3 </li><li>  1 | 4 | 10 | 5 | 14 13 | 23 | 4 | 15 | 9 </li></ol><br>  Next is the addition.  If you get a number greater than 26, then you must subtract 26 from it. Example 4 + 1 = 5, 20 + 14 = 8. <br>  The final sequence: 5 | 19 | 24 | 20 | 8 8 | 16 | 9 | 5 | 12.  Translate into letters: <b>ESXTH HPIEL</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Decryption </h5><br>  Decrypting a message is also very easy.  Absolutely the same gamma is generated and gamma is subtracted from the ciphertext.  If a number less than zero is obtained, then just 26 is added to it. Example 5-1 = 4, 8-14 = 20. <br><ol><li>  5 | 19 | 24 | 20 | 8 8 | 16 | 9 | 5 | 12 </li><li>  1 | 4 | 10 | 5 | 14 13 | 23 | 4 | 15 | 9 </li></ol><br>  Total we have 4 | 15 | 14 | 15 | 20 21 | 19 | 5 | 16 | 3 -&gt; <b>DO NOT USE PC</b> <br><br><h4>  Gamma Generation </h4><br>  It is this part of the algorithm that makes this cipher so interesting.  A full deck of cards 52 cards + 2 jokers is required.  Maps must be numbered, preferably in the mind (you do not want the NSA to know your secret).  From Ace to the King from 1 to 13 and according to the colors, the order is the following: Clubs, Diamonds, Worms, Spades.  The last 2 numbers will take the joker, which must be distinguished between 53-A, junior joker and 54-B senior joker. <br>  You need to have 2 decks that will be shuffled in exactly the same way.  You will have one deck, your friend will have another deck, who will decrypt your messages. <br>  For ease of perception, I will cut decks to 28 cards.  Suppose initially they were arranged in this order: <br>  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 <u>27</u> <b>28</b> <br><br>  <b>1 step.</b>  Move the junior joker to 1 card down the deck.  If it turns out to be the last one, then place it after 1 card. <br>  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 <b>28</b> <u>27</u> <br><br>  <b>2 step.</b>  Move the high joker 2 positions down the deck.  If he is the last, then place him after 2 cards, if he is the last but after the first card. <br>  1 <b>28</b> 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 <u>27</u> <br><br>  <b>3 step.</b>  Swap the 2 ends of the deck, separated by 2 jokers.  In this case, the number 1 will go to the end of the deck. <br>  <b>28</b> 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 <u>27</u> 1 <br><br>  <b>4 step.</b>  Look at the last number.  Count off so many cards from the beginning of the deck and place them before the last card.  The last card is intentionally left in place for reversibility of the algorithm. <br>  2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 <u>27</u> <b>28</b> 1 <br><br>  <b>5 step.</b>  Look at 1 number.  Count down the number of cards after it and remember this number.  In this case, it is 4. This is the first number of the key sequence.  This step does not change the deck.  Further steps 1 to 5 are repeated n times.  Where n is the number of characters in the encrypted text. <br><br><h4>  Localization </h4><br>  I also thought about the Cyrillic version of ‚Äúsolitaire‚Äù.  Everything turned out to be quite not difficult.  If we exclude the letter e, then in Russian there are 32 letters.  +2 jokers total 34 cards.  A regular deck without a 6-approx. <br><br><h4>  Implementation </h4><br>  The essence of the cipher is in its invisibility.  Well, judge for yourself what looks pale: a deck of cards or encryption programs on a laptop?  However, it is necessary to spend a lot of time to encrypt and decrypt large texts.  I found a whole bunch of <a href="http://www.schneier.com/solitaire.html">implementations</a> .  But among them was not familiar to me PHP.  It was just a very boring evening and a small application was born (link below).  The basis of the application is the solitaire class.  It implements some necessary methods. <br><ul><li>  Post preparation.  definition of its linguistic affiliation, the formation of certain constants and string processing </li><li>  Gamma preparation.  More precisely the original sequence that the user sets.  From it just turns gamma </li><li>  Receiving character gamma.  The solution is certainly not the most elegant (I will be glad to comment).  A massive array_slice - array_merge was used. </li><li>  Convert strings to numbers and back. </li><li>  Line addition and subtraction (encryption and decryption). </li></ul><br><br><h4>  Evaluation </h4><br>  Such algorithms can only be decrypted by brute force (brute force).  Various analytical methods are practically not applicable to it.  The weakness of the algorithm is only in its key (deck).  If you capture a deck, they will be able to decipher it, provided that you completely follow the algorithm. <br>  The author himself offers several ways. <br>  1. Use each time a new key.  Take the key from a certain agreement (a bridge column from newspapers, certain numbers from stock ratings, etc.).  The main thing about them to agree. <br>  2. Change the gamma acquisition algorithm slightly.  Then, when removing the deck, the NSA still does not understand anything. <br><br><h4>  Links </h4><br>  Official article of the author of the algorithm: <a href="http://www.schneier.com/solitaire.html">link</a> <br>  My application for encryption and decryption: <a href="http://blog.assorium.ru/crypt/solitair/">link</a> <br>  Link to PHP class: <a href="">link</a> </div><p>Source: <a href="https://habr.com/ru/post/138986/">https://habr.com/ru/post/138986/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138980/index.html">How does it work in a Google office in Zurich?</a></li>
<li><a href="../138981/index.html">Prototyping Windows Phone Applications in SketchFlow</a></li>
<li><a href="../138982/index.html">Mozilla and Telefonica are working on a new mobile OS.</a></li>
<li><a href="../138983/index.html">Mozillovsky Boot to Gecko: The Web is a Platform</a></li>
<li><a href="../138984/index.html">Webserver nginx + fastcgi-wrapper + matlab</a></li>
<li><a href="../138987/index.html">Asynchronous IndexedDB API wrapper</a></li>
<li><a href="../138989/index.html">Methods for monitoring websites and services</a></li>
<li><a href="../138990/index.html">Mobilization: Opera Mobile 12 and Opera Mini 7 Next</a></li>
<li><a href="../138991/index.html">The FBI ordered the court to shut off 3,000 GPS bugs, now it cannot find them</a></li>
<li><a href="../138994/index.html">5 more gems for all occasions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>