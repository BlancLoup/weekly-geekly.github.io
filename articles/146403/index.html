<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About the MultiWii flight controller (copters, airplanes and helicopters)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ATTENTION, the article is outdated, but it can still be used for informational purposes. 
 I wanted to suddenly tell more about the open and free proj...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About the MultiWii flight controller (copters, airplanes and helicopters)</h1><div class="post__text post__text-html js-mediator-article">  <b>ATTENTION, the article is outdated, but it can still be used for informational purposes.</b> <br><img src="https://habrastorage.org/storage2/2f6/4ec/d68/2f64ecd68101c8b3dd5540555229af9f.gif" align="left">  I wanted to suddenly tell more about the open and free project to control various aircraft (LA).  Generally, until recently it was designed only for multirotone systems (copters), stabilization of the camera suspension and in the beta version was stabilization for the flying wing, but judging by the dev firmware, airplanes and helicopters will soon be added, and stabilization of the flight of the flying wing is already out from beta testing. <a name="habracut"></a><br><br><h4>  A little background </h4><br>  At the very beginning of the development of the project there was a big problem with sensors - they simply did not exist or were, but at incredibly high prices, therefore the Wii Motion Plus (WMP) from the Nintendo Wii console became the first sensor for this flight controller, and from here went prefix Wii in the title.  But as time went on, sensors became cheaper and now very few people use controllers from the console to create their MultiWii controller. <br><br><h4>  Components </h4><br>  The main brain of the controller is the AVR processor, or rather, a simple Arduino shawl, to which various sensors cling to the I2C port.  At the moment, to fly, you need any Arduino compatible board and a <b>gyroscope</b> , for example, ITG3205 is sawed (this is not slang, but I literally sawed out) from a Chinese clone of the WMP controller, but in this configuration it will be quite difficult to manage the copter parallel to the ground (and therefore eliminate the drift) will have to hands.  And here comes the <b>accelerometer</b> , which always knows where the "bottom" comes to, i.e.  land, and help keep the aircraft parallel to the ground.  Thus, for a quiet and stable flight, Arduino and two three-axis sensors are needed: a gyroscope and an accelerometer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/fb5/986/df3/fb5986df3a7312f0b10a4bc75fe74a61.jpg"><br><br>  Additionally, you can add sensors such as a magnetometer, a barometer and a GPS receiver. <br>  <b>The magnetometer</b> (also known as compass) knows how the aircraft is rotated relative to the direction of the earth‚Äôs magnetic field and can help with heading, GPS navigation or carefree mode for beginners, when, regardless of the direction of the real nose of the device, the copter will fly from the pilot to the command ‚Äúforward‚Äù "And to the pilot on the" back "command.  The magnetometer is very negatively affected by magnetic fields from power sources, wires, motors and everything that electromagnetic waves can produce, so when designing an LA frame, this sensor should be located as far as possible from everything metallic and magnetized. <br>  <b>A barometer</b> (also known as an atmospheric pressure sensor) may be useful for maintaining altitude, but it is worth considering that altitude retention directly depends on the sensor accuracy, for example, BMP085 (installed in many flight controllers) will give an accuracy of no more than + -1 meter, i.e.  under the best of conditions, your aircraft will float at a height of 1 meter or more.  More modern sensor MS5611 can give accuracy up to 10 cm.  Any changes in pressure around the wind, wind or air flow from the propellers can influence the barometer, so it is recommended to put this sensor ‚Äúunder the hood‚Äù or stick a piece of foam rubber to it (as on microphones), but it is very important not to close the opening in the sensor (for example, filling there glue). <br>  <b>GPS receiver</b> , useful and at the same time useless thing.  On the one hand, it helps to include such good things as holding a position and returning to the starting point (returning home), and on the other, this very point is very approximate and depends on the accuracy of the receiver, the number of visible satellites or weather conditions, so hanging <s>around the window of the women's locker room</s> can turn out in a circle with a diameter of about 3-10 meters (and when adding a good barometer in a flattened ball). <br>  At the time of this writing, there are attempts to add a sonar (ultrasonic range finder) and an optical displacement sensor (which are installed in mice).  <b>Sonar</b> will allow you to achieve very accurate height retention (about 1 cm) at a low height (up to about 3 meters), but very much depends on the surface, for example, tall grass or mounds will give interference and abrupt height changes, i.e.  the jumper will bounce or drop sharply.  But an <b>optical sensor</b> can help a GPS receiver to more accurately hold a position. <br>  The project boasts a large number of supported sensors for various purposes and with each release their number increases, and given the openness of the project, you can attach your own sensors. <br>  Here is a list of them, officially supported in the MultiWii 2.0 firmware (and in the last in the develop firmware): <br><table><tbody><tr><th>  Gyroscopes </th><th>  Accelerometers </th><th>  Barometers </th><th>  Magnetometers </th></tr><tr><td>  Wmp <br>  ITG3200 <br>  L3G4200D <br>  (MPU6050) </td><td>  MMA745 <br>  ADXL345 <br>  BMA020 <br>  BMA180 <br>  NUNCHACK <br>  LIS3LV02 <br>  LSM303DLx_ACC </td><td>  BMP085 <br>  MS561101BA </td><td>  HMC5843 <br>  HMC5883 <br>  AK8975 <br>  MAG3110 </td></tr></tbody></table><br><br><h4>  Ready controller cards </h4><br>  As I wrote above, you can make your controller from the set of available sensors and Arduino, but it is easier (and often more profitable) to buy a ready-made shawl, which already has an AVR chip and a set of necessary sensors. <br>  The most popular motherboard is the Crius MultiWii, available in two versions of Lite and Standart Edition, and a new version has just appeared, which differs only in the presence of a convenient I2C input and a smaller size. <br>  Crius MultiWii Lite Edition has only 2 sensors on board: a gyroscope and an accelerometer.  Standart Edition, besides Lite sensors, boasts a BMP085 barometer and a compass.  The new version of the board has an I2C connector for connecting a GPS module, which is a UART GPS receiver and an AVR chip (Arduino), which acts as an intermediary between the GPS and MultiWii controller (and in the foreseeable future, will completely take over the GPS functionality to unload the main brain) . <br>  In some online stores you can find other similar controllers, so if you come across something with 2 or 4 sensors and a 328p chip (or 1280/2560), then with a 99% probability this is a MultiWii controller. <br><br><h5>  Crius pin description and connection details </h5><br>  I hope you have already <a href="http://habrahabr.ru/post/141669/">read</a> <a href="http://habrahabr.ru/post/120266/">my</a> <a href="http://habrahabr.ru/post/120332/">articles</a> about <a href="http://habrahabr.ru/post/144788/">copters</a> and you know that the speed controllers and the remote control receiver are connected to the controller, and you can also attach the camera suspension stabilization control servos. <br><img src="https://habrastorage.org/storage2/df0/59a/f3c/df059af3c8ded59136ce91ac3d9b486a.jpg"><br>  The picture highlighted connectors for connecting the above devices.  As you can see, each connector combines 3 pins: <b>S</b> - signal, <b>+</b> - power (+ 5v) and <b>G</b> - ground.  Also, the connectors have inscriptions of the form <b>A</b> digit and <b>D</b> digit - they are connected to the speed controllers, servos and sometimes additional channels of the radio control receiver (correspond to the outputs on the Arduino).  Inputs marked as THR, ROLL, PITCH, YAW, MODE are designed to connect the corresponding outputs of the receiver. <br>  From each speed controller (ESC) there are 3 wires, one of which is + 5v (red or orange in the middle), but you only need to power the Crius board from one of the ESCs, and you can (and even need) power the remaining consumers: receiver and servo suspension.  To do this, you need to pull out the central wire of all (except one, which will power the board) speed controllers from the connector and connect them to consumers or isolate them. <br>  To connect to other consumers, you can break off 2 contacts from the comb and solder them together: <br><img src="https://habrastorage.org/storage2/afb/27a/692/afb27a6921002e4dcd9907fecbb5f6ce.jpg"><br><br>  And then connect the power wire from the speed controller with the power cord of the consumer and tighten them in shrink: <br><img src="https://habrastorage.org/storage2/cb6/c4b/c1c/cb6c4bc1c887c27dbf9ceeb1c6f56137.jpg"><br><br>  Similarly, you can do with unnecessary wires, folding the red wire in half and insulating it with heat shrink: <br><img src="https://habrastorage.org/storage2/ce9/52b/dc2/ce952bdc2b74ad533c9d77aa60a95d34.jpg"><br><br>  Included with the controller is a set of wires - they must be used to connect the receiver, it is enough to connect only the signal wires, one common contact (ground) and connect the power wire from one of the speed controllers. <br><br><h4>  The nuances of setting MultiWii </h4><br>  First of all, it is worth updating the firmware of the received controller, for this it is enough to download the firmware from the <a href="http://code.google.com/p/multiwii/downloads/list">official</a> MultiWii <a href="http://code.google.com/p/multiwii/downloads/list">repository</a> (please do not download the DEV version if you do not know what it is and why), upload it to the <a href="http://arduino.cc/hu/Main/Software">Arduino IDE</a> , adjust the parameters of your aircraft and select a set of sensors in the config.h file, then load the resulting sketch into the controller by selecting one of the boards with the 328p chip in the settings (but not the arduino UNO). <br>  With the version of MultiWii 2.0, Crius controllers appeared in the list of sensor sets: <br> <code>//#define CRIUS_LITE // Crius MultiWii Lite</code> <br> <code>//#define CRIUS_SE // Crius MultiWii SE</code> <br>  Uncomment one of them that matches your controller type. <br>  There are several very frequent problems for newbies (relevant for version 2.0): <br><ul><li>  For a hexocopter, the receiver does not work - in config.h it requires uncommenting the line # define A0_A1_PIN_HEX, and to activate the additional RU channel, you can uncomment one of the lines #define RCAUXPIN8 or #define RCAUXPIN12 and connect the receiver channel to D8 or D12 </li><li>  Not all motors work or not synchronous work - you need to calibrate the speed regulators, for this you need to connect all the signal and all common (ground) contacts and connect them to the Throttle channel (CH3) of the receiver, as well as connect one of the power wires, and then calibrate speed regulator according to the instructions for it, but usually you need to set the throttle to the maximum position, apply power to the speed regulators (I hope the screws did not forget to remove? otherwise it will be very painful), then lower the throttle to the bottom (minimum)  lying </li><li>  The motors rotate in the wrong direction - you need to change any 2 contacts coming from the speed controller to the motor </li><li>  Motors are not activated - check the settings of the switchgear, for this in the MultiWii configurator check that the extreme positions of the knob correspond to 1000 and 2000, and the center position is 1500, if it is not, correct it, then recalibrate the speed controllers </li></ul><br><br><h4>  Graphic Configurator </h4><br>  The graphical configurator is written in <a href="http://processing.org/">processing</a> and is a cross-platform Java application, currently compiled for Linux, Windows and MacOS operating systems 32 and 64 bit architectures. <br><br><img src="https://habrastorage.org/storage2/75f/619/fac/75f619face4df20359dda36bb4ee9594.png"><br>  The appearance is a bit scary, but often you don‚Äôt have to climb here.  Run the configurator after inserting the flight controller into the computer.  In the upper left corner, select the controller port and press the START button - the curves on the graph and the numbers next to it should run (ideally, everything should be smooth). <br><br><img src="https://habrastorage.org/storage2/3bc/ca5/ac3/3bcca5ac375e35b5797cdf8a8f02418f.png"><br>  To the right of the graph there is a volume model of your copter, as well as indicators of the compass and tilt of the device.  If the device is parallel to the horizon, and in the picture PITCH and ROLL are tilted - press the CALIB_ACC button so that the controller remembers this position and always strives for it. <br><br><img src="https://habrastorage.org/storage2/e81/362/423/e81362423c99588d5f6b3dd614a0b5ef.png"><br>  Above the graph, the PID controller settings, modes activation and some status data are located.  To see the values, you need to press the READ button, to change them, click on the window with the number and move it with the mouse, and to save, click WRITE.  Never change a few PID values ‚Äã‚Äãof a regulator for 1 time - otherwise you will not understand what has become better or worse.  What and how to twist can be read <a href="http://airm.ru/articles/2">here</a> . <br><br>  A more detailed description can be found on the <a href="http://multiwii.com/">official website of the MultiWii project</a> or on my website <a href="http://airm.ru/articles/2">airm.ru</a> , where I try to keep the same information in Russian, as well as many additions and news about the project. <br><br><h4>  What, where, how much? </h4><br>  All described controllers can be easily found on <a href="http://www.ebay.com/sch/i.html%3F_nkw%3DMultiWii">ebay</a> , <a href="http://www.aliexpress.com/wholesale%3FSearchText%3DMultiWii">aliexpress</a> , <a href="http://www.goodluckbuy.com/index.php%3Ftarget%3Dproducts%26mode%3Dsearch%26q%3DMultiWii">goodluckbuy</a> or <a href="http://www.rctimer.com/index.php%3FgOo%3Dgoods_search_list.dwt%26gkey%3DMultiWii">rctimer</a> <br>  The price can vary from 25 to 100 dollars, depending on the store and arrogance. <br><br><h4>  Flying with GPS </h4><br>  More than a year ago, I promised to fly by GPS, along a route, and other navigation bonuses.  So far, on the MultiWii controller it has been possible to test holding a position. <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Xb-LD_chyXw%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhgy1M5LLIXImgK_ENAMczEzcsV-TQ" frameborder="0" allowfullscreen=""></iframe><br>  In general, not bad, the copter swam in a circle with a radius of about 7 meters (did not set anything up in advance), but then suddenly pulled somewhere far away from me and the tests were postponed. <br>  But he began to gradually master the photo and video shooting from the air. <br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/xjfsysCHgO0%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhjFIscdO3KVPxoBA2QhDeg4plE51w" frameborder="0" allowfullscreen=""></iframe><br>  It turns out so-so, but still 2/3 of the summer ahead and a lot of plans, including a separate console for the operator. <br><table><tbody><tr><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/7bd/09c/972/7bd09c972d6fbe20bbba27b09ecb33ce.jpg"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b27/16f/ebe/b2716febe86986d2b9c68cfef5505f4c.jpg"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/cbd/ddb/674/cbdddb674ec2606392b33f2c5676412c.jpg"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/eff/d39/d9e/effd39d9ebf7278cb041fd6bb3b8131a.jpg"></a> </td></tr></tbody></table><br><br>  Ask questions, if any, try to answer and supplement this article. </div><p>Source: <a href="https://habr.com/ru/post/146403/">https://habr.com/ru/post/146403/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146397/index.html">Regular shots taken by Nokia PureView</a></li>
<li><a href="../146398/index.html">Canonical asked to do support for Retina-displays</a></li>
<li><a href="../146400/index.html">PayPal will pay for bugs found in its system</a></li>
<li><a href="../146401/index.html">The closure of the emulator Diablo III Blizzards</a></li>
<li><a href="../146402/index.html">Development of a startup in 24 hours at AngelHack 2012</a></li>
<li><a href="../146404/index.html">Once again about WOL</a></li>
<li><a href="../146405/index.html">CoffeeScript: Classes</a></li>
<li><a href="../146407/index.html">Nokia fires some Qt developers</a></li>
<li><a href="../146408/index.html">History of a single file manager</a></li>
<li><a href="../146409/index.html">Google Maps API reduces prices by 8 times</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>