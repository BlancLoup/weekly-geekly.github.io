<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to create a reliable game mechanics in Excel. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this part, we will solve the problem of optimal placement of weapons on the tank, the spatial location of teleports in the MMORPG and balance the b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to create a reliable game mechanics in Excel. Part 2</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/uz/nc/jb/uzncjbvwkyi9mqataguysd8pjai.png"></div><br>  In this part, we will solve the problem of optimal placement of weapons on the tank, the spatial location of teleports in the MMORPG and balance the battles of four classes of RPG characters. <br><br><h2>  Object location tasks </h2><br>  <i>Spreadsheets for this part can be downloaded here: ( <a href="https://app.box.com/s/aou5vsocupc72h5ivvhd">SuperTank</a> ) ( <a href="https://app.box.com/s/e96dctsvg1r3mvj07box">teleports, part 1</a> ) ( <a href="https://app.box.com/s/m8z8d8be3osr1ijrts4w">teleports, part 2</a> )</i> <br><br><h2>  SuperTank: problem solved! </h2><br>  In the <a href="https://habr.com/post/429258/">first article of the</a> series, we talked about an example of a task for a game called SuperTank.  In the second part, we got acquainted with the basic concepts of solution modeling and I talked about solving a simple example using the Find Solutions tool in Excel. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now we can apply the knowledge obtained in the second part to the SuperTank problem, and prove that with their help this problem can be solved easily and quickly.  Refresh your memory: SuperTank is a game in which you can fight in a custom tank. <a name="habracut"></a>  Supertank looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fb8/a6c/2fc/fb8a6c2fcddbb776a18893059f989afc.jpg"></div><br>  Each supertank can have any number of guns of five different types: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/62e/717/050/62e717050c0d1e991663a3e9ef2dfc39.png"></div><br>  The supertank can fit 50 tons of weapons, and the player can spend 100 credits.  Also, the supertank has 3 "critical slots" in which special guns such as the MegaRocket and UltraLaser are placed. <br><br>  The spreadsheet for this example can be downloaded <a href="https://app.box.com/s/aou5vsocupc72h5ivvhd">here</a> . <br><br>  The goal is to pick up weapons that maximize damage inflicted by supertank, without going beyond the limits of 50 tons, 100 credits and 3 critical slots.  We also assume that this table contains all the necessary information, and that such factors as range, frequency and accuracy of shooting are irrelevant or have already been taken into account in the Damage parameter of the corresponding weapon. <br><br>  To optimize this scheme, we first enter this data into a spreadsheet.  Immediately below it, we will add another table, in which there will be a set of 5 "quantitative" cells to indicate the number of each of the 5 types of weapons. <br><br>  For now, we will enter the value 1 in these cells, just to test their work, but these will be our decision cells ‚Äî we will ask the Solver tool to find the correct values ‚Äã‚Äãfor these cells.  It is possible to understand that these are decision cells by the yellow color, because we continue to follow the formatting rules set forth in the second part.  To the right of the ‚Äúquantitative‚Äù cells, we will add calculation cells, which will multiply the values ‚Äã‚Äãof the number in the decision cells by the values ‚Äã‚Äãof Damage, Weight, Cost and Critical Slots from the table above.  Thus, each row of this table will correctly display the damage, weight, price and critical slots required for all used guns in all categories of weapons. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f4e/342/27a/f4e34227a58768ee4d0a4f79fe6954e3.png"></div><br>  We will also create a section below that summarizes all the values ‚Äã‚Äãof quantity, weight, cost and critical slots from the table above, and compare them with the maximum values ‚Äã‚Äãof weight, cost and critical slots specified in the problem conditions (50, 100 and 3, respectively). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f6/76d/b7e/7f676db7e7034d6b9a02be24c5a1eb4b.png"></div><br>  In accordance with the formatting rules from the second part of the article, the blue cells at the top are the criteria from the conditions of the problem.  Gray cells are calculation cells that represent the total values ‚Äã‚Äãof weight, cost, and critical slots based on the summation from the quantity table (that is, the total values ‚Äã‚Äãof the columns Weight x Quantity, Cost x Quantity, and Critical Slots x Quantity).  Finally, the orange cell represents the total damage of our supertank, based on the total damage of the Damage x Quantity column from the table above. <br><br>  Before we proceed to the solution, let's make our spreadsheet more user friendly.  We will use Excel's ability to give each cell a name and give clear names to the seven cells in the last calculation table.  This is optional, but in the long run this will make the spreadsheet look much clearer (for example, if instead of $ F $ 21, the cell is called MaxCriticalSlots).  To do this, we simply select the cell and go to the name input field to the left of the formula field, and enter a new name. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/295/3bc/e19/2953bce19ac48c3e2ed4920edbb1e26b.png"></div><br>  Now let's finally go to Excel Solver and find the solution (go to the right side of the Data tab and select Solver.) If you don‚Äôt see it, go to Excel Options , select the Add-Ins category (‚ÄúAdd-ins‚Äù), make sure that Excel Add-Ins is selected in the Manage drop-down list, click Go, and make sure that The Solver Add-in checkbox is selected. <br><br>  In the Set Objective field (‚ÄúOptimize the target function‚Äù) we will select the orange target cell, and below we will click on the Max radio button.  In the By Changing Variable Cells field, select the decision cells (the yellow cells in the Quantity column of the second table).  Below, click on the Add button (‚ÄúAdd‚Äù) to add the following restrictions: <br><br><ul><li>  The values ‚Äã‚Äãof the decision cells must be in the range from 0 to some reasonable maximum (we chose 50, even though this is probably a much larger limit value than necessary).  It is also necessary to set the restriction "= integer" ("whole") for each cell of the solution, because we cannot have a fractional part of the armament, and Excel Solver considers each variable as a real number by default, unless you specify the opposite. </li></ul><br><ul><li>  We also need to limit the values ‚Äã‚Äãof the total cost, total weight and total number of critical slots to the values ‚Äã‚Äãfrom the conditions of the problem.  The image of the dialog box shows that they now have convenient names that we added to the lower table, making the dialog box easier to read. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b88/86b/402/b8886b40290a1c34dd36245276ef9930.png"></div><br>  Now we will click on the Solve button (‚ÄúFind solution‚Äù) and after a short wait Solver will fill in the Quantity values, which will give us the following: <br><br><ul><li>  1 Machine Gun </li><li>  3 rockets </li><li>  2 MegaRockets </li><li>  1 Laser </li><li>  1 UltraLaser </li></ul><br>  All this gives us a total loss of 83 units and takes exactly 50 tons, 100 credits and 3 critical slots.  You can see that the best solution does not change from the Solver runtime.  If you reset these values ‚Äã‚Äãand re-optimize, or go to Options and change the seed, we still get the same values.  We cannot be 100% sure that this solution is optimal, but given the fact that Solver did not manage to improve it after several passes of optimization, then with high probability it is a real optimum, and not just a local maximum. <br><br>  Problem solved! <br><br><h2>  Additional uses </h2><br>  The great thing here is that we not only solved the problem much faster than we would have done it manually, but also set it up in such a way that it would allow us to test which weapon in the SuperTank game would be most useful with different parameters (weight, cost, critical slots).  This means that we can relatively easily change the effect of various changes on these parameters on the SuperTank game, and if we want to add a new alternative model of supertank, which will be easier, harder or have a different number of critical slots, then this can be done very simply. <br><br>  By changing all these parameters, we can also get an understanding of the relative utility of each of these weapons, and quickly determine which of them is too useful, not enough, has a price that is inappropriate to its weight and damage, and so on. <br><br>  Again, the point is that such a tool allows us to search the design space much faster than we could manually.  It provides us with a convenient opportunity to evaluate the effect of such changes with any incremental design solution that we can come up with, whether it is changing the parameters of the weapon or the supertank itself, adding new weapons or models of supertanks, as well as adding new parameters (let's say the size limit in cubic meters). <br><br>  To understand what I mean, go to the blue ‚ÄúMax Cost‚Äù cell and change its value from 100 to 99. Now start Solver again and you will get a completely different weapon placement pattern: <br><br><ul><li>  0 machine guns </li><li>  2 rockets </li><li>  3 MegaRockets </li><li>  3 lasers </li><li>  0 UltraLasers </li></ul><br>  Such a scheme gives a slightly smaller damage indicator (82 instead of 83), but it is radically different from the previous one. <br><br>  If we set the Max Cost value to 101 or 102, and perform the calculation again, then there is a probability that we will get a configuration similar to the first one or coinciding with it;  Be that as it may, the damage will remain equal to 83 (the schemes may vary, because in such cases there are several optimal schemes).  However, if you set Max Cost to 103, you should get the following: <br><br><ul><li>  1 Machine Gun </li><li>  4 rockets </li><li>  2 MegaRockets </li><li>  0 lasers </li><li>  1 UltraLaser </li></ul><br>  That increases the total damage to 84. <br><br>  This is interesting: such a weapon deployment scheme is very different from the first two. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/106/807/611/106807611d9a60e93d06f9ddeca3f7f6.png"></div><br>  As you see, we get an unexpected result: the optimal choice of weapons in our scheme strongly depends on the parameters of the supertank and can change significantly even with small changes in these parameters.  In addition, it gives us all sorts of useful information: all five types of weapons are useful in at least two of the three supertank settings, and Rockets and MegaRockets are obviously useful in all three.  It seems that this tells us that all five types of weapons are well balanced, that is, useful in relation to each other, and at the same time they remain unique. <br><br>  And as you can also see, similar modeling and solution optimization provide us with an excellent opportunity to quickly perform a search in a local neighborhood and re-optimization.  For some types of tasks, it will allow us to detect the dominant strategies and exploits of players that are difficult or impossible to find in any other way. <br><br><h2>  Wormhole Teleports </h2><br>  Looking at the last two examples (example with tax rates in a strategic game and SuperTank), you might think that such techniques are applicable only in cases when users deal with numbers.  But you will be absolutely wrong!  As we will see, there are many examples of the fact that you can benefit from the optimization of design elements that not only do not look like numbers to users, but do not look like them at all! <br><br>  You may also think that decision modeling applies only to decisions that players can make in games.  This is also not true: in some cases they can be used for modeling in order to optimize your own solutions as a designer. <br><br>  Let's say you are working on a space MMORPG.  One day, your lead designer approaches you with visible anxiety on your face.  ‚ÄúWe are completing the redesign of the Omega sector,‚Äù he says.  ‚ÄúAnd we had a problem.  We are planning to add several ‚ÄúWormhole‚Äù teleports in this segment of the world, but we cannot agree on where to place them. ‚Äù <br><br>  ‚ÄúHow many teleports?‚Äù You ask. <br><br>  ‚ÄúWe don't know yet.  Probably three, but they can be from two to four.  We are not sure yet. ‚Äù  Then he shows you a map that looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0db/a6e/bc1/0dba6ebc16043666d174e5b3269a2965.png"></div><br>  ‚ÄúWhat is this?‚Äù You ask. <br><br>  ‚ÄúThis is a map of the Omega sector.  Or at least the star systems that a player can visit in this quadrant.  We need to determine in which cells the wormholes should be. ‚Äù <br><br>  ‚ÄúWell, okay, but according to what rules are they located?  Can a wormhole be placed in the same quadrant with a star system? ‚Äù <br><br>  ‚ÄúWe want you to place the wormhole in such a way as to minimize the distance from any star system to the nearest wormhole.‚Äù  And yes, you can put them in the same quadrant as the star system;  these are just small teleports hanging in space, so they can be placed anywhere.  And remember that we have not yet decided how many there should be, so give me solutions for 2, 3, and 4 wormholes. ‚Äù <br><br>  How to formulate this problem, and how to solve it? <br><br><h2>  Optimize teleports! </h2><br>  Let's start by preparing the solution cells.  Denote four teleports as A, B, C, and D. We know that each teleport is essentially nothing more than the coordinates (x, y) on the star map of the Omega sector.  We also know that we will need some way to specify the number of active teleports, so we will add a cell that allows us to specify the number of teleports.  We use teleport D only when 4 ‚Äúwormholes‚Äù are used, and C - only when we have 3 or more. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e25/6b2/68d/e256b268da6878a1a79c14d2b7bfeb48.png"></div><br>  Below we will prepare a table for calculating the distance from each star system to the nearest teleport.  This table looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cdf/4d8/410/cdf4d8410caa870a35ce2dfbe2f2be19.png"></div><br>  The left blue shows the coordinates of each star system on the map.  Each line is one star system.  We simply transferred them from the Omega sector map, which was given to us by the leading designer. <br><br>  On the right, we calculate the distance to each of the four teleports.  This is just the Pythagorean theorem.  The distance is calculated as the square root of the horizontal and vertical distance between the star system and the teleport: <br><br><blockquote>  <b>= SQRT (($ B14-Ax) ^ 2 + ($ C14-Ay) ^ 2)</b> </blockquote><br>  (Do not worry - I promise that this is the most difficult mathematics we will meet in the series!) <br><br>  We take the X and Y coordinates of each star system from the blue cells of the table above, and the X and Y coordinates of each teleport (the cells with the names Ax and Ay for teleport A in the above SQRT () function) from the yellow solution cells above. <br><br>  Finally, we take the minimum of these four values ‚Äã‚Äãin the Dist to Closest column, that is, we simply use the MIN () function to determine the minimum of the four values ‚Äã‚Äãon the left.  Then we summarize the whole column below;  sum is the target cell. <br><br>  You may have noticed that in the screenshot above, all the cells are Dist to D. The reason is that we use the ‚ÄúNumber of Teleporters?‚Äù Cell in the upper section of the decision model, which allows you to adjust the number of teleports to be counted.  If the number of teleports is 2, then we use the value 99 in both Dist to C and Dist to D, and if it is 3, then the value 99 is used only in the Dist to D. column. Due to this, each star system will ignore all the extra teleports. when calculating the distance to the nearest teleport in the case of 2 or 3 teleports. <br><br>  Now we will launch Solver: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/526/3f6/35c/5263f635cf3425abfe0f6ede918faf68.png"></div><br>  The target cell is the sum at the bottom of the Dist to Closest column.  Note that unlike other examples, here we want to use the ‚ÄúTo: Min‚Äù radio button, because we need the minimum distance between all star systems and teleports, and not the maximum. <br><br>  Below, we will specify eight yellow cells of X and Y coordinates of wormholes A, B, C and D as the decision cells (‚ÄúBy Changing Variable Cells‚Äù). In the restrictions section, we limit each of the coordinates as an integer value in the range from 0 to 12. Notice that we use an integer constraint for these decision cells, because we mean that the lead designer just wants to know which cell each teleport will be in, but we can easily skip this constraint if the designer needed real coordinates. <br><br>  If we set the values ‚Äã‚Äãof 2, 3, and 4 for ‚ÄúNumber of Teleporters?‚Äù And sequentially run Solver at each value, we get the following configurations: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fb3/705/3d0/fb37053d0bb564a0ec27a7a45e4e8c32.png"></div><br>  With this information, we can go to the lead designer and show him the optimal places for locating any number of teleports in the range from 2 to 4. Here‚Äôs how the optimal wormhole locations for 2, 3 and 4 teleports look on the map (shown in green). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ca/08d/551/6ca08d5517b7f57754deab8408117e19.png"></div><br>  The spreadsheet for this example can be downloaded <a href="https://app.box.com/s/e96dctsvg1r3mvj07box">from here</a> . <br><br><h2>  Did I talk about ninjas? </h2><br>  ‚ÄúAmazing,‚Äù says the lead designer, but you see suffering on his face.  ‚ÄúUh, but I forgot to tell you that some of these systems are populated by space ninjas.  And we want systems with ninjas to be further from wormholes, so that players do not feel overly threatened. ‚Äù <br><br>  ‚ÄúWow.  It completely changes things. ‚Äù <br><br>  ‚ÄúExactly.  In addition, in some star systems there are not one, but two colonies, that is, it is twice as important for them to be close to teleports.  Or it is twice as important to be farther away if it is a system with two space ninja colonies.  Here is what the map looks like now: " <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ab/b1c/2de/1abb1c2dea24fc72efbf45d034cb2fdb.png"></div><br>  He continues: ‚ÄúEvery negative number is a space ninja colony.  The system with the number 2 contains two human colonies, and with the number -2 there are two ninja colonies.  Can you tell me where to place the teleporters in this case? ‚Äù <br><br>  ‚ÄúTell me, well, at least you have already decided how many teleports will be: 2, 3 or 4?‚Äù, You ask sarcally. <br><br>  "I'm afraid not yet." <br><br><h2>  We decide taking into account the ninja </h2><br>  To solve this problem, we need to add a new column to the table, indicating the weights of the table.  We will call it a multiplier.  We will simply multiply this value by the value in the ‚ÄúDist to Closest‚Äù column. <br><br>  When we do this, Dist to Closest slightly changes its meaning.  Now this is not the distance to the nearest star system, because for star systems of ninjas the value changes by a factor of -1.  It is more like generalized "points" (score), so let's call them that. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/667/7e8/edd/6677e8edddd9fa2ac4fecf1ae499f069.png"></div><br>  Thus, points now represent the cumulative value.  By minimizing it, we make sure that Solver strives to be as close as possible to systems with human colonies and at the same time as far as possible from populated ninja systems. <br><br>  Now we get the following results: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/910/372/a85/910372a8558cafb6e62a3b9298c230fc.png"></div><br>  As you can see, this gives us a configuration of teleports, in each case very different from simpler versions without ninjas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/92a/1a4/727/92a1a4727400d6279a03988381e75f5b.png"></div><br>  The spreadsheet for this enhanced version of the teleport example can be downloaded <a href="https://app.box.com/s/m8z8d8be3osr1ijrts4w">from here</a> . <br><br>  As you can see, our solution model was able to quickly solve this non-trivial task, and we can adapt it to changing requirements. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This task belongs to a class of tasks, called ‚Äúobject location problems‚Äù, which are very well studied in the field of operational management. </font><font style="vertical-align: inherit;">But as you can see, they can potentially be used in game design as well as in level design, and the solution is simple (if not trivial) in Excel.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Balancing classes for battles Player-vs-Player </font></font></h2><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The spreadsheet for this part can be downloaded from here: </font></font><a href="https://app.box.com/s/l3y8j73tdvjm21f3h0io"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a></i> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Spreadsheets and Simulations </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the previous three parts of this series of articles, we became acquainted with the concept of modeling and optimization of solutions, as well as with the tool ‚ÄúSearch for solutions‚Äù (Solver) of Excel. We showed how they can be used to calculate the optimal city tax rates in 4X strategies, to determine the optimal placement of teleports in the space game and to select the optimal weapon layout for the supertank task described in the first part. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A natural question arises: what about balancing the game? Is it possible to apply such techniques to all kinds of complex balancing tasks that are found in many different types of games, in particular, in strategies, RPG and MMORPG?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The answer to this question: yes, of course, but with many reservations. Spreadsheets in particular have many limitations, because in most non-trivial cases they do not accurately describe the game. Therefore, it will be difficult for us to perform reliable balancing using optimization techniques; the real problems of balancing the vast majority of games will be far beyond what we can model in a spreadsheet. Simulation of the game itself is usually too complicated, it has a lot of ‚Äúmoving parts‚Äù and is often performed in real time. When trying to perform a discrete simulation, we can face all sorts of problems. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Therefore, if we wanted to use similar techniques for balancing classes in such MMORPGs as </font></font><a href="http://www.wildstar-online.com/en/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WildStar</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or in strategic games like</font></font><a href="http://www.uberent.com/pa/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Planetary Annihilation</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then to ensure at least some accuracy and utility, we would have to integrate them into the game simulation itself.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, the truth is that some aspects of balancing cannot be automated; as we explained in the</font></font><a href="https://habr.com/post/429258/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> first part of the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> article, the feel of the game is not automatically adjustable.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Therefore, the best we can hope for is a demonstration of a simple example that illustrates a general approach to tasks of this type: using a simple example in Excel, we will learn how to approach and optimize this type of balancing problem. </font><font style="vertical-align: inherit;">We show that, at least for an example of simple combat, Solver can do a good balance of several RPG classes relative to each other. </font><font style="vertical-align: inherit;">Then you can use this basic structure as a basis for solving such optimization problems with a more complex scheme and deeper integrated into the simulation of the game. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We hope that with us you will learn all the tricks and see what this simple example can give us.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Balancing not defined </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is no single, generally accepted definition of the word "balancing." It has many meanings, and the true one usually depends on the context of the game in question. In different conditions, balancing can be associated with setting up several classes of characters in order to equalize their capabilities in a role-playing game, with the number of opposing forces fighting against each other in a strategic game, or adjusting the cost of different units or resources in accordance with their usefulness. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The best definition of "balancing" usually depends on the design goals of the game in question, but since these goals can be any, it is impossible a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">priori to</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> determine what balancing actually means for games in general.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Some players tend to think that balancing in battle means equal damage. </font><font style="vertical-align: inherit;">This is especially true for the MMORPG, in which players often complain that the damage per second (DPS) damage of one class is too small or too large relative to others. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, classes cannot be balanced only by DPS; </font><font style="vertical-align: inherit;">It is acceptable that one class has more DPS than the other, but this should be compensated for by other factors that limit the overall utility of the class, for example, reduced survival or less long-term DPS compared to short-term DPS.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tiny MMO </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagine that we are creating a new project, a very simplified multiplayer massively online role-playing game called ‚ÄúTiny MMO‚Äù. </font><font style="vertical-align: inherit;">As part of the design, we strive to balance the four classes for player versus player (PVP) battles so that all four classes are relatively equal in battle against each other, and so that there is no obvious ‚Äúbest‚Äù or ‚Äúworst‚Äù class that You can fight against other classes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Although ‚ÄúTiny MMO‚Äù is a real-time game, each player‚Äôs action lasts for exactly 3 seconds, so we can sample it by presenting it as a turn-based game in which each turn is a three-second gameplay. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Players in this game can choose one of four classes of characters:</font></font><br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warrior (Warrior)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deals the most damage</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> casts spells at a distance and has the greatest attack range from all four classes.</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Healer (Healer) is</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> automatically treated, restoring for each move a certain part of their health</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Barbarian (Barbarian)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> has the most health</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is all that we know about these four classes, and we need to set the initial parameters of health (HP), damage, treatment and attack range for all four classes. </font><font style="vertical-align: inherit;">We need to balance them in such a way that each class is unique and its characteristics are significantly different from all other classes, but as a result, each class is as ‚Äúbalanced‚Äù as possible with respect to the three others. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In other words, we aim to optimize the following table:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2a5/bb2/b9a/2a5bb2b9a8a5b91eed643b89f168cd5f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For now, we use temporary values ‚Äã‚Äãand assume that each class starts with 50 HP, deals 10 points of damage per turn, cures 0 HP per turn, and has an attack range of 40 meters. Each character moves at a speed of 10 meters per turn. Since the design states that all four classes of characters can move at the same speed, we will consider this value constant, and we will not enter the movement speed in the table of decision variables.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviously, this is a training example with a very simplified damage model. This is a continuous average damage value per second, which ignores the differences in impulse damage from long-term damage, as well as mana and other mechanics that modify the attacking abilities of classes. We will have only one type of damage, which is rather unrealistic, because most classes have dozens of types of damage, and we will need to implement an AI system that chooses an attack in each turn. In addition, in most games, the damage has an element of chance, but for now we will omit it and assume that the variability of the damage is not so great as to significantly influence the outcome of the battle between the two classes.</font></font><br><br> ,  ,   Excel,         ;       .     -    <i></i>       Excel,               ,        ,    . <br><br><h2>   </h2><br>             .      4  (Warrior, Mage, Healer  Barbarian),    6    : <br><br><ul><li> Warrior ‚Äî Mage </li><li> Warrior ‚Äî Healer </li><li> Warrior ‚Äî Barbarian </li><li> Mage ‚Äî Healer </li><li> Mage ‚Äî Barbarian </li><li> Healer ‚Äî Barbarian </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Such balancing can be quite complex. </font><font style="vertical-align: inherit;">Even in our rather simple case with four classes, we have six interclass relations, just as we can draw six lines between four points of a square.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52f/bc5/6e2/52fbc56e2c50d662a5236a089c8c9fdc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Every time we want to make even a small change in one of the parameters of any of the classes, this change will also affect the balancing of PvP between this pair of classes and the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">other</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> two classes. </font><font style="vertical-align: inherit;">This power interconnectivity with an increase in the number of classes will only grow, and decisions about balancing PvP between any pair of classes made ‚Äúin vacuum‚Äù, without taking into account all other interactions, can become very dangerous. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ideally, we would like to create a certain </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">table of victories.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">like the one shown below. </font><font style="vertical-align: inherit;">If we can simulate a fight between each of these 6 pairs in a spreadsheet, then we will be able to generate a certain variable of ‚Äúpoints‚Äù for each of the 6 pairs. </font><font style="vertical-align: inherit;">The more points the better, so we can combine all these six points to generate a goal function.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b2f/b4f/6e8/b2fb4f6e8317a42dfc6696d1c41ade97.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notice that in the table shown above, the cells along the diagonals are zero, because they denote pairs of the same class, which will be balanced by definition. </font><font style="vertical-align: inherit;">In addition, the cells in the upper right corner are also zero, because they denote exactly the same pairs as in the cells in the lower left. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now let's prepare a model for the fight between two different classes.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "Battle Simulator" </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Place each pair of classes at a distance of 100 meters from each other. </font><font style="vertical-align: inherit;">Each character has 3 seconds to attack, so we can present this as a step-by-step simulation, in which each ‚Äúturn‚Äù means 3 seconds. </font><font style="vertical-align: inherit;">On each move, each character either attacks the other, if it is within the range of the attack, or continues to move, in order to shorten the distance. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The simulation looks like this:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3b1/7ce/236/3b17ce2366faaece720a363f57c261d9.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Above shows a pair of characters who joined the battle: in this case it is Mage (class 1) and Healer (class 2). </font><font style="vertical-align: inherit;">The left column shows the current distance between two simulated characters. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For each character, the columns will be as follows:</font></font><br><br><ul><li> <b>Max Range</b> :   ,     .           . </li><li> <b>Healing</b> :      ,      . </li><li> <b>HP</b> :      .      HP    ,        .         ,         . </li><li> <b>Damage</b> :  ,   ,       .   ,     0. </li><li> <b>Attacks?</b> :   ,       .  ,    ,      ;  ,    ,     . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thus, both characters begin to move towards each other, and then attack, until one or both of them die. Each character moves every 3 seconds for 5 meters (5 meters per ‚Äúturn‚Äù). When both characters move towards each other, the Range will change in each turn by 10 units, and by 5 units, if only one of them moves. The game itself is structured so that both characters can start moving at the same time, after which the move is allowed at the same time, so it is possible that both characters can die at the same time. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next, we need to set up scoring for this table and generate a numerical value indicating how ‚Äúgood‚Äù the fight was; in other words, how close we are to achieving our design goals.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviously, we want both characters to be dead by the end of the battle, or at least as close to death as possible. If the battle is balanced, then both of the fighting classes should minimize the health of the enemy at the end of the battle. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, this alone is not enough. If we organize scoring in this way, the optimizer will simply maximize the damage values ‚Äã‚Äãso that both characters instantly kill each other! (If you're curious, try changing the spreadsheet attached to the article to see for yourself.) Obviously, we are not aiming for instant death: we need both characters to be dead or almost dead by the end of the battle, but </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">at the same time</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we want the battle to last a reasonable amount of time.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In other words, we are not only striving to ensure a relatively equal balancing of all classes against each other; we also want to make the balance </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interesting</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , including that the battles last for the right amount of time. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To generate such a balance estimate, we need to create several cells to the right of each table. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Duration</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indicates the duration of the battle; it counts the number of rows in the table in which </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">both</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> characters are still alive. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total HP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calculates the total hit points of the two surviving characters. Ideally, it should be 0, that is, by the time the battle ends, both characters die.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/957/514/77c/95751477c6324ce2fc26e41c6979122a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I. Finally, Score combines the duration and total amount of hit points in the form (Duration / (1 + Total HP)). Notice that we added 1 to the divisor, because Total HP can be equal to 0, and in that case we would get a divide-by-zero error. Thus, we can guarantee that we reward the optimizer for finding the maximum battle duration </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and the</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> minimum value of the sum of hit points. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Note that since in each ‚Äúsimulation‚Äù of class versus class we have 17 lines. This means that we essentially made a design decision that the battle should last about 17 rounds. If we want the battle to be shorter or longer, you can change the number of rows, edit the formulas for estimating the score accordingly and perform the re-optimization.)</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally, we take these six Score values ‚Äã‚Äã(one for each table) and use them in the above ‚ÄúVictory Table‚Äù to show the results of the battle between each of the pairs of classes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can simply summarize these six scores and use the result as the final Score value. However, if we do this, Solver will most likely not be able to find a good balance between the highest and lowest grades for individual battles, and will also receive very high marks for some pairs of classes and low marks for others. We do not want this: we need </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all the</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ratings to be high and we strive to improve them all. To fix this, we multiply the sum of the estimates by the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">smallest</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> group evaluation (using the Excel MIN () function) to get Solver to focus on the estimates with the lowest value. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Add restrictions </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We have not finished yet. </font><font style="vertical-align: inherit;">If you optimize the decision model with the current parameters, then most likely the classes will be configured incorrectly - in fact, it is highly likely that the model will write the same values ‚Äã‚Äãof HP, Damage, Healing and Range in the table of decision variables. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And we, of course, want each class to have its own individuality. </font><font style="vertical-align: inherit;">We need Warrior to do the most damage, Mage has the largest Range, Healer has the highest Healing value, and Barbarian has the most HP. </font><font style="vertical-align: inherit;">We also want these differences not to be too small - we need these classes to be very different from each other.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To do this, we will create a small table of restrictions. </font><font style="vertical-align: inherit;">This table ensures that each of the four classes will have a corresponding attribute, and then give a rating of 0 or 1, depending on whether the restriction condition is satisfied.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/91a/a33/010/91aa330102f6855b19ddc62b21e4b1a3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Min difference table on the right indicates the minimum difference of each class attribute relative to all other classes. </font><font style="vertical-align: inherit;">In other words, Warrior must have at least 4 HP more damage than all other classes, Mage must have an attack range of at least 10 more, and so on. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now that we have added these special limitations, it is time to optimize!</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Searching of decisions </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we can run Excel's built-in Solver tool (‚ÄúSearch for Solutions‚Äù) to try to optimize the initial parameters. </font><font style="vertical-align: inherit;">As the goal cell, we will select the Score cell, which combines the results of all six tournaments. </font><font style="vertical-align: inherit;">We set the decision variables to include all 16 cells in the yellow Decision variables table that we created at the beginning. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We also set limits (in the Subject to the Constraints field) as follows:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> All decision cells must be integers with a minimum value of 0. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> All cells in the HP column must have a maximum value of 200 and a minimum of 30. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> All cells in the Damage column have a maximum value of 20. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> All cells in the Healing column have a maximum value of 15. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> All cells in the Range column have a maximum value of 100. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In addition, all four cells in a particular section of the Constraints must be set to 1 in order for their special conditions to be satisfied. </font></font></li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc0/cae/d5a/fc0caed5a1d370e16c71d9b2f3ef7933.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally, select the Evolutionary value for the Solving Method and launch Solver. </font><font style="vertical-align: inherit;">Consider, since this is an evolutionary algorithm, there is a possibility of improving the solution found during the second or third Solver run, or after setting the parameters (the Options button) for evolutionary optimization. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a result, we should have something like this:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ad/d71/2c6/0add712c65d58c0182fd01b362787d1c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... and how magic Solver gave us a good initial balance configuration. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you can see, Warrior now deals the most damage, the Mage has the greatest range, the Healer heals the best, and the Barbarian has the most HP. In addition, you can go down to the results of individual ‚Äúclass versus class‚Äù tournaments and see how classes have manifested themselves in battle with each other; as you can see, most of them are balanced very evenly - by the end of the battle both classes die, or one of them barely survives. In addition, all tournaments last long enough, none of the classes can not "voshotny" the other. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Not bad for a few hours, right?</font></font><br><br><h2>  Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this example, we created a simple balancing problem and demonstrated that in fact we can solve it using simulation and optimization. Although it is obvious that this is a simple example, it shows us the power of modeling and optimization techniques for solutions. In addition, it can be a source of inspiration, which can be used in more complex balancing tools, which are closely integrated into the simulation of the game. We hope that you will be able to use this example as a guide to the formulation of such tasks in practice.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the next two parts of the series, we will plunge into the task assignment area, which is associated with the choice of optimal assignments from two or more sets of entities. </font><font style="vertical-align: inherit;">We will show how to solve these types of tasks and demonstrate how this approach was used to create the design of the towers in our strategic game for iOS / Android </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">City Conquest</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div><p>Source: <a href="https://habr.com/ru/post/430114/">https://habr.com/ru/post/430114/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../430102/index.html">ENOG 15: "Why is the Internet still online?"</a></li>
<li><a href="../430104/index.html">Medical Data | Do not give out a medical card.</a></li>
<li><a href="../430106/index.html">New XYZprinting at IMTS 2018: 3D Printers and Robots</a></li>
<li><a href="../430108/index.html">Why "Young Technician" will not be able to build a laser</a></li>
<li><a href="../430112/index.html">How we learned to talk to millions of people</a></li>
<li><a href="../430116/index.html">Computers write prose, but still give way to people. Why?</a></li>
<li><a href="../430118/index.html">Unity3D: Modifying the delegate of an iOS application</a></li>
<li><a href="../430120/index.html">Tame the beast. What did we encounter when developing an application for keeping a personal journal on React Native?</a></li>
<li><a href="../430122/index.html">Workaholism is a painful condition that is not customary to talk about</a></li>
<li><a href="../430126/index.html">Another list of projects on what to practice</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>