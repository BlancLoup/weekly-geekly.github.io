<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What will happen if you mix nuts, Arduino, OpenCV and Delphi. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the first part, I tried to select nuts without OpenCV, and was wrong. 
 Programming in Delphi from the institute, starting with version 2, although...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What will happen if you mix nuts, Arduino, OpenCV and Delphi. Part 2</h1><div class="post__text post__text-html js-mediator-article">  In the <a href="http://habrahabr.ru/post/238629/">first</a> part, I tried to select nuts without OpenCV, and was wrong. <br>  Programming in Delphi from the institute, starting with version 2, although being fairly close familiar with other PLs, I nevertheless began to look for titles specifically for Delphi.  And <a href="https://github.com/Laex/Delphi-OpenCV">found</a> . <br>  Having compiled the EdgeDetect example, and seeing the results, I realized that OpenCV tool is really powerful, simple and fast.  Thanks to good people for the pascal header files to the C interface of this wonderful library, because they gave me the opportunity to write in the environment of my usual RAD.  Having decided on PL, I began to develop software from scratch, this article describes my victories and misadventures, and please, do not judge the pain, this is only my second article on Habr√©. <br><a name="habracut"></a><br>  The first rake was connected with a rather tangible memory leak: they were connected with the fact that after each cvFindContours you need to call cvClearMemStorage. <br>  Soon realizing that at 30 FPS, which gave out my Logitech C270, I could not detect the nuts in free fall, I began to look for high-speed cameras.  For the experiments, the PS3 Eye Camera was acquired, giving out transcendental 187 FPS at 320x240.  As a result, another feature was found - the draw limit of 65 FPS under Win7.  As it turned out, cvWaitKey is limiting - a solution was immediately found, namely: to call cvWaitKey not with each processed frame, but with a smaller frequency. <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><pre><code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> gettickcount-rendertickcount &gt;= <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-comment"><span class="hljs-comment">// 1000 / 33 = ~30 FPS //... rendertickcount := gettickcount; cc := cvWaitKey(1); end;</span></span></code> </pre> <br></div></div><br>  I will describe the algorithm itself. <br>  For each sample from the base, an ‚Äúalbum‚Äù of rotated samples was generated in 10-degree increments.  This makes it possible to store much less samples in the database of standards and not to waste resources on rotation ‚Äúon the fly‚Äù.  I implement the primitive perspective correction on the fly using cvResize. <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAlbum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(nsIndex:integer)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i : integer; rot_mat: pCvMat; scale: Double; center: TcvPoint2D32f; width, height : integer; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> nsamples[nsIndex] <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> width := nutimgs[<span class="hljs-number"><span class="hljs-number">0</span></span>].width; height := nutimgs[<span class="hljs-number"><span class="hljs-number">0</span></span>].height; center.x := width <span class="hljs-keyword"><span class="hljs-keyword">div</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; center.y := height <span class="hljs-keyword"><span class="hljs-keyword">div</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; scale := <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i:= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> nutimgs[i].width := width; nutimgs[i].height := height; rot_mat := cvCreateMat(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, CV_32FC1); cv2DRotationMatrix(center, i * <span class="hljs-number"><span class="hljs-number">10</span></span>, scale, rot_mat); cvWarpAffine(nutimgs[<span class="hljs-number"><span class="hljs-number">0</span></span>], nutimgs[i], rot_mat, CV_INTER_LINEAR <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> CV_WARP_FILL_OUTLIERS, cvScalarAll(<span class="hljs-number"><span class="hljs-number">0</span></span>)); cvReleaseMat(rot_mat); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre> <br></div></div><br>  As a result of the sliding of nuts along the grooves, they quickly stain these same grooves with fat, which is very rich.  This fact prevents more accurate finding of the contours of nuts.  I tried both simple cvThreshold and cvThreshold with cvCanny on top - it worked poorly on a dirty background.  Plus, the shadow, which was thrown by the nuts, hindered when spans at a small distance from the background.  To solve this problem, I came up with my filter.  Its essence is that it replaces the most "non-colored" pixels with white pixels. <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">removeBack</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> img: PIplImage; k:integer)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x, y :integer; sat: byte; framesize :integer; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> cvcvtColor(img, hsv, CV_BGR2HSV); x := <span class="hljs-number"><span class="hljs-number">1</span></span>; framesize := img.width * img.height * <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> x &lt;= framesize <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> sat := hsv.imageData[x]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> sat &lt; k <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> hsv.imageData[x-<span class="hljs-number"><span class="hljs-number">1</span></span>] := <span class="hljs-number"><span class="hljs-number">255</span></span>; hsv.imageData[x+<span class="hljs-number"><span class="hljs-number">1</span></span>] := <span class="hljs-number"><span class="hljs-number">255</span></span>; hsv.imageData[x] := <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; inc(x ,<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; cvcvtColor(hsv, img, CV_HSV2BGR); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br></div></div><br>  For nuts sliding on a white background, there is a contour.  A mask is made from the contour, which allows you to copy each nut with transparency into an array of PIplImage.  Too small and very large contours are skipped. <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><pre> <code class="delphi hljs"> frame := cvQueryFrame(capture); cvCopy(frame, oframe); cvCvtColor(frame, gframe, CV_BGR2GRAY); cvThreshold(gframe, gframe, LowThreshVal, HighThreshVal, CV_THRESH_BINARY_INV); cvFindContours(gframe, storage, @contours, SizeOf(TCvContour), CV_RETR_EXTERNAL, CV_CHAIN_APPROX_NONE, cvPoint(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)); b := contours; NutIndex := <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> b &lt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> asize := cvContourArea(b, CV_WHOLE_SEQ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((asize &gt; tbminObjSize) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (asize &lt; tbmaxObjSize)) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> _rect := cvBoundingRect(b); cvZero(mask); cvDrawContours(mask, b, CV_RGB(<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>), CV_RGB(<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), -<span class="hljs-number"><span class="hljs-number">1</span></span>, CV_FILLED, <span class="hljs-number"><span class="hljs-number">1</span></span>, cvPoint(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)); snuts[nutIndex].snut.width := _rect.width; snuts[nutIndex].snut.height := _rect.height; cvSetImageROI(oframe, _rect); cvSetImageROI(mask, _rect); cvZero(snuts[nutIndex].snut); cvCopy(oframe, snuts[nutIndex].snut, mask); cvResetImageROI(oframe); cvResetImageROI(mask); snuts[NutIndex].rect := _rect; inc(NutIndex); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; b := b.h_next; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br></div></div><br>  The frame is divided into regions-&gt; lines, in reality, these are separate gutters, along which nuts slide.  At the end of each line there is an actuator, which is a nozzle that controls the flow of air under pressure. <br>  In the application, each line is serviced by a separate thread (thread).  Inside the thread, we find the nut closest to the nozzle, and determine its ‚Äúsimilarity‚Äù with the base of the reference samples.  Below is a code section that considers ‚Äúsimilarity‚Äù via cvAbsDiff: <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><pre> <code class="delphi hljs"> cvAbsDiff(tnut, nsamples[tp1].nutimgs[angle], matchres); cvCvtColor(matchres, gmatchres, CV_BGR2GRAY); cvThreshold(gmatchres, gmatchres, tbminTreshM, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); wcount := cvCountNonZero(gmatchres);</code> </pre><br></div></div><br>  The value of the wcount variable is the coefficient of similarity between the nut and the standard in ‚Äúparrots‚Äù.  When this value is exceeded above the threshold, we transmit the line number through a com port in arduino.  The controller opens the nozzle for a specified time, than ‚Äúblows‚Äù the nut, in the normal state, the nozzle is closed.  For asynchronous operation of executive devices, the following sketch was written. <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">int</span></span> timeout = <span class="hljs-number"><span class="hljs-number">75</span></span>; <span class="hljs-type"><span class="hljs-type">int</span></span> comm; unsigned long timeStamps[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-type"><span class="hljs-type">int</span></span> ePins[] = {<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>}; <span class="hljs-type"><span class="hljs-type">void</span></span> setup() { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= <span class="hljs-number"><span class="hljs-number">7</span></span>; i++){ pinMode(ePins[i], OUTPUT); } <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">9600</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!<span class="hljs-type"><span class="hljs-type">Serial</span></span>) { ; // wait <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">serial</span></span> port <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span>. Needed <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Leonardo <span class="hljs-keyword"><span class="hljs-keyword">only</span></span> } } <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-type"><span class="hljs-type">Serial</span></span>.available() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { comm = <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (comm &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; comm &lt;= <span class="hljs-number"><span class="hljs-number">7</span></span>) { digitalWrite(ePins[comm], HIGH); timeStamps[comm] = millis(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (comm == <span class="hljs-number"><span class="hljs-number">66</span></span>) { <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(<span class="hljs-number"><span class="hljs-number">103</span></span>); // <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> device autodetection, <span class="hljs-number"><span class="hljs-number">103</span></span> means <span class="hljs-keyword"><span class="hljs-keyword">version</span></span> <span class="hljs-number"><span class="hljs-number">1.03</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= <span class="hljs-number"><span class="hljs-number">7</span></span>; i++){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (millis() - timeStamps[i] &gt;= timeout) { digitalWrite(ePins[i], LOW); } } }</code> </pre><br></div></div><br>  Nozzles are an electromagnetic solenoid.  We switch this load according to the following scheme.  Each nozzle needs a separate key. <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"> <a href="http://hostingkartinok.com/show-image.php%3Fid%3D65970dc9167610a81931d174ff2f5212" title="upload picture"><img src="https://habrastorage.org/getpro/habr/post_images/3e6/b40/9ed/3e6b409ed726049d142a3de6d2aa07af.png"></a> <br></div></div><br>  And this is the assembled device: <br><div class="spoiler">  <b class="spoiler_title">Show</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/087/8c0/69a/0878c069a0f701e1ae2523d5f7c4215a.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/89a/8bd/478/89a8bd47808678b59360cf7b6701d267.jpg" alt="image"><br></div></div><br>  At the request of the customer, I can not publish images of the finished device.  I hope the next video will provide an opportunity to present the final device. <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/wm8D5xzUt0o%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700190,15700253&amp;usg=ALkJrhhli0WCSfbVNsGmDASrHT1vd60BTQ" frameborder="0" allowfullscreen=""></iframe><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Eq-tJAjiJdc%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700190,15700253&amp;usg=ALkJrhj7OGvIW_RNNU6c-rHe1rOGEm10tA" frameborder="0" allowfullscreen=""></iframe><br>  I tried to describe the most difficult and interesting moments that I met as a result of working on this interesting project.  Feel free to ask questions if, in your opinion, something is not detailed enough. <br>  Thanks for attention. <br><br>  <b>UPD: Added slowmotion video, 75 FPS -&gt; 1 FPS</b> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/238783/">https://habr.com/ru/post/238783/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../238765/index.html">The best publications of social networks</a></li>
<li><a href="../238771/index.html">‚ÄúBleed the mind. Inexpensive. Is there any sense of a mask for lucid dreams?</a></li>
<li><a href="../238775/index.html">Windows 10 Technical Preview is available for download.</a></li>
<li><a href="../238777/index.html">Epson Contest Reminder for Android Developers</a></li>
<li><a href="../238779/index.html">IDE Atom from GitHub. Published roadmap to version 1.0</a></li>
<li><a href="../238785/index.html">Holy Grail on steroids: total synchronization and isomorphic JavaScript on Swarm.js</a></li>
<li><a href="../238787/index.html">Go to the global pile without traffic jams. Explore memory managers</a></li>
<li><a href="../238793/index.html">Drupal 8 beta</a></li>
<li><a href="../238795/index.html">We read Habr by mail</a></li>
<li><a href="../238797/index.html">What can we expect from 14 nanometers?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>