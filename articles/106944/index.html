<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We present our development - geo-hosting</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Why did we do this? 
 It is well known that the speed of loading a page on a site is greatly influenced by how far the user is from the server where t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We present our development - geo-hosting</h1><div class="post__text post__text-html js-mediator-article"><h5>  Why did we do this? </h5><br>  It is well known that the speed of loading a page on a site is greatly influenced by how far the user is from the server where the site is located. <br>  If users come to the site mainly from one region - the issue of download speed is easily solved - the site is hosted on a server that is physically located in this region.  But what if the site comes from several distant from each other, regions or from around the world? <br>  We tried to answer this question by developing our <b>CDN</b> ( <i>Content Delivery Network, content delivery system</i> ) and providing a new service - <b>geo-hosting</b> . <br>  Geo-hosting means placing the site on several servers at once, which are located in geographically distant data centers, and organizing the operation of the system so that the information is given to the server that is geographically closer to it. <br><a name="habracut"></a><br><br><h5>  How did we do it? </h5><br>  As a first step to building a content delivery system, we installed 3 servers in data centers in Ukraine, Russia and the USA. <br>  Content is stored on each server.  The system works in such a way that the site owner does not need to change the operation of the web application to work with the distributed architecture.  Users are provided with a cPanel hosting control panel for managing and uploading information to the server. <br>  First of all, it was necessary to find a system that would allow copying changes in the file structure of the site data.  Moreover, you need to synchronize data in all directions, that is, when changes to the site files are made from any geo-hosting point.  To solve this problem, we have chosen the <a href="http://ru.wikipedia.org/wiki/Unison">Unison</a> program.  It has ample opportunities to copy data simultaneously between multiple servers. <br>  In principle, it was possible not to synchronize the data, but to use one file server for storing them and connect any geo-hosting points to this server, however, with such a scheme, the failure of the file server will lead to the incapacity of all points of the system.  Again, you can make a cluster for a file server, but do not forget about possible delays in the access of the front-end server to our file server with such an organization. <br>  Next, we started to build a DNS system, because it was she who was supposed to help us send the user to the nearest server relative to its geo-location.  We use the well-known GeoIP.  By installing a special patch using <a href="http://www.maxmind.com/">GeoIP</a> in the DNS system, we can determine, and most importantly, redirect users to the desired (closest to them) server. <br><br>  That is, schematically it works like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/50d/661/ab4/50d661ab4b974386a0a09ed004408c7d.jpg" alt="image"><br><br>  An important step in building a CDN is to solve the issue of database synchronization.  In our geo-hosting, we use the master-slave-slave system model, that is, one server is a master, and the other two servers duplicate it.  Slave-servers with a certain periodicity interrogate the master-server for changes in the database.  Thus, all changes on the master server are repeated on the slave servers.  In this way, data redundancy is created on two servers and thus high availability and reliability of data is achieved.  An important advantage of this replication, for example, before regular copying, is that we transfer only the changes made over the network each time, not all the data.  The master server writes all changes in the database to the ‚Äúbinary log log‚Äù, assigning a number to each operation.  When the slave server accesses our main server, it reports the number of the last operation it has already performed, and receives all the new changes, counting from this number. <br>  We control this architecture using <a href="http://ru.wikipedia.org/wiki/Zabbix">Zabbix</a> , which is very convenient to use for online monitoring of servers.  With it, we control the work of both the master and its two replicating servers.  Zabbix also monitors the DNS server system, as it is a very important link in the geo-hosting system. <br><br><h5>  What did we get? </h5><br>  One of our clients kindly agreed to test our development on his website.  The results of the work pleased both him and us. <br>  The first screenshot shows the results of a survey (from different parts of the world) of a site that is located on the same server in Ukraine: <br><img src="https://habrastorage.org/getpro/habr/post_images/335/eed/f6f/335eedf6f03eab7f088ebe4c294dee1b.png" alt="Survey of a site hosted in Ukraine"><br><br>  On the second - a site survey, which is hosted on three servers - in Ukraine, Russia and the United States: <br><img src="https://habrastorage.org/getpro/habr/post_images/e67/5bf/90f/e675bf90ff50ebf6e731a7d7e5f7193d.png" alt="Survey site, located in Ukraine, Russia and the United States"><br><br>  And for clarity, the comparison in the diagram: <br><img src="https://habrastorage.org/getpro/habr/post_images/fbf/011/b17/fbf011b173fab9441648a2fb6d90e9d7.png" alt="image"><br><br><h5>  What has not yet succeeded? </h5><br>  Make this solution for multi-site accounts.  While it works only for the option one site - one cPanel account. <br><br><h5>  Side effects </h5><br>  It's okay here :) <br>  In addition to the main task - increasing the speed of access, geo-hosting has several advantages: <br><ul><li>  less vulnerability to DDOS attacks due to redistribution of the flow of requests to the site, as well as the ability to limit requests from a specific region; </li><li>  the load created by the site is distributed among several servers; </li></ul><br>  We also continue to develop the constructed system in order to find more and more useful ‚Äúside effects‚Äù. <br><br><h5>  How to get? </h5><br>  While you can get free for a month - in testing.  Then charge - the details <a href="http://hostpro.ua/ru/hosting_geo.html">on the page</a> . <br><br>  I would also like to note that this proposal is basic, but we are happy to go to meet the wishes of the client and set up a similar system for VPS and servers. We can also consider placing the site on servers in countries other than the base three - Ukraine, Russia, USA. </div><p>Source: <a href="https://habr.com/ru/post/106944/">https://habr.com/ru/post/106944/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../106936/index.html">Messenger embedded in your site - 13 days later</a></li>
<li><a href="../106937/index.html">Life without Cisco</a></li>
<li><a href="../106938/index.html">How France saves the music industry</a></li>
<li><a href="../106939/index.html">Droider Chart. Release 24</a></li>
<li><a href="../106940/index.html">Removing password protection from iPhone 4</a></li>
<li><a href="../106945/index.html">Forum Nokia will hold workshops for developers in four cities of Russia</a></li>
<li><a href="../106948/index.html">Google has finally improved feedburner</a></li>
<li><a href="../106950/index.html">Apartama - a service for interior design and not only</a></li>
<li><a href="../106951/index.html">MSDN: Internet Explorer Developer Center Updated</a></li>
<li><a href="../106953/index.html">Most people seem dumb compared to you.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>