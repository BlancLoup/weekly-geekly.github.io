<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automate word processing using the Microsoft Word API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Much of the text documents today are created and edited in Microsoft Word. The presence of this program on almost every computer makes it possible to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automate word processing using the Microsoft Word API</h1><div class="post__text post__text-html js-mediator-article">  Much of the text documents today are created and edited in Microsoft Word.  The presence of this program on almost every computer makes it possible to automate the printing, processing and export of text documents to PDF using <a href="https://msdn.microsoft.com/en-us/library/bb244515%2528v%3Doffice.12%2529.aspx">the Microsoft Word API</a> . <br><br>  In this article, I will explain how to automate the printing of text documents and the conversion of documents into PDF. <br><a name="habracut"></a><br>  An example of a source code for printing a text document written in Microsoft Visual Basic .NET language looks like this: <br><br><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> app = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"Word.Application"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> doc = app.Documents.Open(<span class="hljs-string"><span class="hljs-string">"D:\in\my resume.doc"</span></span>) app.PrintOut(<span class="hljs-literal"><span class="hljs-literal">False</span></span>) doc.Close() app.Quit()</code> </pre> <br>  This code looks very simple.  But to automate the printing of a list of documents should take into account a number of nuances: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1. People need the ability to set the name of the printer to be used. <br>  2. You need to make Word work in invisible mode, and not appear on the screen when processing each document <br>  3. It is necessary to disable all informational messages and requests for confirmation of operations with documents. <br>  4. It is necessary to disable the addition of the files processed in automatic mode to the ‚ÄúRecent files‚Äù list. <br><br>  The finalized version of our program will look like this: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> app = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"Word.Application"</span></span>) app.Visible = <span class="hljs-literal"><span class="hljs-literal">False</span></span> app.DisplayAlerts = <span class="hljs-number"><span class="hljs-number">0</span></span> app.FeatureInstall = <span class="hljs-number"><span class="hljs-number">0</span></span> app.DisplayRecentFiles = <span class="hljs-literal"><span class="hljs-literal">False</span></span> app.DisplayDocumentInformationPanel = <span class="hljs-literal"><span class="hljs-literal">False</span></span> app.AutomationSecurity = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> wdOptions = app.Options wdOptions.WarnBeforeSavingPrintingSendingMarkup = <span class="hljs-literal"><span class="hljs-literal">False</span></span> wdOptions.SavePropertiesPrompt = <span class="hljs-literal"><span class="hljs-literal">False</span></span> wdOptions.DoNotPromptForConvert = <span class="hljs-literal"><span class="hljs-literal">True</span></span> wdOptions.PromptUpdateStyle = <span class="hljs-literal"><span class="hljs-literal">False</span></span> wdOptions.ConfirmConversions = <span class="hljs-literal"><span class="hljs-literal">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> doc = app.Documents.Open(<span class="hljs-string"><span class="hljs-string">"D:\in\my resume.doc"</span></span>) doc.Application.ActivePrinter = <span class="hljs-string"><span class="hljs-string">"Xerox Global Print Driver PS"</span></span> app.PrintOut(<span class="hljs-literal"><span class="hljs-literal">False</span></span>) doc.Saved = <span class="hljs-literal"><span class="hljs-literal">True</span></span> doc.Close(<span class="hljs-number"><span class="hljs-number">0</span></span>) app.Quit()</code> </pre><br>  I believe that this code is quite enough to pass the university programming test.  But before introducing it into a commercial application, several more questions should be solved. <br><br>  1. This code will not work if the input file has the attribute ‚ÄúRead only‚Äù. <br>  2. The performance of your program can be increased several times, if you open and close only documents, and leave Microsoft Word open. <br>  3. Many users need the ability to print only a specified range of pages, and not the entire document, as well as the ability to print multiple copies of the document. <br>  4. This code will not work if your program is launched from Windows Tasks Scheduler or as Windows Service. <br><br>  In this article I will not talk about how to solve these four problems, so as not to make the life of my readers too boring.  Let me just say that in the <a href="http://www.print-conductor.com/">Print Conductor</a> , <a href="http://www.foldermill.com/">FolderMill</a> and <a href="http://www.doc2prn.com/">2Printer programs</a> they were successfully solved by me. <br><br>  To convert a document to PDF, you need to replace the PrintOut function with ExportAsFixedFormat.  After this, our code will look like this: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> app = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"Word.Application"</span></span>) app.Visible = <span class="hljs-literal"><span class="hljs-literal">False</span></span> app.DisplayAlerts = <span class="hljs-number"><span class="hljs-number">0</span></span> app.FeatureInstall = <span class="hljs-number"><span class="hljs-number">0</span></span> app.DisplayRecentFiles = <span class="hljs-literal"><span class="hljs-literal">False</span></span> app.DisplayDocumentInformationPanel = <span class="hljs-literal"><span class="hljs-literal">False</span></span> app.AutomationSecurity = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> wdOptions = app.Options wdOptions.WarnBeforeSavingPrintingSendingMarkup = <span class="hljs-literal"><span class="hljs-literal">False</span></span> wdOptions.SavePropertiesPrompt = <span class="hljs-literal"><span class="hljs-literal">False</span></span> wdOptions.DoNotPromptForConvert = <span class="hljs-literal"><span class="hljs-literal">True</span></span> wdOptions.PromptUpdateStyle = <span class="hljs-literal"><span class="hljs-literal">False</span></span> wdOptions.ConfirmConversions = <span class="hljs-literal"><span class="hljs-literal">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> doc = app.Documents.Open(<span class="hljs-string"><span class="hljs-string">"D:\in\my resume.doc"</span></span>) doc.ExportAsFixedFormat(<span class="hljs-string"><span class="hljs-string">"D:\out\my resume.pdf"</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>) doc.Saved = <span class="hljs-literal"><span class="hljs-literal">True</span></span> doc.Close(<span class="hljs-number"><span class="hljs-number">0</span></span>) app.Quit()</code> </pre><br>  This example will work if you have Microsoft Word 2007 SP2 or a newer version on your computer. <br><br>  The ExportAsFixedFormat function will not work if no printers are installed on the computer.  Or if one of the installed printers is not assigned as a system default printer. <br><br>  The code for exporting documents to PDF can be improved by implementing the ability to export parts of the document pages, as well as the ability to export documents to PDF / A.  Microsoft has implemented both of these features in the <a href="https://msdn.microsoft.com/en-us/library/bb256835%2528v%3Doffice.12%2529.aspx">ExportAsFixedFormat</a> function. <br><br>  Examples of commercial applications that use this code to convert documents to PDF: <a href="http://www.docufreezer.com/">DocuFreezer</a> and <a href="http://www.foldermill.com/">FolderMill</a> . </div><p>Source: <a href="https://habr.com/ru/post/275989/">https://habr.com/ru/post/275989/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275979/index.html">Alteration of RC-cars in a smart machine using Arduino</a></li>
<li><a href="../275981/index.html">Office as a platform: how the project Notegram for OneNote is developing</a></li>
<li><a href="../275983/index.html">Checking the source code of the C # /. NET component kit from Sony</a></li>
<li><a href="../275985/index.html">Who are the Microsoft partner students?</a></li>
<li><a href="../275987/index.html">Site CrashSafari.com sends iPhones to reboot</a></li>
<li><a href="../275993/index.html">Where do bad programmers come from and what is their problem</a></li>
<li><a href="../275995/index.html">Software licensing</a></li>
<li><a href="../275997/index.html">What's new in Windows Server 2016 RDS. Part 1</a></li>
<li><a href="../275999/index.html">Processing a temporary or permanent replacement of a 1C: Enterprise 8.2-8.3 authentication password</a></li>
<li><a href="../276003/index.html">Cach√© Class Explorer - explore Cach√© in UML notation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>