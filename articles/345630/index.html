<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Volumetric atmospheric light scattering</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you have lived on planet Earth long enough, then you probably wondered why the sky is usually blue, but it turns red at sunset. The optical phenome...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Volumetric atmospheric light scattering</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e56/d9f/840/e56d9f840f1e8562094cc55b1cf2bffd.png" alt="image"></div><br>  If you have lived on planet Earth long enough, then you probably wondered why the sky is usually blue, but it turns red at sunset.  The optical phenomenon that has become the (main) cause of this is called <strong>Rayleigh scattering</strong> .  In this article I will explain how to model atmospheric scattering to simulate many of the visual effects that appear on planets.  If you want to learn how to render physically accurate images of alien planets, then this tutorial is <em>definitely</em> worth studying. <br><br><div class="spoiler">  <b class="spoiler_title">Gif</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/823/cde/8b5/823cde8b5dd7ef73050c5f1b8213bab6.gif" width="563" height="563"></div></div></div><br>  The article is divided into the following parts: <br><br><ul><li>  Part 1. Volumetric atmospheric scattering. </li><li>  Part 2. The Theory of Atmospheric Scattering </li><li>  Part 3. Mathematics of Rayleigh Scattering </li><li>  Part 4. Journey through the atmosphere </li><li>  Part 5. Atmospheric shader </li><li>  Part 6. Crossing the atmosphere </li><li>  Part 7. Atmospheric Scatter Shader </li></ul><a name="habracut"></a><br><h2>  Part 1. Volumetric atmospheric scattering. </h2><br><h4>  Introduction </h4><br>  Recreating atmospheric phenomena is so difficult because the sky is not an opaque object.  In traditional rendering techniques, it is assumed that the objects are just empty shells.  All graphic calculations are performed on the surfaces of materials and do not depend on what is inside.  This strong simplification allows for very efficient rendering of opaque objects.  However, the properties of some materials are determined by the fact that light can pass through them.  The final appearance of <strong>translucent</strong> objects becomes the result of the interaction of light with their internal structure.  In most cases, this interaction can be very effectively imitated, as can be seen in the tutorial " <a href="https://habrahabr.ru/post/337370/">Fast Shader for Subsurface Scattering in Unity</a> ".  Unfortunately, in our case, if we want to create a convincing sky, this is not so.  Instead of rendering only the ‚Äúouter shell‚Äù of the planet, we will have to simulate what happens to the rays of light passing through the atmosphere.  Performing calculations inside an object is called <strong>volume rendering</strong> ;  We discussed this topic in detail in a series of articles, <a href="https://www.alanzucconi.com/%3Fp%3D5159" rel="noopener">Volumetric Rendering</a> .  In this series of articles, I talked about two techniques ( <strong>raymarching</strong> and <strong>iconic distance functions</strong> ) that cannot be effectively used to simulate atmospheric scattering.  In this article, we will introduce a technique that is more suitable for rendering translucent solid objects, often called <strong>unit volume scattering</strong> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Single scatter </h4><br>  In a room without light, we will not see anything.  Objects become visible only when the rays of light are reflected from them and enter our eye.  Most game engines (such as Unity and Unreal) assume that the light moves in a ‚Äúvacuum‚Äù.  This means that only objects can affect the light.  In fact, the light always moves in the environment.  In our case, this medium is the air we breathe.  Therefore, the distance traveled by light in the air affects the appearance of the object.  On the surface of the Earth, the density of air is relatively small, its influence is so insignificant that it should be considered only when light travels long distances.  Distant mountains merge with the sky, but atmospheric scattering has almost no effect on nearby objects. <br><br>  The first step in recreating the optical effect of atmospheric scattering is to analyze how light passes through environments such as air.  As stated above, we can see an object only when light falls into our eyes.  In the context of 3D graphics, our eye is the camera used to render the scene.  The molecules that make up the air around us can reflect the light rays passing through them.  Therefore, they are able to change the way we perceive objects.  If to simplify greatly, then there are two ways in which molecules can affect our vision. <br><br><h5>  Scattering out </h5><br>  The most obvious way of interacting molecules with light is that they reflect light, changing its direction.  If the light beam directed into the camera is reflected, then we observe the <strong>scattering</strong> process <strong>outside</strong> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/784/80a/dd5/78480add5f1d2d3d59ce0ddd163a1299.png"></div><br>  A real source of light can emit quadrillion photons every second, and each of them with a certain probability can collide with an air molecule.  The denser the environment in which the light moves, the more likely the reflection of a single photon.  The effect of scattering outside also depends on the distance traveled by the light. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f12/7c9/55c/f127c955c9e3f6662bb975f05d37dde4.png"></div><br>  Scattering outward causes the light to gradually become dimmer, and this property depends on the distance traveled and the density of the air. <br><br><h5>  Inward scattering </h5><br>  When a light is reflected by a particle, it may happen that it is redirected to the camera.  Such an effect is the opposite of scattering out, and it is logical that it is called <strong>scattering inward</strong> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/351/fa7/77e/351fa777eb9e6ee01b667a2ee6d86622.png"></div><br>  Under certain conditions, scattering inside allows you to see light sources that are not in the direct field of view of the camera.  The most obvious result of this is an optical effect - light halos around light sources.  They arise from the fact that the camera receives from one source both direct and indirect rays of light, which de facto increases the number of photons produced. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/326/956/e13/326956e137f06f859fd586c636bde855.png"></div><br><h4>  Unit volume scattering </h4><br>  One ray of light can be reflected any number of times.  This means that before you get into the camera.  the beam can pass very difficult routes.  This becomes a serious difficulty for us, because the rendering of high-quality translucent materials requires the simulation of the paths of each of the individual rays of light.  This technique is called <strong>raytracing</strong> , and is currently too expensive to implement in real time.  The <strong>single scattering</strong> technique presented in this tutorial takes into account a single event of scattering a ray of light.  Later we will see that such a simplification still allows to obtain realistic results in just a small fraction of the calculations required for true ray tracing. <br><br>  The basis for rendering a realistic sky is a simulation of what happens to the rays of light as it passes through the atmosphere of the planet.  The diagram below shows a camera looking through the planet.  The main idea of ‚Äã‚Äãthis rendering technique is to calculate how the passage of light from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> A </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> B </script>  affects scattering.  This means that it is necessary to calculate the influence that scattering in and out on the beam passing to the camera has.  As stated above, due to scattering outward, we observe attenuation.  The amount of light present at each point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;">v </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mrow" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;">b</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-7">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-10">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;"></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.693ex" height="2.057ex" viewBox="0 -780.1 6756.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="1347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="2197" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="2683" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="4385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="4730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="5331" y="0"></use><g transform="translate(5797,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="529" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> P \ in \ overline {ab} </script>  has a small chance of reflection away from the camera. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/26d/b88/aee/26db88aee67b412eddd00ccb561731f9.png"></div><br>  To correctly take into account the amount of scattering outward, occurring at each point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-22"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> P </script>  we first need to know how much light was present in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> P </script>  .  If we assume that only one star illuminates the planet, then all the light received <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> P </script>  should come from the sun.  Part of this light will be scattered inward and reflected into the camera: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a2d/c76/5da/a2dc765da25ec0f3b23eac3e4c1719ea.png" width="712" height="335"></div><br>  These two stages are sufficient to approximate most of the effects observed in the atmosphere.  However, everything is complicated by the fact that the amount of light produced <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-28"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> P </script>  from the sun is also subject to scattering when the light passes through the atmosphere from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> C </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> P </script>  . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb5/847/384/bb58473846466bfd4c05c7cfc6432e5b.png" width="579" height="272"></div><br>  To summarize what we need to do: <br><br><ul><li>  The field of view of the camera enters the atmosphere in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-34"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> A </script>  and is in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-36"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> B </script>  ; </li><li>  As an approximation, we will take into account the influence of inward and outward scattering when it occurs at each point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-38"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;">v </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mrow" id="MJXp-Span-52"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-52"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;">b</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-40">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-43">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-52"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;"></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.693ex" height="2.057ex" viewBox="0 -780.1 6756.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="1347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="2197" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="2683" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="4385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="4730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="5331" y="0"></use><g transform="translate(5797,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="529" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-12"> P \ in \ overline {ab} </script>  ; </li><li>  The amount of light received <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-55"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> P </script>  from the sun; </li><li>  The amount of light received <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-57"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> P </script>  and scattered to the outside as it passes through the atmosphere <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-mtext" id="MJXp-Span-60">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mrow" id="MJXp-Span-69"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.454ex" height="2.057ex" viewBox="0 -780.1 5362 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="1687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="2437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="2783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3383" y="0"></use><g transform="translate(3850,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="760" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-15"> \ overline {CP} </script>  ; </li><li>  Part of the light received <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> P </script>  and scattered inward, which redirects the rays to the camera; </li><li>  Part of the world of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> P </script>  sent to the camera, scattered outward and reflected from the field of view. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eac/80f/de9/eac80fde9f6e203d3b3402ab99352e56.png" width="750" height="361"></div><br><div class="spoiler">  <b class="spoiler_title">This is not the only way rays of light can get into the camera!</b> <div class="spoiler_text">  The solution proposed in this tutorial takes into account scattering inward along the field of view <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-mtext" id="MJXp-Span-77">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mrow" id="MJXp-Span-86"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.449ex" height="2.211ex" viewBox="0 -831.5 5360 952" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="1687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="2437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="2783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3383" y="0"></use><g transform="translate(3850,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="750" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-18"> \ overline {AB} </script>  .  Light reaching the point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.074ex" viewBox="0 -772.3 751.5 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> P </script>  from the sun, with a certain probability can be reflected in the camera. <br><br>  However, there are many ways in which rays can enter the camera.  For example, one of the rays, scattered outwards on the way to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.074ex" viewBox="0 -772.3 751.5 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-20"> P </script>  , in a second collision, it can be scattered back towards the camera (see diagram below).  And there may be rays reaching the camera after three reflections, or even four. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/711/d2f/630/711d2f630a0d075d4111711d5746edc2.png" width="711" height="334"></div><br>  The technique we are considering is called <strong>unit scattering</strong> , because it takes into account only inward scattering that occurs along the field of view.  More sophisticated techniques can expand this process and take into account other ways the beam can reach the camera.  However, the number of possible paths increases exponentially with the number of scattering events considered.  Fortunately, the probability of hitting the camera also decreases exponentially. </div></div><br><h2>  Part 2. The Theory of Atmospheric Scattering </h2><br>  In this part, we will begin to derive the equations that control this complex, but wonderful optical phenomenon. <br><br><h4>  Pass function </h4><br>  To calculate the amount of light transmitted to the camera, it is useful to make the same journey that the rays from the sun pass.  Looking at the diagram below, it is easy to see that the rays of light reaching <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-21"> C </script>  pass through the empty space.  Since there is nothing on their way, all the light reaches <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-22"> C </script>  without undergoing any scattering effect.  Let's mark the variable <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-97"><span class="MJXp-msubsup" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-100" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.504ex" height="2.419ex" viewBox="0 -780.1 1078.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="622" y="-219"></use></g></svg></span><script type="math/tex" id="MathJax-Element-23"> I_C </script>  the amount of unscattered light produced by a point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24"> C </script>  from the sun.  During his journey to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-25"> P </script>  , the ray enters the atmosphere of the planet.  Some rays collide with molecules hanging in the air and are reflected in different directions.  As a result, part of the light is scattered from the path.  Amount of light reaching <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-26"> P </script>  (denoted as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-msubsup" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-110" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.49ex" height="2.298ex" viewBox="0 -780.1 1071.9 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="622" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-27"> I_P </script>  ) will be less than <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-msubsup" id="MJXp-Span-112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-114" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.504ex" height="2.419ex" viewBox="0 -780.1 1078.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="622" y="-219"></use></g></svg></span><script type="math/tex" id="MathJax-Element-28"> I_C </script>  . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/208/cef/d9a/208cefd9aa14f10fa83612a4912a3c6b.png" width="711" height="326"></div><br>  Ratio <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-msubsup" id="MJXp-Span-116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-118" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.504ex" height="2.419ex" viewBox="0 -780.1 1078.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="622" y="-219"></use></g></svg></span><script type="math/tex" id="MathJax-Element-29"> I_C </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-119"><span class="MJXp-msubsup" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-122" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.49ex" height="2.298ex" viewBox="0 -780.1 1071.9 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="622" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-30"> I_P </script>  called <strong>transmittance</strong> : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133"><font style="vertical-align: inherit;">v </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135"><font style="vertical-align: inherit;">r</font></span></font><span class="MJXp-mtext" id="MJXp-Span-125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-131">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mrow" id="MJXp-Span-140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144"><font style="vertical-align: inherit;"> r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;">= </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-mrow" id="MJXp-Span-156"><span class="MJXp-msubsup" id="MJXp-Span-157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">I </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-156"><span class="MJXp-msubsup" id="MJXp-Span-157"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-159" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">P </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-160"><span class="MJXp-msubsup" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">I </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-160"><span class="MJXp-msubsup" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-163" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">C</font></span></span></span></font><span class="MJXp-mtext" id="MJXp-Span-143">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148"></span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0.333em; margin-right: 0.333em;"></span><span class="MJXp-mtext" id="MJXp-Span-151">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155"></span><span class="MJXp-mrow" id="MJXp-Span-156"><span class="MJXp-msubsup" id="MJXp-Span-157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158" style="margin-right: 0.05em;"></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-159" style="vertical-align: -0.4em;"></span></span></span><span class="MJXp-mrow" id="MJXp-Span-160"><span class="MJXp-msubsup" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162" style="margin-right: 0.05em;"></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-163" style="vertical-align: -0.4em;"></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.338ex" height="2.66ex" viewBox="0 -832 16937.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2270" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="3271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="3756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4242" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="4708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="5160" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="5458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="5804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="6404" y="0"></use><g transform="translate(6871,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="760" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="8633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="9084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="9430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9910" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="10487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="10848" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="11515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="12822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="13372" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="13824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="14353" y="0"></use><g transform="translate(14787,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="622" y="-213"></use></g><g transform="translate(15858,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="622" y="-219"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> T \ left (\ overline {CP} \ right) = \ frac {I_P} {I_C} </script></p><br>  We can use it to denote the percentage of light that was not scattered (that is, was <strong>missed</strong> ) when traveling from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-32"> C </script>  before <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-33"> P </script>  .  Later we explore the nature of this function.  So far the only thing we need to know is that it corresponds to the influence of atmospheric dispersion to the outside. <br><br>  Therefore, the amount of light produced <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-34"> P </script>  equals: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-170"><span class="MJXp-msubsup" id="MJXp-Span-171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-173" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-177" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-mspace" id="MJXp-Span-178" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182"><font style="vertical-align: inherit;">e</font></span></font><span class="MJXp-mtext" id="MJXp-Span-180">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">t</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-186">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">e</span><span class="MJXp-mrow" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">P</span></span><span class="MJXp-mtext" id="MJXp-Span-198">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">t</span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.581ex" height="2.66ex" viewBox="0 -832 14888.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="622" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="1349" y="0"></use><g transform="translate(2405,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="622" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="3650" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="5370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="5920" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="6282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="6921" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="7407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="7892" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="8359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="8810" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="9109" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="9454" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="10055" y="0"></use><g transform="translate(10521,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="760" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="12283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="12735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="13080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="13561" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="14137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="14499" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-35"> I_P = I_C \, T \ left (\ overline {CP} \ right) </script></p><br><h4>  Scatter function </h4><br>  Point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-36"> P </script>  receives light directly from the sun.  However, not all of this light passing through <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-37"> P </script>  transferred back to the camera.  To calculate the amount of light actually reaching the camera, we introduce a new concept: <strong>the scattering function</strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-38"> S </script>  .  It will denote the amount of light reflected in a particular direction.  If we look at the diagram below, we will see that only the rays reflected at the angle will be directed to the camera. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-211"><span class="MJXp-mtext" id="MJXp-Span-212">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.057ex" viewBox="0 -780.1 2545.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-39"> \ theta </script>  . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a2d/c76/5da/a2dc765da25ec0f3b23eac3e4c1719ea.png" width="712" height="335"></div><br>  Value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227"><font style="vertical-align: inherit;">l</font></span></font><span class="MJXp-mtext" id="MJXp-Span-220">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-226">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">a</span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-234">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">a</span><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">h</span><span class="MJXp-mtext" id="MJXp-Span-242">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">t</span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.817ex" height="2.66ex" viewBox="0 -832 13268.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="3212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="4918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="5871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="6401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="7096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="7457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="8034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="10663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="11114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="11460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="12517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="12878" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-40"> S \ left (\ lambda, \ theta, h \ right) </script>  denotes the fraction of light reflected on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-249"><span class="MJXp-mtext" id="MJXp-Span-250">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.057ex" viewBox="0 -780.1 2545.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-41"> \ theta </script>  radian.  This function is our main problem, and we explore its nature in the next section.  So far the only thing you need to know is that it depends on the color of the light produced (determined by the <strong>wavelength</strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-mtext" id="MJXp-Span-257">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.987ex" height="2.057ex" viewBox="0 -780.1 3439 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="2386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="2909" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-42"> \ lambda </script>  ), <strong>scattering angle</strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-264"><span class="MJXp-mtext" id="MJXp-Span-265">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.057ex" viewBox="0 -780.1 2545.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-43"> \ theta </script>  and <strong>heights</strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.339ex" height="2.057ex" viewBox="0 -780.1 576.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-44"> h </script>  points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-45"> P </script>  .  Altitude is important because the density of the atmosphere varies as a function of altitude.  And density is one of the factors determining the amount of light scattered. <br><br>  We now have all the necessary tools to write a general equation showing the amount of light transmitted from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-46"> P </script>  to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-47"> A </script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-279"><span class="MJXp-msubsup" id="MJXp-Span-280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-282" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">A</span></span></span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-286">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">d</span><span class="MJXp-mrow" id="MJXp-Span-292"><span class="MJXp-msubsup" id="MJXp-Span-293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-295" style="vertical-align: -0.4em;">P</span></span></span><span class="MJXp-mspace" id="MJXp-Span-296" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306"><font style="vertical-align: inherit;">a</font></span></font><span class="MJXp-mtext" id="MJXp-Span-298">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-304">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">a</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-312">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">a</span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">h</span><span class="MJXp-mtext" id="MJXp-Span-320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">t</span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-327" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337"><font style="vertical-align: inherit;">v </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338"><font style="vertical-align: inherit;">e</font></span></font><span class="MJXp-mtext" id="MJXp-Span-329">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-335">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">e</span><span class="MJXp-mrow" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">A</span></span><span class="MJXp-mtext" id="MJXp-Span-347">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">t</span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="73.314ex" height="2.66ex" viewBox="0 -832 31565.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="1880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="3186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="3616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-78" x="4101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4674" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5140" y="0"></use><g transform="translate(5664,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="622" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="6902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="7798" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="8096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="8563" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="9113" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="9475" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="10114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="10413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="10942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="11821" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="12250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="12774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="13303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="13998" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="14360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="14936" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="15403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="15764" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="16294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="16739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="17566" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="18017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="18363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="18843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="19420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="19781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="20337" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="21292" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="21590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="22057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="22607" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="22969" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="23608" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="24094" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="24579" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="25046" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="25497" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="25796" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="26141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="26742" y="0"></use><g transform="translate(27208,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="28960" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="29412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="29757" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="30238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="30814" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="31176" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-48"> I_ {PA} = \ boxed {I_P} \, S \ left (\ lambda, \ theta, h \ right) \, T \ left (\ overline {PA} \ right) </script></p><br><br>  Thanks to the previous definition, we can deploy <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-354"><span class="MJXp-msubsup" id="MJXp-Span-355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-357" style="vertical-align: -0.4em;">P</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.49ex" height="2.298ex" viewBox="0 -780.1 1071.9 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="622" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-49"> I_P </script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-358"><span class="MJXp-msubsup" id="MJXp-Span-359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-361" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">A</span></span></span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-365">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">d</span><span class="MJXp-mrow" id="MJXp-Span-371"><span class="MJXp-msubsup" id="MJXp-Span-372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-374" style="vertical-align: -0.4em;">C</span></span><span class="MJXp-mspace" id="MJXp-Span-375" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">(</font></span></font><span class="MJXp-mtext" id="MJXp-Span-377">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-383">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">e</span><span class="MJXp-mrow" id="MJXp-Span-392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">P</span></span><span class="MJXp-mtext" id="MJXp-Span-395">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">t</span><span class="MJXp-mo" id="MJXp-Span-401" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mspace" id="MJXp-Span-402" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414"><font style="vertical-align: inherit;">b</font></span></font><span class="MJXp-mtext" id="MJXp-Span-404">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-410">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">a</span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-418">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">a</span><span class="MJXp-mo" id="MJXp-Span-424" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">h</span><span class="MJXp-mtext" id="MJXp-Span-426">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">t</span><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-433" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></font></span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></font></span></font><span class="MJXp-mtext" id="MJXp-Span-435">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">e</span><span class="MJXp-mrow" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">A</span></span><span class="MJXp-mtext" id="MJXp-Span-453">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">t</span><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="102.271ex" height="2.66ex" viewBox="0 -832 44033 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="1880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="3186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="3616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-78" x="4101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4674" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5140" y="0"></use><g transform="translate(5664,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="622" y="-219"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="1244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2199" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2497" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="2964" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3514" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3876" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="4515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="5001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="5486" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="5953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="6404" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="6703" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="7048" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="7649" y="0"></use><g transform="translate(8115,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="760" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="9877" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="10329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="10674" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11155" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="11731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="12093" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="18313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="19209" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="19507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="19974" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="20524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="20886" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="21525" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="21824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="22353" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="23232" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="23661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="24185" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="24714" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="25409" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="25771" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="26347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="26814" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="27175" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="27705" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="28150" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="28977" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="29428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="29774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="30254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="30831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="31192" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="31748" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="32703" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="33001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="33468" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="34018" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="34380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="35019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="35505" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="35990" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="36457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="36908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="37207" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="37552" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="38153" y="0"></use><g transform="translate(38619,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="40371" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="40823" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="41168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="41649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="42225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="42587" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="43254" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-50"> I_ {PA} = \ boxed {I_C \, T \ left (\ overline {CP} \ right)} \, S \ left (\ lambda, \ theta, h \ right) \, T \ left (\ overline { PA} \ right) = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-461"><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-463">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">t</span><span class="MJXp-mrow" id="MJXp-Span-472"><span class="MJXp-mtext" id="MJXp-Span-473">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">t</span><span class="MJXp-mrow" id="MJXp-Span-478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">n</span><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">g</span></span></span><span class="MJXp-mrow" id="MJXp-Span-492"><span class="MJXp-mtext" id="MJXp-Span-493">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">e</span><span class="MJXp-mrow" id="MJXp-Span-504"><span class="MJXp-msubsup" id="MJXp-Span-505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-507" style="vertical-align: -0.4em;">C</span></span><span class="MJXp-mspace" id="MJXp-Span-508" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">S</span><span class="MJXp-mtext" id="MJXp-Span-510">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">t</span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-516">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">a</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-524">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">a</span><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">h</span><span class="MJXp-mtext" id="MJXp-Span-532">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">t</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mspace" id="MJXp-Span-539" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-540">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">t</span><span class="MJXp-mrow" id="MJXp-Span-549"><span class="MJXp-mtext" id="MJXp-Span-550">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">t</span><span class="MJXp-mrow" id="MJXp-Span-555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">t</span><span class="MJXp-mo" id="MJXp-Span-559" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">g</span></span></span><span class="MJXp-mrow" id="MJXp-Span-570"><span class="MJXp-mtext" id="MJXp-Span-571">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">e</span><span class="MJXp-mrow" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">T</span><span class="MJXp-mtext" id="MJXp-Span-584">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">t</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-590">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">e</span><span class="MJXp-mrow" id="MJXp-Span-599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">P</span></span><span class="MJXp-mtext" id="MJXp-Span-602">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">t</span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-609" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">T</span><span class="MJXp-mtext" id="MJXp-Span-611">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">t</span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-617">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">e</span><span class="MJXp-mrow" id="MJXp-Span-626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">A</span></span><span class="MJXp-mtext" id="MJXp-Span-629">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">t</span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="173.911ex" height="2.66ex" viewBox="0 -832 74878.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="1306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="1878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="2479" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="3920" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="4856" y="0"></use><g transform="translate(5218,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="345" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2212" x="1168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="2638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="4790" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="5242" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="5587" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="6188" y="0"></use></g></g><g transform="translate(13899,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="1423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="2413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="2864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="4275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4708" y="0"></use><g transform="translate(5175,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="622" y="-219"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="1244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="2905" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4456" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="4755" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="5284" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="6163" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="6592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="7116" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="7645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8341" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="8702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="9279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="9745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="10107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="10636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="11908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="12359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="12705" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="13185" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="13762" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="14123" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="34004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="34576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="35177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="35700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="36167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="36618" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="37088" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="37554" y="0"></use><g transform="translate(37916,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1058" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2212" x="1641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="2642" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="3111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="4074" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="4436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4797" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="5264" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="5715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="6061" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="6661" y="0"></use></g></g><g transform="translate(47070,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="1423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="2413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="2864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="4275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4708" y="0"></use><g transform="translate(5175,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2270" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="3271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="3756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4242" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="4708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="5160" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="5458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="5804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="6404" y="0"></use><g transform="translate(6871,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="760" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="8633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="9084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="9430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9910" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="10487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="10848" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="11404" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="12359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="12657" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="13124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="13674" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="14036" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="14675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="15161" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="15646" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="16113" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="16564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="16863" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="17208" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="17809" y="0"></use><g transform="translate(18275,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="20027" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="20479" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="20824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="21305" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="21881" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="22243" y="0"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-51"> = \ underset {\ text {in-scattering}} {\ underbrace {I_C \, S \ left (\ lambda, \ theta, h \ right)}} \, \ underset {\ text {out-scattering}} { \ underbrace {T \ left (\ overline {CP} \ right) \, T \ left (\ overline {PA} \ right)}} </script></p><br>  The equation speaks for itself: <br><br><ul><li>  Light travels from the sun to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-52"> C </script>  without dissipating in the vacuum of space; </li><li>  Light enters the atmosphere and passes from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-53"> C </script>  to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-54"> P </script>  .  In this process, due to <b>scattering outwardly</b> only a part <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">T</span><span class="MJXp-mtext" id="MJXp-Span-644">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">t</span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-650">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">e</span><span class="MJXp-mrow" id="MJXp-Span-659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">P</span></span><span class="MJXp-mtext" id="MJXp-Span-662">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">t</span><span class="MJXp-mo" id="MJXp-Span-668" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.101ex" height="2.66ex" viewBox="0 -832 11238 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2270" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="3271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="3756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4242" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="4708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="5160" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="5458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="5804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="6404" y="0"></use><g transform="translate(6871,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="760" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="8633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="9084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="9430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9910" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="10487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="10848" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-55"> T \ left (\ overline {CP} \ right) </script>  reaches destination; </li><li>  The part of the world that got from the sun to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-56"> P </script>  Reflected back into the camera.  The proportion of light subject to <strong>scattering</strong> is equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">S</span><span class="MJXp-mtext" id="MJXp-Span-673">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">t</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-679">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">a</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-687">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">a</span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">h</span><span class="MJXp-mtext" id="MJXp-Span-695">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">t</span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.817ex" height="2.66ex" viewBox="0 -832 13268.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="3212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="4918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="5871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="6401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="7096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="7457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="8034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="10663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="11114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="11460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="12517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="12878" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-57"> S \ left (\ lambda, \ theta, h \ right) </script>  ; </li><li>  The remaining light passes from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-58"> P </script>  before <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-59"> A </script>  and again only part <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">T</span><span class="MJXp-mtext" id="MJXp-Span-708">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">t</span><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-714">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">e</span><span class="MJXp-mrow" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725">A</span></span><span class="MJXp-mtext" id="MJXp-Span-726">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">t</span><span class="MJXp-mo" id="MJXp-Span-732" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.078ex" height="2.66ex" viewBox="0 -832 11228 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2270" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="3271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="3756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4242" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="4708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="5160" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="5458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="5804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="6404" y="0"></use><g transform="translate(6871,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="8623" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="9074" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="9420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="10477" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="10838" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-60"> T \ left (\ overline {PA} \ right) </script>  . </li></ul><br><h4>  Numerical integration </h4><br>  If you carefully read the previous paragraphs, you might have noticed that the brightness was recorded differently.  Symbol <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-733"><span class="MJXp-msubsup" id="MJXp-Span-734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-736" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">A</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.722ex" height="2.419ex" viewBox="0 -780.1 1602.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-61"> I_ {PA} </script>  denotes the amount of light transmitted from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-62"> P </script>  to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-63"> A </script>  .  However, the value does not take into account all the light that gets <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-64"> A </script>  .  In these simplified models of atmospheric scattering, we take into account scattering inward from each point along the camera's field of view in the atmosphere. <br><br>  Total amount of light received <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-65"> A </script>  ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-747"><span class="MJXp-msubsup" id="MJXp-Span-748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-750" style="vertical-align: -0.4em;">A</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.488ex" height="2.419ex" viewBox="0 -780.1 1071.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="622" y="-230"></use></g></svg></span><script type="math/tex" id="MathJax-Element-66"> I_A </script>  ), calculated by adding the influence of all points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">P</span><span class="MJXp-mtext" id="MJXp-Span-753">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">n</span><span class="MJXp-mtext" id="MJXp-Span-756">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">e</span><span class="MJXp-mrow" id="MJXp-Span-765"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">b</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.693ex" height="2.057ex" viewBox="0 -780.1 6756.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="1347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="2197" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="2683" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="4385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="4730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="5331" y="0"></use><g transform="translate(5797,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="529" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-67"> P \ in \ overline {ab} </script>  .  From the point of view of mathematics, on the segment <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-mtext" id="MJXp-Span-769">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">e</span><span class="MJXp-mrow" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">B</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.449ex" height="2.057ex" viewBox="0 -780.1 5360 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="1687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="2437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="2783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3383" y="0"></use><g transform="translate(3850,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="750" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-68"> \ overline {AB} </script>  there is an infinite number of points, therefore a cyclic round of them is impossible.  However, we can share <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-781"><span class="MJXp-mtext" id="MJXp-Span-782">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">e</span><span class="MJXp-mrow" id="MJXp-Span-791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">B</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.449ex" height="2.057ex" viewBox="0 -780.1 5360 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="1687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="2437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="2783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3383" y="0"></use><g transform="translate(3850,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="750" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-69"> \ overline {AB} </script>  into smaller lengths <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.306ex" height="2.057ex" viewBox="0 -780.1 993 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="523" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-70"> ds </script>  (see diagram below), and summarize the influence of each of them. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c1/b69/128/8c1b691280174ac7b16a70dd90510304.png" width="705" height="257"></div><br>  Such an approximation process is called <strong>numerical integration</strong> and leads to the following expression: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-797"><span class="MJXp-msubsup" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-800" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-802">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">u</span><span class="MJXp-msubsup" id="MJXp-Span-805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-807" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">P</span><span class="MJXp-mtext" id="MJXp-Span-809">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">n</span><span class="MJXp-mtext" id="MJXp-Span-812">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">e</span><span class="MJXp-mrow" id="MJXp-Span-821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">B</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-824"><span class="MJXp-msubsup" id="MJXp-Span-825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-827" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">A</span></span></span><span class="MJXp-mspace" id="MJXp-Span-830" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">s</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.617ex" height="2.419ex" viewBox="0 -780.1 12751.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="622" y="-230"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="1348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="2655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="3124" y="0"></use><g transform="translate(3697,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="1105" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="1450" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="2404" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="2890" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3375" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3842" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4293" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="4592" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="4937" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="5538" y="0"></use><g transform="translate(4245,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="750" y="0"></use></g></g></g><g transform="translate(9989,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="1769" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="2292" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-71"> I_A = \ sum_ {P \ in \ overline {AB}} {I_ {PA} \, ds} </script></p><br>  The more points we take into account, the more accurate the final result will be.  In reality, in our atmospheric shader, we simply loop around a few points. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-833"><span class="MJXp-msubsup" id="MJXp-Span-834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-836" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.292ex" height="2.419ex" viewBox="0 -780.1 986.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="908" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-72"> P_i </script>  inside the atmosphere, summing up their influence in the overall result. <br><br><div class="spoiler">  <b class="spoiler_title">Why do we multiply by ds?</b> <div class="spoiler_text">  Here we use the approximation of a continuous phenomenon.  The more points we consider, the closer we will be to the real result.  Multiplying each point by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.306ex" height="2.074ex" viewBox="0 -772.3 993 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="523" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-73"> ds </script>  , we give its influence weight according to its length.  The more points we have, the less important each of them is. <br><br>  You can look at it in another way: multiplying by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.306ex" height="2.074ex" viewBox="0 -772.3 993 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="523" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-74"> ds </script>  , we "average" the influence of all points. </div></div><br><h4>  Directional lighting </h4><br>  If the sun is relatively close, then it is best modeled as a <strong>point source of light</strong> .  In this case, the amount received <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-75"> C </script>  light depends on the distance to the sun.  However, if we are talking about planets, we often assume that the sun is so far away that its rays fall on the planet from one angle.  If this is true, then we can simulate the sun as a <strong>directional light source</strong> .  The light received from a directional light source remains constant, regardless of the distance traveled by it.  Therefore every point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-76"> C </script>  receives the same amount of light, and the direction relative to the sun is the same for all points. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cfd/b2c/cbe/cfdb2ccbe5cb7ce2893d2e34a8b950d6.png" width="710" height="304"></div><br>  We can use this assumption to simplify our equations. <br><br>  Let's replace <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-847"><span class="MJXp-msubsup" id="MJXp-Span-848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-850" style="vertical-align: -0.4em;">C</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.504ex" height="2.419ex" viewBox="0 -780.1 1078.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="622" y="-219"></use></g></svg></span><script type="math/tex" id="MathJax-Element-77"> I_C </script>  constant <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-851"><span class="MJXp-msubsup" id="MJXp-Span-852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-854" style="vertical-align: -0.4em;">S</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.315ex" height="2.419ex" viewBox="0 -780.1 996.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="622" y="-219"></use></g></svg></span><script type="math/tex" id="MathJax-Element-78"> I_S </script>  which determines the <strong>brightness of the sun</strong> . <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-855"><span class="MJXp-msubsup" id="MJXp-Span-856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-858" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-860">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">u</span><span class="MJXp-msubsup" id="MJXp-Span-863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-865" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">P</span><span class="MJXp-mtext" id="MJXp-Span-867">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">n</span><span class="MJXp-mtext" id="MJXp-Span-870">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">e</span><span class="MJXp-mrow" id="MJXp-Span-879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">B</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-882"><span class="MJXp-mtext" id="MJXp-Span-883">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">d</span><span class="MJXp-mrow" id="MJXp-Span-889"><span class="MJXp-msubsup" id="MJXp-Span-890"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-892" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">A</span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-895" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">s</span></span><span class="MJXp-mo" id="MJXp-Span-898" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.405ex" height="2.419ex" viewBox="0 -780.1 16535.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="622" y="-230"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="1348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="2655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="3124" y="0"></use><g transform="translate(3697,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="1105" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="1450" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="2404" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="2890" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3375" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3842" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4293" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="4592" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="4937" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="5538" y="0"></use><g transform="translate(4245,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="750" y="0"></use></g></g></g><g transform="translate(9989,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-78" x="1165" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="2204" y="0"></use><g transform="translate(2727,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="4496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="5020" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="15756" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-79"> I_A = \ sum_ {P \ in \ overline {AB}} {\ boxed {I_ {PA}} \, ds} = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-899"><span class="MJXp-mo" id="MJXp-Span-900" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-901">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">u</span><span class="MJXp-msubsup" id="MJXp-Span-904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-906" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">P</span><span class="MJXp-mtext" id="MJXp-Span-908">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">n</span><span class="MJXp-mtext" id="MJXp-Span-911">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">e</span><span class="MJXp-mrow" id="MJXp-Span-920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">B</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-923"><span class="MJXp-mtext" id="MJXp-Span-924">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">d</span><span class="MJXp-mrow" id="MJXp-Span-930"><span class="MJXp-msubsup" id="MJXp-Span-931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-933" style="vertical-align: -0.4em;">C</span></span><span class="MJXp-mspace" id="MJXp-Span-934" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">S</span><span class="MJXp-mtext" id="MJXp-Span-936">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">t</span><span class="MJXp-mo" id="MJXp-Span-941" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-942">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">a</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-950">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">a</span><span class="MJXp-mo" id="MJXp-Span-956" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">h</span><span class="MJXp-mtext" id="MJXp-Span-958">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">t</span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-965" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">T</span><span class="MJXp-mtext" id="MJXp-Span-967">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">t</span><span class="MJXp-mo" id="MJXp-Span-972" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-973">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">e</span><span class="MJXp-mrow" id="MJXp-Span-982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">P</span></span><span class="MJXp-mtext" id="MJXp-Span-985">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">t</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-992">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">T</span><span class="MJXp-mtext" id="MJXp-Span-995">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">t</span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1001">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">e</span><span class="MJXp-mrow" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">A</span></span><span class="MJXp-mtext" id="MJXp-Span-1013">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">t</span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mspace" id="MJXp-Span-1020" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">s</span></span><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="119.439ex" height="2.66ex" viewBox="0 -832 51424.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="1306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="1775" y="0"></use><g transform="translate(2348,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="1105" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="1450" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="2404" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="2890" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3375" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3842" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4293" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="4592" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="4937" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="5538" y="0"></use><g transform="translate(4245,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="750" y="0"></use></g></g></g><g transform="translate(8640,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-78" x="1165" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="2204" y="0"></use><g transform="translate(2727,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="622" y="-219"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="1244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="2905" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4456" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="4755" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="5284" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="6163" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="6592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="7116" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="7645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8341" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="8702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="9279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="9745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="10107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="10636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="11908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="12359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="12705" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="13185" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="13762" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="14123" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="14679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="15634" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="15932" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="16399" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="16949" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="17311" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="17950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="18436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="18921" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="19388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="19839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="20138" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="20483" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="21084" y="0"></use><g transform="translate(21550,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="760" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="23312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="23764" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="24109" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="24590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="25166" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="25528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="26167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="26613" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="27567" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="27866" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="28332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="28883" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="29244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="29884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="30369" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="30855" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="31321" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="31773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="32071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="32417" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="33017" y="0"></use><g transform="translate(33484,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="35236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="35687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="36033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="36513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="37090" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="37451" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="40735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="41258" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="50646" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-80"> = \ sum_ {P \ in \ overline {AB}} {\ boxed {I_C \, S \ left (\ lambda, \ theta, h \ right) \, T \ left (\ overline {CP} \ right) \ , T \ left (\ overline {PA} \ right)} \, ds} = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1024"><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1028" style="vertical-align: -0.4em;">S</span></span><span class="MJXp-mtext" id="MJXp-Span-1029">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">u</span><span class="MJXp-msubsup" id="MJXp-Span-1032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1034" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">P</span><span class="MJXp-mtext" id="MJXp-Span-1036">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">n</span><span class="MJXp-mtext" id="MJXp-Span-1039">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">e</span><span class="MJXp-mrow" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">B</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1051"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">S</span><span class="MJXp-mtext" id="MJXp-Span-1053">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">t</span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1059">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">a</span><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1067">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">a</span><span class="MJXp-mo" id="MJXp-Span-1073" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">h</span><span class="MJXp-mtext" id="MJXp-Span-1075">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">t</span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1082" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">T</span><span class="MJXp-mtext" id="MJXp-Span-1084">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">t</span><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1090">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">e</span><span class="MJXp-mrow" id="MJXp-Span-1099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">P</span></span><span class="MJXp-mtext" id="MJXp-Span-1102">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">t</span><span class="MJXp-mo" id="MJXp-Span-1108" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1109" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">T</span><span class="MJXp-mtext" id="MJXp-Span-1111">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">t</span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1117">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">e</span><span class="MJXp-mrow" id="MJXp-Span-1126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">A</span></span><span class="MJXp-mtext" id="MJXp-Span-1129">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">t</span><span class="MJXp-mo" id="MJXp-Span-1135" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1136" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">s</span></span><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="111.301ex" height="2.66ex" viewBox="0 -832 47921 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="0" y="0"></use><g transform="translate(1056,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="622" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="2303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="2772" y="0"></use><g transform="translate(3345,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="1105" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="1450" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="2404" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="2890" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3375" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3842" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4293" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="4592" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="4937" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="5538" y="0"></use><g transform="translate(4245,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="750" y="0"></use></g></g></g><g transform="translate(9637,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="3212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="4918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="5871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="6401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="7096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="7457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="8034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="10663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="11114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="11460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="12517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="12878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="13435" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="14389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="14688" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="15154" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="15705" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="16066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="16706" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="17191" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="17677" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="18143" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="18595" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="18893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="19239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="19839" y="0"></use><g transform="translate(20306,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="760" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="22068" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="22519" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="22865" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="23345" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="23922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="24283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="24839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="25794" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="26092" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="26559" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="27109" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="27471" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="28110" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="28596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="29081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="29548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="29999" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="30298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="30643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="31244" y="0"></use><g transform="translate(31710,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="751" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="33462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="33914" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="34259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="34740" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="35316" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="35678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="36234" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="36757" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="47142" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-81"> = I_S \ sum_ {P \ in \ overline {AB}} {S \ left (\ lambda, \ theta, h \ right) \, T \ left (\ overline {CP} \ right) \, T \ left ( \ overline {PA} \ right) \, ds} = </script></p><br>  There is one more optimization that we can perform, it includes the scattering function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">S</span><span class="MJXp-mtext" id="MJXp-Span-1142">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">t</span><span class="MJXp-mo" id="MJXp-Span-1147" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1148">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">a</span><span class="MJXp-mo" id="MJXp-Span-1155" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1156">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">a</span><span class="MJXp-mo" id="MJXp-Span-1162" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">h</span><span class="MJXp-mtext" id="MJXp-Span-1164">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">t</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.817ex" height="2.66ex" viewBox="0 -832 13268.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="3212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="4918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="5871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="6401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="7096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="7457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="8034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="10663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="11114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="11460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="12517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="12878" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-82"> S \ left (\ lambda, \ theta, h \ right) </script>  .  If sunlight always falls from one direction, then the angle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1171"><span class="MJXp-mtext" id="MJXp-Span-1172">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.057ex" viewBox="0 -780.1 2545.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-83"> \ theta </script>  becomes permanent.  Below we will see that directional influence can be excluded from the amount. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">S</span><span class="MJXp-mtext" id="MJXp-Span-1180">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">t</span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1186">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">a</span><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1194">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">a</span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">h</span><span class="MJXp-mtext" id="MJXp-Span-1202">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">t</span><span class="MJXp-mo" id="MJXp-Span-1208" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.817ex" height="2.66ex" viewBox="0 -832 13268.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="3212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="4918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="5871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="6401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="7096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="7457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="8034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="10663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="11114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="11460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="12517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="12878" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-84"> S \ left (\ lambda, \ theta, h \ right) </script>  .  But for the time being we will leave him. <br><br><h4>  Absorption coefficient </h4><br>  In describing the possible results of the interaction between light and air molecules, we allowed only two options - either passing through or reflecting.  But there is a third possibility.  Some chemical compounds absorb light.  In the atmosphere of the Earth there are many substances with this property.  Ozone, for example, is located in the upper atmosphere and actively interacts with ultraviolet radiation.  However, its presence has virtually no effect on the color of the sky, because it absorbs light outside the visible spectrum.  Here on Earth, the influence of light-absorbing substances is often ignored.  But in the case of other planets it is impossible to refuse him.  For example, the usual coloring of Neptune and Uranus is caused by the presence of a large amount of methane in their atmosphere.  Methane absorbs red light, which gives a blue hue.  In the remaining part of the tutorial, we will ignore the absorption coefficient, but we will add a way to tint the atmosphere. <br><br><div class="spoiler">  <b class="spoiler_title">Why did the sun turn red during the 2017 Hurricane Ophelia?</b> <div class="spoiler_text"><script type="text/javascript">function gtElInit() {var lib = new google.translate.TranslateService();lib.translatePage('ru', 'en', function () {});}</script><script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=gtElInit&amp;client=wt"></script> If you live in the UK, you may have noticed that during Hurricane Ophelia, the sun was turning red.  This was because Ophelia brought sand from the Sahara.  These tiny particles hanging in the air intensified the scattering effect.  As we will see in the next section, blue light is scattered more than red. <br><br>  If you look at the colors of the visible spectrum (below), then it is easy to see that if enough blue light is scattered, then the sky can actually turn yellow or red. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/34e/0bf/929/34e0bf9290857494724cfe9aecf62082.png" width="1024" height="128"></div><br>  There is a temptation to say that the color of the sky is associated with a shade of yellow Sahara sand.  However, the same effect can be seen during large fires due to smoke particles, which are usually close to black. </div></div><br><h2>  Part 3. Mathematics of Rayleigh scattering. </h2><br>  In this part we will get acquainted with the mathematics of Rayleigh scattering - an optical phenomenon, because of which the sky looks blue.  The equations derived in this part are transferred to the shader code of the next part. <br><br><h4>  Introduction </h4><br>  In the previous section, we derived an equation, which is a good basis for approximating atmospheric scatter in a shader.  However, we missed the fact that a single equation does not give us convincing results.  If we need a beautiful looking, atmospheric shader, then we need to delve a bit into math. <br><br>  The interaction between light and matter is incredibly difficult, and we will not be able to fully describe it in an easy way.  In fact, modeling atmospheric dispersion is very time consuming.  Part of the problem is caused by the fact that the atmosphere is not a homogeneous medium.  Its density and composition vary considerably as a function of height, which makes it almost impossible to create an ‚Äúideal‚Äù model. <br><br>  That is why in the scientific literature there are several models of scattering, each of which is intended to describe a subset of optical phenomena that occur under certain conditions.  Most of the optical effects demonstrated by the planets can be recreated, considering only two different models: <strong>Rayleigh scattering</strong> and <strong>light scattering by a spherical particle</strong> .  These two mathematical tools allow us to predict the scattering of light on objects of different sizes.  The first models the reflection of light by molecules of oxygen and nitrogen, which constitute most of the composition of the air.  The latter models the reflection of light in larger structures present in the lower layers of the atmosphere, such as pollen, dust and pollutants. <br><br>  Rayleigh scattering causes blue skies and red sunsets.  The scattering of light by a spherical particle gives the clouds their white color.  If you want to know <em>how</em> this happens, then we will have to dive deeper into the mathematics of scattering. <br><br><h4>  Rayleigh scattering </h4><br>  What is the fate of a photon hitting a particle?  To answer this question, we need to rephrase it more formally.  Imagine that a ray of light passes through empty space and suddenly collides with a particle.  The result of such a collision strongly depends on the particle size and the color of the light beam.  If the particle is small enough (about the size of atoms or molecules), then the behavior of light is better predicted using <strong>Rayleigh scattering</strong> . <br><br>  What is going on?  Part of the world continues on its way, ‚Äúnot feeling‚Äù any influence.  However, a small percentage of this source light interacts with the particle and scatters in all directions.  However, not all directions receive the same amount of light.  The photons are more likely to pass right through the particle or are reflected back.  That is, the photon reflection variant is 90 degrees less.  This behavior can be seen in the diagram below.  The blue line shows the most probable directions of stray light. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/372/04f/000/37204f0003899114c91d9f557350b074.png" width="397" height="291"></div><br>  This optical phenomenon is mathematically described <strong>by the Rayleigh scattering equation.</strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">S</span><span class="MJXp-mtext" id="MJXp-Span-1211">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">t</span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1217">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">a</span><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">a</span><span class="MJXp-mo" id="MJXp-Span-1231" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">h</span><span class="MJXp-mtext" id="MJXp-Span-1233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">t</span><span class="MJXp-mo" id="MJXp-Span-1239" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.817ex" height="2.66ex" viewBox="0 -832 13268.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="3212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="4918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="5871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="6401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="7096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="7457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="8034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="10663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="11114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="11460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="12517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="12878" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-85"> S \ left (\ lambda, \ theta, h \ right) </script>  which gives us a share of the original light <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1240"><span class="MJXp-msubsup" id="MJXp-Span-1241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242" style="margin-right: 0.05em;">I</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1243" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.077ex" height="2.419ex" viewBox="0 -780.1 894.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-30" x="622" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-86"> I_0 </script>  reflected in direction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1244"><span class="MJXp-mtext" id="MJXp-Span-1245">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.057ex" viewBox="0 -780.1 2545.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-87"> \ theta </script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">I</span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255" style="margin-right: 0.05em;">I</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1256" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mspace" id="MJXp-Span-1257" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">S</span><span class="MJXp-mtext" id="MJXp-Span-1259">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">t</span><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1265">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">a</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1273">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">a</span><span class="MJXp-mo" id="MJXp-Span-1279" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">h</span><span class="MJXp-mtext" id="MJXp-Span-1281">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">t</span><span class="MJXp-mo" id="MJXp-Span-1287" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.552ex" height="2.66ex" viewBox="0 -832 16168 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="782" y="0"></use><g transform="translate(1838,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-30" x="622" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="2899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="3795" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4093" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="4560" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="5110" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="5472" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="6111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="6410" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="6939" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="7818" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="8247" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8771" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="9300" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="9995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="10357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="10933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="11400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="11761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="12291" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="12736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="13562" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="14014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="14359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="14840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="15416" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="15778" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-88"> I = I_0 \, S \ left (\ lambda, \ theta, h \ right) </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">S</span><span class="MJXp-mtext" id="MJXp-Span-1290">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">t</span><span class="MJXp-mo" id="MJXp-Span-1295" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1296">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">a</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1304">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">a</span><span class="MJXp-mo" id="MJXp-Span-1310" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">h</span><span class="MJXp-mtext" id="MJXp-Span-1312">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">t</span><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">c</span><span class="MJXp-mrow" id="MJXp-Span-1325"><span class="MJXp-mtext" id="MJXp-Span-1326">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">p</span><span class="MJXp-msubsup" id="MJXp-Span-1328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1330" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1331">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">t</span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1339" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1340" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1341">1</span><span class="MJXp-mtext" id="MJXp-Span-1342">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">t</span><span class="MJXp-msubsup" id="MJXp-Span-1348"><span class="MJXp-mo" id="MJXp-Span-1349" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1350" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1351"><span class="MJXp-mn" id="MJXp-Span-1352">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1353">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">t</span><span class="MJXp-mrow" id="MJXp-Span-1362"><span class="MJXp-mtext" id="MJXp-Span-1363">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">t</span><span class="MJXp-mrow" id="MJXp-Span-1368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">y</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1376"><span class="MJXp-mtext" id="MJXp-Span-1377">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">e</span><span class="MJXp-mrow" id="MJXp-Span-1388"><span class="MJXp-mtext" id="MJXp-Span-1389">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">c</span><span class="MJXp-mrow" id="MJXp-Span-1394"><span class="MJXp-mtext" id="MJXp-Span-1395">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">o</span><span class="MJXp-mtext" id="MJXp-Span-1399">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">t</span><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">h</span><span class="MJXp-mtext" id="MJXp-Span-1406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">t</span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">N</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1415">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">t</span><span class="MJXp-mrow" id="MJXp-Span-1423"><span class="MJXp-mtext" id="MJXp-Span-1424">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">t</span><span class="MJXp-mrow" id="MJXp-Span-1429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">h</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1440"><span class="MJXp-mtext" id="MJXp-Span-1441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">e</span><span class="MJXp-mrow" id="MJXp-Span-1451"><span class="MJXp-mtext" id="MJXp-Span-1452">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">c</span><span class="MJXp-mrow" id="MJXp-Span-1457"><span class="MJXp-mn" id="MJXp-Span-1458">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1459"><span class="MJXp-mtext" id="MJXp-Span-1460">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">d</span><span class="MJXp-msubsup" id="MJXp-Span-1466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1468" style="vertical-align: 0.5em;">4</span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1469">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">t</span><span class="MJXp-mrow" id="MJXp-Span-1478"><span class="MJXp-mtext" id="MJXp-Span-1479">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">t</span><span class="MJXp-mrow" id="MJXp-Span-1484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">y</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1493"><span class="MJXp-mtext" id="MJXp-Span-1494">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">e</span><span class="MJXp-mrow" id="MJXp-Span-1505"><span class="MJXp-mtext" id="MJXp-Span-1506">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">t</span><span class="MJXp-mo" id="MJXp-Span-1511" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1512">1</span><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1514">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">o</span><span class="MJXp-msubsup" id="MJXp-Span-1517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1519" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1520">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">a</span><span class="MJXp-mtext" id="MJXp-Span-1526">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">t</span><span class="MJXp-mo" id="MJXp-Span-1532" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="234.49ex" height="3.021ex" viewBox="0 -987.6 100960.8 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="3212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="4918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="5871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="6401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="7096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="7457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="8034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="10663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="11114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="11460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="12517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="12878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="13546" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="14852" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="15402" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="15854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="16383" y="0"></use><g transform="translate(16817,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-70" x="250" y="0"></use><g transform="translate(753,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32" x="488" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="1802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="2567" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3118" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3479" y="0"></use><g transform="translate(3869,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32" x="849" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2212" x="5146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31" x="6146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="6897" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="7348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="7694" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="8174" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8751" y="0"></use><g transform="translate(9112,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32" x="550" y="583"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32" x="26773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="27524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="28096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="28697" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="29220" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="29687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="30138" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="30608" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="31074" y="0"></use><g transform="translate(31436,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="990" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="1590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="2060" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2405" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-79" x="2767" y="0"></use></g></g><g transform="translate(36712,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="1423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="2413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="2864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="4275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4708" y="0"></use><g transform="translate(5175,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="1278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="2778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="4080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="4906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="5358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="5703" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="6184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="6760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="7122" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-4E" x="9726" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="52752" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="53238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="53723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="54190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="54641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="55111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="55577" y="0"></use><g transform="translate(55939,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="1246" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="2963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="3563" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="4044" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="4405" y="0"></use></g></g><g transform="translate(62933,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="1687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="2139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="2568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3020" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="3549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3983" y="0"></use><g transform="translate(4449,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="2386" y="0"></use><g transform="translate(2909,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-34" x="748" y="583"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="74240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="74813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="75413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="75937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="76403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="76855" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="77324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="77791" y="0"></use><g transform="translate(78152,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="947" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2311" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2777" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-79" x="3590" y="0"></use></g></g><g transform="translate(84252,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-75" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="1423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="2413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="2864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="3294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="4275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4708" y="0"></use><g transform="translate(5175,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="1927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31" x="2316" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2B" x="3039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="4289" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="4723" y="0"></use><g transform="translate(5208,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32" x="663" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="6382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="6743" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="7320" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="7786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8148" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="8927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="9379" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="9724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="10205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="10781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="11143" y="0"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-89"> S \ left (\ lambda, \ theta, h \ right) = \ frac {\ pi ^ 2 \ left (n ^ 2-1 \ right) ^ 2} {2} \ underset {\ text {density}} { \ underbrace {\ frac {\ rho \ left (h \ right)} {N}}} \ overset {\ text {wavelength}} {\ overbrace {\ frac {1} {\ lambda ^ 4}}} \ underset { \ text {geometry}} {\ underbrace {\ left (1+ \ cos ^ 2 \ theta \ right)}} </script></p><br>  Where: <br><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1533"><span class="MJXp-mtext" id="MJXp-Span-1534">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.987ex" height="2.057ex" viewBox="0 -780.1 3439 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="2386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="2909" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-90"> \ lambda </script>  : <strong>wavelength (wavelength) of the</strong> incoming light; </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1541"><span class="MJXp-mtext" id="MJXp-Span-1542">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.057ex" viewBox="0 -780.1 2545.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-91"> \ theta </script>  : <strong>scattering angle</strong> ; </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-92-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.339ex" height="2.057ex" viewBox="0 -780.1 576.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-92"> h </script>  : <strong>altitude of a</strong> point; </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">n</span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1553">1.00029</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-93-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.115ex" height="1.937ex" viewBox="0 -728.2 5216.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="878" y="0"></use><g transform="translate(1934,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-30" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-30" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-30" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-39" x="2781" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-93"> n = 1.00029 </script>  : air <strong>refractive index</strong> ; </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">N</span><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1557">2.504</span><span class="MJXp-mtext" id="MJXp-Span-1558">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">t</span><span class="MJXp-msubsup" id="MJXp-Span-1563"><span class="MJXp-mn" id="MJXp-Span-1564" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1565" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1566">25</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-94-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.43ex" height="2.419ex" viewBox="0 -935.7 8365.9 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-4E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="1166" y="0"></use><g transform="translate(2222,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-35" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-30" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-34" x="1780" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="4753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="5710" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="6195" y="0"></use><g transform="translate(6557,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-30" x="500" y="0"></use><g transform="translate(1001,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-35" x="500" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-94"> N = 2.504 \ cdot 10 ^ {25} </script>  : number of molecules per cubic meter of standard atmosphere; </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1567"><span class="MJXp-mtext" id="MJXp-Span-1568">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">o</span><span class="MJXp-mtext" id="MJXp-Span-1572">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">t</span><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">h</span><span class="MJXp-mtext" id="MJXp-Span-1579">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">t</span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-95-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.446ex" height="2.66ex" viewBox="0 -832 7511.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="1278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="2778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="4080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="4906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="5358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="5703" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="6184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="6760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="7122" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-95"> \ rho \ left (h \ right) </script>  : <strong>density coefficient</strong> . This number at sea level is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1586"><span class="MJXp-mn" id="MJXp-Span-1587">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-96-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.937ex" viewBox="0 -728.2 500.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-96"> 1 </script>  , and exponentially decreases with increasing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-97-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.339ex" height="2.057ex" viewBox="0 -780.1 576.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-97"> h </script>  .  Much can be said about this function, and we will look at it in the following sections. </li></ul><br><div class="spoiler">  <b class="spoiler_title">But this is not the Rayleigh scattering equation!</b> <div class="spoiler_text">  If you met Rayleigh scattering not in the field of computer graphics, then there is a chance that you have seen another equation.  For example, presented in the article <a href="https://en.wikipedia.org/wiki/Rayleigh_scattering" rel="noopener">‚ÄúRayleigh scattering‚Äù</a> on Wikipedia, is very different. <br><br>  The equation used in this tutorial is taken from the Scientific article ‚Äú <a href="http://nishitalab.org/user/nis/cdrom/sig93_nis.pdf" rel="noopener">Taking into Account Atmospheric Scattering</a> , Nishita <em>et al.</em> </div></div><br><div class="spoiler">  <b class="spoiler_title">Where does this function come from?</b> <div class="spoiler_text">  One of the objectives of this blog is to explain the output of all the obtained values.  Unfortunately, this does not apply to Rayleigh scattering. <br><br>  If you are still interested in understanding why particles of light are so strangely reflected from air molecules, then the following explanation can provide an intuitive understanding of what is happening. <br><br>  The cause of Rayleigh scattering is in fact not the ‚Äúrepulsion‚Äù of particles.  Light is an electromagnetic wave, and it can interact with a charge imbalance present in certain molecules.  These charges are saturated by absorbing the resulting electromagnetic radiation, which is later emitted again.  The angular shape shown in the angular function shows how air molecules become <strong>electrical dipoles</strong> radiating like microscopic antennas. </div></div><br>  The first thing that can be noticed in Rayleigh scattering is that more light travels in some directions than in others.  The second important aspect is that the amount of scattered light strongly depends on the wavelength <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1590"><span class="MJXp-mtext" id="MJXp-Span-1591">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-98-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.987ex" height="2.057ex" viewBox="0 -780.1 3439 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="2386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="2909" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-98"> \ lambda </script>  the coming light.  The pie chart shown below visualizes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">S</span><span class="MJXp-mtext" id="MJXp-Span-1600">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">t</span><span class="MJXp-mo" id="MJXp-Span-1605" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1606">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">a</span><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1614">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619">a</span><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1621">0</span><span class="MJXp-mtext" id="MJXp-Span-1622">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">t</span><span class="MJXp-mo" id="MJXp-Span-1628" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-99-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.64ex" height="2.66ex" viewBox="0 -832 13192.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="3212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="4918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="5871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="6401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="7096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="7457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="8034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-30" x="9836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="10587" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="11038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="11384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="12441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="12802" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-99"> S \ left (\ lambda, \ theta, 0 \ right) </script>  for three different wavelengths.  Calculation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-100-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-100"> S </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">h</span><span class="MJXp-mo" id="MJXp-Span-1633" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1634">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-101-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.6ex" height="2.057ex" viewBox="0 -780.1 2411.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-30" x="1910" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-101"> h = 0 </script>  often called <strong>sea ‚Äã‚Äãlevel scattering</strong> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_q/f7/sj/_qf7sjiuc2wertcvqfxm73qwwga.png"></div><br>  The figure below shows the visualization of the scattering coefficients for a continuous range of wavelengths / colors of the visible spectrum (code is available in <a href="https://www.shadertoy.com/view/4tsyWs" rel="noopener">ShaderToy</a> ). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e0/759/bb1/9e0759bb1bc973b9d9d9998c844f3610.png" width="800" height="450"></div><br>  The center of the image looks black, because the wavelengths in this range are outside the visible spectrum. <br><br><h4>  Rayleigh scattering coefficient </h4><br>  Rayleigh scattering equation shows how much light is scattered in a certain direction.  However, it does not tell us how much energy has been dissipated.  To calculate this, we need to take into account the dissipation of energy in <em>all</em> directions.  The derivation of the equation is not easy;  if you have not mastered the complex analysis, here is the result: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1635"><span class="MJXp-mtext" id="MJXp-Span-1636">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">a</span><span class="MJXp-mtext" id="MJXp-Span-1641">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">t</span><span class="MJXp-mo" id="MJXp-Span-1646" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1647">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">a</span><span class="MJXp-mo" id="MJXp-Span-1654" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">h</span><span class="MJXp-mtext" id="MJXp-Span-1656">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661">t</span><span class="MJXp-mo" id="MJXp-Span-1662" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1664">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668">c</span><span class="MJXp-mrow" id="MJXp-Span-1669"><span class="MJXp-mn" id="MJXp-Span-1670">8</span><span class="MJXp-mtext" id="MJXp-Span-1671">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">p</span><span class="MJXp-msubsup" id="MJXp-Span-1673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1675" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mtext" id="MJXp-Span-1676">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">t</span><span class="MJXp-mo" id="MJXp-Span-1681" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1684" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1685" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1686">1</span><span class="MJXp-mtext" id="MJXp-Span-1687">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">t</span><span class="MJXp-msubsup" id="MJXp-Span-1693"><span class="MJXp-mo" id="MJXp-Span-1694" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1695" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1696"><span class="MJXp-mn" id="MJXp-Span-1697">3</span></span><span class="MJXp-mtext" id="MJXp-Span-1698">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">c</span><span class="MJXp-mrow" id="MJXp-Span-1703"><span class="MJXp-mtext" id="MJXp-Span-1704">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">o</span><span class="MJXp-mtext" id="MJXp-Span-1708">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712">t</span><span class="MJXp-mo" id="MJXp-Span-1713" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">h</span><span class="MJXp-mtext" id="MJXp-Span-1715">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">t</span><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1724">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728">c</span><span class="MJXp-mrow" id="MJXp-Span-1729"><span class="MJXp-mn" id="MJXp-Span-1730">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1731"><span class="MJXp-mtext" id="MJXp-Span-1732">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">d</span><span class="MJXp-msubsup" id="MJXp-Span-1738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1740" style="vertical-align: 0.5em;">4</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-102-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="100.798ex" height="3.021ex" viewBox="0 -987.6 43398.8 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="1507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2287" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="3052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3964" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="4902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="5431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="6310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="6739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="7263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="7792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="8237" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="9064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="9515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="9861" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="10341" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="10918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="11279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="11946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="13253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="13803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="14255" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="14784" y="0"></use><g transform="translate(15218,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-38" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-70" x="750" y="0"></use><g transform="translate(1254,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-33" x="488" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="3068" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3618" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3980" y="0"></use><g transform="translate(4369,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32" x="849" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2212" x="5646" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31" x="6647" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="7397" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="7849" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="8194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="8675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="9251" y="0"></use><g transform="translate(9613,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32" x="550" y="583"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-33" x="25674" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="26425" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="26975" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="27427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="27956" y="0"></use><g transform="translate(28390,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="1278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="2778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="4080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="4906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="5358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="5703" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="6184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="6760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="7122" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-4E" x="35901" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="37040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="37590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="38042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="38571" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31" x="39005" y="0"></use><g transform="translate(39505,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="2386" y="0"></use><g transform="translate(2909,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-34" x="748" y="583"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-102"> \ beta \ left (\ lambda, h \ right) = \ frac {8 \ pi ^ 3 \ left (n ^ 2-1 \ right) ^ 2} {3} \ frac {\ rho \ left (h \ right )} {N} \ frac {1} {\ lambda ^ 4} </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1741"><span class="MJXp-mtext" id="MJXp-Span-1742">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">a</span><span class="MJXp-mtext" id="MJXp-Span-1747">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">t</span><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1753">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">a</span><span class="MJXp-mo" id="MJXp-Span-1760" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">h</span><span class="MJXp-mtext" id="MJXp-Span-1762">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767">t</span><span class="MJXp-mo" id="MJXp-Span-1768" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-103-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.103ex" height="2.66ex" viewBox="0 -832 11669.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="1507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2287" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="3052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3964" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="4902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="5431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="6310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="6739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="7263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="7792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="8237" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="9064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="9515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="9861" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="10341" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="10918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="11279" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-103"> \ beta \ left (\ lambda, h \ right) </script>  shows the fraction of energy that is lost due to scattering after a collision with a single particle.  Often this value is called <strong>the Rayleigh scatter coefficient</strong> . <br><br>  If you read the previous part of the tutorial, you can guess that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1769"><span class="MJXp-mtext" id="MJXp-Span-1770">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-104-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.731ex" height="2.057ex" viewBox="0 -780.1 2037 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="1507" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-104"> \ beta </script>  is actually <strong>the attenuation coefficient</strong> that was used in determining the transmittance <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">T</span><span class="MJXp-mtext" id="MJXp-Span-1777">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">t</span><span class="MJXp-mo" id="MJXp-Span-1782" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1783">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">e</span><span class="MJXp-mrow" id="MJXp-Span-1792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">B</span></span><span class="MJXp-mtext" id="MJXp-Span-1795">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">t</span><span class="MJXp-mo" id="MJXp-Span-1801" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-105-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.097ex" height="2.66ex" viewBox="0 -832 11236 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2270" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="3271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="3756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="4242" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="4708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="5160" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="5458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="5804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="6404" y="0"></use><g transform="translate(6871,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="750" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="8631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="9082" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="9428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="10485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="10846" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-105"> T \ left (\ overline {AB} \ right) </script>  on the segment <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1802"><span class="MJXp-mtext" id="MJXp-Span-1803">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">e</span><span class="MJXp-mrow" id="MJXp-Span-1812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">B</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-106-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.449ex" height="2.057ex" viewBox="0 -780.1 5360 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-76" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="1687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="2437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="2783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="3383" y="0"></use><g transform="translate(3850,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-42" x="750" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-106"> \ overline {AB} </script>  . <br><br>  Unfortunately, the calculation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1815"><span class="MJXp-mtext" id="MJXp-Span-1816">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-107-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.731ex" height="2.057ex" viewBox="0 -780.1 2037 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="1507" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-107"> \ beta </script>  very expensive.  In the shader that we are going to write, I will try to save as much as possible calculations.  For this reason, it will be useful to ‚Äúextract‚Äù all factors from the scattering coefficient, which are constants.  What gives us <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1821"><span class="MJXp-mtext" id="MJXp-Span-1822">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">a</span><span class="MJXp-mtext" id="MJXp-Span-1827">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1830">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831">t</span><span class="MJXp-mo" id="MJXp-Span-1832" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1833">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">a</span><span class="MJXp-mtext" id="MJXp-Span-1840">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">t</span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-108-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.73ex" height="2.66ex" viewBox="0 -832 10647.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="1507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2287" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="3052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3964" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="4902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="5431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="6310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="6739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="7263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="8042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="8494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="8839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9320" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="9896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="10258" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-108"> \ beta \ left (\ lambda \ right) </script>  , which is called <strong>the Rayleigh scattering coefficient at sea level</strong> ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">h</span><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1850">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-109-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.6ex" height="2.057ex" viewBox="0 -780.1 2411.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-30" x="1910" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-109"> h = 0 </script>  ): <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1851"><span class="MJXp-mtext" id="MJXp-Span-1852">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">a</span><span class="MJXp-mtext" id="MJXp-Span-1857">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">t</span><span class="MJXp-mo" id="MJXp-Span-1862" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1863">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1864">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869">a</span><span class="MJXp-mtext" id="MJXp-Span-1870">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1874">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875">t</span><span class="MJXp-mo" id="MJXp-Span-1876" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1878">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882">c</span><span class="MJXp-mrow" id="MJXp-Span-1883"><span class="MJXp-mn" id="MJXp-Span-1884">8</span><span class="MJXp-mtext" id="MJXp-Span-1885">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">p</span><span class="MJXp-msubsup" id="MJXp-Span-1887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1888" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1889" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mtext" id="MJXp-Span-1890">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">t</span><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1896"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1898" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1899" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1900">1</span><span class="MJXp-mtext" id="MJXp-Span-1901">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1903">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906">t</span><span class="MJXp-msubsup" id="MJXp-Span-1907"><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1909" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1910"><span class="MJXp-mn" id="MJXp-Span-1911">3</span></span><span class="MJXp-mtext" id="MJXp-Span-1912">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">c</span><span class="MJXp-mrow" id="MJXp-Span-1917"><span class="MJXp-mn" id="MJXp-Span-1918">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1919"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1921">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">c</span><span class="MJXp-mrow" id="MJXp-Span-1926"><span class="MJXp-mn" id="MJXp-Span-1927">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1928"><span class="MJXp-mtext" id="MJXp-Span-1929">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">d</span><span class="MJXp-msubsup" id="MJXp-Span-1935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1937" style="vertical-align: 0.5em;">4</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="82.141ex" height="3.021ex" viewBox="0 -987.6 35366.1 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="1507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2287" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="3052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3964" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="4603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="4902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="5431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="6310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="6739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="7263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="8042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="8494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="8839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9320" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="9896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="10258" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-3D" x="10925" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="12231" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="12782" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="13233" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="13763" y="0"></use><g transform="translate(14196,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-38" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-70" x="750" y="0"></use><g transform="translate(1254,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-33" x="488" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="2303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="2601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="3068" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="3618" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="3980" y="0"></use><g transform="translate(4369,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32" x="849" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2212" x="5646" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31" x="6647" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="7397" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="7849" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="8194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="8675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="9251" y="0"></use><g transform="translate(9613,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-32" x="550" y="583"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-33" x="24653" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="25403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="25954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="26405" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="26935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31" x="27368" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-4E" x="27869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="29007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="29558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="30009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-63" x="30539" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-31" x="30972" y="0"></use><g transform="translate(31473,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="2386" y="0"></use><g transform="translate(2909,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-34" x="748" y="583"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-110"> \ beta \ left (\ lambda \ right) = \ frac {8 \ pi ^ 3 \ left (n ^ 2-1 \ right) ^ 2} {3} \ frac {1} {N} \ frac {1} {\ lambda ^ 4} </script></p><br><div class="spoiler">  <b class="spoiler_title">Show me the calculations!</b> <div class="spoiler_text">  The Rayleigh scattering equation shows us a fraction of the energy dissipated in a certain direction.  To calculate the total loss, we need to consider all possible directions.  Summation on the continuous interval requires <strong>integration</strong> . <br><br>  You can try to integrate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1939">S</span><span class="MJXp-mtext" id="MJXp-Span-1940">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1941">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1944">t</span><span class="MJXp-mo" id="MJXp-Span-1945" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1946">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1947">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1952">a</span><span class="MJXp-mo" id="MJXp-Span-1953" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1954">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1956">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959">a</span><span class="MJXp-mo" id="MJXp-Span-1960" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1961">h</span><span class="MJXp-mtext" id="MJXp-Span-1962">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1967">t</span><span class="MJXp-mo" id="MJXp-Span-1968" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.817ex" height="2.762ex" viewBox="0 -831.5 13268.3 1189" role="img" focusable="false" style="vertical-align: -0.83ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-66" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="2211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-28" x="2572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6C" x="3212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="3510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-6D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-62" x="4918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-64" x="5348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="5871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="6401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="7096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="7457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="8034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="8500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="8862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-2C" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="9836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-72" x="10663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-69" x="11114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-67" x="11460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="11940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="12517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMAIN-29" x="12878" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-111"> S \ left (\ lambda, \ theta, h \ right) </script>  by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1969"><span class="MJXp-mtext" id="MJXp-Span-1970">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.074ex" viewBox="0 -772.3 2545.5 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345630/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj7XQxQP230IZzyKus9E9iHaILH9g#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-112"> \ theta </script>  on the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1976"><span class="MJXp-mtext" id="MJXp-Span-1977">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1979">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">t</span><span class="MJXp-mo" id="MJXp-Span-1982" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1983">0</span><span class="MJXp-mo" id="MJXp-Span-1984" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1985">2</span><span class="MJXp-mtext" id="MJXp-Span-1986">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">i</span><span class="MJXp-mtext" id="MJXp-Span-1989">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1990">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994">t</span><span class="MJXp-mo" id="MJXp-Span-1995" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-113"> \ left [0,2 \ pi \ right] </script>  but it will be a mistake. <br><br>  Despite the fact that we visualized Rayleigh scattering in two dimensions, this is actually a three-dimensional phenomenon.  Scattering angle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1996"><span class="MJXp-mtext" id="MJXp-Span-1997">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2002">a</span></span></span><script type="math/tex" id="MathJax-Element-114"> \ theta </script>  can take any direction in 3D space.  Calculations taking into account the full distribution of the function, which depends on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2003"><span class="MJXp-mtext" id="MJXp-Span-2004">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">a</span></span></span><script type="math/tex" id="MathJax-Element-115"> \ theta </script>  in three-dimensional space (as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011">S</span></span></span><script type="math/tex" id="MathJax-Element-116"> S </script>  ) is called the <strong>integration over the solid angle</strong> : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2012"><span class="MJXp-mtext" id="MJXp-Span-2013">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017">a</span><span class="MJXp-mtext" id="MJXp-Span-2018">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2021">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022">t</span><span class="MJXp-mo" id="MJXp-Span-2023" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2024">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030">a</span><span class="MJXp-mo" id="MJXp-Span-2031" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2032">h</span><span class="MJXp-mtext" id="MJXp-Span-2033">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2035">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038">t</span><span class="MJXp-mo" id="MJXp-Span-2039" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2040" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2041">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043">n</span><span class="MJXp-msubsup" id="MJXp-Span-2044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2048"><span class="MJXp-mn" id="MJXp-Span-2049">2</span><span class="MJXp-mtext" id="MJXp-Span-2050">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2052">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2046"><span class="MJXp-mn" id="MJXp-Span-2047">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2053">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055">n</span><span class="MJXp-msubsup" id="MJXp-Span-2056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2060"><span class="MJXp-mtext" id="MJXp-Span-2061">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2062">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2058"><span class="MJXp-mn" id="MJXp-Span-2059">0</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064">S</span><span class="MJXp-mtext" id="MJXp-Span-2065">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2068">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2069">t</span><span class="MJXp-mo" id="MJXp-Span-2070" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2071">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2074">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2075">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077">a</span><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2079">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2083">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084">a</span><span class="MJXp-mo" id="MJXp-Span-2085" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086">h</span><span class="MJXp-mtext" id="MJXp-Span-2087">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2091">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">t</span><span class="MJXp-mo" id="MJXp-Span-2093" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-2094">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2096">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2097">n</span><span class="MJXp-mtext" id="MJXp-Span-2098">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2099">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2102">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2103">a</span><span class="MJXp-mspace" id="MJXp-Span-2104" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105">d</span><span class="MJXp-mtext" id="MJXp-Span-2106">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2108">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2109">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2110">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2112">d</span><span class="MJXp-mtext" id="MJXp-Span-2113">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2115">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">i</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-117"> \ beta \ left (\ lambda, h \ right) = \ int_ {0} ^ {2 \ pi} \ int_ {0} ^ {\ pi} S \ left (\ lambda, \ theta, h \ right) \ sin \ theta \, d \ theta d \ phi </script></p><br>  Internal integral moves <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2117"><span class="MJXp-mtext" id="MJXp-Span-2118">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2120">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2121">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2122">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2123">a</span></span></span><script type="math/tex" id="MathJax-Element-118"> \ theta </script>  in the XY plane, and the outer one rotates the result around the X axis to take into account the third dimension.  Added <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2124"><span class="MJXp-mtext" id="MJXp-Span-2125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2128">n</span><span class="MJXp-mtext" id="MJXp-Span-2129">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2130">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2133">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134">a</span></span></span><script type="math/tex" id="MathJax-Element-119"> \ sin \ theta </script>  used for spherical angles. <br><br>  The integration process is only interested in what depends on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2135"><span class="MJXp-mtext" id="MJXp-Span-2136">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2138">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2140">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141">a</span></span></span><script type="math/tex" id="MathJax-Element-120"> \ theta </script>  .  Several members <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2143">S</span><span class="MJXp-mtext" id="MJXp-Span-2144">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2146">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148">t</span><span class="MJXp-mo" id="MJXp-Span-2149" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2150">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2152">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2153">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2154">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2155">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156">a</span><span class="MJXp-mo" id="MJXp-Span-2157" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2158">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2159">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2160">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2162">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2163">a</span><span class="MJXp-mo" id="MJXp-Span-2164" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2165">h</span><span class="MJXp-mtext" id="MJXp-Span-2166">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2167">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2169">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">t</span><span class="MJXp-mo" id="MJXp-Span-2172" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-121"> S \ left (\ lambda, \ theta, h \ right) </script>  are constant, so they can be transferred from under the integral sign: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2173"><span class="MJXp-mtext" id="MJXp-Span-2174">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2175">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2176">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2177">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2178">a</span><span class="MJXp-mtext" id="MJXp-Span-2179">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2180">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2182">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2183">t</span><span class="MJXp-mo" id="MJXp-Span-2184" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2185">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2187">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2188">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2189">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2190">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2191">a</span><span class="MJXp-mo" id="MJXp-Span-2192" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2193">h</span><span class="MJXp-mtext" id="MJXp-Span-2194">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2196">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2197">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2199">t</span><span class="MJXp-mo" id="MJXp-Span-2200" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2201" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2202">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2204">n</span><span class="MJXp-msubsup" id="MJXp-Span-2205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2206" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2209"><span class="MJXp-mn" id="MJXp-Span-2210">2</span><span class="MJXp-mtext" id="MJXp-Span-2211">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2213">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2207"><span class="MJXp-mn" id="MJXp-Span-2208">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2214">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2216">n</span><span class="MJXp-msubsup" id="MJXp-Span-2217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2221"><span class="MJXp-mtext" id="MJXp-Span-2222">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2224">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2219"><span class="MJXp-mn" id="MJXp-Span-2220">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2228">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2229">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2230">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2232">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">t</span><span class="MJXp-mrow" id="MJXp-Span-2234"><span class="MJXp-mtext" id="MJXp-Span-2235">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2238">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239">t</span><span class="MJXp-mrow" id="MJXp-Span-2240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2241">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2245">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248">t</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2249"><span class="MJXp-mtext" id="MJXp-Span-2250">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2251">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2254">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2256">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2257">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2258">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260">e</span><span class="MJXp-mrow" id="MJXp-Span-2261"><span class="MJXp-mtext" id="MJXp-Span-2262">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2265">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2266">c</span><span class="MJXp-mrow" id="MJXp-Span-2267"><span class="MJXp-mtext" id="MJXp-Span-2268">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">p</span><span class="MJXp-msubsup" id="MJXp-Span-2270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2271" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2272" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2273">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2274">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2275">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277">t</span><span class="MJXp-mo" id="MJXp-Span-2278" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2281" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2282" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2283">1</span><span class="MJXp-mtext" id="MJXp-Span-2284">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2286">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2288">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">t</span><span class="MJXp-msubsup" id="MJXp-Span-2290"><span class="MJXp-mo" id="MJXp-Span-2291" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2292" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2293"><span class="MJXp-mn" id="MJXp-Span-2294">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2295">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2296">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2297">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2298">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2299">c</span><span class="MJXp-mrow" id="MJXp-Span-2300"><span class="MJXp-mtext" id="MJXp-Span-2301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2302">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2303">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304">o</span><span class="MJXp-mtext" id="MJXp-Span-2305">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2306">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2308">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2309">t</span><span class="MJXp-mo" id="MJXp-Span-2310" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311">h</span><span class="MJXp-mtext" id="MJXp-Span-2312">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2313">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2314">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2317">t</span><span class="MJXp-mo" id="MJXp-Span-2318" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-2319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320">N</span></span><span class="MJXp-mtext" id="MJXp-Span-2321">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2322">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2323">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2324">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2325">c</span><span class="MJXp-mrow" id="MJXp-Span-2326"><span class="MJXp-mn" id="MJXp-Span-2327">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2328"><span class="MJXp-mtext" id="MJXp-Span-2329">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2330">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2331">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2332">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334">d</span><span class="MJXp-msubsup" id="MJXp-Span-2335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2337" style="vertical-align: 0.5em;">4</span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2338">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2339">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2340">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2342">t</span><span class="MJXp-mo" id="MJXp-Span-2343" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2344">1</span><span class="MJXp-mo" id="MJXp-Span-2345" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2346">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348">o</span><span class="MJXp-msubsup" id="MJXp-Span-2349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2350" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2351" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2352">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2355">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357">a</span><span class="MJXp-mtext" id="MJXp-Span-2358">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2363">t</span><span class="MJXp-mo" id="MJXp-Span-2364" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-2365">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2368">n</span><span class="MJXp-mtext" id="MJXp-Span-2369">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2370">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2372">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">a</span><span class="MJXp-mspace" id="MJXp-Span-2375" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2376">d</span><span class="MJXp-mtext" id="MJXp-Span-2377">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2378">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2380">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2382">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2383">d</span><span class="MJXp-mtext" id="MJXp-Span-2384">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2387">i</span><span class="MJXp-mo" id="MJXp-Span-2388" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-122"> \ beta \ left (\ lambda, h \ right) = \ int_ {0} ^ {2 \ pi} \ int_ {0} ^ {\ pi} \ underset {\ text {constant}} {\ underbrace {\ frac {\ pi ^ 2 \ left (n ^ 2-1 \ right) ^ 2} {2} \ frac {\ rho \ left (h \ right)} {N} \ frac {1} {\ lambda ^ 4}} } \ left (1+ \ cos ^ 2 \ theta \ right) \ sin \ theta \, d \ theta d \ phi = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2389"><span class="MJXp-mo" id="MJXp-Span-2390" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2391">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2393">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2395">c</span><span class="MJXp-mrow" id="MJXp-Span-2396"><span class="MJXp-mtext" id="MJXp-Span-2397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398">p</span><span class="MJXp-msubsup" id="MJXp-Span-2399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2400" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2401" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2402">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2403">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2405">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">t</span><span class="MJXp-mo" id="MJXp-Span-2407" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2409" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2410" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2411" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2412">1</span><span class="MJXp-mtext" id="MJXp-Span-2413">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2414">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2416">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2417">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2418">t</span><span class="MJXp-msubsup" id="MJXp-Span-2419"><span class="MJXp-mo" id="MJXp-Span-2420" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2421" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2422"><span class="MJXp-mn" id="MJXp-Span-2423">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2424">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2425">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2427">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2428">c</span><span class="MJXp-mrow" id="MJXp-Span-2429"><span class="MJXp-mtext" id="MJXp-Span-2430">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2431">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2432">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2433">o</span><span class="MJXp-mtext" id="MJXp-Span-2434">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2436">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2437">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2438">t</span><span class="MJXp-mo" id="MJXp-Span-2439" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2440">h</span><span class="MJXp-mtext" id="MJXp-Span-2441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2443">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2444">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2445">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2446">t</span><span class="MJXp-mo" id="MJXp-Span-2447" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-2448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449">N</span></span><span class="MJXp-mtext" id="MJXp-Span-2450">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2453">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">c</span><span class="MJXp-mrow" id="MJXp-Span-2455"><span class="MJXp-mn" id="MJXp-Span-2456">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2457"><span class="MJXp-mtext" id="MJXp-Span-2458">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2459">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2460">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2463">d</span><span class="MJXp-msubsup" id="MJXp-Span-2464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2465" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2466" style="vertical-align: 0.5em;">4</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2467">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2468">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2469">n</span><span class="MJXp-msubsup" id="MJXp-Span-2470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2471" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2474"><span class="MJXp-mn" id="MJXp-Span-2475">2</span><span class="MJXp-mtext" id="MJXp-Span-2476">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2477">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2472"><span class="MJXp-mn" id="MJXp-Span-2473">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2479">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2480">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2481">n</span><span class="MJXp-msubsup" id="MJXp-Span-2482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2486"><span class="MJXp-mtext" id="MJXp-Span-2487">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2488">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2489">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2484"><span class="MJXp-mn" id="MJXp-Span-2485">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2490">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2491">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2492">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2494">t</span><span class="MJXp-mo" id="MJXp-Span-2495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2496">1</span><span class="MJXp-mo" id="MJXp-Span-2497" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2498">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500">o</span><span class="MJXp-msubsup" id="MJXp-Span-2501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2503" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2504">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2505">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2506">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2508">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2509">a</span><span class="MJXp-mtext" id="MJXp-Span-2510">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2511">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2512">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2513">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2515">t</span><span class="MJXp-mo" id="MJXp-Span-2516" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-2517">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2518">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2519">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520">n</span><span class="MJXp-mtext" id="MJXp-Span-2521">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2522">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2523">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2524">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2525">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2526">a</span><span class="MJXp-mspace" id="MJXp-Span-2527" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2528">d</span><span class="MJXp-mtext" id="MJXp-Span-2529">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2530">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2531">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2533">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2534">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535">d</span><span class="MJXp-mtext" id="MJXp-Span-2536">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2537">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2538">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539">i</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-123"> = \ frac {\ pi ^ 2 \ left (n ^ 2-1 \ right) ^ 2} {2} \ frac {\ rho \ left (h \ right)} {N} \ frac {1} {\ lambda ^ 4} \ int_ {0} ^ {2 \ pi} \ int_ {0} ^ {\ pi} \ left (1+ \ cos ^ 2 \ theta \ right) \ sin \ theta \, d \ theta d \ phi </script></p><br>  This greatly simplifies the internal integral, which now takes the following form: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2540"><span class="MJXp-mtext" id="MJXp-Span-2541">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2542">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2543">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2544">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2545">a</span><span class="MJXp-mtext" id="MJXp-Span-2546">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2547">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2548">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2550">t</span><span class="MJXp-mo" id="MJXp-Span-2551" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2552">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2553">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2554">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2557">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558">a</span><span class="MJXp-mo" id="MJXp-Span-2559" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2560">h</span><span class="MJXp-mtext" id="MJXp-Span-2561">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2562">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2564">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2565">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2566">t</span><span class="MJXp-mo" id="MJXp-Span-2567" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2568" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2569">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2570">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2571">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2572">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2573">c</span><span class="MJXp-mrow" id="MJXp-Span-2574"><span class="MJXp-mtext" id="MJXp-Span-2575">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2576">p</span><span class="MJXp-msubsup" id="MJXp-Span-2577"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2578" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2579" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2580">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2581">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2583">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2584">t</span><span class="MJXp-mo" id="MJXp-Span-2585" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2587" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2588" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2589" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2590">1</span><span class="MJXp-mtext" id="MJXp-Span-2591">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2592">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2593">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2594">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2596">t</span><span class="MJXp-msubsup" id="MJXp-Span-2597"><span class="MJXp-mo" id="MJXp-Span-2598" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2599" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2600"><span class="MJXp-mn" id="MJXp-Span-2601">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2602">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2603">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2604">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2605">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2606">c</span><span class="MJXp-mrow" id="MJXp-Span-2607"><span class="MJXp-mtext" id="MJXp-Span-2608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2609">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2610">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2611">o</span><span class="MJXp-mtext" id="MJXp-Span-2612">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2613">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2614">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2615">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2616">t</span><span class="MJXp-mo" id="MJXp-Span-2617" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618">h</span><span class="MJXp-mtext" id="MJXp-Span-2619">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2620">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2622">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2623">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2624">t</span><span class="MJXp-mo" id="MJXp-Span-2625" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-2626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2627">N</span></span><span class="MJXp-mtext" id="MJXp-Span-2628">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2629">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2630">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2631">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2632">c</span><span class="MJXp-mrow" id="MJXp-Span-2633"><span class="MJXp-mn" id="MJXp-Span-2634">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2635"><span class="MJXp-mtext" id="MJXp-Span-2636">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2639">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2640">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2641">d</span><span class="MJXp-msubsup" id="MJXp-Span-2642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2643" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2644" style="vertical-align: 0.5em;">4</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2645">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2646">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2647">n</span><span class="MJXp-msubsup" id="MJXp-Span-2648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2649" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2652"><span class="MJXp-mn" id="MJXp-Span-2653">2</span><span class="MJXp-mtext" id="MJXp-Span-2654">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2655">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2656">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2650"><span class="MJXp-mn" id="MJXp-Span-2651">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2657">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2658">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2659">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2660">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2661">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2662">d</span><span class="MJXp-mrow" id="MJXp-Span-2663"><span class="MJXp-mtext" id="MJXp-Span-2664">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2666">n</span><span class="MJXp-msubsup" id="MJXp-Span-2667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2668" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2671"><span class="MJXp-mtext" id="MJXp-Span-2672">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2673">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2674">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2669"><span class="MJXp-mn" id="MJXp-Span-2670">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2675">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2676">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2677">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2678">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2679">t</span><span class="MJXp-mo" id="MJXp-Span-2680" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2681">1</span><span class="MJXp-mo" id="MJXp-Span-2682" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2683">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2684">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685">o</span><span class="MJXp-msubsup" id="MJXp-Span-2686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2687" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2688" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2689">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2690">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2691">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2692">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2694">a</span><span class="MJXp-mtext" id="MJXp-Span-2695">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2696">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2697">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2698">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2699">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2700">t</span><span class="MJXp-mo" id="MJXp-Span-2701" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-2702">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2703">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2704">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2705">n</span><span class="MJXp-mtext" id="MJXp-Span-2706">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2707">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2708">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2709">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2710">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2711">a</span><span class="MJXp-mspace" id="MJXp-Span-2712" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2713">d</span><span class="MJXp-mtext" id="MJXp-Span-2714">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2715">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2716">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2718">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2719">a</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2720">d</span><span class="MJXp-mtext" id="MJXp-Span-2721">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2722">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2723">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2724">i</span><span class="MJXp-mo" id="MJXp-Span-2725" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-124"> \ beta \ left (\ lambda, h \ right) = \ frac {\ pi ^ 2 \ left (n ^ 2-1 \ right) ^ 2} {2} \ frac {\ rho \ left (h \ right) } {N} \ frac {1} {\ lambda ^ 4} \ int_ {0} ^ {2 \ pi} \ boxed {\ int_ {0} ^ {\ pi} \ left (1+ \ cos ^ 2 \ theta \ right) \ sin \ theta \, d \ theta} d \ phi = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2726"><span class="MJXp-mo" id="MJXp-Span-2727" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2728">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2729">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2731">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2732">c</span><span class="MJXp-mrow" id="MJXp-Span-2733"><span class="MJXp-mtext" id="MJXp-Span-2734">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2735">p</span><span class="MJXp-msubsup" id="MJXp-Span-2736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2737" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2738" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2739">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2740">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2741">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2742">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2743">t</span><span class="MJXp-mo" id="MJXp-Span-2744" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2746" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2747" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2748" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2749">1</span><span class="MJXp-mtext" id="MJXp-Span-2750">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2751">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2752">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2753">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2754">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2755">t</span><span class="MJXp-msubsup" id="MJXp-Span-2756"><span class="MJXp-mo" id="MJXp-Span-2757" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2758" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2759"><span class="MJXp-mn" id="MJXp-Span-2760">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2761">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2762">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2763">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2764">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765">c</span><span class="MJXp-mrow" id="MJXp-Span-2766"><span class="MJXp-mtext" id="MJXp-Span-2767">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2769">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2770">o</span><span class="MJXp-mtext" id="MJXp-Span-2771">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2772">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2773">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2774">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2775">t</span><span class="MJXp-mo" id="MJXp-Span-2776" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2777">h</span><span class="MJXp-mtext" id="MJXp-Span-2778">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2779">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2780">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2781">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2782">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2783">t</span><span class="MJXp-mo" id="MJXp-Span-2784" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-2785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2786">N</span></span><span class="MJXp-mtext" id="MJXp-Span-2787">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2788">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2789">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2790">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2791">c</span><span class="MJXp-mrow" id="MJXp-Span-2792"><span class="MJXp-mn" id="MJXp-Span-2793">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2794"><span class="MJXp-mtext" id="MJXp-Span-2795">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2796">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2798">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2800">d</span><span class="MJXp-msubsup" id="MJXp-Span-2801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2802" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2803" style="vertical-align: 0.5em;">4</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2804">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2805">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2806">n</span><span class="MJXp-msubsup" id="MJXp-Span-2807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2808" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2811"><span class="MJXp-mn" id="MJXp-Span-2812">2</span><span class="MJXp-mtext" id="MJXp-Span-2813">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2815">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2809"><span class="MJXp-mn" id="MJXp-Span-2810">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2816">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2817">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2818">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2819">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2820">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2821">d</span><span class="MJXp-mrow" id="MJXp-Span-2822"><span class="MJXp-mtext" id="MJXp-Span-2823">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2824">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2825">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2826">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2827">c</span><span class="MJXp-mrow" id="MJXp-Span-2828"><span class="MJXp-mn" id="MJXp-Span-2829">8</span></span><span class="MJXp-mrow" id="MJXp-Span-2830"><span class="MJXp-mn" id="MJXp-Span-2831">3</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2832">d</span><span class="MJXp-mtext" id="MJXp-Span-2833">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2834">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2835">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2836">i</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-125"> = \ frac {\ pi ^ 2 \ left (n ^ 2-1 \ right) ^ 2} {2} \ frac {\ rho \ left (h \ right)} {N} \ frac {1} {\ lambda ^ 4} \ int_ {0} ^ {2 \ pi} \ boxed {\ frac {8} {3}} d \ phi </script></p><br>  Now we can perform external integration: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2837"><span class="MJXp-mtext" id="MJXp-Span-2838">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2839">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2840">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2841">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2842">a</span><span class="MJXp-mtext" id="MJXp-Span-2843">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2844">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2845">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2846">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2847">t</span><span class="MJXp-mo" id="MJXp-Span-2848" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2849">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2850">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2851">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2852">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2854">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2855">a</span><span class="MJXp-mo" id="MJXp-Span-2856" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2857">h</span><span class="MJXp-mtext" id="MJXp-Span-2858">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2859">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2860">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2861">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2862">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2863">t</span><span class="MJXp-mo" id="MJXp-Span-2864" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2865" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2866">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2867">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2869">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2870">c</span><span class="MJXp-mrow" id="MJXp-Span-2871"><span class="MJXp-mtext" id="MJXp-Span-2872">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2873">p</span><span class="MJXp-msubsup" id="MJXp-Span-2874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2875" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2876" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2877">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2878">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2879">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2880">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2881">t</span><span class="MJXp-mo" id="MJXp-Span-2882" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2884" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2885" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2886" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2887">1</span><span class="MJXp-mtext" id="MJXp-Span-2888">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2889">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2890">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2891">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2892">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2893">t</span><span class="MJXp-msubsup" id="MJXp-Span-2894"><span class="MJXp-mo" id="MJXp-Span-2895" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2896" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2897"><span class="MJXp-mn" id="MJXp-Span-2898">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2899">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2900">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2901">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2902">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2903">c</span><span class="MJXp-mrow" id="MJXp-Span-2904"><span class="MJXp-mtext" id="MJXp-Span-2905">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2906">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2907">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2908">o</span><span class="MJXp-mtext" id="MJXp-Span-2909">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2910">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2911">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2912">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2913">t</span><span class="MJXp-mo" id="MJXp-Span-2914" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2915">h</span><span class="MJXp-mtext" id="MJXp-Span-2916">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2917">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2918">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2919">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2920">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921">t</span><span class="MJXp-mo" id="MJXp-Span-2922" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-2923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2924">N</span></span><span class="MJXp-mtext" id="MJXp-Span-2925">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2926">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2927">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2928">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2929">c</span><span class="MJXp-mrow" id="MJXp-Span-2930"><span class="MJXp-mn" id="MJXp-Span-2931">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2932"><span class="MJXp-mtext" id="MJXp-Span-2933">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2934">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2935">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2937">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2938">d</span><span class="MJXp-msubsup" id="MJXp-Span-2939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2940" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2941" style="vertical-align: 0.5em;">4</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2942">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2943">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2944">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2945">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2946">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2947">d</span><span class="MJXp-mrow" id="MJXp-Span-2948"><span class="MJXp-mtext" id="MJXp-Span-2949">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2950">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2951">n</span><span class="MJXp-msubsup" id="MJXp-Span-2952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2953" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2956"><span class="MJXp-mn" id="MJXp-Span-2957">2</span><span class="MJXp-mtext" id="MJXp-Span-2958">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2959">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2960">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2954"><span class="MJXp-mn" id="MJXp-Span-2955">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2961">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2962">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2963">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2964">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2965">c</span><span class="MJXp-mrow" id="MJXp-Span-2966"><span class="MJXp-mn" id="MJXp-Span-2967">8</span></span><span class="MJXp-mrow" id="MJXp-Span-2968"><span class="MJXp-mn" id="MJXp-Span-2969">3</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2970">d</span><span class="MJXp-mtext" id="MJXp-Span-2971">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2972">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2973">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2974">i</span></span><span class="MJXp-mo" id="MJXp-Span-2975" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-126"> \ beta \ left (\ lambda, h \ right) = \ frac {\ pi ^ 2 \ left (n ^ 2-1 \ right) ^ 2} {2} \ frac {\ rho \ left (h \ right) } {N} \ frac {1} {\ lambda ^ 4} \ boxed {\ int_ {0} ^ {2 \ pi} \ frac {8} {3} d \ phi} = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2976"><span class="MJXp-mo" id="MJXp-Span-2977" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2978">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2979">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2980">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2981">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2982">c</span><span class="MJXp-mrow" id="MJXp-Span-2983"><span class="MJXp-mtext" id="MJXp-Span-2984">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2985">p</span><span class="MJXp-msubsup" id="MJXp-Span-2986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2987" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2988" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2989">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2990">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2991">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2992">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2993">t</span><span class="MJXp-mo" id="MJXp-Span-2994" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2995"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2996" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2997" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2998" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2999">1</span><span class="MJXp-mtext" id="MJXp-Span-3000">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3001">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3002">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3003">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3004">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3005">t</span><span class="MJXp-msubsup" id="MJXp-Span-3006"><span class="MJXp-mo" id="MJXp-Span-3007" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3008" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3009"><span class="MJXp-mn" id="MJXp-Span-3010">2</span></span><span class="MJXp-mtext" id="MJXp-Span-3011">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3012">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3013">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3014">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3015">c</span><span class="MJXp-mrow" id="MJXp-Span-3016"><span class="MJXp-mtext" id="MJXp-Span-3017">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3018">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3019">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3020">o</span><span class="MJXp-mtext" id="MJXp-Span-3021">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3022">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3023">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3024">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3025">t</span><span class="MJXp-mo" id="MJXp-Span-3026" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3027">h</span><span class="MJXp-mtext" id="MJXp-Span-3028">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3029">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3030">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3031">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3032">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3033">t</span><span class="MJXp-mo" id="MJXp-Span-3034" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-3035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3036">N</span></span><span class="MJXp-mtext" id="MJXp-Span-3037">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3038">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3039">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3040">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3041">c</span><span class="MJXp-mrow" id="MJXp-Span-3042"><span class="MJXp-mn" id="MJXp-Span-3043">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3044"><span class="MJXp-mtext" id="MJXp-Span-3045">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3046">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3047">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3048">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3049">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3050">d</span><span class="MJXp-msubsup" id="MJXp-Span-3051"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3052" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3053" style="vertical-align: 0.5em;">4</span></span></span><span class="MJXp-mtext" id="MJXp-Span-3054">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3055">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3056">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3057">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3058">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3059">d</span><span class="MJXp-mrow" id="MJXp-Span-3060"><span class="MJXp-mtext" id="MJXp-Span-3061">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3062">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3063">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3064">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3065">c</span><span class="MJXp-mrow" id="MJXp-Span-3066"><span class="MJXp-mn" id="MJXp-Span-3067">16</span><span class="MJXp-mtext" id="MJXp-Span-3068">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3069">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3070">i</span></span><span class="MJXp-mrow" id="MJXp-Span-3071"><span class="MJXp-mn" id="MJXp-Span-3072">3</span></span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-127"> = \ frac {\ pi ^ 2 \ left (n ^ 2-1 \ right) ^ 2} {2} \ frac {\ rho \ left (h \ right)} {N} \ frac {1} {\ lambda ^ 4} \ boxed {\ frac {16 \ pi} {3}} </script></p><br>  Which brings us to the final look: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3073"><span class="MJXp-mtext" id="MJXp-Span-3074">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3075">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3076">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3077">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3078">a</span><span class="MJXp-mtext" id="MJXp-Span-3079">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3080">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3081">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3082">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3083">t</span><span class="MJXp-mo" id="MJXp-Span-3084" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3085">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3086">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3087">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3088">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3089">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3090">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3091">a</span><span class="MJXp-mo" id="MJXp-Span-3092" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3093">h</span><span class="MJXp-mtext" id="MJXp-Span-3094">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3095">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3096">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3097">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3098">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3099">t</span><span class="MJXp-mo" id="MJXp-Span-3100" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3101" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3102">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3103">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3104">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3105">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3106">c</span><span class="MJXp-mrow" id="MJXp-Span-3107"><span class="MJXp-mn" id="MJXp-Span-3108">8</span><span class="MJXp-mtext" id="MJXp-Span-3109">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3110">p</span><span class="MJXp-msubsup" id="MJXp-Span-3111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3112" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3113" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mtext" id="MJXp-Span-3114">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3115">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3116">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3117">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3118">t</span><span class="MJXp-mo" id="MJXp-Span-3119" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3121" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3122" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3123" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3124">1</span><span class="MJXp-mtext" id="MJXp-Span-3125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3126">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3127">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3128">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3129">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3130">t</span><span class="MJXp-msubsup" id="MJXp-Span-3131"><span class="MJXp-mo" id="MJXp-Span-3132" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3133" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3134"><span class="MJXp-mn" id="MJXp-Span-3135">3</span></span><span class="MJXp-mtext" id="MJXp-Span-3136">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3137">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3138">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3139">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3140">c</span><span class="MJXp-mrow" id="MJXp-Span-3141"><span class="MJXp-mtext" id="MJXp-Span-3142">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3143">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3144">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3145">o</span><span class="MJXp-mtext" id="MJXp-Span-3146">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3147">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3148">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3149">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3150">t</span><span class="MJXp-mo" id="MJXp-Span-3151" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3152">h</span><span class="MJXp-mtext" id="MJXp-Span-3153">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3154">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3155">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3156">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3157">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3158">t</span><span class="MJXp-mo" id="MJXp-Span-3159" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-3160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3161">N</span></span><span class="MJXp-mtext" id="MJXp-Span-3162">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3163">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3164">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3165">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3166">c</span><span class="MJXp-mrow" id="MJXp-Span-3167"><span class="MJXp-mn" id="MJXp-Span-3168">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3169"><span class="MJXp-mtext" id="MJXp-Span-3170">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3171">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3172">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3173">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3174">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3175">d</span><span class="MJXp-msubsup" id="MJXp-Span-3176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3177" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3178" style="vertical-align: 0.5em;">4</span></span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-128"> \ beta \ left (\ lambda, h \ right) = \ frac {8 \ pi ^ 3 \ left (n ^ 2-1 \ right) ^ 2} {3} \ frac {\ rho \ left (h \ right )} {N} \ frac {1} {\ lambda ^ 4} </script></p><br>  Since this is an integral that takes into account the influence of dispersion in all directions, it is logical that the expression no longer depends on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3179"><span class="MJXp-mtext" id="MJXp-Span-3180">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3181">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3182">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3183">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3184">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3185">a</span></span></span><script type="math/tex" id="MathJax-Element-129"> \ theta </script>  . </div></div><br>  This new equation gives us another way to understand how different colors are scattered.  The graph below shows the amount of scattering to which light is exposed, as a function of its wavelength. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sm/81/t9/sm81t94h6i2buomg6srzydsh8_y.png"></div><br>  This is a strong relationship between the scattering coefficient. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3186"><span class="MJXp-mtext" id="MJXp-Span-3187">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3188">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3189">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3190">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3191">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-130-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-130"> \ beta </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3192"><span class="MJXp-mtext" id="MJXp-Span-3193">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3194">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3195">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3196">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3197">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3198">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3199">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-131-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-131"> \ lambda </script>  which causes the red sky at sunset.  The photons received from the sun are distributed over a wider range of wavelengths.  Rayleigh scattering tells us that the atoms and molecules of the Earth‚Äôs atmosphere disperse the blue color more than green or red.  If the light can move long enough, then all its blue component will be lost due to scattering.  This is what happens at sunset, when the light passes almost parallel to the surface. <br><br>  Reasoning the same way, we can understand why the sky looks blue.  The light of the sun falls from one direction.  However, its blue component is scattered in all directions.  When we look at the sky, blue light comes from all directions. <br><br><h4>  Rayleigh Phase Function </h4><br>  The original equation describing Rayleigh scattering, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3201">S</span><span class="MJXp-mtext" id="MJXp-Span-3202">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3203">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3204">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3205">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3206">t</span><span class="MJXp-mo" id="MJXp-Span-3207" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3208">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3209">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3210">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3211">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3212">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3213">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3214">a</span><span class="MJXp-mo" id="MJXp-Span-3215" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-3216">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3217">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3218">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3219">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3220">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3221">a</span><span class="MJXp-mtext" id="MJXp-Span-3222">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3223">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3224">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3225">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3226">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3227">t</span><span class="MJXp-mo" id="MJXp-Span-3228" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-132-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-132"> S \ left (\ lambda, \ theta \ right) </script>  can be decomposed into two components.  The first is the scattering coefficient that we just derived, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3229"><span class="MJXp-mtext" id="MJXp-Span-3230">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3231">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3232">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3233">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3234">a</span><span class="MJXp-mtext" id="MJXp-Span-3235">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3236">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3237">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3238">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3239">t</span><span class="MJXp-mo" id="MJXp-Span-3240" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3241">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3242">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3243">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3244">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3245">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3246">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3247">a</span><span class="MJXp-mtext" id="MJXp-Span-3248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3249">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3250">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3251">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3252">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3253">t</span><span class="MJXp-mo" id="MJXp-Span-3254" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-133-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-133"> \ beta \ left (\ lambda \ right) </script>  which modulates its intensity.  The second part is related to the scattering geometry, and controls its direction: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3256">S</span><span class="MJXp-mtext" id="MJXp-Span-3257">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3258">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3259">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3260">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3261">t</span><span class="MJXp-mo" id="MJXp-Span-3262" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3263">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3264">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3265">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3266">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3267">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3268">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3269">a</span><span class="MJXp-mo" id="MJXp-Span-3270" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-3271">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3272">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3273">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3274">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3275">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3276">a</span><span class="MJXp-mo" id="MJXp-Span-3277" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3278">h</span><span class="MJXp-mtext" id="MJXp-Span-3279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3280">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3281">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3282">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3283">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3284">t</span><span class="MJXp-mo" id="MJXp-Span-3285" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3286" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3287">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3288">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3289">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3290">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3291">a</span><span class="MJXp-mtext" id="MJXp-Span-3292">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3293">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3294">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3295">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3296">t</span><span class="MJXp-mo" id="MJXp-Span-3297" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3298">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3299">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3300">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3301">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3302">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3303">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3304">a</span><span class="MJXp-mo" id="MJXp-Span-3305" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3306">h</span><span class="MJXp-mtext" id="MJXp-Span-3307">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3308">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3309">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3310">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3311">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3312">t</span><span class="MJXp-mo" id="MJXp-Span-3313" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-3314">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3315">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3316">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3317">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3318">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3319">a</span><span class="MJXp-mtext" id="MJXp-Span-3320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3321">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3322">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3323">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3324">t</span><span class="MJXp-mo" id="MJXp-Span-3325" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3326">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3327">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3328">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3329">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3330">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3331">a</span><span class="MJXp-mtext" id="MJXp-Span-3332">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3333">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3334">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3335">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3336">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3337">t</span><span class="MJXp-mo" id="MJXp-Span-3338" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-134-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-134"> S \ left (\ lambda, \ theta, h \ right) = \ beta \ left (\ lambda, h \ right) \ gamma \ left (\ theta \ right) </script></p><br>  This new value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3339"><span class="MJXp-mtext" id="MJXp-Span-3340">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3341">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3342">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3343">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3344">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3345">a</span><span class="MJXp-mtext" id="MJXp-Span-3346">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3347">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3348">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3349">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3350">t</span><span class="MJXp-mo" id="MJXp-Span-3351" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3352">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3353">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3354">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3355">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3356">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3357">a</span><span class="MJXp-mtext" id="MJXp-Span-3358">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3359">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3360">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3361">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3362">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3363">t</span><span class="MJXp-mo" id="MJXp-Span-3364" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-135-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-135"> \ gamma \ left (\ theta \ right) </script>  can be obtained by dividing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3366">S</span><span class="MJXp-mtext" id="MJXp-Span-3367">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3368">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3369">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3370">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3371">t</span><span class="MJXp-mo" id="MJXp-Span-3372" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3373">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3374">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3375">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3376">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3377">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3378">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3379">a</span><span class="MJXp-mo" id="MJXp-Span-3380" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-3381">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3382">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3383">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3384">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3385">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3386">a</span><span class="MJXp-mo" id="MJXp-Span-3387" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3388">h</span><span class="MJXp-mtext" id="MJXp-Span-3389">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3390">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3391">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3392">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3393">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3394">t</span><span class="MJXp-mo" id="MJXp-Span-3395" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-136-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-136"> S \ left (\ lambda, \ theta, h \ right) </script>  on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3396"><span class="MJXp-mtext" id="MJXp-Span-3397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3398">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3399">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3400">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3401">a</span><span class="MJXp-mtext" id="MJXp-Span-3402">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3403">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3404">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3405">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3406">t</span><span class="MJXp-mo" id="MJXp-Span-3407" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3408">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3409">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3410">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3411">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3412">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3413">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3414">a</span><span class="MJXp-mtext" id="MJXp-Span-3415">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3416">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3417">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3418">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3419">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3420">t</span><span class="MJXp-mo" id="MJXp-Span-3421" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-137-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-137"> \ beta \ left (\ lambda \ right) </script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3422"><span class="MJXp-mtext" id="MJXp-Span-3423">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3424">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3425">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3426">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3427">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3428">a</span><span class="MJXp-mtext" id="MJXp-Span-3429">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3430">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3431">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3432">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3433">t</span><span class="MJXp-mo" id="MJXp-Span-3434" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3435">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3436">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3437">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3438">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3439">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3440">a</span><span class="MJXp-mtext" id="MJXp-Span-3441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3442">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3443">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3444">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3445">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3446">t</span><span class="MJXp-mo" id="MJXp-Span-3447" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3448" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3449">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3450">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3451">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3452">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3453">c</span><span class="MJXp-mrow" id="MJXp-Span-3454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3455">S</span><span class="MJXp-mtext" id="MJXp-Span-3456">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3457">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3458">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3459">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3460">t</span><span class="MJXp-mo" id="MJXp-Span-3461" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3462">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3463">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3464">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3465">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3466">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3467">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3468">a</span><span class="MJXp-mo" id="MJXp-Span-3469" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-3470">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3471">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3472">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3473">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3474">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3475">a</span><span class="MJXp-mo" id="MJXp-Span-3476" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3477">h</span><span class="MJXp-mtext" id="MJXp-Span-3478">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3479">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3480">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3481">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3482">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3483">t</span><span class="MJXp-mo" id="MJXp-Span-3484" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-3485"><span class="MJXp-mtext" id="MJXp-Span-3486">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3487">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3488">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3489">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3490">a</span><span class="MJXp-mtext" id="MJXp-Span-3491">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3492">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3493">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3494">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3495">t</span><span class="MJXp-mo" id="MJXp-Span-3496" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3497">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3498">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3499">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3500">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3501">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3502">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3503">a</span><span class="MJXp-mtext" id="MJXp-Span-3504">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3505">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3506">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3507">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3508">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3509">t</span><span class="MJXp-mo" id="MJXp-Span-3510" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-3511" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-138-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-138"> \ gamma \ left (\ theta \ right) = \ frac {S \ left (\ lambda, \ theta, h \ right)} {\ beta \ left (\ lambda \ right)} = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3512"><span class="MJXp-mo" id="MJXp-Span-3513" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3514">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3515">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3516">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3517">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3518">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3519">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3520">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3521">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3522">t</span><span class="MJXp-mrow" id="MJXp-Span-3523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3524">S</span><span class="MJXp-mtext" id="MJXp-Span-3525">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3526">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3527">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3528">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3529">t</span><span class="MJXp-mo" id="MJXp-Span-3530" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3531">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3532">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3533">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3534">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3535">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3536">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3537">a</span><span class="MJXp-mo" id="MJXp-Span-3538" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-3539">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3540">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3541">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3542">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3543">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3544">a</span><span class="MJXp-mo" id="MJXp-Span-3545" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3546">h</span><span class="MJXp-mtext" id="MJXp-Span-3547">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3548">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3549">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3550">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3551">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3552">t</span><span class="MJXp-mo" id="MJXp-Span-3553" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-3554"><span class="MJXp-mtext" id="MJXp-Span-3555">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3556">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3557">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3558">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3559">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3560">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3561">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3562">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3563">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3564">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3565">e</span><span class="MJXp-mrow" id="MJXp-Span-3566"><span class="MJXp-mtext" id="MJXp-Span-3567">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3568">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3569">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3570">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3571">c</span><span class="MJXp-mrow" id="MJXp-Span-3572"><span class="MJXp-mtext" id="MJXp-Span-3573">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3574">p</span><span class="MJXp-msubsup" id="MJXp-Span-3575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3576" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3577" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-3578">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3579">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3580">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3581">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3582">t</span><span class="MJXp-mo" id="MJXp-Span-3583" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3585" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3586" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3587" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3588">1</span><span class="MJXp-mtext" id="MJXp-Span-3589">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3590">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3591">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3592">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3593">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3594">t</span><span class="MJXp-msubsup" id="MJXp-Span-3595"><span class="MJXp-mo" id="MJXp-Span-3596" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3597" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3598"><span class="MJXp-mn" id="MJXp-Span-3599">2</span></span><span class="MJXp-mtext" id="MJXp-Span-3600">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3601">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3602">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3603">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3604">c</span><span class="MJXp-mrow" id="MJXp-Span-3605"><span class="MJXp-mtext" id="MJXp-Span-3606">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3607">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3608">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3609">o</span><span class="MJXp-mtext" id="MJXp-Span-3610">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3611">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3612">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3613">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3614">t</span><span class="MJXp-mo" id="MJXp-Span-3615" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3616">h</span><span class="MJXp-mtext" id="MJXp-Span-3617">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3618">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3619">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3620">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3621">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3622">t</span><span class="MJXp-mo" id="MJXp-Span-3623" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-3624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3625">N</span></span><span class="MJXp-mtext" id="MJXp-Span-3626">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3627">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3628">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3629">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3630">c</span><span class="MJXp-mrow" id="MJXp-Span-3631"><span class="MJXp-mn" id="MJXp-Span-3632">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3633"><span class="MJXp-mtext" id="MJXp-Span-3634">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3635">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3636">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3637">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3638">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3639">d</span><span class="MJXp-msubsup" id="MJXp-Span-3640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3641" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3642" style="vertical-align: 0.5em;">4</span></span></span><span class="MJXp-mtext" id="MJXp-Span-3643">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3644">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3645">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3646">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3647">t</span><span class="MJXp-mo" id="MJXp-Span-3648" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3649">1</span><span class="MJXp-mo" id="MJXp-Span-3650" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-3651">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3652">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3653">o</span><span class="MJXp-msubsup" id="MJXp-Span-3654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3655" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3656" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-3657">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3658">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3659">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3660">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3661">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3662">a</span><span class="MJXp-mtext" id="MJXp-Span-3663">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3664">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3665">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3666">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3667">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3668">t</span><span class="MJXp-mo" id="MJXp-Span-3669" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mspace" id="MJXp-Span-3670" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-3671">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3672">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3673">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3674">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3675">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3676">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3677">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3678">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3679">t</span><span class="MJXp-mrow" id="MJXp-Span-3680"><span class="MJXp-mtext" id="MJXp-Span-3681">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3682">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3683">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3684">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3685">c</span><span class="MJXp-mrow" id="MJXp-Span-3686"><span class="MJXp-mn" id="MJXp-Span-3687">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3688"><span class="MJXp-mtext" id="MJXp-Span-3689">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3690">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3691">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3692">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3693">a</span><span class="MJXp-mtext" id="MJXp-Span-3694">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3695">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3696">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3697">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3698">t</span><span class="MJXp-mo" id="MJXp-Span-3699" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3700">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3701">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3702">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3703">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3704">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3705">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3706">a</span><span class="MJXp-mtext" id="MJXp-Span-3707">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3708">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3709">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3710">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3711">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3712">t</span><span class="MJXp-mo" id="MJXp-Span-3713" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3714"><span class="MJXp-mtext" id="MJXp-Span-3715">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3716">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3717">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3718">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3719">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3720">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3721">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3722">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3723">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3724">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3725">e</span><span class="MJXp-mrow" id="MJXp-Span-3726"><span class="MJXp-mtext" id="MJXp-Span-3727">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3728">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3729">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3730">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3731">c</span><span class="MJXp-mrow" id="MJXp-Span-3732"><span class="MJXp-mn" id="MJXp-Span-3733">3</span></span><span class="MJXp-mrow" id="MJXp-Span-3734"><span class="MJXp-mn" id="MJXp-Span-3735">8</span><span class="MJXp-mtext" id="MJXp-Span-3736">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3737">p</span><span class="MJXp-msubsup" id="MJXp-Span-3738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3739" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3740" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mtext" id="MJXp-Span-3741">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3742">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3743">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3744">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3745">t</span><span class="MJXp-mo" id="MJXp-Span-3746" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3748" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3749" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3750" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3751">1</span><span class="MJXp-mtext" id="MJXp-Span-3752">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3753">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3754">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3755">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3756">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3757">t</span><span class="MJXp-msubsup" id="MJXp-Span-3758"><span class="MJXp-mo" id="MJXp-Span-3759" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3760" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mtext" id="MJXp-Span-3761">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3762">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3763">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3764">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3765">c</span><span class="MJXp-mrow" id="MJXp-Span-3766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3767">N</span></span><span class="MJXp-mrow" id="MJXp-Span-3768"><span class="MJXp-mtext" id="MJXp-Span-3769">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3770">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3771">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3772">o</span><span class="MJXp-mtext" id="MJXp-Span-3773">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3774">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3775">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3776">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3777">t</span><span class="MJXp-mo" id="MJXp-Span-3778" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3779">h</span><span class="MJXp-mtext" id="MJXp-Span-3780">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3781">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3782">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3783">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3784">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3785">t</span><span class="MJXp-mo" id="MJXp-Span-3786" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-3787">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3788">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3789">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3790">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3791">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3792">d</span><span class="MJXp-msubsup" id="MJXp-Span-3793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3794" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3795" style="vertical-align: 0.5em;">4</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3796" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-139-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-139"> = \ underset {S \ left (\ lambda, \ theta, h \ right)} {\ underbrace {\ frac {\ pi ^ 2 \ left (n ^ 2-1 \ right) ^ 2} {2} \ frac {\ rho \ left (h \ right)} {N} \ frac {1} {\ lambda ^ 4} \ left (1+ \ cos ^ 2 \ theta \ right)}} \, \ underset {\ frac {1 } {\ beta \ left (\ lambda \ right)}} {\ underbrace {\ frac {3} {8 \ pi ^ 3 \ left (n ^ 2-1 \ right) ^ 2} \ frac {N} {\ rho \ left (h \ right)} \ lambda ^ 4}} = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3797"><span class="MJXp-mo" id="MJXp-Span-3798" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3799">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3800">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3801">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3802">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3803">c</span><span class="MJXp-mrow" id="MJXp-Span-3804"><span class="MJXp-mn" id="MJXp-Span-3805">3</span></span><span class="MJXp-mrow" id="MJXp-Span-3806"><span class="MJXp-mn" id="MJXp-Span-3807">16</span><span class="MJXp-mtext" id="MJXp-Span-3808">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3809">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3810">i</span></span><span class="MJXp-mtext" id="MJXp-Span-3811">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3812">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3813">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3814">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3815">t</span><span class="MJXp-mo" id="MJXp-Span-3816" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3817">1</span><span class="MJXp-mo" id="MJXp-Span-3818" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-3819">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3820">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3821">o</span><span class="MJXp-msubsup" id="MJXp-Span-3822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3823" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3824" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-3825">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3826">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3827">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3828">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3829">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3830">a</span><span class="MJXp-mtext" id="MJXp-Span-3831">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3832">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3833">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3834">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3835">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3836">t</span><span class="MJXp-mo" id="MJXp-Span-3837" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-140-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-140"> = \ frac {3} {16 \ pi} \ left (1+ \ cos ^ 2 \ theta \ right) </script></p><br>  You can see that this new expression does not depend on the wavelength of the incoming light.  This seems counterintuitive, because we know for sure that Rayleigh scattering has a stronger effect on short waves. <br><br>  but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3838"><span class="MJXp-mtext" id="MJXp-Span-3839">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3840">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3841">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3842">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3843">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3844">a</span><span class="MJXp-mtext" id="MJXp-Span-3845">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3846">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3847">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3848">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3849">t</span><span class="MJXp-mo" id="MJXp-Span-3850" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3851">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3852">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3853">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3854">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3855">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3856">a</span><span class="MJXp-mtext" id="MJXp-Span-3857">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3858">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3859">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3860">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3861">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3862">t</span><span class="MJXp-mo" id="MJXp-Span-3863" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-141-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-141"> \ gamma \ left (\ theta \ right) </script>  models the dipole shape that we saw above.  Member <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3864"><span class="MJXp-mtext" id="MJXp-Span-3865">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3866">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3867">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3868">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3869">c</span><span class="MJXp-mrow" id="MJXp-Span-3870"><span class="MJXp-mn" id="MJXp-Span-3871">3</span></span><span class="MJXp-mrow" id="MJXp-Span-3872"><span class="MJXp-mn" id="MJXp-Span-3873">16</span><span class="MJXp-mtext" id="MJXp-Span-3874">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3875">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3876">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-142-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-142"> \ frac {3} {16 \ pi} </script>  serves as the normalization factor to the integral over all possible angles <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3877"><span class="MJXp-mtext" id="MJXp-Span-3878">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3879">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3880">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3881">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3882">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3883">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-143-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-143"> \ theta </script>  summed up in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3884"><span class="MJXp-mn" id="MJXp-Span-3885">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-144-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-144"> 1 </script>  .  If formulated technically, then we can say that the integral over <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3886"><span class="MJXp-mn" id="MJXp-Span-3887">4</span><span class="MJXp-mtext" id="MJXp-Span-3888">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3889">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3890">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-145-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-145"> 4 \ pi </script>  steradians equal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3891"><span class="MJXp-mn" id="MJXp-Span-3892">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-146-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-146"> 1 </script>  . <br><br>  In the following parts we will see how the separation of these two components will allow us to derive more efficient equations. <br><br><h4>  Let's summarize </h4><br><ul><li>  <strong>Rayleigh scattering equation</strong> : denotes the fraction of light reflected in the direction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3893"><span class="MJXp-mtext" id="MJXp-Span-3894">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3895">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3896">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3897">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3898">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3899">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-147-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-147"> \ theta </script>  .  The amount of scattering depends on the wavelength. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3900"><span class="MJXp-mtext" id="MJXp-Span-3901">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3902">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3903">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3904">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3905">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3906">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3907">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-148-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-148"> \ lambda </script>  incoming light. </li></ul><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3909">S</span><span class="MJXp-mtext" id="MJXp-Span-3910">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3911">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3912">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3913">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3914">t</span><span class="MJXp-mo" id="MJXp-Span-3915" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3916">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3917">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3918">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3919">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3920">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3921">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3922">a</span><span class="MJXp-mo" id="MJXp-Span-3923" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-3924">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3925">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3926">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3927">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3928">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3929">a</span><span class="MJXp-mo" id="MJXp-Span-3930" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3931">h</span><span class="MJXp-mtext" id="MJXp-Span-3932">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3933">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3934">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3935">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3936">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3937">t</span><span class="MJXp-mo" id="MJXp-Span-3938" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3939" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3940">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3941">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3942">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3943">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3944">c</span><span class="MJXp-mrow" id="MJXp-Span-3945"><span class="MJXp-mtext" id="MJXp-Span-3946">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3947">p</span><span class="MJXp-msubsup" id="MJXp-Span-3948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3949" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3950" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-3951">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3952">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3953">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3954">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3955">t</span><span class="MJXp-mo" id="MJXp-Span-3956" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3958" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3959" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3960" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3961">1</span><span class="MJXp-mtext" id="MJXp-Span-3962">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3963">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3964">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3965">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3966">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3967">t</span><span class="MJXp-msubsup" id="MJXp-Span-3968"><span class="MJXp-mo" id="MJXp-Span-3969" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3970" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3971"><span class="MJXp-mn" id="MJXp-Span-3972">2</span></span><span class="MJXp-mtext" id="MJXp-Span-3973">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3974">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3975">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3976">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3977">c</span><span class="MJXp-mrow" id="MJXp-Span-3978"><span class="MJXp-mtext" id="MJXp-Span-3979">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3980">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3981">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3982">o</span><span class="MJXp-mtext" id="MJXp-Span-3983">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3984">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3985">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3986">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3987">t</span><span class="MJXp-mo" id="MJXp-Span-3988" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3989">h</span><span class="MJXp-mtext" id="MJXp-Span-3990">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3991">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3992">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3993">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3994">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3995">t</span><span class="MJXp-mo" id="MJXp-Span-3996" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-3997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3998">N</span></span><span class="MJXp-mtext" id="MJXp-Span-3999">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4000">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4001">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4002">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4003">c</span><span class="MJXp-mrow" id="MJXp-Span-4004"><span class="MJXp-mn" id="MJXp-Span-4005">1</span></span><span class="MJXp-mrow" id="MJXp-Span-4006"><span class="MJXp-mtext" id="MJXp-Span-4007">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4008">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4009">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4010">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4011">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4012">d</span><span class="MJXp-msubsup" id="MJXp-Span-4013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4014" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4015" style="vertical-align: 0.5em;">4</span></span></span><span class="MJXp-mtext" id="MJXp-Span-4016">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4017">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4018">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4019">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4020">t</span><span class="MJXp-mo" id="MJXp-Span-4021" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4022">1</span><span class="MJXp-mo" id="MJXp-Span-4023" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-4024">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4025">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4026">o</span><span class="MJXp-msubsup" id="MJXp-Span-4027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4028" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4029" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-4030">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4031">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4032">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4033">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4034">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4035">a</span><span class="MJXp-mtext" id="MJXp-Span-4036">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4037">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4038">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4039">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4040">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4041">t</span><span class="MJXp-mo" id="MJXp-Span-4042" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-149-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-149"> S \ left (\ lambda, \ theta, h \ right) = \ frac {\ pi ^ 2 \ left (n ^ 2-1 \ right) ^ 2} {2} \ frac {\ rho \ left (h \ right)} {N} \ frac {1} {\ lambda ^ 4} \ left (1+ \ cos ^ 2 \ theta \ right) </script></p><br>  Besides: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4044">S</span><span class="MJXp-mtext" id="MJXp-Span-4045">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4046">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4047">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4048">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4049">t</span><span class="MJXp-mo" id="MJXp-Span-4050" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4051">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4052">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4053">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4054">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4055">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4056">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4057">a</span><span class="MJXp-mo" id="MJXp-Span-4058" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-4059">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4060">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4061">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4062">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4063">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4064">a</span><span class="MJXp-mo" id="MJXp-Span-4065" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4066">h</span><span class="MJXp-mtext" id="MJXp-Span-4067">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4068">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4069">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4070">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4071">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4072">t</span><span class="MJXp-mo" id="MJXp-Span-4073" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4074" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-4075">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4076">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4077">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4078">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4079">a</span><span class="MJXp-mtext" id="MJXp-Span-4080">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4081">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4082">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4083">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4084">t</span><span class="MJXp-mo" id="MJXp-Span-4085" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4086">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4087">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4088">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4089">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4090">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4091">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4092">a</span><span class="MJXp-mo" id="MJXp-Span-4093" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4094">h</span><span class="MJXp-mtext" id="MJXp-Span-4095">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4096">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4097">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4098">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4099">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4100">t</span><span class="MJXp-mo" id="MJXp-Span-4101" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-4102">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4103">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4104">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4105">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4106">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4107">a</span><span class="MJXp-mtext" id="MJXp-Span-4108">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4109">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4110">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4111">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4112">t</span><span class="MJXp-mo" id="MJXp-Span-4113" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4114">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4115">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4116">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4117">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4118">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4119">a</span><span class="MJXp-mtext" id="MJXp-Span-4120">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4121">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4122">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4123">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4124">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4125">t</span><span class="MJXp-mo" id="MJXp-Span-4126" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-150-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-150"> S \ left (\ lambda, \ theta, h \ right) = \ beta \ left (\ lambda, h \ right) \ gamma \ left (\ theta \ right) </script></p><br><ul><li>  <strong>Rayleigh</strong> Scatter <strong>Factor</strong> : Indicates the fraction of light lost due to scattering after the first collision. </li></ul><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4127"><span class="MJXp-mtext" id="MJXp-Span-4128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4129">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4130">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4131">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4132">a</span><span class="MJXp-mtext" id="MJXp-Span-4133">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4134">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4135">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4136">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4137">t</span><span class="MJXp-mo" id="MJXp-Span-4138" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4139">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4140">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4141">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4142">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4143">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4144">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4145">a</span><span class="MJXp-mo" id="MJXp-Span-4146" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4147">h</span><span class="MJXp-mtext" id="MJXp-Span-4148">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4149">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4150">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4151">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4152">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4153">t</span><span class="MJXp-mo" id="MJXp-Span-4154" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4155" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-4156">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4157">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4158">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4159">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4160">c</span><span class="MJXp-mrow" id="MJXp-Span-4161"><span class="MJXp-mn" id="MJXp-Span-4162">8</span><span class="MJXp-mtext" id="MJXp-Span-4163">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4164">p</span><span class="MJXp-msubsup" id="MJXp-Span-4165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4166" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4167" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mtext" id="MJXp-Span-4168">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4169">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4170">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4171">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4172">t</span><span class="MJXp-mo" id="MJXp-Span-4173" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4175" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4176" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4177" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-4178">1</span><span class="MJXp-mtext" id="MJXp-Span-4179">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4180">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4181">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4182">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4183">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4184">t</span><span class="MJXp-msubsup" id="MJXp-Span-4185"><span class="MJXp-mo" id="MJXp-Span-4186" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4187" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-4188"><span class="MJXp-mn" id="MJXp-Span-4189">3</span></span><span class="MJXp-mtext" id="MJXp-Span-4190">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4191">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4192">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4193">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4194">c</span><span class="MJXp-mrow" id="MJXp-Span-4195"><span class="MJXp-mtext" id="MJXp-Span-4196">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4197">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4198">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4199">o</span><span class="MJXp-mtext" id="MJXp-Span-4200">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4201">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4202">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4203">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4204">t</span><span class="MJXp-mo" id="MJXp-Span-4205" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4206">h</span><span class="MJXp-mtext" id="MJXp-Span-4207">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4208">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4209">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4210">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4211">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4212">t</span><span class="MJXp-mo" id="MJXp-Span-4213" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-4214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4215">N</span></span><span class="MJXp-mtext" id="MJXp-Span-4216">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4217">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4218">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4219">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4220">c</span><span class="MJXp-mrow" id="MJXp-Span-4221"><span class="MJXp-mn" id="MJXp-Span-4222">1</span></span><span class="MJXp-mrow" id="MJXp-Span-4223"><span class="MJXp-mtext" id="MJXp-Span-4224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4225">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4226">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4227">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4228">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4229">d</span><span class="MJXp-msubsup" id="MJXp-Span-4230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4231" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4232" style="vertical-align: 0.5em;">4</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-151-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-151"> \ beta \ left (\ lambda, h \ right) = \ frac {8 \ pi ^ 3 \ left (n ^ 2-1 \ right) ^ 2} {3} \ frac {\ rho \ left (h \ right )} {N} \ frac {1} {\ lambda ^ 4} </script></p><br><ul><li>  <strong>Rayleigh dispersion coefficient at sea level</strong> : this is analogous to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4233"><span class="MJXp-mtext" id="MJXp-Span-4234">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4235">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4236">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4237">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4238">a</span><span class="MJXp-mtext" id="MJXp-Span-4239">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4240">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4241">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4242">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4243">t</span><span class="MJXp-mo" id="MJXp-Span-4244" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4245">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4246">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4247">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4248">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4249">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4250">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4251">a</span><span class="MJXp-mo" id="MJXp-Span-4252" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-4253">0</span><span class="MJXp-mtext" id="MJXp-Span-4254">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4255">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4256">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4257">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4258">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4259">t</span><span class="MJXp-mo" id="MJXp-Span-4260" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-152-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-152"> \ beta \ left (\ lambda, 0 \ right) </script>  .  Creating this additional factor will be very useful for deriving more efficient equations. </li></ul><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4261"><span class="MJXp-mtext" id="MJXp-Span-4262">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4263">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4264">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4265">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4266">a</span><span class="MJXp-mtext" id="MJXp-Span-4267">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4268">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4269">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4270">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4271">t</span><span class="MJXp-mo" id="MJXp-Span-4272" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4273">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4274">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4275">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4276">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4277">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4278">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4279">a</span><span class="MJXp-mtext" id="MJXp-Span-4280">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4281">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4282">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4283">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4284">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4285">t</span><span class="MJXp-mo" id="MJXp-Span-4286" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4287" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-4288">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4289">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4290">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4291">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4292">a</span><span class="MJXp-mtext" id="MJXp-Span-4293">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4294">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4295">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4296">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4297">t</span><span class="MJXp-mo" id="MJXp-Span-4298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4299">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4300">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4301">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4302">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4303">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4304">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4305">a</span><span class="MJXp-mo" id="MJXp-Span-4306" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-4307">0</span><span class="MJXp-mtext" id="MJXp-Span-4308">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4309">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4310">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4311">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4312">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4313">t</span><span class="MJXp-mo" id="MJXp-Span-4314" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4315" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-4316">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4317">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4318">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4319">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4320">c</span><span class="MJXp-mrow" id="MJXp-Span-4321"><span class="MJXp-mn" id="MJXp-Span-4322">8</span><span class="MJXp-mtext" id="MJXp-Span-4323">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4324">p</span><span class="MJXp-msubsup" id="MJXp-Span-4325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4326" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4327" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mtext" id="MJXp-Span-4328">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4329">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4330">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4331">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4332">t</span><span class="MJXp-mo" id="MJXp-Span-4333" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4335" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4336" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4337" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-4338">1</span><span class="MJXp-mtext" id="MJXp-Span-4339">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4340">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4341">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4342">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4343">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4344">t</span><span class="MJXp-msubsup" id="MJXp-Span-4345"><span class="MJXp-mo" id="MJXp-Span-4346" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4347" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-4348"><span class="MJXp-mn" id="MJXp-Span-4349">3</span></span><span class="MJXp-mtext" id="MJXp-Span-4350">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4351">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4352">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4353">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4354">c</span><span class="MJXp-mrow" id="MJXp-Span-4355"><span class="MJXp-mn" id="MJXp-Span-4356">1</span></span><span class="MJXp-mrow" id="MJXp-Span-4357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4358">N</span></span><span class="MJXp-mtext" id="MJXp-Span-4359">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4360">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4361">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4362">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4363">c</span><span class="MJXp-mrow" id="MJXp-Span-4364"><span class="MJXp-mn" id="MJXp-Span-4365">1</span></span><span class="MJXp-mrow" id="MJXp-Span-4366"><span class="MJXp-mtext" id="MJXp-Span-4367">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4368">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4369">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4370">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4371">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4372">d</span><span class="MJXp-msubsup" id="MJXp-Span-4373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4374" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4375" style="vertical-align: 0.5em;">4</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-153-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-153"> \ beta \ left (\ lambda \ right) = \ beta \ left (\ lambda, 0 \ right) = \ frac {8 \ pi ^ 3 \ left (n ^ 2-1 \ right) ^ 2} {3} \ frac {1} {N} \ frac {1} {\ lambda ^ 4} </script></p><br>  If we consider the wavelengths approximately corresponding to the red, green and blue colors, we get the following results: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4376"><span class="MJXp-mtext" id="MJXp-Span-4377">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4378">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4379">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4380">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4381">a</span><span class="MJXp-mtext" id="MJXp-Span-4382">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4383">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4384">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4385">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4386">t</span><span class="MJXp-mo" id="MJXp-Span-4387" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4388">680</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4389">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4390">m</span><span class="MJXp-mtext" id="MJXp-Span-4391">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4392">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4393">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4394">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4395">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4396">t</span><span class="MJXp-mo" id="MJXp-Span-4397" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4398" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4399">0.00000519673</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-154-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-154"> \ beta \ left (680nm \ right) = 0.00000519673 </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4400"><span class="MJXp-mtext" id="MJXp-Span-4401">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4402">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4403">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4404">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4405">a</span><span class="MJXp-mtext" id="MJXp-Span-4406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4407">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4408">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4409">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4410">t</span><span class="MJXp-mo" id="MJXp-Span-4411" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4412">550</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4413">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4414">m</span><span class="MJXp-mtext" id="MJXp-Span-4415">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4416">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4417">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4418">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4419">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4420">t</span><span class="MJXp-mo" id="MJXp-Span-4421" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4422" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4423">0.0000121427</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-155-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-155"> \ beta \ left (550nm \ right) = 0.0000121427 </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4424"><span class="MJXp-mtext" id="MJXp-Span-4425">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4426">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4427">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4428">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4429">a</span><span class="MJXp-mtext" id="MJXp-Span-4430">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4431">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4432">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4433">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4434">t</span><span class="MJXp-mo" id="MJXp-Span-4435" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4436">440</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4437">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4438">m</span><span class="MJXp-mtext" id="MJXp-Span-4439">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4440">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4441">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4442">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4443">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4444">t</span><span class="MJXp-mo" id="MJXp-Span-4445" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4446" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4447">0.0000296453</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-156-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-156"> \ beta \ left (440nm \ right) = 0.0000296453 </script></p><br>  These results are calculated under the assumption that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4449">h</span><span class="MJXp-mo" id="MJXp-Span-4450" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4451">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-157-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-157"> h = 0 </script>  (this implies that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4452"><span class="MJXp-mtext" id="MJXp-Span-4453">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4454">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4455">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4456">o</span><span class="MJXp-mo" id="MJXp-Span-4457" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4458">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-158-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-158"> \ rho = 1 </script>  ).  This happens only at sea level, where the scattering coefficient has the maximum value.  Therefore, it serves as a ‚Äúguide‚Äù for the amount of light scattering. <br><br><ul><li>  <strong>Rayleigh Phase Function</strong> : Controls the scattering geometry, which denotes the relative fraction of light lost in a particular direction.  Coefficient <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4459"><span class="MJXp-mtext" id="MJXp-Span-4460">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4461">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4462">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4463">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4464">c</span><span class="MJXp-mrow" id="MJXp-Span-4465"><span class="MJXp-mn" id="MJXp-Span-4466">3</span></span><span class="MJXp-mrow" id="MJXp-Span-4467"><span class="MJXp-mn" id="MJXp-Span-4468">16</span><span class="MJXp-mtext" id="MJXp-Span-4469">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4470">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4471">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-159-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-159"> \ frac {3} {16 \ pi} </script>  serves as the normalization factor, so the integral over the unit sphere will be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4472"><span class="MJXp-mn" id="MJXp-Span-4473">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-160-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-160"> 1 </script>  . </li></ul><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4474"><span class="MJXp-mtext" id="MJXp-Span-4475">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4476">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4477">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4478">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4479">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4480">a</span><span class="MJXp-mtext" id="MJXp-Span-4481">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4482">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4483">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4484">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4485">t</span><span class="MJXp-mo" id="MJXp-Span-4486" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4487">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4488">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4489">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4490">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4491">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4492">a</span><span class="MJXp-mtext" id="MJXp-Span-4493">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4494">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4495">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4496">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4497">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4498">t</span><span class="MJXp-mo" id="MJXp-Span-4499" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4500" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-4501">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4502">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4503">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4504">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4505">c</span><span class="MJXp-mrow" id="MJXp-Span-4506"><span class="MJXp-mn" id="MJXp-Span-4507">3</span></span><span class="MJXp-mrow" id="MJXp-Span-4508"><span class="MJXp-mn" id="MJXp-Span-4509">16</span><span class="MJXp-mtext" id="MJXp-Span-4510">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4511">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4512">i</span></span><span class="MJXp-mtext" id="MJXp-Span-4513">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4514">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4515">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4516">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4517">t</span><span class="MJXp-mo" id="MJXp-Span-4518" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4519">1</span><span class="MJXp-mo" id="MJXp-Span-4520" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-4521">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4522">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4523">o</span><span class="MJXp-msubsup" id="MJXp-Span-4524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4525" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4526" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-4527">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4528">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4529">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4530">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4531">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4532">a</span><span class="MJXp-mtext" id="MJXp-Span-4533">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4534">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4535">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4536">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4537">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4538">t</span><span class="MJXp-mo" id="MJXp-Span-4539" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-161-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-161"> \ gamma \ left (\ theta \ right) = \ frac {3} {16 \ pi} \ left (1+ \ cos ^ 2 \ theta \ right) </script></p><br><ul><li>  <strong>Density Factor</strong> : This function is used to simulate the density of the atmosphere.  Its formal definition will be presented below.  If you are not against mathematical spoilers, then it is defined as follows: </li></ul><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4540"><span class="noError" id="MJXp-Span-4541" style="display: inline-block;">\&nbsp;rho&nbsp;\&nbsp;left&nbsp;(h&nbsp;\&nbsp;right)&nbsp;=&nbsp;exp&nbsp;\&nbsp;left&nbsp;\&nbsp;{-&nbsp;\&nbsp;frac&nbsp;{h}&nbsp;{H}&nbsp;\&nbsp;right&nbsp;\}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-162-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-162"> \ rho \ left (h \ right) = exp \ left \ {- \ frac {h} {H} \ right \} </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4543">H</span><span class="MJXp-mo" id="MJXp-Span-4544" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-4545"><span class="MJXp-mo" id="MJXp-Span-4546" style="margin-left: 0em; margin-right: 0em;">$</span></span><span class="MJXp-mn" id="MJXp-Span-4547">850</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-163-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-163"> H = $ 850</script>  meters is called <strong>altitude</strong> . <br><br><h2>  Part 4. Journey through the atmosphere. </h2><br>  In this part we will look at modeling the density of the atmosphere at different altitudes.  This is a necessary step, because the density of the atmosphere is one of the parameters needed to correctly calculate Rayleigh scattering. <br><br><h4>  Atmosphere density coefficient </h4><br>  So far, we have not considered the role of the atmospheric density coefficient <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4548"><span class="MJXp-mtext" id="MJXp-Span-4549">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4550">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4551">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4552">o</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-164-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-164"> \ rho </script>  .  It is logical that the force of dispersion is proportional to the density of the atmosphere.  The more molecules per cubic meter, the greater the probability of photon scattering.  The difficulty lies in the fact that the structure of the atmosphere is very complex, it consists of several layers with different pressures, densities and temperatures.  Fortunately for us, the bulk of Rayleigh scattering occurs in the first 60 km of the atmosphere.  In the <strong>troposphere, the</strong> temperature decreases linearly, and the pressure decreases exponentially. <br><br>  The diagram below shows the relationship between density and height in the lower atmosphere. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dz/rg/7p/dzrg7p_zbvxz6le791_h0avngt8.png"></div><br>  Value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4553"><span class="MJXp-mtext" id="MJXp-Span-4554">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4555">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4556">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4557">o</span><span class="MJXp-mtext" id="MJXp-Span-4558">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4559">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4560">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4561">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4562">t</span><span class="MJXp-mo" id="MJXp-Span-4563" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4564">h</span><span class="MJXp-mtext" id="MJXp-Span-4565">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4566">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4567">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4568">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4569">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4570">t</span><span class="MJXp-mo" id="MJXp-Span-4571" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-165-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-165"> \ rho \ left (h \ right) </script>  represents the measurement of the atmosphere at altitude <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4573">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-166-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-166"> h </script>  meters, normalized in such a way that starts from scratch.  In many scientific articles <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4574"><span class="MJXp-mtext" id="MJXp-Span-4575">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4576"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4577"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4578"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-167-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-167"> \ rho </script>  also called <strong>the density coefficient</strong> , because it can also be defined as follows: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4579"><span class="MJXp-mtext" id="MJXp-Span-4580">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4581"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4582"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4583"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4585"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4586"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4587"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4588"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4589" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4590"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4592"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4593"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4594"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4595"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4596"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4597" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span><span class="MJXp-mo" id="MJXp-Span-4598" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;">= </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4600"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4601"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4602"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4603"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4605"><font style="vertical-align: inherit;">d </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4606"><font style="vertical-align: inherit;">e </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4607"><font style="vertical-align: inherit;">n </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4608"><font style="vertical-align: inherit;">s </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4609"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4610"><font style="vertical-align: inherit;">t </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4611"><font style="vertical-align: inherit;">y </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4613"><font style="vertical-align: inherit;">l </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4614"><font style="vertical-align: inherit;">e </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4615"><font style="vertical-align: inherit;">f </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4616"><font style="vertical-align: inherit;">t </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mo" id="MJXp-Span-4617" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4618"><font style="vertical-align: inherit;">h </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4620"><font style="vertical-align: inherit;">r </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4621"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4622"><font style="vertical-align: inherit;">g </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4623"><font style="vertical-align: inherit;">h </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4624"><font style="vertical-align: inherit;">t </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mo" id="MJXp-Span-4625" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4627"><font style="vertical-align: inherit;">d </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4628"><font style="vertical-align: inherit;">e </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4629"><font style="vertical-align: inherit;">n </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4630"><font style="vertical-align: inherit;">s </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4631"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4632"><font style="vertical-align: inherit;">t </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4633"><font style="vertical-align: inherit;">y </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4635"><font style="vertical-align: inherit;">l </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4636"><font style="vertical-align: inherit;">e </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4637"><font style="vertical-align: inherit;">f </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4638"><font style="vertical-align: inherit;">t </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mo" id="MJXp-Span-4639" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mn" id="MJXp-Span-4640"><font style="vertical-align: inherit;">0 </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4642"><font style="vertical-align: inherit;">r </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4643"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4644"><font style="vertical-align: inherit;">g </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4645"><font style="vertical-align: inherit;">h </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4646"><font style="vertical-align: inherit;">t </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mo" id="MJXp-Span-4647" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-4584">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4585"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4586"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4587"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4588"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4589" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4590"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-4591">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4592"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4593"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4594"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4595"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4596"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4597" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4598" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-4599">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4600"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4601"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4602"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4603"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-4604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4605"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4606"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4607"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4608"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4609"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4610"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4611"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-4612">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4613"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4614"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4615"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4616"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4617" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4618"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-4619">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4620"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4621"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4622"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4623"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4624"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4625" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4627"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4628"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4629"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4630"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4631"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4632"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4633"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-4634">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4635"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4636"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4637"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4638"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4639" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-4640"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-4641">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4642"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4643"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4644"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4645"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4646"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4647" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-168-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-168"> \ rho \ left (h \ right) = \ frac {density \ left (h \ right)} {density \ left (0 \ right)} </script></p><br>  Dividing true density by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4649"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4650"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4651"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4652"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4653"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4654"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4655"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4657"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4658"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4659"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4660"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4661" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mn" id="MJXp-Span-4662"><font style="vertical-align: inherit;">0 </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4664"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4665"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4666"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4667"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4668"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4669" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mtext" id="MJXp-Span-4656">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4657"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4658"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4659"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4660"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4661" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-4662"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-4663">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4664"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4665"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4666"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4667"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4668"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4669" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-169-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-169"> density \ left (0 \ right) </script>  we will get that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4670"><span class="MJXp-mtext" id="MJXp-Span-4671">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4672"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4673"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4674"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4676"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4677"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4678"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4679"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4680" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4681"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4683"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4684"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4685"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4686"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4687"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4688" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mtext" id="MJXp-Span-4675">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4676"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4677"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4678"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4679"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4680" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4681"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-4682">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4683"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4684"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4685"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4686"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4687"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4688" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-170-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-170"> \ rho \ left (h \ right) </script>  at sea level equals <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4689"><span class="MJXp-mn" id="MJXp-Span-4690"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-171-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-171"> 1 </script>  .  However, as highlighted above, the calculation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4692"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4693"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4694"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4695"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4696"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4697"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4698"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4700"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4701"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4702"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4703"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4704" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4705"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4707"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4708"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4709"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4710"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4711"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4712" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mtext" id="MJXp-Span-4699">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4700"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4701"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4702"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4703"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4704" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4705"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-4706">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4707"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4708"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4709"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4710"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4711"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4712" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-172-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-172"> density \ left (h \ right) </script>  far nontrivial.  We can approximate it as an exponential curve;  some of you might already understand that the density in the lower atmosphere is <strong>decreasing exponentially</strong> . <br><br>  If we want to approximate the density coefficient through an exponential curve, then we can do it as follows: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4713"><span class="noError" id="MJXp-Span-4714" style="display: inline-block;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ rho \ left (h \ right) = exp \ left \ {- \ frac {h} {H} \ right \}</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-173-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-173"> \ rho \ left (h \ right) = exp \ left \ {- \ frac {h} {H} \ right \} </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4715"><span class="MJXp-msubsup" id="MJXp-Span-4716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4717" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4718" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-174-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-174"> H_0 </script>  - This is a scale factor called the <strong>reduced height</strong> .  For Rayleigh scattering in the lower layers of the Earth‚Äôs atmosphere, it is often considered that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4720"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H </font></font></span><span class="MJXp-mo" id="MJXp-Span-4721" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mrow" id="MJXp-Span-4722"><span class="MJXp-mo" id="MJXp-Span-4723" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-4724"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 850</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-175-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-175"> H = $ 850</script>  meters (see diagram below).  For light scattering by a spherical particle, the value is often approximately equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4725"><span class="MJXp-mn" id="MJXp-Span-4726"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1200</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-176-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-176"> 1200 </script>  meters. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kw/c1/tb/kwc1tbbboawkmjrkjg9_0geevri.png"></div><br>  The value used for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4728"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-177-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-177"> H </script>  does not give the best approximation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4729"><span class="MJXp-mtext" id="MJXp-Span-4730">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4731">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4732">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4733">o</span><span class="MJXp-mtext" id="MJXp-Span-4734">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4735">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4736">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4737">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4738">t</span><span class="MJXp-mo" id="MJXp-Span-4739" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4740">h</span><span class="MJXp-mtext" id="MJXp-Span-4741">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4742">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4743">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4744">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4745">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4746">t</span><span class="MJXp-mo" id="MJXp-Span-4747" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-178-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-178"> \ rho \ left (h \ right) </script>  .  However, this is actually not a problem.  Most of the values ‚Äã‚Äãpresented in this tutorial are subject to serious approximations.  To create visually pleasing results, it will be much more efficient to adjust the available parameters to reference images. <br><br><h4>  Exponential decrease </h4><br>  In the previous part of the tutorial, we derived an equation showing us how to take into account the scattering to the outside, to which a ray of light is subjected after interacting with a single particle.  The value used to simulate this phenomenon is called <strong>the scattering coefficient.</strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4748"><span class="MJXp-mtext" id="MJXp-Span-4749">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4750">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4751">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4752">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4753">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-179-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-179"> \ beta </script>  .  To take it into account, we introduced the coefficients <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4754"><span class="MJXp-mtext" id="MJXp-Span-4755">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4756">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4757">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4758">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4759">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-180-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-180"> \ beta </script>  . <br><br>  In the case of Rayleigh scattering, we also derived a closed form for calculating the amount of light confirmed by atmospheric scattering in a single interaction: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4760"><span class="MJXp-mtext" id="MJXp-Span-4761">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4762">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4763">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4764">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4765">a</span><span class="MJXp-mtext" id="MJXp-Span-4766">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4767">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4768">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4769">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4770">t</span><span class="MJXp-mo" id="MJXp-Span-4771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4772">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4773">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4774">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4775">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4776">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4777">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4778">a</span><span class="MJXp-mo" id="MJXp-Span-4779" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4780">h</span><span class="MJXp-mtext" id="MJXp-Span-4781">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4782">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4783">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4784">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4785">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4786">t</span><span class="MJXp-mo" id="MJXp-Span-4787" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4788" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-4789">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4790">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4791">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4792">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4793">c</span><span class="MJXp-mrow" id="MJXp-Span-4794"><span class="MJXp-mn" id="MJXp-Span-4795">8</span><span class="MJXp-mtext" id="MJXp-Span-4796">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4797">p</span><span class="MJXp-msubsup" id="MJXp-Span-4798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4799" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4800" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mtext" id="MJXp-Span-4801">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4802">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4803">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4804">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4805">t</span><span class="MJXp-mo" id="MJXp-Span-4806" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4808" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4809" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4810" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-4811">1</span><span class="MJXp-mtext" id="MJXp-Span-4812">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4813">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4814">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4815">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4816">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4817">t</span><span class="MJXp-msubsup" id="MJXp-Span-4818"><span class="MJXp-mo" id="MJXp-Span-4819" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4820" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-4821"><span class="MJXp-mn" id="MJXp-Span-4822">3</span></span><span class="MJXp-mtext" id="MJXp-Span-4823">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4824">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4825">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4826">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4827">c</span><span class="MJXp-mrow" id="MJXp-Span-4828"><span class="MJXp-mtext" id="MJXp-Span-4829">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4830">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4831">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4832">o</span><span class="MJXp-mtext" id="MJXp-Span-4833">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4834">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4835">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4836">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4837">t</span><span class="MJXp-mo" id="MJXp-Span-4838" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4839"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4841"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4842"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4843"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4844"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4845"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4846" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span></font><span class="MJXp-mtext" id="MJXp-Span-4840">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4841"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4842"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4843"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4844"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4845"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4846" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-4847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4848"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4850"><font style="vertical-align: inherit;"> f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4851"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4852"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4853"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-mrow" id="MJXp-Span-4854"><span class="MJXp-mn" id="MJXp-Span-4855"><font style="vertical-align: inherit;">1 </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4858"><font style="vertical-align: inherit;">l </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4859"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4860"><font style="vertical-align: inherit;">m </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4861"><font style="vertical-align: inherit;">b </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4862"><font style="vertical-align: inherit;">d </font></span></span><span class="MJXp-mrow" id="MJXp-Span-4856"><span class="MJXp-msubsup" id="MJXp-Span-4863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4864" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">a </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4856"><span class="MJXp-msubsup" id="MJXp-Span-4863"><span class="MJXp-mn MJXp-script" id="MJXp-Span-4865" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;">4</font></span></span></span></font><span class="MJXp-mtext" id="MJXp-Span-4849">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4850"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4851"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4852"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4853"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-4854"><span class="MJXp-mn" id="MJXp-Span-4855"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-4856"><span class="MJXp-mtext" id="MJXp-Span-4857">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4858"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4859"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4860"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4861"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4862"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-4863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4864" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4865" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"></font></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-181-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-181"> \ beta \ left (\ lambda, h \ right) = \ frac {8 \ pi ^ 3 \ left (n ^ 2-1 \ right) ^ 2} {3} \ frac {\ rho \ left (h \ right )} {N} \ frac {1} {\ lambda ^ 4} </script></p><br>  When calculating at sea level, i.e. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4867">h</span><span class="MJXp-mo" id="MJXp-Span-4868" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4869">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-182-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-182"> h = 0 </script>  The equation gives the following results: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4870"><span class="MJXp-mtext" id="MJXp-Span-4871">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4872">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4873">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4874">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4875">a</span><span class="MJXp-mtext" id="MJXp-Span-4876">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4877">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4878">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4879">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4880">t</span><span class="MJXp-mo" id="MJXp-Span-4881" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4882">680</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4883">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4884">m</span><span class="MJXp-mtext" id="MJXp-Span-4885">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4886">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4887">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4888">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4889">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4890">t</span><span class="MJXp-mo" id="MJXp-Span-4891" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4892" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4893">0.00000519673</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-183-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-183"> \ beta \ left (680nm \ right) = 0.00000519673 </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4894"><span class="MJXp-mtext" id="MJXp-Span-4895">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4896">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4897">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4898">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4899">a</span><span class="MJXp-mtext" id="MJXp-Span-4900">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4901">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4902">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4903">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4904">t</span><span class="MJXp-mo" id="MJXp-Span-4905" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4906">550</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4907">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4908">m</span><span class="MJXp-mtext" id="MJXp-Span-4909">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4910">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4911">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4912">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4913">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4914">t</span><span class="MJXp-mo" id="MJXp-Span-4915" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4916" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4917">0.0000121427</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-184-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-184"> \ beta \ left (550nm \ right) = 0.0000121427 </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4918"><span class="MJXp-mtext" id="MJXp-Span-4919">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4920"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4921"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4922"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4923"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4925"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4926"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4927"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4928"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4929" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mn" id="MJXp-Span-4930"><font style="vertical-align: inherit;">440 </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4931"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4932"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4934"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4935"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4936"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4937"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4938"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mo" id="MJXp-Span-4939" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span><span class="MJXp-mo" id="MJXp-Span-4940" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;">= </font></span><span class="MJXp-mn" id="MJXp-Span-4941"><font style="vertical-align: inherit;">0.0000296453</font></span></font><span class="MJXp-mtext" id="MJXp-Span-4924">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4925"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4926"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4927"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4928"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4929" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-4930"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4931"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4932"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-4933">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4934"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4935"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4936"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4937"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4938"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4939" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-4940" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-4941"><font style="vertical-align: inherit;"></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-185-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-185"> \ beta \ left (440nm \ right) = 0.0000296453 </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4942"><span class="MJXp-mn" id="MJXp-Span-4943"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">680</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-186-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-186"> 680 </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4944"><span class="MJXp-mn" id="MJXp-Span-4945"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">550</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-187-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-187"> 550 </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4946"><span class="MJXp-mn" id="MJXp-Span-4947"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">440</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-188-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-188"> 440 </script>  - wavelengths roughly corresponding to red, green, and blue. <br><br>  What is the meaning of these numbers?  They represent the fraction of light that is lost in a single interaction with a particle.  Assuming that the beam of light initially has brightness <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4948"><span class="MJXp-msubsup" id="MJXp-Span-4949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4950" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4951" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-189-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-189"> I_0 </script>  and passes a segment of the atmosphere with a (total) scattering coefficient <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4952"><span class="MJXp-mtext" id="MJXp-Span-4953">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4954"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4955"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4956"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4957"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-190-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-190"> \ beta </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the amount preserved after the scattering of light is equal to: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4958"><span class="MJXp-msubsup" id="MJXp-Span-4959"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4960" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4961" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-4962" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-munder" id="MJXp-Span-4963"><span class=""><span class="MJXp-mrow" id="MJXp-Span-4964"><span class="MJXp-munderover" id="MJXp-Span-4965"><span class=""><span class="MJXp-msubsup" id="MJXp-Span-4966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4967" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4968" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-4969" style="margin-left: 0px; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚èü</font></font></span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mtext" id="MJXp-Span-4970" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> initial energy</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-4971" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-munder" id="MJXp-Span-4972"><span class=""><span class="MJXp-mrow" id="MJXp-Span-4973"><span class="MJXp-munderover" id="MJXp-Span-4974"><span class=""><span class="MJXp-msubsup" id="MJXp-Span-4975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4976" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4977" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4978"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Œ≤ </font></font></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-4979" style="margin-left: 0px; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚èü</font></font></span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mtext" id="MJXp-Span-4980" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> energy lost</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-4981" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-4982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4983" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4984" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-4985"><span class="MJXp-mo" id="MJXp-Span-4986" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-4987"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-4988" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4989"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤ </font></font></span><span class="MJXp-mo" id="MJXp-Span-4990" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-191-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-191">I_1=\underset{\text{initial energy}}{\underbrace{I_0}} - \underset{\text{energy lost}}{\underbrace{I_0 \beta}}=I_0 \left(1-\beta\right)</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is true for a single collision, but we are interested in how much energy is dissipated during a certain distance. </font><font style="vertical-align: inherit;">This means that the remaining light undergoes this process at every point. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When light passes through a homogeneous medium with a scattering coefficient</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4992"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-192-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-192">\beta</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">how can we calculate which part of it will remain when moving a certain distance? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For those of you who have studied mathematical analysis, this may seem familiar. </font><font style="vertical-align: inherit;">When the multiplicative process is repeated on a continuous segment</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4993"><span class="MJXp-mrow" id="MJXp-Span-4994"><span class="MJXp-mo" id="MJXp-Span-4995" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-4996"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-4997" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4998"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤ </font></font></span><span class="MJXp-mo" id="MJXp-Span-4999" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-193-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-193">\left(1-\beta\right)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">then the </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Euler number</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> appears on the scene </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The amount of light that persists after passing</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5001"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-194-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-194"> x </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> meters equals: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5003">I</span><span class="MJXp-mo" id="MJXp-Span-5004" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5006" style="margin-right: 0.05em;">I</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5007" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5008">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5009">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5010">p</span><span class="MJXp-mrow" id="MJXp-Span-5011"><span class="MJXp-mo" id="MJXp-Span-5012" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mo" id="MJXp-Span-5013" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5014">Œ≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5015">x</span><span class="MJXp-mo" id="MJXp-Span-5016" style="margin-left: 0em; margin-right: 0em;">}</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-195-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-195">I = I_0 exp \left\{-\beta x \right\}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And again we are faced with an exponential function. </font><font style="vertical-align: inherit;">It has nothing to do with the exponential function describing the density coefficient</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5017"><span class="MJXp-mtext" id="MJXp-Span-5018">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5019">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5020">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5021">o</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-196-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-196"> \ rho </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Both phenomena are described by exponential functions because both of them are subject to exponential decrease. </font><font style="vertical-align: inherit;">In addition, there is no connection between them.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Where does exp come from?</font></font></b> <div class="spoiler_text">     ,    ,    ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5022"><span class="MJXp-msubsup" id="MJXp-Span-5023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5024" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5025" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-5026" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-5027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5028" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5029" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-5030"><span class="MJXp-mo" id="MJXp-Span-5031" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-5032"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-5033" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5034"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤ </font></font></span><span class="MJXp-mo" id="MJXp-Span-5035" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span></span><script type="math/tex" id="MathJax-Element-197">I_1 = I_0 \left(1-\beta\right)</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5037"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mo" id="MJXp-Span-5038" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-5039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5040" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5041" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5042"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5043"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5044"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow" id="MJXp-Span-5045"><span class="MJXp-mo" id="MJXp-Span-5046" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{ </font></font></span><span class="MJXp-mo" id="MJXp-Span-5047" style="margin-left: 0em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5048"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5049"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-5050" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></span></span></span></span><script type="math/tex" id="MathJax-Element-198">I = I_0 exp \left\{-\beta x \right\}</script>  . <br><br>          .       ,       ,        : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5051"><span class="MJXp-msubsup" id="MJXp-Span-5052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5053" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5054" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-5055" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-5056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5057" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5058" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-5059"><span class="MJXp-mo" id="MJXp-Span-5060" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-5061"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-5062" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-5063" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5064"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5065"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5066" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-199">I_1 = I_0 \left(1-\frac{\beta}{2}\right)</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5067"><span class="MJXp-msubsup" id="MJXp-Span-5068"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5069" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5070" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-5071" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-menclose" id="MJXp-Span-5072"><span class="MJXp-mrow" id="MJXp-Span-5073"><span class="MJXp-mstyle" id="MJXp-Span-5074"><span class="MJXp-mrow" id="MJXp-Span-5075"><span class="MJXp-msubsup" id="MJXp-Span-5076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5077" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5078" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-5079"><span class="MJXp-mo" id="MJXp-Span-5080" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-5081"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-5082" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-5083" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5084"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5085"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5086" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-200">I_2 = \boxed{I_1} \left(1-\frac{\beta}{2}\right)</script></p><br>     : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5087"><span class="MJXp-msubsup" id="MJXp-Span-5088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5089" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5090" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-5091" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-menclose" id="MJXp-Span-5092"><span class="MJXp-mrow" id="MJXp-Span-5093"><span class="MJXp-mstyle" id="MJXp-Span-5094"><span class="MJXp-mrow" id="MJXp-Span-5095"><span class="MJXp-msubsup" id="MJXp-Span-5096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5097" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5098" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-5099"><span class="MJXp-mo" id="MJXp-Span-5100" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-5101"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-5102" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-5103" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5104"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5105"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5106" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-5107"><span class="MJXp-mo" id="MJXp-Span-5108" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-5109"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-5110" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-5111" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5112"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5113"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5114" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-5115" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-201">I_2 = \boxed{I_0 \left(1-\frac{\beta}{2}\right)} \left(1-\frac{\beta}{2}\right)=</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5116"><span class="MJXp-mo" id="MJXp-Span-5117" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5119" style="margin-right: 0.05em;">I</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5120" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-msubsup" id="MJXp-Span-5121"><span class="MJXp-mrow" id="MJXp-Span-5122" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-5123" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-5124">1</span><span class="MJXp-mo" id="MJXp-Span-5125" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mfrac" id="MJXp-Span-5126" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5127">Œ≤</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5128">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5129" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5130" style="vertical-align: 1.2em;">2</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-202">=I_0 \left(1-\frac{\beta}{2}\right)^2</script></p><br>     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5131"><span class="MJXp-msubsup" id="MJXp-Span-5132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5133" style="margin-right: 0.05em;">I</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5134" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-203">I_2</script>       .     ?  ?  ?        : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5141">I</span><span class="MJXp-mo" id="MJXp-Span-5142" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-5143"><span class=""><span class="MJXp-mo" id="MJXp-Span-5144" style="margin-left: 0.333em; margin-right: 0.333em;">lim</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5145" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5146">n</span><span class="MJXp-mo" id="MJXp-Span-5147">‚Üí</span><span class="MJXp-mi" id="MJXp-Span-5148">‚àû</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-5149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5150" style="margin-right: 0.05em;">I</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5151" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-msubsup" id="MJXp-Span-5152"><span class="MJXp-mrow" id="MJXp-Span-5153" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-5154" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-5155">1</span><span class="MJXp-mo" id="MJXp-Span-5156" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mfrac" id="MJXp-Span-5157" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5158">Œ≤</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5159"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5160" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5161" style="vertical-align: 1.2em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-204">I=\lim_{n\rightarrow \infty }I_0 \left(1-\frac{\beta}{n}\right)^n</script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5162"><span class="MJXp-msubsup" id="MJXp-Span-5163"><span class="MJXp-mo" id="MJXp-Span-5164" style="margin-left: 0.333em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lim </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5165" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5166"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-5167"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mi" id="MJXp-Span-5168"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àû</font></font></span></span></span></span></span><script type="math/tex" id="MathJax-Element-205">\lim_{n\rightarrow \infty }</script> ‚Äî   ,      .   ,   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5169"><span class="MJXp-mi" id="MJXp-Span-5170"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àû</font></font></span></span></span><script type="math/tex" id="MathJax-Element-206">\infty</script>    ,          -  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5171"><span class="MJXp-mfrac" id="MJXp-Span-5172" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5173"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-5174"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àû</font></font></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-207">\frac{\beta}{\infty}</script>  . <br><br>       : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5175"><span class="MJXp-munderover" id="MJXp-Span-5176"><span class=""><span class="MJXp-mo" id="MJXp-Span-5177" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lim </font></font></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5178" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5179"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-5180"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mi" id="MJXp-Span-5181"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àû </font></font></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-5182"><span class="MJXp-mrow" id="MJXp-Span-5183" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-5184" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-5185"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-5186" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-5187" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5188"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5189"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5190" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5191" style="vertical-align: 1.2em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-5192" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-5193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5194" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5195" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-5196"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5197"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-5198" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5199"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5200"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5201"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mrow" id="MJXp-Span-5202"><span class="MJXp-mo" id="MJXp-Span-5203" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></span><span class="MJXp-mo" id="MJXp-Span-5204" style="margin-left: 0em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5205"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span><span class="MJXp-mo" id="MJXp-Span-5206" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-208">\lim_{n\rightarrow \infty } \left(1-\frac{\beta}{n}\right)^n = e^{-\beta}=exp\left\{-\beta\right\}</script></p><br>    ,       . </div></div><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Uniform transmission </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the second part of the tutorial, we introduced the concept of </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transmission</font></font></strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5208">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-209-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-209"> T </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as a fraction of the light remaining after the scattering process as it passes through the atmosphere. </font><font style="vertical-align: inherit;">Now we have all the elements to derive the equation describing it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's look at the scheme below and think about how we can calculate the transmittance for the segment</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5209"><span class="MJXp-munderover" id="MJXp-Span-5210"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5213" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5211">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5212">P</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-210-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-210">\overline{CP}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> You can easily see that the rays of light reaching </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5215">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-211-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-211"> C </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pass through the empty space. </font><font style="vertical-align: inherit;">Therefore, they are not scattered. </font><font style="vertical-align: inherit;">Therefore, the amount of light in</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5217">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-212-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-212"> C </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">really equal to the </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">brightness of the sun</font></font></strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5218"><span class="MJXp-msubsup" id="MJXp-Span-5219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5220" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5221" style="vertical-align: -0.4em;">S</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-213-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-213">I_S</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> During this journey to </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5223">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-214-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-214"> P </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">part of the light is scattered from the path; </font><font style="vertical-align: inherit;">therefore the amount of light reaching</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5225">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-215-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-215"> P </script>  ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5226"><span class="MJXp-msubsup" id="MJXp-Span-5227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5228" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5229" style="vertical-align: -0.4em;">P</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-216-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-216">I_P</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) will be less than </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5230"><span class="MJXp-msubsup" id="MJXp-Span-5231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5232" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5233" style="vertical-align: -0.4em;">S</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-217-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-217">I_S</script>  . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb5/847/384/bb58473846466bfd4c05c7cfc6432e5b.png" width="579" height="272"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The amount of diffused light depends on the distance traveled. </font><font style="vertical-align: inherit;">The longer the path, the stronger the attenuation will be. </font><font style="vertical-align: inherit;">According to the law of exponential decrease, the amount of light at a point</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5234"><span class="MJXp-msubsup" id="MJXp-Span-5235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5236" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5237" style="vertical-align: -0.4em;">P</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-218-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-218">I_P</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can be calculated as follows: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5238"><span class="MJXp-msubsup" id="MJXp-Span-5239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5240" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5241" style="vertical-align: -0.4em;">P</span></span><span class="MJXp-mo" id="MJXp-Span-5242" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5244" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5245" style="vertical-align: -0.4em;">S</span></span><span class="MJXp-mi" id="MJXp-Span-5246">exp</span><span class="MJXp-mo" id="MJXp-Span-5247" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5248"><span class="MJXp-mrow" id="MJXp-Span-5249"><span class="MJXp-mo" id="MJXp-Span-5250" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.278em;">{</span></span><span class="MJXp-mo" id="MJXp-Span-5251" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5252">Œ≤</span><span class="MJXp-munderover" id="MJXp-Span-5253"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5256" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5254">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5255">P</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5257" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.278em;">}</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-219-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-219">I_P = I_S  \exp{\left\{-\beta \overline{CP}\right\}}</script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5258"><span class="MJXp-munderover" id="MJXp-Span-5259"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5262" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5260">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5261">P</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-220-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-220">\overline{CP}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the length of the segment from </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5264">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-221-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-221"> C </script>  before <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5266">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-222-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-222"> P </script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5267"><span class="MJXp-mi" id="MJXp-Span-5268">exp</span><span class="MJXp-mo" id="MJXp-Span-5269" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5270"><span class="MJXp-mrow" id="MJXp-Span-5271"><span class="MJXp-mo" id="MJXp-Span-5272" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5273">x</span><span class="MJXp-mo" id="MJXp-Span-5274" style="margin-left: 0em; margin-right: 0em;">}</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-223-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-223">\exp{\left\{x\right\}}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exponential function</font></font></strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5275"><span class="MJXp-msubsup" id="MJXp-Span-5276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5277" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5278" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5279">x</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-224-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-224">e^{x}</script>  . <br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Atmospheric transmission </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We based our equation on the assumption that the probability of reflection ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the scattering coefficient</font></font></strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5281">Œ≤</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-225-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-225">\beta</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> same at every point along </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5282"><span class="MJXp-munderover" id="MJXp-Span-5283"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5286" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5284">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5285">P</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-226-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-226">\overline{CP}</script>  .  Unfortunately, this is not the case. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The scattering coefficient strongly depends on the density of the atmosphere. </font><font style="vertical-align: inherit;">The more air molecules per cubic meter, the higher the probability of a collision. </font><font style="vertical-align: inherit;">The density of the planet‚Äôs atmosphere is not uniform, and varies with altitude. </font><font style="vertical-align: inherit;">It also means that we cannot calculate outward scattering.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5287"><span class="MJXp-munderover" id="MJXp-Span-5288"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5291" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5289">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5290">P</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-227-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-227">\overline{CP}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in one step. </font><font style="vertical-align: inherit;">To solve this problem, we need to calculate the dispersion to the outside at each point using the scattering coefficient. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To understand how this works, let's start with an approximation. </font><font style="vertical-align: inherit;">Section</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5292"><span class="MJXp-munderover" id="MJXp-Span-5293"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5296" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5294">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5295">P</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-228-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-228">\overline{CP}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> divided by two </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5297"><span class="MJXp-munderover" id="MJXp-Span-5298"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5301" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5299">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5300">Q</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-229-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-229">\overline{CQ}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5302"><span class="MJXp-munderover" id="MJXp-Span-5303"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5306" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5304">Q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5305">P</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-230-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-230">\overline{QP}</script>  . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/54f/82c/97e/54f82c97e69ed862f916b82af3c9b7f8.png" width="713" height="326"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> First we calculate the amount of light from </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5308">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-231-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-231"> C </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> which reaches </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5310">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-232-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-232">Q</script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5311"><span class="MJXp-msubsup" id="MJXp-Span-5312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5313" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5314" style="vertical-align: -0.4em;">Q</span></span><span class="MJXp-mo" id="MJXp-Span-5315" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5317" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5318" style="vertical-align: -0.4em;">S</span></span><span class="MJXp-mi" id="MJXp-Span-5319">exp</span><span class="MJXp-mo" id="MJXp-Span-5320" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5321"><span class="MJXp-mrow" id="MJXp-Span-5322"><span class="MJXp-mo" id="MJXp-Span-5323" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.278em;">{</span></span><span class="MJXp-mo" id="MJXp-Span-5324" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5325">Œ≤</span><span class="MJXp-mrow" id="MJXp-Span-5326"><span class="MJXp-mrow" id="MJXp-Span-5327"><span class="MJXp-mo" id="MJXp-Span-5328" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5329">Œª</span><span class="MJXp-mo" id="MJXp-Span-5330" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5332" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5333" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-5334" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-5335"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5338" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5336">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5337">Q</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5339" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.278em;">}</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-233-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-233">I_Q = I_S \exp{\left\{-\beta{\left(\lambda, h_0\right)} \overline{CQ} \right\}}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Then we use the same approach to calculate the amount of light reaching </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5341">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-234-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-234"> P </script>  of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5343">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-235-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-235">Q</script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5344"><span class="MJXp-msubsup" id="MJXp-Span-5345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5346" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5347" style="vertical-align: -0.4em;">P</span></span><span class="MJXp-mo" id="MJXp-Span-5348" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-menclose" id="MJXp-Span-5349"><span class="MJXp-mrow" id="MJXp-Span-5350"><span class="MJXp-mstyle" id="MJXp-Span-5351"><span class="MJXp-mrow" id="MJXp-Span-5352"><span class="MJXp-msubsup" id="MJXp-Span-5353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5354" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5355" style="vertical-align: -0.4em;">Q</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-5356">exp</span><span class="MJXp-mo" id="MJXp-Span-5357" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5358"><span class="MJXp-mrow" id="MJXp-Span-5359"><span class="MJXp-mo" id="MJXp-Span-5360" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.278em;">{</span></span><span class="MJXp-mo" id="MJXp-Span-5361" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5362">Œ≤</span><span class="MJXp-mrow" id="MJXp-Span-5363"><span class="MJXp-mrow" id="MJXp-Span-5364"><span class="MJXp-mo" id="MJXp-Span-5365" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5366">Œª</span><span class="MJXp-mo" id="MJXp-Span-5367" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5369" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5370" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5371" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-5372"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5375" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5373">Q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5374">P</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5376" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.278em;">}</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-236-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-236">I_P = \boxed{I_Q} \exp{\left\{-\beta{\left(\lambda, h_1\right)} \overline{QP} \right\}}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If we substitute </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5377"><span class="MJXp-msubsup" id="MJXp-Span-5378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5379" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5380" style="vertical-align: -0.4em;">Q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-237-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-237">I_Q</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the second equation and simplify, we get: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m1/jn/_e/m1jn_emr4qlfn6tal4r76keouqi.png"></div><br>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5381"><span class="MJXp-munderover" id="MJXp-Span-5382"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5385" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5383">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5384">Q</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-238-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-238">\overline{CQ}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5386"><span class="MJXp-munderover" id="MJXp-Span-5387"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5390" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5388">Q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5389">P</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-239-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-239">\overline{QP}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> have the same length </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5392">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5393">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-240-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-240"> ds </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we can further simplify the expression: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tc/l2/ix/tcl2ixoh53ywzcgis4ahf6n1ddi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the case of two segments of the same length with different scattering coefficients outward, it is calculated by summing the scattering coefficients of individual segments and multiplied by the lengths of the segments. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We can repeat this process with an arbitrary number of segments, ever closer to the true value. </font><font style="vertical-align: inherit;">This will lead us to the following equation:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5394"><span class="MJXp-msubsup" id="MJXp-Span-5395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5396" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5397" style="vertical-align: -0.4em;">P</span></span><span class="MJXp-mo" id="MJXp-Span-5398" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5400" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5401" style="vertical-align: -0.4em;">S</span></span><span class="MJXp-mi" id="MJXp-Span-5402">exp</span><span class="MJXp-mo" id="MJXp-Span-5403" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5404"><span class="MJXp-mo" id="MJXp-Span-5405" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.049em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.196em; margin-left: -0.336em;">{</span></span><span class="MJXp-mo" id="MJXp-Span-5406" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-menclose" id="MJXp-Span-5407"><span class="MJXp-mrow" id="MJXp-Span-5408"><span class="MJXp-mstyle" id="MJXp-Span-5409"><span class="MJXp-mrow" id="MJXp-Span-5410"><span class="MJXp-munderover" id="MJXp-Span-5411"><span class=""><span class="MJXp-mo" id="MJXp-Span-5412" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5413" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5414">Q</span><span class="MJXp-mo" id="MJXp-Span-5415">‚àà</span><span class="MJXp-munderover" id="MJXp-Span-5416"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5419" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5417">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5418">P</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-5420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5421">Œ≤</span><span class="MJXp-mrow" id="MJXp-Span-5422"><span class="MJXp-mo" id="MJXp-Span-5423" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5424">Œª</span><span class="MJXp-mo" id="MJXp-Span-5425" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5427" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5428" style="vertical-align: -0.4em;">Q</span></span><span class="MJXp-mo" id="MJXp-Span-5429" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-5430" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5431">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5432">s</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5433" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.049em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.196em; margin-left: -0.336em;">}</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-241-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-241">I_P = I_S\exp\left\{ -\boxed{ \sum_{Q \in \overline{CP}} { \beta\left( \lambda, h_Q \right) } \, ds } \right \} </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5434"><span class="MJXp-msubsup" id="MJXp-Span-5435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5436" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5437" style="vertical-align: -0.4em;">Q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-242-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-242">h_Q</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - point height </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5439">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-243-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-243">Q</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The method of dividing a line into a set of segments, which we have just used, is called </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">numerical integration</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If we assume that the initial amount of received light is</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5440"><span class="MJXp-mn" id="MJXp-Span-5441">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-244-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-244"> 1 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then we obtain the equation of atmospheric transmission through an arbitrary segment: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5443">T</span><span class="MJXp-mrow" id="MJXp-Span-5444"><span class="MJXp-mo" id="MJXp-Span-5445" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-5446"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5449" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5447">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5448">P</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5450" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-5451" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-5452">exp</span><span class="MJXp-mo" id="MJXp-Span-5453" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5454"><span class="MJXp-mo" id="MJXp-Span-5455" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.049em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.196em; margin-left: -0.336em;">{</span></span><span class="MJXp-mo" id="MJXp-Span-5456" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-munderover" id="MJXp-Span-5457"><span class=""><span class="MJXp-mo" id="MJXp-Span-5458" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5459" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5460">Q</span><span class="MJXp-mo" id="MJXp-Span-5461">‚àà</span><span class="MJXp-munderover" id="MJXp-Span-5462"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5465" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5463">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5464">P</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-5466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5467">Œ≤</span><span class="MJXp-mrow" id="MJXp-Span-5468"><span class="MJXp-mo" id="MJXp-Span-5469" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5470">Œª</span><span class="MJXp-mo" id="MJXp-Span-5471" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5473" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5474" style="vertical-align: -0.4em;">Q</span></span><span class="MJXp-mo" id="MJXp-Span-5475" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-5476" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5477">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5478">s</span><span class="MJXp-mo" id="MJXp-Span-5479" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.049em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.196em; margin-left: -0.336em;">}</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-245-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-245">T\left(\overline{CP}\right) =\exp\left\{ -\sum_{Q \in \overline{CP}} { \beta\left( \lambda, h_Q \right) } \, ds \right \} </script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We can further expand this expression. </font><font style="vertical-align: inherit;">replacing the total</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5481">Œ≤</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-246-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-246">\beta</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this value used in Rayleigh scattering </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5483">Œ≤</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-247-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-247">\beta</script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5485">T</span><span class="MJXp-mrow" id="MJXp-Span-5486"><span class="MJXp-mo" id="MJXp-Span-5487" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-5488"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5491" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5489">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5490">P</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5492" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-5493" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-5494">exp</span><span class="MJXp-mo" id="MJXp-Span-5495" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5496"><span class="MJXp-mo" id="MJXp-Span-5497" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.049em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.196em; margin-left: -0.336em;">{</span></span><span class="MJXp-mo" id="MJXp-Span-5498" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-munderover" id="MJXp-Span-5499"><span class=""><span class="MJXp-mo" id="MJXp-Span-5500" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5501" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5502">Q</span><span class="MJXp-mo" id="MJXp-Span-5503">‚àà</span><span class="MJXp-munderover" id="MJXp-Span-5504"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5507" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5505">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5506">P</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-5508"><span class="MJXp-menclose" id="MJXp-Span-5509"><span class="MJXp-mrow" id="MJXp-Span-5510"><span class="MJXp-mstyle" id="MJXp-Span-5511"><span class="MJXp-mrow" id="MJXp-Span-5512"><span class="MJXp-mfrac" id="MJXp-Span-5513" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5514">8</span><span class="MJXp-msubsup" id="MJXp-Span-5515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5516" style="margin-right: 0.05em;">œÄ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5517" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-msubsup" id="MJXp-Span-5518"><span class="MJXp-mrow" id="MJXp-Span-5519" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-5520" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-5521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5522" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5523" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-5524" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-5525">1</span><span class="MJXp-mo" id="MJXp-Span-5526" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5527" style="vertical-align: 0.82em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5528">3</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-5529" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5530">œÅ</span><span class="MJXp-mrow" id="MJXp-Span-5531"><span class="MJXp-mo" id="MJXp-Span-5532" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-5533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5534" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5535" style="vertical-align: -0.4em;">Q</span></span><span class="MJXp-mo" id="MJXp-Span-5536" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5537">N</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-5538" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5539">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5541" style="margin-right: 0.05em;">Œª</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5542" style="vertical-align: 0.5em;">4</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-5543" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5544">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5545">s</span><span class="MJXp-mo" id="MJXp-Span-5546" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.049em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.196em; margin-left: -0.336em;">}</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-248-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-248">T\left(\overline{CP}\right) =\exp\left\{ -\sum_{Q \in \overline{CP}} { \boxed{\frac{8\pi^3 \left(n^2-1 \right )^2}{3} \frac{\rho\left(h_Q\right)}{N} \frac{1}{\lambda^4}} } \, ds \right \} </script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Many factors </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5548">Œ≤</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-249-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-249">\beta</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> are constant, so that they can be taken out for the sum: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5550">T</span><span class="MJXp-mrow" id="MJXp-Span-5551"><span class="MJXp-mo" id="MJXp-Span-5552" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-5553"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5556" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5554">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5555">P</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5557" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-5558" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-5559">exp</span><span class="MJXp-mo" id="MJXp-Span-5560" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5561"><span class="MJXp-mo" id="MJXp-Span-5562" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.278em;"><span class="MJXp-right MJXp-scale2" style="font-size: 10.111em; margin-left: -0.394em;">{</span></span><span class="MJXp-mo" id="MJXp-Span-5563" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-munder" id="MJXp-Span-5564"><span class=""><span class="MJXp-munder" id="MJXp-Span-5565"><span class=""><span class="MJXp-mrow" id="MJXp-Span-5566"><span class="MJXp-munderover" id="MJXp-Span-5567"><span class=""><span class="MJXp-mfrac" id="MJXp-Span-5568" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5569">8</span><span class="MJXp-msubsup" id="MJXp-Span-5570"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5571" style="margin-right: 0.05em;">œÄ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5572" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-msubsup" id="MJXp-Span-5573"><span class="MJXp-mrow" id="MJXp-Span-5574" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-5575" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-5576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5577" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5578" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-5579" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-5580">1</span><span class="MJXp-mo" id="MJXp-Span-5581" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5582" style="vertical-align: 0.82em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5583">3</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-5584" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5585">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5586">N</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-5587" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-5588">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5590" style="margin-right: 0.05em;">Œª</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5591" style="vertical-align: 0.5em;">4</span></span></span></span></span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-5592" style="margin-left: 0px; margin-right: 0em;">‚èü</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mtext" id="MJXp-Span-5593" style="margin-left: 0px;">constant</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5594" style="margin-left: 0px;">Œ≤</span><span class="MJXp-mrow" id="MJXp-Span-5595"><span class="MJXp-mo" id="MJXp-Span-5596">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5597">Œª</span><span class="MJXp-mo" id="MJXp-Span-5598">)</span></span></span></span><span class="MJXp-mover" id="MJXp-Span-5599"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mtext" id="MJXp-Span-5623" style="margin-right: 0px; margin-left: 0px;">optical depth</span><span class="MJXp-mspace" id="MJXp-Span-5624" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5625">D</span><span class="MJXp-mrow" id="MJXp-Span-5626"><span class="MJXp-mo" id="MJXp-Span-5627" style="vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-5628"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5631" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5629">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5630">P</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5632" style="vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">)</span></span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-5600"><span class="MJXp-munderover" id="MJXp-Span-5601"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-5622" style="margin-left: 0px; margin-right: 0px;">‚èû</span></span><span class=""><span class="MJXp-munderover" id="MJXp-Span-5602"><span class=""><span class="MJXp-mo" id="MJXp-Span-5603" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5604" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5605">Q</span><span class="MJXp-mo" id="MJXp-Span-5606">‚àà</span><span class="MJXp-munderover" id="MJXp-Span-5607"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5610" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5608">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5609">P</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-5611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5612">œÅ</span><span class="MJXp-mrow" id="MJXp-Span-5613"><span class="MJXp-mo" id="MJXp-Span-5614" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-5615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5616" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5617" style="vertical-align: -0.4em;">Q</span></span><span class="MJXp-mo" id="MJXp-Span-5618" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-5619" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5620">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5621">s</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5633" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.278em;"><span class="MJXp-right MJXp-scale2" style="font-size: 10.111em; margin-left: -0.394em;">}</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-250-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-250">T\left(\overline{CP}\right) =\exp\left\{ - \underset{\beta\left(\lambda\right)}{ \underset{\text{constant}}{ \underbrace{ \frac{8\pi^3 \left(n^2-1 \right )^2}{3} \frac{1}{N} \frac{1}{\lambda^4} }}} \overset{\text{optical depth}\,D\left(\overline{CP}\right)}{ \overbrace{ \sum_{Q \in \overline{CP}} { \rho\left(h_Q\right) } \, ds}} \right \}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The amount expressed by summation is called the </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optical thickness.</font></font></strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5635">D</span><span class="MJXp-mrow" id="MJXp-Span-5636"><span class="MJXp-mo" id="MJXp-Span-5637" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-5638"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5641" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5639">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5640">P</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5642" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">)</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-251-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-251">D\left(\overline{CP}\right)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which we will calculate in the shader. </font><font style="vertical-align: inherit;">The remainder is an increment factor that can be calculated only once, and it corresponds to </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the scattering coefficient at sea level</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In the finished shader, we will calculate only the optical thickness, and the scattering coefficients at sea level</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5644">Œ≤</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-252-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-252">\beta</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will pass as input. </font></font><br><br>  Summarize: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5646">T</span><span class="MJXp-mrow" id="MJXp-Span-5647"><span class="MJXp-mo" id="MJXp-Span-5648" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-5649"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5652" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5650">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5651">P</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5653" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-5654" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-5655">exp</span><span class="MJXp-mo" id="MJXp-Span-5656" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5657"><span class="MJXp-mo" id="MJXp-Span-5658" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.278em;">{</span></span><span class="MJXp-mo" id="MJXp-Span-5659" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5660">Œ≤</span><span class="MJXp-mrow" id="MJXp-Span-5661"><span class="MJXp-mo" id="MJXp-Span-5662" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5663">Œª</span><span class="MJXp-mo" id="MJXp-Span-5664" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5665">D</span><span class="MJXp-mrow" id="MJXp-Span-5666"><span class="MJXp-mo" id="MJXp-Span-5667" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-5668"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-5671" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5669">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5670">P</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5672" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-5673" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.644em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.578em; margin-left: -0.278em;">}</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-253-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-253">T\left(\overline{CP}\right) =\exp\left\{ - \beta\left(\lambda\right) D\left(\overline{CP}\right) \right\}</script></p><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Part 5. Atmospheric shader. </font></font></h2><br><h4>  Introduction </h4><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Shader writing </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We can start writing a shader for this effect in an infinite number of ways. Since we want to render atmospheric scattering on the planets, it is logical to assume that it will be used on the spheres. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you use this tutorial to create a game, there is a chance that you will apply a shader to a ready-made planet. Adding atmospheric scatter calculations over the top is possible, but usually gives poor results. The reason is that the atmosphere is larger than the radius of the planet, so it needs to be rendered on a slightly larger transparent sphere. The figure below shows how the atmosphere extends above the surface of the planet, mixing with the empty space behind it.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/318/262/c03/318262c03c89f4a7ec29e1a9868b998e.jpg" width="1400" height="854"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The application of scattered material to a separate sphere is possible, but redundant. </font><font style="vertical-align: inherit;">In this tutorial, I suggest expanding </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standard Surface Shader</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Unity by adding </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a shader pass</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that renders the atmosphere in a slightly larger sphere. </font><font style="vertical-align: inherit;">We will call it the </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atmospheric sphere</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Shader with two passes </font></font></h4><br>  If you have previously worked with Unity <strong>surface shaders</strong> , you might have noticed that they do not support the <code>Pass</code> block, with which several passes are set in the <strong>vertex and fragment</strong> <strong>shaders</strong> . <br><br>  Creating a two-pass shader may be as simple as adding two separate sections of CG code into one <code>SubShader</code> block: <br><br><pre> <code class="hljs ruby">Shader <span class="hljs-string"><span class="hljs-string">"Custom/NewSurfaceShader"</span></span> { Properties { _Color (<span class="hljs-string"><span class="hljs-string">"Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) _MainTex (<span class="hljs-string"><span class="hljs-string">"Albedo (RGB)"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Glossiness (<span class="hljs-string"><span class="hljs-string">"Smoothness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">5</span></span> _Metallic (<span class="hljs-string"><span class="hljs-string">"Metallic"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> } SubShader { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ---   --- Tags { <span class="hljs-string"><span class="hljs-string">"RenderType"</span></span>=<span class="hljs-string"><span class="hljs-string">"Opaque"</span></span> } LOD <span class="hljs-number"><span class="hljs-number">200</span></span> CGPROGRAM /<span class="hljs-regexp"><span class="hljs-regexp">/   Cg ENDCG /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ ------------------ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ ---   --- Tags { "RenderType"="Opaque" } LOD 200 CGPROGRAM /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   Cg ENDCG /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ ------------------- } FallBack "Diffuse" }</span></span></code> </pre> <br>  You can change the first pass to render the planet.  From now on, we will focus on the second pass, implementing atmospheric scattering in it. <br><br><h4>  Normal extrusion </h4><br>  The atmospheric sphere is slightly larger than the planet.  This means that the second pass must extrude the sphere out.  If smooth normals are used in the model you are using, then we can achieve this effect by using a technique called <strong>normal extrusion</strong> . <br><br>  Normal extrusion is one of the oldest shader tricks, and is usually one of the first to learn.  In my blog there are many references to it;  A good start can be a Post A <a href="https://www.alanzucconi.com/%3Fp%3D1900" rel="noopener">Surface Shader</a> from the <strong>A Gentle Introduction to Shaders</strong> series. <br><br>  If you are unfamiliar with how extrusion of normals works, then I will explain: all vertices are processed by the shader using its <strong>vertex function</strong> .  We can use this function to change the position of each vertex, making the sphere larger. <br><br>  The first step is to change the <code>pragma</code> directive by adding <code>vertex:vert</code> to it <code>vertex:vert</code> ;  this will force Unity to execute the <code>vert</code> function for each vertex. <br><br><pre> <code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> surface surf StandardScattering vertex:vert void vert (inout appdata_full v, out Input o) { UNITY_INITIALIZE_OUTPUT(Input,o); v.vertex.xyz += v.normal * (_AtmosphereRadius - _PlanetRadius); }</span></span></code> </pre> <br>  This code snippet shows a vertex function extruding a sphere along its normals.  The magnitude of the extrusion sphere depends on the size of the atmosphere and the size of the planet.  Both of these values ‚Äã‚Äãneed to be passed to the shader as <strong>properties</strong> that can be accessed through the <strong>material inspector</strong> . <br><br>  Our shader also needs to know where the center of the planet is.  We can add its calculation to the vertex function too.  Finding the center point of an object in the space of the world was discussed in the article <a href="https://www.alanzucconi.com/%3Fp%3D2001" rel="noopener">Vertex and Fragment Shaders</a> . <br><br><pre> <code class="hljs pgsql">struct <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> { float2 uv_MainTex; float3 worldPos; //   Unity float3 centre; //     }; <span class="hljs-type"><span class="hljs-type">void</span></span> vert (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> o) { UNITY_INITIALIZE_OUTPUT(<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>,o); v.vertex.xyz += v.normal * (_AtmosphereRadius - _PlanetRadius); o.centre = mul(unity_ObjectToWorld, half4(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)); }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">What is UNITY_INITIALIZE_OUTPUT?</b> <div class="spoiler_text">  If you look at the vertex function, you can see that it always contains the mysterious call <code>UNITY_INITIALIZE_OUTPUT</code> .  The shader obtains the position of the vertices in the object space, and it needs to project them into the coordinates of the world using the positions, scale and rotation provided by Unity. <br><br>  And this is one of the operations performed by <code>UNITY_INITIALIZE_OUTPUT</code> .  Without it, we would have to write the code necessary for these calculations ourselves. </div></div><br><h4>  Additive blending </h4><br>  Another interesting feature that we need to deal with is transparency.  Usually transparent material allows you to see what is behind the object.  This solution will not work in our case, because the atmosphere is not just a transparent piece of plastic.  Light passes through it, so we need to use <strong>additive blending mode</strong> to increase the luminosity of the planet. <br><br>  In the default Unity surface shader, no blend mode is enabled by default.  To change the situation, we will have to replace the tags in the second pass with the following: <br><br><pre> <code class="hljs objectivec">Tags { <span class="hljs-string"><span class="hljs-string">"RenderType"</span></span>=<span class="hljs-string"><span class="hljs-string">"Transparent"</span></span> <span class="hljs-string"><span class="hljs-string">"Queue"</span></span>=<span class="hljs-string"><span class="hljs-string">"Transparent"</span></span>} LOD <span class="hljs-number"><span class="hljs-number">200</span></span> Cull Back Blend One One</code> </pre> <br>  The <code>Blend One One</code> expression is used by the shader to refer to the additive blending mode. <br><br><h4>  Own lighting function </h4><br>  Most often, when writing a surface shader, programmers change its <code>surf</code> function, which is used to provide ‚Äúphysical‚Äù properties, such as albedo, smoothness of the surface, metallic properties, etc.  All these properties are then used by the shader to compute realistic shading. <br><br>  In our case, these calculations are not required.  To get rid of them, we need to remove <strong>the lighting model</strong> used by the shader.  I examined this topic in detail;  You can study the following posts to figure out how to do it: <br><br><ul><li>  <a href="https://www.alanzucconi.com/%3Fp%3D5660" rel="noopener">3D Printer Shader Effect</a> ( <a href="https://habrahabr.ru/post/331576/">transfer</a> to Habr√©) </li><li>  <a href="https://www.alanzucconi.com/%3Fp%3D6767" rel="noopener">CD-ROM Shader: Diffraction Grating</a> </li><li>  <a href="https://www.alanzucconi.com/%3Fp%3D7053" rel="noopener">Fast Subsurface Scattering in Unity</a> ( <a href="https://habrahabr.ru/post/337370/">transfer</a> to Habr√©) </li></ul><br>  The new lighting model will be called <code>StandardScattering</code> ;  we must create functions for real-time lighting and global lighting, that is, respectively, <code>LightingStandardScattering</code> and <code>LightingStandardScattering_GI</code> . <br><br>  In the code we need to write, properties such as the <strong>direction of light</strong> and the <strong>direction of view</strong> will also be used.  They can be obtained using the following code snippet. <br><br><pre> <code class="hljs cpp"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> surface surf StandardScattering vertex:vert #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"UnityPBSLighting.cginc"</span></span></span><span class="hljs-meta"> inline fixed4 LightingStandardScattering(SurfaceOutputStandard s, fixed3 viewDir, UnityGI gi) { float3 L = gi.light.dir; float3 V = viewDir; float3 N = s.Normal; float3 S = L; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//     float3 D = -V; //   ,    ... } void LightingStandardScattering_GI(SurfaceOutputStandard s, UnityGIInput data, inout UnityGI gi) { LightingStandard_GI(s, data, gi); }</span></span></span></span></code> </pre> <br>  In <code>...</code> will be the shader code itself, which is needed to implement this effect. <br><br><h4>  Floating point accuracy </h4><br>  In this tutorial we will assume that all calculations are made in meters.  This means that if we need to simulate the Earth, we need a sphere with a radius of 6,371,000 meters.  In fact, in Unity, this is not possible due to floating-point number errors that occur when you have to work with very large and very small numbers at the same time. <br><br>  To circumvent these limitations, you can change the scale of the scattering coefficient to compensate.  For example, if a planet has a radius of only 6.371 meters, then the scattering coefficient <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5674"><span class="MJXp-mtext" id="MJXp-Span-5675">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5676">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5677">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5678">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5679">a</span><span class="MJXp-mtext" id="MJXp-Span-5680">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5681">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5682">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5683">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5684">t</span><span class="MJXp-mo" id="MJXp-Span-5685" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-5686">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5687">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5688">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5689">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5690">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5691">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5692">a</span><span class="MJXp-mtext" id="MJXp-Span-5693">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5694">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5695">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5696">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5697">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5698">t</span><span class="MJXp-mo" id="MJXp-Span-5699" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-254-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-254"> \ beta \ left (\ lambda \ right) </script>  should be more than 1,000,000 times, and the height given <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5701">H</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-255-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-255"> H </script>  - 1,000,000 times smaller. <br><br>  In my project Unity all properties and calculations are expressed in meters.  This allows us to use real, physical values ‚Äã‚Äãfor the scattering coefficients and the reduced height.  However, the shader gets the size of the sphere in meters so that it can convert the scale from Unity units to real scale meters. <br><br><h2>  Part 6. The intersection of the atmosphere. </h2><br>  As stated above, the only way to calculate the <strong>optical thickness of a</strong> segment passing through the atmosphere is <strong>numerical integration</strong> .  This means that it is necessary to divide the interval into smaller segments of length. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5703">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5704">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-256-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-256"> ds </script>  and calculate the optical thickness of each, considering its density constant. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c1/b69/128/8c1b691280174ac7b16a70dd90510304.png" width="705" height="257"></div><br>  Image above is optical thickness. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5705"><span class="MJXp-mtext" id="MJXp-Span-5706">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5707">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5708">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5709">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5710">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5711">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5712">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5713">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5714">e</span><span class="MJXp-mrow" id="MJXp-Span-5715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5716">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5717">B</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-257-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-257"> \ overline {AB} </script>  It is calculated by four samples, each of which takes into account the density in the center of the segment itself. <br><br>  The first step will obviously be finding the points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5719">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-258-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-258"> A </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5721">B</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-259-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-259"> B </script>  .  If we assume that the objects we are rendering are a sphere, then Unity will try to render its surface.  Each pixel on the screen corresponds to a point on the sphere.  In the figure below, this point is called <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5723">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-260-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-260"> O </script>  (from <em>origin</em> ).  In surface shader <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5725">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-261-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-261"> O </script>  corresponds to the <code>worldPos</code> variable in the <code>Input</code> structure.  This is the amount of work the shader does;  the only information available to us is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5727">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-262-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-262"> O </script>  direction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5729">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-263-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-263"> D </script>  which denotes the direction of the <strong>ray of sight</strong> , and the atmospheric sphere centered <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5731">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-264-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-264"> C </script>  and radius <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5733">R</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-265-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-265"> R </script>  .  The difficulty is in calculating <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5735">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-266-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-266"> A </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5737">B</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-267-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-267"> B </script>  .  It will be the quickest to use geometry, reducing the task to finding the intersection of the <strong>atmospheric sphere</strong> and the <strong>ray of visibility of the</strong> camera. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e65/8cc/303/e658cc30388c1c41f395c9d2e0fa9f18.png" width="745" height="357"></div><br>  First, it is worth noting that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5739">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-268-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-268"> O </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5741">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-269-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-269"> A </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5743">B</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-270-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-270"> B </script>  lie on the line of sight.  This means that we can treat their position not as a point in 3D space, but as distance from the line of sight to origin. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5745">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-271-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-271"> A </script>  - this is the real point (represented in the shader as <code>float3</code> ), and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5747">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5748">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-272-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-272"> AO </script>  - distance to the starting point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5750">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-273-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-273"> O </script>  (stored as <code>float</code> ). <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5752">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-274-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-274"> A </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5754">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5755">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-275-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-275"> AO </script>  - two equally correct ways of designating the same point, that is true: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5757">A</span><span class="MJXp-mo" id="MJXp-Span-5758" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5759">O</span><span class="MJXp-mo" id="MJXp-Span-5760" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-5761">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5762">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5763">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5764">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5765">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5766">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5767">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5768">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5769">e</span><span class="MJXp-mrow" id="MJXp-Span-5770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5771">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5772">O</span></span><span class="MJXp-mspace" id="MJXp-Span-5773" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5774">D</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-276-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-276"> A = O + \ overline {AO} \, D </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5776">B</span><span class="MJXp-mo" id="MJXp-Span-5777" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5778">O</span><span class="MJXp-mo" id="MJXp-Span-5779" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-5780">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5781">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5782">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5783">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5784">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5785">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5786">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5787">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5788">e</span><span class="MJXp-mrow" id="MJXp-Span-5789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5790">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5791">O</span></span><span class="MJXp-mspace" id="MJXp-Span-5792" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5793">D</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-277-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-277"> B = O + \ overline {BO} \, D </script></p><br>  where is the entry with the dash above <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5794"><span class="MJXp-mtext" id="MJXp-Span-5795">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5796">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5797">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5798">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5799">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5800">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5801">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5802">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5803">e</span><span class="MJXp-mrow" id="MJXp-Span-5804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5805">X</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5806">Y</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-278-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-278"> \ overline {XY} </script>  denotes the length of the segment between two arbitrary points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5808">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-279-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-279"> X </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5810">Y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-280-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-280"> Y </script>  . <br><br>  In the shader code for efficiency we will use <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5812">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5813">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-281-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-281"> AO </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5814"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5815">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5816">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-282-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-282"> BO </script>  and calculate them from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5817"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5818">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5819">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-283-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-283"> OT </script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5820"><span class="MJXp-mtext" id="MJXp-Span-5821">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5822">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5823">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5824">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5825">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5826">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5827">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5828">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5829">e</span><span class="MJXp-mrow" id="MJXp-Span-5830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5831">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5832">O</span></span><span class="MJXp-mo" id="MJXp-Span-5833" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-5834">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5835">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5836">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5837">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5838">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5839">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5840">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5841">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5842">e</span><span class="MJXp-mrow" id="MJXp-Span-5843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5844">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5845">T</span></span><span class="MJXp-mo" id="MJXp-Span-5846" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-5847">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5848">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5849">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5850">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5851">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5852">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5853">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5854">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5855">e</span><span class="MJXp-mrow" id="MJXp-Span-5856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5857">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5858">T</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-284-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-284"> \ overline {AO} = \ overline {OT} - \ overline {AT} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5859"><span class="MJXp-mtext" id="MJXp-Span-5860">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5861">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5862">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5863">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5864">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5865">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5866">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5867">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5868">e</span><span class="MJXp-mrow" id="MJXp-Span-5869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5870">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5871">O</span></span><span class="MJXp-mo" id="MJXp-Span-5872" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-5873">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5874">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5875">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5876">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5877">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5878">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5879">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5880">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5881">e</span><span class="MJXp-mrow" id="MJXp-Span-5882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5883">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5884">T</span></span><span class="MJXp-mo" id="MJXp-Span-5885" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-5886">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5887">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5888">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5889">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5890">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5891">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5892">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5893">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5894">e</span><span class="MJXp-mrow" id="MJXp-Span-5895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5896">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5897">T</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-285-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-285"> \ overline {BO} = \ overline {OT} + \ overline {BT} </script></p><br>  It is also worth noting that the segments <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5898"><span class="MJXp-mtext" id="MJXp-Span-5899">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5900">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5901">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5902">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5903">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5904">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5905">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5906">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5907">e</span><span class="MJXp-mrow" id="MJXp-Span-5908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5909">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5910">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-286-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-286"> \ overline {AT} </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5911"><span class="MJXp-mtext" id="MJXp-Span-5912">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5913">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5914">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5915">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5916">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5917">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5918">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5919">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5920">e</span><span class="MJXp-mrow" id="MJXp-Span-5921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5922">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5923">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-287-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-287"> \ overline {BT} </script>  have the same length.  Now, to find the points of intersection, we need to calculate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5924"><span class="MJXp-mtext" id="MJXp-Span-5925">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5926">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5927">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5928">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5929">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5930">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5931">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5932">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5933">e</span><span class="MJXp-mrow" id="MJXp-Span-5934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5935">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5936">O</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-288-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-288"> \ overline {AO} </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5937"><span class="MJXp-mtext" id="MJXp-Span-5938">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5939">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5940">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5941">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5942">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5943">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5944">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5945">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5946">e</span><span class="MJXp-mrow" id="MJXp-Span-5947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5948">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5949">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-289-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-289"> \ overline {AT} </script>  . <br><br>  Section <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5950"><span class="MJXp-mtext" id="MJXp-Span-5951">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5952">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5953">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5954">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5955">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5956">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5957">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5958">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5959">e</span><span class="MJXp-mrow" id="MJXp-Span-5960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5961">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5962">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-290-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-290"> \ overline {OT} </script>  it is easiest to calculate.  If you look at the diagram above, you can see that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5963"><span class="MJXp-mtext" id="MJXp-Span-5964">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5965">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5966">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5967">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5968">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5969">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5970">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5971">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5972">e</span><span class="MJXp-mrow" id="MJXp-Span-5973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5974">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5975">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-291-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-291"> \ overline {OT} </script>  is a projection of a vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5977">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5978">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-292-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-292"> CO </script>  on the ray of sight.  Mathematically, this projection can be performed using a <strong>scalar product</strong> .  If you are familiar with shaders, you may know that a scalar product is a measure of how ‚Äúaligned‚Äù the two directions are.  When it is applied to two vectors, and one of them has a unit length, it becomes the projection operator: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5979"><span class="MJXp-mtext" id="MJXp-Span-5980">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5981">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5982">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5983">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5984">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5985">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5986">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5987">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5988">e</span><span class="MJXp-mrow" id="MJXp-Span-5989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5990">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5991">T</span></span><span class="MJXp-mo" id="MJXp-Span-5992" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-5993">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5994">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5995">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5996">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5997">t</span><span class="MJXp-mo" id="MJXp-Span-5998" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5999">C</span><span class="MJXp-mo" id="MJXp-Span-6000" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6001">O</span><span class="MJXp-mtext" id="MJXp-Span-6002">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6003">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6004">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6005">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6006">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6007">t</span><span class="MJXp-mo" id="MJXp-Span-6008" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-6009">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6010">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6011">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6012">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6013">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6014">D</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-293-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-293"> \ overline {OT} = \ left (C-O \ right) \ cdot D </script></p><br>  It is also worth noting that <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6015"><span class="MJXp-mtext" id="MJXp-Span-6016">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6017">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6018">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6019">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6020">t</span><span class="MJXp-mo" id="MJXp-Span-6021" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6022">C</span><span class="MJXp-mo" id="MJXp-Span-6023" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6024">O</span><span class="MJXp-mtext" id="MJXp-Span-6025">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6026">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6027">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6028">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6029">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6030">t</span><span class="MJXp-mo" id="MJXp-Span-6031" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-294-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-294"> \ left (C-O \ right) </script>  - this is a three-dimensional vector, and not the length of the segment between <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6033">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-295-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-295"> C </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6035">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-296-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-296"> O </script>  . <br><br>  Next, we need to calculate the length of the segment <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6036"><span class="MJXp-mtext" id="MJXp-Span-6037">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6038">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6039">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6040">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6041">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6042">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6043">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6044">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6045">e</span><span class="MJXp-mrow" id="MJXp-Span-6046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6047">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6048">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-297-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-297"> \ overline {AT} </script>  .  It can be calculated using <strong>the Pythagon theorem</strong> in the triangle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6049"><span class="MJXp-mtext" id="MJXp-Span-6050">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6051">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6052">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6053">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6054">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6055">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6056">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6057">t</span><span class="MJXp-mrow" id="MJXp-Span-6058"><span class="MJXp-mtext" id="MJXp-Span-6059">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6060">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6061">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6062">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6063">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6064">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6065">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6066">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6067">e</span></span><span class="MJXp-mrow" id="MJXp-Span-6068"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6069">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6070">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6071">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-298-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-298"> \ overset {\ triangle} {ACT} </script>  .  She claims that: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6072"><span class="MJXp-msubsup" id="MJXp-Span-6073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6074" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6075" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6076" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6077">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6078">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6079">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6080">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6081">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6082">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6083">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6084">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6085">e</span><span class="MJXp-msubsup" id="MJXp-Span-6086"><span class="MJXp-mrow" id="MJXp-Span-6087" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6088">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6089">T</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6090" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6091" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-6092">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6093">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6094">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6095">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6096">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6097">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6098">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6099">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6100">e</span><span class="MJXp-mrow" id="MJXp-Span-6101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6102">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6103">T</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-299-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-299"> R ^ 2 = \ overline {AT} ^ 2 + \ overline {CT} </script></p><br>  And this means that: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6104"><span class="MJXp-mtext" id="MJXp-Span-6105">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6106">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6107">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6108">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6109">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6110">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6111">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6112">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6113">e</span><span class="MJXp-mrow" id="MJXp-Span-6114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6115">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6116">T</span></span><span class="MJXp-mo" id="MJXp-Span-6117" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6118">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6119">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6120">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6121">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6122">t</span><span class="MJXp-mrow" id="MJXp-Span-6123"><span class="MJXp-msubsup" id="MJXp-Span-6124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6125" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6126" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6127" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-6128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6129">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6130">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6131">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6132">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6133">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6134">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6135">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6136">e</span><span class="MJXp-mrow" id="MJXp-Span-6137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6138">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6139">T</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-300-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-300"> \ overline {AT} = \ sqrt {R ^ 2 - \ overline {CT}} </script></p><br>  Length <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6140"><span class="MJXp-mtext" id="MJXp-Span-6141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6142">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6143">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6144">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6145">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6146">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6147">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6148">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6149">e</span><span class="MJXp-mrow" id="MJXp-Span-6150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6151">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6152">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-301-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-301"> \ overline {CT} </script>  still unknown.  However, it can be calculated by again applying the Pythagorean theorem to the triangle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6153"><span class="MJXp-mtext" id="MJXp-Span-6154">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6155">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6156">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6157">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6158">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6159">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6160">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6161">t</span><span class="MJXp-mrow" id="MJXp-Span-6162"><span class="MJXp-mtext" id="MJXp-Span-6163">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6164">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6165">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6166">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6167">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6168">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6169">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6170">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6171">e</span></span><span class="MJXp-mrow" id="MJXp-Span-6172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6173">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6174">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6175">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-302-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-302"> \ overset {\ triangle} {OCT} </script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6176"><span class="MJXp-mtext" id="MJXp-Span-6177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6178">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6179">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6180">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6181">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6182">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6183">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6184">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6185">e</span><span class="MJXp-msubsup" id="MJXp-Span-6186"><span class="MJXp-mrow" id="MJXp-Span-6187" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6188">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6189">O</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6190" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6191" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6192">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6193">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6194">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6195">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6196">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6197">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6198">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6199">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6200">e</span><span class="MJXp-msubsup" id="MJXp-Span-6201"><span class="MJXp-mrow" id="MJXp-Span-6202" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6203">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6204">T</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6205" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6206" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-6207">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6208">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6209">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6210">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6211">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6212">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6213">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6214">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6215">e</span><span class="MJXp-msubsup" id="MJXp-Span-6216"><span class="MJXp-mrow" id="MJXp-Span-6217" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6218">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6219">T</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6220" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-303-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-303"> \ overline {CO} ^ 2 = \ overline {OT} ^ 2 + \ overline {CT} ^ 2 </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6221"><span class="MJXp-mtext" id="MJXp-Span-6222">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6223">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6224">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6225">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6226">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6227">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6228">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6229">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6230">e</span><span class="MJXp-mrow" id="MJXp-Span-6231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6232">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6233">T</span></span><span class="MJXp-mo" id="MJXp-Span-6234" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6235">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6236">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6237">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6238">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6239">t</span><span class="MJXp-mrow" id="MJXp-Span-6240"><span class="MJXp-mtext" id="MJXp-Span-6241">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6242">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6243">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6244">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6245">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6246">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6247">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6248">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6249">e</span><span class="MJXp-msubsup" id="MJXp-Span-6250"><span class="MJXp-mrow" id="MJXp-Span-6251" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6252">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6253">O</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6254" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6255" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-6256">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6257">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6258">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6259">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6260">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6261">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6262">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6263">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6264">e</span><span class="MJXp-msubsup" id="MJXp-Span-6265"><span class="MJXp-mrow" id="MJXp-Span-6266" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6267">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6268">T</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6269" style="vertical-align: 0.5em;">2</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-304-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-304"> \ overline {CT} = \ sqrt {\ overline {CO} ^ 2 - \ overline {OT} ^ 2} </script></p><br>  Now we have all the necessary quantities.  Summarize: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6270"><span class="MJXp-mtext" id="MJXp-Span-6271">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6272">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6273">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6274">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6275">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6276">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6277">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6278">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6279">e</span><span class="MJXp-mrow" id="MJXp-Span-6280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6281">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6282">T</span></span><span class="MJXp-mo" id="MJXp-Span-6283" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6284">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6285">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6286">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6287">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6288">t</span><span class="MJXp-mo" id="MJXp-Span-6289" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6290">C</span><span class="MJXp-mo" id="MJXp-Span-6291" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6292">O</span><span class="MJXp-mtext" id="MJXp-Span-6293">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6294">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6295">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6296">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6297">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6298">t</span><span class="MJXp-mo" id="MJXp-Span-6299" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-6300">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6301">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6302">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6303">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6304">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6305">D</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-305-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-305"> \ overline {OT} = \ left (C-O \ right) \ cdot D </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6306"><span class="MJXp-mtext" id="MJXp-Span-6307">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6308">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6309">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6310">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6311">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6312">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6313">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6314">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6315">e</span><span class="MJXp-mrow" id="MJXp-Span-6316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6317">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6318">T</span></span><span class="MJXp-mo" id="MJXp-Span-6319" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6321">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6322">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6323">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6324">t</span><span class="MJXp-mrow" id="MJXp-Span-6325"><span class="MJXp-mtext" id="MJXp-Span-6326">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6327">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6328">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6329">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6330">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6331">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6332">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6333">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6334">e</span><span class="MJXp-msubsup" id="MJXp-Span-6335"><span class="MJXp-mrow" id="MJXp-Span-6336" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6337">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6338">O</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6339" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6340" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-6341">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6342">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6343">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6344">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6345">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6346">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6347">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6348">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6349">e</span><span class="MJXp-msubsup" id="MJXp-Span-6350"><span class="MJXp-mrow" id="MJXp-Span-6351" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6352">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6353">T</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6354" style="vertical-align: 0.5em;">2</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-306-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-306"> \ overline {CT} = \ sqrt {\ overline {CO} ^ 2 - \ overline {OT} ^ 2} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6355"><span class="MJXp-mtext" id="MJXp-Span-6356">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6357">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6358">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6359">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6360">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6361">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6362">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6363">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6364">e</span><span class="MJXp-mrow" id="MJXp-Span-6365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6366">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6367">T</span></span><span class="MJXp-mo" id="MJXp-Span-6368" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6369">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6370">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6371">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6372">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6373">t</span><span class="MJXp-mrow" id="MJXp-Span-6374"><span class="MJXp-msubsup" id="MJXp-Span-6375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6376" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6377" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6378" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-6379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6380">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6381">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6382">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6383">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6384">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6385">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6386">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6387">e</span><span class="MJXp-msubsup" id="MJXp-Span-6388"><span class="MJXp-mrow" id="MJXp-Span-6389" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6390">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6391">T</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6392" style="vertical-align: 0.5em;">2</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-307-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-307"> \ overline {AT} = \ sqrt {R ^ 2 - \ overline {CT} ^ 2} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6393"><span class="MJXp-mtext" id="MJXp-Span-6394">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6395">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6396">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6397">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6398">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6399">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6400">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6401">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6402">e</span><span class="MJXp-mrow" id="MJXp-Span-6403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6404">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6405">O</span></span><span class="MJXp-mo" id="MJXp-Span-6406" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6407">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6408">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6409">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6410">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6411">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6412">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6413">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6414">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6415">e</span><span class="MJXp-mrow" id="MJXp-Span-6416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6417">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6418">T</span></span><span class="MJXp-mo" id="MJXp-Span-6419" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-6420">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6421">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6422">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6423">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6424">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6425">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6426">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6427">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6428">e</span><span class="MJXp-mrow" id="MJXp-Span-6429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6430">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6431">T</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-308-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-308"> \ overline {AO} = \ overline {OT} - \ overline {AT} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6432"><span class="MJXp-mtext" id="MJXp-Span-6433">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6434">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6435">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6436">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6437">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6438">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6439">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6440">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6441">e</span><span class="MJXp-mrow" id="MJXp-Span-6442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6443">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6444">O</span></span><span class="MJXp-mo" id="MJXp-Span-6445" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6446">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6447">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6448">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6449">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6450">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6451">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6452">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6453">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6454">e</span><span class="MJXp-mrow" id="MJXp-Span-6455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6456">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6457">T</span></span><span class="MJXp-mo" id="MJXp-Span-6458" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-6459">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6460">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6461">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6462">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6463">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6464">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6465">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6466">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6467">e</span><span class="MJXp-mrow" id="MJXp-Span-6468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6469">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6470">T</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-309-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-309"> \ overline {BO} = \ overline {OT} + \ overline {AT} </script></p><br>  This set of equations has square roots.  They are defined only for non-negative numbers.  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6471"><span class="MJXp-msubsup" id="MJXp-Span-6472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6473" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6474" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6475" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mtext" id="MJXp-Span-6476">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6477">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6478">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6479">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6480">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6481">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6482">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6483">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6484">e</span><span class="MJXp-msubsup" id="MJXp-Span-6485"><span class="MJXp-mrow" id="MJXp-Span-6486" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6487">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6488">T</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6489" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-310-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-310"> R ^ 2> \ overline {CT} ^ 2 </script>  , there is no solution, which means that the ray of visibility does not intersect the sphere. <br><br>  We can convert this to the following Cg function: <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">bool</span></span> rayIntersect ( // Ray float3 O, // Origin float3 D, //  //  float3 C, //  <span class="hljs-type"><span class="hljs-type">float</span></span> R, //  <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-type"><span class="hljs-type">float</span></span> AO, //    <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-type"><span class="hljs-type">float</span></span> BO //    ) { float3 L = C - O; <span class="hljs-type"><span class="hljs-type">float</span></span> DT = dot (L, D); <span class="hljs-type"><span class="hljs-type">float</span></span> R2 = R * R; <span class="hljs-type"><span class="hljs-type">float</span></span> CT2 = dot(L,L) - DT*DT; //      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (CT2 &gt; R2) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-type"><span class="hljs-type">float</span></span> AT = sqrt(R2 - CT2); <span class="hljs-type"><span class="hljs-type">float</span></span> BT = AT; AO = DT - AT; BO = DT + BT; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> <br>  It returns not one, but three values. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6490"><span class="MJXp-mtext" id="MJXp-Span-6491">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6492">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6493">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6494">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6495">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6496">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6497">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6498">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6499">e</span><span class="MJXp-mrow" id="MJXp-Span-6500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6501">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6502">O</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-311-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-311"> \ overline {AO} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6503"><span class="MJXp-mtext" id="MJXp-Span-6504">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6505">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6506">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6507">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6508">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6509">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6510">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6511">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6512">e</span><span class="MJXp-mrow" id="MJXp-Span-6513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6514">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6515">O</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-312-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-312"> \ overline {BO} </script>  as well as the binary value of the presence of the intersection.  The lengths of these two segments are returned using the out keywords, which save after the completion of the function any changes that it made to these parameters. <br><br><h4>  Colliding with the planet </h4><br>  There is another problem to consider.  Some rays of visibility collide with the planet, so their journey through the atmosphere ends early.  One solution is to revise the output above. <br><br>  A simpler, but less efficient approach is to perform <code>rayIntersect</code> twice and, if necessary, change the end point. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d7f/951/650/d7f9516500ea06dfecd97bfcb4a6ce32.png" width="745" height="346"></div><br>  This translates to the following code: <br><br><pre> <code class="hljs pgsql">//     <span class="hljs-type"><span class="hljs-type">float</span></span> tA; //     (worldPos + V * tA) <span class="hljs-type"><span class="hljs-type">float</span></span> tB; //     (worldPos + V * tB) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!rayIntersect(O, D, _PlanetCentre, _AtmosphereRadius, tA, tB)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fixed4(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); //       //      ? <span class="hljs-type"><span class="hljs-type">float</span></span> pA, pB; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rayIntersect(O, D, _PlanetCentre, _PlanetRadius, pA, pB)) tB = pA;</code> </pre> <br><h2>  Part 7. Atmospheric scatter shader. </h2><br>  In this part, we will finally complete the work on simulating Rayleigh scattering in the atmosphere of the planet. <br><br><div class="spoiler">  <b class="spoiler_title">Gif</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/16f/7a4/a92/16f7a4a924e404e808e6dd3782d3450c.gif"></div></div></div><br><h4>  Sampling ray visibility </h4><br>  Let's recall the atmospheric scattering equation we recently derived: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6517">I</span><span class="MJXp-mo" id="MJXp-Span-6518" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-6519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6520" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-6521" style="vertical-align: -0.4em;">S</span></span><span class="MJXp-mtext" id="MJXp-Span-6522">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6523">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6524">u</span><span class="MJXp-msubsup" id="MJXp-Span-6525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6526" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-6527" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6528">P</span><span class="MJXp-mtext" id="MJXp-Span-6529">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6530">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6531">n</span><span class="MJXp-mtext" id="MJXp-Span-6532">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6533">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6534">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6535">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6536">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6537">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6538">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6539">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6540">e</span><span class="MJXp-mrow" id="MJXp-Span-6541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6542">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6543">B</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-6544"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6545">S</span><span class="MJXp-mtext" id="MJXp-Span-6546">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6547">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6548">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6549">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6550">t</span><span class="MJXp-mo" id="MJXp-Span-6551" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6552">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6553">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6554">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6555">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6556">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6557">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6558">a</span><span class="MJXp-mo" id="MJXp-Span-6559" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-6560">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6561">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6562">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6563">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6564">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6565">a</span><span class="MJXp-mo" id="MJXp-Span-6566" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6567">h</span><span class="MJXp-mtext" id="MJXp-Span-6568">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6569">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6570">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6571">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6572">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6573">t</span><span class="MJXp-mo" id="MJXp-Span-6574" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6575">T</span><span class="MJXp-mtext" id="MJXp-Span-6576">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6577">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6578">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6579">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6580">t</span><span class="MJXp-mo" id="MJXp-Span-6581" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6582">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6583">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6584">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6585">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6586">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6587">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6588">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6589">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6590">e</span><span class="MJXp-mrow" id="MJXp-Span-6591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6592">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6593">P</span></span><span class="MJXp-mtext" id="MJXp-Span-6594">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6595">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6596">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6597">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6598">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6599">t</span><span class="MJXp-mo" id="MJXp-Span-6600" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6601">T</span><span class="MJXp-mtext" id="MJXp-Span-6602">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6603">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6604">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6605">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6606">t</span><span class="MJXp-mo" id="MJXp-Span-6607" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6609">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6610">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6611">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6612">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6613">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6614">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6615">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6616">e</span><span class="MJXp-mrow" id="MJXp-Span-6617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6618">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6619">A</span></span><span class="MJXp-mtext" id="MJXp-Span-6620">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6621">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6622">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6623">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6624">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6625">t</span><span class="MJXp-mo" id="MJXp-Span-6626" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6627">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6628">s</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-313-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-313"> I = I_S \ sum_ {P \ in \ overline {AB}} {S \ left (\ lambda, \ theta, h \ right) T \ left (\ overline {CP} \ right) T \ left (\ overline { PA} \ right) ds} </script></p><br>  The amount of light we receive is equal to the amount of light emitted by the sun, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6629"><span class="MJXp-msubsup" id="MJXp-Span-6630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6631" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-6632" style="vertical-align: -0.4em;">S</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-314-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-314"> I_S </script>  multiplied by the sum of the individual effects of each point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6634">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-315-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-315"> P </script>  on the segment <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6635"><span class="MJXp-mtext" id="MJXp-Span-6636">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6637">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6638">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6639">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6640">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6641">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6642">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6643">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6644">e</span><span class="MJXp-mrow" id="MJXp-Span-6645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6646">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6647">B</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-316-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-316"> \ overline {AB} </script>  . <br><br>  We can implement this function directly in the shader.  However, here you need to make some optimization.  In the previous part, I said that the expression can be simplified even more.  The first thing you can do is to break the scattering function into two main components: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6649">S</span><span class="MJXp-mtext" id="MJXp-Span-6650">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6651">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6652">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6653">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6654">t</span><span class="MJXp-mo" id="MJXp-Span-6655" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6656">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6657">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6658">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6659">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6660">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6661">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6662">a</span><span class="MJXp-mo" id="MJXp-Span-6663" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-6664">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6665">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6666">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6667">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6668">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6669">a</span><span class="MJXp-mo" id="MJXp-Span-6670" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6671">h</span><span class="MJXp-mtext" id="MJXp-Span-6672">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6673">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6674">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6675">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6676">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6677">t</span><span class="MJXp-mo" id="MJXp-Span-6678" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-6679" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6680">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6681">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6682">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6683">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6684">a</span><span class="MJXp-mtext" id="MJXp-Span-6685">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6686">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6687">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6688">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6689">t</span><span class="MJXp-mo" id="MJXp-Span-6690" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6691">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6692">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6693">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6694">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6695">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6696">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6697">a</span><span class="MJXp-mo" id="MJXp-Span-6698" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6699">h</span><span class="MJXp-mtext" id="MJXp-Span-6700">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6701">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6702">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6703">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6704">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6705">t</span><span class="MJXp-mo" id="MJXp-Span-6706" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-6707">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6708">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6709">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6710">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6711">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6712">a</span><span class="MJXp-mtext" id="MJXp-Span-6713">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6714">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6715">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6716">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6717">t</span><span class="MJXp-mo" id="MJXp-Span-6718" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6719">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6720">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6721">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6722">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6723">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6724">a</span><span class="MJXp-mtext" id="MJXp-Span-6725">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6726">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6727">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6728">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6729">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6730">t</span><span class="MJXp-mo" id="MJXp-Span-6731" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-6732" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-6733">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6734">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6735">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6736">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6737">a</span><span class="MJXp-mtext" id="MJXp-Span-6738">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6739">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6740">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6741">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6742">t</span><span class="MJXp-mo" id="MJXp-Span-6743" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6744">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6745">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6746">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6747">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6748">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6749">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6750">a</span><span class="MJXp-mtext" id="MJXp-Span-6751">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6752">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6753">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6754">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6755">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6756">t</span><span class="MJXp-mo" id="MJXp-Span-6757" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-6758">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6759">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6760">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6761">o</span><span class="MJXp-mtext" id="MJXp-Span-6762">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6763">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6764">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6765">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6766">t</span><span class="MJXp-mo" id="MJXp-Span-6767" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6768">h</span><span class="MJXp-mtext" id="MJXp-Span-6769">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6770">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6771">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6772">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6773">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6774">t</span><span class="MJXp-mo" id="MJXp-Span-6775" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-6776">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6777">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6778">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6779">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6780">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6781">a</span><span class="MJXp-mtext" id="MJXp-Span-6782">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6783">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6784">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6785">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6786">t</span><span class="MJXp-mo" id="MJXp-Span-6787" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6788">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6789">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6790">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6791">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6792">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6793">a</span><span class="MJXp-mtext" id="MJXp-Span-6794">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6795">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6796">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6797">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6798">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6799">t</span><span class="MJXp-mo" id="MJXp-Span-6800" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-317-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-317"> S \ left (\ lambda, \ theta, h \ right) = \ beta \ left (\ lambda, h \ right) \ gamma \ left (\ theta \ right) = \ beta \ left (\ lambda \ right) \ rho \ left (h \ right) \ gamma \ left (\ theta \ right) </script></p><br>  <strong>Phase function</strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6801"><span class="MJXp-mtext" id="MJXp-Span-6802">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6803">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6804">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6805">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6806">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6807">a</span><span class="MJXp-mtext" id="MJXp-Span-6808">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6809">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6810">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6811">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6812">t</span><span class="MJXp-mo" id="MJXp-Span-6813" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6814">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6815">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6816">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6817">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6818">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6819">a</span><span class="MJXp-mtext" id="MJXp-Span-6820">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6821">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6822">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6823">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6824">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6825">t</span><span class="MJXp-mo" id="MJXp-Span-6826" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-318-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-318"> \ gamma \ left (\ theta \ right) </script>  and <strong>dispersion coefficient at sea level</strong> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6827"><span class="MJXp-mtext" id="MJXp-Span-6828">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6829">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6830">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6831">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6832">a</span><span class="MJXp-mtext" id="MJXp-Span-6833">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6834">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6835">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6836">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6837">t</span><span class="MJXp-mo" id="MJXp-Span-6838" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6839">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6840">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6841">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6842">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6843">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6844">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6845">a</span><span class="MJXp-mtext" id="MJXp-Span-6846">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6847">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6848">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6849">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6850">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6851">t</span><span class="MJXp-mo" id="MJXp-Span-6852" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-319-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-319"> \ beta \ left (\ lambda \ right) </script>  are constants relative to the sum, because the angle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6853"><span class="MJXp-mtext" id="MJXp-Span-6854">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6855">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6856">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6857">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6858">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6859">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-320-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-320"> \ theta </script>  and wavelength <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6860"><span class="MJXp-mtext" id="MJXp-Span-6861">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6862">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6863">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6864">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6865">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6866">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6867">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-321-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-321"> \ lambda </script>  do not depend on the sampled point.  Therefore, they can be taken for the amount of: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-6868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6869">I</span><span class="MJXp-mo" id="MJXp-Span-6870" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-6871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6872" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-6873" style="vertical-align: -0.4em;">S</span></span><span class="MJXp-mspace" id="MJXp-Span-6874" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-6875">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6876">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6877">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6878">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6879">a</span><span class="MJXp-mtext" id="MJXp-Span-6880">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6881">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6882">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6883">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6884">t</span><span class="MJXp-mo" id="MJXp-Span-6885" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6886">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6887">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6888">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6889">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6890">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6891">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6892">a</span><span class="MJXp-mtext" id="MJXp-Span-6893">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6894">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6895">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6896">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6897">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6898">t</span><span class="MJXp-mo" id="MJXp-Span-6899" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-6900">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6901">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6902">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6903">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6904">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6905">a</span><span class="MJXp-mtext" id="MJXp-Span-6906">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6907">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6908">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6909">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6910">t</span><span class="MJXp-mo" id="MJXp-Span-6911" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6912">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6913">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6914">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6915">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6916">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6917">a</span><span class="MJXp-mtext" id="MJXp-Span-6918">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6919">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6920">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6921">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6922">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6923">t</span><span class="MJXp-mo" id="MJXp-Span-6924" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-6925">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6926">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6927">u</span><span class="MJXp-msubsup" id="MJXp-Span-6928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6929" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-6930" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6931">P</span><span class="MJXp-mtext" id="MJXp-Span-6932">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6933">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6934">n</span><span class="MJXp-mtext" id="MJXp-Span-6935">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6936">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6937">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6938">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6939">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6940">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6941">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6942">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6943">e</span><span class="MJXp-mrow" id="MJXp-Span-6944"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6945">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6946">B</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-6947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6948">T</span><span class="MJXp-mtext" id="MJXp-Span-6949">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6950">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6951">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6952">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6953">t</span><span class="MJXp-mo" id="MJXp-Span-6954" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6955">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6956">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6957">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6958">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6959">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6960">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6961">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6962">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6963">e</span><span class="MJXp-mrow" id="MJXp-Span-6964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6965">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6966">P</span></span><span class="MJXp-mtext" id="MJXp-Span-6967">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6968">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6969">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6970">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6971">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6972">t</span><span class="MJXp-mo" id="MJXp-Span-6973" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6974">T</span><span class="MJXp-mtext" id="MJXp-Span-6975">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6976">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6977">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6978">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6979">t</span><span class="MJXp-mo" id="MJXp-Span-6980" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6981">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6982">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6983">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6984">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6985">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6986">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6987">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6988">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6989">e</span><span class="MJXp-mrow" id="MJXp-Span-6990"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6991">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6992">A</span></span><span class="MJXp-mtext" id="MJXp-Span-6993">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6994">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6995">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6996">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6997">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6998">t</span><span class="MJXp-mo" id="MJXp-Span-6999" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-7000">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7001">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7002">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7003">o</span><span class="MJXp-mtext" id="MJXp-Span-7004">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7005">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7006">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7007">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7008">t</span><span class="MJXp-mo" id="MJXp-Span-7009" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7010">h</span><span class="MJXp-mtext" id="MJXp-Span-7011">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7012">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7013">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7014">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7015">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7016">t</span><span class="MJXp-mo" id="MJXp-Span-7017" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7018">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7019">s</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-322-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-322"> I = I_S \, \ beta \ left (\ lambda \ right) \ gamma \ left (\ theta \ right) \ sum_ {P \ in \ overline {AB}} {T \ left (\ overline {CP} \ right ) T \ left (\ overline {PA} \ right) \ rho \ left (h \ right) ds} </script></p><br>  This new expression is mathematically similar to the previous one, but more efficiently in the calculation, because the most "heavy" parts are derived from the sum. <br><br>  We are not yet ready for its implementation.  There is an infinite number of points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7021">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-323-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-323"> P </script>  which we must consider.  Reasonable approximation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7023">I</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-324-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-324"> I </script>  will be splitting <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7024"><span class="MJXp-mtext" id="MJXp-Span-7025">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7026">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7027">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7028">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7029">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7030">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7031">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7032">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7033">e</span><span class="MJXp-mrow" id="MJXp-Span-7034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7035">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7036">B</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-325-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-325"> \ overline {AB} </script>  shorter lengths <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7038">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7039">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-326-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-326"> ds </script>  and the addition of the influence of each individual segment.  By doing this, we can assume that each segment is small enough to have a constant density.  In general, this is not the case, but if <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7041">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7042">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-327-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-327"> ds </script>  is small enough, then we can achieve a fairly good approximation. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c1/b69/128/8c1b691280174ac7b16a70dd90510304.png" width="705" height="257"></div><br>  The number of segments in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7043"><span class="MJXp-mtext" id="MJXp-Span-7044">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7045">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7046">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7047">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7048">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7049">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7050">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7051">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7052">e</span><span class="MJXp-mrow" id="MJXp-Span-7053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7054">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7055">B</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-328-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-328"> \ overline {AB} </script>  we will call the <strong>visibility samples</strong> , because all the segments are on the line of sight.  In the shader this will be the <code>_ViewSamples</code> property.  Since this is a property, we will be able to access it from the material inspector.  This allows us to reduce the accuracy of the shader for its performance. <br><br>  The following code snippet allows you to loop around all segments in the atmosphere. <br><br><pre> <code class="hljs pgsql">//     //      P  AB float3 totalViewSamples = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-type"><span class="hljs-type">float</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span> = tA; <span class="hljs-type"><span class="hljs-type">float</span></span> ds = (tB-tA) / (<span class="hljs-type"><span class="hljs-type">float</span></span>)(_ViewSamples); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; _ViewSamples; i ++) { //   // (     ) float3 P = O + D * (<span class="hljs-type"><span class="hljs-type">time</span></span> + ds * <span class="hljs-number"><span class="hljs-number">0.5</span></span>); // T(CP) * T(PA) * œÅ(h) * ds totalViewSamples += viewSampling(P, ds); <span class="hljs-type"><span class="hljs-type">time</span></span> += ds; } // I = I_S * Œ≤(Œª) * Œ≥(Œ∏) * totalViewSamples float3 I = _SunIntensity * _ScatteringCoefficient * phase * totalViewSamples;</code> </pre> <br>  The <code>time</code> variable is used to track how far we are from the starting point. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7057">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-329-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-329"> O </script>  .  After each iteration, it is incremented by <code>ds</code> . <br><br><h4>  Optical thickness PA </h4><br>  Each point on the line of sight <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7058"><span class="MJXp-mtext" id="MJXp-Span-7059">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7060">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7061">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7062">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7063">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7064">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7065">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7066">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7067">e</span><span class="MJXp-mrow" id="MJXp-Span-7068"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7069">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7070">B</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-330-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-330"> \ overline {AB} </script>  contributes to the final color of the pixel we draw.  This contribution, to put it mathematically, is the value within the sum: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-7071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7072">I</span><span class="MJXp-mo" id="MJXp-Span-7073" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-7074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7075" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-7076" style="vertical-align: -0.4em;">S</span></span><span class="MJXp-mspace" id="MJXp-Span-7077" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-7078">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7079">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7080">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7081">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7082">a</span><span class="MJXp-mtext" id="MJXp-Span-7083">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7084">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7085">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7086">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7087">t</span><span class="MJXp-mo" id="MJXp-Span-7088" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-7089">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7090">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7091">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7092">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7093">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7094">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7095">a</span><span class="MJXp-mtext" id="MJXp-Span-7096">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7097">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7098">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7099">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7100">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7101">t</span><span class="MJXp-mo" id="MJXp-Span-7102" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-7103">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7104">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7105">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7106">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7107">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7108">a</span><span class="MJXp-mtext" id="MJXp-Span-7109">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7110">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7111">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7112">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7113">t</span><span class="MJXp-mo" id="MJXp-Span-7114" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-7115">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7116">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7117">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7118">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7119">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7120">a</span><span class="MJXp-mtext" id="MJXp-Span-7121">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7122">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7123">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7124">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7125">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7126">t</span><span class="MJXp-mo" id="MJXp-Span-7127" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-7128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7129">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7130">u</span><span class="MJXp-msubsup" id="MJXp-Span-7131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7132" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-7133" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7134">P</span><span class="MJXp-mtext" id="MJXp-Span-7135">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7136">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7137">n</span><span class="MJXp-mtext" id="MJXp-Span-7138">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7139">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7140">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7141">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7142">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7143">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7144">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7145">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7146">e</span><span class="MJXp-mrow" id="MJXp-Span-7147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7148">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7149">B</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-7150">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7151">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7152">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7153">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7154">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7155">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7156">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7157">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7158">t</span><span class="MJXp-mrow" id="MJXp-Span-7159"><span class="MJXp-mtext" id="MJXp-Span-7160">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7161">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7162">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7163">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7164">t</span><span class="MJXp-mrow" id="MJXp-Span-7165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7166">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7167">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7168">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7169">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7170">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7171">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7172">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7173">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7174">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7175">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7176">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7177">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7178">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7179">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7180">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7181">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7182">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7183">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7184">f</span></span><span class="MJXp-mspace" id="MJXp-Span-7185" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7186">L</span><span class="MJXp-mtext" id="MJXp-Span-7187">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7188">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7189">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7190">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7191">t</span><span class="MJXp-mo" id="MJXp-Span-7192" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7193">P</span><span class="MJXp-mtext" id="MJXp-Span-7194">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7195">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7196">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7197">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7198">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7199">t</span><span class="MJXp-mo" id="MJXp-Span-7200" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-7201"><span class="MJXp-mtext" id="MJXp-Span-7202">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7203">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7204">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7205">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7206">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7207">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7208">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7209">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7210">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7211">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7212">e</span><span class="MJXp-mrow" id="MJXp-Span-7213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7214">T</span><span class="MJXp-mtext" id="MJXp-Span-7215">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7216">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7217">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7218">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7219">t</span><span class="MJXp-mo" id="MJXp-Span-7220" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-7221">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7222">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7223">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7224">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7225">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7226">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7227">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7228">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7229">e</span><span class="MJXp-mrow" id="MJXp-Span-7230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7231">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7232">P</span></span><span class="MJXp-mtext" id="MJXp-Span-7233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7234">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7235">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7236">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7237">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7238">t</span><span class="MJXp-mo" id="MJXp-Span-7239" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7240">T</span><span class="MJXp-mtext" id="MJXp-Span-7241">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7242">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7243">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7244">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7245">t</span><span class="MJXp-mo" id="MJXp-Span-7246" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-7247">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7248">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7249">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7250">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7251">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7252">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7253">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7254">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7255">e</span><span class="MJXp-mrow" id="MJXp-Span-7256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7257">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7258">A</span></span><span class="MJXp-mtext" id="MJXp-Span-7259">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7260">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7261">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7262">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7263">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7264">t</span><span class="MJXp-mo" id="MJXp-Span-7265" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-7266">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7267">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7268">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7269">o</span><span class="MJXp-mtext" id="MJXp-Span-7270">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7271">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7272">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7273">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7274">t</span><span class="MJXp-mo" id="MJXp-Span-7275" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7276">h</span><span class="MJXp-mtext" id="MJXp-Span-7277">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7278">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7279">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7280">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7281">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7282">t</span><span class="MJXp-mo" id="MJXp-Span-7283" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7284">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7285">s</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-331-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-331"> I = I_S \, \ beta \ left (\ lambda \ right) \ gamma \ left (\ theta \ right) \ sum_ {P \ in \ overline {AB}} \ underset {\ text {light contribution of} \, L \ left (P \ right)} {\ underbrace {T \ left (\ overline {CP} \ right) T \ left (\ overline {PA} \ right) \ rho \ left (h \ right) ds}} </script></p><br>  Let's try to simplify this expression, as in the last paragraph.  We can further expand the expression above by replacing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7287">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-332-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-332"> T </script>  by its definition: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-7288"><span class="noError" id="MJXp-Span-7289" style="display: inline-block;">T&nbsp;\&nbsp;left&nbsp;(\&nbsp;overline&nbsp;{XY}&nbsp;\&nbsp;right)&nbsp;=&nbsp;\&nbsp;exp&nbsp;\&nbsp;left&nbsp;\&nbsp;{-&nbsp;\&nbsp;beta&nbsp;\&nbsp;left&nbsp;(\&nbsp;lambda&nbsp;\&nbsp;right)&nbsp;D&nbsp;\&nbsp;left&nbsp;(\&nbsp;overline&nbsp;{XY}&nbsp;\&nbsp;right)&nbsp;\&nbsp;right&nbsp;\}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-333-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-333"> T \ left (\ overline {XY} \ right) = \ exp \ left \ {- \ beta \ left (\ lambda \ right) D \ left (\ overline {XY} \ right) \ right \} </script></p><br>  The result of passing through <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7290"><span class="MJXp-mtext" id="MJXp-Span-7291">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7292">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7293">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7294">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7295">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7296">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7297">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7298">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7299">e</span><span class="MJXp-mrow" id="MJXp-Span-7300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7301">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7302">P</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-334-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-334"> \ overline {CP} </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7303"><span class="MJXp-mtext" id="MJXp-Span-7304">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7305">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7306">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7307">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7308">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7309">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7310">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7311">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7312">e</span><span class="MJXp-mrow" id="MJXp-Span-7313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7314">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7315">a</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-335-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-335"> \ overline {pa} </script>  turns into: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-7316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7317">T</span><span class="MJXp-mtext" id="MJXp-Span-7318">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7319">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7320">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7321">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7322">t</span><span class="MJXp-mo" id="MJXp-Span-7323" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-7324">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7325">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7326">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7327">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7328">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7329">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7330">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7331">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7332">e</span><span class="MJXp-mrow" id="MJXp-Span-7333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7334">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7335">P</span></span><span class="MJXp-mtext" id="MJXp-Span-7336">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7337">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7338">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7339">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7340">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7341">t</span><span class="MJXp-mo" id="MJXp-Span-7342" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7343">T</span><span class="MJXp-mtext" id="MJXp-Span-7344">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7345">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7346">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7347">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7348">t</span><span class="MJXp-mo" id="MJXp-Span-7349" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-7350">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7351">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7352">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7353">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7354">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7355">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7356">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7357">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7358">e</span><span class="MJXp-mrow" id="MJXp-Span-7359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7360">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7361">A</span></span><span class="MJXp-mtext" id="MJXp-Span-7362">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7363">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7364">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7365">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7366">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7367">t</span><span class="MJXp-mo" id="MJXp-Span-7368" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-7369" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-336-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-336"> T \ left (\ overline {CP} \ right) T \ left (\ overline {PA} \ right) = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-7370"><span class="noError" id="MJXp-Span-7371" style="display: inline-block;">=&nbsp;\&nbsp;underset&nbsp;{T&nbsp;\&nbsp;left&nbsp;(\&nbsp;overline&nbsp;{CP}&nbsp;\&nbsp;right)}&nbsp;{\&nbsp;underbrace&nbsp;{\&nbsp;exp&nbsp;\&nbsp;left&nbsp;\&nbsp;{-&nbsp;\&nbsp;beta&nbsp;\&nbsp;left&nbsp;(\&nbsp;lambda&nbsp;\&nbsp;right)&nbsp;D&nbsp;\&nbsp;left&nbsp;(\&nbsp;overline&nbsp;{CP}&nbsp;\&nbsp;right&nbsp;)&nbsp;\&nbsp;right&nbsp;\}}}&nbsp;\,&nbsp;\&nbsp;underset&nbsp;{T&nbsp;\&nbsp;left&nbsp;(\&nbsp;overline&nbsp;{PA}&nbsp;\&nbsp;right)}&nbsp;{\&nbsp;underbrace&nbsp;{\&nbsp;exp&nbsp;\&nbsp;left&nbsp;\&nbsp;{-&nbsp;\&nbsp;beta&nbsp;\&nbsp;left&nbsp;(\&nbsp;lambda&nbsp;\&nbsp;right)&nbsp;D&nbsp;\&nbsp;left&nbsp;(&nbsp;\&nbsp;overline&nbsp;{PA}&nbsp;\&nbsp;right)&nbsp;\&nbsp;right&nbsp;\}}}&nbsp;=</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-337-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-337"> = \ underset {T \ left (\ overline {CP} \ right)} {\ underbrace {\ exp \ left \ {- \ beta \ left (\ lambda \ right) D \ left (\ overline {CP} \ right ) \ right \}}} \, \ underset {T \ left (\ overline {PA} \ right)} {\ underbrace {\ exp \ left \ {- \ beta \ left (\ lambda \ right) D \ left ( \ overline {PA} \ right) \ right \}}} = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-7372"><span class="noError" id="MJXp-Span-7373" style="display: inline-block;">=&nbsp;\&nbsp;exp&nbsp;\&nbsp;left&nbsp;\&nbsp;{-&nbsp;\&nbsp;beta&nbsp;\&nbsp;left&nbsp;(\&nbsp;lambda&nbsp;\&nbsp;right)&nbsp;\&nbsp;left&nbsp;(D&nbsp;\&nbsp;left&nbsp;(\&nbsp;overline&nbsp;{CP}&nbsp;\&nbsp;right)&nbsp;+&nbsp;D&nbsp;\&nbsp;left&nbsp;(\&nbsp;overline&nbsp;{PA}&nbsp;\&nbsp;right)&nbsp;\&nbsp;right)&nbsp;\&nbsp;right&nbsp;\}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-338-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-338"> = \ exp \ left \ {- \ beta \ left (\ lambda \ right) \ left (D \ left (\ overline {CP} \ right) + D \ left (\ overline {PA} \ right) \ right) \ right \} </script></p><br>  <strong>The combined transmittance is</strong> modeled as an exponential reduction, whose coefficient is the sum of the <strong>optical thickness</strong> along the path traveled by the light ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7374"><span class="MJXp-mtext" id="MJXp-Span-7375">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7376">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7377">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7378">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7379">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7380">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7381">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7382">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7383">e</span><span class="MJXp-mrow" id="MJXp-Span-7384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7385">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7386">P</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-339-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-339"> \ overline {CP} </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7387"><span class="MJXp-mtext" id="MJXp-Span-7388">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7389">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7390">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7391">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7392">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7393">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7394">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7395">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7396">e</span><span class="MJXp-mrow" id="MJXp-Span-7397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7398">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7399">a</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-340-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-340"> \ overline {pa} </script>  ) multiplied by <em>the scattering coefficient at sea level</em> ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7400"><span class="MJXp-mtext" id="MJXp-Span-7401">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7402">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7403">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7404">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7405">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-341-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-341"> \ beta </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7407">h</span><span class="MJXp-mo" id="MJXp-Span-7408" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-7409">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-342-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-342"> h = 0 </script>  ). <br>  The first quantity we begin to calculate is the optical thickness of the segment. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7410"><span class="MJXp-mtext" id="MJXp-Span-7411">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7412">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7413">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7414">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7415">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7416">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7417">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7418">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7419">e</span><span class="MJXp-mrow" id="MJXp-Span-7420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7421">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7422">a</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-343-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-343"> \ overline {pa} </script>  which goes from the point of entry into the atmosphere to the point at which we are currently sampling in the for loop.  Let's remember the definition of optical thickness: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-7423"><span class="noError" id="MJXp-Span-7424" style="display: inline-block;">D&nbsp;\&nbsp;left&nbsp;(\&nbsp;overline&nbsp;{PA}&nbsp;\&nbsp;right)&nbsp;=&nbsp;\&nbsp;sum_&nbsp;{Q&nbsp;\&nbsp;in&nbsp;\&nbsp;overline&nbsp;{PA}}&nbsp;{\&nbsp;exp&nbsp;\&nbsp;left&nbsp;\&nbsp;{-&nbsp;\&nbsp;frac&nbsp;{h_Q}&nbsp;{H}&nbsp;\&nbsp;right&nbsp;\}}&nbsp;\,&nbsp;ds</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-344-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-344"> D \ left (\ overline {PA} \ right) = \ sum_ {Q \ in \ overline {PA}} {\ exp \ left \ {- \ frac {h_Q} {H} \ right \}} \, ds </script></p><br>  If we had to implement it "in the forehead", then we would create an <code>opticalDepth</code> function, which samples the loop between <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7426">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-345-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-345"> P </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7428">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-346-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-346"> A </script>  .  This is possible, but very inefficient.  In fact, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7430">D</span><span class="MJXp-mtext" id="MJXp-Span-7431">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7432">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7433">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7434">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7435">t</span><span class="MJXp-mo" id="MJXp-Span-7436" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-7437">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7438">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7439">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7440">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7441">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7442">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7443">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7444">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7445">e</span><span class="MJXp-mrow" id="MJXp-Span-7446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7447">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7448">A</span></span><span class="MJXp-mtext" id="MJXp-Span-7449">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7450">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7451">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7452">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7453">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7454">t</span><span class="MJXp-mo" id="MJXp-Span-7455" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-347-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-347"> D \ left (\ overline {PA} \ right) </script>  - This is the optical thickness of the segment, which we are already analyzing in the outermost for loop.  We can save a lot of calculations if we calculate the optical thickness of the current segment, centered at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7457">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-348-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-348"> P </script>  ( <code>opticalDepthSegment</code> ), and continue to summarize it in a for loop ( <code>opticalDepthPA</code> ). <br><br><pre> <code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">/    float opticalDepthPA = 0; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/     /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/     P  AB float time = tA; float ds = (tB-tA) /</span></span> (float)(_ViewSamples); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; _ViewSamples; i ++) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   /<span class="hljs-regexp"><span class="hljs-regexp">/ (    ) float3 P = O + D * (time + viewSampleSize*0.5); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/     /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ œÅ(h) * ds float height = distance(C, P) - _PlanetRadius; float opticalDepthSegment = exp(-height /</span></span> _ScaleHeight) * ds; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    /<span class="hljs-regexp"><span class="hljs-regexp">/ D(PA) opticalDepthPA += opticalDepthSegment; ... time += ds; }</span></span></code> </pre> <br><h4>  Light sampling </h4><br>  If we return to the expression for the influence of light <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7459">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-349-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-349"> P </script>  , the only required quantity is the optical thickness of the segment. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7460"><span class="MJXp-mtext" id="MJXp-Span-7461">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7462">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7463">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7464">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7465">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7466">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7467">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7468">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7469">e</span><span class="MJXp-mrow" id="MJXp-Span-7470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7471">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7472">P</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-350-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-350"> \ overline {CP} </script>  , <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-7473"><span class="noError" id="MJXp-Span-7474" style="display: inline-block;">L&nbsp;\&nbsp;left&nbsp;(P&nbsp;\&nbsp;right)&nbsp;=&nbsp;\&nbsp;underset&nbsp;{\&nbsp;text&nbsp;{combined&nbsp;transmittance}}&nbsp;{\&nbsp;underbrace&nbsp;{\&nbsp;exp&nbsp;\&nbsp;left&nbsp;\&nbsp;{-&nbsp;\&nbsp;beta&nbsp;\&nbsp;left&nbsp;(\&nbsp;lambda&nbsp;\&nbsp;right)&nbsp;\&nbsp;left&nbsp;(D&nbsp;\&nbsp;left&nbsp;(\&nbsp;overline&nbsp;{CP}&nbsp;\&nbsp;right)&nbsp;+&nbsp;D&nbsp;\&nbsp;left&nbsp;(\&nbsp;overline&nbsp;{PA}&nbsp;\&nbsp;right)&nbsp;\&nbsp;right)&nbsp;\&nbsp;right&nbsp;\}}}&nbsp;\,&nbsp;\&nbsp;underset&nbsp;{\&nbsp;text&nbsp;{optical&nbsp;depth&nbsp;of}&nbsp;\,&nbsp;ds}&nbsp;{\&nbsp;underbrace&nbsp;{\&nbsp;rho&nbsp;\&nbsp;left&nbsp;(h&nbsp;\&nbsp;right)&nbsp;ds}}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-351-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-351"> L \ left (P \ right) = \ underset {\ text {combined transmittance}} {\ underbrace {\ exp \ left \ {- \ beta \ left (\ lambda \ right) \ left (D \ left (\ overline {CP} \ right) + D \ left (\ overline {PA} \ right) \ right) \ right \}}} \, \ underset {\ text {optical depth of} \, ds} {\ underbrace {\ rho \ left (h \ right) ds}} </script></p><br>  We will move the code that calculates the optical thickness of the segment <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7475"><span class="MJXp-mtext" id="MJXp-Span-7476">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7477">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7478">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7479">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7480">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7481">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7482">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7483">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7484">e</span><span class="MJXp-mrow" id="MJXp-Span-7485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7486">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7487">P</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-352-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-352"> \ overline {CP} </script>  into a function called <code>lightSampling</code> .  The name is taken from a <strong>ray of light</strong> that is a segment starting at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7489">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-353-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-353"> P </script>  and directed towards the sun.  We called the point at which it comes out of the atmosphere <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7491">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-354-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-354"> C </script>  . <br><br>  However, the <code>lightSampling</code> function <code>lightSampling</code> not simply calculate the optical thickness. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7492"><span class="MJXp-mtext" id="MJXp-Span-7493">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7494">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7495">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7496">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7497">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7498">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7499">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7500">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7501">e</span><span class="MJXp-mrow" id="MJXp-Span-7502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7503">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7504">P</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-355-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-355"> \ overline {CP} </script>  .  So far we have considered only the influence of the atmosphere and ignored the role of the planet itself.  Our equations do not take into account the possibility that a ray of light moving from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7506">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-356-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-356"> P </script>  to the sun, may collide with the planet.  If this happens, then all calculations performed up to this point are not applicable, because the light does not actually reach the camera. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f57/129/d20/f57129d20624d4df4583a22d635554a6.png" width="711" height="258"></div><br>  In the diagram below it is easy to see that the effect of light <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7507"><span class="MJXp-msubsup" id="MJXp-Span-7508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7509" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-7510" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-357-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-357"> P_0 </script>  need to be ignored because no sun light reaches <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7511"><span class="MJXp-msubsup" id="MJXp-Span-7512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7513" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-7514" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-358-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-358"> P_0 </script>  .  When cyclically moving points between <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7516">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-359-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-359"> P </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7518">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-360-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-360"> C </script>  The <code>lightSampling</code> function also checks if there has been a collision with a planet.  This can be done by checking the height of the point for negativity. <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">bool</span></span> lightSampling ( float3 P, //      float3 S, //    <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-type"><span class="hljs-type">float</span></span> opticalDepthCA ) { <span class="hljs-type"><span class="hljs-type">float</span></span> _; //     <span class="hljs-type"><span class="hljs-type">float</span></span> C; rayInstersect(P, S, _PlanetCentre, _AtmosphereRadius, _, C); //    PC <span class="hljs-type"><span class="hljs-type">float</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-type"><span class="hljs-type">float</span></span> ds = distance(P, P + S * C) / (<span class="hljs-type"><span class="hljs-type">float</span></span>)(_LightSamples); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; _LightSamples; i ++) { float3 Q = P + S * (<span class="hljs-type"><span class="hljs-type">time</span></span> + lightSampleSize*<span class="hljs-number"><span class="hljs-number">0.5</span></span>); <span class="hljs-type"><span class="hljs-type">float</span></span> height = distance(_PlanetCentre, Q) - _PlanetRadius; //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (height &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; //      opticalDepthCA += exp(-height / _RayScaleHeight) * ds; <span class="hljs-type"><span class="hljs-type">time</span></span> += ds; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The above function first computes a point. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7520">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-361-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-361"> C </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with the help of </font></font><code>rayInstersect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Then she divides the segment</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7521"><span class="MJXp-munderover" id="MJXp-Span-7522"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-7525" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7523">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7524">A</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-362-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-362">\overline{PA}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">into segments </font></font><code>_LightSamples</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of length </font></font><code>ds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The calculation of the optical thickness is the same as that used in the outermost loop. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The function returns false if a collision with a planet has occurred. </font><font style="vertical-align: inherit;">We can use this to update the missing code of the outermost loop, replacing </font></font><code>...</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="hljs pgsql"> // D(CP) <span class="hljs-type"><span class="hljs-type">float</span></span> opticalDepthCP = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-type"><span class="hljs-type">bool</span></span> overground = lightSampling(P, S); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (overground) { //   // T(CP) * T(PA) = T(CPA) = exp{ -Œ≤(Œª) [D(CP) + D(PA)]} <span class="hljs-type"><span class="hljs-type">float</span></span> transmittance = exp ( -_ScatteringCoefficient * (opticalDepthCP + opticalDepthPA) ); //   // T(CPA) * œÅ(h) * ds totalViewSamples += transmittance * opticalDepthSegment; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now that we have considered all the elements, our shader is ready. </font></font><br><br>  <i>[Approx.</i> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trans .: on the Patreon author's page you can buy access to the </font></font><a href="https://www.patreon.com/posts/14807027"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standard</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://www.patreon.com/posts/14806526"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Premium</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> versions of the finished shader.]</font></font></i> </div><p>Source: <a href="https://habr.com/ru/post/345630/">https://habr.com/ru/post/345630/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345620/index.html">"On the mistakes of others": what you need to know for the successful implementation of the Service Desk</a></li>
<li><a href="../345622/index.html">ServiceNow Kingston Update: Machine Learning Functions and Now Platform Upgrades</a></li>
<li><a href="../345624/index.html">Identity Management: a new tool in ServiceNow for managing credentials</a></li>
<li><a href="../345626/index.html">Clydesdale and Yorkshire Banks to Implement ServiceNow to Manage IT Infrastructure</a></li>
<li><a href="../345628/index.html">What ITOM can do and why it is needed</a></li>
<li><a href="../345632/index.html">Dell EMC Technologies for Data Protection</a></li>
<li><a href="../345634/index.html">Developing mobile games - the thorny path of the Padawan</a></li>
<li><a href="../345636/index.html">How people's habit of posting photos from concerts has changed the life of mobile operators</a></li>
<li><a href="../345638/index.html">Testing the synthesizability of the beautiful features of SystemVerilog in practice</a></li>
<li><a href="../345640/index.html">Christmas magic and gifts (version 2018)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>