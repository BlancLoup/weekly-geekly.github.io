<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Android programming tips and tricks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the summer, a friend threw a couple of orders for development for Android. The first is a streaming video player for one French television, the sec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Android programming tips and tricks</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/307/56e/dfe/30756edfe21f9ee199835cbb7e26dea2.jpg" alt="Tips and tricks" align="left"><br>  In the summer, a friend threw a couple of orders for development for Android.  The first is a streaming video player for one French television, the second is a simple toy. <br>  During development (my first development experience on Android and Java), I understood a few rules that need to be followed for the correct and stable operation of the programs I want to share ... <br><a name="habracut"></a><br>  Perhaps for professionals the article will not be interesting, but for beginners who first encountered the development of mobile devices, the information will be useful. <br><br><h4>  Examples </h4><br>  For clarity, I created a small project in which a few examples of the rules are given below. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/d47/634/e3f/d47634e3f41fdeb4f7a77bc5a0d71517.png" alt="Main Activity"><br>  Sources: <a href="http://fileshare.in.ua/3050399">fileshare.in.ua/3050399</a> <br>  APK: <a href="http://fileshare.in.ua/3050402">fileshare.in.ua/3050402</a> <br><br><h4>  Rule 1. Do not perform complex operations in the UI stream. </h4><br><img src="http://img683.imageshack.us/img683/2298/notresponding.png" alt="Not responding" align="left"><br>  Performing any complicated operation in the UI thread will cause the UI to be inaccessible to the user (i.e., it will ‚Äúhang‚Äù).  At the same time, any actions of the user, during such ‚Äúhang-ups‚Äù, may lead to the appearance of a message stating that the application has hung, with a proposal to close it. <br>  Therefore, all complex calculations should be made in a separate thread. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>For example:</b> <br>  See how you do not need to do, and what it can lead to by clicking the "Do all on UI thread" button.  At the moment of clicking, a child Activity is created, which has a pseudo-complex operation in the onCreate () method, which takes 20 seconds.  After pressing, when you try to press the phone‚Äôs Back button, a message pops up saying that the application is ‚Äúfrozen‚Äù. <br>  When you click the ‚ÄúDo hard operation with separate thread‚Äù button of the main window, an Activity will be created and a thread will be created to perform a complex operation. <br><br><h4>  Rule 2. Use adapters correctly </h4><br><img src="https://habrastorage.org/getpro/geektimes/post_images/bdd/a8d/dfa/bdda8ddfa9b8c269667f101a4a3b18a4.png" alt="Listview" align="right"><br>  When working with non-standard lists, the creation of strings occurs by means of a hidden call to the getView () method of the adapter set for this list. <br>  In the getView () adapter, the developer is given the opportunity to create a string of any kind.  For example: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/c43/60b/81e/c4360b81e82bf7667dfa46324f9d321a.jpg" alt="image"><br><br>  <b>Example:</b> <br>  <i>How not to do:</i> <blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">@Override <br> <font color="#0000ff">public</font> View getView( <font color="#0000ff">int</font> position, View convertView, ViewGroup parent) { <br> final View view = mInflater.inflate(R.layout.row, <font color="#0000ff">null</font> ); <br> <br> TextView tv_programm = (TextView) view.findViewById(R.id.channel_proramm); <br> TextView tv_starttime = (TextView) view.findViewById(R.id.time_start); <br> TextView tv_endtime = (TextView) view.findViewById(R.id.time_end); <br> ImageView ib_logo = (ImageView) view.findViewById(R.id.channel_logo); <br> ProgressBar pb_progress = (ProgressBar) view.findViewById(R.id.programm_progress); <br> <br> tv_programm.setFocusable( <font color="#0000ff">false</font> ); <br> tv_starttime.setFocusable( <font color="#0000ff">false</font> ); <br> tv_endtime.setFocusable( <font color="#0000ff">false</font> ); <br> ib_logo.setFocusable( <font color="#0000ff">false</font> ); <br> pb_progress.setFocusable( <font color="#0000ff">false</font> ); <br> <br> ib_logo.setClickable( <font color="#0000ff">false</font> ); <br> <br> final <font color="#2B91AF">String</font> name = mNames[position]; <br> <font color="#0000ff">if</font> ( name != <font color="#0000ff">null</font> ) { <br> tv_programm.setText(name); <br> } <br> <font color="#0000ff">return</font> view; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Here, for each row in the list, a new View object is created.  As a result, when scrolling through the list, we will get memory clogged with objects that are not displayed.  And therefore the Garbage Collector will be called more often (see rule 3). <br><br>  <i>How to do it:</i> <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> ViewHolder { <br> TextView tv_programm; <br> TextView tv_starttime; <br> TextView tv_endtime; <br> ImageView ib_logo; <br> ProgressBar pb_progress; <br> } <br> <br> @Override <br> <font color="#0000ff">public</font> View getView( <font color="#0000ff">int</font> position, View convertView, ViewGroup parent) { <br> ViewHolder holder = <font color="#0000ff">null</font> ; <br> <font color="#0000ff">if</font> ( convertView == <font color="#0000ff">null</font> ) { <br> convertView = mInflater.inflate(R.layout.row, <font color="#0000ff">null</font> ); <br> <br> holder = <font color="#0000ff">new</font> ViewHolder(); <br> holder.tv_programm = (TextView) convertView.findViewById(R.id.channel_proramm); <br> holder.tv_starttime = (TextView) convertView.findViewById(R.id.time_start); <br> holder.tv_endtime = (TextView) convertView.findViewById(R.id.time_end); <br> holder.ib_logo = (ImageView) convertView.findViewById(R.id.channel_logo); <br> holder.pb_progress = (ProgressBar) convertView.findViewById(R.id.programm_progress); <br> <br> holder.tv_programm.setFocusable( <font color="#0000ff">false</font> ); <br> holder.tv_starttime.setFocusable( <font color="#0000ff">false</font> ); <br> holder.tv_endtime.setFocusable( <font color="#0000ff">false</font> ); <br> holder.ib_logo.setFocusable( <font color="#0000ff">false</font> ); <br> holder.pb_progress.setFocusable( <font color="#0000ff">false</font> ); <br> <br> holder.ib_logo.setClickable( <font color="#0000ff">false</font> ); <br> <br> convertView.setTag(holder); <br> } <font color="#0000ff">else</font> { <br> holder = (ViewHolder) convertView.getTag(); <br> } <br> <br> final <font color="#2B91AF">String</font> name = mNames[position]; <br> <font color="#0000ff">if</font> ( name != <font color="#0000ff">null</font> ) { <br> holder.tv_programm.setText(name); <br> } <br> <font color="#0000ff">return</font> convertView; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  In this example, only the number of objects that will fit on the screen will be created.  And for drawing new lines of the list, objects that are not currently displayed will be used.  That is, the objects will be reused, without creating new ones. <br><br>  <b>What is the gain?</b> <br>  In the example for rule 2 (the ‚ÄúUse incorrect list adapter‚Äù and ‚ÄúUse correct list adapter‚Äù buttons), a list of 1000 lines is created. <br>  When launched, the application uses 3% of the total device memory. <br>  When scrolling through the list with incorrect use of the adapter, you need an additional 14% of the device's memory to scroll through the list to the last item.  At the same time drawing is jerky. <br>  If the adapter is used correctly, it is additionally used &lt;= 1% and flipping passes smoothly. <br><br><h4>  Rule 3. Less memory allocation (Java and Garbage Collector) </h4><br>  This rule is probably familiar to every Java developer.  But since I previously programmed in C ++, the Garbage Collector (aka GC) was new to me. <br>  The more often objects are created and deleted, the more often GC is called.  And each GC call takes 100-200ms.  In this case, all threads for the duration of the GC stop.  In this case, frame drawing may be noticeable (sometimes &lt;10 fps). <br><br><h4>  Conclusion: </h4><br>  This is only a small part of what I managed to learn while working with Android, and if someone is interested in the topic, I will write the next batch of tips and tricks. <br><br><h4>  Useful links: </h4><br>  <a href="http://android-developers.blogspot.com/">android-developers.blogspot.com</a> - Android developer blog <br>  <a href="http://developer.android.com/videos/index.html">developer.android.com/videos/index.html</a> - Android Development Video <br>  I especially advise you to look at: <br>  Google I / O 2009 - Make your Android UI Fast and Efficient.  - Rule 2 is taken from here. <br>  Google I / O 2009 - Writing Real-Time Games for Android.  - Rule 3. <br><br>  <b>UPD:</b> thanks for the karma, transferred to Android <br>  <b>UPD2:</b> thanks to i- <a href="https://geektimes.ru/users/i_home/" class="user_link">home</a> for another useful link <a href="http://small-coding.blogspot.com/">small-coding.blogspot.com</a> in the <a href="http://habrahabr.ru/blogs/android/78570/">comments</a> </div><p>Source: <a href="https://habr.com/ru/post/78570/">https://habr.com/ru/post/78570/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../78556/index.html">Trendoscope 2010: a laptop almost for nothing</a></li>
<li><a href="../78560/index.html">Sign up for the iPhone Developer Program. Version of December 17, 2009 (current)</a></li>
<li><a href="../78565/index.html">Niche social projects or thematic groups in large social networks</a></li>
<li><a href="../78566/index.html">Trigram index or "Search with typos"</a></li>
<li><a href="../78568/index.html">Quintura introduced the search module for sites on Bitrix</a></li>
<li><a href="../78571/index.html">Interesting acquisition in the BPM market</a></li>
<li><a href="../78574/index.html">Interesting job</a></li>
<li><a href="../78575/index.html">25 forecasts of the main futurologist Cisco</a></li>
<li><a href="../78576/index.html">Why do Russian companies lag behind the Western ones?</a></li>
<li><a href="../78577/index.html">New Facebook office</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>