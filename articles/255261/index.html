<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hardware "watchdog" or an indispensable tool in the fight against hang</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In one company there were many terminals, and one of the ungrateful tasks for technical support is to travel to points and restart the operating syste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hardware "watchdog" or an indispensable tool in the fight against hang</h1><div class="post__text post__text-html js-mediator-article">  In one company there were many terminals, and one of the ungrateful tasks for technical support is to travel to points and restart the operating system inside the terminals.  It was decided to challenge this problem in the form of developing a hardware watchdog timer. <br><br>  As a result, we got a device that connects to the expansion paired USB-connector on the motherboard. <br><br><img src="https://habrastorage.org/files/d77/d03/c6f/d77d03c6fdfe42178da0e6ee5c8f0b1c.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  This device has the following features: <br><br><ol><li>  Simulation of pressing buttons POWER and RESET; </li><li>  USB power management (provided it does not have a separate source); </li><li>  Control galvanically isolated contact group (relay).  You can put in the cut of the food chain; </li><li>  Indicator LEDs (one can be controlled, the second shows the modes of operation). </li></ol><br><br>  The operation algorithm is simple: inside there are two adjustable timers that constantly count down the specified time, after which the press of the corresponding buttons (POWER and RESET) is simulated.  To prevent an accidental reboot, you must periodically send a timer reset command. <br><br>  It is better that the target application be responsible for the reset of the timers, and not a third-party or system (Cron, scheduling service) due to the fact that the probability of a system failure is less than in the application (although, who has it). <br>  The exchange of information is similar to the console. <br><br>  Command system: <br><br><table><tbody><tr><th>  team </th><th>  Description </th><th>  Example </th></tr><tr><td>  help </td><td>  Command Summary </td><td>  help </td></tr><tr><td>  LED1 </td><td>  LED control off by default </td><td>  LED1 ON <br>  LED1 OFF </td></tr><tr><td>  Relay </td><td>  Relay control, enabled by default </td><td>  RELAY ON <br>  RELAY OFF </td></tr><tr><td>  KEY1 </td><td>  Imitation of pressing the button 1, not pressed by default </td><td>  KEY1 ON <br>  KEY1 OFF </td></tr><tr><td>  KEY2 </td><td>  Imitation of pressing a button 2, not pressed by default </td><td>  KEY2 ON <br>  KEY2 OFF </td></tr><tr><td>  C1 </td><td>  Control of timer 1 associated with button 1. <br>  Set the time in seconds, the maximum value of 32767. <br>  To disable the timer function, you must set the time to 0. </td><td>  C1 res <br>  C1 SET 60 <br>  C1 SET 0 </td></tr><tr><td>  C2 </td><td>  Timer 2 control associated with button 2. <br>  Set the time in seconds, the maximum value of 32767. <br>  To disable the timer function, you must set the time to 0. </td><td>  C2 RES <br>  C2 SET 60 <br>  C2 SET 0 </td></tr><tr><td>  USB </td><td>  USB power management enabled by default </td><td>  USB ON <br>  USB OFF </td></tr></tbody></table><br><br>  If successful, the command returns "OK". <br>  In case of incorrect data returns ‚ÄúERROR‚Äù. <br>  A sign of the end of the line is the carriage return character "\ r".  Also supported mode is "\ r \ n". <br><br><img src="https://habrastorage.org/files/b6c/067/c4d/b6c067c4d3a348e984a73225b073cffd.png"><br><br>  The device is based on an STM32F103CA controller with USB hardware support.  Library of work with USB version V4.0.0.  3.3V operation voltage is obtained using a 5V line to USB stabilizer.  All control circuits use transistors in key mode.  Also, do not forget about the protective diode from self-induction currents in the relay coil (in my case it turned out to be built-in). <br><br>  That's all - simple and angry =). <br><br>  <a href="https://github.com/tachcard/watchdog">Github</a> <br><br><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/118703395&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj89EXn0vjlxUuVlBn3aGipd6xaPg" width="398" height="315" frameborder="0" title="hardware watchdog" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/255261/">https://habr.com/ru/post/255261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255245/index.html">Run PHP script on schedule cron. When it's not so clear</a></li>
<li><a href="../255247/index.html">Step-by-step instructions for creating a portlet platform: Portlet description</a></li>
<li><a href="../255251/index.html">Fake certificates for Google domains found</a></li>
<li><a href="../255253/index.html">How to stop worrying and start living without Flash</a></li>
<li><a href="../255259/index.html">Install SQL Server 2012 for SharePoint 2013</a></li>
<li><a href="../255263/index.html">WPF 4.6 and beyond</a></li>
<li><a href="../255265/index.html">Conference YAPC :: Russia :: MayPerl 2015 in Moscow May 16-17</a></li>
<li><a href="../255269/index.html">Mouse Factory in Shenzhen</a></li>
<li><a href="../255271/index.html">Hand on pulse: how we created a load tracking system for user servers</a></li>
<li><a href="../255275/index.html">Features of domain controller authentication using two different certificates</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>