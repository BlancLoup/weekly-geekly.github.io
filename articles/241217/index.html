<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Localization of applications for OS X</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When developing an application, its localization has a certain value, since it directly affects the number of users and, accordingly, the success of t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Localization of applications for OS X</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/mailru/blog/241217/"><img src="https://habrastorage.org/files/4b4/235/d8d/4b4235d8dbee4b4785ab1096cec6959c.png"></a> <br><br>  When developing an application, its localization has a certain value, since it directly affects the number of users and, accordingly, the success of the product.  We know the <a href="http://www.internetworldstats.com/stats7.htm">statistics</a> on the number of Internet users for different languages, and the conclusion is that by making a translation for a group of certain specific languages, you can significantly expand the audience of users of your program. <br><br>  Our team is working on the ICQ project and Mail.Ru Agent (hello Dima, Vova, Lesha) under OS X, and localizing the product at different stages of development was carried out differently, for each of the approaches revealed their strengths and weaknesses.  Some experience I want to share. <br><a name="habracut"></a><br><h1>  1. Localization through Interface Builder </h1> The easiest way to do localization is through standard Interface Builder (IB) tools.  At the same time, new languages ‚Äã‚Äãcan be added in the project settings MyTestProject&gt; Info&gt; Localizations.  Also here, already existing interface files can be processed automatically (a command of the type <code>genstrings -o en.lproj *.m</code> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When creating a new file with a user interface, just click on the Localize button in the Utilities window.  The interface is generally friendly and understandable.  To get strings from xib, if you want to localize not via IB, but manually, it makes sense to use a console command like this: <br><br><pre> <code class="bash hljs">ibtool --<span class="hljs-built_in"><span class="hljs-built_in">export</span></span>-strings-file SomeViewController.utf16-strings.tmp \ SomeViewController.xib &amp;&amp; iconv -f utf-16 -t utf-8 \ SomeViewController.utf16-strings.tmp &gt; SomeViewController.strings &amp;&amp; \ rm SomeViewController.utf16-strings.tmp</code> </pre><br>  The output will be something like: <br><br><pre> <code class="hljs vbscript">$ cat SomeViewController.strings /* <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> = <span class="hljs-string"><span class="hljs-string">"NSTextFieldCell"</span></span>; title = <span class="hljs-string"><span class="hljs-string">"   "</span></span>; ObjectID = <span class="hljs-string"><span class="hljs-string">"4"</span></span>; */ <span class="hljs-string"><span class="hljs-string">"4.title"</span></span> = <span class="hljs-string"><span class="hljs-string">"   "</span></span>; /* <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> = <span class="hljs-string"><span class="hljs-string">"NSTextFieldCell"</span></span>; title = <span class="hljs-string"><span class="hljs-string">"  "</span></span>; ObjectID = <span class="hljs-string"><span class="hljs-string">"9"</span></span>; */ <span class="hljs-string"><span class="hljs-string">"9.title"</span></span> = <span class="hljs-string"><span class="hljs-string">"  "</span></span>; /* <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> = <span class="hljs-string"><span class="hljs-string">"NSTextFieldCell"</span></span>; title = <span class="hljs-string"><span class="hljs-string">" "</span></span>; ObjectID = <span class="hljs-string"><span class="hljs-string">"15"</span></span>; */ <span class="hljs-string"><span class="hljs-string">"15.title"</span></span> = <span class="hljs-string"><span class="hljs-string">" "</span></span>; /* <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> = <span class="hljs-string"><span class="hljs-string">"NSTextFieldCell"</span></span>; title = <span class="hljs-string"><span class="hljs-string">""</span></span>; ObjectID = <span class="hljs-string"><span class="hljs-string">"23"</span></span>; */ <span class="hljs-string"><span class="hljs-string">"23.title"</span></span> = <span class="hljs-string"><span class="hljs-string">""</span></span>;</code> </pre><br>  The resulting translation can be corrected manually in any editor or any automation can be applied, after which the new SomeViewController.strings strings file can be returned to xib as follows: <br><br><pre> <code class="bash hljs">iconv -f utf-8 -t utf-16 SomeViewController.strings &gt; \ SomeViewController.utf16-strings.tmp &amp;&amp; ibtool --strings-file SomeViewController.utf16-strings.tmp \ SomeViewController.xib --write SomeViewController-updated.xib &amp;&amp; \ rm SomeViewController.utf16-strings.tmp</code> </pre><br>  The advantage here is simplicity and clarity, visual control of the ‚Äúlayout‚Äù for each language.  The disadvantages include problems with merge in git, the fact that with a large number of supported languages, changes in localization need to be done via IB, which is not always convenient.  Alternatively, you can still use scripts, such as the one above, keep the translation in xibs and translate everything automatically, but in our case, practice has shown that it is better not to complicate the system and not to use extra add-ins. <br><br><h1>  2. Software localization through NSLocalizedString </h1>  This approach eliminates the shortcomings of the previous one and consists in the fact that the interface element outlet is programmatically <code>NSLocalizedStrings</code> headers by the <code>NSLocalizedStrings</code> function: <br><br><pre> <code class="objectivec hljs"><span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.startButton.stringValue = <span class="hljs-built_in"><span class="hljs-built_in">NSLocalizedString</span></span>(@‚ÄúStartCaption‚Äù, @‚ÄúStart button <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> menu‚Äù); <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.pauseButton.stringValue = <span class="hljs-built_in"><span class="hljs-built_in">NSLocalizedString</span></span>(@‚ÄúPauseCaption‚Äù, @‚ÄúPause button <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> menu‚Äù);</code> </pre><br>  Here, the first argument of the function is the key by which the corresponding localized string is searched for in the corresponding Localizable.strings file. <br><br><img src="https://habrastorage.org/files/729/08c/bcc/72908cbcc86b4d05ad93b32a013fcb11.png"><br><br>  Examples of localization file content: <br><br><pre> <code class="bash hljs">Localizable.strings (Russian): ‚ÄúStartCaption‚Äù = ‚Äú!‚Äù; ‚ÄúPauseCaption‚Äù = ‚Äú!‚Äù; Localizable.strings (Engligh): ‚ÄúStartCaption‚Äù = ‚ÄúStart!‚Äù; ‚ÄúPauseCaption‚Äù = ‚ÄúPause!‚Äù;</code> </pre><br>  It is worth noting that if the key is not in <code>Localizable.strings</code> , then <code>NSLocalizedStrings</code> will return its value itself.  There is a temptation to use its value as a key, we did it for some time - here is a beautiful clear key, and it‚Äôs not scary to forget to write down the value, but in fact it became clear that, first, it is more inconvenient that the key value may be needed put down the key in the base language, different from the key itself, and it turns out ugly, and, secondly, it is still more convenient to control the correctness of localization using the key that pops out to the GUI.  The second argument of <code>NSLocalizedStrings</code> is a comment that does not play a special role, it is mainly used in the generation of string files based on existing code to clarify exactly what the string refers to.  You can get the actual file with strings for translation using the following script: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash export LANG=C LC_CTYPE=C LC_ALL=C for file in `find . -name "*.m"` do genstrings -a $file done cat Localizable.strings | sort -u | sed '/\/\\*/d' &gt; actual.strings</span></span></code> </pre><br>  Along with <code>NSLocalizedString</code> you can immediately use the <code>[NSBundle localizedStringForKey:value:table:]</code> method, which actually twitches (for the main bundle and with nil as a table) - it makes sense to use it when working with libraries, when you want to load strings from a custom .strings file (then specify its name as a table).  The language used is determined based on the values ‚Äã‚Äãof the <code>AppleLanguages</code> key from <code>NSUserDefaults</code> . <br><br>  If the translation lengths for different languages ‚Äã‚Äãare very different, and the interface floats, then along with the software alignment based on the size of the control <br><br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSSize</span></span> myButtonSize = [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.myButton.stringValue sizeWithAttributes:[<span class="hljs-built_in"><span class="hljs-built_in">NSDictionary</span></span> dictionaryWithObject:<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.myButton.font forKey:<span class="hljs-built_in"><span class="hljs-built_in">NSFontAttributeName</span></span>]];</code> </pre><br>  you can, and it's generally more convenient, use Auto Layout: <br><br><img src="https://habrastorage.org/files/362/b5a/86f/362b5a86fd3e47a2a00f42b6df4ef4ba.png"><br><br><img src="https://habrastorage.org/files/a04/cc0/d86/a04cc0d86570471ca68884497a1078bf.png"><br><br>  Here it is necessary to affix, as when changing the text of the control, to change its geometry automatically, and to align the buttons following it.  Great. <br><br><h1>  3. Dynamic localization </h1>  Now applied in our project.  It is rather a modification of the previous version, the bottom line is that the language changes dynamically through the program settings, and a notification is sent that we go around localized interfaces, where our <code>NSLocalizedString</code> analog is <code>NSLocalizedString</code> <code>localizedStringForKey</code> based on <code>[NSBundle localizedStringForKey:value:table:]</code> , which at runtime, it takes from the application resources the required line value in the language selected in the program settings.  Of the nuances worth noting that <br><ul><li>  in practice, for some languages ‚Äã‚Äãthere may not be some translations and you need to take a translation from the default one; </li><li>  for a language whose localization is not in the project, you need to do a check and return the default value of the language; </li><li>  for some languages ‚Äã‚Äã(for example, Portuguese), the language designation in the system (pt) and the Xcode environment (pt-BR) may differ, and therefore an additional check needs to be done. </li></ul><br>  In general, for each approach has its own scope.  Localization via IB, for example, is better to use for applications where not very many languages ‚Äã‚Äãare supported, a large number of text elements, and for different localizations the interface geometry is different.  Software localization is best done for projects where, on the contrary, many languages ‚Äã‚Äãand line lengths for different localizations are not very different.  In some cases, you can get stuck and make a dynamic localization, here is a plus in that you can additionally switch the language elegantly on the fly, and the user will be happy.  Do not forget the Auto Layout.  I hope someone will find something useful for themselves in this information.  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/241217/">https://habr.com/ru/post/241217/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../241205/index.html">How vGate helps in investigating security incidents in a virtual infrastructure</a></li>
<li><a href="../241209/index.html">Features of working with the Google Drive API</a></li>
<li><a href="../241211/index.html">Step-by-step guide to creating a trading robot in Python</a></li>
<li><a href="../241213/index.html">Google's Lollipop OS, new Nexus and a list of billions of companies in the mobile market - and other news of the week for a mobile developer</a></li>
<li><a href="../241215/index.html">GLPI and the latest time zone updates in Windows</a></li>
<li><a href="../241219/index.html">Apple obliges developers to create 64-bit applications</a></li>
<li><a href="../241221/index.html">Cryptographic solutions. From crypto providers to browser plug-ins</a></li>
<li><a href="../241223/index.html">How to write your own application with Yandex.Disk REST API</a></li>
<li><a href="../241227/index.html">SED: look for who benefits</a></li>
<li><a href="../241229/index.html">Pythonista. Writing in Python for iOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>