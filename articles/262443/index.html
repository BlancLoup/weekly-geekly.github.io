<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A simple replacement for Boost :: Optional for using nullable types in C ++ projects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article tells the story of how the author frightened the monstrous Boost and how he came up with his little nullable-bike. Perhaps the article wil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A simple replacement for Boost :: Optional for using nullable types in C ++ projects</h1><div class="post__text post__text-html js-mediator-article">  The article tells the story of how the author frightened the monstrous Boost and how he came up with his little nullable-bike.  Perhaps the article will be useful to those who want to use simple nullable-types in their project without using Boost, meeting the requirements given in the article are not the simplest. <br><a name="habracut"></a><br>  So, starting to support one relatively large MFC project that implements a thin billing client, I found that every time you need to pass a NULL to the database, there is an additional code containing this type check (conditionally): <br><br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//... void CSomeClass::someFunction(double variable) { //... if (variable == 0) { db-&gt;addValue(NULL); } else { db-&gt;addValue(variable); } //‚Ä¶</span></span></code> </pre> <br>  When I was faced with the need to implement a new feature in this project that requires reading and writing NULL values, I immediately wanted to build in the project support for nullable types, which would provide a simple and safe solution in terms of memory leaks to create them, assign them different values, copying and transferring to those ready-made functions that take a pointer to the value in memory as input. <br><br>  Until now, I have not had to use the Boost library, but I heard about it and thought: ‚ÄúGreat, it's time to touch it‚Äù.  Moreover, the ‚Äúgoogle‚Äù on the topic of ‚Äúc ++ nullable type‚Äù somehow boldly hints at Boost :: Optional. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      However, I quickly realized that Boost :: Optional does not suit me (and / or does not like it).  Firstly, its study and connection to the project was not included in the assessment of the work time for the task, secondly, I realized (perhaps I was mistaken here) that I would get problems when converting from Boost :: Optional to the usual ‚Äúpointing‚Äù type C ( at a minimum, it will not look very beautiful in code), in other words, I was not at all prepared for the fact that I would encounter difficulty for me in using it.  Maybe the whole thing is that I had Jeff Alger‚Äôs book ‚ÄúC ++ for real programmers‚Äù read behind, there were various solutions in my head for implementing all sorts of smart (and not so) pointers and operator overloading, and therefore I didn‚Äôt understand why for the implementation of the nullable-type, which I saw quite simple (for my needs), you need a monster like Boost :: Optional. <br><br>  And my needs are as follows (immediately using the example of using my nullable-bike): <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooModel</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: NullableType&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; intParam; }; FooModel* model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FooModel(); <span class="hljs-comment"><span class="hljs-comment">// ,  -  nullable-   NULL bool resBool = model-&gt;intParam == nullptr; //        NULL model-&gt;intParam = 654; //  ‚Äú   ‚Äù   .  resBool = model-&gt;intParam == nullptr; //    ‚Äú   ‚Äù  NULL,      NullableType&lt;int&gt; globIntParam1 = model-&gt;intParam; //    ,        int* intVarPtr1 = new int(23); //      C- int* intVarPtr2 = NULL; model-&gt;intParam = intVarPtr1; //       model-&gt;intParam = intVarPtr2; //   . (    ,  ) NullableType&lt;int&gt; globIntParam2(intVarPtr); //       </span></span></code> </pre><br>  I need a simple wrapper over the built-in simple C types that allow them to be assigned a NULL value, something like an int?  or double?  in C #, without the support of assigning NULL to "anything."  (Just in case, I will say that there can be no talk of using features of C ++ 11 or higher).  A little googling, I found a couple of similar implementations, but I was confused by the lack of all the features I needed and I wrote my own implementation of nullable-wrappers. <br><br>  If I am right, then something like this is needed in many C ++ projects.  Therefore, it is hard to imagine that so far Google has not given a simple solution to this issue. <br><br>  My wrapper has a problem - it cannot be used without a mind with strings, since  when initializing a string "wrapped" into it with a NULL value, you need to do something so that when you try to convert to string, you get an empty string from a NULL.  In the comments to the source there is a quick solution (checked in gcc and clang, everything is OK), but it may not please everyone.  This problem can also be solved for MFC privately by adding support for CString, which it uses instead of the usual string, but I didn‚Äôt do it not to bind it to MFC, and even now I didn‚Äôt need to write a NULL value. in the database instead of the empty string. <br><br>  Once again I will be to various proposals and criticism, perhaps I did not put enough effort to find a ready-made simple solution to this problem. <br><br>  The source code for the described nullable class is <a href="https://gist.github.com/bekasov/1e30ba3c29388b4f1627">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/262443/">https://habr.com/ru/post/262443/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../262431/index.html">Real-time data processing in AWS Cloud. Part 2</a></li>
<li><a href="../262433/index.html">IDA Pro Upgrade. Debugger plugin. Part I. Theory</a></li>
<li><a href="../262435/index.html">Simplify unit tests with the AutoFixture bundle and xUnit</a></li>
<li><a href="../262437/index.html">Automatic regulator of temperature of a geyser</a></li>
<li><a href="../262439/index.html">Optimizing Asterisk Dialplan Listing with MySQL</a></li>
<li><a href="../262445/index.html">Facebook World Data Analysis</a></li>
<li><a href="../262447/index.html">Event for university teachers in St. Petersburg on programming training</a></li>
<li><a href="../262451/index.html">Practical task with the analysis of the solution</a></li>
<li><a href="../262453/index.html">Overview of application frameworks on symfony2</a></li>
<li><a href="../262455/index.html">Static analysis of the HPX library with PVS-Studio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>