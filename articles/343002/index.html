<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Review of music software code defects. Part 4. Ardour</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ardour is still the largest of the musical projects involved in the review of code defects. The project includes about 1000 source code files in C ++....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Review of music software code defects. Part 4. Ardour</h1><div class="post__text post__text-html js-mediator-article"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f75/a45/0cf/f75a450cf4104ea058d74f25508caaf5.png"></div><br>  Ardour is still the largest of the musical projects involved in the review of code defects.  The project includes about 1000 source code files in C ++.  The project is actively supported by the developer community, and I did not find any mention of using any static analysis tools.  As a result - a lot of errors of different nature.  The article will describe the most interesting of them. <br><a name="habracut"></a><br><h2>  Introduction </h2><br>  <a href="https://ardour.org/">Ardour</a> - digital audio workstation (Digital Audio Workstation).  Works on Linux, Mac OS X and FreeBSD.  Ardour‚Äôs capabilities are limited only by the hardware on which it is running.  This makes the program one of the most popular tools for working with sound in a professional environment. <br><br>  Ardour uses many third-party libraries.  Some of them are located with the source code Ardour and edited by its authors.  Also, the project is divided into different components.  The article includes only the most interesting errors from the <i>gtk2_ardour</i> and <i>libs / ardour directories</i> .  To view the full report, authors can verify the project themselves by requesting a temporary key in support. <br><br>  The analysis was performed using <a href="https://www.viva64.com/ru/pvs-studio/">PVS-Studio</a> .  It is a tool for detecting errors in the source code of programs written in C, C ++ and C # languages.  Works in the environment of Windows and Linux. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  What is the author's idea? </h2><br>  In this section I will give a few examples of code according to which the opinions of readers can be divided: an error or a false positive.  And the correct solution is to rewrite the code anyway, so that it does not confuse other developers and analysis tools. <br><br>  <a href="https://www.viva64.com/ru/w/v696/">V696</a> The 'continue' operator will terminate 'do {...} while (FALSE)' loop because the condition is always false.  Check lines: 394, 397. session_transport.cc 394 <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Session::butler_transport_work () { .... <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { more_disk_io_to_do = _butler-&gt;flush_tracks_to_disk_after_.... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (errors) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (more_disk_io_to_do) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">false</span></span>); .... }</code> </pre> <br>  The <i>do-while (false) loop</i> can be used together with the <i>continue</i> statement to go to the end of the block (an analogue of <i>goto</i> ), but why then is the <i>break</i> statement?  It is possible that an error was made in the code and the loop should be <i>do-while (true)</i> .  In general, the code can and should be rewritten. <br><br>  Note.  Perhaps not everyone understood the point, so I will explain in a little more detail.  The <i>continue</i> operator transfers control not to the beginning of the <i>do-while</i> operator, but to the condition.  Since the condition is always false, here the <i>continue</i> operator works in exactly the same way as the <i>break</i> statement. <br><br>  <a href="https://www.viva64.com/ru/w/v547/">V547</a> Expression 'strlen (buf) &lt;256' is always true.  vst_info_file.cc 262 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_string</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FILE *fp)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf[MAX_STRING_LEN]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!fgets (buf, MAX_STRING_LEN, fp)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (buf) &lt; MAX_STRING_LEN) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (buf)) { buf[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (buf)<span class="hljs-number"><span class="hljs-number">-1</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> strdup (buf); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } }</code> </pre> <br>  The <i>fgets ()</i> function takes as its second argument the maximum length of the string, including the terminal zero, i.e.  the <i>buf</i> buffer will end with a null character correctly.  And what happens next in the code?  The condition <i>(strlen (buf) &lt;MAX_STRING_LEN) is</i> always true, since  The <i>fgets ()</i> function reads no more than <i>(MAX_STRING_LEN - 1)</i> characters.  Further, if the string is not empty, then the last character is deleted from it.  Not sure what this programmer planned to write.  Most likely, he expected that the string is not limited to the null character, but then such a string cannot be passed to the <i>strlen ()</i> function.  In general, the code should be rewritten so that you do not have to guess how it works and whether it corresponds to the originally intended one. <br><br>  <a href="https://www.viva64.com/ru/w/v575/">V575</a> The 'substr' function processes '-1' elements.  Inspect the second argument.  meter_strip.cc 491 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> MeterStrip::set_tick_bar (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> m) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> n; _tick_bar = m; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_tick_bar &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>) { n = meter_ticks1_area.get_name(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n.substr(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) != <span class="hljs-string"><span class="hljs-string">"Bar"</span></span>) { meter_ticks1_area.set_name(<span class="hljs-string"><span class="hljs-string">"Bar"</span></span> + n); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { n = meter_ticks1_area.get_name(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n.substr(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) == <span class="hljs-string"><span class="hljs-string">"Bar"</span></span>) { meter_ticks1_area.set_name(n.substr(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">-1</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// &lt;= } } if (_tick_bar &amp; 2) { n = meter_ticks2_area.get_name(); if (n.substr(0,3) != "Bar") { meter_ticks2_area.set_name("Bar" + n); } } else { n = meter_ticks2_area.get_name(); if (n.substr(0,3) == "Bar") { meter_ticks2_area.set_name(n.substr(3,-1)); // &lt;= } } }</span></span></code> </pre> <br>  Note all calls to the <i>substr ()</i> function.  The second argument is the value <i>-1</i> .  But what does it mean?  Here is the function prototype: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">substr</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pos = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> len = npos)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span></span>;</code> </pre> <br>  According to the documentation, without the 2nd argument, the <i>substr ()</i> function returns a substring from the specified position to the end of the string.  Those.  instead of simply writing <i>substr (pos)</i> or at least <i>substr (pos, string :: npos)</i> , the programmer decided to pass a value of <i>-1</i> , which eventually implicitly converts to the <i>size_t</i> type and turns into the value <i>string :: npos</i> .  Probably, the code is correct, but ugly.  In general, this can and should be rewritten. <br><br><h2>  Something is wrong in the program. </h2><br>  <a href="https://www.viva64.com/ru/w/v517/">V517</a> The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 2389, 2409. mixer_strip.cc 2389 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> MixerStrip::parameter_changed (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> p) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (p == _visibility.get_state_name()) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (p == <span class="hljs-string"><span class="hljs-string">"track-name-number"</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// &lt;= name_changed (); } else if (p == "use-monitor-bus") { .... } else if (p == "track-name-number") { // &lt;= update_track_number_visibility(); } }</span></span></code> </pre> <br>  Due to the same conditional expressions, the <i>update_track_number_visibility ()</i> function is never called.  It looks like the track number is not updated correctly at the right moment. <br><br>  Another five suspicious places: <br><br><ul><li>  V517 The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 160, 170. event_type_map.cc 160 </li><li>  V517 The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 4065, 4151. session_state.cc 4065 </li><li>  V517 The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 4063, 4144. session_state.cc 4063 </li><li>  V517 The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 498, 517. ardour_ui_options.cc 498 </li><li>  V517 The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 477, 519. ardour_ui_options.cc 477 </li></ul><br>  Another example: <br><br>  <a href="https://www.viva64.com/ru/w/v571/">V571</a> Recurring check.  The 'if (working_on_selection)' condition was already verified in line 284. editor_ops.cc 314 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Editor::split_regions_at (....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (working_on_selection) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( working_on_selection ) { <span class="hljs-comment"><span class="hljs-comment">//these are the new regions created after the split selection-&gt;add (latest_regionviews); } } commit_reversible_command (); }</span></span></code> </pre> <br>  The logical variable <i>working_on_selection is</i> checked a second time, in such a way that the condition is always false.  Perhaps due to such an error, some interface element is incorrectly highlighted. <br><br><h2>  10 more interesting mistakes </h2><br><h3>  #one </h3><br>  <a href="https://www.viva64.com/ru/w/v512/">V512</a> A call to the 'memset' function will lead to the underflow of the buffer 'error_buffer'.  ardour_http.cc 142 <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpGet</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> error_buffer[CURL_ERROR_SIZE]; .... }; HttpGet::HttpGet (<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> p, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ssl) : persist (p) , _status (<span class="hljs-number"><span class="hljs-number">-1</span></span>) , _result (<span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span> (error_buffer, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span> (*error_buffer)); .... }</code> </pre> <br>  I often encountered errors when, for example, not the size of an object, but the size of a pointer to it is passed to the <i>memset ()</i> function, but something new was found here.  Instead of the entire array, only one byte is reset. <br><br>  Another such place: <ul><li>  V512 A call to the 'memset' function will lead to the underflow of the buffer 'error_buffer'.  ardour_http.cc 208 </li></ul><br><h3>  # 2 </h3><br>  <a href="https://www.viva64.com/ru/w/v541/">V541</a> It is dangerous to print the 'buf' string into itself.  luawindow.cc 490 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> LuaWindow::save_script () { .... <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf[<span class="hljs-number"><span class="hljs-number">80</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span> t = time(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tm</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeinfo</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">localtime</span></span></span><span class="hljs-class"> (&amp;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">);</span></span> strftime (buf, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(buf), <span class="hljs-string"><span class="hljs-string">"%s%d"</span></span>, timeinfo); <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span> (buf, <span class="hljs-string"><span class="hljs-string">"%s%ld"</span></span>, buf, random ()); <span class="hljs-comment"><span class="hljs-comment">// is this valid? .... }</span></span></code> </pre> <br>  Here form a certain line in the buffer.  Then they want to get a new line, keeping the previous value of the line and adding the value of the function <i>random () to it</i> .  It seems simple. <br><br>  In the code, the original comment of the developer, who doubted the correctness of the code, was left.  To explain why an unexpected result can be obtained here, I will quote a simple and understandable example from the documentation for this diagnostic: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> s[<span class="hljs-number"><span class="hljs-number">100</span></span>] = <span class="hljs-string"><span class="hljs-string">"test"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(s, <span class="hljs-string"><span class="hljs-string">"N = %d, S = %s"</span></span>, <span class="hljs-number"><span class="hljs-number">123</span></span>, s);</code> </pre> <br>  As a result of this code, I want to get the line: <br><br><pre> <code class="cpp hljs">N = <span class="hljs-number"><span class="hljs-number">123</span></span>, S = test</code> </pre> <br>  But in practice, the string will be formed in the buffer: <br><br><pre> <code class="cpp hljs">N = <span class="hljs-number"><span class="hljs-number">123</span></span>, S = N = <span class="hljs-number"><span class="hljs-number">123</span></span>, S =</code> </pre> <br>  In other situations, a similar code can lead not only to the output of incorrect text, but also to the program crash.  The code can be corrected by using a new buffer to save the result.  Correct option: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> s1[<span class="hljs-number"><span class="hljs-number">100</span></span>] = <span class="hljs-string"><span class="hljs-string">"test"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> s2[<span class="hljs-number"><span class="hljs-number">100</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(s2, <span class="hljs-string"><span class="hljs-string">"N = %d, S = %s"</span></span>, <span class="hljs-number"><span class="hljs-number">123</span></span>, s1);</code> </pre> <br>  In the case of the control line "% s% ld" troubles may not occur, and the correct line will be printed.  But the code is very dangerous and unreliable. <br><br><h3>  # 3 </h3><br>  <a href="https://www.viva64.com/ru/w/v530/">V530</a>  audio_library.cc 162 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AudioLibrary::search_members_and (<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt;&amp; members, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt;&amp; tags) { .... sort(members.begin(), members.end()); unique(members.begin(), members.end()); .... }</code> </pre> <br>  Removing duplicate elements from the <i>members</i> vector is done incorrectly.  After calling the <i>unique ()</i> function, there are undefined elements in the vector. <br><br>  Corrected code: <br><br><pre> <code class="cpp hljs">sort(members.begin(), members.end()); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> last = unique(members.begin(), members.end()); v.erase(last, members.end());</code> </pre> <br><h3>  #four </h3><br>  <a href="https://www.viva64.com/ru/w/v654/">V654</a> The condition 'tries &lt;8' of loop is always true.  session_transport.cc 68 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Session::add_post_transport_work (PostTransportWork ptw) { PostTransportWork oldval; PostTransportWork newval; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tries = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (tries &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) { oldval = (PostTransportWork) g_atomic_int_get (....); newval = PostTransportWork (oldval | ptw); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (g_atomic_int_compare_and_exchange (....)) { <span class="hljs-comment"><span class="hljs-comment">/* success */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } } error &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Could not set post transport work! ...."</span></span> &lt;&lt; endmsg; }</code> </pre> <br>  The code above assumes 8 attempts of a certain operation, but the tries variable counter <i>does</i> not change in a loop.  Consequently, there is only one exit point from the cycle and, judging by the commentary, it indicates successful execution.  Because of such a defect in the code, the program conceals potential errors and may hang during execution. <br><br><h3>  #five </h3><br>  <a href="https://www.viva64.com/ru/w/v595/">V595</a> The '_session' pointer was used before it was verified against nullptr.  Check lines: 1576, 1579. editor_rulers.cc 1576 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Editor::set_minsec_ruler_scale (<span class="hljs-keyword"><span class="hljs-keyword">samplepos_t</span></span> lower, <span class="hljs-keyword"><span class="hljs-keyword">samplepos_t</span></span> upper) { <span class="hljs-keyword"><span class="hljs-keyword">samplepos_t</span></span> fr = _session-&gt;sample_rate() * <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">samplepos_t</span></span> spacer; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_session == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } .... }</code> </pre> <br>  This place looks like a serious mistake.  If the <i>_session</i> field is zero, then dereferencing of a non-valid pointer will occur before the corresponding check. <br><br>  Another small list of similar places: <br><br><ul><li>  V595 The 'rui' pointer was used before it was verified nullptr.  Check lines: 250, 253. analysis_window.cc 250 </li><li>  V595 The 'scan_dlg' pointer was used before it was verified against nullptr.  Check lines: 5089, 5099. ardour_ui.cc 5089 </li><li>  V595 The '_session' pointer was used before it was verified against nullptr.  Check lines: 352, 361. ardour_ui_options.cc 352 </li><li>  It was verified against nullptr.  Check lines: 581, 586. editor_mouse.cc 581 </li><li>  V595 The '_a_window' pointer was used before it was counted against nullptr.  Check lines: 423, 430. fft_graph.cc 423 </li><li>  V595 The '_editor -&gt; _ session' pointer was used before it was verified against nullptr.  Check lines: 140, 142. verbose_cursor.cc 140 </li></ul><br><h3>  # 6 </h3><br>  <a href="https://www.viva64.com/ru/w/v614/">V614</a> Uninitialized variable 'req.height' used.  Consider the set_size_request function.  time_axis_view.cc 159 <br><br><pre> <code class="cpp hljs">TimeAxisView::TimeAxisView (....) { .... boost::scoped_ptr&lt;Gtk::Entry&gt; an_entry (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FocusEntry); an_entry-&gt;set_name (X_(<span class="hljs-string"><span class="hljs-string">"TrackNameEditor"</span></span>)); Gtk::Requisition req; an_entry-&gt;size_request (req); name_label.set_size_request (<span class="hljs-number"><span class="hljs-number">-1</span></span>, req.height); name_label.set_ellipsize (Pango::ELLIPSIZE_MIDDLE); .... }</code> </pre> <br>  By this example, it was not immediately clear why the <i>req</i> structure is not initialized.  But looking at the sources and documentation, I found a function prototype: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size_request</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Requisition&amp; requisition)</span></span></span></span>;</code> </pre> <br>  The structure is transmitted by a constant link and can not be changed. <br><br><h3>  # 7 </h3><br>  <a href="https://www.viva64.com/ru/w/v746/">V746</a> Object slicing.  By reference rather than by value.  ardour_ui.cc 3806 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ARDOUR_UI::build_session (....) { .... <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { new_session = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Session (....); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (SessionException e) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (...) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } .... }</code> </pre> <br>  The analyzer has detected a potential error related to catching an exception by value.  This means that with the help of the copy constructor, a new <i>e</i> object of the <i>SessionException</i> type will be constructed.  In this case, some of the exception information that was stored in classes inherited from <i>SessionException</i> will be lost.  More correctly and, in addition, more effectively, intercept an exception by reference. <br><br>  Other warnings of this type: <br><br><ul><li>  V746 Object slicing.  By reference rather than by value.  ardour_ui.cc 3670 </li><li>  V746 Object slicing.  By reference rather than by value.  luawindow.cc 467 </li><li>  V746 Object slicing.  By reference rather than by value.  luawindow.cc 518 </li><li>  V746 Object slicing.  By reference rather than by value.  luainstance.cc 1326 </li><li>  V746 Object slicing.  By reference rather than by value.  luainstance.cc 1363 </li></ul><br><h3>  #eight </h3><br>  <a href="https://www.viva64.com/ru/w/v762/">V762</a> It was possible a virtual function was overridden incorrectly.  See the second argument of the function 'set_mouse_mode' in the derived class 'Editor' and the base class 'PublicEditor'.  editor.h 184 <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PublicEditor</span></span></span><span class="hljs-class"> :</span></span> .... { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_mouse_mode</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Editing::MouseMode m, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> force = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_follow_playhead</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> yn, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> catch_up = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; .... } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Editor</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> PublicEditor, .... { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_mouse_mode</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Editing::MouseMode, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> force=</span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_follow_playhead</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> yn, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> catch_up = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; .... }</code> </pre> <br>  Immediately, two functions in the <i>Editor</i> class were redefined incorrectly.  You can't just take the default value of an argument like this :). <br><br><h3>  #9 </h3><br>  <a href="https://www.viva64.com/ru/w/v773/">V773</a> The function of the mootcher pointer.  A memory leak is possible.  sfdb_ui.cc 1064 <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> SoundFileBrowser::freesound_get_audio_file(Gtk::TreeIter iter) { Mootcher *mootcher = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mootcher; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> file; <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> id = (*iter)[freesound_list_columns.id]; <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> uri = (*iter)[freesound_list_columns.uri]; <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> ofn = (*iter)[freesound_list_columns.filename]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mootcher-&gt;checkAudioFile(ofn, id)) { <span class="hljs-comment"><span class="hljs-comment">// file already exists, no need to download it again file = mootcher-&gt;audioFileName; delete mootcher; (*iter)[freesound_list_columns.started] = false; return file; } if (!(*iter)[freesound_list_columns.started]) { // start downloading the sound file (*iter)[freesound_list_columns.started] = true; mootcher-&gt;fetchAudioFile(ofn, id, uri, this); } return ""; }</span></span></code> </pre> <br>  The <i>mootcher</i> pointer <i>is</i> released on one condition.  In other cases, a memory leak occurs. <br><br><h3>  #ten </h3><br>  <a href="https://www.viva64.com/ru/w/v1002/">V1002</a> The 'XMLProcessorSelection' class, containing pointers, constructor and destructor, is copied by the automatically generated operator =.  processor_selection.cc 25 <br><br><pre> <code class="cpp hljs">XMLProcessorSelection processors; ProcessorSelection&amp; ProcessorSelection::<span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>= (ProcessorSelection <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> &amp; other) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> != &amp;other) { processors = other.processors; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }</code> </pre> <br>  One of the new diagnostics of PVS-Studio has found an interesting error.  Assigning one object of the <i>XMLProcessorSelection</i> class to another causes the pointer inside these objects to refer to the same memory location. <br><br>  <i>XMLProcessorSelection</i> class <i>definition</i> : <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XMLProcessorSelection</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: XMLProcessorSelection() : node (<span class="hljs-number"><span class="hljs-number">0</span></span>) {} ~XMLProcessorSelection() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> node; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XMLNode* n)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> node; } node = n; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XMLNode* newchild)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!node) { node = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLNode (<span class="hljs-string"><span class="hljs-string">"add"</span></span>); } node-&gt;add_child_nocopy (*newchild); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clear</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> node; node = <span class="hljs-number"><span class="hljs-number">0</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">empty</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> node == <span class="hljs-number"><span class="hljs-number">0</span></span> || ....empty(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> XMLNode&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_node</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *node; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: XMLNode* node; <span class="hljs-comment"><span class="hljs-comment">// &lt;= };</span></span></code> </pre> <br>  As we can see, the class contains a <i>node</i> pointer, but does not have an overriding assignment operator.  Most likely, instead of assignment, it was necessary to use the <i>set ()</i> or <i>add ()</i> functions. <br><br><h2>  Where else can you look for errors? </h2><br>  Articles always include a limited number of error examples.  Also in this review I took examples only from the <i>gtk2_ardour</i> and <i>libs / ardour directories.</i>  But there are a lot of sources in the Ardore project, and by studying all the analysis results, you can significantly improve both the quality of the project code and the stability of the program. <br><br>  I will give one example of an interesting error from the <i>libs / vamp-plugins</i> directory: <br><br>  <a href="https://www.viva64.com/ru/w/v523/">V523</a> The 'then' statement is equivalent to the 'else' statement.  Transcription.cpp 1827 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Transcribe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">0</span></span>;j&lt;<span class="hljs-number"><span class="hljs-number">112</span></span>;j++) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(A1[j]&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) { D[j]=A1[j];D2[j]=A1[j]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { D[j]=A1[j];D2[j]=A1[j]; } } .... }</code> </pre> <br>  The analyzer detected the same branches of the conditional operator.  The fact that the condition checks whether the element is positive or not makes this code fragment even more suspicious. <br><br><h2>  Conclusion </h2><br>  The Ardour project is likely to be more in demand in a professional environment than previous projects from the review.  Therefore, there should be quite a lot of people interested in correcting errors. <br><br>  Other reviews: <br><br><ul><li>  <a href="https://www.viva64.com/ru/b/0530/">Review of music software code defects.</a>  <a href="https://www.viva64.com/ru/b/0530/">Part 1. MuseScore</a> </li><li>  <a href="https://www.viva64.com/ru/b/0532/">Review of music software code defects.</a>  <a href="https://www.viva64.com/ru/b/0532/">Part 2. Audacity</a> </li><li>  <a href="https://www.viva64.com/ru/b/0536/">Review of music software code defects.</a>  <a href="https://www.viva64.com/ru/b/0536/">Part 3. Rosegarden</a> </li></ul><br>  If you know an interesting software for working with music and want to see it in the review, then send the names to me by <a href="">mail</a> . <br><br>  It is very easy to try the PVS-Studio analyzer on your project, just go to the <a href="https://www.viva64.com/ru/pvs-studio-download/">download</a> page. <br><br><div style="text-align:center;"> <a href="https://www.viva64.com/en/b/0540/"><img src="https://habrastorage.org/files/8d2/41b/5bf/8d241b5bf34747169141ed7c1997143b.png"></a> </div><br>  If you want to share this article with an English-speaking audience, then please use the link to the translation: Svyatoslav Razmyslov.  <a href="https://www.viva64.com/en/b/0540/">Review of Music Software Code Defects Part 4. Ardour</a> <br><br><div class="spoiler">  <b class="spoiler_title">Read the article and have a question?</b> <div class="spoiler_text">  Often our articles are asked the same questions.  We collected answers to them here: <a href="https://www.viva64.com/ru/a/0085/">Answers to questions from readers of articles about PVS-Studio, version 2015</a> .  Please review the list. </div></div></div><p>Source: <a href="https://habr.com/ru/post/343002/">https://habr.com/ru/post/343002/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342992/index.html">TgGram - website creation service for / from telegram channels</a></li>
<li><a href="../342994/index.html">Psychology of perception of form in logos</a></li>
<li><a href="../342996/index.html">Goto in ITMO: Botali week. Torn 2 accordions</a></li>
<li><a href="../342998/index.html">"Correct" command structure for DevOps</a></li>
<li><a href="../343000/index.html">Diagnostics of industrial electric motors and generators on the spectrum of current consumption and prevention of accidents</a></li>
<li><a href="../343004/index.html">The second wave that covered us. The standard that was waiting</a></li>
<li><a href="../343006/index.html">Russian AI Cup: Participant's Toolkit</a></li>
<li><a href="../343008/index.html">Development of sustainability strategies</a></li>
<li><a href="../343010/index.html">Renga BIM API</a></li>
<li><a href="../343012/index.html">Scrum is not only in development - we use a flexible methodology in organizing an IT festival for children and parents</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>