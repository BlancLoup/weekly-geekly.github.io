<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Eternally Open Sesame, or Several Loopholes in Your IT Landscape</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The furious vulnerabilities like EthernalBlue or Heartbleed attract a lot of attention to themselves, fueling the idea that the main thing is timely p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Eternally Open Sesame, or Several Loopholes in Your IT Landscape</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/1r/cf/j-/1rcfj-kz1j_7pnicqqkjavhqz4y.jpeg"><br><br>  The furious vulnerabilities like EthernalBlue or Heartbleed attract a lot of attention to themselves, fueling the idea that the main thing is timely patching of system software.  However, not everyone remembers that critical configuration defects are found no less often and are not always corrected by simply installing updates. <br><br>  I would like to speak about several of these security flaws, since they are found at every second (if not the first) customer and have not been corrected for years. <br><a name="habracut"></a><br><h2>  Letter from the director </h2><br>  Social engineering is the No. 1 problem, because it is badly curtailed by traditional protection measures.  It is possible to teach employees of the company to be wary of unexpected emails, but when it comes to specialists who receive dozens of emails per day from various senders, it is difficult to expect a good result. <br>  Take a look at your SMTP server.  With high probability, it processes mail without sender authentication.  This is not about mail traffic, through which tons of spam are sent to the outside - this is almost never encountered.  Here is another kind of problem: anyone can connect to your mail server from the outside and without authentication send an email to any local user.  In this case, the sender's address can be arbitrary - external or internal.  Want to send an email on behalf of IT support?  There is nothing easier: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/sz/3a/f0/sz3af0m22kq4mouikf76oupxbus.png"><br><br>  But even if the address of the local sender is unknown, you can try to pick it up, since in most cases the mail server checks whether there is a local user on whose behalf correspondence is sent. <br><br>  Attack scenario is trivial.  By exploiting a deliberately high trust of the victim to the author of the letter: the attacker forces the victim to open the attached file or follow the link.  Cheating antivirus software today is a matter of technology.  Most antiviruses confidently catch files containing code that exploits known vulnerabilities, and only a few are able to cope with customized code.  High secrecy of malicious code can be achieved by using obfuscators and encoders (such as Pyherion), which ‚Äúhide‚Äù suspicious chains of instructions from analytical engines.  To overcome sandboxes and other advanced behavioral analyzers, timers are added to the code, which set delays during which the running process shows no activity in the system, and many other tricks.  Attackers are often one step ahead of the manufacturers of protective equipment, because they have the opportunity to prepare and test their customized malware without any risk. <br><br>  In practice, this allows in 8 cases out of 10 to get a valid backdoor at the user's workstation. <br><br><h2>  Defenseless network </h2><br>  A well-segmented network with strict access lists is often found on internal pen tests.  Additional measures to protect administrative accounts (for example, LAPS technology) limit the potential of attacks aimed at extracting account details from OS memory of compromised hosts running Windows.  Sometimes hosts are protected so well that an attacker needs to look for attack vectors at the application level or in the network infrastructure.  The latter is found frighteningly often.  Let us give an example of a common security hole typical of networks built on Cisco equipment. <br><br>  The essence of the problem is that the Cisco Smart Install (SMI) service in most modern Cisco Catalyst switches allows you to change the device configuration without authentication.  The SMI service is designed for the initial configuration of network devices, so it is enabled by default on many switch models.  Moreover, in some cases it cannot be disabled (for example, on the Catalyst 6500 Series with IOS version 15.1 (2) SY11, 15.2 (1) SY5, 15.2 (2) SY3), and the only protection measure is the use of ACL. <br>  Check port 4786 / tcp on your Cisco networking equipment.  With high probability you will find a working service on it. <br><br>  It is wrong to consider SMI a rudiment of the past - with time new functions were added to it.  Starting with IOS 15.2, the ability to run post-install scripts in enable mode has been added, and this still does not require authentication.  The configuration upload / download procedure is available on all versions of IOS. <br><br><img src="https://habrastorage.org/webt/rx/-p/lb/rx-plbw98eepv_1dhfo94bflqnc.png"><br><br>  Due to the possibility of obtaining and modifying the configuration of a network device, there are ample opportunities for attacks on the network: starting with disclosing administrative details and intercepting network traffic, ending with redrawing access lists and including any VLAN present on the remote switch.  If the network device is bordered by the protected network segment, its capture will mean an intruder has entered the protected segment. <br><br><h2>  Manage can not be banned </h2><br>  Group Policy, which is one of the pillars of the AD directory service, allows administrators to implement a number of configuration scripts that require account credentials.  The configuration of such policies is stored in XML files in the SYSVOL directory of the domain controller and is available to all participants.  The problem is that the passwords of the accounts specified in the policy are stored in the cpassword attribute in an encrypted form, while the encryption key is publicly known and cannot be changed.  Thus, any domain member can retrieve and decrypt the password values ‚Äã‚Äãof user accounts stored in the following files: <br><br><ul><li>  groups.xml </li><li>  scheduledtasks.xml </li><li>  services.xml </li><li>  datasources.xml </li></ul><br>  Obviously, in most cases, accounts stored in this manner have administrative privileges. <br><br>  In 2014, Microsoft released security fixes KB2928120 / KB2961899, which prohibit storing user names and passwords in the Group Policy setting.  However, forcibly disabling or changing existing policies did not dare.  Yes, it is no longer possible to create new Group Policy settings containing user credentials, however, the previously created settings continue to act, warning at every opportunity the domain administrator with a message like: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/r_/_2/t4/r__2t4du5oycpv9j9covj3yha0s.png"></div><br><br>  Microsoft has offered administrators workarounds and alternative ways to implement domain configuration scripts, but in most cases has not been heard. <br><br><h2>  Summary </h2><br>  Much of the critical security issues cannot be fixed only by installing patches.  Standards for configuring information system components are an effective and cheap protective measure that should not be neglected.  In their absence, it remains to rely only on expensive detection measures: integrity monitoring, detection of behavioral abnormalities and suspicious traffic. <br><br>  <i>Andrei Zakharov, Head of Information Security Jet Infosystems Center Group</i> </div><p>Source: <a href="https://habr.com/ru/post/350622/">https://habr.com/ru/post/350622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350610/index.html">Breaking the Timlide Stalemate: Software Engineering Manager has more salary, better prospects - and we hire them in batches</a></li>
<li><a href="../350612/index.html">How to be * a compiler - creating a JavaScript compiler</a></li>
<li><a href="../350614/index.html">Top 10 trends in artificial intelligence (AI) technology in 2018</a></li>
<li><a href="../350618/index.html">Hackaton MentorHack: Inside out</a></li>
<li><a href="../350620/index.html">Change of profession: from graphic designer to front-end developer</a></li>
<li><a href="../350624/index.html">Neural network that determines the age of the blood test - the development of scientists of the ITMO University</a></li>
<li><a href="../350626/index.html">Flask Mega-Tutorial, Part XIV: Ajax</a></li>
<li><a href="../350628/index.html">Software Transactional Memory on Free Monads</a></li>
<li><a href="../350630/index.html">Unleash the game code using the Command pattern, and debugging while flying on the time machine</a></li>
<li><a href="../350632/index.html">Security Week 7: Dating through a coder and spam updates</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>