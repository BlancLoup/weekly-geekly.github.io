<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Smart watch do it yourself for 1500 rubles. Part 2 - Board and Components</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Due to numerous requests, I post the source of the clock scheme with a description of the components. 


 The circuit and the board were made in the D...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Smart watch do it yourself for 1500 rubles. Part 2 - Board and Components</h1><div class="post__text post__text-html js-mediator-article">  Due to numerous requests, I post the source of the clock scheme with a description of the components. <br><img src="https://habrastorage.org/getpro/habr/post_images/f4a/2dc/b64/f4a2dcb64c1691d9aac4fded67458126.jpg"><br><a name="habracut"></a><br>  The circuit and the board were made in the DipTrace program. <br>  When I ordered components for watches, there was a slightly different set, but due to the lack of those models that I wanted, I had to take these: <br><br><h6>  Stabilizer: </h6><br><ul><li>  Model: ADP3338AKCZ-3.3-RL7; </li><li>  body: SOT-223; </li><li>  input voltage: 2.7V - 8V; </li><li>  output voltage 3.3V; </li><li>  maximum load: 1A (picked up with a margin); </li><li>  Maximum own consumption in Regulation mode: 3mA at 100mA load, 0.19mA at 0.1mA load;  in Dropout mode :, 0.6mA at 0.1mA load; </li><li>  connection diagram: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/391/8cb/b31/3918cbb31374822a2055ae9bc871f196.jpg"><br><br><h6>  Real time clock: </h6><br><ul><li>  Model: DS1337U +; </li><li>  case: 8 uSOP; </li><li>  input voltage: 1.8V - 5.5V; </li><li>  maximum consumption: 0.15mA (if you look at the graph, at an input voltage of 3.3V, consumption ~ 40uA); <br><img src="https://habrastorage.org/getpro/habr/post_images/5b7/bc7/67d/5b7bc767d296c3640a2f731437f9ce41.jpg"></li><li>  interface protocol: I2C; </li><li>  connection diagram: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/6bf/ed2/326/6bfed23260faeeb23a429ab7e34f9e4f.gif">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  Bluetooth: </h6><br><ul><li>  Model: HC-06; </li><li>  body: your; </li><li>  input voltage: 3.0V - 4.2V; </li><li>  maximum consumption before connection: fluctuations in the range of 30-40 mA (~ 25mA), after connection: 8mA; </li><li>  connection diagram: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/45d/9bf/e4b/45d9bfe4b895b5400958193423d596c3.jpg"><br><br><h6>  Battery: </h6><br><ul><li>  Model: LIR3048; </li><li>  body: your; </li><li>  output "normal" voltage: 3.6V; </li><li>  "Normal" capacity: 200mAh; </li><li>  charging voltage: 4.25V; </li><li>  charge current: ‚Äúnormal‚Äù 0.5C (100mA), max.  1C (200mA); </li><li>  maximum discharge current: 2C (400mA); </li></ul><br><br><h6>  Battery Charging Controller: </h6><br><ul><li>  Model: MCP73831T_2ACI_OT; </li><li>  body: SOT-23-5; </li><li>  input voltage: 3.75V - 6V; </li><li>  consumption is not interested; </li><li>  connection diagram: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/e9a/721/d51/e9a721d516ea19124a737ee69da65bbf.jpg"><br>  Charging current is regulated by a resistor according to the formula: <br><img src="https://habrastorage.org/getpro/habr/post_images/7e5/1e8/720/7e51e8720d6a23ae49d352bd93579bdd.jpg"><br>  Since  The battery charge current is 100mA, then the resistor is 10kOhm. <br><br><h6>  USB - UART: </h6><br><ul><li>  Model: CP2102-GMR; </li><li>  housing: MLP-28; </li><li>  input voltage: 4V - 5.25V; </li><li>  consumption is not interested; </li><li>  connection diagram: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/a77/7f2/8c7/a777f28c7d41cb29071463bed4728231.jpg"><br><br><h6>  Microcontroller: </h6><br><ul><li>  Model: msp430g2553ipw28; </li><li>  housing: TSSOP28; </li><li>  input voltage: 1.8V - 3.6V; </li><li>  consumption: depends on the power consumption mode, the included modules, the processor frequency, etc .; </li><li>  pin connections: A 47kOhm pull-up resistor and a 10nF capacitor to ground (no more than 2.2nF when using the SBW or JTAG interface); </li></ul><br><br><h6>  Screen: </h6><br><ul><li>  model: nokia 1202; </li><li>  body: your; </li><li>  input voltage: 3.3V; </li><li>  connection diagram: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/ec8/557/080/ec8557080e90874136993eb1ed5aefe3.jpg"><br>  Taken <a href="http://radioskot.ru/publ/mk/podkljuchenie_displeja_k_mikrokontrolleru/9-1-0-702">from here</a> <br><br><h6>  Rest: </h6><br>  The lever for controlling the clock was taken from the old communicator.  It has 3 positions: up, center, bottom.  Also, just in case, the reset button MK is added.  Vibrating motor from the same communicator.  Quartz for CRR from the Launchpad set.  The miniUSB port is taken from the broken card reader.  LED for charging status indication I don‚Äôt remember where it‚Äôs coming from =) <br><br><h2>  Scheme </h2><br>  It remains to connect all the blocks together and see what happens. <br>  Yeah, between the battery and the ground, there are 2 capacitors for 1uF (stabilizer) and 4.7uF (charging).  We take only the larger one at 4.7uF.  Yes, and between 5V from USB and ground again there are 2 capacitors for 1uF (USB-UART) and 4.7uF (charging).  Again we take only the larger one at 4.7uF. <br>  Scheme in the studio! <br><img src="https://habrastorage.org/getpro/habr/post_images/bb8/3cb/c20/bb83cbc20cf4709ddb77da1ca725960f.jpg"><br>  To save power, the BT power must be turned off when not in use.  To do this, let's get a power pin on the MK leg.  But!  In this state, BT did not start.  As far as I remember, the load on each pin is limited to 40mA and apparently this is not enough to turn on the BT.  Therefore, we connect the power BT to two pins.  (of course, it would be possible to make a power key on transistors, but this is extra space on the board for components + complication of the circuit, etc.). <br>  Just want to know when BT is connected, and when waiting for a connection.  To do this, let's get the BT LED pin on the MK pin.  When enabled without connecting to this pin log.  sequence 01010101 ... In the connected state there is always a log on it.  one. <br>  To measure the voltage on the battery, a voltage divider with two resistors was connected to the ADC input.  The values ‚Äã‚Äãof the resistors were chosen so that the input to the ADC when charging (maximum voltage 4.25V) was less than 3.3V. <br>  The voltage regulator outputs 3.28 - 3.29 volts with an input voltage of more than 3.4 and about 0.1 - 0.2 volts less than the input when the input is from 2.7 to 3.3 volts.  And when the input is less than 2.7 is disabled. <br><br><h2>  PCB layout </h2><br>  The layout of the board was made manually.  Initially, there were only a few pins of the MC to which it was necessary to connect external components, namely: <br><ul><li>  I2C interface: pins P1.7 (SDA) and P1.6 (SCL); </li><li>  USB - UART for flashing: pins TEST, RST, P1.1 (TX) and P1.5 (RX); </li><li>  voltage divider: any ADC input (P1.x). </li></ul><br>  First, all components were placed on the board.  Then there was a connection for the above points.  Then the layout of all other components. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f4a/2dc/b64/f4a2dcb64c1691d9aac4fded67458126.jpg"><br><br>  The bottom right 5 pins of the BT should be isolated from the board.  Quartz is soldered to the substrate connected to the ground.  For convenience of soldering, near the first pins of the microcircuits, dots are put. <br><br>  Source codes and boards <a href="https://drive.google.com/folderview%3Fid%3D0B5gHoRZUYwPadGprV0RlMmFNaEU">here</a> <br><br>  That seems to be all.  As always, I look forward to questions and comments. <br><br>  <a href="http://habrahabr.ru/post/218495/">Part 1 - Start</a> </div><p>Source: <a href="https://habr.com/ru/post/218645/">https://habr.com/ru/post/218645/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../218633/index.html">Task compression method</a></li>
<li><a href="../218637/index.html">International Mobile Conference # MBLT14</a></li>
<li><a href="../218639/index.html">Authorization through fancybox at yii</a></li>
<li><a href="../218641/index.html">Personalization and analysis of data in offline retail</a></li>
<li><a href="../218643/index.html">How to create your own IT company: the history of Provectus IT</a></li>
<li><a href="../218647/index.html">QR codes for Linux kernel crash reports</a></li>
<li><a href="../218649/index.html">FundingTo - fundraising according to your rules. Part two</a></li>
<li><a href="../218651/index.html">Who to entrust your business? Part 1 - Accounting</a></li>
<li><a href="../218653/index.html">Students-doctors virtually operate three-dimensional bodies</a></li>
<li><a href="../218655/index.html">Sality virus modifies the DNS service of routers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>