<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Python & Arduino. Simple, fast and beautiful</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Very often, beginners and not only developers have questions. How to manage with Arduino from a computer? And if the computer is not a Raspberry Pi, b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Python & Arduino. Simple, fast and beautiful</h1><div class="post__text post__text-html js-mediator-article">  Very often, beginners and not only developers have questions.  How to manage with Arduino from a computer?  And if the computer is not a Raspberry Pi, but an ordinary home computer?  And if you do not want to suffer from ESP8266 and manage through the web interface?  Is it really necessary to open the Arduino IDE each time and send commands via the <b>Port Monitor</b> ?  I will tell you exactly how to create your own GUI application for managing Arduino. <br><a name="habracut"></a><br><h3>  Equipment </h3><br>  I recently got a very interesting board: <b>Arduino SS Micro</b> .  This board, which looks like a Digispark Attiny 85, is nevertheless a Chinese version of the Arduino Micro, with a USB output. <br><br><img src="https://habrastorage.org/webt/aa/wu/2y/aawu2yvapatjuclkye5hfyxkdxs.png"><br><br>  I will not talk about it in detail, because this was already done by a YouTube user with the nickname <b>iomoio</b> , and his review can be viewed <a href="https://www.youtube.com/watch%3Fv%3D89-hkoUUnno">here</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As it seems to me, this is a pretty cool and convenient device for small home projects, because wires have a super-property: to get lost at the most inappropriate moment. <br><br>  MacBook Pro with macOS Mojave operating system was used as a control computer, but do not close the article if you are using Windows or Linux - everything described in the article will work without changes on any operating system. <br><br><h3>  Sketch for Arduino </h3><br>  As an example, we will use a sketch that turns on and off the LED, upon a command from the Serial-port. <br><br>  <b>WARNING</b> <br><br>  The LED in the Arduino SS Micro hangs on the SS port and therefore it turns off automatically.  Despite this, the standard <b>Blink</b> example - the flashing LED is working. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> inChar; <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> LED_PIN SS void setup() { pinMode(LED_PIN, OUTPUT); </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//   Serial.begin(115200); //  Serial -  } void loop() { if (Serial.available() &gt; 0) { inChar = Serial.read(); if (inChar=='e') // e - Enable -  { digitalWrite(LED_PIN,HIGH); } } else if (inChar=='d') // d - Disable -  { digitalWrite(LED_PIN,LOW); } else if (inChar=='b') // b - Blink -    { while (true){ digitalWrite(LED_PIN,HIGH); delay(1000); digitalWrite(LED_PIN,LOW); delay(1000); } } }</span></span></span></span></code> </pre> <br>  If you use another Arduino - do not forget to change the pin of the LED. <br><br><h3>  Code for computer </h3><br>  One of the advantages of Python, in addition to its cross-platform - the presence of a huge number of libraries.  We will need: <br><br><ul><li>  <b>PySerial</b> - library for working with Serial-port </li><li>  <b>PyQT5</b> - a library for creating a graphical interface </li></ul><br><h4>  Installation </h4><br>  For installation, we will use the built-in package manager - pip. <br><br><pre> <code class="bash hljs">pip install pyserial pyqt5</code> </pre> <br>  For the convenience of creating a GUI, you can install the QTDesigner program. <br><br><h4>  Interface </h4><br>  Since this program is intended more likely to demonstrate the capabilities, the user can select the port from those offered, as well as the speed with which the communication will occur. <br><br><img src="https://habrastorage.org/webt/iy/ga/62/iyga62zgwjt9p5zbr8ebw-r6xr4.png"><br><br><h4>  Source </h4><br>  All work with the device takes place thanks to the PySerial library.  But there are a few nuances.  For example, how to find out which port the device is connected to? <br><br>  On the well-known <b>stackoverflow</b> site, a user with the nickname <a href="https://stackoverflow.com/users/300783/thomas">Thomas</a> suggested a ready-made solution, which I used. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serial_ports</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Lists serial port names :raises EnvironmentError: On unsupported or unknown platforms :returns: A list of the serial ports available on the system """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> sys.platform.startswith(<span class="hljs-string"><span class="hljs-string">'win'</span></span>): ports = [<span class="hljs-string"><span class="hljs-string">'COM%s'</span></span> % (i + <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">256</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> sys.platform.startswith(<span class="hljs-string"><span class="hljs-string">'linux'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> sys.platform.startswith(<span class="hljs-string"><span class="hljs-string">'cygwin'</span></span>): <span class="hljs-comment"><span class="hljs-comment"># this excludes your current terminal "/dev/tty" ports = glob.glob('/dev/tty[A-Za-z]*') elif sys.platform.startswith('darwin'): ports = glob.glob('/dev/tty.*') else: raise EnvironmentError('Unsupported platform') result = [] for port in ports: try: s = serial.Serial(port) s.close() result.append(port) except (OSError, serial.SerialException): pass return result</span></span></code> </pre><br>  In addition, you must keep a list of available speeds: <br><br><pre> <code class="python hljs">speeds = [<span class="hljs-string"><span class="hljs-string">'1200'</span></span>,<span class="hljs-string"><span class="hljs-string">'2400'</span></span>, <span class="hljs-string"><span class="hljs-string">'4800'</span></span>, <span class="hljs-string"><span class="hljs-string">'9600'</span></span>, <span class="hljs-string"><span class="hljs-string">'19200'</span></span>, <span class="hljs-string"><span class="hljs-string">'38400'</span></span>, <span class="hljs-string"><span class="hljs-string">'57600'</span></span>, <span class="hljs-string"><span class="hljs-string">'115200'</span></span>]</code> </pre> <br>  Now let's put together the <b>design</b> (created in QtDesigner and converted using pyuic5 utility to .py file), <b>functions for scanning ports</b> and the <b>main program code</b> . <br><br>  The main class that contains all the logic of the program <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LedApp</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(QtWidgets.QMainWindow, design.Ui_Form)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.setupUi(self) self.Port.addItems(serial_ports()) self.Speed.addItems(speeds) self.realport = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.ConnectButton.clicked.connect(self.connect) self.EnableBtn.clicked.connect(self.send) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: self.realport = serial.Serial(self.Port.currentText(),int(self.Speed.currentText())) self.ConnectButton.setStyleSheet(<span class="hljs-string"><span class="hljs-string">"background-color: green"</span></span>) self.ConnectButton.setText(<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: print(e) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.realport: self.realport.write(<span class="hljs-string"><span class="hljs-string">b'b'</span></span>)</code> </pre><br>  The variables <b>self.Port</b> and <b>self.Speed</b> are drop-down lists containing the values ‚Äã‚Äãof the available ports and speeds. <br><br>  When you click on the <b>self.ConnectButton</b> button, the <b>connect</b> function is called, in which you attempt to connect to the specified port with the specified speed.  If the connection is successful, the button turns green and the label changes. <br><br><img src="https://habrastorage.org/webt/gk/6y/f2/gk6yf27-ftwz7k_omji4nuxrraw.png"><br><br>  The <b>send</b> function sends a byte string to our port - forcing the flashing mode to be enabled. <br><br>  In this way, you can control various devices connected to USB. <br><br>  This article is an introductory and overview, more complete information can be found for example here: <br><br><ul><li>  <a href="https://pyserial.readthedocs.io/en/latest/">PySerial</a> </li><li>  <a href="https://tproger.ru/translations/python-gui-pyqt/">PyQT</a> </li><li>  <a href="http://arduino.ru/Reference/Serial">Serial to Arduino</a> </li></ul><br>  The full source code, both a sketch for Arduino, and the program is posted on <a href="https://github.com/Snusmumrick/Arduino-And-Python">GitHub</a> . </div><p>Source: <a href="https://habr.com/ru/post/443326/">https://habr.com/ru/post/443326/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../443312/index.html">Python memory management</a></li>
<li><a href="../443314/index.html">What is Cordentity? [Translation of the article]</a></li>
<li><a href="../443320/index.html">Electronic document management system "Vizir"</a></li>
<li><a href="../443322/index.html">GitLab 11.8 released with SAST for JavaScript, GitLab Pages for subgroups and bug tracking</a></li>
<li><a href="../443324/index.html">Python vs. Scala for Apache Spark - the expected benchmark with an unexpected result</a></li>
<li><a href="../443330/index.html">Security Week 11: RSA 2019 and a bright future</a></li>
<li><a href="../443332/index.html">Kitchen Robotics</a></li>
<li><a href="../443334/index.html">Yellow muzzle</a></li>
<li><a href="../443342/index.html">Free options for licensing PVS-Studio</a></li>
<li><a href="../443344/index.html">Economics and Human Rights</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>