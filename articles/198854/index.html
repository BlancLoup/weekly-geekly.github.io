<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>From the creators of Indexisto - ‚ÄúSearch for Habr II‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On a gloomy autumn morning, as an experiment, we wrote down our search for Habr with structure and speed. All the work took about 10 minutes. Those wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>From the creators of Indexisto - ‚ÄúSearch for Habr II‚Äù</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://indexisto.com/blog/5/879"><img src="https://habrastorage.org/getpro/habr/post_images/ff5/d74/653/ff5d746535513b87fb8b4fcc4bb96fc1.png"></a> <br><br>  On a gloomy autumn morning, as an experiment, we wrote down our search for Habr with structure and speed.  All the work took about 10 minutes. Those who are too lazy to read a <a href="http://indexisto.com/blog/5/879">tyk to view a new search</a> (search engine right in the body of a blog entry) <br><br>  To obtain such a search, we did not request access to the database, or fill in articles through our API.  Everything is done very simply, through the usual crawler.  For example, we have scrubbed about 5000 articles. <br><a name="habracut"></a><br><h5>  Prehistory </h5><br>  Hello.  Let me remind you that we are doing a quick structured search for <a href="http://indexisto.com/">Indexisto</a> sites (+ our <a href="http://habrahabr.ru/post/185966/">post on Habr√©</a> ).  For a long time nothing was heard from us, and now we finally come out with a release. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After the first publication, many liked what we were doing and many people wanted to introduce.  I am very grateful to the first ones who connected - we saw a lot of, let's say, ‚Äúsubtleties‚Äù that we would not have found.  We repaired everything pretty quickly, and at the same time never dropped a single ‚Äúlive‚Äù index.  However, there was a structural problem: <br>  - Very high threshold of entry.  Complicated connection through the database, complex settings of templates, search query, analyzers, etc. <br><br>  We solved this problem by manually configuring the client configs (for example, you can watch our issue on <a href="http://maximonline.ru/">maximonline.ru</a> ), and by explaining that we need early adopters.  Development (besides bugs) almost got up, and we realized that either we are becoming an integrator, or we need to change something in order to remain an Internet project. <br><br><h5>  Development of events </h5><br>  Today we want to present a cardinal solution to the connection problem - you just need to enter the site URL, and get a ready-made search result.  That's it. <br><br> <a href="http://indexisto.com/"><img src="https://habrastorage.org/getpro/habr/post_images/278/e2c/80f/278e2c80f95cd955f884cccfd5dd2fe5.png"></a> <br><br>  Everything else is done automatically.  A lot of complex settings are taken from the finished template and applied to your index.  At the same time, the admin panel was reduced to the point - to checkboxes and drop-down lists.  For hardcore fans, we left the opportunity to switch to the advanced mode. <br><br><h5>  Crawler and parser </h5><br>  And so, now we have a crawler and a content parser.  Crawler provides relatively reasonable pages: we have more or less learned how to discard pagination, various feeds, view changes (like? Sort = date.asc).  But even if the crawler works perfectly, we will have pages with articles in which there is a ton of excess: the menu, the blocks in the right and left column.  Let's face it, I would not really like to see all this in the search results, if we stick to our positioning. <br><br>  Here we go to the undoubtedly Uber system: the parser allows you to extract any data from the page. <br><br>  Conceptually, the system combines two approaches: <br><ul><li>  automatically extracting content based on algorithms, for example, this <a href="http://www.l3s.de/~kohlschuetter/boilerplate/">Boilerplate Detection using Shallow Text Features</a> .  About this will be a separate post. </li><li> data extraction "in the forehead" using <i>xpath</i> .  Let me remind you, if by simple - <i>xpath</i> allows you to search for text in certain tags, for example <b><code>//span[contains(@class, 'post_title')]</code></b> - pull the title from the <b>span</b> tag with the class <b>post_title</b> . </li></ul><br><br>  The system can operate without any additional settings, as well as using manual settings for a specific site. <br><br><h5>  Parser masks for content extraction </h5><br>  All settings <i>xpath</i> we store in masks <br>  The parser gets a page at the input and starts chasing it in different masks, passing from one to the other.  Each mask tries to isolate something from the html page and add to the received document: title, image, text of the article.  For example, there is a mask that extracts Open Graph tags and appends their contents to the document: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mask</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ogHighPrecision"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.50123"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">document</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ogHighPrecisionTags"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_url"</span></span></span><span class="hljs-tag">&gt;</span></span>//meta[contains(@property, 'og:url')]/@content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_subtype"</span></span></span><span class="hljs-tag">&gt;</span></span>//meta[contains(@property, 'og:type')]/@content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_image"</span></span></span><span class="hljs-tag">&gt;</span></span>//meta[contains(@property, 'og:image')]/@content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag">&gt;</span></span>//meta[contains(@property, 'og:title')]/@content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"description"</span></span></span><span class="hljs-tag">&gt;</span></span>//meta[contains(@property, 'og:description')]/@content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"siteName"</span></span></span><span class="hljs-tag">&gt;</span></span>//meta[contains(@property, 'og:site_name')]/@content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">document</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mask</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  As it is already clear masks we describe in XML.  The code does not require special explanation) <br><br>  We have quite a few such masks - for OG, microdata, garbage pages with noindex, etc. <br><br>  Thus, in principle, you can enter the address of the site, and get an acceptable issue. <br>  However, many want not just acceptable, but perfect.  And here we give you the opportunity to write <i>xpath</i> yourself. <br><br><h5>  Custom masks </h5><br>  Without extra water, let's see how we extracted data from Habra <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mask</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"habrahabrBody"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.21"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allowUrl</span></span></span><span class="hljs-tag">&gt;</span></span>/company/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allowUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allowUrl</span></span></span><span class="hljs-tag">&gt;</span></span>/events/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allowUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allowUrl</span></span></span><span class="hljs-tag">&gt;</span></span>/post/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allowUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allowUrl</span></span></span><span class="hljs-tag">&gt;</span></span>/qa/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allowUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">document</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"habrahabrBody"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"body"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">required</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span>//div[contains(@class, 'html_format')]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">required</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span>//span[contains(@class, 'post_title')]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">field</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">document</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mask</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The code does not need an explanation) In fact, we said to this mask: work only on pages of posts, companies, events and questions, take the body of the article from a <b>div</b> with the <b>html_format</b> class, a heading from the <b>span</b> with a class <b>post_title</b> <br>  Extraction of the picture takes place at the level of system (embedded) masks by the Open Graph tag, so we did not remember anything about the picture in our mask. <br><br>  In the future, we will try to make this process even easier, like Google‚Äôs webmaster panel ( <a href="http://www.youtube.com/watch%3Fv%3DwjhfUz2NjHg">Video</a> ) </div><p>Source: <a href="https://habr.com/ru/post/198854/">https://habr.com/ru/post/198854/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../198838/index.html">20 free add-ons for Visual Studio</a></li>
<li><a href="../198840/index.html">Google-calendar as a replacement for a blackboard with leaves</a></li>
<li><a href="../198842/index.html">Smart home, as I sunk to such. Part 3</a></li>
<li><a href="../198844/index.html">Fujitsu Servers: Autumn Update</a></li>
<li><a href="../198850/index.html">The technical task: why the wording ‚ÄúMake as here‚Äù does not work?</a></li>
<li><a href="../198856/index.html">FailConf-2013: conference on errors in IT business</a></li>
<li><a href="../198858/index.html">Universal Electronic Card (UEC) and its future</a></li>
<li><a href="../198860/index.html">Handwriting Recognition Appears in Gmail and Google Docs</a></li>
<li><a href="../198862/index.html">Vuforia: a bit of magic in our reality</a></li>
<li><a href="../198864/index.html">Social network without a server. Development history of the iOS client and backend</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>