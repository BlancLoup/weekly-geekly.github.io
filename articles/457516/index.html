<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing a threat model</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone, we are continuing our cycle of articles on ‚Äúpaper safety‚Äù. Today we will talk about the development of a threat model. If the goal of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing a threat model</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/yx/xu/e_/yxxue_qrk7mjbofj5tdeqmwalz0.jpeg"><br><br>  Hello everyone, we are continuing our cycle of articles on ‚Äúpaper safety‚Äù.  Today we will talk about the development of a threat model.  If the goal of reading this article is to gain practical skills, then it is better to immediately download our <a href="">document templates</a> , which also contain a threat model template.  But even without a template at hand, the article can also be found in general educational purposes. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Why do you need a threat model? </h2><br><br>  The need to develop a threat model is regulated by a number of regulatory documents.  Here are some of them. <br><br>  Part 2 of Article 19 of Law No. 152- ‚ÄúOn Personal Data‚Äù: <br><br><blockquote>  2. Ensuring the security of personal data is achieved, in particular: <br><br>  1) <b>identification of threats to the security of</b> personal data when they are processed in personal data information systems; </blockquote><br><br>  The composition and content of organizational and technical measures to ensure the security of personal data when they are processed in personal data information systems (approved by order of the FSTEC of Russia dated February 18, 2013 No. 21): <br><br><blockquote>  4. Measures to ensure the security of personal data are implemented, including through the use of information security tools in the information system, which have passed the conformity assessment procedure in the prescribed manner in cases where the use of such tools is necessary to neutralize <b>actual threats to the security of</b> personal data. </blockquote><br><br>  Requirements for the protection of non-state secret information contained in state information systems (approved by the FSTEC of Russia on February 11, 2013 No. 17) <br><br><blockquote>  Formation of requirements for the protection of information ... including includes: <br>  ... <br>  <b>identification of information security threats</b> , the implementation of which may lead to the violation of information security in the information system, and the development of an information security threat model based on them; <br>  ... </blockquote><br><br>  Requirements for ensuring the protection of information in automated systems for managing production and technological processes at critical facilities, potentially hazardous facilities, as well as facilities that pose an increased risk to human life and health and the environment (approved by the order of the FSTEC of Russia dated March 14, 2014. 31): <br><br><blockquote>  Formation of requirements for the protection of information in an automated control system ... including includes: <br>  ... <br>  identification of information security threats, the implementation of which may lead to a violation of the normal operation mode of the automated control system, and the <b>development of an</b> <b>information security threat model</b> based on them; </blockquote><br><br>  Requirements for ensuring the security of significant objects of the critical information infrastructure of the Russian Federation (approved by order of the FSTEC of Russia of December 25, 2017 No. 239): <br><br><blockquote>  11. The development of organizational and technical measures to ensure the safety of a significant object is carried out by the subject of the critical information infrastructure ... and should include: <br><br>  a) analysis of information security threats and the development of a model of information security threats or its refinement (if available); </blockquote><br><br>  So, the conclusion from this is simple: for any information systems that are anyway to be protected in accordance with the law, it is necessary to develop a threat model. <br><br><h2>  Content of the threat model </h2><br><br>  With the need to create a document figured out, let's see what the law on its content prescribes.  Here, oddly enough, everything is pretty meager. <br><br>  As a textbook example of describing the content of a threat model, you can use the 17 FSTEC order: <br><br><blockquote>  The model of information security threats should contain a description of the information system and its structural and functional characteristics, as well as a description of information security threats, including a description of the capabilities of the offenders (violator model), possible information system vulnerabilities, ways to implement information security threats and the consequences of violation of information security properties. </blockquote><br><br>  You will not believe, but that's all.  But on the other hand, although the text is not much, but it is quite informative.  Let's reread and write out what should be in our threat model: <br><br><ul><li>  description of the information system; </li><li>  structural and functional characteristics; </li><li>  description of security threats; </li><li>  offender model; </li><li>  possible vulnerabilities; </li><li>  ways of realizing threats; </li><li>  consequences of violation of information security properties. </li></ul><br><br>  This is required by law, which is required by the FSTEC.  In addition, there are also requirements of the FSB (about them a bit later) and some informal requirements-wishes from FSTEC, which we encountered in the process of agreeing threat models of state information systems. <br><br><h2>  Introductory part of the threat model </h2><br><br>  Ok, let's get to the content of the document. <br><br>  I think about the title page, the list of abbreviations, terms and definitions everything is clear.  Although, perhaps, it is worthwhile to elaborate on ... suddenly the title page. <br><br>  In the template it is signed by the head of the owner of the information system.  It is not just like that. <br><br>  Government Decree of May 11, 2017  No. 555: <br><br><blockquote>  4. The terms of reference for the creation of a system and the model of information security threats are approved by an official of the executive body entrusted with the appropriate authority. </blockquote><br><br>  Naturally, if the information system is not a state system and the system operator is not an executive authority, then anyone can sign the threat model.  It‚Äôs just that we faced more than once when the customer fulfilled the above conditions (the state information system of the executive authority) asked us to change the title page so that only the representatives of the licensee company (that is, ours) signed there.  I had to explain why FSTEC would return such a threat model for revision. <br><br><h2>  Section "Regulatory and methodological support" </h2><br><br>  Here I would like to recall that the threat model can be developed for very different systems - from SPD to KII.  Therefore, the list of regulatory documentation may differ.  For example, if we are developing a threat model for an automated process control system, then the FSTEC orders 21 and 17 must be removed from the template and the 31st should be added. <br><br>  Documents marked with the abbreviation "SKZI" are the regulatory documents of the FSB regulating the handling of encryption tools.  If cryptographic tools are not used in the information system (now it is rare, but still), then these regulatory documents should be removed from the list. <br><br>  A frequent mistake here is the addition of various GOST and other regulatory documents (STR-K is very fond of entering here) that are not related to the modeling of threats.  Or canceled documents.  For example, often in threat models one can find in the list of normative documents of the FSB so-called ‚ÄúMethodical recommendations ...‚Äù and ‚ÄúTypical requirements ...‚Äù, which have <a href="http://www.fsb.ru/fsb/science/single.htm%2521id%253D10437725%2540fsbResearchart.html">not been relevant for a</a> long time. <br><br><h2>  General provisions </h2><br><br>  Here the standard water is presented in the template - why is a threat model needed, etc. What you need to focus on here is a comment about the type of information under consideration.  By default, the template presents the most frequently encountered option - personal data (PD).  But the system may not have personal data, but there may be other confidential information (CI), and the information may not be confidential, but protected (GI) according to other characteristics - integrity and availability. <br><br><h2>  Description of the information system </h2><br><br>  Here you can find general information about the information system - where it is located, what is called, what data and what class (level of protection, category) are processed.  Here, of course, many are interested in how much detail the information system needs to be described. <br><br>  In the process of multiple reconciliation of threat models for state information systems, we have worked out a decision on this ‚Äî there must be a happy medium.  This should not be a copy-paste from a technical passport with serial numbers of hardware.  But on the other hand, a person who is not familiar with the system, who read its description in the threat model should roughly understand how this very system works. <br><br>  Example: <br><br><blockquote>  The server part of the Nipel information system is a cluster of physical servers on which the ESXi 6.x hypervisor is deployed.  The work of the server part of the basic services of the information system is provided by virtual servers (server names) under the control of operating systems (OS list).  The main software that implements the technological processes of processing is (the name of the software).  Application software is a client-server application.  The client side works as a fat client on user workstations running operating systems (OS list).  Users get access to the information system, both from the local network and through the Internet using secure communication channels.  In general, the information system functions as shown in the diagram. <br><br>  A functional (not topological!) Information system diagram is applied. </blockquote><br><br>  This is how it usually looks like.  Style and other details, of course, can vary greatly, the main thing is the information that can be extracted from the description. <br><br>  There is also a section called ‚ÄúSecurity of the premises‚Äù.  Here we describe how the premises are protected during business and non-working hours - video surveillance, access control, security guard, doorman, alarm system and that's it. <br><br>  Here, in the template of the threat model, there are purely FSB sections ‚ÄúDetermining the relevance of using the CMIS for ensuring the security of personal data‚Äù and ‚ÄúAdditional objects of protection‚Äù.  If cryptography is not used, then these sections are simply removed, if used, then there is nothing special to change, in general, there is no need, except for how to enter the name of the information system. <br><br>  The section "Principles of a threat model" can also not be changed.  Just note that there is an option for when the system uses cryptographs, and when not.  Choose the right and go further. <br><br><h2>  Intruder Model </h2><br><br>  Here you can divide this part into classic and new.  The classic is the one where the potential violators of the 1, 2 and further categories are described.  In fact, this part of the offender model is left in the template only because regulators like it when it is.  Of practical value is the section ‚ÄúViolators according to the Threat Databank of the FSTEC of Russia‚Äù. <br><br>  This section is of practical value because the threats themselves from the FSTEC threats database (hereinafter referred to as IAB) are tied to violators with low, medium and high potential.  The section itself is a copy-paste description of the characteristics of violators with low, medium and high potentials.  Next is the conclusion of our favorite "expert" by - what the offender for us is relevant.  That is, in essence, the compiler chooses the violator ‚Äúby eye‚Äù, because there are simply no methods for choosing the violator. <br>  We will not give these descriptions in full here; we will try to briefly formulate the difference between the potentials of the violators.  In addition to the delimitation of the potential violators are still external and internal. <br><br>  The most talented hacker in the world who perfectly uses existing tools and can create his tools is suddenly a troublemaker with low potential.  An intruder with the same capabilities, but having some insider information about the system, is already an average potential.  The main phrase that distinguishes the average potential from the low: ‚ÄúThey have access to information about the structural and functional characteristics and features of the functioning of the information system‚Äù.  Here you need to think carefully about how likely a leak of such information.  Violators with high potential, if briefly, it is mainly special services.  Here we have the opportunity to attract specialized scientific organizations and information gathering from physical fields and that‚Äôs all. <br><br>  In realistic situations, the potential of the offender is either low or medium. <br><br><h2>  "FSB" sections </h2><br><br>  Then follow the sections ‚ÄúGeneralized capabilities of attack sources‚Äù and ‚ÄúRealization of information security threats, determined by the capabilities of attack sources‚Äù.  These sections are not needed unless cryptographic tools are used.  If they are still used, then the source data, and in general the tables for these sections are not necessary to be invented, they are taken from the Federal Security Service normative document ‚ÄúGuidelines for the development of legal acts defining threats to the security of personal data that are relevant to the processing of personal data in information personal data systems operated during the implementation of the relevant activities ‚Äù(approved by the management of the 8th Center of the Federal Security Service of Russia on March 31, 2015, No. 149/7/2 / 6-432). <br><br>  We have the truth in the template, the result is somewhat different from the default, given in the above document, the FSB. <br><br>  The ultimate goal of these sections is to establish a class of cryptographic information protection (CIPS) that can be used in the system in question.  This class directly depends on the abuser‚Äôs capabilities and is set in accordance with the 378 order of the FSB (for personal data, and for other types of information there are simply no such requirements). <br><br>  The most commonly used class of cryptographic tools is KC3.  Now tell you why. <br><br>  In general, the document ‚ÄúComposition and content of organizational and technical measures to ensure the security of personal data when they are processed in personal data information systems using the means of cryptographic protection of information necessary to fulfill the requirements for personal data protection for each level of protection established by the Government of the Russian Federation‚Äù ( approved by order of the Federal Security Service of Russia dated July 10, 2014 No. 378) the class of SKZI for the system under consideration is established, firstly, based on the type  and threats, and secondly on the basis of possible infringers. <br><br>  About the types of threats in detail we will not stop; there is a lot of information on the Internet.  Let us dwell on the fact that there are 3 types of threats and to us by hook or by crook, if you plan to use cryptography, you need to do exactly the 3rd type of threats (irrelevant threats associated with undeclared capabilities in the application and system-wide software).  Why? <br><br>  Because the 378 order of the FSB: <br><br><blockquote><ul><li>  SKZI class KA in cases where threats of type 1 are relevant for the information system; </li><li>  SKZI class KV and above in cases where the type 2 threats are relevant for the information system; </li><li>  SKZI class KS1 and above in cases where the type 3 threats are relevant for the information system. </li></ul></blockquote><br><br>  It seems clear, but what's the problem?  The problem is that SKZI classes KA1, KV1 and KV2 you can not buy just like that, even if you have a lot of money, which they cost. <br><br>  We will conduct a small "investigation."  We download the new <a href="http://clsz.fsb.ru/files/download/svedeniya_po_sertifikatam_07..06.doc">registry SKZI</a> , look for SKZI class KA1.  The first search was ‚ÄúHardware-software encoder M-543K‚Äù.  We go to Google, we write "To buy hardware and software encoder M-543K" - a failure.  We are trying to ‚Äúbuy‚Äù the following cryptographic device - again a failure.  We drive in just ‚ÄúKA1 buy crypto tools‚Äù - failure.  We get only links to other cryptographic classes KS1-KS3 or to forums where cryptography is discussed.  But the fact is that, as has already been said, you simply cannot buy SKZI of the classes KA and KV, only through specialized military units.  Why these cryptographs were even mentioned in the personal data document is still not clear.  Therefore, in the usual ISPD - only the third type of threats. <br><br>  With KA and KV figured out, but why precisely KS3, and not KS2 and KS1?  There is already a second condition to blame - the offender. <br><br>  378 order of the FSB: <br><br><blockquote>  12. SKZI class KS3 are used to neutralize attacks, in creating methods, the preparation and conduct of which uses the capabilities listed in paragraphs 10 and 11 of this document and at least one of the following additional capabilities: <br><br>  a) <b>physical access to the SVT, which are used for SKZI and SF</b> ; <br>  b) the ability to locate the hardware components of the SKZI and the SF, limited by the measures implemented in the information system in which the SKZI is used, and aimed at preventing and suppressing unauthorized actions. </blockquote><br><br>  Here is the logic: <br><br><ul><li>  Such common IMSs, such as ViPNet Client or CryptoPRO CSP, are implemented on users' workstations; </li><li>  users are potential offenders; </li><li>  A potential intruder has physical access to the computer facilities on which their SKZI and the environment of operation are implemented. </li></ul><br><br>  Thus, it is only possible to justify a lower class of CIPF only by proving that our users are not potential violators (difficult), or to use only crypto-gateways that are located in server rooms, which, in turn, have access only to privileged users whom we have excluded from the list of potential violators. <br><br><h2>  Vulnerabilities </h2><br><br>  As we remember, potential vulnerabilities should be listed in the threat model.  In the downloadable template, the threat model of this section does not yet exist, so we briefly describe how to handle this. <br><br>  The compiler of the threat model should immediately have a question: what should be the direct list of vulnerabilities identified by the scanner to the document?  The question is good and the answer is not clear.  We know colleagues who do just that, but we think this approach is wrong and here's why. <br><br>  First, the information security threat model document, although subject to change, is still more or less static.  Developed once and forgot to significant infrastructure changes in the system. <br><br>  The list of vulnerabilities generated by scanners is very dynamic information.  Today we revealed vulnerabilities, tomorrow they were eliminated and scanned again - we received a new report.  The day after tomorrow new signatures appeared, the scanner was updated and found new vulnerabilities and so on.  What is the point of applying a vulnerability scanner report made at the time of the development of a threat model?  No <br><br>  Secondly, a threat model can be created for a physically non-existent (designed, but not built) information system.  In this case, we can not even scan anything. <br><br>  The way out of this situation is simple.  Specify in the threat model not specific vulnerabilities with the CVE identifier and CVSS rating, but list the possible classes of vulnerabilities for a specific information system.  And in order to give this list of solidity, let us take this list not from the head, but from GOST R 56546-2015 ‚ÄúInformation security.  Vulnerabilities of information systems.  Classification of information systems vulnerabilities.  The list under the spoiler.  We take it and remove unnecessary, incompatible with the structural and functional characteristics of our system.  The section is ready! <br><br><div class="spoiler">  <b class="spoiler_title">Classes of vulnerabilities according to GOST</b> <div class="spoiler_text">  Vulnerabilities by area of ‚Äã‚Äãorigin: <br><br><ul><li>  code vulnerabilities; </li><li>  configuration vulnerabilities; </li><li>  organizational vulnerabilities; </li><li>  multifactorial vulnerabilities. </li></ul><br><br>  Vulnerabilities by type of information system flaws: <br><br><ul><li>  vulnerabilities associated with incorrect configuration of software parameters; </li><li>  vulnerabilities due to incomplete validation of input data; </li><li>  link-related vulnerabilities; </li><li>  vulnerabilities associated with the ability to implement OS commands; </li><li>  cross-site scripting (script execution) vulnerabilities; </li><li>  vulnerabilities associated with the implementation of arbitrary code; </li><li>  memory buffer overflow vulnerabilities; </li><li>  vulnerabilities associated with leakages / disclosures of restricted access information; </li><li>  credentials management (credential) vulnerabilities; </li><li>  vulnerabilities associated with managing permissions, privileges and access; </li><li>  authentication related vulnerabilities; </li><li>  cryptographic vulnerabilities; </li><li>  cross-site request spoofing vulnerabilities; </li><li>  resource management vulnerabilities. </li></ul><br>  Vulnerabilities at the place of occurrence (manifestation): <br><br><ul><li>  vulnerabilities in system-wide (common) software; </li><li>  vulnerabilities in application software; </li><li>  vulnerabilities in special software; </li><li>  technical vulnerabilities; </li><li>  portable hardware vulnerabilities; </li><li>  vulnerabilities in network (communication, telecommunication) equipment; </li><li>  vulnerabilities in information security. </li></ul><br></div></div><br><br><h2>  Private security threat model </h2><br><br>  And it is only here that we proceed directly to the determination of actual threats. <br>  The method for determining the actual threats from the FSTEC of 2008 slightly smells slightly and we have already <a href="https://habr.com/ru/company/ic-dv/blog/453756/">written</a> about it <a href="https://habr.com/ru/company/ic-dv/blog/453756/">here</a> .  But nothing can be done here, as in the same article noted - that is, with what we are working.  Let's see what exactly we need to do to get a list of current threats. <br><br>  Fresh documents from the FSTEC prescribe as a source of information for information security threats to use the AIS.  Now there are 213 threats and the list can be replenished. <br><br>  Here I would immediately like to talk about the pros and cons of the NIS.  A definite plus is that now there is no need to invent and formulate threats on their own, although it also prohibits nothing to supplement the threat model with its own threats.  Another plus is the prescribed potential of the violator and certain violated security characteristics of the information for each threat - no need to invent anything. <br><br>  Minuses.  The first minus is terribly scary opportunities for sorting threats.  When you first begin to make a model of threats according to the NDU, then the natural desire is to weed out threats that may not be relevant in your system according to structural and functional characteristics.  For example, to remove threats to virtual containers and hypervisors, because the system does not use virtualization or to select threats to the BIOS / UEFI is necessary for some reason, but there is no such possibility.  Not to mention the fact that there are a number of quite exotic threats in the NDBU, for example, connected with supercomputers or grid systems. <br><br>  Since we, as a licensing organization, are developing many threat models for different systems, we had to manually divide 213 threats into groups, otherwise the work is very difficult, especially considering that the threats are not grouped even in order. <br><br>  The second minus is the description of the threats themselves.  No, somewhere everything is clear and understandable.  But there is a threat that is formulated in such a way that you need to break your head in order to figure out what this is all about. <br><br>  Let us return to the definition of the list of current threats. <br><br><h3>  Initial security level </h3><br><br>  The first thing to define is a global parameter ‚Äî the level of initial security.  It is global because it is determined once and does not change from threat to threat. <br><br>  To determine the level of initial security (it‚Äôs also the coefficient of initial security Y1), for seven indicators, choose one of the values ‚Äã‚Äãthat is most suitable for your system. <br><br>  List of characteristics under the spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">List of characteristics and their values</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td rowspan="2">  technical and operational characteristics of ipdn </td><td colspan="3">  security level </td></tr><tr><td>  tall </td><td>  average </td><td>  low </td></tr><tr><td colspan="4">  1. by location: </td></tr><tr><td>  distributed area that spans multiple regions, territories, counties, or the state as a whole </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td>  urban area covering no more than one locality (city, town) </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td>  corporate distributed uprn covering many divisions of one organization </td><td>  - </td><td>  + </td><td>  - </td></tr><tr><td>  local (campus) service, deployed within the same building </td><td>  - </td><td>  + </td><td>  - </td></tr><tr><td>  local service deployed within the same building </td><td>  + </td><td>  - </td><td>  - </td></tr><tr><td colspan="4">  2. by the presence of a connection to public communication networks: </td></tr><tr><td>  service with multipoint access to public communication network </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td>  single-point connection to public communication network </td><td>  - </td><td>  + </td><td>  - </td></tr><tr><td>  ispdn physically separated from the public network </td><td>  + </td><td>  - </td><td>  - </td></tr><tr><td colspan="4">  3. for built-in (legal) operations with records of personal data bases: </td></tr><tr><td>  reading, searching </td><td>  + </td><td>  - </td><td>  - </td></tr><tr><td>  record, delete, sort </td><td>  - </td><td>  + </td><td>  - </td></tr><tr><td>  modification </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td colspan="4">  4. on the delimitation of access to personal data: </td></tr><tr><td>  ispdn, to which certain employees of the organization that owns the item or the subject of the pdn have access </td><td>  - </td><td>  + </td><td>  - </td></tr><tr><td>  A service that all employees of the organization that owns the service have access to </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td>  open access service </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td colspan="4">  5. by the presence of connections with other pdn databases of other ispdn: </td></tr><tr><td>  Integrated service (organization) uses several pdn service bases, and the organization does not own all used pdn databases) </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td>  A service that uses one pdn database belonging to the organization that owns this service provider. </td><td>  + </td><td>  - </td><td>  - </td></tr><tr><td colspan="4">  6. the level of generalization (depersonalization) pdn: </td></tr><tr><td>  A field in which user-provided data is impersonal (at the level of organization, industry, region, region, etc.) </td><td>  + </td><td>  - </td><td>  - </td></tr><tr><td>  ispdn, in which the data is anonymized only when transferred to other organizations and not impersonal when presented to the user in the organization </td><td>  - </td><td>  + </td><td>  - </td></tr><tr><td>  Ispdn, in which the data provided to the user are not impersonal (i.e., there is information available to identify the subject of the pdn) </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td colspan="4">  7. by volume of pdn that are provided to third-party users of unallocated data without preprocessing </td></tr><tr><td>  ispdn, providing the entire database with pdn </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td>  ispdn, providing part of pdn </td><td>  - </td><td>  + </td><td>  - </td></tr><tr><td>  service not providing any information </td><td>  + </td><td>  - </td><td>  - </td></tr></tbody></table></div><br></div></div><br><br>  Each value corresponds to a high, medium, or low level of security.  We consider what percentage we have for indicators with different values.  About the high level of initial security - forget it does not happen.  If ‚Äúhigh‚Äù and ‚Äúmedium‚Äù scored 70% or more, then we determine the average level of initial security (Y1 = 5), if not, then it is low (Y1 = 10). <br><br><h3>  Danger of threats </h3><br><br>  This section in the template is called ‚ÄúDetermining the consequences of violation of information security properties (danger of threats)‚Äù.  They called it this way because, in essence, by definition of the danger of threats, this is a definition of consequences, but when agreeing on a threat model, the verifiers may not draw this parallel, and since the ‚Äúdetermination of consequences‚Äù must be in the threat model, they write a comment. <br><br>  So, the danger of threats can be low, medium or high, depending on whether minor negative, just negative or significant negative consequences occur when the threat is realized, respectively. <br><br>  Specialists here often argue whether the danger of threats should be determined once and be a constant for all threats - or not.  Methodology is not specified, so it is possible and so.  Our approach is intermediate - we determine the danger of threats depending on the violation of confidentiality, integrity or availability in the implementation of a specific threat. <br><br>  According to our logic, the negative consequences do not depend on the method of violation of confidentiality, integrity and availability.  For example, if your personal data leaks in some database, then you most likely will not care how it happened - with the help of SQL injection or with the physical access of the intruder to the server (professional interest of the IB person does not count!).  Therefore, we define three ‚Äúdanger threats‚Äù, so to speak, to violate confidentiality, integrity and availability.  Often they may coincide, but it is still better to analyze the threats in the threat model separately.  Fortunately, in the AUU for each threat, the characteristics that are violated are also spelled out. <br><br><h3>  Elimination of ‚Äúextra‚Äù threats </h3><br><br>  Next, in order to immediately cut off the extra threats, we make a sign with a list of excluded threats and a rationale - why we throw them out. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In the template as an example are presented: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elimination of threats associated with grid systems, supercomputers, and big data; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elimination of threats associated with virtualization; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elimination of threats associated with the use of wireless communication networks; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> exclusion of threats associated with the use of cloud services; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elimination of threats to process control systems; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> exclusion of threats associated with the use of mobile devices; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the exclusion of threats, the realization of which is possible only by the violator with high potential. </font></font></li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> On the last point, you need to clarify a couple of points: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> if you identify an intruder with a low potential, then there are excluded threats that violators with medium and high potential can carry out; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> only the remaining threats that were not excluded in the previous paragraphs are excluded; </font></font></li><li>    ,                . </li></ul><br><br><h3>   </h3><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next comes a table describing the threats that were not excluded. Yes, here it is necessary to copy-paste the text from the NDB, because the threat model should have a ‚Äúdescription of threats‚Äù, it‚Äôs impossible to get rid of the identifiers. Let's see what we have in this table. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Number in order and the identifier of threats from the NDU - everything is clear. Columns "description of the threat" and "method of realization of the threat" - a text block from the NDT. Insert the text in the first column to the words "The realization of the threat is possible ...". In the second - everything else. The separation is again connected with the requirement of regulatory documents that the ‚ÄúMethods of realization of the threat‚Äù should be described in the threat model. When coordinating this will help avoid unnecessary questions.</font></font><br><br><img src="https://habrastorage.org/webt/xj/pd/dq/xjpddqphllbleyu9ltrnl0tww3o.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The following columns of the tables are the potentials of the internal and external violators. </font><font style="vertical-align: inherit;">In order to make the table more compact and give more space to text blocks, we first assigned the numbers 1, 2 and 3 to the high, medium and low potentials, respectively. If the potential in the AED is not specified, put a dash. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Column "Objects of impact" - also take data from the NDT. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The column ‚ÄúViolable properties‚Äù - K, TS and D, confidentiality, integrity and availability - were replaced with letters for the same purpose as in the case of violators.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And the last columns are ‚ÄúPrerequisites‚Äù and ‚ÄúJustification of the absence of prerequisites‚Äù. </font><font style="vertical-align: inherit;">The first is the beginning of the determination of the Y2 coefficient, it is also the probability of the threat realizing, which in turn is determined from the presence of the prerequisites for realizing the threat and taking measures to neutralize the threat.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Determination of threat probability</font></font></b> <div class="spoiler_text">   ()       , ,               .      : <br><br>  ‚Äì       (,     ,      ,   ); <br><br>   ‚Äì      ,        (,     ); <br><br>   ‚Äî      ,       ; <br><br>   ‚Äî              . <br><br>                 ,  : <br><br> 0 ‚Äì   ; <br> 2 ‚Äì    ; <br> 5 ‚Äì    ; <br> 10 ‚Äì    . <br><br></div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is important to say here that the last column is purely our initiative and is not stipulated by law. </font><font style="vertical-align: inherit;">Therefore, you can safely clean it. </font><font style="vertical-align: inherit;">But we consider it important that if a specialist additionally excludes threats, because there are no prerequisites for their implementation, it is important that he describe why he decided so. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This moment is also connected with the fact that we are in a sense moving away from the threat modeling methodology. </font><font style="vertical-align: inherit;">According to the methodology for threats that do not have prerequisites, it is necessary to further consider their relevance. </font><font style="vertical-align: inherit;">And in some cases, threats that do not have the prerequisites may become relevant. </font><font style="vertical-align: inherit;">We consider this a flaw in the legislation and still exclude from the final table threats that have no prerequisites.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> List of current threats </font></font></h3><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">More precisely, the last table is a list of actual and irrelevant threats and a compilation of the remaining parameters to determine their relevance. </font><font style="vertical-align: inherit;">There are no threats for which there are no prerequisites, but of the remaining threats, based on the calculation of coefficients, some threats may be considered irrelevant. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the last table, we deliberately did not include some parameters:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Y1 - this parameter is global, so we just keep it in mind; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Prerequisites - in the final table, we only have threats that have prerequisites, so there is no point in this column. </font></font></li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Briefly go through the columns. The number is in order and the threat is only in the form of an identifier - everything is clear. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúMeasures taken‚Äù - by ‚Äúexpert‚Äù means we determine whether measures have been taken to neutralize this threat (by the way, one more trick of the methodology - if measures are ‚Äútaken‚Äù, the threat may still remain relevant). There may be three options: accepted; accepted but insufficient; not accepted (+, + -, - respectively). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Based on the measures taken and given that there are prerequisites for the threat, the probability coefficient (Y2) is determined, how to determine it is higher under the spoiler. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The next column is the coefficient of realizability of the threat Y. It is calculated by the simple formula Y = (Y1 + Y2) / 20.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The possibility of realization is the verbal analogue of the Y coefficient. It is determined depending on the numerical value as follows: </font></font><br><br><img src="https://habrastorage.org/webt/ut/ro/vu/utrovumo2_av2eefdvk_fetxrt0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Danger - above, we determined the danger of a threat based on the violated property of security. </font><font style="vertical-align: inherit;">Here we enter the desired hazard value based on what security properties this particular threat violates. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And finally - the relevance of the threat. </font><font style="vertical-align: inherit;">Determined by the table:</font></font><br><br><img src="https://habrastorage.org/webt/hd/vx/os/hdvxospkpdnkxvr0sfaziq-dysg.png" alt="image"><br><br>  Hooray!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Our threat model is ready. </font></font></div><p>Source: <a href="https://habr.com/ru/post/457516/">https://habr.com/ru/post/457516/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457504/index.html">Why write your React Data Grid in 2019</a></li>
<li><a href="../457508/index.html">Raising a child vs Machine learning: compares a young mother</a></li>
<li><a href="../457510/index.html">Use mcrouter to scale memcached horizontally.</a></li>
<li><a href="../457512/index.html">Logical replication between PostgreSQL versions</a></li>
<li><a href="../457514/index.html">Nevangary</a></li>
<li><a href="../457518/index.html">Plasma Cash Chain as a solution to the blockchain scalability trilemma</a></li>
<li><a href="../457520/index.html">Creating a 3-level menu using the Htmlix framework - part 2 mobile menu version</a></li>
<li><a href="../457522/index.html">Raise your mailing service or use ready-made solutions? What I learned for 5 years of work in UniSender</a></li>
<li><a href="../457524/index.html">Depth cameras - silent revolution (when robots see) Part 1</a></li>
<li><a href="../457526/index.html">Technical media as a bazaar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>