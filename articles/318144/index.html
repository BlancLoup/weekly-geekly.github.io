<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Lecture by Charles Moore, creator of Forth: 144-core processor, why? Is it difficult to program 144 cores?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The creator of the 144-core GA144 processor and the Forth programming language, the well-known programmer Charles Moore (Charles H. Moore), also known...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Lecture by Charles Moore, creator of Forth: 144-core processor, why? Is it difficult to program 144 cores?</h1><div class="post__text post__text-html js-mediator-article">  The creator of the 144-core GA144 processor and the Forth programming language, the well-known programmer Charles Moore (Charles H. Moore), also known as Chuck Moore, in his lecture talks about the prospects of using the 144-core asynchronous chip created by his company , GreenArrays, as well as its programming.  After all, its chip consumes only 7 pJ of energy (when performing the basic ALU instruction, which takes 1.5 nanoseconds), which makes it indispensable in cases when the processor can be powered only from an independent source of energy without the possibility of recharging, ranging from developments in medicine and ending with robotics.  Unused cores consume only 100 NW, while the active one requires only 4 milliwatts when processing 666 MIPS: a dense code minimizes the number of instructions to be executed, reducing the number of instruction samples, switching transistors and the duty cycle. <br><br>  Since the lecture has not been published yet, we published it for you on youtube: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zqNTxxO33sc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If someone will be able to make subtitles - write, add, we will be very grateful if someone finds time to do such important work. <br><br>  The processor itself <a href="https://geektimes.ru/post/133291/">went on sale in 2011, at a price of $ 20</a> .  In this publication, we tried to systematize the available information and fill in the gaps that may arise after reading the documentation from GreenArrays. <a name="habracut"></a><br><br><h3>  144-core processor, why? </h3><br>  If you need effective power management and high speed, the ability to create parallel energy-efficient applications for a wide range of tasks - the multi-core GA144 processor can provide you with this.  GA144 is an interesting tool for analyzing and modeling parallel data processing algorithms that are intended for use in homogeneous computing environments. <br><br><h3>  What makes the GreenArrays GA144 chip unique? </h3><br>  Here are some reasons to consider it as such: <br><br>  - it has 144, 18-bit kernels; <br>  - it is characterized by completely independent asynchronous cores, therefore it does not have a clock; <br>  - it is programmed in Forth and GreenArrays, which in turn provide colorForth, the version of arrayForth specifically for GA144; <br>  - its hardware capabilities for synchronizing tasks on different kernels and high speed of code execution; <br>  - the ability to programmatically set the functionality of I / O lines. <br><br>  But, despite the fact that there is a lot of relevant documentation on the programming of this chip, for some, getting started with it causes difficulties.  Online tutorials usually work for the old version of arrayForth and are not supported by new ones.  Basic information is distributed across all available documentation.  And if there is a desire to begin to work professionally with GA144, then you will have to carefully go through it all.  Think well before you start your experiments with him, there will be no quick result.  Especially if you need to program a chip with an IDE that looks like this: <br><br><img src="https://habrastorage.org/files/7f4/fa7/c07/7f4fa7c072a34006a1064178c0830cad.jpg"><br><br>  But do not worry, I will try to explain in this post how to write an example of the ‚ÄúHello World‚Äù standard and run it on the simulator, without really going into the details of the chip operation.  Most likely you already have some idea of ‚Äã‚ÄãGA144, Forth and its stack.  In addition, I recommend that you read the <a href="http://www.greenarraychips.com/home/documents/greg/DB004-131030-aFUSER.pdf">instructions in arrayForth</a> to get a basic idea of ‚Äã‚Äãwhat it is. <br><br><h3>  First start </h3><br>  If you did everything right and started arrayForth, you should see a similar window: <br><br><img src="https://habrastorage.org/files/e3f/4be/6fc/e3f4be6fcadd4ef0aa2af682bc3fceb9.jpg"><br><br>  You should know that it uses a special keyboard layout to enter various types and colors of syntax (hence colorForth).  On page 13, chapter 3 of the arrayForth user manual, you can find the layout used in the editor.  Before we start writing our ‚ÄúHello World‚Äù example, we need to know how the memory is organized, where we leave our code, which nodes which code block is executed, etc. <br><br><h3>  Memory organization </h3><br>  The memory in arrayForth is organized into 1400 blocks, some of them contain the software of the system itself, such as a compiler and a simulator, others contain code written by the user or simply empty.  A summary of how the memory blocks are organized can be found on page 18, chapter 4 of the arrayForth user manual, and a detailed description can be found in the file EVB001-02b.html, which is located in the installation folder. <br><br>  You can see that blocks from 840 to 1078 can be used to store user code.  Please note that even-numbered blocks may contain custom code, and odd-numbered blocks are used to store user comments. <br><br><h3>  Knot Layout </h3><br>  The GA144 chip consists of 144 F18 nodes in an 18 √ó 8 grid: <br><br><img src="https://habrastorage.org/files/76c/a77/b97/76ca77b975264b15b474008bcc10132a.jpg"><br><br>  Each node has an identifier that begins with 000 on the lower left node and ends 717 for the upper right node.  Each node is associated with neighboring nodes.  Extreme nodes have access to the outside, either directly or through peripheral devices such as UART, SPI, ADC, etc.  Therefore, you must carefully plan the location of your application. <br><br><h3>  "Hello World" </h3><br>  Now that we know a little about GA144, let's write our first piece of code that performs the following calculations: 3 (x + 1).  We will place our code in block 860, which is accessible to custom code. <br><br>  860 &lt;space&gt; edit &lt;space&gt; <br><br>  This command opens the editor and displays us an empty block: <br><br><img src="https://habrastorage.org/files/f0c/4cd/56e/f0c4cd56eba44c699a5fddfa00d6b81e.png"><br><br>  Enter the following command: <br><br> <code>&lt;u*&gt;0&lt;&gt;org&lt;&gt;&lt;esc*&gt;&lt;x*&gt;br&lt;&gt;&lt;esc*&gt;</code> <br> <br>  On the monitor you should see a similar picture: <br><br><img src="https://habrastorage.org/files/ef3/7e6/f5f/ef37e6f5f03048169d1da84d8b9740f0.jpg"><br><br>  If you know the assembler, then you should understand that the yellow part 0 org means that everything that will be entered further will be placed in the memory cell from 0 and above.  Blue br is an editor command that does not compile into the executable code, but rather tells the editor to add two new lines.  If it were cr, then only one new line would be added. <br>  Next, we define three words (functions): setup, calc, and mul. <br><br>  setup - will give the value of the variable x in our formula 3 (x + 1) and save it in the register. <br>  calc will extract the value in register a, add to it, and multiply it by three. <br>  Mul is a function that performs 18-bit multiplication, since the F18 node does not have a single multiplication command. <br><br>  Let's first compile the code for the mul function: <br><br> <code>&lt;i*&gt;mul&lt;&gt;a!&lt;&gt;0&lt;&gt;17&lt;&gt;&lt;esc*&gt;&lt;u*&gt;for&lt;&gt;&lt;esc*&gt;&lt;o*&gt;+*&lt;&gt;&lt;esc*&gt;&lt;u*&gt;unext&lt;&gt;drop&lt;&gt;drop&lt;&gt;&lt;esc*&gt;&lt;o*&gt;a&lt;&gt;;&lt;&gt;&lt;esc*&gt;</code> <br> <br><img src="https://habrastorage.org/files/9b1/e03/54e/9b1e0354e2b94e64a7ca5d7b2784157b.jpg"><br><br>  Next comes the calc function: <br><br> <code>&lt;i*&gt;calc&lt;&gt;a&lt;&gt;1&lt;&gt;+&lt;&gt;3&lt;&gt;mul&lt;&gt;;&lt;&gt;&lt;esc*&gt;</code> <br> <br><img src="https://habrastorage.org/files/643/a9d/cb7/643a9dcb7e964af58737de41772d72cf.jpg"><br><br>  The final setup function: <br><br> <code>&lt;i*&gt;setup&lt;&gt;4&lt;&gt;a!&lt;&gt;calc&lt;&gt;;&lt;&gt;&lt;esc*&gt;&lt;x*&gt;br&lt;&gt;&lt;esc*&gt;</code> <br> <br><img src="https://habrastorage.org/files/992/15f/c50/99215fc508024ed49e04ae2846e8c379.jpg"><br><br>  In this case, we have chosen x = 4, which will result in 3 (4 + 1) = 15 = 0x0F in hexadecimal.  We are almost done!  The last part of our ‚ÄúHello World‚Äù example is to make sure that the entry point of our program (setup) is called when the node is loaded with our code.  We can install it like this: <br><br> <code>&lt;u*&gt;&lt;F1*&gt;0a9&lt;&gt;&lt;F1*&gt;org&lt;&gt;&lt;esc*&gt;&lt;o*&gt;setup&lt;&gt;;&lt;&gt;&lt;esc*&gt;</code> <br> <br>  This gives us the last line of our code, and places the entry point to our code at 0xA9, where the installation will be called. <br><br><img src="https://habrastorage.org/files/fb2/a5a/b94/fb2a5ab94a664a98897d6074bab76792.jpg"><br><br>  Now press the spacebar to exit edit mode (you will see that at the bottom of the red 860 from the right side will turn gray).  We need to compile the code, this can be done by typing compile and pressing the spacebar.  You can also save the state of all 1400 blocks using the save function (save type and space). <br><br><h3>  Node configuration </h3><br>  So we wrote the code, but how do we put it in one of the nodes?  This is the part that is not affected if you view older documentation.  Block 200 contains instructions for downloading code from blocks to nodes.  This is exactly the place where we can download our code.  First you need to change all the instructions that are not white or blue to white.  You can do this by placing the cursor on the instruction / number and clicking until it turns pale. :) <br><br>  We will place the boot instructions after the first line. <br><br>  &lt;u *&gt; 400 &lt;space&gt; node &lt;space&gt; 860 &lt;space&gt; load &lt;space&gt; &lt;esc *&gt; &lt;x *&gt; br &lt;space&gt; &lt;esc *&gt; <br><br>  This line selects node 404 and loads block 860 into it. It looks something like this: <br><br><img src="https://habrastorage.org/files/aa3/45c/537/aa345c537f1849138508e588cec2d2c3.jpg"><br><br>  The reason we put all this in block 200 is because the softsim simulator, which is in arrayForth (blocks 148-150), initially sets up the simulator (block 148) and the application download code is stored in block 200 (block 150). <br><br>  You can repeat this step if you want to place the same block in another node (the same code runs in parallel), or if you want to load another block of code in another node.  If we started the simulator now, we would see that node 404 does not execute any code.  In order to make sure that the node will start the program counter, which indicates the correct entry point, we need to change block 216. This block contains the configuration and testsbeds for the simulator. <br><br>  Open block 216: <br><br> <code>216&lt;&gt;edit&lt;&gt;</code> <br> <br>  And add the following code before the line that starts with the comment ‚Äúrom write test 200 + node 13 / p,‚Äù: <br><br> <code>&lt;u*&gt;&lt;F1*&gt;0a9&lt;&gt;&lt;F1*&gt;404&lt;&gt;enter&lt;&gt;&lt;esc*&gt;&lt;x*&gt;br&lt;&gt;&lt;esc*&gt;</code> <br> <br>  Block 216 now looks like this: <br><br><img src="https://habrastorage.org/files/68a/8e3/44e/68a8e344e3784f6eb36c4a7fd14844dd.jpg"><br><br>  Now the correct entry point for node 404 has been set, we are ready to run our code in the simulator! <br><br><h3>  Running the simulator </h3><br>  Type softsim and press the spacebar to start the simulator. <br><br><img src="https://habrastorage.org/files/419/086/52d/41908652d8464450b984ae325f5c98a6.jpg"><br><br>  Page 33, chapter 7 of the instructions in arrayForth describes how the simulator works, but I will try to explain briefly. <br><br>  In the upper right corner, there is a 18 by 8 grid representing all the nodes of GA144.  A green symbol means a node that is running, gray means that the node is suspended.  If it were not for the modified block 216, as described above, node 404 (5th from the left and 4 above) would be gray, since our Hello World example would not work.  There are also red and yellow X, which represent the ‚Äúfocus‚Äù node and the ‚Äúother‚Äù node, respectively.  The bottom right corner shows the contents of the focal node memory.  If you press the "/" key, then in the upper right corner will be replaced by the contents of the memory of the "other" node.  This is useful if you have two nodes interacting with each other.  The left part of the screen displays the internal state of the nodes, the contents of the registers.  The selected grid 8 by 4 nodes is marked with a blue rectangle in the grid overview in the upper right corner, it can be moved to select the nodes whose internal state we want to know: <br><br><img src="https://habrastorage.org/files/8b4/227/9e7/8b42279e7e744d88b3659e7e10e2dfe4.jpg"><br><br>  Top down: <br><br><ol><li>  Node number (gray), COM port address (white) </li><li>  Slot number (white), opcode name (green) </li><li>  Command register (white) </li><li>  Memory timer (green), program counter (white) </li><li>  A, register (white) </li><li>  B, B register (white) </li><li>  IO, IO register (turquoise) </li><li>  R, top of the return stack (red) </li><li>  T, top of data stack (green) </li><li>  S, data stack (green) </li><li>  @ Represents the communication port that is used. </li></ol><br><br><h3>  Run our code </h3><br>  If you put a red X on node 404, and also set up a blue rectangle to include node 404, we can see what happens to the node on which we want to run our example: <br><br><img src="https://habrastorage.org/files/eb8/209/5c3/eb82095c3289437f97581e64971afbb0.jpg"><br><br>  By pressing n several times, we can see that node 404 executes our code: <br><br><img src="https://habrastorage.org/files/261/1f9/929/2611f9929b8f4d51bbfa4e3d5bba06a1.jpg"><br><br>  The following is a brief explanation of what happens in chronological order.  First, the memory address is indicated, and a numbered list of instructions is shown next to it, which correspond to the command slots (see F18 Technology document for more detailed and extensive additional information). <br><br>  0xA9 <br><ol><li>  Go to 0xA. </li></ol><br>  0xA <br><ol><li>  Put the value stored in 0xB (which is 4) on the stack. </li><li>  Store at the top of the stack in register A. </li><li>  Nop. </li><li>  Nop. </li></ol><br>  0xC <br><ol><li>  Go to 0x6. </li></ol><br>  0x6 <br><ol><li>  Put the value stored in register A on the stack. </li><li>  Put the value stored in 0x7 (1) on the stack. </li><li>  Perform addition. </li><li>  Put the value stored in 0x8 (3) on the stack. </li></ol><br>  0x9 <br><ol><li>  Go to 0x0. </li></ol><br>  0x0 <br><ol><li>  Store at the top of the stack in register A. </li><li>  Put the value stored in 0x1 (0) on the stack. </li><li>  Put the value stored in 0x2 (0x11 = 17) on the stack. </li><li>  Nop. </li></ol><br>  0x3 <br><ol><li>  Store at the top of the stack at the top of the return stack. </li><li>  Nop. </li><li>  Nop. </li><li>  Nop. </li></ol><br>  0x4 <br><ol><li>  Perform step multiplication. </li><li>  Go to the next instruction if the return stack is 0, otherwise return to the previous slot. </li><li>  Drop the value stored at the top of the data stack. </li><li>  Nop. </li></ol><br>  0x5 <br><ol><li>  Drop the value stored on top of the data stack. </li><li>  Put the value stored in register A on the stack. </li><li>  Return. </li></ol><br><br>  When the last instruction is executed, we can see 0xF or 15 in decimal on the top of the stack, which confirms that our example works correctly!  I hope this post will help fill in the gaps after reading the GreenArrays documentation. <br><br>  The article was published with the assistance of ua-hosting.company hosting provider.  Therefore, taking this opportunity, we want to remind you about the action: <br><br>  <a href="https://geektimes.ru/company/ua-hosting/blog/286660/">VPS (KVM) with dedicated drives (full-fledged analog of dedicated entry-level servers from $ 29) in the Netherlands and the USA free for 1-3 months for all + 1 month bonus for geektimes</a> <br><br>  Do not forget that your orders and support (cooperation with you) will allow you to publish in the future even more interesting material.  We would appreciate your feedback and criticism and possible orders.  ua-hosting.company - happy to make you happier. </div><p>Source: <a href="https://habr.com/ru/post/318144/">https://habr.com/ru/post/318144/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318132/index.html">Cloud Pricing: AWS vs Azure vs Google vs Cloud4Y</a></li>
<li><a href="../318134/index.html">How to sell a startup on Facebook in three months</a></li>
<li><a href="../318136/index.html">How to simplify working with IntelliJ IDEA: useful features for developers</a></li>
<li><a href="../318140/index.html">How companies will save in 2017: 3 effective ways</a></li>
<li><a href="../318142/index.html">Smart, easy and cross-platform C ++ code profiler</a></li>
<li><a href="../318146/index.html">Quake Live Server Setup - Step-by-Step Guide</a></li>
<li><a href="../318148/index.html">Fast course Redux + websockets for backend</a></li>
<li><a href="../318150/index.html">Poisson distribution and football betting</a></li>
<li><a href="../318154/index.html">Practical interpretation of the method and indicators of mastered volume</a></li>
<li><a href="../318158/index.html">Slow Cooker: load testing network services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>