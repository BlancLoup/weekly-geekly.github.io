<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The Pix2pix Neural Network realistically colors pencil sketches and black and white photos</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Four examples of the program, whose code is published in the public domain. The source images are shown on the left, the result of automatic processin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The Pix2pix Neural Network realistically colors pencil sketches and black and white photos</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/e3a/85a/a3e/e3a85aa3e3854d03b8a9b0f79d002d2e.jpg"><br>  <i>Four examples of the program, whose code is published in the public domain.</i>  <i>The source images are shown on the left, the result of automatic processing is shown on the right.</i> <br><br>  Many tasks in image processing, computer graphics and computer vision can be reduced to the problem of ‚Äúbroadcasting‚Äù one image (at the entrance) to another (at the output).  Just as the same text can be presented in English or Russian, so the image can be presented in RGB-colors, in gradients, in the form of a map of object borders, a map of semantic labels, etc.  Following a sample of automatic text translation systems, developers from the Berkeley AI Research (BAIR) laboratory at the University of California at Berkeley <a href="https://phillipi.github.io/pix2pix/">created an application</a> for automatically translating images from one presentation to another.  For example, from a black and white outline to a full color picture. <br><a name="habracut"></a><br>  To an uninformed person, the work of such a program will seem like magic, but it is based on a program model of <a href="">conditional generative adversarial networks</a> (cGAN) ‚Äîa variation of a known type of generative adversary networks (generative adversarial networks, GAN). <br><br>  The authors of the scientific work write that most of the problems that arise during the broadcast of images are related to the broadcast or ‚Äúmany to one‚Äù (computer vision - the translation of photos into semantic maps, segments, borders of objects, etc.), or ‚Äúone to many "(Computer graphics - translation of tags or input from the user in realistic images).  Traditionally, each of these tasks is performed by a separate specialized application.  In their work, the authors tried to create a single universal framework for all such problems.  And they did it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Convolutional neural networks, trained to minimize <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D1%2583%25D0%25BD%25D0%25BA%25D1%2586%25D0%25B8%25D1%258F_%25D0%25BF%25D0%25BE%25D1%2582%25D0%25B5%25D1%2580%25D1%258C">the loss function</a> , that is, the measure of the discrepancy between the true value of the parameter being evaluated and the parameter estimate, are great for broadcasting images.  Although the learning itself takes place automatically, it still takes considerable manual work to effectively minimize the loss function.  In other words, we still need to explain and show neural networks what exactly needs to be minimized.  And here lies a lot of pitfalls that negatively affect the result, if we work with the loss function at a low level such as ‚Äúminimize the Euclidean distance between the predicted and real pixels‚Äù - this will lead to the generation of blurred images. <br><br><img src="https://habrastorage.org/files/d58/31a/779/d5831a779b784020853d7e187e64cea8.jpg"><br>  <i>The effect of various loss functions on the result</i> <br><br>  It would be much easier for neural networks to set high-level tasks like ‚Äúgenerate an image indistinguishable from reality‚Äù, and then automatically train the neural network to minimize the loss function that best performs the task.  This is how generative competitive networks (GAN) work - one of the most promising areas in the development of neural networks today.  The GAN network teaches a loss function, the task of which is to classify an image as ‚Äúreal‚Äù or ‚Äúfake‚Äù, while simultaneously training the generative model to minimize this function.  There can be no blurry output at all, because they will not pass the classification test as ‚Äúreal‚Äù. <br><br>  The developers used conditional generative adversarial networks (cGAN), that is, GAN with a conditional parameter.  Just as GAN assimilates the generative data model, cGAN assimilates the generative model according to a certain condition, which makes it suitable for broadcasting images ‚Äúone to one‚Äù. <br><br><img src="https://habrastorage.org/files/118/d26/ac0/118d26ac08fb4a8f8a327a6de93a6762.jpg"><br>  <i>Streaming Cityscapes in realistic photos.</i>  <i>On the left is the markup, in the center is the original, and on the right is the generated image.</i> <br><br>  In the past two years, many GAN applications have been described and the theoretical basis of their work has been well studied.  But in all these works, GAN is used only for specialized tasks (for example, <a href="https://geektimes.ru/post/281826/">generating frightening images</a> or <a href="https://geektimes.ru/post/281714/">generating porn pictures</a> ).  It was not entirely clear how GAN is suitable for efficiently broadcasting ‚Äúone to one‚Äù images.  The main goal of this work is to demonstrate that such a neural network is capable of performing a large list of various tasks, showing quite an acceptable result. <br><br>  For example, the coloring of black and white pencil sketches (left column), on the basis of which the neural network generates photorealistic images (right column), looks very good.  In some cases, the result of the neural network seems even more realistic than a real photo (central column, for comparison). <br><br><img src="https://habrastorage.org/files/a56/27c/e1e/a5627ce1e9cb44c5a35271f697682659.jpg"><br>  <i>Broadcast pencil sketches into realistic photos.</i>  <i>On the left is a pencil drawing, in the center is the original, and on the right is the generated image.</i> <br><br><img src="https://habrastorage.org/files/7f5/e76/7b8/7f5e767b8fad4afabe9c13736a2e7210.jpg"><br><br><img src="https://habrastorage.org/files/ce6/06c/5d0/ce606c5d0c464d32aa65d9413c98ccc8.jpg"><br>  <i>Broadcast pencil sketches into realistic photos</i> <br><br>  As in other generative networks, in this GAN neural networks <a href="https://habrahabr.ru/post/278425/">are at war with each other</a> .  One of them (the generator) is trying to create a fake image to deceive the other (the discriminator).  Over time, the generator learns all the better to deceive the discriminator, that is, to generate more realistic images.  Unlike conventional GANs, in Pix2Pix, both a discriminator and a generator both have access to the original image. <br><br><img src="https://habrastorage.org/files/58f/c76/1a2/58fc761a293949c1ba10ab1bbfa4b318.png"><br>  <i>CGAN's training in predicting aerial photography using terrain maps</i> <br><br><img src="https://habrastorage.org/files/56a/95e/33f/56a95e33ffd84fa8a160fa4888ed7d11.jpg"><br>  <i>Examples of cGAN's work in broadcasting aerial photography to maps of the area and vice versa</i> <br><br>  The scientific article was <a href="https://arxiv.org/pdf/1611.07004v1.pdf">published</a> in open access, the source code of Pix2pix - <a href="https://github.com/phillipi/pix2pix">on GitHub</a> .  The authors offer everyone to experience the program. </div><p>Source: <a href="https://habr.com/ru/post/399469/">https://habr.com/ru/post/399469/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../399457/index.html">Russian FinTech Meetup # 2: Trading in the Era of Modern Digital Technologies</a></li>
<li><a href="../399459/index.html">Blackjack leakage protection with counters</a></li>
<li><a href="../399461/index.html">Artificial intelligence will help people get rid of phobias and fears</a></li>
<li><a href="../399463/index.html">Multicopters have learned how to sit down on the roofs of moving cars</a></li>
<li><a href="../399465/index.html">Kak2tak.tk: it means the idea was not so bad ...</a></li>
<li><a href="../399471/index.html">Space Housing, Part 5: How we will live on Mercury (or not)</a></li>
<li><a href="../399473/index.html">The Intel 4004 chip is 45 years old. A bit of IT history</a></li>
<li><a href="../399475/index.html">The Chinese are going to build a powerful solar power plant in the Chernobyl exclusion zone</a></li>
<li><a href="../399479/index.html">Rumor: Samsung is considering splitting Samsung Electronics into two companies and selling Lenovo's PC business</a></li>
<li><a href="../399483/index.html">The most popular games of his time, part 1: 1970s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>