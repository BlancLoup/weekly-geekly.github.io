<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Results and analysis of tasks online tour NeoQUEST-2014</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is time to sum up the online tour NeoQUEST-2014, including: 
 - parse all 7 tasks of the quest (for each day of the week!); 
 - tell about the winn...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Results and analysis of tasks online tour NeoQUEST-2014</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/342/d12/80a/342d1280ad1f68444d5576b9386da85c.jpg">  It is time to sum up the online tour NeoQUEST-2014, including: <br>  - parse all 7 tasks of the quest (for each day of the week!); <br>  - tell about the winners and their awards; <br>  - to tell what awaits the participants and guests of the event in the on-site tour NeoQUEST-2014, which will be held on July 3 in St. Petersburg at the Polytechnic University. <br><a name="habracut"></a><br><br><h4>  About the winners </h4><br>  "Gold", "silver" and "bronze" online tour received AV1ct0r, n0n3m4 and Dor1s, respectively.  The fight for the first place was very hot, for three days the leader was constantly changing - AV1ct0r and n0n3m4 pulled the first place from each other, and the difference between them was only a couple of points.  But then AV1ct0r passed the task about the ‚Äúfake citrus‚Äù and strengthened its leadership, breaking the lead by 113 points!  We cannot fail to note the will of n0n3m4 to victory and his undoubted talent (he completed the second most difficult task of the quest).  The ‚Äúbronze‚Äù prize-winner of Dor1s did not lag far behind the second place, but it realized a big lead over the following participants. <br><br>  Congratulations to the winners, they are waiting for the main prizes and a full-time tour, a victory in which will bring the winner a trip to one of the international hacker conferences!  AV1ct0r and n0n3m4 are awarded with smart watches from <a href="http://www.mobile-review.com/articles/2013/samsung-galaxy-gear.shtml">Samsung</a> and <a href="http://hi-tech.mail.ru/review/sony_smartwatch_2_rev.html">Sony</a> (and <a href="http://habrahabr.ru/post/216011/">here is</a> another interesting review on Habr√©), respectively, and Dor1s gets almost a three-kilogram <a href="http://wowwee.ru/robotics/robosapien808x">robot</a> , which is also not stupid!  By the way, all those who have completed at least one NeoQUEST-2014 task are also waiting for a small prize.  Since the standard ideas of memorable souvenirs (cups, notepads, flash drives, pens, chocolates, etc.) have already been exhausted, our souvenir will surprise the participants, but most likely, sooner or later they will use them!  We contact all winners.  Dear participants, check your mail for the presence of letters from info@neoquest.ru! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Analysis of tasks </h4><br>  NeoQUEST-2014 consisted of 7 tasks from various cybersecurity areas: <br>  1) ‚ÄúI don‚Äôt understand yours‚Äù - reverse engineering applications in C #; <br>  2) ‚ÄúHasta la vista‚Äù - reverse engineering Android applications; <br>  3) ‚ÄúTimeShift2.  Revenge "- a temporary attack on the RSA; <br>  4) ‚ÄúFreezed Computer‚Äù - getting the virtual memory of a virtual machine from a RAM dump; <br>  5) ‚ÄúUnknown smoking device detected‚Äù - analysis of a USB sync dump of an Android phone with a computer; <br>  6) ‚ÄúIgodrom‚Äù - use port knocking to play Pac-Man; <br>  7) ‚ÄúWould citrus live in the thicket of the south?  Yes, but a fake instance! ‚Äù- a task for reverse engineering, knowledge of DEP and ASLR bypass technologies, the basics of cryptography and the ability to exploit binary vulnerabilities. <br><br>  The tasks ‚ÄúUnknown smoking device detected‚Äù, ‚ÄúIgodrom‚Äù, ‚ÄúCitrus would live in the thickets of the south‚Äù will be discussed in detail in the May issue of the Hacker magazine.  In addition, our participants wrote a sufficient number of writeup'ov, in which you can read, as they went through this or that task.  <a href="http://nightsite.info/blog/13223-neoquest-2014-quals-writeup.html">Here is a</a> writeup from AV1ct0r, <a href="http://www.suslopas.pw/2014/03/neoquest-2014-ru.html">here</a> from n0n3m4 and from Dor1s. <br><br><h5>  1 - I don‚Äôt understand yours </h5><br>  The task was based on a technology that allows embedding C # applications into Internet sites.  Perhaps this is only if the site is written in asp.NET.  True, there are certain limitations.  Only Internet Explorer will be able to display the graphical shell of the applet, other browsers can only use the functions it exports. <br>  From the entire source data, the quest participant received only the IP address of the site, upon transition to which the following page was loaded: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/356/b89/e5c/356b89e5c1d294f34a4f612f5e231997.jpg"><br><br>  The page displayed the address of the user who visited the site, and still incomprehensible hieroglyphs.  The address, highlighted in white, hints that the site is not indifferent to the location from which the user enters it. <br>  If you enter the hieroglyphs displayed by the site into the <a href="http://translate.google.ru/">translate.google.com</a> service, you get this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/804/09a/bbb/80409abbbba7e9239d3e08d202f8b32b.jpg"><br><br>  The service automatically identified the language as Vietnamese, this should push the quest member to think that it is worth trying to visit the site through a Vietnamese proxy server.  Lists of proxy servers are freely available on many sites, for example, <a href="http://www.freeproxylists.net/ru/vn.html">here</a> . <br>  Using a Vietnamese proxy results in the desired result.  The participant is shown another version of the site with the task: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/886/0e3/9ef/8860e39ef90b8061a8424f18b598de7c.jpg"><br><br>  The user is presented with a form for data entry, but what should be entered there?  That is the question.  To do this, you need to delve into the source code of the page, then such an interesting piece is revealed: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/548/bd1/ec2/548bd1ec286d239ee76a5eef6d981449.jpg"><br><br>  The source of the page explicitly indicates the path to the C # applet.  But, as mentioned above, it is not displayed in any browsers except Internet Explorer.  This is what a site in IE looks like when using a proxy server: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/22c/b45/af7/22cb45af711686e15f367fb17462e18a.jpg"><br><br>  However, the task execution does not affect the display of the graphic part of the applet.  The buttons in its interface do not carry any payload. <br>  The further task of the participant is to study the source code of the applet.  Applications written in C # are fairly easy to decompile.  For example, you can use the .NET Reflector application.  Get the applet source code: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a2/505/19f/2a250519f60a374285c887c1dd3d651f.jpg"><br><br>  In a decompiled application, it is easy to find a class with the speaker name KeyStore.  It contains the key that must be entered into the form on the site. <br>  By the way, the key verification function is implemented in the applet as well.  Using asp.NET, it is invoked and checks the input information for correctness.  This functionality works in any browser.  Task completed! <br><br><h5>  2 - Hasta la vista </h5><br>  In the task, the participants received a certain file MyGreenManController.zip, when opened, it became clear that this is nothing more than an Android application (yes, in fact, the file name suggested): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bc1/5c7/04b/bc15c704b127f5486488961cddf34a3e.jpg"><br><br>  Participants needed to reverse this file.  This required to know what is an application for the Android operating system.  This is nothing more than an archive packed with a zip and having the extension ‚Äú.apk‚Äù.  This archive contains application resources, the AndroidManifest.xml file, which defines the application rights, its name, etc., and the classes.dex file.  The latter is a byte-code compiled for the <a href="http://ru.wikipedia.org/wiki/Dalvik_virtual_machine">Dalvik</a> virtual machine used in Android.  Getting the java source code out of it just won't work, but you can get a set of commands for the virtual machine - dalvik opcodes.  This method is not particularly suitable for analyzing applications, because there is another, simpler and more convenient, which consists in converting a dex-file into a jar, which can be decompiled and get quite readable java code. <br><br>  Reversing is reduced to obtaining the classes.dex file using the Apk Manager utility or a simple archiver.  Then, using the dex2jar utility, we get the classes.dex.dex2jar.jar file, which is very convenient to study using the jd-gui program. <br>  The entry point is the Code class: <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Code</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String aA = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle paramBundle)</span></span></span><span class="hljs-function"> </span></span>{ super.onCreate(paramBundle); setContentView(<span class="hljs-number"><span class="hljs-number">2130837504</span></span>); TextView localTextView = (TextView)findViewById(<span class="hljs-number"><span class="hljs-number">2130968577</span></span>); ((Button)findViewById(<span class="hljs-number"><span class="hljs-number">2130968578</span></span>)).setOnClickListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> View.OnClickListener(localTextView) { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> onClick(View paramView) { Code.aA = Code.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getApplicationContext().getFilesDir().getAbsolutePath(); String str = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AA().a(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.val$aaa.getText().toString(), Code.aA); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (str == null) Toast.makeText(Code.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getApplicationContext(), <span class="hljs-string"><span class="hljs-string">"Error"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>).show(); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!str.equals(<span class="hljs-string"><span class="hljs-string">"Correct command"</span></span>)); Toast.makeText(Code.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getApplicationContext(), <span class="hljs-string"><span class="hljs-string">"Correct command"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>).show(); A localA = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> A(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { localA.a((TelephonyManager)Code.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getSystemService(<span class="hljs-string"><span class="hljs-string">"phone"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception localException) { localException.printStackTrace(); } } }); } }</code> </pre> <br><br>  What does the Code class do?  When you click on the button, the path to the application is recorded in the aA variable (and yes, the same type of method and class names were made solely to confuse the quest participants): <br><br><pre> <code class="cpp hljs">Code.aA = Code.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getApplicationContext().getFilesDir().getAbsolutePath();</code> </pre><br><br>  Then the variable str is written to the result of executing method a from class AA. <br>  Method a is simple to the impossibility: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String paramString1, String paramString2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!paramString1.equals(<span class="hljs-string"><span class="hljs-string">"download_image"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; aa(<span class="hljs-string"><span class="hljs-string">"http://10.0.31.111/index.php"</span></span>, <span class="hljs-string"><span class="hljs-string">"neoquest_2014"</span></span>, paramString2 + File.separator + <span class="hljs-string"><span class="hljs-string">"neoquest_2014"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Correct command"</span></span>; }</code> </pre><br><br>  If a command other than ‚Äúdownload_image‚Äù is entered in the text field, null is returned, otherwise the aa method is called with the following parameters: <br><br><pre> <code class="cpp hljs">aa(<span class="hljs-string"><span class="hljs-string">"http://hastalavistababy.ru/index.php"</span></span>, <span class="hljs-string"><span class="hljs-string">"neoquest_2014"</span></span>, paramString2 + File.separator + <span class="hljs-string"><span class="hljs-string">"neoquest_2014"</span></span>);</code> </pre><br><br>  The aa method forms a string like: <br><pre> <code class="cpp hljs">¬´cmd=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;time=xxx&amp;command_name=download_image&amp;path=neoquest_2014¬ª</code> </pre><br><br>  And then it calls the getExampleInFile method, which saves the response from the server to the file: <br><br><pre> <code class="cpp hljs">getExampleInFile(<span class="hljs-string"><span class="hljs-string">"http://hastalavistababy.ru/index.php"</span></span>, cmd=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;time=xxx&amp;command_name=download_image&amp;path=neoquest_2014, /data/data/com.example.NeoQUEST2014/files/neoquest_2014);</code> </pre><br><br>  As a result, the file downloaded from the server will be in the files folder of our application.  Due to the fact that you can get this file on your phone only with root privileges, you should use the wget utility and download the file with the following command: <br><br><pre> <code class="cpp hljs">wget.exe http:<span class="hljs-comment"><span class="hljs-comment">//hastalavistababy.ru/index.php?cmd=1&amp;time=xxx&amp;command_name=download_image&amp;path=neoquest_2014</span></span></code> </pre><br><br>  What is this strange file?  This question will be answered by the Code class.  After downloading the file, the class A method is called with the TelephonyManager parameter: <br><br><pre> <code class="cpp hljs">A localA = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> A(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ localA.a((TelephonyManager)Code.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getSystemService(<span class="hljs-string"><span class="hljs-string">"phone"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; }</code> </pre><br><br>  Method a does the following: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TelephonyManager paramTelephonyManager)</span></span></span><span class="hljs-function"> throws Exception </span></span>{ StringBuffer localStringBuffer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuffer(); localStringBuffer.append(paramTelephonyManager.getDeviceId()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!paramTelephonyManager.getDeviceId().equals(<span class="hljs-string"><span class="hljs-string">"352276054393855"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; localStringBuffer.append(paramTelephonyManager.getSimOperator()); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!paramTelephonyManager.getSimOperator().equals(<span class="hljs-string"><span class="hljs-string">"25001"</span></span>)); localStringBuffer.append(aaaa(<span class="hljs-string"><span class="hljs-string">"neoquest_2014"</span></span>)); String str = aaaa(localStringBuffer.toString()); localStringBuffer.setLength(<span class="hljs-number"><span class="hljs-number">0</span></span>); localStringBuffer.append(str); aa(localStringBuffer.toString().substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>).getBytes()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Success"</span></span>; }</code> </pre><br><br>  First, it takes the phone ID and checks it for the line "352276054393855", and the carrier ID checks for the line "25001" and adds these strings to the localStringBuffer variable: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!paramTelephonyManager.getDeviceId().equals(<span class="hljs-string"><span class="hljs-string">"352276054393855"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; localStringBuffer.append(paramTelephonyManager.getSimOperator()); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!paramTelephonyManager.getSimOperator().equals(<span class="hljs-string"><span class="hljs-string">"25001"</span></span>));</code> </pre><br><br>  Then the string ‚Äúneoquest_2014‚Äù is added to the localStringBuffer variable: <br><br><pre> <code class="cpp hljs">localStringBuffer.append(aaaa(<span class="hljs-string"><span class="hljs-string">"neoquest_2014"</span></span>));</code> </pre><br><br>  Then the aaaa method is called with the parameter - the generated string.  This method considers hash using the MD5 algorithm: <br><br><pre> <code class="cpp hljs">String str = aaaa(localStringBuffer.toString());</code> </pre><br><br>  Next, the aa method with the parameter is called ‚Äî the first 16 bytes of the resulting hash: <br><br><pre> <code class="cpp hljs">aa(localStringBuffer.toString().substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>).getBytes());</code> </pre><br><br>  The aa method decrypts the downloaded neoquest_2014 file with the key consisting of the first 16 bytes of the same hash, and writes the result to the neoquest_2014_original file: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">aa</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte[] paramArrayOfByte)</span></span></span><span class="hljs-function"> throws Exception </span></span>{ SecretKeySpec localSecretKeySpec = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SecretKeySpec(paramArrayOfByte, <span class="hljs-string"><span class="hljs-string">"AES"</span></span>); byte[] arrayOfByte1 = IOUtils.toByteArray(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(Code.aA + File.separator + <span class="hljs-string"><span class="hljs-string">"neoquest_2014"</span></span>)); Cipher localCipher = Cipher.getInstance(<span class="hljs-string"><span class="hljs-string">"AES/ECB/PKCS5Padding"</span></span>); localCipher.init(<span class="hljs-number"><span class="hljs-number">1</span></span>, localSecretKeySpec); localCipher.init(<span class="hljs-number"><span class="hljs-number">2</span></span>, localSecretKeySpec); byte[] arrayOfByte2 = localCipher.doFinal(arrayOfByte1); FileOutputStream localFileOutputStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileOutputStream(Code.aA + File.separator + <span class="hljs-string"><span class="hljs-string">"neoquest_2014_original"</span></span>); localFileOutputStream.write(arrayOfByte2); localFileOutputStream.close(); }</code> </pre><br><br>  Thus, participants had to download the file to a computer (or from a phone, for lovers of perversions), and then restore the key and decrypt the downloaded file. <br><br><h5>  3 - TimeShift 2. Revenge </h5><br>  The task from the in-person tour NeoQUEST-2013, then no one could pass it.  We finalized it for an online tour, and this time many have coped with it. <br>  From the legend, we have two IP addresses with a port (213.170.102.196:4001, 213.170.102.197:4002) and a key B4365F2. <br>  Having established a connection with the first server and sending arbitrary data (for example, the netcat program), we get the answer: <br><br><pre> <code class="cpp hljs">ilya@debian:~$ netcat <span class="hljs-number"><span class="hljs-number">213.170</span></span><span class="hljs-number"><span class="hljs-number">.102</span></span><span class="hljs-number"><span class="hljs-number">.196</span></span> <span class="hljs-number"><span class="hljs-number">4001</span></span> hi —óAlert! Expected client hello message. Format: <span class="hljs-number"><span class="hljs-number">1</span></span> byte type NEOSSL_HANDSHAKE <span class="hljs-number"><span class="hljs-number">0x16</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> byte version NEOSSL1_VERSION <span class="hljs-number"><span class="hljs-number">0x01</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-number"><span class="hljs-number">-4</span></span> <span class="hljs-function"><span class="hljs-function">bytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(excluding header)</span></span></span><span class="hljs-function"> 5 byte data NEOSSL_CLIENT_HELLO 0x01 ---DEBUG INFO--- Ubuntu Release 10.04 </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lucid)</span></span></span><span class="hljs-function"> Kernel Linux 2.6.32-21-generic Memory 1001.9 MiB Processor </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Intel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(R)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Core</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TM)</span></span></span><span class="hljs-function"> i3 CPU Processing time 1471 cycles Processing threads - 1 thread Public-key cryptography algorithm - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RSA</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with Montgomery multiplication)</span></span></span><span class="hljs-function"> Symmetric-key cryptography algorithm - AES-128 </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(zero IV)</span></span></span><span class="hljs-function"> ------</span></span></code> </pre><br><br>  The host responds with an error message that contains the format of the expected message and debug information.  The server expects to receive a client hello message: {0x16, 0x01, 0x00, 0x01, 0x01}.  Of the 5 bytes, 4 is included in the message header, one (NEOSSL_CLIENT_HELLO) in the data. <br>  Check the second server. <br><br><pre> <code class="cpp hljs">ilya@debian:~$ netcat <span class="hljs-number"><span class="hljs-number">213.170</span></span><span class="hljs-number"><span class="hljs-number">.102</span></span><span class="hljs-number"><span class="hljs-number">.197</span></span> <span class="hljs-number"><span class="hljs-number">4002</span></span> hi Î§≤t! Expected server hello message. Format: <span class="hljs-number"><span class="hljs-number">1</span></span> byte type NEOSSL_HANDSHAKE <span class="hljs-number"><span class="hljs-number">0x16</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> byte version NEOSSL1_VERSION <span class="hljs-number"><span class="hljs-number">0x01</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-number"><span class="hljs-number">-4</span></span> <span class="hljs-function"><span class="hljs-function">bytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(excluding header)</span></span></span><span class="hljs-function"> 5 byte data NEOSSL_SERVER_HELLO 0x02 6 byte data RSA_WITH_AES_128_CBC 0x01 7-n bytes data Certificate ---DEBUG INFO--- Ubuntu Release 10.04 </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lucid)</span></span></span><span class="hljs-function"> Kernel Linux 2.6.32-21-generic Memory 1001.9 MiB Processor </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Intel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(R)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Core</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TM)</span></span></span><span class="hljs-function"> i3 CPU Processing time 1531 cycles Processing threads - 1 thread Public-key cryptography algorithm - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RSA</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with Montgomery multiplication)</span></span></span><span class="hljs-function"> Symmetric-key cryptography algorithm - AES-128 </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(zero IV)</span></span></span><span class="hljs-function"> ------</span></span></code> </pre><br><br>  The second host responds with a client hello message and waits for a server hello message containing the server certificate.  Thus, the first host performs the role of the server, the second - the client.  By sending their messages to each other and analyzing the error messages, you can understand the communication protocol. <br>  1. The client sends a NEOSSL_CLIENT_HELLO message. <br>  2. The server responds with a NEOSSL_SERVER_HELLO message, containing the secure connection parameters (RSA_WITH_AES_128_CBC) and a certificate. <br>  3. The client sends the NEOSSL_KEY_EXCHANGE message, containing the AES-128 session key encrypted by the server's public key. <br>  4. The server responds with NEOSSL_FINISHED. <br>  5. The client sends encrypted data. <br>  Encrypted data is also sent with a header and has the following format: <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> byte type NEOSSL_DATA <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> byte version NEOSSL1_VERSION <span class="hljs-number"><span class="hljs-number">0x01</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-number"><span class="hljs-number">-4</span></span> <span class="hljs-function"><span class="hljs-function">bytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(excluding header)</span></span></span><span class="hljs-function"> 5-n bytes data</span></span></code> </pre><br><br>  Since there is no client authentication in the scheme, you can try to send messages to the server, however, without knowing the protocol for further communication, this will not bring any results. <br>  You need to get the data that the client sends to the server in step 5.  You can try to generate a certificate and use it to establish a connection with the client.  However, the client checks the received certificate and does not accept the generated one.  Practically nothing is known about AES encryption (the key is different each time, the message probably also varies, and its content is unknown).  So, you need to hack RSA. <br><br>  You must obtain the server private key.  There is a server certificate (containing the public key) and access to the encoder (in step 3, the client sends the data, which the server decrypts and interprets as a session key). <br><br>  Among the attacks on RSA there is an interesting class of <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D1%2580%25D0%25B8%25D0%25BF%25D1%2582%25D0%25BE%25D0%25B0%25D0%25BD%25D0%25B0%25D0%25BB%25D0%25B8%25D0%25B7_RSA">attacks</a> associated with the implementation of encryption.  We are most interested in the attack on the execution time, because the debug information contains the time that the server spent on decrypting the message (and also the name of the task hints!).  Another thing about encryption is that it uses Montgomery multiplication to increase encryption speed. <br>  To unlock the secret key, you can use the attack described in the Harshman Singh article " <a href="http://cs.ucsb.edu/~koc/ns/projects/04Reports/Singh.pdf">Timing Attacks on software implementation of RSA</a> ".  The attack allows you to calculate one of the factors of the module n.  Opening the multiplier is performed bit by bit, starting with the higher bits.  For opening, requests generated from the current known value of the module are sent to the encoder and the time difference is calculated in case bit 0 or 1 is selected. If the difference is large, the zero bit is set, otherwise ‚Äúone‚Äù.  The first three bits of the multiplier with this need to guess.  After opening the multiplier, it is easy to calculate the server's private key. <br><br>  Next, having established a connection with the client, we will try to decrypt the session key and the message encrypted with the AES cipher.  The debug information says that the AES zero initialization vector is used.  Here is the message from the client: <br><br><pre> <code class="cpp hljs">To obtain the access to the missile control system send a message: <span class="hljs-string"><span class="hljs-string">"XXXXXXX:Connect"</span></span>. XXXXXXX - ID</code> </pre><br><br>  As the ID you need to use the value from the task - B4365F2.  You need to encrypt the string "B4365F2: Connect" using the session key and send it to the client.  Deciphering his next answer, we get a hash - f9e8ceee19e980bd68e3193d6d0de2d3, this is our key.  Task completed! <br><br><h5>  4 - Freezed computer </h5><br>  This task was devoted to the analysis of data dump memory, which was issued to participants in the form of a file size of 1GB.  The dump was obtained by simply copying the vmem file from a running and pre-configured virtual machine.  The peculiarity of the task was that inside one VMware virtual machine, from which the dump was provided, another virtual machine was created and started running under the Oracle Virtual Box.  The scheme of the task looked like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a3/080/551/0a30805512a063b581cdd0f6bee0d842.jpg"><br><br>  Both virtual machines were running the same versions of Windows 7, so the memory dump had two operating systems at the same time, the memory pages of which were heavily scattered across the dump.  NeoQUEST participants were required to find the key in the dump.  The presence of two virtual machines and the determination of their types was found quite easily by analyzing all the text strings in memory.  It is interesting to note that when using CMAT on the dump given to the participants, the program refused to work normally, while the Volatility Framework successfully coped with its work and found two operating systems at once. <br>  The winner of AV1ct0r used the <a href="https://code.google.com/p/volatility/">Volatility Framework</a> to solve this assignment, about which he wrote in detail in his blog.  Another feature of the NeoQUEST task was that the key that participants needed to find was only in the form of a graphic image in the video memory of the Virtual Box virtual machine.  Therefore, for the solution it was necessary to restore the video memory of this virtual machine.  There are two ways to solve this problem, because the RAM and the video memory of the Virtual Box are jammed simultaneously into the physical memory of the VMware virtual machine and into the virtual memory of the Virtual Box process with emulators (oddly enough, VirtualBox.exe). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bab/f1f/96f/babf1f96f9367475d539183004c02882.jpg"><br><br>  AV1ct0r solved the task using the memory dump of the VirtualBox.exe process, allocating video memory in it using the virtual address found in the logs and making a picture of it.  Getting the dump process was carried out by him with the help of the Volatility Framework.  Here is an algorithm for solving a task with getting the video memory of the Virtual Box virtual machine and generating a picture from it using the video memory mapping into the physical memory of the VMware virtual machine. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b6/85e/f39/2b685ef39cba62fb852dbb999e47aced.jpg"><br><br>  Step 1. Get all the readable strings from the memory dump of the VMware virtual machine using the strings.exe utility.  The file with the lines is impressive: 196 MB. <br>  Step 2. We learn that the Virtual Box virtual machine is running and we get a piece of the log from its launch with more detailed and necessary information: <br><br><pre> <code class="cpp hljs">:<span class="hljs-number"><span class="hljs-number">2013122720131228</span></span>: komsomol@file:<span class="hljs-comment"><span class="hljs-comment">///C:/Users/komsomol/VirtualBox%20VMs/KP-2/Logs/VBox.log 00:00:02.305000 00:00:02.305001 [/DBGF/] (level 1) 00:00:02.305002 Path &lt;string&gt; = "C:\Users\komsomol\VirtualBox VMs\KP-2/debug/;C:\Users\komsomol\VirtualBox VMs\KP-2/;C:\Users\komsomol/" (cb=103) 00:00:02.897225 HWACCM: TPR shadow physaddr = 000000003dd5f000 00:00:02.897227 HWACCM: VCPU0: MSR bitmap physaddr = 000000003dd67000 00:00:02.897229 HWACCM: VCPU0: VMCS physaddr = 000000003dd65000 00:00:02.897653 CPUMSetGuestCpuIdFeature: Enabled sysenter/exit 00:00:02.897655 HWACCM: 32-bit guests supported. 00:00:02.897656 HWACCM: VMX enabled! 00:00:02.897656 HWACCM: Enabled nested paging 00:00:02.897658 HWACCM: EPT root page = 000000003dd8b000</span></span></code> </pre><br><br>  From the log, we learn that hardware virtualization is enabled and that hardware support for nested paging page tables is enabled.  The latter means that Virtual Box configures EPT (Extended Page Tables) tables, which are then used by the processor to convert the physical addresses of the virtual machine to the physical addresses of the host machine.  In our case, the physical addresses of the Virtual Box virtual machine are offset in the dump file.  To learn more about the EPT format (and about the fact that it corresponds to PML4), you need to read the processor manual. <br>  The root table address is visible in the log and it is equal to 3dd8b000.  Like any translation tables, they use only physical addresses that correspond to the absolute offsets in the dump file, so it remains to read the video memory, which is also located in the physical address space of the Virtual Box virtual machine and mapped using EPT. <br>  Emulators of the VGA device (video adapter) use the host RAM to simulate the video memory for the virtual machine, and to directly draw the picture onto the screen, they simply copy the RAM into the host video memory periodically - just like the classic double buffering algorithm used in many graphics engines. <br>  Step 3. Find out the physical address of the video memory for the Virtual Box virtual machine. <br>  It is not in the dump, so in order to recognize it, it is enough to run the Virtual Box on your computer and see the value in the video adapter's tab (by the way, there is RAM in the dump): <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">02.305353</span></span> VRamSize &lt;integer&gt; = <span class="hljs-number"><span class="hljs-number">0x0000000001000000</span></span> (<span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">777</span></span> <span class="hljs-number"><span class="hljs-number">216</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span> MB)</code> </pre><br><br>  Step 4. Determine the format and size of the video image.  In video memory, graphic data is stored in a specific format, which is similar to the usual BMP format: RGBXRGBX bytes in series ... 3 or 4 bytes per pixel.  Screen resolution and bit depth we learn from the log: <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">14.565973</span></span> Display::handleDisplayResize(): uScreenId = <span class="hljs-number"><span class="hljs-number">0</span></span>, pvVRAM=<span class="hljs-number"><span class="hljs-number">065</span></span>c0000 w=<span class="hljs-number"><span class="hljs-number">800</span></span> h=<span class="hljs-number"><span class="hljs-number">600</span></span> bpp=<span class="hljs-number"><span class="hljs-number">32</span></span> cbLine=<span class="hljs-number"><span class="hljs-number">0xC80</span></span>, flags=<span class="hljs-number"><span class="hljs-number">0x1</span></span></code> </pre><br><br>  Step 5. Now you need to write a program that reads only the video memory from the dump.  To do this, the program should parse the page tables in the specified range (starting from the physical address 0xE0000000 with the length of the picture size 800 * 600 * 4).  The main part of the program code looks like this: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">DWORD </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TranslateGPA2HPA</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( DWORD gpa )</span></span></span><span class="hljs-function"> </span></span>{ vmxGuestPysicalAddress addr; addr.Value = gpa; vmxEPTP eptp; eptp.Value = EPT_base; DWORD64 pml4_base = (eptp.PML4ShiftedAddr &lt;&lt; <span class="hljs-number"><span class="hljs-number">12</span></span>); vmxEptPML4Entry pml4_ent; pml4_ent.Value = DumpRead64(pml4_base + <span class="hljs-number"><span class="hljs-number">8</span></span> * addr.eptPML4EntryOffset); DWORD64 pdpt_base = (pml4_ent.eptPDPTShiftedAddr &lt;&lt; <span class="hljs-number"><span class="hljs-number">12</span></span>); vmxEptPDPTEntry pdpt_ent; pdpt_ent.Value = DumpRead64(pdpt_base + <span class="hljs-number"><span class="hljs-number">8</span></span> * addr.eptPDPTEntryOffset); DWORD64 pd_base = (pdpt_ent.eptrfPDShiftedAddr &lt;&lt; <span class="hljs-number"><span class="hljs-number">12</span></span>); vmxEptPDEntry pd_ent; pd_ent.Value = DumpRead64(pd_base + <span class="hljs-number"><span class="hljs-number">8</span></span> * addr.eptPDEntryOffset); DWORD64 pt_base = (pd_ent.eptrfPTShiftedAddr &lt;&lt; <span class="hljs-number"><span class="hljs-number">12</span></span>); vmxEptPTEntry pt_ent; pt_ent.Value = DumpRead64(pt_base + <span class="hljs-number"><span class="hljs-number">8</span></span> * addr.eptPTEntryOffset); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (pt_ent.Shifted4KPageAddr &lt;&lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) | addr.eptByteOffset; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *data, DWORD gpa)</span></span></span><span class="hljs-function"> </span></span>{ DWORD offset = TranslateGPA2HPA(gpa &amp; (~<span class="hljs-number"><span class="hljs-number">0xFFF</span></span>)); fseek(g_fdump, offset, SEEK_SET); fread(data, <span class="hljs-number"><span class="hljs-number">4096</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, g_fdump); } <span class="hljs-function"><span class="hljs-function">HBITMAP </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadVideoMemory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( DWORD width, DWORD height, DWORD bpp )</span></span></span><span class="hljs-function"> </span></span>{ DWORD size = ((width * height * (bpp / <span class="hljs-number"><span class="hljs-number">8</span></span>) / <span class="hljs-number"><span class="hljs-number">4096</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>) * <span class="hljs-number"><span class="hljs-number">4096</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *bmp = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *)<span class="hljs-built_in"><span class="hljs-built_in">malloc</span></span>(size); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; size; i+=<span class="hljs-number"><span class="hljs-number">4096</span></span>) { ReadPage(bmp + i, <span class="hljs-number"><span class="hljs-number">0xE0000000</span></span> + i); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CreateBitmap(width, height, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>, bmp); }</code> </pre><br><br>  Declaration of structures can be found in the documentation for the processor.  The <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd183485(v%3Dvs.85).aspx">CreateBitmap</a> function can be found on the Internet. <br>  After compiling and running the program, the following image is obtained: <br><br><img src="//habrastorage.org/files/65b/6cc/116/65b6cc1165c94ce6b677a98280983ef8.jpg"><br><br>  Key found!  As a result, the task can be solved without the use of CMAT and Volatility Framework, using knowledge about the video memory device and virtualization technology. <br><br><h5>  5 - Unknown smoking device detected </h5><br>  According to the legend, the participants had to figure out what kind of incomprehensible device they ‚Äúsynchronized with the laptop‚Äù, to get the key from a file of an unknown format. <br>  AV1ct0r in his <a href="http://nightsite.info/blog/13223-neoquest-2014-quals-writeup.html">writeup</a> determined that this file is nothing but a dump of the USB traffic of an Android device, and quite correctly noted that it is most convenient to work with it in a HEX editor, and not in Wireshark. <br>  After analyzing the dump, we find the names of people, phone numbers and SMS-messages.  Remembering that important information can be stored in SMS, look for a hint and find: <br><br><img src="//habrastorage.org/files/e9b/56f/891/e9b56f8919a3493f965b84a780839a16.jpg"><br><br>  Information about the dates of birth was stored in a notebook, it began with VCARD, there were 4 pretenders for the role of wife.  The question remained open: what should open this password?  After a closer look at the dump, we find a file called look_at_this.7z.  Google signature 7z files: <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>A BC AF <span class="hljs-number"><span class="hljs-number">27</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>C</code> </pre><br><br>  Then there is nothing but to get the archive out of the dump and sort through the 4 previously obtained birth dates.  Inside the archive is a file win.txt with the key flag.  Task completed! <br><br><h5>  6 - Igodrom </h5><br>  In this task, participants were required to play the good old <a href="http://ru.wikipedia.org/wiki/Pac-Man">Pac-Man</a> , but in a special way, implementing a kind of <a href="http://en.wikipedia.org/wiki/Port_knocking">port knocking</a> . <br>  Initially - it was necessary to guess that the server accepts requests only with a tag.  By trial and error, using prompts from the server, coming from port 1898, the participant should finally receive this welcome message: <br><br><pre> <code class="cpp hljs">&lt;pacman gameid=<span class="hljs-string"><span class="hljs-string">"7e09d6f13c5fd6086e3cc374e2bb8857"</span></span>&gt; &lt;info message=<span class="hljs-string"><span class="hljs-string">'Hello, Mr. Struve. Waiting for you at the next congress. Your move. Use action "newstep" and node &lt;direction&gt; [UP, DOWN, LEFT or RIGHT]&lt;/direction&gt;; for step'</span></span> /&gt; &lt;/pacman&gt;</code> </pre><br><br>  It turns out that they are waiting for us at some incomprehensible next congress.  Now is the time to turn on the logic and put together piecemeal pieces of information: <br>  - port 1898; <br>  - Struve; <br>  - congress. <br>  Using the search engines, participants had to come to the conclusion that the port is the year of the CPSU Congress (or its earlier forms), and ‚Äúthey are waiting for us‚Äù at the 1903rd port.  corresponding to the date of the next congress.  It is also easy to find the dates of the CPSU congresses: <br><br><img src="//habrastorage.org/files/5c3/e7a/751/5c3e7a75125d4e2082e5895707fcead4.jpg"><br><br>  Now we are making a move to the correct port, and we receive a response from the server, encoded using Base64.  After decryption, we get a dump starting with the string "% PNG", and we understand that this is a PNG-picture.  Open the image - and here it is, Pac-Man! <br><br><img src="//habrastorage.org/files/4ff/f7a/78f/4fff7a78fd794c36877cb7482b3cf547.jpg"><br><br>  It remains only to pass the game!  After passing, we get a response from the server with the key: <br><br><pre> <code class="cpp hljs">&lt;pacman&gt; &lt;info message=<span class="hljs-string"><span class="hljs-string">"You Win! Key is 584cc0bdfb44ac2dc00ec03ae6a5d937"</span></span> /&gt; &lt;/pacman&gt;</code> </pre><br><br><h5>  7 - Would citrus live in the thickets of the south?  Yes, but a fake copy! </h5><br>  The most difficult task (it passed only AV1ct0r), which requires knowledge of reverse engineering, the basics of cryptography, DEP and ASLR bypass technologies, as well as the ability to exploit binary vulnerabilities.  Who wants to delve deeper - in the May issue of "Hacker" a large and detailed article on its passage. <br><br>  The following files were provided to the participant: <br>  1. atl110.dll; <br>  2. NeoQuestDocument.docx; <br>  3. NeoQuestActiveX.dll. <br><br>  The NeoQuestDocument.docx document loads ActiveX and the result of the launch is Decryption Error. <br>  The ActiveX module, implemented in the NeoQuestActiveX.dll binary file, contains a vulnerability in the EncryptedTextBlob property setter, which can be exploited and which allows to execute arbitrary code on the user's machine. <br>  As a result of the reverse engineering of NeoQuestActiveX.dll, we obtain the following algorithm for the operation of the EncryptedTextBlob property setter of the NeoQuestActiveX.dll ActiveX component: <br><br><img src="//habrastorage.org/files/56f/bba/585/56fbba585f97436f94b8a6ca18fa76fb.jpg"><br><br>  A little explain the algorithm of the words, in conjunction with the picture, this should clarify the plan of action. <br>  When setting the EncryptedTextBlob property, the setter is called.  It is passed a string, which, in turn, is decoded from Base64.  Next, the resulting byte array is divided into segments and the first two bytes are taken, containing the length of the second segment.  Then the second segment is copied to the stack 16-byte buffer.  This is where an error occurs and Word crashes if the length is more than 16. Using the memmove function, the memory is copied without checking the number of bytes copied. <br><br>  Then, in the case of the normal course of the program, the second segment of bytes is taken and parsed as the serial number of the certificate.  The certificate store is looking for a certificate with the specified serial number.  And if the certificate is found, the third segment is decrypted with the help of the CryptDecryptMessage function and as a result we have to get the key for the task to pass. <br><br>     ,       ,     .      NeoQuestDocument.docx    ¬´!!!Decryption Error!!!¬ª,   . <br>   ?     .   ,   . <br><br>          : <br> 1.  ,    NeoQuestActiveX.dll         ; <br> 2.        (  : ¬´ 213.170.102.198    ¬ª,      ); <br> 3.  ; <br> 4.     ; <br> 5.   NeoQuestDocument.docx      . <br><br>    .   WINWORD.exe  permanent-DEP  ASLR.     ASLR  ‚Äî NeoQuestActiveX.dll.       ,   ,        ROP-  .    ROP-    ()   ,      . <br><br>    ROP-  <a href="https://www.immunityinc.com/products-immdbg.shtml">Immunity Debugger'</a>     mona.py.  mona.py,   ROP-.   ROP-  payload.       shell_reverse_tcp (  ,           80- ),      IP-   .        Metasploit'. <br><br>   docx   ,  ¬´¬ª     Metasploit',      ,         NeoQuestDocument.docx.      .  Victory! <br><br><h4>   ‚Äî  ... </h4><br>           NeoQUEST     ‚Äî  ,       ().  ,  ,  -      ,    . <br><br>     ,  ,      , ‚Äî      NeoQUEST-2014 3   ! <b> !</b>          ,     - (   !),      ,        !      <a href="http://neoquest.ru/2014.php"></a> ! </div><p>Source: <a href="https://habr.com/ru/post/216373/">https://habr.com/ru/post/216373/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../216361/index.html">How I chose the smart watch: Omate TrueSmart vs ZGPAX S5</a></li>
<li><a href="../216363/index.html">Queue Server</a></li>
<li><a href="../216367/index.html">How we manage configurations in pics.io</a></li>
<li><a href="../216369/index.html">Fiber Channel Basics</a></li>
<li><a href="../216371/index.html">How to create cool products: two key principles from the company HubSpot</a></li>
<li><a href="../216375/index.html">Responsive design. Reaction to the light level</a></li>
<li><a href="../216377/index.html">About megapixels, number 41 and Jacques Fresco / UPD: added a demo video with zoom and comparison with a soap box at the request of readers</a></li>
<li><a href="../216379/index.html">Autonomous solar power station for cellular transponder. Leap into the unknown and what came of it</a></li>
<li><a href="../216381/index.html">Exchange of data arrays with external components 1C</a></li>
<li><a href="../216383/index.html">How did I highlight specific values ‚Äã‚Äãin a table in SAPUI5 (SAP MII)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>