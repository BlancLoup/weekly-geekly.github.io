<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cumulus Linux for the network in the data center</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The modern data center is markedly different from the traditional corporate network. Applications focus more on L3 switching instead of assuming that ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cumulus Linux for the network in the data center</h1><div class="post__text post__text-html js-mediator-article">  The modern data center is markedly different from the traditional corporate network.  Applications focus more on L3 switching instead of assuming that all connections are on the same subnet, more traffic goes ‚Äúhorizontally‚Äù than ‚Äúvertically‚Äù, etc.  Undoubtedly, the main difference is a gigantic scale. <br><br>  Thanks to virtualization, the number of network connections in the data center is estimated from tens of thousands to millions, whereas in the good old days there were only a few thousand.  The scale of virtual networks has long gone beyond the capabilities of traditional VLANs, the speed of reconfiguration has also increased by orders of magnitude.  In addition, the number of servers in a modern data center is such that the network equipment is needed a head more than in a traditional corporate network. <br><br>  The evolution of the network infrastructure went on as usual, from monolithic pseudo-OS via embedded QNX and VxWorks operating systems to the modern stage, when the OS is based on Linux or BSD, sometimes this image is launched in the virtual machine of the usual Linux distribution.  On the other hand, the management method refused to evolve; it is still a command line with a multi-level structure.  Difficulties add more and different syntax from different manufacturers, and often one in different models. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To summarize, the problem lies not in hardware, but in network operating systems.  Approaches to the solution were divided, the first path went to the northbound and southbound API approach (OpenFlow gained the most popularity), the second - to use Linux and its ecosystem.  In other words, the first option tries to add an advanced management API to existing OSs, the second one suggests switching to an OS that already has all the necessary features. <br><br>  In the <a href="http://habrahabr.ru/company/etegro/blog/227897/">previous article,</a> we talked about switches without a pre-installed OS. <br>  and the deployment environment for <a href="http://onie.github.io/onie/docs/overview/index.html">ONIE</a> . <br><br>  It's time to tell about one of the representatives of the second approach, which can be installed on our platforms - Cumulus Linux. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7de/b65/50a/7deb6550a340f1dde7a11446ac66fbc8.png"><br><br><a name="habracut"></a><br><br>  Cumulus Linux is not just based on Linux, as many are, this is Linux, so working with it is almost the same as normal. <br>  Linux server.  Completely standard applications are installed directly on the switch, if necessary, new utilities are developed <br>  without focusing on specific APIs, the usual tools for working with the network are supplemented with tools for building CLOS factories and automation. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/988/031/e30/988031e300a0a99a6b8b599e1c706aff.png"></a> <br>  <i>Architecture</i> <br><br>  <b>Installation and Monitoring</b> <br><br>  What does this look like in deployment?  Everyone is accustomed to the "boot by PXE, OS image deployment" approach, here is similar. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/6ba/304/307/6ba304307475907b410c0b0786d54ed3.png"></a> <br>  <i>Habitual approach</i> <br><br><ol><li>  The first download goes to ONIE, the process of searching for the source of the OS image is launched, the required image is determined in it and deployed to the switch. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b52/c10/762/b52c1076205773cf3d1d5e1edd327504.png"></a> <br>  <i>Training</i> </li><li>  The first boot in Cumulus Linux, the presence of configuration scripts is determined through option 239 DHCP.  If the response is a URL, then <br>  a script is requested for it, CUMULUS-AUTOPROVISIONING is searched for in it and the script is run as root.  Bash, Ruby, Perl, Python are supported. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/dbf/ba7/791/dbfba7791ecc857bd437ed51233148b2.png"></a> <br>  <i>Script search</i> </li><li>  The third step is a normal download to Cumulus Linux. </li></ol><br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/8b9/12b/488/8b912b488851b4a091ab0d4e6a2d6e57.png"></a> <br>  <i>Work mode</i> <br><br>  The first setup is complete, great.  What's next? <br><br>  And then you can use all the same tools as for servers. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/f55/602/c5d/f55602c5d01c09f188e6040575b12db1.png"></a> <br>  <i>Orchestration</i> <br><br>  In addition to existing tools, you can integrate any development that is already used in the company. <br><br>  Monitoring?  Ganglia, Graphite, collectd, net-SNMP, Icinga - install on the switch and collect data in real time. <br><br>  <b>The delights of automation</b> <br><br>  Linux not only has excellent management capabilities and clear APIs, but it also fits perfectly with the network model of a modern data center.  The control level is in user space and is separate from the packet processing level in the kernel.  The FIB (Forwarding Information Base) is located in the kernel, the RIB (Routing Information Base) is controlled from the user environment by the corresponding daemons, the basic capabilities of the network equipment and a number of advanced functions related to BGP are supported.  The current toolkit allows you to directly access interfaces, routing tables, there are mechanisms for notification of changes, etc. <br><br>  This database allows you to use your native Linux console, instead of specialized JunOS shells, NX-OS, and others.  The console is by its nature great for using chains of independent commands and using scripts. <br><br>  And the switch is perfectly automated! <br><br><ol><li>  Package and Process Management </li><li>  Configuration templates </li><li>  Monitoring automation </li></ol><br><br>  All this helps to customize L2 / L3 and simplify the life of the administrator. <br><br>  Another handy tool is the Prescriptive Topology Manager (PTM).  When the logical topology of the data center is defined, it is not an easy task to consume the cable management system, consuming a lot of time and effort.  PTM allows you to check the correctness of connecting cables in real time and specify the exact location to eliminate the error.  He uses the graphviz-DOT cabling plan (some companies already use it to create a plan) and compares it with the information obtained through the LLDP to verify that the cables are connected correctly. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/e6d/079/d56/e6d079d56dd46cd7c8c1adcd796eb1cc.png"></a> <br>  <i>Topology check</i> <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/cc4/813/6ea/cc48136ea67053b75e1a74d347662340.png"></a> <br>  <i>Comparison with LLDP data</i> <br><br>  <b>Integration examples</b> <br><br>  Software solutions for overlays limit the ability to control the hardware side of the network, not allowing to automate configuration and management, as well as complicate problem tracking.  Linux supports VXLAN, so it‚Äôs not a problem to develop agents for various network virtualization solutions.  Cumulus Linux can work as a hardware portal L2, allowing you to bypass the limitations of software solutions and maintain high switching performance (VXLAN tunnel endpoint (VTEP) is processed at the speed of the channel) while using all the advantages of VXLAN technology. <br><br>  Developed agents for PLUMgrid, Nuage Networks, Midokura, VMware NSX solutions. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/a8a/65c/562/a8a65c562fde95e78dd167432d8e5778.png"></a> <br>  <i>VMware Integration</i> <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/5fd/9ff/6ac/5fd9ff6acda548273044d60268c9faab.png"></a> <br>  <i>Integration with Midokura</i> <br><br>  <b>Network architecture</b> <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/17b/2a8/5d8/17b2a85d85caba3aaa49f4b1f08bf51a.png"></a> <br>  <i>Traditional network</i> <br><br>  The traditional network architecture includes kernel, aggregation and access levels.  Three levels - above the delay and there are a number of hereditary restrictions.  Such solutions are not suitable for modern data centers with high server density and significant cross-server traffic.  Protocols STP / RSTP / PVSTP, VTP, HSRP, MLAG, LACP are used.  In general, "so we were taught." <br><br><ol><li>  Orientation on L2. </li><li>  Static by nature - VLAN, poorly scaled when virtualized. </li><li>  Leans on crutches - MLAG, Trill, etc. </li><li>  Optimization for north-south traffic. </li><li> Low scalability - hundreds or thousands of connections. </li></ol><br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/3bf/edf/64e/3bfedf64e2bc4aaffb04a9aed793a30f.png"></a> <br>  <i>Modern network</i> <br><br><ol><li>  She is easier. </li><li>  Fewer proprietary protocols. </li><li>  Predictable delays. </li><li>  Horizontal Scalability. </li><li>  Orientation on L3. </li><li>  Great for virtualization and cloud environments with multiple ‚Äúowners.‚Äù </li><li>  Scalable to millions of connections. </li></ol><br><br>  <b>Weak spots</b> <br><br>  There are no ideal options, due to the orientation on the L3 environment, Cumulus Linux has several weak points. <br><br><ol><li>  The desire to build a L2 factory using MLAG, TRILL, Virtual Chassis, VLT, Chassis Stacking, etc. </li><li>  Work with Netflow </li><li>  Providers access switches with VRF, MPLS, VPLS, etc. </li><li>  QinQ </li><li>  Access switches with Port Security, complex QoS rules, 802.1x, PoE </li><li>  IS-IS, RIP, EIGRP routing protocols. </li><li>  Authorization by TACAS or Radius AAA (there is an alternative to LDAP). </li></ol><br><br>  Everything related to the traditional approach to building a network and providers are poorly compatible with the methods for building <br>  networks in a modern data center. <br><br>  <b>Summarizing.</b> <br><br>  Unlinking a hardware switch from the operating system allows you to take the next step to software-configured DDC.  The ability to select the OS allows you to focus on those features that are necessary and choose from several available options the best. <br><br>  The system becomes much more transparent, everything can be checked using the built-in Linux tools without being tied to specific vendor commands.  It also becomes possible to work with a router as with a server that has many network ports, just as at the beginning of the development of network equipment, a UNIX server with several ports.  Only in the modern case, all network operations are performed using ASIC, and the server part only manages. <br><br>  As usual, we have a lab with Cumlus Linux on the <a href="http://www.etegro.ru/configurator/network/eos220">Eos 220</a> switch available for inhuman experiments and preparation. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/fb7/c7a/acf/fb7c7aacf08436c9df382b534ea69603.jpg"></a> </div><p>Source: <a href="https://habr.com/ru/post/231533/">https://habr.com/ru/post/231533/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../231523/index.html">Binding session to server in nginx. Nginx-sticky-module</a></li>
<li><a href="../231525/index.html">We write on Kotlin for Android</a></li>
<li><a href="../231527/index.html">SERP Yandex and Google: Analyzing competitors, researching industries - advodka.com</a></li>
<li><a href="../231529/index.html">cool-old-term - good old terminal</a></li>
<li><a href="../231531/index.html">The evolution of search engine algorithms</a></li>
<li><a href="../231535/index.html">American scientists have created an air light guide, which repeatedly improves the propagation of a laser beam in the air.</a></li>
<li><a href="../231537/index.html">How to convince visitors of your site to buy a product using competitors? Part 1</a></li>
<li><a href="../231541/index.html">Swift Tutorial - iOS8 Application Development [Part 1, Hello World!]</a></li>
<li><a href="../231545/index.html">A small step for book publishing - a huge leap for crowdsourcing space</a></li>
<li><a href="../231547/index.html">CCNP Certification Routing and Switching Update</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>