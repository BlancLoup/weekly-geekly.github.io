<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VariFlight ADS-B - Flightradar in Chinese</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúFlightradar‚Äù, in some way, has become a household name, in effect replacing the concept of ‚Äúa site where you can watch aircraft in real time‚Äù . Altho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VariFlight ADS-B - Flightradar in Chinese</h1><div class="post__text post__text-html js-mediator-article"> <b>‚ÄúFlightradar‚Äù,</b> in some way, has become a household name, in effect replacing the concept of <i>‚Äúa site where you can watch aircraft in real time‚Äù</i> .  Although in fact there are several such large sites, and smaller projects are even more, but it is often possible to see in the media news about an aviation event with the phrase ‚Äúaccording to the Flightradar website‚Äù and a screenshot from another resource. <br><br>  On Habr√© there are a number of publications about radar sports, in which or in the comments to which not only the Flightradar is mentioned.  In this post, I‚Äôll talk about the Chinese air traffic tracking service and its <i>Chinese</i> ADSB receiver, which they send out for free. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ye/_h/7a/ye_h7atxvw-x1mhbzgc0dcj-0zm.jpeg"></div><br><a name="habracut"></a><br>  Radarspotting is quite an interesting activity to captivate a significant number of people.  Several articles on Habr√© pretty well describe the essence of the lesson: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <a href="https://habr.com/post/156477/">Plain and Radarspotting, or I am sick of aviation</a> </li><li>  <a href="https://habr.com/post/280454/">Step by step: Transmit data to flightradar24</a> </li><li>  <a href="https://habr.com/post/408003/">Flightradar24 - how does it work?</a> </li><li>  <a href="https://habr.com/post/334360/">How to keep track of identified flying objects with the Raspberry Pi</a> </li><li>  <abbr title="staked out a place for an article lying in the drafts and from where some illustrations are drawn into this article">Cheap and simple radarspot station</abbr> </li></ul><br>  The receiver receives, transmitted by airplanes, a signal at a frequency of 1090 MHz, decrypts it and sends it in some format.  For example: <br><br><pre><code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"updatetime"</span></span>:<span class="hljs-number"><span class="hljs-number">1537902225</span></span>,<span class="hljs-attr"><span class="hljs-attr">"UTC Time"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-09-25 19:03:45"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"anum"</span></span>:<span class="hljs-string"><span class="hljs-string">"TCETM"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"fnum"</span></span>:<span class="hljs-string"><span class="hljs-string">"KKK6944"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"position"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"long"</span></span>:<span class="hljs-number"><span class="hljs-number">30.66455078125</span></span>,<span class="hljs-attr"><span class="hljs-attr">"lat"</span></span>:<span class="hljs-number"><span class="hljs-number">39.351677</span></span>},<span class="hljs-attr"><span class="hljs-attr">"height"</span></span>:<span class="hljs-number"><span class="hljs-number">10005.06</span></span>,<span class="hljs-attr"><span class="hljs-attr">"speed"</span></span>:<span class="hljs-number"><span class="hljs-number">888.96</span></span>,<span class="hljs-attr"><span class="hljs-attr">"angle"</span></span>:<span class="hljs-number"><span class="hljs-number">130</span></span>},</code> </pre> <br>  This lesson is not only interesting, but has become the activity of several companies: <br><br><ul><li>  <a href="https://www.flightradar24.com/">Flightradar24</a> </li><li>  <a href="https://flightaware.com/">Flightaware</a> </li><li>  <a href="https://planefinder.net/">Planefinder</a> </li><li>  <a href="https://www.radarbox24.com/">AirNav Network Radarbox</a> </li><li>  <a href="http://www.avdelphi.com/track.html">AvDelphi network</a> </li></ul><br>  Few people think what they do for a living and how services like Flightradar work.  An example of this can be seen in ru.vikipedii " <i>public web service, allowing real-time monitoring of the position of aircraft in the air</i> ."  The article itself and the title give a false impression of Flightradar as a kind of entertainment service. <br><br>  In fact, having emerged in the early 2000s as a hobby, these companies quickly reached a payback period and increased their income every year.  For example, Flightaware, founded in 2005, became profitable already in 2006, earning more than $ 1M in the first 18 months, and showing an annual growth of 40-75%.  According to some resources, the annual income of Flightaware exceeds $ 9M, and Flightradar - more than $ 2M. <br><br>  If in Europe there is a Flightradar, in the USA - Flightaware, then in China there is a VariFlight.  In the same way, the service, which sells flight statuses, statistical data and archives of flights, performs analysis and forecasting for customers - organizations and individual clients. <br><br>  VariFlight own words: <br><br><pre> <code class="plaintext hljs"> &lt;meta name="description" content="VariFlight         .    ,      ,    .    ,     ,         ."&gt; &lt;meta name="keywords" content=" ,   ,  ,  ,  ,  ,  ,  ,  ,   ,  ,  ,  ,  ,  "&gt; &lt;meta property="og:url" content="http://www.variflight.com/ru/"&gt;</code> </pre> <br>  Companies trade data, both their own and those received, for example, from the US Federal Aviation Administration.  But the greatest profit can be obtained from its own receivers, the operation of which the company does not cost anything because  they are installed by radarspot enthusiasts, you only need to spend money on manufacturing and shipping.  Therefore, at some point companies began to sell and send their receivers for free.  Free of charge to where the company does not yet have coverage with its network of receivers and from where there is no data. <br><br>  The cost of the data justifies the ‚Äúfree‚Äù distribution of receivers (note the text below the table - the receiver remains in the ownership of Flightaware, formally rented out for free). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xt/_s/fo/xt_sfoqxfdfzr7yl8cex0omn2eu.png"></div><br>  By 2015, Flightradar had more than 8,000 active receivers in the network, Flightaware had about 4,500. But Flightaware began distributing receivers two years before, and Flightradar had built its network for almost a decade by that time.  At <a href="https://flightaware.com/adsb/">this time</a> in the Flightaware network more than 15,000 receivers.  Flightaware receivers software is constantly being upgraded to this and FMSDATA, FMSWX. <br><br>  Location map of receivers in March 2017: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ec7/7cb/81b/ec77cb81ba574463aacc88bbbe2180e2.png" alt="image"></div><br>  Orange - free-of-charge Flightaware receivers, white - homemade receivers, red - <a href="http://www.coaa.co.uk/planeplotter.htm">PlanePlotter</a> paid program. <br><br>  This coverage of the Flightaware receiver network in December 2015: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ib/rc/mv/ibrcmvzeioalsr24lc9rrqu9hmi.png"></div><br>  And in March 2017, the Flightaware receivers network (the <a href="https://ru.flightaware.com/adsb/coverage">current state at the offsite site</a> ) provided such coverage: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fd7/44e/65d/fd744e65db8e464c8466c7d0618cfe6f.png" alt="image" width="600"></div><br>  It is not always possible to install receivers, so in 2018 the data of ground receivers are supplemented with data from the Iridium NEXT satellites - <a href="https://habr.com/post/370247/">‚ÄúFor the first time, it will be possible to continuously track aircraft anywhere in the world</a> . <a href="https://habr.com/post/370247/">‚Äù</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e5/kj/4i/e5kj4iu27uca4hwemcagg3mte4c.gif"></div><br>  Gray Blue - Iridium NEXT satellite data.  Green and yellow (the latter is <a href="https://habr.com/post/250813/">MLAT</a> ) are ground receiver data. <br><br>  The radius of the zone covered by one station is limited by the curvature of the Earth‚Äôs surface and the obstacles covering the horizon, and is no more than 450 km at best.  And in the "usual case" about 150 km.  With rare <a href="https://habr.com/company/mailru/blog/400497/">tropospheric passages</a> for this radio frequency, it is possible to look beyond the horizon.  An example of the zones of maximum coverage of stations broadcasting on <abbr title="planeradar.ru/virtualradar/">Planeradar.ru:</abbr> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/d6/hg/u2/d6hgu2xf1c6ypsg6tn3knl-fc8c.png"></div><br>  The sharp peaks in the reception diagrams are just isolated cases of reception at very large distances. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ln/ux/ly/lnuxlyvtt9lgjwqh8s4drhq_wua.jpeg"></div><br>  The animation below shows the need to send receivers.  Outside the EU / US, this hobby is not very popular.  There may be a reason for the cost of a hobby, and this map indirectly indicates the level of welfare, technical education, population density in the region.  Perhaps it is of practical interest - users transmitting data from their receivers receive a free <a href="https://flightaware.com/commercial/premium/">Flightaware corporate account</a> , worth $ 90 per month. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rv/pi/iy/rvpiiyuijvmsb-ewvntooqfzbn4.gif"></div><br>  And so the situation is outlined.  The market for this service is growing, the market needs more data and VariFlight has also begun to deploy its network.  In April 2018, the company VariFlight announced that it is looking for volunteers to accommodate free equipment.  An example of such a message in the post on <a href="https://www.instagram.com/p/BhfmzKGHZDy/">Instagram</a> . <br><br>  And in August, I came across this offer for free to order a receiver via the link <a href="http://flightadsb.feeyo.com/index/adsb%3Frecommender%3DMTg4OTU2MjE5MDU%26lang%3Den%26fbclid%3DIwAR0aetWVIkwlPyFGIv5gy3COMh0uAzSd-tNywRTL1fgFfstBhNAwTXSqkCs">http://flightadsb.feeyo.com/index/adsb?lang=en</a> .  After studying the site, I noticed that the company is looking for voluntary network participants in countries near the borders of China.  And having filled out the questionnaire, I did not particularly expect that the SFD is in the area of ‚Äã‚Äãthe company's interests. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jq/tk/gn/jqtkgnxt7ufd9rbhiafof8wbl0e.png"></div><br>  In the application itself you need to indicate on the map the installation location ( <i>Installation Location</i> ), the antenna installation floor on the building ( <i>Floor of Installation</i> , for example, 7/9 - the 7th floor of a 9-storey building), the nearest airport code ( <i>Airport code</i> - I indicated the IATA code) and upload photos of the horizon from the <i>Installation Environment</i> .  The rest is almost identical to the order on Aliexpress, except for the items Title, Nationality, Occupation, Company.  Filled in English with full name. <br><br>  After a couple of weeks, checking the mail, I found two <b>emails</b> from <b>ADSB Â±ïÁ§∫ Á≥ªÁªü (Display system of ADS-B)</b> stating that the application was approved almost immediately and that the package had been rushing to me for a long time, having already passed the customs at that time. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zn/qc/jj/znqcjjlrquqas4qt8bliader-6q.png"></div><br>  In the second letter were the login, password and track number of the parcel.  And also the instruction that I did not notice and read when ... you know yourself, when they usually read the instructions. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/tg/3p/qktg3pugddffvb9lzbf0v4kcrka.png"></div><br>  Login matched the name in the application, and the password is clearly sent the same to everyone.  Therefore, we go and change the password immediately (and login if required). <br><br>  In general, the phrase ‚ÄúThis is some kind of nonsense‚Äù from the Sudden-strike game appeared more and more often in my head, if anyone remembers how the Germans in the game with accent speak Russian.  Sometimes quiet, sometimes loud. <br><br>  By the way, the profile was the only page in English, then everything will be in Chinese.  On Habr√© <a href="https://habr.com/ru/users/wtigga/" class="user_link">wtigga</a> published an excellent article about the Chinese Internet, <a href="https://habr.com/post/370659/">‚ÄúChinese Internet and software: about sore‚Äù</a> .  I felt all the pain just now.  If you have not read, then it's time to prepare. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1k/oi/ay/1koiayqeuae_alsvu_yxcqrheug.png"></div><br>  The Google Chrome browser with the translation function will help to work on the site, but many pages that were not always feasible for it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tq/nm/yg/tqnmygwscpsyjyuskdb0iny0oyq.png"></div><br>  Places will be funny phrases. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5a/xw/-2/5axw-2211tuxsg4zqbgh1hyhoyg.png"></div><br>  And so we log in with the data from the second email. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ni/cb/jd/nicbjd2losvkfsgprjxppsloyx8.png"></div><br>  And go to the item <a href="http://flightadsb.feeyo.com/user/me">Personal information</a> .  As it turned out, Google Chrome cannot always translate the page or it does not succeed the first time, and in this case, after a series of automatic translation attempts, I had to copy the text into Google Translate.  Therefore, I post a hint for those who encounter the same problem. <br><br>  The page has two tabs, the active of which is marked with a red line.  At first you can not touch anything. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-s/sr/xy/-ssrxyi8w0fjdrs13rpzod_hgtg.png"></div><br><ol><li>  Full name </li><li>  Your phone number </li><li>  Your email </li><li>  Airport code </li><li>  Name of your ADSB receiver </li></ol><br>  QQ item is a <a href="https://ru.wikipedia.org/wiki/Tencent_QQ">Chinese Tencent QQ messenger</a> . <br><br>  On the second tab, change password <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gd/no/n-/gdnon-flkgykpprdisx-ghcztlu.png"></div><br><ol><li>  Old Password </li><li>  New password </li><li>  Repeat new password </li></ol><br>  With the exception of this, automatic translation almost always works.  The sitemap design is very close to the Flightradar site and the ‚Äúfeatures‚Äù of the translation do not make it difficult to use. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ti/rv/zz/tirvzzf2wwbat2fvqm-xfgv0qxe.png"></div><br>  A detailed examination of the service differs, for example, an <a href="http://map.variflight.com/heat">interesting functionality</a> that Flightaware does not have - a <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D0%25BF%25D0%25BB%25D0%25BE%25D0%25BA%25D0%25B0%25D1%2580%25D1%2582%25D0%25B0">heat map</a> , translated by Google Chrome as ‚Äúthermal analysis‚Äù. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tq/xn/oh/tqxnoh__qsuaa1pzvnmra5husrs.png"></div><br>  An interesting feature of some flights: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jl/kf/fu/jlkffukwq0xrwfd931hqwvuoyk0.png" width="100"></div><br>  Probably there is no information about the airports of departure and landing of this flight. <br><br><h2>  <font color="#cc0000">Package and receiver overview</font> </h2><br>  By track number the parcel was sent on September 6 and received on September 18.  The box has solid dimensions that surprised post office workers.  On the way from the post office inside, something thundered, tinkled and rolled. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ea/nj/yj/eanjyj4bgyexd-nasadkur7prvu.jpeg" width="400"></div><br>  The open box was somewhat surprised by the lack of packaging materials. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fk/q_/xl/fkq_xlageyzym4psi5huluhuo5o.jpeg" width="400"></div><br>  For comparison, the box at the receiver Flightaware. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ko/jp/vz/kojpvzknaatsndykd2qfmz77ng4.jpeg"></div><br>  Surprisingly, the contents of the box did not seem to suffer.  Only on the antenna there was a scratch - the film was torn off. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iz/j5/37/izj537mwxv512fiw6em5b3u0nks.jpeg" width="400"></div><br>  The receiver itself has the inscription only two connectors - power and HDMI.  In addition to two, all connectors are on one side.  LAN, 2 USB ports, four-pin connector (assumption that this serial interface was confirmed by a dial tone on the BCM 14 (8 pin TXD / Transmit), <br>  BCM 15 (10 pin RXD / Receive)), 5 volt power supply and SMA (female) antenna connector. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xo/c9/dn/xoc9dnespvqq3r1f2frwjjs7zay.jpeg" width="400"></div><br>  On the opposite side, behind the two holes in the housing, are green and red LEDs.  And next to the sticker with the "serial number" of the receiver, recorded by hand.  Also, the receiver has HDMI and microUSB. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e_/8j/zv/e_8jzvvbk2_bp1nt46icd1uijke.jpeg" width="400"></div><br>  The cover of the receiver has two ears for mounting on the wall, which positively distinguishes it from almost the same case of the Flightaware receiver, which the manufacturer provided for only four silicone feet at the bottom. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bq/iw/af/bqiwafgqodhiap_-hdd3ipizm3s.jpeg" width="400"></div><br>  Test the ability to use these two ears for mounting the receiver: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qw/9f/pg/qw9fpg1gij5ndga6urbayxv2qle.jpeg" width="400"></div><br>  Flightaware Flightfeeder upside down: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lf/4s/wx/lf4swxpj43wvnjxbfsqu5rd2gom.jpeg" width="400"></div><br>  To compare receiver sizes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nr/bv/zr/nrbvzre_u9jhgkzusug0jqtgk1w.jpeg" width="400"></div><br>  The natural question is "what's inside?"  Removing the cover, fixed with 4 screws, we see this layout. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/40/qq/k9/40qqk99d-ac9ppuikahdjmic7oc.jpeg" width="400"></div><br>  The connectors are on a separate receiver board, made in the form of an expansion card for the Raspberry Pi 3 Model B V1.2. <br><br>  For comparison, a photo Flightaware Flightfeeder (G6) without a cover.  This generation of receivers sent out until about 2017.  Built on RPi 2 Model B v.1.1 and mode-receiver-decoder <a href="http://www.modesbeast.com/scope.html">mode-S Beast</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ko/ya/4e/koya4exme2bh95occfbtkdb7wx8.jpeg" width="400"></div><br>  The reverse side of this design hid an unexpected element.  Surprise is a massive radiator located on the bottom side of the board.  The need for it is incomprehensible (after a week, I think this is a ‚Äútropical design.‚Äù In my conditions, the radiator is slightly warm). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/t9/2o/le/t92ole4een-gqivnp2ksqweixqi.jpeg" width="400"></div><br>  Additionally, the expansion board is connected to the RPi with a four-wire connector with three wires soldered to test points PP27 (USB VCC), PP44 (USB D-), <br>  PP45 (USB D +). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/he/vc/ui/hevcuirbhsyjqagyrtsie2n9kuy.jpeg" width="400"></div><br>  Those.  nothing can be plugged into the top right USB connector.  Therefore, in the photo of the case placed above, it can be seen that of the two paired USB connectors, the slot in the case is just opposite one that is closest to the LAN. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8l/vs/xf/8lvsxfznp3keyqhthe4cnq7lh4u.jpeg" width="400"></div><br>  Flightaware did the same, soldering the receiver to the pins of one of the connectors. <br><br>  Most of the expansion card takes a metal screen.  Of the visible parts of the connectors on the same side, and on the opposite two indicators and some "coil" with taps.  Reminds shunt with variable resistance.  Perhaps <a href="https://habr.com/ru/users/1div0/" class="user_link">1div0</a> , the author of the article <a href="https://habr.com/post/395625/">‚ÄúWhy bend tracks?‚Äù</a> Knows what it is.  During normal operation of the receiver, the green LED is on.  In what cases it is lit red - I do not know.  Not yet watched its inclusion. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k5/nx/ul/k5nxuli9peb2vtru9ktvvlkqm44.jpeg" width="400"></div><br>  On the side of the connectors there are power connectors and antennas, and a four-pin connector of unknown purpose. <br><br>  All electronics are hidden under a large tin screen cover.  The Flightaware Flightfeeder receiver board is not shielded.  On the Flightaware forum, the developers answered this question that the metal case of the receiver itself is sufficient to protect against external interference. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dr/sw/w9/drsww9uvadqiqaagbhk99ibhatg.jpeg" width="400"></div><br>  An attempt to look under the screen was a success from the second approach.  The lid broke off and turned out ... <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/wy/a_/1q/wya_1qu4awvmsaop9eulebq8o7e.jpeg" width="400"></a> </div><br>  ... as it turned out, everything was in vain - marking with chips was carefully cut down. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/eg/hc/38/eghc38dwf3d24o6hqmzrznpchoi.jpeg" width="400"></div><br>  Looking ahead, I‚Äôll say that it turned out to be an almost ordinary RTLSDR receiver - <a href="https://habr.com/post/149702/">RTL2832U DVB-T</a> (0bda: 2838), called ‚Äúdongles‚Äù, ‚Äúwhistles‚Äù, and which are devoted to several articles on Habr√© that give an idea of ‚Äã‚Äãthese devices and how they have simplified and cheapened the implementation of the reception and processing of radio signals on computers.  For example: <br><br><ul><li>  <a href="https://habr.com/post/149702/">USB TV tuners on rtl2832 - or how to hear everything on the radio for 600 rubles</a> </li><li>  <a href="https://habr.com/post/373465/">Once again about receiving HF on RTL-SDR</a> </li></ul><br>  In the latter, the background is well described: <br><blockquote>  The release of the RTL2832U chip for DVB-T digital television receivers did not promise any sensation, because Realtek was already somewhat late with its release.  In 2010, the more progressive DVB-T2 standard with more efficient coding of information was already being introduced, so the new product did not attract much attention.  For two years, cheap USB tuners at its base were used for their intended purpose, until at the beginning of 2012 some technical information about the operating modes of this chip leaked.  It turned out that for receiving analog (FM) and digital (DAB) radio in the VHF band, this chip uses the principle of software decoding of a previously digitized frequency band from the air.  Those.  roughly speaking, it digitizes the high-frequency signal from the antenna input, and filtering of a specific carrier and its detection (allocation of useful information) from the received digital stream is left to the central processor.  Obviously, this was done for reasons of economy, in the same way as at the time of sunset Dial-UP, extremely cheap ‚Äúsoft modems‚Äù received widespread distribution, which also represented only an advanced pair of DAC + ADC, and all signal processing was performed by CPU in thread with the highest priority. </blockquote><br>  Unlike the ‚Äúregular tuners‚Äù that I have, this instance of usb id 0bda: 2832 also has a 17-digit serial number. <br>  <b>Bus 001 Device 005: ID 0bda: 2832 Realtek Semiconductor Corp.</b>  <b>RTL2832U DVB-T</b> <br>  <b>Found Rafael Micro R820T tuner</b> <br>  Those.  analogue to the "blue whistle" used to create homemade ADSB receivers.  In the photo is the receiver on OrangePI. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8v/h2/2x/8vh22xmude7pxxexaxkiqbupdjw.jpeg" width="400"></div><br>  Assembling the receiver back, set the radiator just in case.  Bought specifically for the revision of routers and other home equipment. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i8/r2/rq/i8r2rqvr2yriumcf8x_n8kk0gwg.jpeg" width="400"></div><br>  Power supply 5V 2A.  It looks more solid than the power supply for Flightaware Flightfeeder.  But with a Chinese plug ... I tried to remember where my adapter was lying around. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/aj/lc/l5/ajlcl51jfqqhg0trs2xaykrva-u.jpeg" width="400"></div><br>  In a box of white cardboard turned out to be such a pretty velvet bag. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/di/w7/zy/diw7zywbjqf1oadipbx68qxsajq.jpeg" width="400"></div><br>  "... in the chest - a hare, in a hare - a duck, in a duck - an egg, in an egg - a needle ..." <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bi/mh/jb/bimhjbyxhtpskqn8qppiebop1t4.jpeg" width="400"></div><br>  Inside was a puzzle of three adapters that solved the question "where is my adapter lying around." <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jw/2j/bm/jw2jbm8zmoxzdfkp2xh6l4giapk.jpeg" width="400"></div><br>  The CA-23RP 2.5GHZ 400W Made in Japan lightning arrester appeared in a brown cardboard box.  I am not aware of this configuration of other ADS-B receivers.  Very reasonable for protection against low power accidents. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xd/vj/3i/xdvj3iho-lnma7j8xsdyxc6ltko.jpeg" width="400"></div><br>  The indoor antenna is likely to test the receiver without installing an external antenna.  Not suitable for practical use.  But it is sold on Aliexpress / Ebay as an ‚ÄúADS-B antenna‚Äù, but its current purpose is given on a magnetic inscription.  I caught airplanes on this antenna no further than within a radius of 30-40 km. <br><br>  Near adapter N (female) - SMA (male).  Perhaps a gift in the event of a filter or low-noise amplifier. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/aq/lo/6w/aqlo6wt-ekzwdj5gi2lz1peqeyc.jpeg" width="400"></div><br>  Coaxial cable for antenna 5 meters with N and SMA connectors, and twisted pair 10 meters ("100% oxygen-free copper, blablabla"). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iv/wb/fu/ivwbfuae7vic79oosq7ycp5gyds.jpeg" width="400"></div><br>  Antenna cable marked KOPA PLESS RG400-KF MIL-C-17.  Googling <a href="http://www.mil-c-17.com/lkpgs/rg-400.htm">M17 / 128-RG400 RG-400 Double Braid Flexible Coaxial Cable</a> with a different shell color: <br><br><ul><li>  Maximum operating frequency 6 GHz </li><li>  At a frequency of 1.20 GHz, the maximum attenuation is 0.54 dB / m </li></ul><br>  It is very doubtful that these are characteristics of a Chinese cable.  By the way, Flightaware bundled a lousy antenna cable, albeit an Italian one.  Shortening the cable from the antenna to several tens of centimeters three times increased the number of received packets by the Flightaware receiver. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dt/ax/iy/dtaxiyp-0hsnbkxoyxvwxqppmpm.jpeg" width="400"></div><br>  Outdoor antenna and its mounting to the mast. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/od/cd/uw/odcduwhuzkas2_16eb-bvkonhgk.jpeg" width="400"></div><br>  Kuryoz from the <a href="https://www.facebook.com/groups/446877039078083/">FlightFeeder ADS-B VariFlight group</a> on Facebook: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/in/-v/xt/in-vxt5ycgivunptwzqwlteg1ns.png"></div><br>  The antenna is slightly smaller in diameter than Flightaware <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/57/og/_c/57og_cudvkojungdjrhx7nbvmmm.jpeg" width="400"></div><br>  Flightaware mast mount from duralumin <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-v/rd/df/-vrddfifb-tgjkc4chgcxonphki.jpeg" width="400"></div><br>  A gift with the symbolism of VariFlight.  Judging by the inscriptions on the back - this label should cling to the luggage in case of loss at the airport, filling out contact details of the owner. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/na/ay/3t/naay3txh_wtm7qlo9hpe1zbczji.jpeg" width="400"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xh/uy/sq/xhuysqq2i9mjm8r5kmsy8eo6md8.jpeg" width="400"></div><br><h2>  <font color="#cc0000">First start</font> </h2><br>  Turning on the power did not fundamentally change the appearance of the device.  Only the LAN indicators were on, the router had a new host name raspberrypi in the list of issued dhcp IP addresses.  On HDMI, there was a normal RPi boot output and login request. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/u3/jq/la/u3jqlagqk0w2vni0vquhtllulk0.jpeg" width="400"></div><br>  And that's all.  The expected web interface for such devices at IP: 8080 was unavailable.  The port scan of the device found only port 22. Attempting to log in as the default user and password was sent far to both the console and ssh: <br><br><pre> <code class="bash hljs">login as: pi pi@raspberrypi<span class="hljs-string"><span class="hljs-string">'s password: Access denied</span></span></code> </pre> <br>  The receiver turned on and off several times, remained for days on the assumption that it could download something at that time or try to reach servers in China.  Neither the red nor the green indicator lights up. <br><br>  At that time, I went off-site looking for an FAQ, technical support or something else that could tell what this device should and should not do.  I logged in for the first time, but this did not change anything in principle - there are no contact forms or feedback forms.  The only thing that was found was that the receiver was tied to an account and had the status offline.  I drew attention to the fact that the system last saw it on the network on September 2 at 17.18 Beijing time, 4 days before being sent by mail.  Those.  He was checked and connected to the account. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0b/-0/fs/0b-0fsjl_qfuohrhfdanizpv9y8.png"></div><br>  After spending a couple of days in ferment on the sites of the ‚ÄúChinese Internet‚Äù, which by some links referred to offsite or to which links from offsite were, and tired of their original design, I realized that there was no technical support for this product.  And at that moment I remembered two emails from ADSB Â±ïÁ§∫ Á≥ªÁªü (Display system of ADS-B). <br><br>  ‚ÄúThis is some kind of nonsense‚Äù - once again I heard a familiar voice with an accent in my head.  My email to this address has been sent back to PostMaster feeyo.com <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7q/bh/vw/7qbhvwk-bzc6ljjz6rpqfusctgi.png"></div><br>  And then the eye caught on the attachment to the second letter, which had previously eluded the view (due to the unusual GMail design).  This turned out to be a VariFlight ADS-B installation manual.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It's time to find out how it was supposed to work. </font></font><br><br><h2> <font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meet È£û Â∏∏ ÂáÜ ADS-B ËÆæÂ§á ÂÆâË£Ö ËØ¥Êòé</font></font></font> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Below is a translation of the instructions in 6 pages and two languages, most of which are occupied by illustrations. </font></font><br><br><h3> <i><font color="#00cc00"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VariFlight ADS-B Installation Instructions</font></font></font></i> </h3> <i><br></i> <div style="text-align:center;"> <i><img src="https://habrastorage.org/webt/eg/id/qd/egidqdatgtfzejqa91n4nfh-zn8.jpeg" width="400"></i> </div> <i><br></i> <h3>  <i><font color="#00cc00">Short description</font></i> </h3> <i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The VariFlight ADS-B is equipment designed for civil aviation enthusiasts to track aircraft. </font><font style="vertical-align: inherit;">The kit consists of an ADS-B receiver, power supply, patch cord (patch cord), antenna and cable for it.</font></font><br><br></i> <div style="text-align:center;"> <i><img src="https://habrastorage.org/webt/mo/gu/kz/mogukz2z2_ohzy4un1bhz3pk6pa.jpeg" width="400"></i> </div> <i><br></i> <h3> <i><font color="#00cc00"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antenna installation site</font></font></font></i> </h3> <i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The external antenna must be fixed on the outside of the building, as high as possible above the obstacles to the radio signal; </font><font style="vertical-align: inherit;">installation on the roof is preferred. </font><font style="vertical-align: inherit;">Otherwise, ADS-B signals will be absorbed by obstacles such as a wall or a building.</font></font><br><br></i> <div style="text-align:center;"> <i><img src="https://habrastorage.org/webt/7_/3a/ru/7_3aruxylxvhzffbg2xwormtdmk.jpeg" width="400"></i> </div> <i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> After installing the antenna, you need to connect the ADS-B receiver to the Internet by following these steps: </font></font><br><br></i> <ol><li> <i>    .</i> </li><li> <i>   -      ADS-B .</i> </li><li> <i>    .</i> </li></ol> <i><br></i> <div style="text-align:center;"> <i><img src="https://habrastorage.org/webt/gi/me/bv/gimebv-tiw4td7c_m3evyd34tro.jpeg" width="400"></i> </div> <i><br>    ,        .  IP  ,  DHCP. <br><br></i> <h3> <i><font color="#00cc00">   </font></i> </h3> <i><br></i> <div style="text-align:center;"> <i><img src="https://habrastorage.org/webt/ac/vj/sr/acvjsruuug3lop68iq8xm-7act4.jpeg" width="400"></i> </div> <i><br></i> <h3> <i><font color="#00cc00">    </font></i> </h3> <i><br></i> <div style="text-align:center;"> <i><img src="https://habrastorage.org/webt/lg/4u/iv/lg4uivsn2odmoktyc6pbuc63ze4.jpeg" width="400"></i> </div> <i><br></i> <h3> <i><font color="#00cc00">      ADS-B      </font></i> </h3> <i><br> <b> .</b> <br>      IP  ADS-B    <i>http//XXX.XXX.XXX:8080</i>   ,  XXX.XXX.XXX  IP     . <br><br></i> <div style="text-align:center;"> <i><img src="https://habrastorage.org/webt/wp/di/d3/wpdid3rucptn5hlql698q1murns.png"></i> </div> <i><br> <b> </b> <br><br>   <a href="http://flightadsb.variflight.com/">flightadsb.variflight.com</a>   , ,    <a href="http://flightadsb.variflight.com/airport/position"> Airport</a> <br><br></i> <div style="text-align:center;"> <i><img src="https://habrastorage.org/webt/9o/hs/ja/9ohsja9e_inbqrha1kivz6rzrsw.png"></i> </div> <i><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The third method, only for Chinese volunteers</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> For Chinese users, we can use WeChat. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This instruction is over. </font><font style="vertical-align: inherit;">In accordance with this instruction, the device works partially - it receives IP on the local network, but does not display the web interface, in which you can find out the</font></font><a href="https://github.com/antirez/dump1090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dump1090</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Mode S decoder, created for RTLSDR dongles and used in similar devices.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/647/54e/431/64754e43182b4740b7c08d138527a1f9.jpg" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Without working dump1090, no data will be sent to the server. </font><font style="vertical-align: inherit;">It is strange that the device somehow worked when checking before sending. </font><font style="vertical-align: inherit;">"This is some kind of nonsense." </font><font style="vertical-align: inherit;">Since the Chinese are not interested in the device‚Äôs fate in any way, and I couldn‚Äôt find any signs of technical support, my conscience is completely clear if I try to repair it myself.</font></font><br><br><h2> <font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Take control of the device</font></font></font> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Having disassembled the receiver, immediately upon receipt, I made a microSD image in the state before the first power up and studied the contents a bit, immediately suspecting as the receiver sends data to the server - there were files and scripts with service addresses in / root /. </font></font><br><br><h3> <font color="#00cc00"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reset PI user password</font></font></font> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instructions on changing the ‚Äúforgotten password‚Äù with pictures can be found at this </font></font><a href="https://www.raspberrypistarterkits.com/how-to/reset-forgotten-raspberry-pi-password/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I disassemble the receiver again. </font><font style="vertical-align: inherit;">To get to the microSD you need to unscrew all the screws and pull out both the boards. </font><font style="vertical-align: inherit;">Later, when working with the receiver, I did not assemble it back into the case. </font><font style="vertical-align: inherit;">I had to replace two microSD with different systems. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We take out the microSD from Rpi, make a backup copy on the computer, if not already done, and edit the file - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmdline.txt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="bash hljs">dwc_otg.lpm_enable=0 console=ttyAMA0,115200 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 elevator=deadline fsck.repair=yes rootwait</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Add to the end of this line </font></font><br><br><pre> <code class="bash hljs">init=/bin/sh</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We return the microSD back to the RPi, connect the monitor and keyboard. </font><font style="vertical-align: inherit;">Connect the power. </font><font style="vertical-align: inherit;">When the lines stop running on the screen, press Enter. </font><font style="vertical-align: inherit;">The console prompt appears, in which we type</font></font><br><br><pre> <code class="bash hljs">mount -rw -o remount / passwd pi sync <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> /sbin/init</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The lines run again and again wait for them to stop running, then turn off. </font><font style="vertical-align: inherit;">We take out microSD from RPi. </font><font style="vertical-align: inherit;">On the computer, we edit or restore the backup copy </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmdline.txt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - delete ‚Äúinit = / bin / sh‚Äù. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The last time we return the microSD back to RPi. </font><font style="vertical-align: inherit;">Turn on. </font><font style="vertical-align: inherit;">Successfully log in with a new password. </font><font style="vertical-align: inherit;">Enable ssh by typing raspi-config and selecting SSH from the menu. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then, using the top command, I want to see what the receiver lives with and suddenly notice the wget processes and ... dump-1090.</font></font> Silent scene.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I check in the web browser http // XXX.XXX.XXX: 8080 - there is an interface. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/r_/io/t1/r_iot1vh1tljjqcj6gqdat3ufkq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Not to say that it is unexpected, but definitely unusual. From the instructions I check </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Method Two</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - everything is fine there too: the receiver's icon turned green, and below there was a list of airplanes that he heard.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It would be possible to finish this, but firstly, using RPi3 only for this would be unforgivable. And secondly, if this device worked stably. For example, it disappeared from the list of IP addresses of the DHCP router, while it was available when accessing the previously received IP, and at the same time there was no image on HDMI. But the most important was the instability of the broadcast. According to statistics on the receiver page, it worked several hours a day. Sometimes a full day, sometimes several hours, sometimes zero hours. It took several days to study the system - not every software was installed. Chinese repositories ... The German voice finally convinced that it was necessary to make an ADS-B receiver for a healthy person, and for this you need to roll onto another microSD image of PiAware. The original microSD is still useful to find out how it works.</font></font><font color="#FF0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At least save files from / root. </font><font style="vertical-align: inherit;">Preferably make an image.</font></font></font> <br><br><h2> <font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PiAware</font></font></font> </h2><br> <a href="https://ru.flightaware.com/adsb/piaware/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PiAware</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Linux software for transferring flight data to FlightAware. </font><font style="vertical-align: inherit;">Contains fork dump1090-mutability. </font><font style="vertical-align: inherit;">According to the developers, one of the differences is that it does not send packages to the FlightAware server if they do not differ from the first one.</font></font> Those.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if the plane did not change the speed, altitude, then this data should not be processed, and thus reduces the load on the server. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About two years ago, FlightAware began translating texts on the site into Russian. And much to create your own station PiAware can be found </font></font><a href="https://ru.flightaware.com/adsb/piaware/build"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">offsite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The essence of creating a station on RPi with RTLSDR is to write to the microSD of the finished image of PiAware on Raspbian Linux using the </font></font><a href="https://www.balena.io/etcher/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etcher</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> program </font><font style="vertical-align: inherit;">. Further, before you insert the card in RPi and wait for the download, you need to make some changes. To enable SSH access, create an empty file with no extension called ssh in the boot partition. And in the piaware-config.txt file you can make the necessary </font></font><a href="https://ru.flightaware.com/adsb/piaware/advanced_configuration"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">settings</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, specify a static IP or enable WiFi and specify an SSID / password, provided that a supported USB WiFi adapter is connected. </font><font style="vertical-align: inherit;">The same settings can be made from the console using the command piaware-config </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setting_ Possible_values</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you already have a Flightaware account, then in 5 minutes the station will </font></font><a href="https://flightaware.com/adsb/piaware/claim"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">become attached to the account</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by receiving a Unique Identifier. </font><font style="vertical-align: inherit;">And the receiver will have its own page with statistics. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By default, the PI user has the password flightaware. </font><font style="vertical-align: inherit;">It‚Äôs a good idea to change your password right away.</font></font><br><br><h3> <font color="#00cc00"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Tests"</font></font></font> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tests in quotes, just impressions. Having two devices with almost the same software, you can evaluate their abilities. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I have a free Flightaware receiver and the first thing I experienced was a complete VariFlight antenna. I just replaced it with a Flightaware antenna. And while studying the VariFlight receiver, FlightFeeder statistics were collected on the Flightaware page. The conclusion is disappointing. Although the maximum range, nothing has changed, like FlightFeeder, in the direction of the line of sight, catching some at a distance of 400 km, but the statistics of aircraft per hour / day slipped by 2-3 times. Sure takes the board for 300+ kilometers, but sees slightly less messages. What I do not know inside the case of the antenna itself is not collapsible.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A Flightaware antenna was connected to the VariFlight receiver and it showed statistics of the same order. </font><font style="vertical-align: inherit;">And with a native antenna even lower.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ed/tq/0z/edtq0z5qbkaioqmq8khv4q75nse.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I decipher the statistics. </font><font style="vertical-align: inherit;">Statistics from 10-05 to 10-07 is the VariFlight receiver with Flightaware antenna. </font><font style="vertical-align: inherit;">10-08 the complete antenna was connected and from 10-09 to 10-11 the statistics of the VariFlight kit. </font><font style="vertical-align: inherit;">10-12 The send_message.py script has been modified to collect data from Flightaware Flightfeeder. </font><font style="vertical-align: inherit;">After that, data from it and 10-13 daily statistics based on Flightaware Flightfeeder data went to VariFlight. </font><font style="vertical-align: inherit;">Further more, for example, for 10-18 - 396 flights, 814176 packages, for 10-19 - 471 flights, 860415 packages. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let us estimate how the receiver VariFlight is subject to radio interference. </font><font style="vertical-align: inherit;">To do this, we scan the 800 MHz-1200 MHz range and generate a heat map.</font></font><br><br><pre> <code class="bash hljs">sudo apt-get install python-imaging sudo wget https://raw.githubusercontent.com/keenerd/rtl-sdr-misc/master/heatmap/heatmap.py sudo chmod +x heatmap.py sudo systemctl stop dump1090-fa sudo rtl_power -f 800M:1200M:100k -i 30 -c 50% -e 30m -g 30 -F 9 &gt;scan.csv</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> After half an hour (-e 30m) scanning stops and generate an image. </font></font><br><pre> <code class="bash hljs">./heatmap.py scan.csv scan.png</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reboot the device to restore the work of dump1090. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And copy the resulting image to a computer using (win) scp. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is a fragment of a thermal scan map around 1090 MHz. </font><font style="vertical-align: inherit;">Full image is available by click.</font></font><br><br> <a href=""><img src="https://habrastorage.org/webt/qs/jl/om/qsjlomhpqztfezcodd2c__ik-zy.png"></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bright yellow stripes is a mobile connection. Nothing out of the ordinary - he has no prefilters like the Flightfeeder, and he is greatly hampered by mobile stations. In this, it is absolutely the same as the simple ‚Äúblue whistle‚Äù mentioned earlier. Manufacturing in the form of a special expansion card is possible; it makes some sense, for example, the role of ‚Äúcurved tracks‚Äù on this board is incomprehensible. Making a specialized board it would not be difficult to install both a low-noise amplifier and a surfactant filter at 1090 MHz. Just looking at the scripts in the device, I had an idea why this was done - one script is called acars.py.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gj/je/c5/gjjec5drhpf-ummw90sui3ar5vw.jpeg" width="640"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As far as the amplifier and the filter would improve the characteristics of the receiver shows an example from the above-mentioned group on Facebook. </font><font style="vertical-align: inherit;">One of the VariFlight Box users connected a specialized dongle from Flightaware instead of a regular receiver, which brought it to the top of the rating from about a thousand users (of course, the installation location and another antenna also affected).</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/wx/vx/wnwxvxmudv-gpbpatzreybmtgzk.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlightAware launches two dongle models - Pro Stick and Pro Stick Plus, which are still the same ‚Äúblue whistle‚Äù but have a preamplifier, and the latter additionally has a </font></font><abbr title="SAW filter"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAW filter</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that eliminates unnecessary signals in areas with a lot of interference, for example in cities, as well as these models are equipped with an SMA antenna connector. </font><font style="vertical-align: inherit;">These dongles are used in Flightaware Flightfeeder ‚Äúorange‚Äù receivers.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zo/bv/m0/zobvm0srdsqzwa0zj-sn4jnpkow.jpeg" width="400"></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with the cover removed</font></font></b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/_r/do/al_rdoa1ezof9rwtjv6v97o2nd8.jpeg"></div><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The name of the script "acars.py" hints that the absence of any filters is not an error and a saving. </font></font><a href="https://ru.wikipedia.org/wiki/ACARS"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Address and reporting system of aviation communication</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Eng. Aircraft Communications Addressing and Reporting System, ACARS) - a digital radio communication system used in aviation to transmit short messages between the aircraft and ground stations. </font><font style="vertical-align: inherit;">The operating frequency for ACARS in Europe is 131.725 MHz. </font><font style="vertical-align: inherit;">Therefore, the device cannot have a filter only for 1090 MHz, otherwise it will not be able to receive a signal at 131 MHz. </font><font style="vertical-align: inherit;">What is inside the antenna is unknown, I am not going to break it, but it is obvious that its ‚Äúwide coverage‚Äù is also provided by the creators. </font><font style="vertical-align: inherit;">Similarly, the method above generated a heat map in the range of 100 MHz-500 MHz. </font><font style="vertical-align: inherit;">Fragment of the thermal scan map around 450 MHz. </font><font style="vertical-align: inherit;">The full image is also available by click.</font></font><br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/pl/16/as/pl16astc_zfrbh2svvnrmzmurss.png"></a> </div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the heat map are visible control panels, security sensors, wireless doorbells, wireless weather stations, radio amateurs, FM radio stations, and so on and so forth. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, by setting rtl_433, you can see the data of the neighboring wireless sensors of weather stations and, if desired, use them as the author of </font></font><a href="https://raspberrypiandstuff.wordpress.com/2017/08/04/rtl_433-on-a-raspberry-pi-made-bulletproof/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uc/mm/ze/ucmmzezt7bnrtnsqxlkan5gtiwa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And by running rtl_tcp, you can listen to radio amateurs and FM radio. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x3/an/ti/x3antiicq0ssing7bra1wpglk_q.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interestingly, not all radio amateurs exactly hold the frequency. </font><font style="vertical-align: inherit;">It was amusing to see how the radio amateurs rated the interlocutor as audible, and the frequency of one of the radio stations was somewhere off to the side. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But the Chinese receiver on its own system showed accuracy - 0 PPM. </font><font style="vertical-align: inherit;">On the method of measuring PPM can be read on Habr√© in the article </font></font><a href="https://habr.com/ru/users/quwy/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quwy </font></font></a> <a href="https://habr.com/post/373465/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Once again on the reception of HF on RTL-SDR"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">It is highly desirable to adjust the PPM for best reception. </font><font style="vertical-align: inherit;">What the Chinese did. </font><font style="vertical-align: inherit;">There is a small error on Piaware that can and should be removed by specifying the correct PPM value with the command sudo piaware-config rtlsdr-ppm &lt;PPM value&gt;.</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RTLSDR Calibration Instructions with rtl_test and kalibrate-rtl</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"> rtl_test -p</code> </pre> <br>   10 ,    .    ppm. <br><br>            kalibrate-rtl. <br><pre> <code class="bash hljs">sudo apt-get install libtool autoconf automake libfftw3-dev git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/asdil12/kalibrate-rtl.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> kalibrate-rtl git checkout arm_memory ./bootstrap ./configure make sudo make install kal -s GSM900</code> </pre><br>     ,    ¬´power¬ª . <br>       kal -c &lt; &gt; -e &lt;  PPM,      rtl_test&gt; -v <br>    ¬´average absolute error¬ª.     ppm,   ,   sudo piaware-config rtlsdr-ppm &lt; PPM&gt; <br></div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a result, we can say that the VariFlight receiver for iron is little better than what you can assemble yourself. </font><font style="vertical-align: inherit;">This is a good base to start practicing this hobby (and iron testing has been shown; it can be used for a wide range of other tasks. Especially since there are three free USB ports). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The unique disadvantage of an ADSB receiver is the software and the Chinese interface of the site. </font><font style="vertical-align: inherit;">If nothing can be done with the Chinese site, then you can modify the software of the receiver itself. </font><font style="vertical-align: inherit;">The easiest way is to install PiAware and set up distribution on VariFlight. </font><font style="vertical-align: inherit;">Then you can set up distribution on Flightradar24 and get an account with special conditions there. </font><font style="vertical-align: inherit;">An example of using an account with special features is access to the archived data of Flightaware (the crash of the An-148 Saratov Airlines).</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dt/ug/du/dtugduq0reih0v5pv5pphsrxn2a.jpeg" alt="image" width="640"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ua/zc/u8/uazcu8jmy0bk0-wpmw-a_9rm63c.png"></div><br><h2> <font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We give data on VariFlight</font></font></font> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Back to the root directory. </font><font style="vertical-align: inherit;">It can be found on </font></font><a href="https://github.com/dextercai/FEEYO-Adsb/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The names of the files clearly hint at their functions.</font></font><br><br><pre> <code class="bash hljs">root@raspberrypi:/home/pi<span class="hljs-comment"><span class="hljs-comment"># ls /root -l total 24 drwxr-xr-x 8 root root 4096 Nov 22 2016 dump1090 drwxr-xr-x 5 root root 4096 Oct 16 18:54 get_message -rwxr-xr-x 1 root root 567 Nov 22 2016 install.sh drwxr-xr-x 7 root root 4096 Nov 22 2016 rtl-sdr -rwxr-xr-x 1 root root 62 Nov 22 2016 synctime.sh -rwxr-xr-x 1 root root 1300 Nov 29 2016 task.sh</span></span></code> </pre><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">install.sh</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash apt-get update apt-get install cmake libusb-1.0-0-dev build-essential vim ntpdate -y apt-get remove ntp cd get_message/ mv rtl-sdr-blacklist.conf /etc/modprobe.d/ mv dump.sh /etc/init.d/dump chmod +x /etc/init.d/dump mv task.sh ../ chmod +x ../task.sh cd ../rtl-sdr/ mkdir rtl cd rtl cmake ../ -DINSTALL_UDEV_RULES=ON make install ldconfig cd ../../dump1090/ make cd /root/get_message/ python get_ip.py ps aux | grep py update-alternatives --config editor crontab -e * * * * * /root/task.sh &gt;/dev/null 2&gt;&amp;1 * * */6 * * /root/synctime.sh &gt;/dev/null 2&gt;&amp;1</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> From the last install.sh lines, you can see that cron adds two tasks ‚Äî run task.sh every minute and synctime.sh every 6 days. </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">synctime.sh</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash /usr/sbin/ntpdate 115.182.42.248 &gt; /dev/null 2&gt;&amp;1</span></span></code> </pre><br></div></div><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">115.182.42.248 - BeiJing Wanglianxuntong Telecom Technology Co., Ltd, Beijing, China. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remarks: Please note that CNNIC is not an ISP and is not </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remarks: empowered to investigate complaints of network abuse. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remarks: Please contact the tech-c or admin-c of the network.</font></font></blockquote><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">task.sh</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash ps -eaf | grep dump1090 | grep -v grep if [ $? -eq 1 ] then /etc/init.d/dump stop sleep 1 /etc/init.d/dump start echo `date "+%G-%m-%d %H:%M:%S"`" dump1090 restart" echo "------------------------------------------------------------------------" else echo `date "+%G-%m-%d %H:%M:%S"`" dump1090 running" echo "------------------------------------------------------------------------" fi ps -eaf | grep send_message.py | grep -v grep # if not found - equals to 1, start it if [ $? -eq 1 ] then python -O /root/get_message/send_message.py &amp; echo `date "+%G-%m-%d %H:%M:%S"`" send_message restart" echo "------------------------------------------------------------------------" else echo `date "+%G-%m-%d %H:%M:%S"`" send_message running" echo "------------------------------------------------------------------------" fi ps -eaf | grep get_ip.py | grep -v grep # if not found - equals to 1, start it if [ $? -eq 1 ] then python /root/get_message/get_ip.py echo `date "+%G-%m-%d %H:%M:%S"`" get_ip restart" echo "------------------------------------------------------------------------" else echo `date "+%G-%m-%d %H:%M:%S"`" get_ip running" echo "------------------------------------------------------------------------" fi</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The script task.sh, which is run every minute by cron, checks and, if necessary, restarts dump1090, the send_message.py and get_ip.py scripts. </font></font><br><pre> <code class="bash hljs">pi@raspberrypi:~ $ ps -eaf | grep dump1090 | grep -v grep root 830 1 14 Oct12 ? 13:49:25 ./dump1090 --net --net-sbs-port 30003 pi@raspberrypi:~ $ ps -eaf | grep get_ip.py | grep -v grep pi@raspberrypi:~ $ ps -eaf | grep send_message.py | grep -v grep root 838 1 0 Oct12 ? 00:09:20 python -O /root/get_message/send_message.py</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_message</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> directory </font><font style="vertical-align: inherit;">contains python scripts, one of which, send_message.py, sends data.</font></font><br><br><pre> <code class="bash hljs">root@raspberrypi:/home/pi<span class="hljs-comment"><span class="hljs-comment"># ls /root/get_message -l total 40 -rw-r--r-- 1 root root 954 Nov 22 2016 acars.py -rw-r--r-- 1 root root 1341 Nov 22 2016 acars.sh -rw-r--r-- 1 root root 173 Nov 22 2016 config.ini drwxr-xr-x 8 root root 4096 Nov 22 2016 dump1090 -rwxr-xr-x 1 root root 1731 Nov 22 2016 get_ip.py drwxr-xr-x 3 root root 4096 Nov 22 2016 get_message1117 -rwxr-xr-x 1 root root 3400 Dec 7 2016 init.sh -rw-r--r-- 1 root root 33 Oct 16 18:51 md5.txt -rwxr-xr-x 1 root root 1143 Oct 12 18:16 send_message.py -rw-r--r-- 1 root root 16 May 27 2016 UUID</span></span></code> </pre><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">init.sh</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash path='/root/get_message/' DATE=`date -d "today" +"%Y-%m-%d_%H:%M:%S"` result="" UUID="" execom="" FromServer="" SourceMD5="" device="" if ps -ef |grep dump1090 |grep -v grep &gt;/dev/null then device="adsb" elif ps -ef |grep acarsdec |grep -v grep &gt;/dev/null then device="acars" else device="unknow" fi IpAddr=`/sbin/ifconfig |grep "addr:" |grep -v 127.0.0.1 |cut -d ':' -f2 |cut -d ' ' -f1` if [ -f "/root/get_message/UUID" ] then UUID=`cat /root/get_message/UUID` fi execut(){ while read command do eval $command if [ $? -ne 0 ] then execom=$command result=0 break fi result=1 done &lt;$path/package/exe.txt } removefile(){ rm -rf $path/package rm -f $path/*tar.gz* } main(){ ps -eaf | grep "pic.veryzhun.com/ADSB/update/newpackage.tar.gz" | grep -v grep if [ $? -eq 1 ] then /usr/bin/wget -P $path -c -t 1 -T 2 pic.veryzhun.com/ADSB/update/newpackage.tar.gz if [ -f "$path/newpackage.tar.gz" ] then dmd5=`md5sum $path/newpackage.tar.gz|cut -d ' ' -f1` if [ "$SourceMD5" = "$dmd5" ] then /bin/tar -xzf $path/newpackage.tar.gz -C $path echo $SourceMD5 &gt; $path/md5.txt /bin/touch /usr/src/start.pid echo $DATE &gt; /usr/src/start.pid execut if [ $result -eq 1 ] then curl -m 2 -s -d UUID=$UUID -d date=$DATE -d execom=$execom -d message="success" http://receive.cdn35.com/ADSB/result.php else curl -m 2 -s -d UUID=$UUID -d date=$DATE -d execom=$execom -d message="fail" http://receive.cdn35.com/ADSB/result.php fi removefile else curl -m 2 -s -d UUID=$UUID -d date=$DATE -d execom="------" -d message="post file has been changed" http://receive.cdn35.com/ADSB/result.php removefile fi else curl -m 2 -s -d UUID=$UUID -d date=$DATE -d execom="------" -d message="download failed" http://receive.cdn35.com/ADSB/result.php removefile fi fi } if curl -m 2 -s pic.veryzhun.com/ADSB/update.php &gt;/dev/null;then removefile FromServer=`curl -m 2 -s -d UUID="$UUID" -d IpAddr="$IpAddr" -d Device="$device" pic.veryzhun.com/ADSB/update.php` SourceMD5=`echo $FromServer|cut -d ' ' -f1` length=`echo $SourceMD5 |wc -L` if [ $length -ne 32 ] then curl -m 2 -s -d UUID=$UUID -d date=$DATE -d execom="------" -d message="md5 style error" http://receive.cdn35.com/ADSB/result.php exit fi else curl -m 2 -s -d UUID=$UUID -d date=$DATE -d execom="------" -d message="curl failed" http://receive.cdn35.com/ADSB/result.php exit fi DesMD5=`cat $path/md5.txt` if [ "$SourceMD5" = "$DesMD5" ] then curl -m 2 -s -d UUID=$UUID -d date=$DATE -d execom="------" -d message="no update,md5 without change " http://receive.cdn35.com/ADSB/result.php exit else main fi</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The init.sh script checks if there is an update and installs a new send_message.py </font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_ip.py</font></font></b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> socket <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fcntl <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys,os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ConfigParser <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> hashlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uuid config = ConfigParser.ConfigParser() config.readfp(open(sys.path[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-string"><span class="hljs-string">'/config.ini'</span></span>,<span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) uuid_file=sys.path[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-string"><span class="hljs-string">'/UUID'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> os.path.exists(uuid_file) : file_object = open(uuid_file) mid = file_object.read() file_object.close() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> : mid = uuid.uuid1().get_hex()[<span class="hljs-number"><span class="hljs-number">16</span></span>:] file_object = open(uuid_file , <span class="hljs-string"><span class="hljs-string">'w'</span></span>) file_object.write( mid ) file_object.close() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(source_data)</span></span></span><span class="hljs-function">:</span></span> source_data=source_data.replace(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>,<span class="hljs-string"><span class="hljs-string">'$$$'</span></span>) f=urllib2.urlopen( url = config.get(<span class="hljs-string"><span class="hljs-string">"global"</span></span>,<span class="hljs-string"><span class="hljs-string">"ipurl"</span></span>), data = source_data, timeout = <span class="hljs-number"><span class="hljs-number">60</span></span> ) tmp_return=f.read() request_json=json.loads(tmp_return) request_md5=request_json[<span class="hljs-string"><span class="hljs-string">'md5'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> request_json[<span class="hljs-string"><span class="hljs-string">'md5'</span></span>] tmp_hash=<span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> request_json: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> tmp_hash==<span class="hljs-string"><span class="hljs-string">''</span></span> : tmp_hash=tmp_hash+request_json[i] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> : tmp_hash=tmp_hash+<span class="hljs-string"><span class="hljs-string">','</span></span>+request_json[i] md5=hashlib.md5(tmp_hash.encode(<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>)).hexdigest() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (md5 == request_md5): operate(request_json) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'MD5 ERR'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"return: "</span></span>+tmp_return; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_ip_address</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ifname)</span></span></span><span class="hljs-function">:</span></span> skt = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) pktString = fcntl.ioctl(skt.fileno(), <span class="hljs-number"><span class="hljs-number">0x8915</span></span>, struct.pack(<span class="hljs-string"><span class="hljs-string">'256s'</span></span>, ifname[:<span class="hljs-number"><span class="hljs-number">15</span></span>])) ipString = socket.inet_ntoa(pktString[<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">24</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ipString <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(request_json)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> request_json[<span class="hljs-string"><span class="hljs-string">'type'</span></span>] == <span class="hljs-string"><span class="hljs-string">'reboot'</span></span> : os.system(<span class="hljs-string"><span class="hljs-string">'/sbin/reboot'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> request_json[<span class="hljs-string"><span class="hljs-string">'type'</span></span>] == <span class="hljs-string"><span class="hljs-string">'code'</span></span> : fileHandle = open ( urllib.unquote( request_json[<span class="hljs-string"><span class="hljs-string">'path'</span></span>] ) , <span class="hljs-string"><span class="hljs-string">'w'</span></span> ) fileHandle.write( urllib.unquote( request_json[<span class="hljs-string"><span class="hljs-string">'content'</span></span>] ) ) fileHandle.close() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'OK'</span></span> eth=get_ip_address(<span class="hljs-string"><span class="hljs-string">'eth0'</span></span>) send_message(mid+<span class="hljs-string"><span class="hljs-string">'|'</span></span>+eth+<span class="hljs-string"><span class="hljs-string">'|'</span></span>)</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I especially do not understand the meaning of the network exchange performed by the script. </font><font style="vertical-align: inherit;">A unique UUID is generated if it is missing. </font><font style="vertical-align: inherit;">And there is a certain exchange with the addresses specified in the config.ini file. </font><font style="vertical-align: inherit;">Probably this script is responsible for linking the transmitted data and IP to the account. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noteworthy is the line "if request_json ['type'] == 'reboot': os.system ('/ sbin / reboot')".</font></font><br><br><pre> <code class="plaintext hljs">[global] name = NEW ipurl = http://receive.cdn35.com/ADS-B_IP.php sendurl = http://adsb.feeyo.com/adsb/ReceiveCompressADSB.php version = 1.0 passwd = 'null'</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Finally, the script sends the data. </font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">send_message.py</font></font></b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> socket <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ConfigParser <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> base64 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os,uuid serverHost = <span class="hljs-string"><span class="hljs-string">'localhost'</span></span> serverPort = <span class="hljs-number"><span class="hljs-number">30003</span></span> config = ConfigParser.ConfigParser() config.readfp(open(sys.path[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-string"><span class="hljs-string">'/config.ini'</span></span>,<span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) uuid_file=sys.path[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-string"><span class="hljs-string">'/UUID'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> os.path.exists(uuid_file) : file_object = open(uuid_file) mid = file_object.read() file_object.close() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> : mid = uuid.uuid1().get_hex()[<span class="hljs-number"><span class="hljs-number">16</span></span>:] file_object = open(uuid_file , <span class="hljs-string"><span class="hljs-string">'w'</span></span>) file_object.write( mid ) file_object.close() sockobj = socket.socket(socket.AF_INET,socket.SOCK_STREAM) sockobj.connect((serverHost,serverPort)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(source_data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: source_data=base64.b64encode(zlib.compress(source_data)) f=urllib2.urlopen(url = config.get(<span class="hljs-string"><span class="hljs-string">"global"</span></span>,<span class="hljs-string"><span class="hljs-string">"sendurl"</span></span>),data = urllib.urlencode({<span class="hljs-string"><span class="hljs-string">'from'</span></span>:mid,<span class="hljs-string"><span class="hljs-string">'code'</span></span>:source_data}),timeout = <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception,e: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> str(e) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> tmp_buf=<span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: buf = sockobj.recv(<span class="hljs-number"><span class="hljs-number">1024</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> buf: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(buf) != <span class="hljs-number"><span class="hljs-number">0</span></span>: tmp_buf=tmp_buf+buf <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> buf[len(buf)<span class="hljs-number"><span class="hljs-number">-1</span></span>] == <span class="hljs-string"><span class="hljs-string">'\n'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> send_message(tmp_buf) : tmp_buf=<span class="hljs-string"><span class="hljs-string">''</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I edited the serverHost = 'localhost' string, replacing 'localhost' with 'ff-1234' ‚Äîthe network name of my Flightaware Flightfeeder and rebooting the VariFlight receiver. After that, the data from the Flightfeeder went to VariFlight. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The remaining scripts are the reception of ACARS messages. Perhaps the remnants of a functional or a function implemented in the future. Scripts work with /root/acarsdec-3.0/acarsdec, which is missing along this path. ACARSDEC is an </font></font><a href="https://github.com/TLeconte/acarsdec"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACARS SDR decoder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that decodes messages, for example, at a frequency of 131.725 MHz. Apparently it is precisely based on the reception of this frequency, at the input of the receiver there are no filters at 1090 MHz.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qz/kh/hu/qzkhhuoty6nf40do5noeftc1psk.jpeg" width="400"></div><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The address and reporting aviation communication system (ACARS) is a digital communication system used in aviation for transmitting short, relatively simple messages between an aircraft and ground stations, either through direct radio communication or via satellite systems. </font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">More information about ACARS can be found, for example, </font></font><a href="http://skynav.ru/likbez/acars/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The acars.sh script is similar in implementation to task.sh ‚Äî it restarts acarsdec and the get_ip.py and acars.py scripts if it does not detect the required process.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acars.sh</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash ps -eaf | grep acarsdec | grep -v grep if [ $? -eq 1 ] then /root/acarsdec-3.0/acarsdec -n 127.0.0.1:8888 -o 0 -p -8 -r 0 127.272 126.475 &amp; echo `date "+%G-%m-%d %H:%M:%S"`" acarsdec restart" echo "------------------------------------------------------------------------" else echo `date "+%G-%m-%d %H:%M:%S"`" acarsdec running" echo "------------------------------------------------------------------------" fi ps -eaf | grep get_ip.py | grep -v grep # if not found - equals to 1, start it if [ $? -eq 1 ] then python /root/get_message/get_ip.py echo `date "+%G-%m-%d %H:%M:%S"`" get_ip restart" echo "------------------------------------------------------------------------" else echo `date "+%G-%m-%d %H:%M:%S"`" get_ip running" echo "------------------------------------------------------------------------" fi ps -eaf | grep acars.py | grep -v grep # if not found - equals to 1, start it if [ $? -eq 1 ] then python /root/get_message/acars.py echo `date "+%G-%m-%d %H:%M:%S"`" acars restart" echo "------------------------------------------------------------------------" else echo `date "+%G-%m-%d %H:%M:%S"`" acars running" echo "------------------------------------------------------------------------" fi /usr/sbin/ntpdate cn.pool.ntp.org &gt; /dev/null</span></span></code> </pre><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acars.py</font></font></b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python import socket, traceback ,time,urllib2,urllib,sys,ConfigParser def send_message(source_data): try: f=urllib2.urlopen(url = config.get("global","sendurl"),data = urllib.urlencode({'from':config.get("global","name"),'code':source_data}),timeout = 10) print "return: "+f.read(); return True except Exception,e: print str(e) return False host = '127.0.0.1' port = 8888 config = ConfigParser.ConfigParser() config.readfp(open(sys.path[0]+'/config.ini',"rb")) s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) s.bind((host, port)) while 1: try: message, address = s.recvfrom(8192) socket_udp_str='{0} :{1} \n\n'.format(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(time.time())),message) send_message(socket_udp_str) except (KeyboardInterrupt, SystemExit): raise except: traceback.print_exc()</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In operation, it looks like this: </font></font><br><br><pre> <code class="bash hljs">PID TTY STAT TIME COMMAND 20726 ? Ss 0:00 \_ sshd: pi [priv] 20732 ? S 0:00 \_ sshd: pi@pts/0 20734 pts/0 Ss 0:00 \_ -bash 20744 pts/0 R+ 0:00 \_ ps -afx 777 tty1 Ss+ 0:00 /sbin/agetty --noclear tty1 linux 907 ? Sl 737:23 ./dump1090 --net --net-sbs-port 30003 915 ? S 11:11 python -O /root/get_message/send_message.py</code> </pre><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ps -afx fully</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs">pi@raspberrypi:~ $ ps -afx PID TTY STAT TIME COMMAND 2 ? S 0:00 [kthreadd] 3 ? S 0:59 \_ [ksoftirqd/0] 5 ? S&lt; 0:00 \_ [kworker/0:0H] 7 ? S 5:28 \_ [rcu_sched] 8 ? S 0:00 \_ [rcu_bh] 9 ? S 0:01 \_ [migration/0] 10 ? S 0:01 \_ [migration/1] 11 ? S 0:05 \_ [ksoftirqd/1] 13 ? S&lt; 0:00 \_ [kworker/1:0H] 14 ? S 0:01 \_ [migration/2] 15 ? S 0:04 \_ [ksoftirqd/2] 17 ? S&lt; 0:00 \_ [kworker/2:0H] 18 ? S 0:01 \_ [migration/3] 19 ? S 0:04 \_ [ksoftirqd/3] 21 ? S&lt; 0:00 \_ [kworker/3:0H] 22 ? S 0:00 \_ [kdevtmpfs] 23 ? S&lt; 0:00 \_ [netns] 24 ? S&lt; 0:00 \_ [perf] 25 ? S 0:00 \_ [khungtaskd] 26 ? S&lt; 0:00 \_ [writeback] 27 ? S&lt; 0:00 \_ [crypto] 28 ? S&lt; 0:00 \_ [bioset] 29 ? S&lt; 0:00 \_ [kblockd] 31 ? S&lt; 0:00 \_ [rpciod] 32 ? S 0:00 \_ [kswapd0] 33 ? S&lt; 0:00 \_ [vmstat] 34 ? S 0:00 \_ [fsnotify_mark] 35 ? S&lt; 0:00 \_ [nfsiod] 44 ? S&lt; 0:00 \_ [kthrotld] 46 ? S&lt; 0:00 \_ [bioset] 47 ? S&lt; 0:00 \_ [bioset] 48 ? S&lt; 0:00 \_ [bioset] 49 ? S&lt; 0:00 \_ [bioset] 50 ? S&lt; 0:00 \_ [bioset] 51 ? S&lt; 0:00 \_ [bioset] 52 ? S&lt; 0:00 \_ [bioset] 53 ? S&lt; 0:00 \_ [bioset] 54 ? S&lt; 0:00 \_ [bioset] 55 ? S&lt; 0:00 \_ [bioset] 56 ? S&lt; 0:00 \_ [bioset] 57 ? S&lt; 0:00 \_ [bioset] 58 ? S&lt; 0:00 \_ [bioset] 59 ? S&lt; 0:00 \_ [bioset] 60 ? S&lt; 0:00 \_ [bioset] 61 ? S&lt; 0:00 \_ [bioset] 62 ? S&lt; 0:00 \_ [bioset] 63 ? S&lt; 0:00 \_ [bioset] 64 ? S&lt; 0:00 \_ [bioset] 65 ? S&lt; 0:00 \_ [bioset] 66 ? S&lt; 0:00 \_ [bioset] 67 ? S&lt; 0:00 \_ [bioset] 68 ? S&lt; 0:00 \_ [bioset] 69 ? S&lt; 0:00 \_ [bioset] 70 ? S&lt; 0:00 \_ [VCHIQ-0] 71 ? S&lt; 0:00 \_ [VCHIQr-0] 72 ? S&lt; 0:00 \_ [VCHIQs-0] 73 ? S&lt; 0:00 \_ [iscsi_eh] 74 ? S&lt; 0:00 \_ [dwc_otg] 75 ? S&lt; 0:00 \_ [DWC Notificatio] 77 ? S 0:00 \_ [irq/92-mmc1] 78 ? S 0:00 \_ [VCHIQka-0] 79 ? S&lt; 0:00 \_ [SMIO] 80 ? S&lt; 0:00 \_ [deferwq] 83 ? S&lt; 0:00 \_ [bioset] 84 ? S 0:11 \_ [mmcqd/0] 87 ? S 0:04 \_ [jbd2/mmcblk0p2-] 88 ? S&lt; 0:00 \_ [ext4-rsv-conver] 89 ? S&lt; 0:00 \_ [ipv6_addrconf] 172 ? S 415:15 \_ [w1_bus_master1] 224 ? S&lt; 0:00 \_ [cfg80211] 227 ? S&lt; 0:00 \_ [brcmf_wq/mmc1:0] 229 ? S 0:00 \_ [brcmf_wdog/mmc1] 493 ? S&lt; 0:00 \_ [kworker/1:1H] 550 ? S&lt; 0:00 \_ [kworker/3:1H] 632 ? S&lt; 0:00 \_ [kworker/u9:0] 633 ? S&lt; 0:00 \_ [hci0] 634 ? S&lt; 0:00 \_ [hci0] 638 ? S&lt; 0:00 \_ [kworker/u9:2] 3856 ? S&lt; 0:00 \_ [kworker/2:1H] 9346 ? S&lt; 0:00 \_ [kworker/0:1H] 15564 ? S 0:00 \_ [kworker/1:0] 17556 ? S 0:00 \_ [kworker/u8:2] 17878 ? S 0:00 \_ [kworker/0:0] 17879 ? S 0:00 \_ [kworker/2:2] 19234 ? S 0:00 \_ [kworker/u8:4] 19566 ? S 0:00 \_ [kworker/3:1] 20143 ? S 0:00 \_ [kworker/2:1] 20259 ? S 0:00 \_ [kworker/3:2] 20352 ? S 0:00 \_ [kworker/0:2] 20416 ? S 0:00 \_ [kworker/1:2] 20600 ? S 0:00 \_ [kworker/3:0] 20601 ? S 0:00 \_ [kworker/2:0] 20605 ? S 0:00 \_ [kworker/u8:0] 20725 ? S 0:00 \_ [kworker/0:1] 1 ? Ss 0:10 /sbin/init 134 ? Ss 1:00 /lib/systemd/systemd-journald 136 ? Ss 0:08 /lib/systemd/systemd-udevd 416 ? Ss 0:09 /usr/sbin/cron -f 426 ? Ss 0:01 /lib/systemd/systemd-logind 429 ? Ss 0:00 avahi-daemon: running [raspberrypi.local] 458 ? S 0:00 \_ avahi-daemon: chroot helper 433 ? Ss 0:00 /usr/bin/dbus-daemon --system --address=systemd: --no 450 ? Ss 0:02 /usr/sbin/thd --daemon --triggers /etc/triggerhappy/t 496 ? Ss 0:03 /sbin/wpa_supplicant -s -B -P /run/wpa_supplicant.wla 498 ? Ssl 0:13 /usr/sbin/rsyslogd -n 636 ? S 0:00 /usr/bin/hciattach /dev/serial1 bcm43xx 921600 noflow 640 ? Ss 0:00 /usr/lib/bluetooth/bluetoothd 729 ? Ss 0:02 /sbin/dhcpcd -q -w 749 ? Ss 0:00 /usr/sbin/sshd -D 20726 ? Ss 0:00 \_ sshd: pi [priv] 20732 ? S 0:00 \_ sshd: pi@pts/0 20734 pts/0 Ss 0:00 \_ -bash 20744 pts/0 R+ 0:00 \_ ps -afx 777 tty1 Ss+ 0:00 /sbin/agetty --noclear tty1 linux 907 ? Sl 737:23 ./dump1090 --net --net-sbs-port 30003 915 ? S 11:11 python -O /root/get_message/send_message.py</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From this it is clear that you can take data from PiAware almost without straining, in fact, only by transferring the scripts to a new system. </font><font style="vertical-align: inherit;">And if there is already an existing adsb-station - self-made, Flightradar24, Flightaware, then the existing receiver can be used at your discretion for other personal goals and tasks with a completely clear conscience.</font></font><br><br><h2> <font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installing VariFlight on PiAware</font></font></font> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We transfer the necessary files to the new system from the old one. </font></font> Those.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the contents of the root directory: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_message directory and files install.sh, synctime.sh, task.sh. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the get_message directory:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> acars.py </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> acars.sh </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> config.ini </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> get_ip.py </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> init.sh </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> send_message.py </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and the UUID file is your VariFlight network ID. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you want to start sharing data without having a VariFlight Feeder, then when you first run the script, your UUID is generated. </font><font style="vertical-align: inherit;">This file and the name of the nearest airport should be sent to chengyi (at) variflight.com to create your account on the service.</font></font></i> <br><br>  Further: <br><pre> <code class="bash hljs">pi@piaware:~ $ sudo apt-get install -y python ntpdate pi@piaware:~ $ su root@piaware:~<span class="hljs-comment"><span class="hljs-comment"># sh task.sh root@piaware:~# crontab -e</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Edit the crontab in nano by inserting </font></font><br><pre> <code class="bash hljs">* * * * * /root/task.sh &gt;/dev/null 2&gt;&amp;1</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Save the file by pressing [Ctrl + O] and close [Ctrl + X]. </font></font><br><pre> <code class="bash hljs">root@piaware:~<span class="hljs-comment"><span class="hljs-comment"># chmod 777 task.sh root@piaware:~# reboot</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After rebooting, check the page with its statistics </font></font><a href="http://flightadsb.feeyo.com/user/rank"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flightadsb.feeyo.com/user/rank.</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In the fourth column should be a green inscription online. </font><font style="vertical-align: inherit;">And in the </font></font><a href="http://flightadsb.feeyo.com/airport/position"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Airport</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> list, the </font><font style="vertical-align: inherit;">taken airplanes (the third column - how many seconds ago the signal from the aircraft was received). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At this point, my draft ‚Äústuck‚Äù indefinitely, because </font><font style="vertical-align: inherit;">here I wanted to write how to run on a router with an openwrt script and ModeSMixer to distribute data to services and thus turn off this receiver and use it for other purposes. </font><font style="vertical-align: inherit;">But I do not yet have free time and I decided to publish it as it is. </font><font style="vertical-align: inherit;">Maybe someone </font></font><a href="http://flightadsb.feeyo.com/index/adsb%3Frecommender%3DMTg4OTU2MjE5MDU%26lang%3Den%26fbclid%3DIwAR0aetWVIkwlPyFGIv5gy3COMh0uAzSd-tNywRTL1fgFfstBhNAwTXSqkCs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wants to order a </font></font></a> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">free</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> receiver and this article will be useful.</font></font><br><br><h2> <font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ModeSMixer</font></font></font> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One receiver can distribute data to several services and is used for this program ModeSMixer. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ModeSMixer is a console application for combining and relaying streams with Mode-S data in various formats. </font><font style="vertical-align: inherit;">Approximate use case:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k_/r_/kg/k_r_kgk9z0hxapzmioayflatyce.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The program is designed to combine and retransmit different stream formats ModeS data. </font><font style="vertical-align: inherit;">The program has no default settings. </font><font style="vertical-align: inherit;">Everything is set by parameters. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The --inConnect parameter specifies the addresses and ports from which data is received. </font><font style="vertical-align: inherit;">And the parameter --outServer defines the format and port for the relayed data. </font><font style="vertical-align: inherit;">The example in the picture will look like this:</font></font><br><pre> <code class="bash hljs">./modesmixer2 --inConnect 192.168.0.105:30005 --inConnect 127.0.0.1:30005 --outServer sbs10001:10001 --outServer beast:31001 --globes 32000:tablename:home --location XX.XXXXX:YY.YYYYY --web 8765 &amp;</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The --location parameter defines the latitude and longitude of the station installation location, and the --web parameter specifies the port on which the program‚Äôs web interface will work. More information about the program can be read </font></font><a href="https://sonicgoose.com/combining-and-rebroadcasting-ads-b-feeds-with-modesmixer2/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By setting up a distribution to several services, the station owner receives a special membership on each service and access to non-public information and the archive of flights for a certain period. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the case of PiAware, data is already being sent to FlightAware and all that remains is to collect this data using modesmixer2. And in the case of Variflight, you need to get data in BaseStation format on some free port, for example, 10001. The parameter will look like --outServer msg: 10001. If necessary, you can add port 10002 for the VirtualRadar program: --outServer beast: 10002</font></font><br><pre> <code class="bash hljs">./modesmixer2 --inConnect localhost:30005 --inConnect localhost:30105 --outServer msg:10001 --outServer beast:10002 --location &lt;&gt;:&lt;&gt; --web 8765 &amp;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In order for it to start and restart automatically, you need to edit task.sh, adding: </font></font><br><pre> <code class="bash hljs">ps -eaf | grep modesmixer2 | grep -v grep <span class="hljs-comment"><span class="hljs-comment"># if not found - equals to 1, start it if [ $? -eq 1 ] then ./modesmixer2 --inConnect localhost:30005 --inConnect localhost:30105 --outServer msg:10001 --location &lt;&gt;:&lt;&gt; --web 8765 &amp; echo `date "+%G-%m-%d %H:%M:%S"`" modesmixer2 restart" echo "------------------------------------------------------------------------" else echo `date "+%G-%m-%d %H:%M:%S"`" modesmixer2 running" echo "------------------------------------------------------------------------" fi</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Finally, edit the get_message / send_message.py script, specifying the new port with the data: </font></font><br><pre> <code class="python hljs">serverHost = <span class="hljs-string"><span class="hljs-string">'localhost'</span></span> serverPort = <span class="hljs-number"><span class="hljs-number">10001</span></span></code> </pre><br><br><h2> <font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meanwhile</font></font></font> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">while this article was in draft, news from China appeared concerning these services. </font><font style="vertical-align: inherit;">In November 2018, the Chinese authorities began to turn off the ADSB receivers of foreign services. </font><font style="vertical-align: inherit;">This can be seen in the public statistics of Flightaware stations in China: </font></font><br><br><img src="https://habrastorage.org/webt/qt/ao/zw/qtaozwosymnimbutqn0miisq_mu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The news is that Chinese radarspotting enthusiasts said they received calls from representatives of the Chinese authorities and were visited by the police, who ‚Äúvery nicely and politely‚Äù asked them to stop transmitting ADS-B data to overseas services that appear to ‚Äúendanger China‚Äôs national security and sovereignty.‚Äù</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Some claimed that they were called, even if they did not receive the receiver from FlightRadar24 and FlightAware. </font><font style="vertical-align: inherit;">These events caused a stir among enthusiasts, and many of them stopped the transfer of ADS-B data. </font><font style="vertical-align: inherit;">It is known that FlightRadar24 tried to anonymize the user stations in China. </font><font style="vertical-align: inherit;">It is not clear how effective it is. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notification to the Chinese authorities in English:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5g/ib/aq/5gibaqetlgqzcqxaul0ognxlau0.png" width="400"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúIt threatens the national security and sovereignty of China‚Äù by the fact that such services make it possible to locate Chinese (American, European and others except the countries of the former USSR) military aircraft. </font><font style="vertical-align: inherit;">For example, the weekly trajectory of the US strategic reconnaissance UAV over international waters at an altitude of 16 km:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hv/zz/oy/hvzzoywpk5ukuehepkkdjgcbvt0.png" alt="image" width="400"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the world there are two secondary radar systems from the United States and the USSR. </font><font style="vertical-align: inherit;">Therefore, these receivers and services cannot show the whereabouts of most ‚ÄúSoviet‚Äù airplanes and helicopters if they are not equipped with an ‚ÄúAmerican‚Äù radar responder, which is necessary only for flying in airspace, for example, the United States or the EU. </font><font style="vertical-align: inherit;">Therefore, it is possible to see something interesting on the territory of the Russian Federation in the border areas, preferably by the sea. </font><font style="vertical-align: inherit;">For example, the above-mentioned American intelligence officer is remarkably visible from Krasnodar. </font><font style="vertical-align: inherit;">Due to this coastal location of the receiver, mentioned above, the PlaneRadar service periodically gets into the news of the Russian media.</font></font><br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1067760621398253569"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div></div><p>Source: <a href="https://habr.com/ru/post/423989/">https://habr.com/ru/post/423989/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423979/index.html">British Biomarker Panel Healthy Aging</a></li>
<li><a href="../423981/index.html">DDIA book (book with hog) - make level up in understanding databases</a></li>
<li><a href="../423983/index.html">11 JavaScript libraries for data visualization, which should be known in 2018</a></li>
<li><a href="../423985/index.html">Roskomnadzor proposes to abolish network neutrality in 5G networks</a></li>
<li><a href="../423987/index.html">How to become a Java programmer</a></li>
<li><a href="../423991/index.html">Apple's App Store Subscription Management Secrets</a></li>
<li><a href="../423993/index.html">How to draw a black hole. Geodesic ray tracing in a curved space-time</a></li>
<li><a href="../423995/index.html">Clean in the boom workshop. Part 2</a></li>
<li><a href="../423997/index.html">IT Crimea: a new technology park in Sevastopol - it will start working at the end of this year</a></li>
<li><a href="../423999/index.html">The data of Windows users on a PC with touch input is written to a separate file.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>