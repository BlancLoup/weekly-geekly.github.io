<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Interactive recommenders: how to create, how to work</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How to build recommendation systems? What machine learning models can you use? Which problems are solved by interactive recommenders, and which ones a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Interactive recommenders: how to create, how to work</h1><div class="post__text post__text-html js-mediator-article">  How to build recommendation systems?  What machine learning models can you use?  Which problems are solved by interactive recommenders, and which ones are not?  What tools can be useful for e-commerce portal?  About this - in the report of the Big Data-engineer of EPAM <b>Ekaterina Sotenko</b> ‚ÄúReview of the approaches of building interactive recommenders‚Äù, with which she spoke at the Samara ITsubbotnik this spring.  Below is a video of the report, and even lower is its summary. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/bFu9wfnfdIQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br><h3>  How it all began </h3><br>  EPAM was addressed by the famous British fashion house, which needed an interactive recommender for the e-commerce portal.  Prior to this, EPAM introduced the implementation of the usual offline recommender.  Now the customer wanted to learn about the desires of users in real time, and not after the fact.  To solve this problem, we studied the customer's portal and selected the following elements to work: <br><br>  <b>1. Homepage</b> <br>  This is the page where the user - even if he has not logged in - sees the directory.  Whichever user comes - already registered or new - we need to interest him from the very beginning.  For this, we proposed a concept with categorical filters: you can choose from the proposed set of categories according to the principle ‚ÄúI would like it more than this‚Äù and not specify (‚ÄúI want exactly this‚Äù).  This is different from the usual search: the user is given a tool with which you can quickly find something interesting to him, even if the person has not clearly formulated his wishes.  Here, interactive recommenders are appropriate, since we need to understand whether the user is looking for something new or already familiar.  This problem can be solved with the help of the multi-armed bandits group of algorithms. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>2. Main directory</b> <br>  Traditionally, the user can select items from the catalog using filters by color, size and other criteria.  If we already know the preferences of a person, you can immediately submit a catalog with the most relevant selection of elements for it.  Algorithms that use user information are <b>demographic based recommenders</b> . <br><br>  But then the question arises: what if we do not know about the context of the user and do not understand what determines his choice?  Here <b>context context recommenders</b> will help us.  Moreover, we can build recommendations interactively: for example, if the user starts scrolling the screen, we understand that he continues to search, and throw up new products to him.  We take into account that the options that have already been presented, were uninteresting.  Here you can again use the model of multi-armed bandits. <br><br>  <b>3. Basket</b> <br>  If the user has made his choice, you can try to interest him with something else.  This is realized with the help of the product line of the type "With this also buy."  To build this line, use <b>learning to rank</b> or <b>sequential pattern mining algorithms</b> . <br><br>  <b>4. Gifts</b> <br>  The main problem of this section is that the user chooses not gifts for himself.  It is necessary to use the information not about you, but about who gets the gift.  Neither knowledge of the user nor collaborative filtering will help.  We need information with whom the user is friends, whether he has children, etc.  Here we can use a <b>demographic based recommender</b> using information about the user's relationship and <b>sequential pattern mining</b> . <br><br><h3>  Conversion </h3><br>  When we have decided on the tasks and tools, we need to understand which tools will bring the greatest conversion.  Consider an example of apparel stores.  In Germany, conducted a study on user behavior during online shopping, when buying clothes.  About 50 women participated in it.  They needed to choose an image for a meeting of graduates in a restaurant.  As part of the experiment, they could buy any number of things, but spend no more than 300 euros.  Based on data on income, age, habit of following the fashion, the researchers divided the participants into several groups and began collecting statistics. <br><br><img src="https://habrastorage.org/web/7c0/93a/e9d/7c093ae9db5c486f8bdfbed933ae577d.png"><br><br>  The results of the study showed that the participants most often used filters and search (71%).  Among the filters most actively used the filter in color, followed by filters in size and cost.  If we talk about recommenders, then most often they used collaborative filtering, and other tools - much less often. <br><br>  At the same time, the main share of conversion was generated by search (62%) and navigation using filters (83%).  This means that if the user is looking, he knows what he wants, and there is no need to disturb him.  Collaborative filtering, a ‚Äúput on‚Äù recommendation, style guide yielded less than 50% conversion.  This is explained by the fact that people do not want to look like others and tend to emphasize their individuality.  On the other hand, 50% is not bad, and with proper use such recommendations can be very effective.  For example, the section Occasion / event brought 100% conversion. <br><br>  Separately, it is worth noting that the sections Top seller's list, New in, seasonal offers brought 0% conversion.  This should not be taken as absolute indicators, since you need to remember the task: women chose not casual clothes, moreover, the choice did not depend on the season.  It means that in other conditions such recommendations could work. <br><br><h2>  Theory.  Types of recommendation systems </h2><br><br><img src="https://habrastorage.org/web/e37/fb5/755/e37fb5755f0846a8a226ccf710f2b775.png"><br><br>  Briefly consider how you can implement these or other recommendations. <br><br>  <b>1. Collaborative filtering</b> <br>  The idea of ‚Äã‚Äãthis approach is that there are users and elements that people evaluate in several ways: put likes, ratings, etc.  Based on them, a matrix of user ratings is built.  But since not everyone likes, this matrix is ‚Äã‚Äãsparse, and the task is to regress the missing estimates. <br><br>  There are two types of algorithms that implement this concept: <br><br>  ‚Ä¢ Neighborhood-based (Memory-Based) methods.  They help restore assessments explicitly, while maintaining a complete matrix of relationships, which is usually very large.  The main disadvantage of these methods is low efficiency due to the fact that they do not give a truly personalized assessment. <br>  <i>Examples of algorithms</i> : User-Based Filtering (UBCF), Item-Based Filtering (IBCF), Slope-One. <br><br>  ‚Ä¢ Model Based Methods.  Their idea is to identify hidden factors (user interests), on the basis of which people rate. <br><br>  <i>Examples of algorithms:</i> <i><br></i>  o Matrix Factorization (MF): Singular Value Decomposition (SVD, SVD ++, timeSVD ++, MSVD), Non-Negative MF (ALS), Factorization Machines, Probabilistic Matrix Factorization (PMF) <br>  o RBM (Restricted Bolzman Machines). <br>  o Incremental CF via Co-clustering (COCL, ECOCL) <br>  o Probabilistic Principle Component Analysis (pPCA), Probabilistic Latent Semantic Analysis (pLSA), Latent Dirichlet Allocation (LDA) and etc. <br><br>  The advantage of collaborative filtering is that for building recommendations, knowledge of the subject area in general is not needed, it is not necessary to know the details about items and users.  They cluster among themselves in the mode of self-organization. <br><br>  Disadvantage: cold start problem (cold start problem): if a new user or item appears, they will not be recommended, as there is no information and ratings. <br><br>  <b>2. Content based recommenders</b> <br>  To solve the cold start problem and recommend new elements, collaborative filtering is sometimes integrated with content based recommenders.  With this approach, you need to describe all the items.  But their properties are not always able to be collected for legal or technical reasons. <br><br>  <b>3. Demographic based recommendations</b> <br>  If a cold start occurred for the user, then we need to collect information about him and describe it. <br><br>  The general problem of the group of methods related to collaborative filtering is as follows.  They work well only when it comes to large amounts of data.  These methods are suitable for recommending objects whose choice depends on the taste of the user, for example, for recommending films or music.  But this approach is not effective when it is necessary to recommend such complex objects as cars, real estate, etc.  In this case, knowledge based recommenders can be used. <br><br>  <b>4. Knowledge based recommenders</b> <br>  It requires experts who evaluate the proposed objects and describe the criteria by which users choose them.  It is believed that these experts know everything: what type of users do you belong to, how much do you want to spend, what characteristics should the goods have to attract you.  Thus, the problem is solved for both users and items.  But there is a drawback: the experts are very expensive and unreliable people, so it is not always possible to describe all the rules for your catalog. <br><br>  <b>5. ontext-aware recommenders</b> <br>  Offline expert assessments may be erroneous and incomplete, since at the evaluation stage the context in which the user selects the item is unknown.  The context may change over time.  For example, you watched horror movies all the time, but suddenly you started looking for cartoons, because your children wanted to watch them.  From the point of view of the recommender, you are crazy, and he will continue to recommend horror films to you, assuming that one day you will come to your senses.  What really happened to you?  The context has changed, and we need to respond to this, which context-aware recommenders allow us to do. <br><br>  To effectively make contextual recommendations, you need to solve the Change Point Detection task in the sense of time series.  When the user's behavior changes dramatically, it means that the context has changed dramatically.  There are various methods that allow us to take into account the context: factorization machines, Byesian Probablistic Tensor Factorization. <br><br>  <b>6. Interactive recommenders</b> <br>  Their main goal is to select the options that are most relevant to their wishes in the current user session mode. <br><br>  <b>Life example</b> <br>  Remember yourself in a bar.  You want to have a great time.  You see beer taps and start to choose what to drink.  At this moment you are solving the problem: drinking unfamiliar (exploration) or familiar (exploitation) beer?  This is <b>Exploration vs.</b>  <b>Exploitation problem</b> .  It should be solved by interactive recommenders.  Approaches to solving this problem: <br><br>  1. Active learning (AL) allows the reduction of the search space. <br>  2. Multi-armed bandits (MAB) algorithms: E-greedy, UCB, LinUCB, Tomson Sampling, Active Thompson Sampling (ATS) <br>  3. Markov Decision Process (MDP) / Reinforcement Learning (RL) <br>  4. Hybrid scoring approaches could be considered - models composition used. <br><br><h3>  Main types of MAB algorithms </h3><br><br><img src="https://habrastorage.org/web/c3c/41f/908/c3c41f908218438e8d902d6fe708551f.png"><br><br>  1. E-greedy is just a frequency estimate: we choose this or that hand of our thug based on the frequency of its use.  We recall the taps in the bar: the more often we use one or another tap, the more we love this beer. <br><br>  2. Upper Confidence Bound (UCB) - we strive to evaluate the pleasure that the user will receive from the choice of a particular item.  The task is to accurately estimate this pleasure for each of the pens.  For new items in this algorithm, a potentially maximum reward rating is assigned.  Every time the gangster is pulled, a reward score is updated.  This algorithm will always lean toward exploration rather than exploitation, and cannot support the calculation of too many hands. <br><br>  3. Tomson Sampling (TS) can represent each of the hands of a gangster as a probability distribution and each time simply recalculate the probability when interacting with each of the hands.  Each hand is selected based on its history, and our goal is to minimize the total frustration that the user may experience when interacting with the MAB. <br><br>  As a rule, interactive recommenders do not use on their own, but combine, for example, with collaborative filtering.  In practice, linear UCB and Tompson Sampling + Probablistic Matrix Factorization performed well. <br><br><h3>  Little about features </h3><br>  To build recommenders, you need a dataset.  There should be features describing our model.  There are two types of features that you should know about: implicit and explicit feedback.  <b>Implicit feedback</b> is when the user scrolls, clicks, and so on.  And <b>explicit feedback</b> is when they obviously put likes or dislikes.  What is dangerous in the second?  Explicit feedback - ratings, likes, which users put - very much noise.  At the same time, implicit feedback - scrolls, clicks, views - works much better for recommendations.  It is less noisy, because it has nothing to do with the preferences of users, it does not depend on their mood and understanding of what ‚Äúscore from zero to five‚Äù is.  In order not to solve the problem of offsets, you can work with an implicit feedback.  It is clear that it is impossible to work only with it, and both signals must be taken into account.  Therefore, there are models that allow one to take into account both approaches. <br><br><h3>  Spotify recommender example </h3><br>  Spotify has a recommender of music.  They use collaborative filtering as a basis: they monitor user preferences, cluster them among themselves.  They also make a projection of the user's intent at a given point in time into the space of users' musical interests.  In addition, Spotify uses natural language processing (NLP) methods to analyze playlists.  He collects data on all playlists of users and says that your playlist is the same text document.  Here you can use the classic NLP tools, when we simply work with text and extract, for example, topics for a playlist.  In addition, they use deep learning to extract content.  They take the track, pass it through the deep neural network, extract features that users value in the song.  This is a content based recommender, made on the basis of deep learning.  So the company collects data about the items themselves. <br><br><h3>  Libraries and systems for creating recommendations </h3><br>  What gives us open source?  There are two levels of technical proposals: technical libraries and systems. <br><br>  The most powerful libraries are Spark MLLib, RankSys, LensKit.  There are Waffles, a C ++ library. <br>  There are higher-level tools than one library, machine learning servers.  The most interesting seems to me PredictionIO. <br><br>  Those who want to deal with recommenders should read the ‚ÄúRecommendation System Handbook, 2nd Edition‚Äù, which deals with different approaches to building recommenders, algorithms and their practical application. </div><p>Source: <a href="https://habr.com/ru/post/335114/">https://habr.com/ru/post/335114/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335102/index.html">Breakthrough in the business process automation market</a></li>
<li><a href="../335104/index.html">Solving a closed transport problem with additional conditions using Python tools</a></li>
<li><a href="../335106/index.html">Basics of working with LongPoll server VKontakte</a></li>
<li><a href="../335110/index.html">How the KOMPAS-3D math library turned into a C3D Toolkit for CAD developers ‚Üí part 2</a></li>
<li><a href="../335112/index.html">Model-View-Intent and Load / Update Indicator</a></li>
<li><a href="../335120/index.html">RailsClub 2017: we are waiting for all rubists on September 23 in Moscow</a></li>
<li><a href="../335122/index.html">Speed ‚Äã‚Äãup your website using machine learning.</a></li>
<li><a href="../335128/index.html">Getting started with Wagtail CMS (Django) and GraphQL</a></li>
<li><a href="../335132/index.html">Dedicated servers based on Intel Xeon processors Skylake-SP</a></li>
<li><a href="../335134/index.html">WiFiBeat: We detect suspicious traffic in a wireless network</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>