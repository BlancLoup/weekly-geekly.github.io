<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Orchard CMS: software content of the site</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagine a situation: it is necessary to transfer a large amount of some data to a site made on Orchard. For example, it may be an online store, site d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Orchard CMS: software content of the site</h1><div class="post__text post__text-html js-mediator-article">  Imagine a situation: it is necessary to transfer a large amount of some data to a site made on Orchard.  For example, it may be an online store, site directory, etc. <br><br>  Suppose we need to create a website - a catalog of cars.  For example, let's agree that for each car you need to store the model name, price, year of manufacture and the number of available cars.  Using the Orchard source code and a considerable number of articles on the topic of writing modules, we will create our own ContentType. <br><a name="habracut"></a><br>  <b>Model - Car class with properties Model, Price, Year, Quantity:</b> <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CarPartRecord</span></span> : <span class="hljs-title"><span class="hljs-title">ContentPartRecord</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Model { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span> Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Year { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Quantity { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CarPart</span></span> : <span class="hljs-title"><span class="hljs-title">ContentPart</span></span>&lt;<span class="hljs-title"><span class="hljs-title">CarPartRecord</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Model { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Record.Model; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { Record.Model = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span> Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Record.Price; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { Record.Price = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Year { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Record.Year; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { Record.Year = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Quantity { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Record.Quantity; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { Record.Quantity= <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } }</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>View:</b> <br><br><pre> <code class="cs hljs"> @T(<span class="hljs-string"><span class="hljs-string">"Model: "</span></span>) @Model.Model&lt;br /&gt; @T(<span class="hljs-string"><span class="hljs-string">"Price: "</span></span>) @Model.Price&lt;br /&gt; @T(<span class="hljs-string"><span class="hljs-string">"Year: "</span></span>) @Model.Year&lt;br /&gt; @T(<span class="hljs-string"><span class="hljs-string">"Quantity: "</span></span>) @Model.Quantity&lt;br /&gt;</code> </pre><br><br>  Well, let's say the content type is created.  The main problem is that the car catalog we need needs to be imported into Orchard.  How to do it? <br><br>  Obviously, if the data volume exceeds 50 records, I would like to add them to the CMS programmatically.  In Orchard, in order to write data through the database, it is necessary for each element to add records to <b>5</b> related tables: <br><br><ul><li>  <b>CarPartRecord_Name</b> </li><li>  <b>Common_CommonPartRecord</b> </li><li>  <b>Common_CommonPartVersionRecord</b> </li><li>  <b>Orchard_Framework_ContentItemRecord</b> </li><li>  <b>Orchard_Framework_ContentItemVersionRecord</b> </li></ul><br><br>  Then there are two options: use either SQL scripts or LINQtoSQL.  Personally, when I checked the first option, I could not do without the construction of the form <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> ...</code> </pre> <br>  with a large number of records (checked for 3000+), it leads to a completely unacceptable operating time (about a few hours). <br><br>  Therefore, we will focus on the second option: we will write a simple WinForms application, which we will import data. <br><br>  When you start the import, 5 functions should be sequentially called that add entries to each of the above tables, for example: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> CarPartRecord </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/*   CSV-, XMLNode       */</span></span></span></span></span><span class="hljs-function">)</span></span> { CarPartRecord record = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CarPartRecord(); record.Model = <span class="hljs-comment"><span class="hljs-comment">// record.Price = //   ContentPart record.Year = //  record.Quantity = // return record; } private Orchard_Framework_ContentItemRecord related1_create() { Orchard_Framework_ContentItemRecord record = new Orchard_Framework_ContentItemRecord(); record.ContentType_id = 9; //    "" CMS  8  ContentType,     return record; } private Orchard_Framework_ContentItemVersionRecord related2_create(CarPartRecord item) { Orchard_Framework_ContentItemVersionRecord record = new Orchard_Framework_ContentItemVersionRecord(); record.Number = 1; record.Latest = true; record.Published = true; record.ContentItemRecord_id = item.Id; return record; } private Common_CommonPartRecord related3_create(int id) //  ID  CarPartRecord { Common_CommonPartRecord record = new Common_CommonPartRecord(); record.CreatedUtc = DateTime.Now; record.ModifiedUtc = DateTime.Now; record.PublishedUtc = DateTime.Now; record.OwnerId = 2; record.Id = id; return record; } private Common_CommonPartVersionRecord related4_create(int id) //  ID  CarPartRecord { Common_CommonPartVersionRecord record = new Common_CommonPartVersionRecord(); record.CreatedUtc = DateTime.Now; record.ModifiedUtc = DateTime.Now; record.PublishedUtc = DateTime.Now; record.ContentItemRecord_id = id; record.Id = id; return record; }</span></span></code> </pre><br><br>  And, accordingly, in main: <br><br><pre> <code class="cs hljs">CarPartRecord record = create(<span class="hljs-comment"><span class="hljs-comment">/*   */</span></span>); context.CarPartRecords.InsertOnSubmit(record); <span class="hljs-comment"><span class="hljs-comment">//     context.SubmitChanges(); Orchard_Framework_ContentItemRecord tmp1 = related1_create(); //  ,    ID  CarPartRecord. context.Orchard_Framework_ContentItemRecords.InsertOnSubmit(tmp1); Orchard_Framework_ContentItemVersionRecord tmp2 = related2_create(record); context.Orchard_Framework_ContentItemVersionRecords.InsertOnSubmit(tmp2); Common_CommonPartRecord tmp3 = related3_create(record.Id); context.Common_CommonPartRecords.InsertOnSubmit(tmp3); Common_CommonPartVersionRecord tmp4 = related4_create(record.Id); context.Common_CommonPartVersionRecords.InsertOnSubmit(tmp4); context.SubmitChanges();</span></span></code> </pre><br><br>  As a result, the import of 3000+ entries will last about 100 seconds on a medium configuration machine.  Profit </div><p>Source: <a href="https://habr.com/ru/post/170759/">https://habr.com/ru/post/170759/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../170747/index.html">New domain zones such as ".cadillac," ".vegas," and ".music." will appear in April</a></li>
<li><a href="../170749/index.html">Making a VoIP GSM Gateway from Tp-link mr-3020 and Huawei E-171 - part one</a></li>
<li><a href="../170751/index.html">Nagios vs Icinga. The real story of one of the ‚Äúhottest‚Äù branches in free software</a></li>
<li><a href="../170755/index.html">Export favorites Habra in FB2 - high-speed PHP-version</a></li>
<li><a href="../170757/index.html">Master's program at the Academic University of the Russian Academy of Sciences: sharing experience</a></li>
<li><a href="../170761/index.html">Presentation of new phones at the exhibition MWC-2013</a></li>
<li><a href="../170763/index.html">Is IPTV over Wi-Fi a problem? Absolutely no problem!</a></li>
<li><a href="../170765/index.html">Writing an extension for Google Chrome (and publish it)</a></li>
<li><a href="../170767/index.html">More than plain vanilla scrum. Common practice with requirements</a></li>
<li><a href="../170769/index.html">Nokia 105 for 15 euros with a flashlight and a 800 mAh battery</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>