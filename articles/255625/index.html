<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Features of creating programs in NODEMCU ESP8266 for the ‚ÄúInternet of Things‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I started exploring the capabilities of the ESP8266 chip a couple of months ago. Initially, like most, I purchased the ESP-01 module, but almost immed...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Features of creating programs in NODEMCU ESP8266 for the ‚ÄúInternet of Things‚Äù</h1><div class="post__text post__text-html js-mediator-article">  I started exploring the capabilities of the ESP8266 chip a couple of months ago.  Initially, like most, I purchased the ESP-01 module, but almost immediately found a new solution at that time based on the ESD-12 module in the form of DEVKIT and nodeMCU firmware, which has VM LUA version 5.1.4 embedded (without debug and OS * modules ). <br><br><img src="https://habrastorage.org/files/9de/29d/93a/9de29d93aa64480c89819a680ac5c50a.jpg" alt="image"><br><br>  There are several ways to join the world of beauty - the ‚ÄúInternet of Things‚Äù.  You can take the ESP-01 module, in which 512 Kbytes of flash, there is a UART interface, a pair of ESP contacts, add an interface to the USB to subsequently rewire the flash to a larger volume.  For those who have no desire or ability to work on modifying the module, but I want to join and start programming right away, there is another way - this is the DEVKIT board mentioned above. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If we take into account the price difference of a solution of $ 10 - the choice is yours. <br><a name="habracut"></a><br><h4>  What is good about this DEVKIT module? </h4><br>  <b>First</b> , it already contains a UART-USB interface with a micro USB connector.  Therefore, to connect it to a computer, only a USB-microUSB cable is needed. <br><br>  <b>Secondly</b> , it has outputs of all available signals from the ESP8266.  Here is my connection diagram for the module of various sensors: <br><br><img src="https://habrastorage.org/files/310/540/3d4/3105403d4bdf4aa581c82735ac779b8c.jpg"><br><br>  To connect sensors to DEVKIT board contacts, I used a cable from an old computer to connect peripherals (disks, CD-ROMs, ports, etc.). As you see, I connected everything or almost everything to the module.  In the project - the frequency control of the engine and PID regulation of power plants (heaters and switches). <br><br>  <b>Thirdly</b> , the module already has flash 4 MB, and NODEMCU has a built-in spiffs file system. <br><br>  <b>Fourth</b> , it is possible to update the firmware from the cloud or via USB. <br><br>  <b>Fifth</b> , you can create multiple scripts on the LUA and write them to the file system. <br><br>  After that, via WIFI, you can call the necessary scripts for execution. <br><br>  The LUA extension library contains the following modules: <br><br>  <b>json, file, timer, pwm, i2c, spi, 1-wire, net, mqtt, coap, gpio, wifi, adc, uart and system api.</b> <br><br>  Board contracts can be programmed for <b>gpio, i2c, pwm.</b> <br>  Two firmware versions are available with the format of integers or real numbers. <br><br>  It should be noted that you can program your development on the SI. <br>  But the problem is that to debug every change in your program, you need to assemble a 200 KB firmware and load it into the module for about 1 minute.  Those.  how many mistakes - so many minutes. <br><br>  Another way is to debug the modules of the LUA and subsequently (if necessary) transfer them to the SI using the API SI for the LUA (I actually do this). <br><br>  One error is about 1-2KB and loading 1-2 seconds.  Those.  how many mistakes - so many seconds. <br><br><h4>  What are the disadvantages of this module? </h4><br>  The main disadvantage is that VM LUA executes LUA scripts only placed in the RAM of the crystal.  And this memory for scripts is only 20 KB.  This amount of memory is enough to execute the script in about 110 lines. <br>  Therefore, the creation of relatively large scripts for this module has its own specifics. <br><br>  <b>First</b> , it is necessary to divide the algorithm into linear blocks. <br>  <b>Second</b> , write these blocks into separate files of the module file system. <br>  <b>Third</b> , execute these modules using the dofile statement. <br><br>  When writing modules, you must adhere to the following rules: <br>  - At the end of each module, explicitly call the garbage collector; <br>  - To exchange data between modules, use global variables, and for calculations inside modules, local variables. <br><br>  As a result, the main lua program looks like this (one of the working options): <br><br>  - <b>dofile ('nk_start.lc')</b> - call the initial sensor initialization module <br>  - <b>function cb ()</b> - callback function for periodic measurement of sensor readings <br>  <b>collectgarbage ()</b> - call the garbage collector <br>  <b>if ip == nil then</b> <br>  <b>dofile ('wifi_1.lua')</b> - initialization function of a wifi station or server <br>  <b>end</b> <br>  - <b>if ip ~ = nil and is == nil then</b> <br>  <b>dofile ('srv_1.lua');</b>  - in this embodiment, a web server is implemented <br>  <b>is = 1;</b> <br>  <b>end</b> <br>  - <b>dofile ('cbAM2302.lc');</b>  - data acquisition from the humidity and temperature sensor AM2302 <br>  <b>dofile ('cb18b20.lua');</b>  - obtaining readings from DS18B20 temperature sensors (I have three) <br>  <b>dofile ('get_tp.lc');</b>  <b>dofile ('norm.lc');</b>  - receiving indications from the sensor of pressure and temperature (BMP180) <br>  <b>end</b> <br>  <b>tmr.alarm (3,1000,1, cb)</b> - discretization timer - calls the callback function.  sampling frequency 1 Hz <br><br>  Since in this program each module takes the place of the previous one, there may be many such modules.  All of them are stored in the file system. <br><br>  If you implement the algorithm of this program without using moduleization, then the program can only accommodate one sensor in the module‚Äôs memory (either AM2302, or 18b20, or BMP180). </div><p>Source: <a href="https://habr.com/ru/post/255625/">https://habr.com/ru/post/255625/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255611/index.html">Post Hawk. Reboot</a></li>
<li><a href="../255617/index.html">Center for technical creativity Edu Kraft: our history</a></li>
<li><a href="../255619/index.html">The most relevant examples of notifications about non-standard user behavior</a></li>
<li><a href="../255621/index.html">Dagaz: Kicks to common sense (part 5)</a></li>
<li><a href="../255623/index.html">Comparison of technical support of the largest software vendors in the field of network security</a></li>
<li><a href="../255627/index.html">Building signs and comparing images: global signs. Lectures from Yandex</a></li>
<li><a href="../255629/index.html">Reports and competitions for NeoQUEST-2015</a></li>
<li><a href="../255631/index.html">"Operator Overloading" in Scala</a></li>
<li><a href="../255633/index.html">Nakapcha Mail.Ru - captcha, which is not shown</a></li>
<li><a href="../255637/index.html">Is there a USB in this MK?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>