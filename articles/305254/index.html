<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ThinkPwn vulnerability in computer firmware was more serious than it seemed before</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few days ago, we wrote about the 0day Local Privilege Escalation (LPE) vulnerability in the UEFI firmware of Lenovo ThinkPad notebooks, which was th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ThinkPwn vulnerability in computer firmware was more serious than it seemed before</h1><div class="post__text post__text-html js-mediator-article">  A few days ago, we <a href="https://habrahabr.ru/company/eset/blog/304566/">wrote</a> about the 0day Local Privilege Escalation (LPE) vulnerability in the UEFI firmware of Lenovo ThinkPad notebooks, which was the subject of an interesting study of the security recorder under the nickname Cr4sh.  The demonstrated exploitation vector of the vulnerability allows you to disable the built-in hardware protection called SPI Protected Ranges, which is used to protect the chip's SPI flash-memory from data recording.  The vulnerability itself is present in one of the UEFI firmware drivers called SystemSmmRuntimeRt and allows you to execute arbitrary privileged SMM code in the system. <br><br><img src="https://habrastorage.org/files/dff/8d7/acc/dff8d7accfce4a52aafc6303e9a8a2f5.jpeg"><br><br>  In turn, Lenovo issued a security notification in which it indicated that it did not develop the vulnerable driver, as it requests the manufacturers of BIOS / UEFI firmware, which, in turn, use the operating time of Intel and AMD.  After that, it became clear that the range of laptops and computers vulnerable to ThinkPwn is not limited to Lenovo.  Although, apart from Lenovo, none of the manufacturers of computers and motherboards mentioned the vulnerability, it became <a href="https://github.com/Cr4sh/ThinkPwn/blob/master/README.TXT">known</a> that Hewlett-Packard Pavilion notebooks, computers with motherboards from GIGABYTE (Z68-UD3H, Z77X-UD5H, Z87MX-D3H, and others) were susceptible to it, Fujitsu LIFEBOOK laptops, as well as Dell. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><img src="https://habrastorage.org/files/e73/f07/fdb/e73f07fdbfef4de481e2290a69f46d14.png"><br>  Fig.  The decompiled code of the vulnerable driver from the flash-memory of the Gigabyte Z68-UD3H motherboard chip.  <i>(Cr4sh twitter)</i> <br><br><img src="https://habrastorage.org/files/ede/8fc/d25/ede8fcd2584e466a907a807f3cbbea5d.png"><br>  Fig.  Demonstration of successful exploit on a laptop Dell Latitude E6430. <br><br>  The vulnerability of ThinkPwn was fixed by Intel back in 2014, however, UEFI manufacturers still use the vulnerable version of the driver in the production of firmware.  The full scale of coverage of this vulnerability of computers is not entirely clear, as none of the UEFI vendors commented on this situation.  Obviously, we are talking about a significant number of different models of computers from different manufacturers, among them, Lenovo, Hewlett-Packard, GIGABYTE, Fujitsu, and Dell. <br><br>  As we indicated earlier, the ThinkPwn exploit uses a 0day vulnerability in SystemSmmRuntimeRt to execute its SMM code, which helps the exploit bypass the SMM LockBox security measure used to secure the UEFI Boot Script Table system structure.  This structure is the key to reset the SPI Protected Range registers when the computer is in S3 sleep mode.  By modifying the structure fields that are responsible for maintaining the SPI Protected Range registers with an SMM code, they can be subsequently loaded with zero values ‚Äã‚Äãinto the SPI registers themselves. <br><br>  ThinkPwn allows you to disable the write protection of the SPI flash-memory chip, which allows attackers to embed their backdoor or rootkit there to compromise the work of any OS at the lowest level.  This, in turn, can lead to bypassing the secure boot technology of Secure Boot or such authentic technologies as Virtual Secure Mode and Credential Guard on Windows 10. </div><p>Source: <a href="https://habr.com/ru/post/305254/">https://habr.com/ru/post/305254/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../305184/index.html">How to set up a network bridge (br0) on Ubuntu Linux 14.04 and 16.04 LTS</a></li>
<li><a href="../305188/index.html">Performance analysis of individual subsystems of the program for Linux perf report</a></li>
<li><a href="../305204/index.html">Roman Nester, co-founder of Segmento - about the future of advertising technologies on the Internet</a></li>
<li><a href="../305246/index.html">Big Binary in my Rust?</a></li>
<li><a href="../305252/index.html">2D magic in detail. Part one. Shine</a></li>
<li><a href="../305256/index.html">ORegex: Is it fast enough for objects?</a></li>
<li><a href="../305258/index.html">Win a weightless flight with Veeam and Zero Gravity (USA)</a></li>
<li><a href="../305262/index.html">Vulners - Google for a hacker. How is the best search engine for vulnerabilities and how to use it</a></li>
<li><a href="../305264/index.html">How we sent SMS from the old Nokia and the phone to Android</a></li>
<li><a href="../305268/index.html">How to answer the question - what is a "computer virus"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>