<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Intuitive revision of Vote Up / Down and User Karma (joyful emotions of a new drupalist)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to share the joy of the successful work done today (at an intuitive level) to refine the algorithms for calculating karma and user rating in Dr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Intuitive revision of Vote Up / Down and User Karma (joyful emotions of a new drupalist)</h1><div class="post__text post__text-html js-mediator-article"><img src="http://www.rdlt.com/wp-content/uploads/2009/09/drupal-man.png" align="left" hspace="10" width="100" alt="image">  I want to share the joy of the successful work done today (at an intuitive level) to refine the algorithms for calculating karma and user rating in Drupal 6. But first, you need to tell a little about my level of preparation so that it becomes clear how universal API and OOP principles adorn life for people.  I hope it will be useful for newbies, like me, and will help them overcome the first difficulties on the way of Drupal development.  Who wants to go directly to the essence of the article, scroll to the title "The long-awaited evaluation and karma." <br><br><a name="habracut"></a><br><br><h4>  The first acquaintance with web-programming and CMS </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Just over a year I am closely acquainted with such a concept as CMS.  Made a few normal (functional, diverse and loved by users) sites on Joomla, first 1.10, then 1.5 (I haven't gotten to 1.6 yet).  In this case, he always used only standard mechanisms.  Plug-in things (modules, plug-ins, components) set only in the original version.  I allowed my hands only to feel a little the templates (themes) and CSS.  Nowhere did not climb further. <br><br>  I am quite familiar with the basics of OOP, but I almost never came across the web application of these principles.  The principles are very similar and understandable.  Most of all difficulties, most likely because of a difference of terminology.  I was frightened for a long time by the phrase ‚Äúlearn the Drupal API‚Äù.  Or the word hook - "trap hook".  But when it came to the fact that hooks are, in essence, event handlers, it immediately became easier and more understandable. <br><br>  The peculiar inclusions of the executable code <code>&lt;?php ..... ?&gt;</code> Inside the html-pages are also somehow unusual, as well as the syntax of this new language for me.  Well, the geographical separation of your offspring is unusual: scripts and themes in one place, as if by themselves, and the database from which the basic information of the site is formed may be in a completely different country.  And from it it is necessary to pull the strings and knit pages.  Most of the course is automatically done, but, nevertheless ... <br><br><h4>  Why I changed Joomla </h4><br><br>  From laziness of brains and following the principle of a duckling, I tried my best not to get involved with anything other than Joomla.  But when it came to creating a collective blog with extensive voting options, I came to the conclusion that Drupal is better suited for this.  Or rather, it is perfect, while Joomla doesn‚Äôt fit at all (at least, this is my conviction after studying numerous comparisons and descriptions of the connected components to these two CMS). <br><br>  Acquaintance with something cardinally new, when you feel like a complete zero, a nothingness, killed and crushed by a large amount of incomprehensible information that needs to be processed and driven into the topic ... It's such a thrill.  I already have adrenaline gushing in the blood, that I can not sleep at night.  (But I do not brag that I do it effectively, but only emotionally). <br><br>  Along with studying Drupal, in parallel, I began to learn php and get acquainted with jQuery, as well as recall the lessons of SQL.  At first it was just a reading of the descriptions of different modules, their alternate connection and testing.  And then I began to look into the API, wrote my own module (first by the lesson, and now I finish my original one). <br><br><br><h4>  Long-awaited evaluation and karma </h4><br><br>  Immediately installed <a href="http://drupal.org/project/vote_up_down">Vote Up / Down</a> .  Oh, that was what I needed!  You can vote for nodes, comments and tags (sections of taxonomy). <br><br>  Then the task arose to accumulate estimates, merging them into a single figure of the user's rating.  The choice fell on <a href="http://drupal.org/project/user_karma">User Karma</a> .  This module made it possible to ideally embody an idea - to score points according to a certain algorithm, depending on user actions and votes through specified significance coefficients. <br><br>  For example, according to my algorithm, a bunch of rating consists of such flowers: <br><br>  Rating (Reputation) = Voices * 3 + VoicesComments * 1 + AdditionNo * 1 + LeftEvaluation * 0.2 <br><br>  You choose the sum amounts yourself, and prescribe the coefficients of their significance with pens.  You can also set the number of days after which the estimates will melt (but I felt sorry for the rating, and so tortured inflation in real life). <br><br>  But since I recently registered on Habr√©, I wanted to repeat the mechanism of karma, which is located here.  As if an indicator of support from the community.  How many people for you, and how many - against.  Not a vote for some of your material, but a vote for your personality.  Everyone can give you either one Plus or Minus.  And only once. <br><br>  A little googling in runet, I did not find the desired solution (for finalizing Vote Up / Down), and decided to understand the structure of the module for educational purposes.  And I immediately noticed that sub-modules in the folders vud_node, vud_comment, vud_term are responsible for all types of voting.  Having typed vud_user in Google, I found what I needed. <br><br>  In January of this year, one person <a href="http://drupal.org/node/1015958">raised the question of voting for users</a> , to which the developers of VoteUpDown responded that they would not realize this opportunity for Drupal 6, and for the 7th version they plan to vote for arbitrary fields of materials (as I understood, but not should trust my English.). <br><br>  In February, one person in the comments posted a sub-module vud_user, as he says, made it from the module vud_comment.  I downloaded it and earned it from me, just like karma on Habr√©, from which I was very happy. <br><br>  But then my joy gave way to deep thought.  After all, according to the logic of the intended Reputation, the voice for the user should also influence it, and very weighty.  And for this you need to modify User Karma. <br><br>  My inner instinct told me that I would hardly find such a refinement (small self-made things), and therefore made a strange move for me, relying only on intuition. <br><br>  The User Karma module consisted of 4 sub-modules. <br>  user_karma_receive_vote_node // - points when voting for your node <br>  user_karma_receive_vote_comment - vote for your comment <br>  user_karma_insert_node - adding an article <br>  user_karma_give_vote - your evaluation of materials <br><br>  I picked up the first one, and logically suited my _receive_vote_node and copied all the files associated with this sub-module.  And the word node in the names replaced by user. <br><br>  Going into these files, I made a ‚ÄúSearch - Replace‚Äù node ---&gt; user. <br><br>  And installed them on the site.  A new sub-module _receive_vote_node has appeared in the modules (admin) section.  Turn it on.  And in the settings of User Karma, a new addendum for ‚Äúvoting for the user‚Äù has appeared.  I asked him a factor of 10. Immediately entered the profile of a random user, after memorizing his rating.  Voted for him and updated, in anticipation of the growth of the reputation jump by 10. <br><br>  SQL started using Drupal, that the {user} table does not exist and there are no nid fields in it.  I fixed on {users} and uid respectively. <br><br>  And it all worked for me!  Just the way I wanted!  Now it is necessary for someone to vote for the user profile, as his rating soars by +10 (or drops by -10). <br><br>  So let's summarize my karma <s>dr ...</s> experiment. <br><br>  <a href="http://drupal.org/project/vote_up_down">Vote Up / Down</a> adds to your articles, comments and taxonomy terms buttons for voting, which, through chaos tools through Ajax, effectively work, changing the estimates in the eyes of the user.  Vote Up / Down also adds the scores to the database neatly on the shelves (user1 minus such and such usera2 comment in such and such article at 7-30 am, etc.).  Then you can use this information, for example, to calculate anonymous minusists, inadequate plusists and normal people, as well as sell offended voting results, which many people have cruelly pumped into karma, and they want to know: ‚Äúwho did it to me so much !? " <br><br>  <a href="http://drupal.org/project/user_karma">User Karma</a> aggregates all scores into a single number that clings to the user.  This is about the country's GDP.  Uncle Vasya dug 3 bags of potatoes, Abramovich dug 50 tons of diamonds, VAZ collected 100 thousand Kalin, Megaphone lost $ 2 million because of Skype - it would seem so many different numbers, and in the end we get a total figure that sums up all our joint efforts.  Russia's GDP in 2010  amounted to X billion rubles.  And all this bunch of pros and cons for nodes, comments, potatoes and diamonds, is ascribed to Russia as a result and appears in various reports as an indicator of its success. <br><br>  Because  it was my first attempt at modifying modules, it struck me most of all that I created a whole sub-module with serious customization options, in just a few keystrokes.  Given the fact that I am new to these matters, I was overwhelmed with euphoria of some kind that I even wanted to share. <br><br>  The moral of the story, I think, is this: ‚ÄúThis is what the universalization of function names and a well-thought-out API lead to.‚Äù  In Drupal everything is very strict and thoughtful.  Beginners, do not be afraid, learn the logic of the API and will soon be able to work wonders on the fly in web programming. <br><br>  Given the fact that I myself am a novice in Drupal and on Habr√©, I will be glad if I don‚Äôt have the opportunity to write here, as well as advice to correct my understanding of some things that I don‚Äôt understand yet.  Thanks for attention. <br><br>  Well, most of all I dream of making good experienced friends who would help me master Drupal. </div><p>Source: <a href="https://habr.com/ru/post/116740/">https://habr.com/ru/post/116740/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116734/index.html">Files Over Miles: P2P via browser</a></li>
<li><a href="../116735/index.html">Web 2.0 Expo 2011: social networks will tell your inside story, and the "clouds" will turn the IT market</a></li>
<li><a href="../116736/index.html">Goodbye, Gnome!</a></li>
<li><a href="../116738/index.html">Script LizaMoon found already on 500 thousand sites</a></li>
<li><a href="../116739/index.html">The new Google service will allow you to find information about a person by his photo.</a></li>
<li><a href="../116741/index.html">Django PR Hero project: what's inside and the experience gained</a></li>
<li><a href="../116747/index.html">Once again about port forwarding due to firewall</a></li>
<li><a href="../116748/index.html">Motorola Milestone 2 Review</a></li>
<li><a href="../116749/index.html">Microcomputer BK 0010-01</a></li>
<li><a href="../116752/index.html">Draw widgets in the title bar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>