<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Programming and debugging ARM Cortex-M4 microcontrollers by Atmel in the environment of the Linux operating system. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuation of the electronic version of the article from issue No. 2 for 2016 of the magazine Components and Technologies . Posted by Andrey Kurnits...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Programming and debugging ARM Cortex-M4 microcontrollers by Atmel in the environment of the Linux operating system. Part 2</h1><div class="post__text post__text-html js-mediator-article">  <i><b>Continuation of the electronic version of the article from issue No. 2 for 2016 of the magazine <a href="http://www.kit-e.ru/">Components and Technologies</a> .</b></i>  <i><b>Posted by Andrey Kurnits.</b></i>  <i><b>Link to the <a href="https://habrahabr.ru/company/rainbow/blog/281665/">first part</a></b></i> <br><br><h4>  Creating, running and debugging a primitive program on the Atmel SAM4S microcontroller </h4><br>  Now that the software for development of Atmel SAM4S microcontrollers has been installed and configured on the workstation, you can make sure that the system is working by creating a simple program that will light and turn off the LED on the SAM4S-EK board. <br>  In order to build a workable program for the microcontroller, in addition to the GCC tools, the following components are needed: <br><ol><li>  The CMSIS (Cortex Microcontroller Software Interface Standard) library describes a single interface for interacting with the core of ARM Cortex-M microcontrollers - common for ARM Cortex-M microcontrollers of various manufacturers. </li><li>  The library for interacting with the periphery of this family of microcontrollers is different for each manufacturer, be it Atmel, STMicroelectronics, NXP, etc. </li><li>  The linker script is a file with instructions on how to place the program in the microcontroller‚Äôs flash memory, as well as on the service areas (sections) in RAM: stack, heap, etc. For different microcontrollers with different memory sizes, different linker scripts are used respectively. </li><li>  The syscalls.c file contains system functions necessary for the operation of the standard C library (implementation newlib).  Usually these functions are part of the operating system for which the program is intended.  However, in the case of a microcontroller, which most often works without an operating system, the syscalls.c file must be included in the assembly, which contains mostly empty system functions [10]. </li><li>  In fairness it should be noted that there are many operating systems designed specifically for microcontrollers. </li><li>  The initial initialization code (startup code) is responsible for filling the interrupt vector table with corresponding handlers, including the microcontroller interrupt handler (reset handler). </li><li>  Also contains an implementation of the interrupt handler for resetting, which resets the necessary memory sections, initializes the standard C library and transfers control to the program's entry point - to the main () function. </li></ol><a name="habracut"></a><br><br><h4>  Atmel Software Framework Library </h4><br>  To create programs for its microcontrollers, Atmel freely distributes the Atmel Software Framework library (ASF) for C / C + languages, which contains all 5 components from the list above that are required to build the program. <br>  The ASF library provides a high-level interface, one for microcontrollers of different families and architectures: megaAVR, AVR XMEGA, AVR UC3 and SAM.  The ASF library contains examples of working with various peripheral units of microcontrollers, as well as with external devices located on various evaluation boards. <br>  Such a variety of supported microcontrollers adversely affected the ease with which the ASF library was mastered.  The library turned out to be very complex, confusing and large in size (archive ~ 400 MB, containing more than 70,000 files). <br>  Even though the ASF library can be downloaded separately [8] and it is designed to use the GCC compiler as well, however, the author failed to manually extract the necessary files from the library to create the simplest program for the Atmel SAM4S16C microcontroller. <br>  The author suggests this way: <br>  1.To get a minimal compiled project use the Atmel Studio IDE integrated development environment designed for Windows operating systems and based on Microsoft Visual Studio 2013. <br>  2. In the future, "manually" add the necessary components to the resulting project by copying them from a separately loaded ASF library. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Atmel Studio IDE </h4><br>  The Atmel Studio IDE is free and can be downloaded from the official website [ <a href="http://www.atmel.com/tools/ATMELSTUDIO.aspx">9</a> ].  During installation, you should select the ARM architecture on the computer or virtual machine running Windows and specify whether you need to install the ASF library (Fig. 5). <br><img src="https://habrastorage.org/files/5f2/51c/05a/5f251c05a89249db81ea8206e77f2587.png"><br>  Fig.  5. Features installation Atmel Studio IDE. <br><br>  After installation, you should run the Atmel Studio IDE and create a new project by selecting the menu item "File -&gt; New -&gt; Project ...".  Next, select the project type ‚ÄúGCC C ASF Board Project‚Äù, as shown in Fig.  6 <br><img src="https://habrastorage.org/files/25f/83b/638/25f83b6383e6401c8272cdd80b46fa86.png"><br>  Fig.  6. Select the type of project in the Atmel Studio IDE. <br><br>  Next, a window opens to select the hardware platform for which the project will be assembled (Fig. 7) <br><img src="https://habrastorage.org/files/b32/f7b/7f0/b32f7b7f08114a949c4f2db930225f74.png"><br>  Fig.  7. Microcontroller selection <br><br>  You can enter the name of the microcontroller, but in this case it is easier to set the name of the evaluation board.  To do this, select the ‚ÄúSelect by Board‚Äù item and select the name ‚ÄúSAM4S-EK‚Äù (Fig. 7).  In the list below, select the item with the name of the microcontroller "ATSAM4S16C" and click "Ok". <br>  After the project is created, the source code files will be placed in the previously specified (Fig. 6) directory (in the case of the author, c: \ Users \ andrey_k \ Documents \ Atmel Studio \ 7.0 \ GccBoardProject1 \ GccBoardProject1 \ src). <br>  The src directory can now be transferred to the Linux operating system in the project directory, for example, to the ~ / sam / directory.  Its structure is shown in fig.  eight. <br><img src="https://habrastorage.org/files/fbf/b75/963/fbfb75963eab45399f9af690538e587d.png"><br>  Fig.  8. The structure of the simplest project <br><br>  Attention should be paid to the location: <br><ol><li>  The linker script is the file ~ / sam / src / ASF / sam / utils / linker_scripts / sam4s / sam4s16 / gcc / flash.ld </li><li>  The initialization code and the interrupt vector table are located in ~ / sam / src / ASF / sam / utils / cmsis / sam4s / source / templates / gcc / startup_sam4s.c </li><li>  The syscalls.c file is located in ~ / sam / src / ASF / sam / utils / syscalls / gcc directory. </li></ol><br><br><h4>  Add module from ASF library </h4><br>  At the moment, there is no delay.h component in the project, which is required to get delays for exactly the specified time (this is needed for the LED to ‚Äúflash‚Äù).  The following shows how as the project grows, add the necessary components from the ASF library ‚Äî for example, the delay.h component.  To add it, you need to copy from the separately downloaded archive of the ASF library [ <a href="http://asf.atmel.com/docs/latest/download.html">8</a> ] the file common / services / delay / delay.h and the directory with all the files common / services / delay / sam / to the project directory ~ / sam / src / ASF / common / services / delay. <br>  In addition, you must include the component delay.h in the assembly by adding a line at the end of the ~ / sam / src / asf.h file: <br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;delay.h&gt;</span></span></span></span></code> </pre> <br>  As you can see, adding individual components from the ASF library to the project does not present much difficulty. <br><br><h4>  The code of the simplest program </h4><br>  The listing of the main.c file is shown below: <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;asf.h&gt; int main (void) { board_init(); sysclk_init(); while (1) { LED_On(LED1_GPIO); delay_ms(500); LED_Off(LED1_GPIO); delay_ms(500); } return 0; }</span></span></span></span></code> </pre><br><br>  The board_init () function initializes the input / output (GPIO) ports of the microcontroller in accordance with the external electronic components connected to them, including configuring the input / output ports as outputs for turning on / off the LEDs located on the board.  The board_init () function is in the src / ASF / sam / borads / sam4s_ek / init.c file. <br>  You can choose which ports will be initialized, and which will not, using macros in the src / config / conf_borad.h file. <br>  The sysclk_init () function is responsible for initializing the microcontroller clock unit.  After reset, the built-in 4 MHz RC generator is turned on [ <a href="http://www.atmel.com/images/atmel-11100-32-bit%2520cortex-m4-microcontroller-sam4s_datasheet.pdf">12</a> ].  The sysclk_init () function activates a generator operating from an external crystal oscillator at 12 MHz, and also adjusts the PLL phase locked loop so that the clock frequency of the microcontroller core is 120 MHz. <br>  You can change the clocking settings by changing the macro definitions in the src / config / conf_clock.h file. <br>  Then, in an infinite loop, the functions of turning on and off the evaluation LEDs are successively called: LED_On () and LED_Off ().  As an argument, the LED1_GPIO macro is passed, which corresponds to the green LED connected to the port PA20.  The LED_On (), LED_Off () and LED1_GPIO macros functions are defined in the source files in the src / ASF / sam / borads / sam4s_ek / directory, which contains, among other things, the description of connecting LEDs to the microcontroller pins. <br>  Calling the function delay_ms (500), which is included in the previously added module delay.h, results in a delay of 0.5 seconds.  The delay is implemented by empty microcontroller cycles, and there is no need to worry about accounting for the microcontroller clocking frequency - the current frequency is taken into account inside the ASF library after calling the sysclk_init () function. <br><br><h4>  Build with QBS Automation </h4><br>  To get the executable firmware file you need to compile a fairly large number of files.  Atmel offers to use makefiles, which are instructions to the GCC compiler. <br>  The author proposes to use QBS [1 ]‚Äôs build automation environment built into Qt Creator.  To do this, you will need to create a QBS project file containing information about the source files to be compiled. <br>  One of the advantages of QBS is that there is no need to manually enter the name of each file with the source code in the QBS file - it is enough to specify the directories of the files, the rest will be done by the system itself. <br><br><div class="spoiler">  <b class="spoiler_title">QBS text file</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> qbs <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> qbs.FileInfo <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> qbs.ModUtils Project { CppApplication { type: [<span class="hljs-string"><span class="hljs-string">"application"</span></span>, <span class="hljs-string"><span class="hljs-string">"ucfw"</span></span> ] Depends { name: <span class="hljs-string"><span class="hljs-string">"cpp"</span></span> } consoleApplication: <span class="hljs-literal"><span class="hljs-literal">true</span></span> cpp.positionIndependentCode: <span class="hljs-literal"><span class="hljs-literal">false</span></span> cpp.executableSuffix: <span class="hljs-string"><span class="hljs-string">".elf"</span></span> cpp.includePaths: [ <span class="hljs-string"><span class="hljs-string">"src"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/boards"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/services/clock"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/services/clock/sam4s"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/services/gpio"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/services/gpio/sam_gpio"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/services/ioport"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/services/ioport/sam"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/services/delay"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/services/delay/sam"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/utils"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/common/utils/interrupt"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/boards"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/boards/sam4s_ek"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/drivers/pio"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/drivers/pmc"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/utils"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/utils/cmsis/sam4s/include"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/utils/cmsis/sam4s/include/component"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/utils/cmsis/sam4s/include/instance"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/utils/cmsis/sam4s/include/pio"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/utils/header_files"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/sam/utils/preprocessor"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/ASF/thirdparty/CMSIS/Include"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/config"</span></span> ] cpp.defines: [ <span class="hljs-string"><span class="hljs-string">"__SAM4SA16C__"</span></span>, <span class="hljs-string"><span class="hljs-string">"BOARD = SAM4S_EK"</span></span> ] cpp.commonCompilerFlags: [ <span class="hljs-string"><span class="hljs-string">"-mcpu=cortex-m4"</span></span>, <span class="hljs-string"><span class="hljs-string">"-mthumb"</span></span>, <span class="hljs-string"><span class="hljs-string">"-mfloat-abi=soft"</span></span> ] cpp.linkerFlags: [ <span class="hljs-string"><span class="hljs-string">"-mcpu=cortex-m4"</span></span>, <span class="hljs-string"><span class="hljs-string">"-mthumb"</span></span>, <span class="hljs-string"><span class="hljs-string">"-mfloat-abi=soft"</span></span>, <span class="hljs-string"><span class="hljs-string">"-Xlinker"</span></span>, <span class="hljs-string"><span class="hljs-string">"--gc-sections"</span></span> ] <span class="hljs-comment"><span class="hljs-comment">//  -    . Properties { condition: qbs.buildVariant === "debug" cpp.debugInformation: true cpp.optimization: "none" } Properties { condition: qbs.buildVariant === "release" cpp.debugInformation: false cpp.optimization: "small" } //   DEBUG,   "". Properties { condition: cpp.debugInformation cpp.defines: outer.concat("DEBUG") } //    cpp.linkerScripts: [ "src/ASF/sam/utils/linker_scripts/sam4s/sam4s16/gcc/flash.ld" ] //        "sources" Group { name: "sources" prefix: "./src/**/" files: [ "*.c", "*.cpp", "*.h", "*.s" ] cpp.cxxFlags: [ "-std=c++11" ] cpp.cFlags: [ "-std=gnu99" ] cpp.warningLevel: "all" } //      "ldscripts" Group { name: "ldscripts" prefix: "./src/**/" files: "*.ld" } //   "others"    OpenOCD Group { name: "others" prefix: "./**/" files: [ "*.cfg" ] } //    : // 1.       size    GCC // 2.       Intel HEX // 3. ""      OpenOCD Rule { id: flashing //     "" condition: qbs.buildVariant === "release" inputs: ["application"] Artifact { fileTags: ["ucfw"] // !!!     type  CppApplication!!! filePath: input.baseDir + "/" + input.baseName + ".hex" } prepare: { //   var sizePath = "arm-none-eabi-size"; var argsSize = [input.filePath]; var cmdSize = new Command(sizePath, argsSize); cmdSize.description = "Size of sections:"; cmdSize.highlight = "linker"; //     Intel HEX var objCopyPath = "arm-none-eabi-objcopy"; var argsConv = ["-O", "ihex", input.filePath, output.filePath]; var cmdConv = new Command(objCopyPath, argsConv); cmdConv.description = "converting to HEX: " + FileInfo.fileName(input.filePath); cmdConv.highlight = "linker"; //   var flashUtilityPath = "openocd"; var cmd1 = 'flash write_image erase' + ' ' + input.filePath; var argsFlash = [ "-f", "interface/jlink.cfg", "-f", "board/atmel_sam4s_ek.cfg", "-c", "init", "-c", "halt", "-c", cmd1, "-c", "reset", "-c", "shutdown"]; var cmdFlash = new Command(flashUtilityPath, argsFlash); cmdFlash.description = "flashig to uC: " + FileInfo.fileName(output.filePath); cmdFlash.highlight = "linker"; //    3  return [cmdSize, cmdConv, cmdFlash]; } } } }</span></span></code> </pre><br></div></div><br><br>  In case of a successful release of an assembly (release ‚Äî that is, not for debugging, final), the QBS file contains instructions to perform the following actions: <br><ol><li>  Print the size of the firmware to the console, </li><li>  convert firmware file from ELF format to Intel HEX format </li><li>  Upload the file to the target microcontroller via the SAM-ICE adapter using the OpenOCD program </li></ol><br><br><h4>  Conclusion </h4><br>  As a result of the above actions, an ecosystem has been created for the development of Atmel SAM4S microcontrollers, consisting entirely of freely distributed programs.  Ecosystem is easy to modify to use another ARM microcontroller from Atmel. <br>  Download the finished project at [ <a href="http://www.sourceware.org/newlib/libc.html">11</a> ].  To use it, you will need the Ubuntu operating system or a derivative of it (Lubuntu, Kubuntu, Xubuntu) with the installed packages: <br><ul><li>  GCC tools for ARM microcontrollers [1] </li><li>  Qt Creator Development Environment [1] </li><li>  OpenOCD program (installation described above) </li></ul><br><br><h4>  Literature </h4><br><ol><li>  Kurnits A. Development for STM32 microcontrollers in the environment of the Linux operating system // Components and technologies.  2015. ‚Ññ 10. </li><li>  <a href="http://www.sourceforge.net/projects/openocd">www.sourceforge.net/projects/openocd</a> </li><li>  <a href="http://www.we.easyelectronics.ru/CADSoft/ubuntueclipse-code-sourcery-openocd-j-link-arm-ilibystryy-start-dlya-somnevayuschihsya.html">www.we.easyelectronics.ru/CADSoft/ubuntueclipse-code-sourcery-openocd-j-link-arm-ilibystryy-start-dlya-somnevayuschihsya.html</a> </li><li>  <a href="http://www.microsin.net/programming/arm/openocdmanual-part1.html">www.microsin.net/programming/arm/openocdmanual-part1.html</a> </li><li>  <a href="http://www.microsin.net/programming/ARM/openocdmanual-part2.html">www.microsin.net/programming/ARM/openocdmanual-part2.html</a> </li><li>  <a href="http://www.microsin.net/programming/ARM/openocdmanual-part3.html">www.microsin.net/programming/ARM/openocdmanual-part3.html</a> </li><li>  <a href="http://www.openocd.org/doc/html/General-Commands.html">www.openocd.org/doc/html/General-Commands.html</a> </li><li>  <a href="http://www.asf.atmel.com/docs/latest/download.html">www.asf.atmel.com/docs/latest/download.html</a> </li><li>  <a href="http://www.atmel.com/tools/ATMELSTUDIO.aspx">www.atmel.com/tools/ATMELSTUDIO.aspx</a> </li><li>  <a href="http://www.sourceware.org/newlib/libc.html">www.sourceware.org/newlib/libc.html#Syscalls</a> </li><li>  <a href="http://www.e-kit.ru/">www.e-kit.ru</a> </li><li>  <a href="http://www.atmel.com/images/atmel-11100-32-bit%2520cortex-m4-microcontroller-sam4s_datasheet.pdf">www.atmel.com/images/atmel-11100-32-bit%20cortex-m4-microcontroller-sam4s_datasheet.pdf</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/281715/">https://habr.com/ru/post/281715/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../281691/index.html">What is the difference between the Everyone and Authenticated Users groups?</a></li>
<li><a href="../281703/index.html">This will not be in BI (By purchasing the BI tool, you will not get it)</a></li>
<li><a href="../281707/index.html">How to win the game with unknown rules?</a></li>
<li><a href="../281709/index.html">Dcoin on iOS ... and Kate. The final</a></li>
<li><a href="../281711/index.html">Vertical indents or again about the margin</a></li>
<li><a href="../281717/index.html">Ladies Code Conference: Girls at IT April 26 in Moscow</a></li>
<li><a href="../281719/index.html">The main issue of programming, refactoring and all that</a></li>
<li><a href="../281721/index.html">AngularJS: Migration from 1.2 to 1.4, part 2</a></li>
<li><a href="../281723/index.html">On the issue of availability</a></li>
<li><a href="../281725/index.html">News of the world of IT. April</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>