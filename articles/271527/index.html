<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Manage the real world things from the virtual world of Minecraft (translation)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I started playing Minecraft again. Vanilla Minecraft is somewhat boring, as for me, and I always look for modpacks (add-on packs). Looking f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Manage the real world things from the virtual world of Minecraft (translation)</h1><div class="post__text post__text-html js-mediator-article">  Recently, I started playing Minecraft again.  Vanilla Minecraft is somewhat boring, as for me, and I always look for modpacks (add-on packs).  Looking for new modpaks, I stumbled upon <a href="http://ftbwiki.org/Feed_The_Beast_Horizons:_Daybreaker">FTB Horizons: Daybreaker</a> .  From the list of mods contained in it, my attention was attracted by the <a href="http://minecraft.curseforge.com/projects/opencomputers">OpenComputers</a> mod. <br><br>  As the name suggests, the OpenComputers module adds computers to Minecraft.  Real computers!  However, they are also modular.  You can add peripherals: from monitors to keyboards and expansion cards that add features such as graphics and networking.  And these computers can be programmed in <a href="http://www.lua.org/">Lua</a> , right in the game.  And there is such a kind of maps, as an Internet card, which you can imagine, can connect to the Internet of the real world.  Not bad. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c6b/660/447/c6b66044731eee9761de7d4a24a4ad0e.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So what can we do in about one hour of free time? <br><a name="habracut"></a><br>  I had a couple of light bulbs with WiFi, would it really be nice to manage them from Minecraft?  My wifi-bulbs are unknown devices <a href="http://rover.ebay.com/rover/1/711-53200-19255-0/1%3Ficep_ff3%3D9%26pub%3D5575146780%26toolid%3D10001%26campid%3D5337781269%26customid%3D%26icep_uq%3DWifi%2BLamp%26icep_sellerId%3D%26icep_ex_kw%3D%26icep_sortBy%3D12%26icep_catId%3D%26icep_minPrice%3D%26icep_maxPrice%3D%26ipn%3Dpsmain%26icep_vectorid%3D229466%26kwid%3D902099%26mtid%3D824%26kw%3Dlg">found on eBay</a> <img src="https://habrastorage.org/getpro/habr/post_images/e1c/4f2/75e/e1c4f275efb76d296c6ae9e305e32910.gif">  that were driven by an awkward mobile app.  My friend Thomas did the reverse-engineering of the protocol and I was able to control their color and state via TCP on port 5577. So, I have everything I need, what's next? <br><br><h4>  Getting tinkering </h4><br>  First of all, I launched Minecraft.  Next, I created a new world in Minecraft and entered the game.  I switched to creative mode, which means I could bring everything I wanted into the game, and built OpenComputers a computer.  There are a lot of <a href="http://ocdoc.cil.li/">instructions</a> on this, but it‚Äôs still a little time to figure out how such computers work.  After some trial and error, I had a working computer and I could create a TCP connection with the real world! <br><br>  The protocol used by the light bulb is quite simple, one byte of the header (header byte), three additional bytes defining the color in the RGB format, and a byte determining the brightness of the white (RGBW bulb), and one byte switching between the RGB mode and the white mode, and the closing byte (footer byte ).  Simple enough! <br><br> <code>0x56 RED GREEN BLUE WHITE MODE 0xAA <br></code> <br><br>  In vanilla Minecraft there is a redstone (‚Äúred dust‚Äù), the equivalent of electricity in our world.  By default, various blocks are supported such as levers, pistons, comparators, etc.  People create really complex designs using Redstone, such as a <a href="http://habrahabr.ru/post/243175/">real processor</a> .  OpenComputers computers work from redstone, so we can read the binary value of the state of the Maynkraftovskogo lever: "on" or "off" and switch the WHITE byte to turn on or off the light bulb. <br><br>  This is a computer that I built in the game, it has 6 monitors that make up one large monitor, a hard disk and a Redstone lever connected to the right by a red dust line: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5dd/dd4/db5/5dddd4db5c463bc5cf6fa65436d44757.jpg" alt="image"><br><br><h4>  We put it all together </h4><br>  So, we have a computer, a way to control a computer and incoming signals.  We also have a path and protocol for communicating with a light bulb.  The last element of the puzzle is a program that starts on a computer and revives the entire system.  First of all, I started a hard drive in Minecraft.  When writing information to a hard disk, the OpenComputers computer creates a directory with unique identifiers in the Minecraft file directory.  This way I can add, edit and delete files from my computer on the computer in the game. <br><br>  As an editor, I used <a href="http://www.sublimetext.com/">Sublime Text</a> , in my opinion, writing code on a computer in a game is not very convenient.  And after some research and errors, I wrote the following script: <br><br><pre> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> event = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'event'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> net = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'internet'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> myEventHandlers = {} <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-built_in"><span class="hljs-built_in">running</span></span> = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> con = net.<span class="hljs-built_in"><span class="hljs-built_in">open</span></span>(<span class="hljs-string"><span class="hljs-string">'192.168.1.110'</span></span>, <span class="hljs-number"><span class="hljs-number">5577</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myEventHandlers.key_up</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(address, char, code, playerName)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">char</span></span> == <span class="hljs-string"><span class="hljs-string">'q'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">running</span></span> = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">'Goodbye '</span></span> .. playerName .. <span class="hljs-string"><span class="hljs-string">'!'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myEventHandlers.redstone_changed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_, address, side)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> brightness = <span class="hljs-number"><span class="hljs-number">0xff</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> side &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> brightness = <span class="hljs-number"><span class="hljs-number">0xff</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> brightness = <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">'Sending '</span></span> .. brightness .. <span class="hljs-string"><span class="hljs-string">' to lamp...'</span></span>) con:<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">0x56</span></span>)) con:<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">0x00</span></span>)) con:<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">0x00</span></span>)) con:<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">0x00</span></span>)) con:<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(brightness)) con:<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">0x0f</span></span>)) con:<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">0xaa</span></span>)) con:<span class="hljs-built_in"><span class="hljs-built_in">flush</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(eventID, ...)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> event = myEventHandlers[eventID] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> event(...) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> con <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">'Connected to the bulb!'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-built_in"><span class="hljs-built_in">running</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> handleEvent(event.pull()) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  The Lua program, when executed, responds to two events (events): ‚Äúkey_up‚Äù and ‚Äúredstone_changed‚Äù.  The first occurs when a key is pressed while the program is running, and the last is when a redstone signal is received. <br>  Now we have the main event loop, and it was possible to implement simple logic. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3d8/a38/51b/3d8a3851b1598b0a70ba9feee2938e7e.gif" alt="image"><br><br>  First of all, if the 'q' key is pressed, the program ends.  When a redstone signal is received, the program converts the position of the lever to '0x00' or '0xFF', which means switching on and off the wifi-lamp.  Packets are transmitted through the channel and the lamp responds accordingly.  Finally, a TCP connection is opened when the program starts.  Simple and works! <br><br>  References: <br><ul><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B5%25D1%2582%25D0%25B2%25D1%2591%25D1%2580%25D1%2582%25D0%25B0%25D1%258F_%25D1%2581%25D1%2582%25D0%25B5%25D0%25BD%25D0%25B0_(%25D1%2582%25D0%25B5%25D1%2580%25D0%25BC%25D0%25B8%25D0%25BD)">Fourth wall (term)</a> </li><li>  <a href="http://hashbang.gr/breaking-the-4th-wall-with-minecraft/">original article</a> </li><li>  <a href="http://www.dx.com/p/e27-7w-550lm-rgbw-15-led-smart-phone-wi-fi-music-control-color-temperature-light-bulb-855-240v-280632%3FUtm_rid%3D53287861%26Utm_source%3Daffiliate">WiFi model used by the author on dx.com</a> </li><li>  <a href="https://news.ycombinator.com/item%3Fid%3D10611442">Hacker News Talk</a> </li><li>  <a href="https://github.com/MightyPirates/OpenComputers">OpenComputers on github</a> </li><li>  <a href="http://www.minecraftforum.net/forums/mapping-and-modding/minecraft-mods/1293018-opencomputers-v1-5-20">OpenComputers on Minecraft Forum</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/271527/">https://habr.com/ru/post/271527/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271505/index.html">Work iOS App in the background</a></li>
<li><a href="../271507/index.html">The world's first floating data center launched</a></li>
<li><a href="../271511/index.html">Superfish: return</a></li>
<li><a href="../271515/index.html">How to solder "bridges" and chips on motherboards using a soldering station</a></li>
<li><a href="../271521/index.html">What is the difference between SSL certificates from Namecheap? Encryption, verification and trust</a></li>
<li><a href="../271529/index.html">Black Friday at the Russian VDS-hoster</a></li>
<li><a href="../271531/index.html">Conference DotNext 2015 Moscow: final program and review of reports</a></li>
<li><a href="../271533/index.html">Carefully, true class contracts may differ from formal</a></li>
<li><a href="../271535/index.html">Preview Android Studio 2.0 is available: two uber features</a></li>
<li><a href="../271537/index.html">Install and configure LXC on Debian 8</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>