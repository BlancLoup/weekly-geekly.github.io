<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create applications using Firebird, jOOQ and Spring MVC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. This time, the process of creating a Java web application using the Spring MVC framework, jOOQ library and Firebird DBMS will be described. 

 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create applications using Firebird, jOOQ and Spring MVC</h1><div class="post__text post__text-html js-mediator-article">  Hello.  This time, the process of creating a Java web application using the Spring MVC framework, jOOQ library and Firebird DBMS will be described. <br><br>  To simplify development, you can use one of the common IDEs for Java (NetBeans, IntelliJ IDEA, Eclipse, JDeveloper, or others).  I personally used NetBeans.  For testing and debugging, we also need to install one and web servers or application servers (Apache Tomcat or Glass Fish). Create a project based on the Maven template of the web application project. <br><a name="habracut"></a><br>  After creating a project based on a template, you need to convert its folder structure so that it is correct for MVC Spring 4. If the project was created in NetBeans 8.2, then the following steps are necessary: <br><br><ol><li>  Delete index.html file </li><li>  Create a WEB-INF folder inside the Web Pages folder </li><li>  Inside the WEB-INF folder create jsp, jspf and resources folders </li><li>  Inside the resources folder we create js and CSS folders </li><li>  Inside the jsp folder create the file index.jsp </li></ol><br>  After our manipulations, the folder structure should look like this. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/web/31d/ddb/fe0/31dddbfe048246188396c88881f26c37.png"><br><br>  In the WEB-INF / jsp folder, the jsp page will be placed, and in the jspf folder, parts of the pages that will be connected to other pages using the instructions: <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">include</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">file</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"&lt; &gt;"</span></span></span><span class="hljs-tag"> %&gt;</span></span></code> </pre> <br>  The resource folder is intended for hosting static web resources.  The cascading style sheet files will be placed in the WEB-INF / resources / css folder, the font files in the WEB-INF / resources / fonts folder, in the WEB-INF / resources / js folder there are JavaScript files and third-party JavaScript libraries. <br><br>  Now we will fix the pom.xml file and write into it the general properties of the application, dependencies on the library packages (Spring MVC, Jaybird, JDBC pool, JOOQ) and JDBC connection properties. <br><br><div class="spoiler">  <b class="spoiler_title">pom.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span>4.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>ru.ibase<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>fbjavaex<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0-SNAPSHOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span>war<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>Firebird Java Example<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">endorsed.dir</span></span></span><span class="hljs-tag">&gt;</span></span>${project.build.directory}/endorsed<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">endorsed.dir</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project.build.sourceEncoding</span></span></span><span class="hljs-tag">&gt;</span></span>UTF-8<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project.build.sourceEncoding</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">spring.version</span></span></span><span class="hljs-tag">&gt;</span></span>4.3.4.RELEASE<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">spring.version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jstl.version</span></span></span><span class="hljs-tag">&gt;</span></span>1.2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jstl.version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">javax.servlet.version</span></span></span><span class="hljs-tag">&gt;</span></span>3.0.1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">javax.servlet.version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">db.url</span></span></span><span class="hljs-tag">&gt;</span></span>jdbc:firebirdsql://localhost:3050/examples<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">db.url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">db.driver</span></span></span><span class="hljs-tag">&gt;</span></span>org.firebirdsql.jdbc.FBDriver<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">db.driver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">db.username</span></span></span><span class="hljs-tag">&gt;</span></span>SYSDBA<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">db.username</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">db.password</span></span></span><span class="hljs-tag">&gt;</span></span>masterkey<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">db.password</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>javax<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>javaee-web-api<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>7.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span>provided<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>javax.servlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>javax.servlet-api<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${javax.servlet.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span>provided<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>jstl<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>jstl<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${jstl.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   JSON --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.fasterxml.jackson.core<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>jackson-core<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.8.5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.fasterxml.jackson.core<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>jackson-annotations<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.8.5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.fasterxml.jackson.core<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>jackson-databind<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.8.5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Spring --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-core<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${spring.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-web<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${spring.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-webmvc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${spring.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-context<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${spring.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-jdbc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${spring.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- JDBC --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.firebirdsql.jdbc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>jaybird-jdk18<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>commons-dbcp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>commons-dbcp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- jOOQ --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.jooq<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>jooq<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.9.2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.jooq<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>jooq-meta<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.9.2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.jooq<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>jooq-codegen<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.9.2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Testing --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>junit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>junit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>4.11<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>jar<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span>test<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-test<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${spring.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span>test<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.apache.maven.plugins<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>maven-compiler-plugin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">surce</span></span></span><span class="hljs-tag">&gt;</span></span>1.7<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">surce</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag">&gt;</span></span>1.7<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">compilerArguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">endorseddirs</span></span></span><span class="hljs-tag">&gt;</span></span>${endorsed.dir}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">endorseddirs</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">compilerArguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.apache.maven.plugins<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>maven-war-plugin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">failOnMissingWebXml</span></span></span><span class="hljs-tag">&gt;</span></span>false<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">failOnMissingWebXml</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.apache.maven.plugins<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>maven-dependency-plugin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.6<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">executions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phase</span></span></span><span class="hljs-tag">&gt;</span></span>validate<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phase</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goal</span></span></span><span class="hljs-tag">&gt;</span></span>copy<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goal</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">outputDirectory</span></span></span><span class="hljs-tag">&gt;</span></span>${endorsed.dir}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">outputDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">silent</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">silent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactItems</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>javax<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>javaee-endorsed-api<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>7.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>jar<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactItems</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">executions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  After you have registered all the necessary dependencies, it is advisable to reload the POM in order to load all the necessary libraries.  If this is not done, then in the process of working with the project errors may occur.  In NetBeans, this is done as follows. <br><br><img src="https://habrastorage.org/web/ed7/2b7/bd4/ed72b7bd4cd34fbda4f5d62e373173ae.png"><br><br>  I don‚Äôt really like configuring via xml, so I‚Äôll work through Java configuration classes. <br><br><div class="spoiler">  <b class="spoiler_title">WebAppConfig.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Bean; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.ComponentScan; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.servlet.config.annotation.EnableWebMvc; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.servlet.view.JstlView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.servlet.view.UrlBasedViewResolver; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.http.converter.json.MappingJackson2HttpMessageConverter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.http.converter.HttpMessageConverter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.fasterxml.jackson.databind.ObjectMapper; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.fasterxml.jackson.databind.SerializationFeature; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@ComponentScan</span></span>(<span class="hljs-string"><span class="hljs-string">"ru.ibase.fbjavaex"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@EnableWebMvc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebAppConfig</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebMvcConfigurerAdapter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configureMessageConverters</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; httpMessageConverters)</span></span></span><span class="hljs-function"> </span></span>{ MappingJackson2HttpMessageConverter jsonConverter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MappingJackson2HttpMessageConverter(); ObjectMapper objectMapper = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObjectMapper(); objectMapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); jsonConverter.setObjectMapper(objectMapper); httpMessageConverters.add(jsonConverter); } <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UrlBasedViewResolver </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupViewResolver</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ UrlBasedViewResolver resolver = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UrlBasedViewResolver(); resolver.setPrefix(<span class="hljs-string"><span class="hljs-string">"/WEB-INF/jsp/"</span></span>); resolver.setSuffix(<span class="hljs-string"><span class="hljs-string">".jsp"</span></span>); resolver.setViewClass(JstlView.class); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> resolver; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addResourceHandlers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ResourceHandlerRegistry registry)</span></span></span><span class="hljs-function"> </span></span>{ registry.addResourceHandler(<span class="hljs-string"><span class="hljs-string">"/resources/**"</span></span>).addResourceLocations(<span class="hljs-string"><span class="hljs-string">"/WEB-INF/resources/"</span></span>); } }</code> </pre><br></div></div><br>  In this configuration class, we set the search location for web resources and JSP views.  The configureMessageConverters method sets the date to be serialized into a string representation (by default, serialized in a numeric representation as a timestamp). <br><br>  Now let's get rid of the Web.xml file instead of it, create the WebInitializer.java file. <br><br><div class="spoiler">  <b class="spoiler_title">WebInitializer.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.ServletContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.ServletException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.ServletRegistration.Dynamic; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.WebApplicationInitializer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.context.support.AnnotationConfigWebApplicationContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.servlet.DispatcherServlet; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebInitializer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebApplicationInitializer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStartup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ServletContext servletContext)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> ServletException </span></span>{ AnnotationConfigWebApplicationContext ctx = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AnnotationConfigWebApplicationContext(); ctx.register(WebAppConfig.class); ctx.setServletContext(servletContext); Dynamic servlet = servletContext.addServlet(<span class="hljs-string"><span class="hljs-string">"dispatcher"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DispatcherServlet(ctx)); servlet.addMapping(<span class="hljs-string"><span class="hljs-string">"/"</span></span>); servlet.setLoadOnStartup(<span class="hljs-number"><span class="hljs-number">1</span></span>); } }</code> </pre><br></div></div><br>  It remains to configure IoC containers for dependency injection.  We will return to this step later, and now we will proceed to the generation of classes for working with the database via jOOQ. <br><br><h3>  Generating classes for working with the database via jOOQ </h3><br>  We will work with the database using the <a href="https://www.jooq.org/">jOOQ</a> library.  jOOQ allows you to build SQL queries from jOOQ objects and code (like LINQ).  jOOQ has closer integration with the database than ORM, therefore, in addition to simple CRUD SQL queries used in Active Record, it allows you to use additional features.  For example, jOOQ can work with stored procedures and functions, sequences, use window functions and other features specific to a particular DBMS.  Full documentation on working with jOOQ is available <a href="http://www.jooq.org/doc/3.9/manual-single-page/">here</a> . <br><br>  The jOOQ classes for working with a database are generated based on a database schema.  Our application will work with the database, the model of which is shown in the figure below. <br><br><img src="https://habrastorage.org/files/aeb/2c3/d3f/aeb2c3d3fec4439dbf6217fce6efb2d4.png" alt="image"><br><br>  In addition to tables, our database also contains stored procedures and sequences.  At the end of this article there is a link to the database creation script. <br><table><tbody><tr><td>  <b>Attention!</b> <br><br>  This model is just an example.  Your subject area may be more complicated, or completely different.  The model used in this article is simplified as much as possible in order not to clutter up the description of working with components with the description of creating and modifying the data model. <br></td></tr></tbody></table><br>  To generate jOOQ classes that work with our database, you need to download the following binary files by <a href="http://www.jooq.org/download">reference</a> or via the maven repository: <br><br><ul><li>  <b>jooq-3.9.2.jar</b> <br>  The main library that is included in our jOOQ application. <br><br></li><li>  <b>jooq-meta-3.9.2.jar</b> <br>  A utility that is included in your assembly for navigating the database schema through the generated objects. <br><br></li><li>  <b>jooq-codegen-3.9.2.jar</b> <br>  A utility that is included in your build to generate a database schema. </li></ul><br>  In addition, to connect to the Firebird database via JDBC, you will need to download the <a href="">jaybird-full-3.0.0.jar driver</a> . <br><br>  Now you need to create the configuration file example.xml, which will be used to generate the database schema classes. <br><br><div class="spoiler">  <b class="spoiler_title">example.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.jooq.org/xsd/jooq-codegen-3.8.0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jdbc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">driver</span></span></span><span class="hljs-tag">&gt;</span></span>org.firebirdsql.jdbc.FBDriver<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">driver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>jdbc:firebirdsql://localhost:3050/examples<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span>SYSDBA<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span>masterkey<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>charSet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>utf-8<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jdbc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">generator</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>org.jooq.util.JavaGenerator<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">database</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   . : org.util.[database].[database]Database --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>org.jooq.util.firebird.FirebirdDatabase<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">inputSchema</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">inputSchema</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  ,      (  Java.  ,    ).     .      ,    ! --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">includes</span></span></span><span class="hljs-tag">&gt;</span></span>.*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">includes</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ,       . (  Java).        RDB$,   MON$    SEC$. --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">excludes</span></span></span><span class="hljs-tag">&gt;</span></span> RDB\$.* | MON\$.* | SEC\$.* <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">excludes</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">database</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packageName</span></span></span><span class="hljs-tag">&gt;</span></span>ru.ibase.fbjavaex.exampledb<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packageName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     .     Maven. --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span>e:/OpenServer/domains/localhost/fbjavaex/src/main/java/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">generator</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Now go to the command line and run the following command: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">java</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-cp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jooq-3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.9</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.jar</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">jooq-meta-3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.9</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.jar</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">jooq-codegen-3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.9</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.jar</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">jaybird-full-3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.jar</span></span>;. <span class="hljs-selector-tag"><span class="hljs-selector-tag">org</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.jooq</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.util</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.GenerationTool</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">example</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span></code> </pre><br>  This command will create the necessary classes and allow you to write in Java language queries to database objects.  You can learn more about the class generation process at the <a href="https://www.jooq.org/doc/3.9/manual-single-page/">Code generation</a> link. <br><br><h3>  Container IoC Configuration </h3><br>  In Spring, Dependency Injection (DI) is implemented via the Spring IoC (Inversion of Control) container.  The introduction of dependencies is a process according to which objects define their dependencies, i.e.  the objects they work with are through constructor / factory method arguments or properties that have been set or returned by the factory method.  Then the inject container (hereinafter "injects") these dependencies when creating the bean.  You can read more about dependency injection in the chapter <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/">The IoC container</a> . <br><br>  I‚Äôm not a supporter of xml configuration, so we‚Äôll use an annotation approach and a java configuration.  The main features and parts of the Java IoC configuration of the container are the classes with the @Configuration annotation and the methods with the <a href="https://habrahabr.ru/users/bean/" class="user_link">Bean</a> annotation.  Annotation <a href="https://habrahabr.ru/users/bean/" class="user_link">Bean is</a> used to indicate that a method creates, configures, and initializes a new object managed by a Spring IoC container.  Such methods can be used as in classes annotated with @Configuration.  Our IoC container will return connection pool, transaction manager, exception translator (converts SQLException exceptions to Spring-specific DataAccessException exceptions), DSL context (starting point for building all queries using Fluent API), as well as managers for implementing business logic and grids for display data. <br><br><div class="spoiler">  <b class="spoiler_title">JooqConfig.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *  IoC  *    . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Bean; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.sql.DataSource; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.commons.dbcp.BasicDataSource; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.jdbc.datasource.DataSourceTransactionManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.impl.DataSourceConnectionProvider; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.DSLContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.impl.DefaultDSLContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.impl.DefaultConfiguration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.SQLDialect; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.impl.DefaultExecuteListenerProvider; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.exception.ExceptionTranslator; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.managers.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.jqgrid.*; <span class="hljs-comment"><span class="hljs-comment">/** *   Spring IoC  */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JooqConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span>(name = <span class="hljs-string"><span class="hljs-string">"dataSource"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataSource </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDataSource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ BasicDataSource dataSource = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicDataSource(); <span class="hljs-comment"><span class="hljs-comment">//    dataSource.setUrl("jdbc:firebirdsql://localhost:3050/examples"); dataSource.setDriverClassName("org.firebirdsql.jdbc.FBDriver"); dataSource.setUsername("SYSDBA"); dataSource.setPassword("masterkey"); dataSource.setConnectionProperties("charSet=utf-8"); return dataSource; } /** *    * * @return */ @Bean(name = "transactionManager") public DataSourceTransactionManager getTransactionManager() { return new DataSourceTransactionManager(getDataSource()); } @Bean(name = "transactionAwareDataSource") public TransactionAwareDataSourceProxy getTransactionAwareDataSource() { return new TransactionAwareDataSourceProxy(getDataSource()); } /** *    * * @return */ @Bean(name = "connectionProvider") public DataSourceConnectionProvider getConnectionProvider() { return new DataSourceConnectionProvider(getTransactionAwareDataSource()); } /** *    * * @return */ @Bean(name = "exceptionTranslator") public ExceptionTranslator getExceptionTranslator() { return new ExceptionTranslator(); } /** *   DSL  * * @return */ @Bean(name = "dslConfig") public org.jooq.Configuration getDslConfig() { DefaultConfiguration config = new DefaultConfiguration(); //   SQL  Firebird config.setSQLDialect(SQLDialect.FIREBIRD); config.setConnectionProvider(getConnectionProvider()); DefaultExecuteListenerProvider listenerProvider = new DefaultExecuteListenerProvider(getExceptionTranslator()); config.setExecuteListenerProvider(listenerProvider); return config; } /** *  DSL  * * @return */ @Bean(name = "dsl") public DSLContext getDsl() { org.jooq.Configuration config = this.getDslConfig(); return new DefaultDSLContext(config); } /** *    * * @return */ @Bean(name = "customerManager") public CustomerManager getCustomerManager() { return new CustomerManager(); } /** *     * * @return */ @Bean(name = "customerGrid") public JqGridCustomer getCustomerGrid() { return new JqGridCustomer(); } /** *    * * @return */ @Bean(name = "productManager") public ProductManager getProductManager() { return new ProductManager(); } /** *     * * @return */ @Bean(name = "productGrid") public JqGridProduct getProductGrid() { return new JqGridProduct(); } /** *     * * @return */ @Bean(name = "invoiceManager") public InvoiceManager getInvoiceManager() { return new InvoiceManager(); } /** *       * * @return */ @Bean(name = "invoiceGrid") public JqGridInvoice getInvoiceGrid() { return new JqGridInvoice(); } /** *       * * @return */ @Bean(name = "invoiceLineGrid") public JqGridInvoiceLine getInvoiceLineGrid() { return new JqGridInvoiceLine(); } /** *    * * @return */ @Bean(name = "workingPeriod") public WorkingPeriod getWorkingPeriod() { return new WorkingPeriod(); } }</span></span></code> </pre><br></div></div><br><h3>  Building SQL queries using jOOQ </h3><br>  Before we consider the implementation of managers and grids, we will describe how to work with the database through jOOQ.  Only brief information about query construction will be presented here, you can find complete documentation on this issue in the jOOQ <a href="https://www.jooq.org/doc/3.9/manual-single-page/%2523sql-building">sql-building</a> chapter. <br><br>  The org.jooq.impl.DSL class is the main class from which you will create all the jOOQ objects.  It acts as a static factory for table expressions, column expressions (or fields), conditional expressions, and many other parts of the query. <br><br>  DSLContext refers to the org.jooq.Configuration object, which customizes the jOOQ behavior when executing queries.  Unlike static DSL, DSLContext allows you to create SQL statements that are already ‚Äútuned‚Äù and ready to be executed.  In our application, DSLContext is created in the JooqConfig configuration class in the getDsl method.  The configuration for DSLContext is returned by the getDslConfig method.  In this method, we have indicated that we will use the Firebird DBMS SQL dialect, the connection provider (determines how we get the connection via JDBC), and the listener for executing SQL queries. <br><br>  jOOQ comes with its own DSL (or Domain Specific Language), which emulates SQL in Java.  This means that you can write SQL statements almost as if Java originally supported them, much the same way as .NET in C # does it using LINQ to SQL. <br><br>  jOOQ uses informal BNF notation, which models a unified SQL dialect suitable for most DBMSs.  Unlike other, simpler frameworks that use the ‚ÄúFluent API‚Äù or ‚Äúchaining method‚Äù, the hierarchy of the BNF interface based on jOOQ does not allow for poor query syntax. <br><br>  Let's look at a simple query in SQL: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> author a <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> book b <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> a.id = b.author_id <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> a.year_of_birth &gt; <span class="hljs-number"><span class="hljs-number">1920</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> a.first_name = <span class="hljs-string"><span class="hljs-string">'Paulo'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> b.title</code> </pre><br>  In jOOQ, it will look like this: <br><br><pre> <code class="java hljs">Result&lt;Record&gt; result = dsl.select() .from(AUTHOR.as(<span class="hljs-string"><span class="hljs-string">"a"</span></span>)) .join(BOOK.as(<span class="hljs-string"><span class="hljs-string">"b"</span></span>)).on(a.ID.equal(b.AUTHOR_ID)) .where(a.YEAR_OF_BIRTH.greaterThan(<span class="hljs-number"><span class="hljs-number">1920</span></span>) .and(a.FIRST_NAME.equal(<span class="hljs-string"><span class="hljs-string">"Paulo"</span></span>))) .orderBy(b.TITLE) .fetch();</code> </pre><br>  The classes AUTHOR and BOOK describing the corresponding tables must be generated in advance.  The process of generating classes jOOQ according to a given DB scheme was described above. <br><br>  In this case, we defined the AUTHOR and BOOK tables with an alias using the as construct.  Without the use of aliases, this query would look like this: <br><br><pre> <code class="java hljs">Result&lt;Record&gt; result = dsl.select() .from(AUTHOR) .join(BOOK).on(AUTHOR.ID.equal(BOOK.AUTHOR_ID)) .where(AUTHOR.YEAR_OF_BIRTH.greaterThan(<span class="hljs-number"><span class="hljs-number">1920</span></span>) .and(AUTHOR.FIRST_NAME.equal(<span class="hljs-string"><span class="hljs-string">"Paulo"</span></span>))) .orderBy(BOOK.TITLE) .fetch();</code> </pre><br>  Now let's look at a more complex query using aggregate functions and grouping. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> AUTHOR.FIRST_NAME, AUTHOR.LAST_NAME, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> AUTHOR <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> BOOK <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> AUTHOR.ID = BOOK.AUTHOR_ID <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> BOOK.LANGUAGE = <span class="hljs-string"><span class="hljs-string">'DE'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> BOOK.PUBLISHED &gt; <span class="hljs-string"><span class="hljs-string">'2008-01-01'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> AUTHOR.FIRST_NAME, AUTHOR.LAST_NAME <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) &gt; <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> AUTHOR.LAST_NAME <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NULLS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FIRST</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OFFSET</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROWS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FETCH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FIRST</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROWS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ONLY</span></span></code> </pre><br>  In jOOQ, it will look like this: <br><br><pre> <code class="java hljs">dsl.select(AUTHOR.FIRST_NAME, AUTHOR.LAST_NAME, count()) .from(AUTHOR) .join(BOOK).on(BOOK.AUTHOR_ID.equal(AUTHOR.ID)) .where(BOOK.LANGUAGE.equal(<span class="hljs-string"><span class="hljs-string">"DE"</span></span>)) .and(BOOK.PUBLISHED.greaterThan(<span class="hljs-string"><span class="hljs-string">"2008-01-01"</span></span>)) .groupBy(AUTHOR.FIRST_NAME, AUTHOR.LAST_NAME) .having(count().greaterThan(<span class="hljs-number"><span class="hljs-number">5</span></span>)) .orderBy(AUTHOR.LAST_NAME.asc().nullsFirst()) .limit(<span class="hljs-number"><span class="hljs-number">2</span></span>) .offset(<span class="hljs-number"><span class="hljs-number">1</span></span>) .fetch();</code> </pre><br>  Note the limit on the number of records returned will be generated according to the specified SQL dialect.  In the example above, the FIREIRD_3_0 dialect was used.  If the FIREBIRD_2_5 dialect or just FIREBIRD were specified, then the ROWS clause would be used instead of OFSET ... FETCH. <br><br>  You can collect the request in parts.  This allows you to change it dynamically, which can be used to change the sort order or add additional filtering options. <br><br><pre> <code class="java hljs"> SelectFinalStep&lt;?&gt; select = dsl.select() .from(PRODUCT); SelectQuery&lt;?&gt; query = select.getQuery(); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (searchOper) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"eq"</span></span>: query.addConditions(PRODUCT.NAME.eq(searchString)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"bw"</span></span>: query.addConditions(PRODUCT.NAME.startsWith(searchString)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"cn"</span></span>: query.addConditions(PRODUCT.NAME.contains(searchString)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (sOrd) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"asc"</span></span>: query.addOrderBy(PRODUCT.NAME.asc()); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"desc"</span></span>: query.addOrderBy(PRODUCT.NAME.desc()); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> query.fetchMaps();</code> </pre><br><h4>  Named and unnamed parameters </h4><br>  By default, each time you use a string, date, and number literal in the query, and also substitute external variables, jOOQ binds this variable or literal through unnamed parameters.  For example, the following expression in Java: <br><br><pre> <code class="java hljs">dsl.select() .from(BOOK) .where(BOOK.ID.equal(<span class="hljs-number"><span class="hljs-number">5</span></span>)) .and(BOOK.TITLE.equal(<span class="hljs-string"><span class="hljs-string">"Animal Farm"</span></span>)) .fetch();</code> </pre><br>  Equivalent to the complete record: <br><br><pre> <code class="java hljs">dsl.select() .from(BOOK) .where(BOOK.ID.equal(val(<span class="hljs-number"><span class="hljs-number">5</span></span>))) .and(BOOK.TITLE.equal(val(<span class="hljs-string"><span class="hljs-string">"Animal Farm"</span></span>))) .fetch();</code> </pre><br>  and converted to sql query: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> BOOK <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> BOOK.ID = ? <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> BOOK.TITLE = ?</code> </pre><br>  You do not need to worry about the index of the corresponding parameter, the values ‚Äã‚Äãwill automatically be tied to the desired parameter.  If you need to change the value of a parameter, you can do it by selecting the desired parameter by the index number (indexing starts from 1). <br><br><pre> <code class="java hljs">Select&lt;?&gt; select = dsl.select() .from(BOOK) .where(BOOK.ID.equal(<span class="hljs-number"><span class="hljs-number">5</span></span>)) .and(BOOK.TITLE.equal(<span class="hljs-string"><span class="hljs-string">"Animal Farm"</span></span>)); Param&lt;?&gt; param = select.getParam(<span class="hljs-string"><span class="hljs-string">"2"</span></span>); Param.setValue(<span class="hljs-string"><span class="hljs-string">"Animals as Leaders"</span></span>);</code> </pre><br>  Another way to assign a new value to a parameter is to call the bind method. <br><br><pre> <code class="java hljs">Query query1 = dsl.select() .from(AUTHOR) .where(LAST_NAME.equal(<span class="hljs-string"><span class="hljs-string">"Poe"</span></span>)); query1.bind(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"Orwell"</span></span>);</code> </pre><br>  In addition, jOOQ supports named parameters.  In this case, they must be explicitly created using org.jooq.Param. <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Create a query with a named parameter. You can then use that name for // accessing the parameter again Query query1 = dsl.select() .from(AUTHOR) .where(LAST_NAME.equal(param("lastName", "Poe"))); Param&lt;?&gt; param1 = query.getParam("lastName"); // Or, keep a reference to the typed parameter in order not to lose the &lt;T&gt; type information: Param&lt;String&gt; param2 = param("lastName", "Poe"); Query query2 = dsl.select() .from(AUTHOR) .where(LAST_NAME.equal(param2)); // You can now change the bind value directly on the Param reference: param2.setValue("Orwell");</span></span></code> </pre><br>  Another way to assign a new value to a parameter is to call the bind method. <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Or, with named parameters Query query2 = dsl.select() .from(AUTHOR) .where(LAST_NAME.equal(param("lastName", "Poe"))); query2.bind("lastName", "Orwell");</span></span></code> </pre><br><h4>  Return Values ‚Äã‚Äãfrom Selective Queries </h4><br>  jOOQ provides many ways to extract data from SQL queries.  We will not list all the ways here, you can read more about them in the <a href="https://www.jooq.org/doc/3.9/manual-single-page/">Fetching</a> chapter of the <a href="https://www.jooq.org/doc/3.9/manual-single-page/">jOOQ</a> documentation.  In our example, we will use the return to the list of maps (fetchMaps method), which is convenient to use for serializing the result in JSON. <br><br><h4>  Other types of requests </h4><br>  Now let's see what other types of queries look like.  For example, the following request to insert a record: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> AUTHOR (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, FIRST_NAME, LAST_NAME) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-string"><span class="hljs-string">'Hermann'</span></span>, <span class="hljs-string"><span class="hljs-string">'Hesse'</span></span>);</code> </pre><br>  in jOOQ it will look like this: <br><br><pre> <code class="java hljs">dsl.insertInto(AUTHOR, AUTHOR.ID, AUTHOR.FIRST_NAME, AUTHOR.LAST_NAME) .values(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-string"><span class="hljs-string">"Hermann"</span></span>, <span class="hljs-string"><span class="hljs-string">"Hesse"</span></span>) .execute();</code> </pre><br>      : <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> AUTHOR <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> FIRST_NAME = <span class="hljs-string"><span class="hljs-string">'Hermann'</span></span>, LAST_NAME = <span class="hljs-string"><span class="hljs-string">'Hesse'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> = <span class="hljs-number"><span class="hljs-number">3</span></span>;</code> </pre> <br>   jOOQ   : <br><br><pre> <code class="java hljs">dsl.update(AUTHOR) .set(AUTHOR.FIRST_NAME, <span class="hljs-string"><span class="hljs-string">"Hermann"</span></span>) .set(AUTHOR.LAST_NAME, <span class="hljs-string"><span class="hljs-string">"Hesse"</span></span>) .where(AUTHOR.ID.equal(<span class="hljs-number"><span class="hljs-number">3</span></span>)) .execute();</code> </pre> <br>    : <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> AUTHOR <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> = <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br>  : <br><br><pre> <code class="java hljs">dsl.delete(AUTHOR) .where(AUTHOR.ID.equal(<span class="hljs-number"><span class="hljs-number">100</span></span>)) .execute();</code> </pre> <br>  ,  jOOQ      ,  <a href="https://www.jooq.org/doc/3.9/manual-single-page/">MERGE</a> . <br><br>   jOOQ      .      *.Routines.*       ,     Java: <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> invoiceId = dsl.nextval(GEN_INVOICE_ID).intValue(); spAddInvoice(dsl.configuration(), invoiceId, customerId, invoiceDate);</code> </pre><br>        SQL : <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEXT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">VALUE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> GEN_INVOICE_ID <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> RDB$<span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span></code> </pre><br>     : <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">EXECUTE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PROCEDURE</span></span> SP_ADD_INVOICE(:INVOICE_ID, :CUSTOMER_ID, :INVOICE_DATE</code> </pre><br> jOOQ        DDL ,       . <br><br><h4>    </h4><br>   jOOQ      , ..   SQL    ,      SQL      ,    .       READ_WRITE READ_COMMITED REC_VERSION WAIT.        JDBC .           (. BasicDataSource.setDefaultTransactionIsolation   getDataSource   JooqConfig). <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are several ways to explicitly manage transactions in jOOQ. </font><font style="vertical-align: inherit;">Since we are developing an application using the Spring Framework, we will use the transaction manager specified in the configuration (JooqConfig). </font><font style="vertical-align: inherit;">You can get a transaction manager by declaring the txMgr property in the class as follows:</font></font><br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DataSourceTransactionManager txMgr;</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In this case, a typical transaction scenario is as follows: </font></font><br><br><pre> <code class="java hljs">TransactionStatus tx = txMgr.getTransaction(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DefaultTransactionDefinition()); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//    for (int i = 0; i &lt; 2; i++) dsl.insertInto(BOOK) .set(BOOK.ID, 5) .set(BOOK.AUTHOR_ID, 1) .set(BOOK.TITLE, "Book 5") .execute(); //   txMgr.commit(tx); } catch (DataAccessException e) { //   txMgr.rolback(tx); }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, Spring makes it possible to implement such a script much easier using the @Transactional annotation specified before the class method. </font><font style="vertical-align: inherit;">In this case, all actions performed in the method will be wrapped in a transaction.</font></font><br><br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> customerId */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> customerId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.deleteFrom(CUSTOMER) .where(CUSTOMER.CUSTOMER_ID.eq(customerId)) .execute(); }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The propagation parameter specifies how transactions will be handled if our method is called from an external transaction. </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Propagation.REQUIRED - run in an existing transaction, if one exists, otherwise create a new one. </font></font></li><li> Propagation.MANDATORY ‚Äî    ,   ,   . </li><li> Propagation.SUPPORTS ‚Äî    ,   ,    . </li><li> Propagation.NOT_SUPPORTED ‚Äî    .   ,    . </li><li> Propagation.REQUIRES_NEW ‚Äî      .   ,         . </li><li> Propagation.NESTED ‚Äî    ,   ,  ,  .     ,       ;     ,     .    ,    . </li><li> Propagation.NEVER ‚Äî    ,     . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The isolation parameter specifies the transaction isolation mode. 5 values ‚Äã‚Äãare supported: DEFAULT, READ_UNCOMMITTED, READ_COMMITTED, REPEATABLE_READ, SERIALIZABLE. If the value of the DEFAULT parameter is specified, the default transaction isolation mode will be used. The remaining isolation modes are taken from the SQL standard. In Firebird, there are several other isolation modes and the READ_COMMITED mode only fully meets all the criteria. Thus, in JDBC mode, READ_COMMITTED maps to read_committed to Firebird, REPEATABLE_READ to concurrency (Snapshot), and SERIALIZABLE to consistency. In addition, in addition to the isolation mode, Firebird supports additional transaction parameters (NO RECORD_VERSION and RECORD_VERSION, WAIT and NO WAIT).You can customize the mapping of standard isolation levels to Firebird transaction parameters by setting properties of the JDBC connection (for more details see</font></font><a href="https://www.firebirdsql.org/file/Jaybird_2_1_JDBC_driver_manual.pdf">Jaybird 2.1 JDBC driver Java Programmer's Manual</a>   Using transactions).        1 ,     REPEATABLE_READ    . <br><br>   @Transactional   ,          readOnly.       read-write. <br><br><h4>    </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will display the data of our application using JavaScript component </font></font><a href="https://github.com/tonytomov/jqGrid"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jqGrid</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Currently, jqGrid is distributed under a commercial license, but is free for non-commercial purposes. </font><font style="vertical-align: inherit;">Instead, you can use the </font></font><a href="https://github.com/free-jqgrid/jqGrid"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">free-jqGrid</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fork </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">To display the data in this grid and elements of page navigation, we need to return the data in JSON format, the structure of which looks like this.</font></font><br><br><pre> <code class="hljs css">{ <span class="hljs-attribute"><span class="hljs-attribute">total</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, page: <span class="hljs-number"><span class="hljs-number">3</span></span>, records: <span class="hljs-number"><span class="hljs-number">3000</span></span>, rows: [ {id: <span class="hljs-number"><span class="hljs-number">1</span></span>, name: <span class="hljs-string"><span class="hljs-string">"Ada"</span></span>}, {<span class="hljs-attribute"><span class="hljs-attribute">id</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, name: <span class="hljs-string"><span class="hljs-string">"Smith"</span></span>}, ‚Ä¶ ] }</code> </pre><br>  Where <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> total is the total number of pages; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> page - current page number; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> records - the total number of records; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rows - an array of records on the current page. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Create a class that describes this structure: </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JqGridData.java</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.jqgrid; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-comment"><span class="hljs-comment">/** *      jqGrid *     JSON * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Simonov Denis */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JqGridData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * Total number of pages */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> total; <span class="hljs-comment"><span class="hljs-comment">/** * The current page number */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> page; <span class="hljs-comment"><span class="hljs-comment">/** * Total number of records */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> records; <span class="hljs-comment"><span class="hljs-comment">/** * The actual data */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> List&lt;Map&lt;String, Object&gt;&gt; rows; <span class="hljs-comment"><span class="hljs-comment">/** *  * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> total * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> page * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> records * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> rows */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">JqGridData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> total, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> page, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> records, List&lt;Map&lt;String, Object&gt;&gt; rows)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.total = total; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.page = page; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.records = records; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rows = rows; } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTotal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> total; } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> page; } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRecords</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> records; } <span class="hljs-comment"><span class="hljs-comment">/** *    *        * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;Map&lt;String, Object&gt;&gt; getRows() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rows; } }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we will write an abstract class that will return the above structure depending on the search and sorting conditions. </font><font style="vertical-align: inherit;">This class will be the ancestor of classes returning similar structures for specific entities.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jqgrid.java</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/* *      JqGrid */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.jqgrid; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.DSLContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-comment"><span class="hljs-comment">/** *   JqGrid * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Simonov Denis */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JqGrid</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span>(required = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> DSLContext dsl; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> String searchField = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> String searchString = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> String searchOper = <span class="hljs-string"><span class="hljs-string">"eq"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> Boolean searchFlag = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pageNo = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> limit = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offset = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> String sIdx = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> String sOrd = <span class="hljs-string"><span class="hljs-string">"asc"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCountRecord</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *      JSON * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> JqGridData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getJqGridData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> recordCount = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getCountRecord(); List&lt;Map&lt;String, Object&gt;&gt; records = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRecords(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> total = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.limit &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { total = recordCount / <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.limit + <span class="hljs-number"><span class="hljs-number">1</span></span>; } JqGridData jqGridData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JqGridData(total, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pageNo, recordCount, records); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> jqGridData; } <span class="hljs-comment"><span class="hljs-comment">/** *      * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLimit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.limit; } <span class="hljs-comment"><span class="hljs-comment">/** *       * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOffset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset; } <span class="hljs-comment"><span class="hljs-comment">/** *      * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIdx</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sIdx; } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOrd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sOrd; } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPageNo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pageNo; } <span class="hljs-comment"><span class="hljs-comment">/** *       * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> List&lt;Map&lt;String, Object&gt;&gt; getRecords(); <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSearchField</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.searchField; } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSearchString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.searchString; } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSearchOper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.searchOper; } <span class="hljs-comment"><span class="hljs-comment">/** *       * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> limit */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setLimit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> limit)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.limit = limit; } <span class="hljs-comment"><span class="hljs-comment">/** *   ,    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> offset */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setOffset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset = offset; } <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> sIdx * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> sOrd */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setOrderBy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String sIdx, String sOrd)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sIdx = sIdx; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sOrd = sOrd; } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> pageNo */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPageNo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pageNo)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pageNo = pageNo; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset = (pageNo - <span class="hljs-number"><span class="hljs-number">1</span></span>) * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.limit; } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> searchField * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> searchString * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> searchOper */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setSearchCondition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String searchField, String searchString, String searchOper)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.searchFlag = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.searchField = searchField; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.searchString = searchString; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.searchOper = searchOper; } }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Please note that this class contains the DSLContext dsl property, which will be used to build queries for data sampling using jOOQ. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Creating directories </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we can start creating directories. </font><font style="vertical-align: inherit;">We describe the process of creating directories on the example of a reference book of customers. </font><font style="vertical-align: inherit;">The product directory is created in a similar way, and if you wish, you can view its source code at the link provided at the end of the article. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First, we implement the class for working with jqGrid, it will be inherited from our abstract class ru.ibase.fbjavaex.jqgrid.JqGrid described above. </font><font style="vertical-align: inherit;">It has the ability to search and multi-directional sorting by the field NAME. </font><font style="vertical-align: inherit;">The source code listing will provide explanatory comments.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JqGridCustomer.java</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.jqgrid; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Tables.CUSTOMER; <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Simonov Denis */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JqGridCustomer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JqGrid</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> query */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeSearchCondition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SelectQuery&lt;?&gt; query)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.searchOper) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"eq"</span></span>: <span class="hljs-comment"><span class="hljs-comment">// CUSTOMER.NAME = ? query.addConditions(CUSTOMER.NAME.eq(this.searchString)); break; case "bw": // CUSTOMER.NAME STARTING WITH ? query.addConditions(CUSTOMER.NAME.startsWith(this.searchString)); break; case "cn": // CUSTOMER.NAME CONTAINING ? query.addConditions(CUSTOMER.NAME.contains(this.searchString)); break; } } /** *     * * @return */ @Override public int getCountRecord() { // ,    SelectFinalStep&lt;?&gt; select = dsl.selectCount() .from(CUSTOMER); SelectQuery&lt;?&gt; query = select.getQuery(); //    ,     if (this.searchFlag) { makeSearchCondition(query); } //   return (int) query.fetch().getValue(0, 0); } /** *    * * @return */ @Override public List&lt;Map&lt;String, Object&gt;&gt; getRecords() { //     SelectFinalStep&lt;?&gt; select = dsl.select() .from(CUSTOMER); SelectQuery&lt;?&gt; query = select.getQuery(); //    ,     if (this.searchFlag) { makeSearchCondition(query); } //    switch (this.sOrd) { case "asc": query.addOrderBy(CUSTOMER.NAME.asc()); break; case "desc": query.addOrderBy(CUSTOMER.NAME.desc()); break; } //    if (this.limit != 0) { query.addLimit(this.limit); } //  if (this.offset != 0) { query.addOffset(this.offset); } //    return query.fetchMaps(); } }</span></span></code> </pre><br></div></div><br> ,          CustomerManager,           .              Snapshot. <br><br><div class="spoiler"> <b class="spoiler_title">CustomerManager.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.managers; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.DSLContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.transaction.annotation.Transactional; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.transaction.annotation.Propagation; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.transaction.annotation.Isolation; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Tables.CUSTOMER; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Sequences.GEN_CUSTOMER_ID; <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Simonov Denis */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomerManager</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span>(required = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DSLContext dsl; <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> name * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> address * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> zipcode * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> phone */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String address, String zipcode, String phone)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (zipcode != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (zipcode.trim().isEmpty()) { zipcode = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> customerId = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.nextval(GEN_CUSTOMER_ID).intValue(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl .insertInto(CUSTOMER, CUSTOMER.CUSTOMER_ID, CUSTOMER.NAME, CUSTOMER.ADDRESS, CUSTOMER.ZIPCODE, CUSTOMER.PHONE) .values( customerId, name, address, zipcode, phone ) .execute(); } <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> customerId * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> name * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> address * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> zipcode * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> phone */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> customerId, String name, String address, String zipcode, String phone)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (zipcode != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (zipcode.trim().isEmpty()) { zipcode = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.update(CUSTOMER) .set(CUSTOMER.NAME, name) .set(CUSTOMER.ADDRESS, address) .set(CUSTOMER.ZIPCODE, zipcode) .set(CUSTOMER.PHONE, phone) .where(CUSTOMER.CUSTOMER_ID.eq(customerId)) .execute(); } <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> customerId */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> customerId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.deleteFrom(CUSTOMER) .where(CUSTOMER.CUSTOMER_ID.eq(customerId)) .execute(); } }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We now turn to writing a controller. Controller classes begin with the </font></font><a href="https://habrahabr.ru/users/controller/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controller</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> annotation </font><font style="vertical-align: inherit;">. To determine the actions of the controller, you must add the @RequestMapping annotation before the method and indicate in it the route along which the controller's action will be triggered. The route is specified in the parameter value. In the method parameter, you can specify the HTTP request method (PUT, GET, POST, DELETE). The input point of our controller will be the index method, it is responsible for displaying the JSP page (view). This page contains markup for grid display, toolbar and navigation.</font></font><br><br>       jqGrid ( /customer/getdata).      getData.     @ResponseBody,    ,           .   @RequestMapping   produces = MediaType.APPLICATION_JSON,  ,        JSON.         JqGridCustomer  .  @RequestParam      HTTP .      GET .  value   @RequestParam    HTTP   .  required ,    HTTP  .  defaultValue    ,       HHTP . <br><br>  addCustomer     .     /customer/create,         POST .   {success: true}    ,        .        CustomerManager. <br><br>  editCustomer    /customer/edit     .  deleteCustomer    /customer/delete     . <br><br><div class="spoiler"> <b class="spoiler_title">CustomerController.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.controllers; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.HashMap; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.stereotype.Controller; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.ui.ModelMap; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestMapping; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestMethod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.ResponseBody; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestParam; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.ws.rs.core.MediaType; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.managers.CustomerManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.jqgrid.JqGridCustomer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.jqgrid.JqGridData; <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Simonov Denis */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Controller</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomerController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span>(required = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> JqGridCustomer customerGrid; <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span>(required = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CustomerManager customerManager; <span class="hljs-comment"><span class="hljs-comment">/** *    *   JSP  ()   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> map * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment">  JSP  */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/customer/"</span></span>, method = RequestMethod.GET) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ModelMap map)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"customer"</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/** *     JSON  jqGrid * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> rows     * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> page   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> sIdx    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> sOrd   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> search     * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> searchField   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> searchString   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> searchOper   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> JSON  jqGrid */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/customer/getdata"</span></span>, method = RequestMethod.GET, produces = MediaType.APPLICATION_JSON) <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> JqGridData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( //     @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"rows"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"20"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> rows, </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//    @RequestParam(value = "page", required = false, defaultValue = "1") int page, //    @RequestParam(value = "sidx", required = false, defaultValue = "") String sIdx, //   @RequestParam(value = "sord", required = false, defaultValue = "asc") String sOrd, //    @RequestParam(value = "_search", required = false, defaultValue = "false") Boolean search, //   @RequestParam(value = "searchField", required = false, defaultValue = "") String searchField, //   @RequestParam(value = "searchString", required = false, defaultValue = "") String searchString, //   @RequestParam(value = "searchOper", required = false, defaultValue = "") String searchOper, //  @RequestParam(value="filters", required=false, defaultValue="") String filters) { customerGrid.setLimit(rows); customerGrid.setPageNo(page); customerGrid.setOrderBy(sIdx, sOrd); if (search) { customerGrid.setSearchCondition(searchField, searchString, searchOper); } return customerGrid.getJqGridData(); } @RequestMapping(value = "/customer/create", method = RequestMethod.POST, produces = MediaType.APPLICATION_JSON) @ResponseBody public Map&lt;String, Object&gt; addCustomer( @RequestParam(value = "NAME", required = true, defaultValue = "") String name, @RequestParam(value = "ADDRESS", required = false, defaultValue = "") String address, @RequestParam(value = "ZIPCODE", required = false, defaultValue = "") String zipcode, @RequestParam(value = "PHONE", required = false, defaultValue = "") String phone) { Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); try { customerManager.create(name, address, zipcode, phone); map.put("success", true); } catch (Exception ex) { map.put("error", ex.getMessage()); } return map; } @RequestMapping(value = "/customer/edit", method = RequestMethod.POST, produces = MediaType.APPLICATION_JSON) @ResponseBody public Map&lt;String, Object&gt; editCustomer( @RequestParam(value = "CUSTOMER_ID", required = true, defaultValue = "0") int customerId, @RequestParam(value = "NAME", required = true, defaultValue = "") String name, @RequestParam(value = "ADDRESS", required = false, defaultValue = "") String address, @RequestParam(value = "ZIPCODE", required = false, defaultValue = "") String zipcode, @RequestParam(value = "PHONE", required = false, defaultValue = "") String phone) { Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); try { customerManager.edit(customerId, name, address, zipcode, phone); map.put("success", true); } catch (Exception ex) { map.put("error", ex.getMessage()); } return map; } @RequestMapping(value = "/customer/delete", method = RequestMethod.POST, produces = MediaType.APPLICATION_JSON) @ResponseBody public Map&lt;String, Object&gt; deleteCustomer( @RequestParam(value = "CUSTOMER_ID", required = true, defaultValue = "0") int customerId) { Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); try { customerManager.delete(customerId); map.put("success", true); } catch (Exception ex) { map.put("error", ex.getMessage()); } return map; } }</span></span></span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The JSP page for displaying the customer reference book contains nothing special: the markup with the main parts of the page, the table for displaying the grid, and the block for displaying the navigation bar. </font><font style="vertical-align: inherit;">JSP templates are not a very advanced tool, if you prefer, you can replace them with other template systems that support inheritance. </font><font style="vertical-align: inherit;">The ../jspf/head.jspf file contains common scripts and styles for all pages of the site, and the ../jspf/menu.jspf file contains the main menu of the site. </font><font style="vertical-align: inherit;">We will not give their code, it is quite simple and, if you wish, you can view it in the source code of the project.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Customers.jsp</font></font></b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@page</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">contentType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pageEncoding</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">%&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">taglib</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/jsp/jstl/core"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"c"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">c:set</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">var</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${pageContext.request.servletContext.contextPath}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"request"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Content-Type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> Spring MVC    Firebird  jOOQ<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">include</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">file</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../jspf/head.jspf"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${cp}/resources/js/jqGridCustomer.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">include</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">file</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../jspf/menu.jspf"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container body-content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>Customers<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jqGridCustomer"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jqPagerCustomer"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>¬© 2016 -  Spring MVC    Firebird  jOOQ<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> $(</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">).ready(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ JqGridCustomer({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">baseAddress</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'${cp}'</span></span></span><span class="javascript"> }); }); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The main client-side logic is concentrated in the JavaScript module /resources/js/jqGridCustomer.js </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jqGridCustomer.js</font></font></b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> JqGridCustomer = (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jqGridCustomer = { <span class="hljs-attr"><span class="hljs-attr">dbGrid</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-comment"><span class="hljs-comment">//  options: $.extend({ baseAddress: null, showEditorPanel: true }, options), //   getColModel: function () { return [ { label: 'Id', //  name: 'CUSTOMER_ID', //   key: true, //    hidden: true //  }, { label: 'Name', //   name: 'NAME', //   width: 240, //  sortable: true, //   editable: true, //   edittype: "text", //     search: true, //   searchoptions: { sopt: ['eq', 'bw', 'cn'] //    }, editoptions: {size: 30, maxlength: 60}, //        editrules: {required: true} //   ,    }, { label: 'Address', name: 'ADDRESS', width: 300, sortable: false, //   editable: true, //  search: false, //   edittype: "textarea", //   editoptions: {maxlength: 250, cols: 30, rows: 4} }, { label: 'Zip Code', name: 'ZIPCODE', width: 30, sortable: false, editable: true, search: false, edittype: "text", editoptions: {size: 30, maxlength: 10} }, { label: 'Phone', name: 'PHONE', width: 80, sortable: false, editable: true, search: false, edittype: "text", editoptions: {size: 30, maxlength: 14} } ]; }, //   initGrid: function () { // url    var url = jqGridCustomer.options.baseAddress + '/customer/getdata'; jqGridCustomer.dbGrid = $("#jqGridCustomer").jqGrid({ url: url, datatype: "json", //    mtype: "GET", //  http  colModel: jqGridCustomer.getColModel(), rowNum: 500, //    loadonce: false, //     sortname: 'NAME', //      NAME sortorder: "asc", //   width: window.innerWidth - 80, //   height: 500, //   viewrecords: true, //    guiStyle: "bootstrap", iconSet: "fontAwesome", caption: "Customers", //    //     pager: 'jqPagerCustomer' }); }, //   getEditOptions: function () { return { url: jqGridCustomer.options.baseAddress + '/customer/edit', reloadAfterSubmit: true, closeOnEscape: true, closeAfterEdit: true, drag: true, width: 400, afterSubmit: jqGridCustomer.afterSubmit, editData: { //         CUSTOMER_ID: function () { //    var selectedRow = jqGridCustomer.dbGrid.getGridParam("selrow"); //      var value = jqGridCustomer.dbGrid.getCell(selectedRow, 'CUSTOMER_ID'); return value; } } }; }, //   getAddOptions: function () { return { url: jqGridCustomer.options.baseAddress + '/customer/create', reloadAfterSubmit: true, closeOnEscape: true, closeAfterAdd: true, drag: true, width: 400, afterSubmit: jqGridCustomer.afterSubmit }; }, //   getDeleteOptions: function () { return { url: jqGridCustomer.options.baseAddress + '/customer/delete', reloadAfterSubmit: true, closeOnEscape: true, closeAfterDelete: true, drag: true, msg: "  ?", afterSubmit: jqGridCustomer.afterSubmit, delData: { //    CUSTOMER_ID: function () { var selectedRow = jqGridCustomer.dbGrid.getGridParam("selrow"); var value = jqGridCustomer.dbGrid.getCell(selectedRow, 'CUSTOMER_ID'); return value; } } }; }, //        initPagerWithEditors: function () { jqGridCustomer.dbGrid.jqGrid('navGrid', '#jqPagerCustomer', { //  search: true, //  add: true, //  edit: true, //  del: true, //  view: true, //   refresh: true, //  //   searchtext: "", addtext: "", edittext: "", deltext: "", viewtext: "", viewtitle: " ", refreshtext: "" }, jqGridCustomer.getEditOptions(), jqGridCustomer.getAddOptions(), jqGridCustomer.getDeleteOptions() ); }, //        initPagerWithoutEditors: function () { jqGridCustomer.dbGrid.jqGrid('navGrid', '#jqPagerCustomer', { //  search: true, //  add: false, //  edit: false, //  del: false, //  view: false, //   refresh: true, //  //   searchtext: "", viewtext: "", viewtitle: " ", refreshtext: "" } ); }, //    initPager: function () { if (jqGridCustomer.options.showEditorPanel) { jqGridCustomer.initPagerWithEditors(); } else { jqGridCustomer.initPagerWithoutEditors(); } }, //  init: function () { jqGridCustomer.initGrid(); jqGridCustomer.initPager(); }, //     () afterSubmit: function (response, postdata) { var responseData = response.responseJSON; //        if (responseData.hasOwnProperty("error")) { if (responseData.error.length) { return [false, responseData.error]; } } else { //        $(this).jqGrid( 'setGridParam', { datatype: 'json' } ).trigger('reloadGrid'); } return [true, "", 0]; } }; jqGridCustomer.init(); return jqGridCustomer; }; })(jQuery);</span></span></code> </pre><br></div></div><br>  jqGrid    initGrid    html    jqGridCustomer.   ()    getColModel.    jqGrid     .     ,   .      jqGrid       jqGrid   <a href="http://www.trirand.com/jqgridwiki/doku.php%3Fid%3Dwiki%253Acolmodel_options">ColModel API</a> . <br><br>            ( initPagerWithEditors  initPagerWithoutEditors ).         jqPagerCustomer.        <a href="http://www.trirand.com/jqgridwiki/doku.php%3Fid%3Dwiki%253Anavigator">Navigator</a>  jqGrid. <br><br>  getEditOptions, getAddOptions, getDeleteOptions    ,    .  url ,          OK  .  afterSubmit ‚Äì ,           .   afterSubmit ,      .    ,    ,      .     editData.      ,      .   ,          ,        . <br><br><h4>   </h4><br>              .        .               ,       .   ‚Äì   ,     .     WorkingPeriod.      workingPeriod    ru.ibase.fbjavaex.config.JooqConfig. <br><br><div class="spoiler"> <b class="spoiler_title">WorkingPeriod.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.Timestamp; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.time.LocalDateTime; <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Simonov Denis */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WorkingPeriod</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Timestamp beginDate; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Timestamp endDate; <span class="hljs-comment"><span class="hljs-comment">/** *  */</span></span> WorkingPeriod() { <span class="hljs-comment"><span class="hljs-comment">//        this.beginDate = Timestamp.valueOf("2015-06-01 00:00:00"); this.endDate = Timestamp.valueOf(LocalDateTime.now().plusDays(1)); } /** *      * * @return */ public Timestamp getBeginDate() { return this.beginDate; } /** *      * * @return */ public Timestamp getEndDate() { return this.endDate; } /** *      * * @param value */ public void setBeginDate(Timestamp value) { this.beginDate = value; } /** *      * * @param value */ public void setEndDate(Timestamp value) { this.endDate = value; } /** *    * * @param beginDate * @param endDate */ public void setRangeDate(Timestamp beginDate, Timestamp endDate) { this.beginDate = beginDate; this.endDate = endDate; } }</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In our application there will be one magazine "Invoices". </font><font style="vertical-align: inherit;">Invoice - consists of a header, which describes common attributes (number, date, customer ...), and invoice items (product name, quantity, cost, etc.). </font><font style="vertical-align: inherit;">The invoice header is displayed in the main grid, and the positions can be viewed in the detail grid, which is expanded by clicking on the ‚Äú+‚Äù icon on the desired document. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We implement a class for viewing invoice header through jqGrid, it will be inherited from our abstract class ru.ibase.fbjavaex.jqgrid.JqGrid, described above. </font><font style="vertical-align: inherit;">It has the ability to search for the name of the customer and the date of the account. </font><font style="vertical-align: inherit;">In addition, this class supports sorting by date in both directions.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JqGridInvoice.java</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.jqgrid; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.config.WorkingPeriod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Tables.INVOICE; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Tables.CUSTOMER; <span class="hljs-comment"><span class="hljs-comment">/** *     - * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Simonov Denis */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JqGridInvoice</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JqGrid</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span>(required = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> WorkingPeriod workingPeriod; <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> query */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeSearchCondition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SelectQuery&lt;?&gt; query)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     ,    //       //    if (this.searchString.isEmpty()) { return; } if (this.searchField.equals("CUSTOMER_NAME")) { switch (this.searchOper) { case "eq": // equal query.addConditions(CUSTOMER.NAME.eq(this.searchString)); break; case "bw": // starting with query.addConditions(CUSTOMER.NAME.startsWith(this.searchString)); break; case "cn": // containing query.addConditions(CUSTOMER.NAME.contains(this.searchString)); break; } } if (this.searchField.equals("INVOICE_DATE")) { Timestamp dateValue = Timestamp.valueOf(this.searchString); switch (this.searchOper) { case "eq": // = query.addConditions(INVOICE.INVOICE_DATE.eq(dateValue)); break; case "lt": // &lt; query.addConditions(INVOICE.INVOICE_DATE.lt(dateValue)); break; case "le": // &lt;= query.addConditions(INVOICE.INVOICE_DATE.le(dateValue)); break; case "gt": // &gt; query.addConditions(INVOICE.INVOICE_DATE.gt(dateValue)); break; case "ge": // &gt;= query.addConditions(INVOICE.INVOICE_DATE.ge(dateValue)); break; } } } /** *     * * @return */ @Override public int getCountRecord() { SelectFinalStep&lt;?&gt; select = dsl.selectCount() .from(INVOICE) .where(INVOICE.INVOICE_DATE.between(this.workingPeriod.getBeginDate(), this.workingPeriod.getEndDate())); SelectQuery&lt;?&gt; query = select.getQuery(); if (this.searchFlag) { makeSearchCondition(query); } return (int) query.fetch().getValue(0, 0); } /** *   - * * @return */ @Override public List&lt;Map&lt;String, Object&gt;&gt; getRecords() { SelectFinalStep&lt;?&gt; select = dsl.select( INVOICE.INVOICE_ID, INVOICE.CUSTOMER_ID, CUSTOMER.NAME.as("CUSTOMER_NAME"), INVOICE.INVOICE_DATE, INVOICE.PAID, INVOICE.TOTAL_SALE) .from(INVOICE) .innerJoin(CUSTOMER).on(CUSTOMER.CUSTOMER_ID.eq(INVOICE.CUSTOMER_ID)) .where(INVOICE.INVOICE_DATE.between(this.workingPeriod.getBeginDate(), this.workingPeriod.getEndDate())); SelectQuery&lt;?&gt; query = select.getQuery(); //    if (this.searchFlag) { makeSearchCondition(query); } //   if (this.sIdx.equals("INVOICE_DATE")) { switch (this.sOrd) { case "asc": query.addOrderBy(INVOICE.INVOICE_DATE.asc()); break; case "desc": query.addOrderBy(INVOICE.INVOICE_DATE.desc()); break; } } //     if (this.limit != 0) { query.addLimit(this.limit); } if (this.offset != 0) { query.addOffset(this.offset); } return query.fetchMaps(); } }</span></span></code> </pre><br></div></div><br>     -  jqGrid  . -,        ,  -          . <br><br><div class="spoiler"> <b class="spoiler_title">JqGridInvoiceLine.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.jqgrid; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Tables.INVOICE_LINE; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Tables.PRODUCT; <span class="hljs-comment"><span class="hljs-comment">/** *      - * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Simonov Denis */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JqGridInvoiceLine</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JqGrid</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> invoiceId; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getInvoiceId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.invoiceId; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setInvoiceId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> invoiceId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.invoiceId = invoiceId; } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCountRecord</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ SelectFinalStep&lt;?&gt; select = dsl.selectCount() .from(INVOICE_LINE) .where(INVOICE_LINE.INVOICE_ID.eq(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.invoiceId)); SelectQuery&lt;?&gt; query = select.getQuery(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) query.fetch().getValue(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;Map&lt;String, Object&gt;&gt; getRecords() { SelectFinalStep&lt;?&gt; select = dsl.select( INVOICE_LINE.INVOICE_LINE_ID, INVOICE_LINE.INVOICE_ID, INVOICE_LINE.PRODUCT_ID, PRODUCT.NAME.as(<span class="hljs-string"><span class="hljs-string">"PRODUCT_NAME"</span></span>), INVOICE_LINE.QUANTITY, INVOICE_LINE.SALE_PRICE, INVOICE_LINE.SALE_PRICE.mul(INVOICE_LINE.QUANTITY).as(<span class="hljs-string"><span class="hljs-string">"TOTAL"</span></span>)) .from(INVOICE_LINE) .innerJoin(PRODUCT).on(PRODUCT.PRODUCT_ID.eq(INVOICE_LINE.PRODUCT_ID)) .where(INVOICE_LINE.INVOICE_ID.eq(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.invoiceId)); SelectQuery&lt;?&gt; query = select.getQuery(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> query.fetchMaps(); } }</code> </pre><br></div></div><br> , ,    (  ),    ,     ru.ibase.fbjavaex.managers.InvoiceManager,     .              Snapshot.               (   ,     ). <br><br><div class="spoiler"> <b class="spoiler_title">InvoiceManager.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.managers; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.Timestamp; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jooq.DSLContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.transaction.annotation.Transactional; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.transaction.annotation.Propagation; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.transaction.annotation.Isolation; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Sequences.GEN_INVOICE_ID; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Routines.spAddInvoice; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Routines.spEditInvoice; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Routines.spPayForInovice; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Routines.spDeleteInvoice; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Routines.spAddInvoiceLine; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Routines.spEditInvoiceLine; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ru.ibase.fbjavaex.exampledb.Routines.spDeleteInvoiceLine; <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Simonov Denis */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InvoiceManager</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span>(required = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DSLContext dsl; <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> customerId * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceDate */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer customerId, Timestamp invoiceDate)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> invoiceId = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.nextval(GEN_INVOICE_ID).intValue(); spAddInvoice(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.configuration(), invoiceId, customerId, invoiceDate); } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceId * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> customerId * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceDate */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer invoiceId, Integer customerId, Timestamp invoiceDate)</span></span></span><span class="hljs-function"> </span></span>{ spEditInvoice(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.configuration(), invoiceId, customerId, invoiceDate); } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceId */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer invoiceId)</span></span></span><span class="hljs-function"> </span></span>{ spPayForInovice(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.configuration(), invoiceId); } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceId */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer invoiceId)</span></span></span><span class="hljs-function"> </span></span>{ spDeleteInvoice(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.configuration(), invoiceId); } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceId * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> productId * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> quantity */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addInvoiceLine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer invoiceId, Integer productId, Integer quantity)</span></span></span><span class="hljs-function"> </span></span>{ spAddInvoiceLine(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.configuration(), invoiceId, productId, quantity); } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceLineId * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> quantity */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">editInvoiceLine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer invoiceLineId, Integer quantity)</span></span></span><span class="hljs-function"> </span></span>{ spEditInvoiceLine(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.configuration(), invoiceLineId, quantity); } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceLineId */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(propagation = Propagation.REQUIRED, isolation = Isolation.REPEATABLE_READ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deleteInvoiceLine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer invoiceLineId)</span></span></span><span class="hljs-function"> </span></span>{ spDeleteInvoiceLine(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dsl.configuration(), invoiceLineId); } }</code> </pre><br></div></div><br>     .       index,     JSP  ().       ,    . <br><br>          jqGrid ( /invoice/getdata).      getData ( ).      getDetailData ( /invoice/getdetaildata).       ,      .  addInvoice, editInvoice, payInvoice, deleteInvoice  , ,     .  addInvoiceLine, editInvoiceLine, deleteInvoiceLine  ,      . <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvoiceController.java</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.ibase.fbjavaex.controllers; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.Timestamp; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.HashMap; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Date; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.text.ParseException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.text.SimpleDateFormat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.beans.PropertyEditorSupport; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.ws.rs.core.MediaType; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.stereotype.Controller; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.ui.ModelMap; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestMapping; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestMethod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestParam; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.ResponseBody; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.InitBinder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.WebDataBinder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.jqgrid.JqGridInvoice; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.jqgrid.JqGridInvoiceLine; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.managers.InvoiceManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ru.ibase.fbjavaex.jqgrid.JqGridData; <span class="hljs-comment"><span class="hljs-comment">/** *  - * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Simonov Denis */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Controller</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InvoiceController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span>(required = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> JqGridInvoice invoiceGrid; <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span>(required = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> JqGridInvoiceLine invoiceLineGrid; <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span>(required = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> InvoiceManager invoiceManager; <span class="hljs-comment"><span class="hljs-comment">/** * ,      *    HTTP  * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> binder */</span></span> <span class="hljs-meta"><span class="hljs-meta">@InitBinder</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initBinder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WebDataBinder binder)</span></span></span><span class="hljs-function"> </span></span>{ binder.registerCustomEditor(Timestamp.class, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PropertyEditorSupport() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAsText</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((value == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) || (value.isEmpty())) { setValue(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Date parsedDate = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleDateFormat(<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd'T'HH:mm:ss"</span></span>).parse(value); setValue(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Timestamp(parsedDate.getTime())); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (ParseException e) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> java.lang.IllegalArgumentException(value); } } }); } <span class="hljs-comment"><span class="hljs-comment">/** *    *   JSP  ()   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> map * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment">  JSP  */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/invoice/"</span></span>, method = RequestMethod.GET) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ModelMap map)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"invoice"</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/** *       JSON  jqGrid * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> rows     * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> page    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> sIdx   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> sOrd   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> search   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> searchField   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> searchString   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> searchOper   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> filters  * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/invoice/getdata"</span></span>, method = RequestMethod.GET, produces = MediaType.APPLICATION_JSON) <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> JqGridData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"rows"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"20"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> rows, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"page"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"1"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> page, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"sidx"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String sIdx, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"sord"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"asc"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String sOrd, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"_search"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"false"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Boolean search, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"searchField"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String searchField, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"searchString"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String searchString, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"searchOper"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String searchOper, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"filters"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String filters) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (search) { invoiceGrid.setSearchCondition(searchField, searchString, searchOper); } invoiceGrid.setLimit(rows); invoiceGrid.setPageNo(page); invoiceGrid.setOrderBy(sIdx, sOrd); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> invoiceGrid.getJqGridData(); } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> customerId   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceDate    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/invoice/create"</span></span>, method = RequestMethod.POST, produces = MediaType.APPLICATION_JSON) <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Map&lt;String, Object&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addInvoice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"CUSTOMER_ID"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer customerId, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"INVOICE_DATE"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Timestamp invoiceDate) </span></span>{ Map&lt;String, Object&gt; map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { invoiceManager.create(customerId, invoiceDate); map.put(<span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { map.put(<span class="hljs-string"><span class="hljs-string">"error"</span></span>, ex.getMessage()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> map; } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceId    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> customerId   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceDate    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/invoice/edit"</span></span>, method = RequestMethod.POST, produces = MediaType.APPLICATION_JSON) <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Map&lt;String, Object&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">editInvoice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"INVOICE_ID"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer invoiceId, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"CUSTOMER_ID"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer customerId, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"INVOICE_DATE"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Timestamp invoiceDate) </span></span>{ Map&lt;String, Object&gt; map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { invoiceManager.edit(invoiceId, customerId, invoiceDate); map.put(<span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { map.put(<span class="hljs-string"><span class="hljs-string">"error"</span></span>, ex.getMessage()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> map; } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceId    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/invoice/pay"</span></span>, method = RequestMethod.POST, produces = MediaType.APPLICATION_JSON) <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Map&lt;String, Object&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">payInvoice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"INVOICE_ID"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer invoiceId) </span></span>{ Map&lt;String, Object&gt; map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { invoiceManager.pay(invoiceId); map.put(<span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { map.put(<span class="hljs-string"><span class="hljs-string">"error"</span></span>, ex.getMessage()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> map; } <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceId    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/invoice/delete"</span></span>, method = RequestMethod.POST, produces = MediaType.APPLICATION_JSON) <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Map&lt;String, Object&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deleteInvoice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"INVOICE_ID"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer invoiceId) </span></span>{ Map&lt;String, Object&gt; map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { invoiceManager.delete(invoiceId); map.put(<span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { map.put(<span class="hljs-string"><span class="hljs-string">"error"</span></span>, ex.getMessage()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> map; } <span class="hljs-comment"><span class="hljs-comment">/** *      * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoice_id    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/invoice/getdetaildata"</span></span>, method = RequestMethod.GET, produces = MediaType.APPLICATION_JSON) <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> JqGridData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDetailData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"INVOICE_ID"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> invoice_id) </span></span>{ invoiceLineGrid.setInvoiceId(invoice_id); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> invoiceLineGrid.getJqGridData(); } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceId    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> productId   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> quantity   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/invoice/createdetail"</span></span>, method = RequestMethod.POST, produces = MediaType.APPLICATION_JSON) <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Map&lt;String, Object&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addInvoiceLine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"INVOICE_ID"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer invoiceId, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"PRODUCT_ID"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer productId, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"QUANTITY"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer quantity) </span></span>{ Map&lt;String, Object&gt; map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { invoiceManager.addInvoiceLine(invoiceId, productId, quantity); map.put(<span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { map.put(<span class="hljs-string"><span class="hljs-string">"error"</span></span>, ex.getMessage()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> map; } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceLineId     * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> quantity   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/invoice/editdetail"</span></span>, method = RequestMethod.POST, produces = MediaType.APPLICATION_JSON) <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Map&lt;String, Object&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">editInvoiceLine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"INVOICE_LINE_ID"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer invoiceLineId, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"QUANTITY"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer quantity) </span></span>{ Map&lt;String, Object&gt; map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { invoiceManager.editInvoiceLine(invoiceLineId, quantity); map.put(<span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { map.put(<span class="hljs-string"><span class="hljs-string">"error"</span></span>, ex.getMessage()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> map; } <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> invoiceLineId     * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/invoice/deletedetail"</span></span>, method = RequestMethod.POST, produces = MediaType.APPLICATION_JSON) <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Map&lt;String, Object&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deleteInvoiceLine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"INVOICE_LINE_ID"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, defaultValue = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"0"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer invoiceLineId) </span></span>{ Map&lt;String, Object&gt; map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { invoiceManager.deleteInvoiceLine(invoiceLineId); map.put(<span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { map.put(<span class="hljs-string"><span class="hljs-string">"error"</span></span>, ex.getMessage()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> map; } }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In general, invoice controller controlers are similar to reference book controllers with two exceptions: </font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The controller displays and works with the data of both the main and detail grid. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The invoice invoice is filtered by the date field so that only those invoice invoices that are included in the working period are included in the sample. </font></font></li></ol><br>       . <br><br>  java.sql.Timestamp  Java    ,      Firebird    TIMESTAMP    .        . <br><br>      Java    .   ,    Firebird    TIMESTAMP WITH TIMEZONE.    Java ,           (   UTC     ).     JSON     UTC.        JavaScript. <br><br><table><tbody><tr><td>  <b>Attention!</b> <br><br> Java        ,     .         JDK.      JDK,          . <br></td></tr></tbody></table><br><br>      JSON    (     1  1970).    .           WebAppConfig,  ,   configureMessageConverters   SerializationFeature.WRITE_DATES_AS_TIMESTAMPS     false. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@ComponentScan</span></span>(<span class="hljs-string"><span class="hljs-string">"ru.ibase.fbjavaex"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@EnableWebMvc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebAppConfig</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebMvcConfigurerAdapter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configureMessageConverters</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; httpMessageConverters)</span></span></span><span class="hljs-function"> </span></span>{ MappingJackson2HttpMessageConverter jsonConverter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MappingJackson2HttpMessageConverter(); ObjectMapper objectMapper = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObjectMapper(); objectMapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); jsonConverter.setObjectMapper(objectMapper); httpMessageConverters.add(jsonConverter); } ‚Ä¶ }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The initBinder method of the InvoiceController controller describes how the textual representation of the date sent by the browser is converted to a value of type Timestamp. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The JSP page contains markup for displaying a grid with invoice headers and a navigation bar. </font><font style="vertical-align: inherit;">The positions of the invoice are displayed when opening the invoice header, as a drop-down grid.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Invoices.jsp</font></font></b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@page</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">contentType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pageEncoding</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">%&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">taglib</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/jsp/jstl/core"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"c"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">c:set</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">var</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${pageContext.request.servletContext.contextPath}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"request"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Content-Type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> Spring MVC    Firebird  jOOQ<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">include</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">file</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../jspf/head.jspf"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${cp}/resources/js/jqGridProduct.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${cp}/resources/js/jqGridCustomer.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${cp}/resources/js/jqGridInvoice.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">include</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">file</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../jspf/menu.jspf"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container body-content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>Invoices<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jqGridInvoice"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jqPagerInvoice"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>¬© 2016 -  Spring MVC    Firebird  jOOQ<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> invoiceGrid = </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">null</span></span></span><span class="javascript">; $(</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">).ready(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ invoiceGrid = JqGridInvoice({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">baseAddress</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'${cp}'</span></span></span><span class="javascript"> }); }); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The main client-side logic is centered in the JavaScript module /resources/js/jqGridInvoice.js </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jqGridInvoice.js</font></font></b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> JqGridInvoice = (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$, jqGridProductFactory, jqGridCustomerFactory</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jqGridInvoice = { <span class="hljs-attr"><span class="hljs-attr">dbGrid</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">detailGrid</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-comment"><span class="hljs-comment">//  options: $.extend({ baseAddress: null }, options), //    ()   getInvoiceColModel: function () { return [ { label: 'Id', //  name: 'INVOICE_ID', //   key: true, //    hidden: true //  }, { label: 'Customer Id', //  name: 'CUSTOMER_ID', //   hidden: true, //  editrules: {edithidden: true, required: true}, //    editable: true, //  edittype: 'custom', //   editoptions: { custom_element: function (value, options) { //   input return $("&lt;input&gt;") .attr('type', 'hidden') .attr('rowid', options.rowId) .addClass("FormElement") .addClass("form-control") .val(value) .get(0); } } }, { label: 'Date', name: 'INVOICE_DATE', width: 60, //  sortable: true, //   editable: true, //  search: true, //   edittype: "text", //    align: "right", //     formatter: jqGridInvoice.dateTimeFormatter, //    sorttype: 'date', //    formatoptions: { srcformat: 'Ymd\TH:i:s', //   newformat: 'dmY H:i:s' //   }, editoptions: { //      dataInit: function (element) { //  datepicker $(element).datepicker({ id: 'invoiceDate_datePicker', dateFormat: 'dd.mm.yy', minDate: new Date(2000, 0, 1), maxDate: new Date(2030, 0, 1) }); } }, searchoptions: { //      dataInit: function (element) { //  datepicker $(element).datepicker({ id: 'invoiceDate_datePicker', dateFormat: 'dd.mm.yy', minDate: new Date(2000, 0, 1), maxDate: new Date(2030, 0, 1) }); }, searchoptions: { //   sopt: ['eq', 'lt', 'le', 'gt', 'ge'] } } }, { label: 'Customer', name: 'CUSTOMER_NAME', width: 250, editable: true, edittype: "text", editoptions: { size: 50, maxlength: 60, readonly: true //   }, editrules: {required: true}, search: true, searchoptions: { sopt: ['eq', 'bw', 'cn'] } }, { label: 'Amount', name: 'TOTAL_SALE', width: 60, sortable: false, editable: false, search: false, align: "right", formatter: 'currency', //    sorttype: 'number', searchrules: { "required": true, "number": true, "minValue": 0 } }, { label: 'Paid', name: 'PAID', width: 30, sortable: false, editable: true, search: true, searchoptions: { sopt: ['eq'] }, edittype: "checkbox", //  formatter: "checkbox", stype: "checkbox", align: "center", editoptions: { value: "1", offval: "0" } } ]; }, initGrid: function () { // url    var url = jqGridInvoice.options.baseAddress + '/invoice/getdata'; jqGridInvoice.dbGrid = $("#jqGridInvoice").jqGrid({ url: url, datatype: "json", //    mtype: "GET", //  http  //   colModel: jqGridInvoice.getInvoiceColModel(), rowNum: 500, //    loadonce: false, //     sortname: 'INVOICE_DATE', //       sortorder: "desc", //   width: window.innerWidth - 80, //   height: 500, //   viewrecords: true, //    guiStyle: "bootstrap", iconSet: "fontAwesome", caption: "Invoices", //    pager: '#jqPagerInvoice', //      subGrid: true, //    // javascript      subGridRowExpanded: jqGridInvoice.showChildGrid, subGridOptions: { //    //      reloadOnExpand: false, //         "+" selectOnExpand: true } }); }, //    dateTimeFormatter: function(cellvalue, options, rowObject) { var date = new Date(cellvalue); return date.toLocaleString().replace(",", ""); }, //     getTemplate: function () { var template = "&lt;div style='margin-left:15px;' id='dlgEditInvoice'&gt;"; template += "&lt;div&gt;{CUSTOMER_ID} &lt;/div&gt;"; template += "&lt;div&gt; Date: &lt;/div&gt;&lt;div&gt;{INVOICE_DATE}&lt;/div&gt;"; //      template += "&lt;div&gt; Customer &lt;sup&gt;*&lt;/sup&gt;:&lt;/div&gt;"; template += "&lt;div&gt;"; template += "&lt;div style='float: left;'&gt;{CUSTOMER_NAME}&lt;/div&gt; "; template += "&lt;a style='margin-left: 0.2em;' class='btn' onclick='invoiceGrid.showCustomerWindow(); return false;'&gt;"; template += "&lt;span class='glyphicon glyphicon-folder-open'&gt;&lt;/span&gt;&lt;/a&gt; "; template += "&lt;div style='clear: both;'&gt;&lt;/div&gt;"; template += "&lt;/div&gt;"; template += "&lt;div&gt; {PAID} Paid &lt;/div&gt;"; template += "&lt;hr style='width: 100%;'/&gt;"; template += "&lt;div&gt; {sData} {cData} &lt;/div&gt;"; template += "&lt;/div&gt;"; return template; }, //    UTC convertToUTC: function(datetime) { if (datetime) { //    var dateParts = datetime.split('.'); var date = dateParts[2].substring(0, 4) + '-' + dateParts[1] + '-' + dateParts[0]; var time = dateParts[2].substring(5); if (!time) { time = '00:00:00'; } var dt = Date.parse(date + 'T' + time); var s = dt.getUTCFullYear() + '-' + dt.getUTCMonth() + '-' + dt.getUTCDay() + 'T' + dt.getUTCHour() + ':' + dt.getUTCMinute() + ':' + dt.getUTCSecond() + ' GMT'; return s; } else return null; }, //    - getEditInvoiceOptions: function () { return { url: jqGridInvoice.options.baseAddress + '/invoice/edit', reloadAfterSubmit: true, closeOnEscape: true, closeAfterEdit: true, drag: true, modal: true, top: $(".container.body-content").position().top + 150, left: $(".container.body-content").position().left + 150, template: jqGridInvoice.getTemplate(), afterSubmit: jqGridInvoice.afterSubmit, editData: { INVOICE_ID: function () { var selectedRow = jqGridInvoice.dbGrid.getGridParam("selrow"); var value = jqGridInvoice.dbGrid.getCell(selectedRow, 'INVOICE_ID'); return value; }, CUSTOMER_ID: function () { return $('#dlgEditInvoice input[name=CUSTOMER_ID]').val(); }, INVOICE_DATE: function () { var datetime = $('#dlgEditInvoice input[name=INVOICE_DATE]').val(); return jqGridInvoice.convertToUTC(datetime); } } }; }, //    - getAddInvoiceOptions: function () { return { url: jqGridInvoice.options.baseAddress + '/invoice/create', reloadAfterSubmit: true, closeOnEscape: true, closeAfterAdd: true, drag: true, modal: true, top: $(".container.body-content").position().top + 150, left: $(".container.body-content").position().left + 150, template: jqGridInvoice.getTemplate(), afterSubmit: jqGridInvoice.afterSubmit, editData: { CUSTOMER_ID: function () { return $('#dlgEditInvoice input[name=CUSTOMER_ID]').val(); }, INVOICE_DATE: function () { var datetime = $('#dlgEditInvoice input[name=INVOICE_DATE]').val(); return jqGridInvoice.convertToUTC(datetime); } } }; }, //    - getDeleteInvoiceOptions: function () { return { url: jqGridInvoice.options.baseAddress + '/invoice/delete', reloadAfterSubmit: true, closeOnEscape: true, closeAfterDelete: true, drag: true, msg: "  -?", afterSubmit: jqGridInvoice.afterSubmit, delData: { INVOICE_ID: function () { var selectedRow = jqGridInvoice.dbGrid.getGridParam("selrow"); var value = jqGridInvoice.dbGrid.getCell(selectedRow, 'INVOICE_ID'); return value; } } }; }, initPager: function () { //    jqGridInvoice.dbGrid.jqGrid('navGrid', '#jqPagerInvoice', { search: true, //  add: true, //  edit: true, //  del: true, //  view: false, //   refresh: true, //  searchtext: "", addtext: "", edittext: "", deltext: "", viewtext: "", viewtitle: " ", refreshtext: "" }, jqGridInvoice.getEditInvoiceOptions(), jqGridInvoice.getAddInvoiceOptions(), jqGridInvoice.getDeleteInvoiceOptions() ); //       var urlPay = jqGridInvoice.options.baseAddress + '/invoice/pay'; jqGridInvoice.dbGrid.navButtonAdd('#jqPagerInvoice', { buttonicon: "glyphicon-usd", title: "", caption: "", position: "last", onClickButton: function () { //     var id = jqGridInvoice.dbGrid.getGridParam("selrow"); if (id) { $.ajax({ url: urlPay, type: 'POST', data: {INVOICE_ID: id}, success: function (data) { //      if (data.hasOwnProperty("error")) { jqGridInvoice.alertDialog('', data.error); } else { //   $("#jqGridInvoice").jqGrid( 'setGridParam', { datatype: 'json' } ).trigger('reloadGrid'); } } }); } } } ); }, init: function () { jqGridInvoice.initGrid(); jqGridInvoice.initPager(); }, afterSubmit: function (response, postdata) { var responseData = response.responseJSON; //        if (responseData.hasOwnProperty("error")) { if (responseData.error.length) { return [false, responseData.error]; } } else { //   $(this).jqGrid( 'setGridParam', { datatype: 'json' } ).trigger('reloadGrid'); } return [true, "", 0]; }, getInvoiceLineColModel: function (parentRowKey) { return [ { label: 'Invoice Line ID', name: 'INVOICE_LINE_ID', key: true, hidden: true }, { label: 'Invoice ID', name: 'INVOICE_ID', hidden: true, editrules: {edithidden: true, required: true}, editable: true, edittype: 'custom', editoptions: { custom_element: function (value, options) { //     return $("&lt;input&gt;") .attr('type', 'hidden') .attr('rowid', options.rowId) .addClass("FormElement") .addClass("form-control") .val(parentRowKey) .get(0); } } }, { label: 'Product ID', name: 'PRODUCT_ID', hidden: true, editrules: {edithidden: true, required: true}, editable: true, edittype: 'custom', editoptions: { custom_element: function (value, options) { //     return $("&lt;input&gt;") .attr('type', 'hidden') .attr('rowid', options.rowId) .addClass("FormElement") .addClass("form-control") .val(value) .get(0); } } }, { label: 'Product', name: 'PRODUCT_NAME', width: 300, editable: true, edittype: "text", editoptions: { size: 50, maxlength: 60, readonly: true }, editrules: {required: true} }, { label: 'Price', name: 'SALE_PRICE', formatter: 'currency', editable: true, editoptions: { readonly: true }, align: "right", width: 100 }, { label: 'Quantity', name: 'QUANTITY', align: "right", width: 100, editable: true, editrules: {required: true, number: true, minValue: 1}, editoptions: { dataEvents: [ { type: 'change', fn: function (e) { var quantity = $(this).val() - 0; var price = $('#dlgEditInvoiceLine input[name=SALE_PRICE]').val() - 0; $('#dlgEditInvoiceLine input[name=TOTAL]').val(quantity * price); } } ], defaultValue: 1 } }, { label: 'Total', name: 'TOTAL', formatter: 'currency', align: "right", width: 100, editable: true, editoptions: { readonly: true } } ]; }, //       getEditInvoiceLineOptions: function () { return { url: jqGridInvoice.options.baseAddress + '/invoice/editdetail', reloadAfterSubmit: true, closeOnEscape: true, closeAfterEdit: true, drag: true, modal: true, top: $(".container.body-content").position().top + 150, left: $(".container.body-content").position().left + 150, template: jqGridInvoice.getTemplateDetail(), afterSubmit: jqGridInvoice.afterSubmit, editData: { INVOICE_LINE_ID: function () { var selectedRow = jqGridInvoice.detailGrid.getGridParam("selrow"); var value = jqGridInvoice.detailGrid.getCell(selectedRow, 'INVOICE_LINE_ID'); return value; }, QUANTITY: function () { return $('#dlgEditInvoiceLine input[name=QUANTITY]').val(); } } }; }, //       getAddInvoiceLineOptions: function () { return { url: jqGridInvoice.options.baseAddress + '/invoice/createdetail', reloadAfterSubmit: true, closeOnEscape: true, closeAfterAdd: true, drag: true, modal: true, top: $(".container.body-content").position().top + 150, left: $(".container.body-content").position().left + 150, template: jqGridInvoice.getTemplateDetail(), afterSubmit: jqGridInvoice.afterSubmit, editData: { INVOICE_ID: function () { var selectedRow = jqGridInvoice.dbGrid.getGridParam("selrow"); var value = jqGridInvoice.dbGrid.getCell(selectedRow, 'INVOICE_ID'); return value; }, PRODUCT_ID: function () { return $('#dlgEditInvoiceLine input[name=PRODUCT_ID]').val(); }, QUANTITY: function () { return $('#dlgEditInvoiceLine input[name=QUANTITY]').val(); } } }; }, //       getDeleteInvoiceLineOptions: function () { return { url: jqGridInvoice.options.baseAddress + '/invoice/deletedetail', reloadAfterSubmit: true, closeOnEscape: true, closeAfterDelete: true, drag: true, msg: "  ?", afterSubmit: jqGridInvoice.afterSubmit, delData: { INVOICE_LINE_ID: function () { var selectedRow = jqGridInvoice.detailGrid.getGridParam("selrow"); var value = jqGridInvoice.detailGrid.getCell(selectedRow, 'INVOICE_LINE_ID'); return value; } } }; }, //      //       //     showChildGrid: function (parentRowID, parentRowKey) { var childGridID = parentRowID + "_table"; var childGridPagerID = parentRowID + "_pager"; //      //      var childGridURL = jqGridInvoice.options.baseAddress + '/invoice/getdetaildata'; childGridURL = childGridURL + "?INVOICE_ID=" + encodeURIComponent(parentRowKey); //  HTML        //         $('&lt;table&gt;') .attr('id', childGridID) .appendTo($('#' + parentRowID)); $('&lt;div&gt;') .attr('id', childGridPagerID) .addClass('scroll') .appendTo($('#' + parentRowID)); //      jqGridInvoice.detailGrid = $("#" + childGridID).jqGrid({ url: childGridURL, mtype: "GET", datatype: "json", page: 1, colModel: jqGridInvoice.getInvoiceLineColModel(parentRowKey), loadonce: false, width: '100%', height: '100%', guiStyle: "bootstrap", iconSet: "fontAwesome", pager: "#" + childGridPagerID }); //    $("#" + childGridID).jqGrid('navGrid', '#' + childGridPagerID, { search: false, //  add: true, //  edit: true, //  del: true, //  refresh: true //  }, jqGridInvoice.getEditInvoiceLineOptions(), jqGridInvoice.getAddInvoiceLineOptions(), jqGridInvoice.getDeleteInvoiceLineOptions() ); }, //        getTemplateDetail: function () { var template = "&lt;div style='margin-left:15px;' id='dlgEditInvoiceLine'&gt;"; template += "&lt;div&gt;{INVOICE_ID} &lt;/div&gt;"; template += "&lt;div&gt;{PRODUCT_ID} &lt;/div&gt;"; //      template += "&lt;div&gt; Product &lt;sup&gt;*&lt;/sup&gt;:&lt;/div&gt;"; template += "&lt;div&gt;"; template += "&lt;div style='float: left;'&gt;{PRODUCT_NAME}&lt;/div&gt; "; template += "&lt;a style='margin-left: 0.2em;' class='btn' onclick='invoiceGrid.showProductWindow(); return false;'&gt;"; template += "&lt;span class='glyphicon glyphicon-folder-open'&gt;&lt;/span&gt; &lt;/a&gt; "; template += "&lt;div style='clear: both;'&gt;&lt;/div&gt;"; template += "&lt;/div&gt;"; template += "&lt;div&gt; Quantity: &lt;/div&gt;&lt;div&gt;{QUANTITY} &lt;/div&gt;"; template += "&lt;div&gt; Price: &lt;/div&gt;&lt;div&gt;{SALE_PRICE} &lt;/div&gt;"; template += "&lt;div&gt; Total: &lt;/div&gt;&lt;div&gt;{TOTAL} &lt;/div&gt;"; template += "&lt;hr style='width: 100%;'/&gt;"; template += "&lt;div&gt; {sData} {cData} &lt;/div&gt;"; template += "&lt;/div&gt;"; return template; }, //       showProductWindow: function () { var dlg = $('&lt;div&gt;') .attr('id', 'dlgChooseProduct') .attr('aria-hidden', 'true') .attr('role', 'dialog') .attr('data-backdrop', 'static') .css("z-index", '2000') .addClass('modal') .appendTo($('body')); var dlgContent = $("&lt;div&gt;") .addClass("modal-content") .css('width', '760px') .appendTo($('&lt;div&gt;') .addClass('modal-dialog') .appendTo(dlg)); var dlgHeader = $('&lt;div&gt;').addClass("modal-header").appendTo(dlgContent); $("&lt;button&gt;") .addClass("close") .attr('type', 'button') .attr('aria-hidden', 'true') .attr('data-dismiss', 'modal') .html("√ó") .appendTo(dlgHeader); $("&lt;h5&gt;").addClass("modal-title").html(" ").appendTo(dlgHeader); var dlgBody = $('&lt;div&gt;') .addClass("modal-body") .appendTo(dlgContent); var dlgFooter = $('&lt;div&gt;').addClass("modal-footer").appendTo(dlgContent); $("&lt;button&gt;") .attr('type', 'button') .addClass('btn') .html('OK') .on('click', function () { var rowId = $("#jqGridProduct").jqGrid("getGridParam", "selrow"); var row = $("#jqGridProduct").jqGrid("getRowData", rowId); $('#dlgEditInvoiceLine input[name=PRODUCT_ID]').val(row["PRODUCT_ID"]); $('#dlgEditInvoiceLine input[name=PRODUCT_NAME]').val(row["NAME"]); $('#dlgEditInvoiceLine input[name=SALE_PRICE]').val(row["PRICE"]); var price = $('#dlgEditInvoiceLine input[name=SALE_PRICE]').val() - 0; var quantity = $('#dlgEditInvoiceLine input[name=QUANTITY]').val() - 0; $('#dlgEditInvoiceLine input[name=TOTAL]').val(Math.round(price * quantity * 100) / 100); dlg.modal('hide'); }) .appendTo(dlgFooter); $("&lt;button&gt;") .attr('type', 'button') .addClass('btn') .html('Cancel') .on('click', function () { dlg.modal('hide'); }) .appendTo(dlgFooter); $('&lt;table&gt;') .attr('id', 'jqGridProduct') .appendTo(dlgBody); $('&lt;div&gt;') .attr('id', 'jqPagerProduct') .appendTo(dlgBody); dlg.on('hidden.bs.modal', function () { dlg.remove(); }); dlg.modal(); jqGridProductFactory({ baseAddress: jqGridInvoice.options.baseAddress }); }, //       showCustomerWindow: function () { //    var dlg = $('&lt;div&gt;') .attr('id', 'dlgChooseCustomer') .attr('aria-hidden', 'true') .attr('role', 'dialog') .attr('data-backdrop', 'static') .css("z-index", '2000') .addClass('modal') .appendTo($('body')); //     var dlgContent = $("&lt;div&gt;") .addClass("modal-content") .css('width', '730px') .appendTo($('&lt;div&gt;') .addClass('modal-dialog') .appendTo(dlg)); //     var dlgHeader = $('&lt;div&gt;').addClass("modal-header").appendTo(dlgContent); //  "X"   $("&lt;button&gt;") .addClass("close") .attr('type', 'button') .attr('aria-hidden', 'true') .attr('data-dismiss', 'modal') .html("√ó") .appendTo(dlgHeader); //  $("&lt;h5&gt;").addClass("modal-title").html(" ").appendTo(dlgHeader); //   var dlgBody = $('&lt;div&gt;') .addClass("modal-body") .appendTo(dlgContent); //   var dlgFooter = $('&lt;div&gt;').addClass("modal-footer").appendTo(dlgContent); //  "OK" $("&lt;button&gt;") .attr('type', 'button') .addClass('btn') .html('OK') .on('click', function () { var rowId = $("#jqGridCustomer").jqGrid("getGridParam", "selrow"); var row = $("#jqGridCustomer").jqGrid("getRowData", rowId); //      //      $('#dlgEditInvoice input[name=CUSTOMER_ID]').val(rowId); $('#dlgEditInvoice input[name=CUSTOMER_NAME]').val(row["NAME"]); dlg.modal('hide'); }) .appendTo(dlgFooter); //  "Cancel" $("&lt;button&gt;") .attr('type', 'button') .addClass('btn') .html('Cancel') .on('click', function () { dlg.modal('hide'); }) .appendTo(dlgFooter); //         $('&lt;table&gt;') .attr('id', 'jqGridCustomer') .appendTo(dlgBody); //    $('&lt;div&gt;') .attr('id', 'jqPagerCustomer') .appendTo(dlgBody); dlg.on('hidden.bs.modal', function () { dlg.remove(); }); //   dlg.modal(); jqGridCustomerFactory({ baseAddress: jqGridInvoice.options.baseAddress }); }, //     alertDialog: function (title, error) { var alertDlg = $('&lt;div&gt;') .attr('aria-hidden', 'true') .attr('role', 'dialog') .attr('data-backdrop', 'static') .addClass('modal') .appendTo($('body')); var dlgContent = $("&lt;div&gt;") .addClass("modal-content") .appendTo($('&lt;div&gt;') .addClass('modal-dialog') .appendTo(alertDlg)); var dlgHeader = $('&lt;div&gt;').addClass("modal-header").appendTo(dlgContent); $("&lt;button&gt;") .addClass("close") .attr('type', 'button') .attr('aria-hidden', 'true') .attr('data-dismiss', 'modal') .html("√ó") .appendTo(dlgHeader); $("&lt;h5&gt;").addClass("modal-title").html(title).appendTo(dlgHeader); $('&lt;div&gt;') .addClass("modal-body") .appendTo(dlgContent) .append(error); alertDlg.on('hidden.bs.modal', function () { alertDlg.remove(); }); alertDlg.modal(); } }; jqGridInvoice.init(); return jqGridInvoice; }; })(jQuery, JqGridProduct, JqGridCustomer);</span></span></code> </pre><br></div></div><br>    ,      ,       .      subGrid   true.   ,   subGridRowExpanded,     showChildGrid.       .                    jqGridInvoice.dbGrid.navButtonAdd (.  initPager). <br><br>          .       .           jqGrid,          ,    .     getTemplate.         invoiceGrid.showCustomerWindow().        JqGridCustomer.            CUSTOMER_ID.   editData      ,      ,       . <br><br>     .    ,  InvoiceController    UTC,         .       jqGridInvoice.dateTimeFormatter   formatter,   INVOICE_DATE.           ‚Äì        UTC.     convertToUTC. <br><br>     ,     ,    getTemplateDetail.          invoiceGrid.showProductWindow().      JqGridProduct. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The code of the JqGridInvoice module is commented in detail so that you can understand the logic of its operation. </font><font style="vertical-align: inherit;">Additional explanations can be found in it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally, here are some screenshots of the resulting web application. </font></font><br><br><img src="https://habrastorage.org/web/fb6/952/391/fb69523912be4a069de17acca1511bdb.png"><br><br><img src="https://habrastorage.org/web/8ee/70a/906/8ee70a9065d842b09ac07234b04b281c.png"><br><br><img src="https://habrastorage.org/web/cf9/dc6/3b0/cf9dc63b0c0044b7a10ceef58be4b601.png"><br><br><img src="https://habrastorage.org/web/581/135/fc3/581135fc3b8b405c9f99de0ea267f269.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This completes my example. </font><font style="vertical-align: inherit;">Source codes you can download the </font></font><a href="https://github.com/sim1984/fbjavaex"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can download scripts to create a database using the links </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firebird_2_5.sql</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firebird_3_0.sql</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can download ready databases by clicking on </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firebird_2_5_DB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firebird_3_0_DB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div><p>Source: <a href="https://habr.com/ru/post/331098/">https://habr.com/ru/post/331098/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331088/index.html">Reduce the use of Redux code with React Apollo</a></li>
<li><a href="../331090/index.html">Shallow immersion or data recovery from the hard drive after flooding the office</a></li>
<li><a href="../331092/index.html">Cricket Lee and Paul Vixie's Webinar on Network Security with DNS RPZ</a></li>
<li><a href="../331094/index.html">Security Week 24: 95 fixes from Microsoft, the router merges the data with LEDs, for MacOS there is a runner service</a></li>
<li><a href="../331096/index.html">Better to hear once than read seven times</a></li>
<li><a href="../331100/index.html">Casual C ++: isolating the C-style API</a></li>
<li><a href="../331104/index.html">This question must be addressed by the architect. Or not?</a></li>
<li><a href="../331114/index.html">A quick setup option for a wholesale company management system</a></li>
<li><a href="../331116/index.html">New plug-in for Sennheiser headsets and free upgrade to 3CX v15.5</a></li>
<li><a href="../331118/index.html">Catch data big and small! (Overview of Data Science courses from the Cognitive Class)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>