<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Erlang. Recommendations for code design</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, the team had to invite a new programmer and introduce him to Erlang. To speed up the learning process, I decided to translate Erlang ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Erlang. Recommendations for code design</h1><div class="post__text post__text-html js-mediator-article">  Not so long ago, the team had to invite a new programmer and introduce him to Erlang.  To speed up the learning process, I decided to translate <a href="http://www.erlang.se/doc/programming_rules.shtml">Erlang Programming Rules and Conventions</a> for a long time.  What, in principle, I want to share with habrovchanami.  I hope that it will be useful to those who are going to learn or already use this wonderful language.  I must say that the translation is free, so do not criticize much. <br><a name="habracut"></a><br><h4>  1. Goals </h4><br>  This article lists some aspects that should be considered when developing software using Erlang. <br><br><h5>  2. Structure and terminology of Erlang </h5><br>  All Erlang subsystems are divided into modules.  modules in turn consist of functions and attributes. <br>  Functions can be either internal or exported for use in third-party modules. <br>  Attributes start with a '-' and are placed at the beginning of the module. <br><br>  All work in the Erlang architecture is carried out by threads.  A thread in turn is a set of instructions that can use the function calls of various modules.  Streams can communicate with each other by sending messages.  Also, upon receipt, they can determine which messages need to be processed first.  The rest of the messages remain in the queue until <br>  there will be no need. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Streams can follow each other's work through binding ( <i>link</i> command).  When a thread finishes its execution or a signal is automatically dropped, a signal is sent to all associated threads. <br>  The default response to this signal for a thread is to immediately stop the operation. <br>  But this behavior can be changed by setting the <i>trap_exit</i> flag, in which the signals are converted to messages and can be processed by the program. <br><br>  Pure functions are functions whose value depends only on the input data and does not depend on the context of the call.  With this behavior, they are similar to ordinary mathematics.  Those who are not clean are said to be functions with side effects. <br><br>  A side effect usually occurs if the function: <br><ul><li>  Sends messages </li><li>  Receives messages </li><li>  Causes <i>exit</i> </li><li>  calls a <i>BIF</i> that changes the flow environment (such as <i>get / 1</i> , <i>put / 2</i> , <i>erase / 1</i> , <i>process_flag / 2</i> ) </li></ul><br><h4>  3 Design Principles </h4><br><br><h5>  3.1 Export as few functions as possible from the module. </h5><br>  Modules are the basic structural unit in Erlang.  They may contain a huge number of functions, but only those included in the export list will be available to third-party modules. <br><br>  The complexity of the module depends on the number of exported functions.  Agree, because it is easier to deal with the module that exports a couple of functions than the one that exports a dozen. <br>  After all, the user needs to understand only those that are exported. <br><br>  In addition, the one who accompanies the module code can be without fear of changing the internal functions, because the interface to the module remains unchanged. <br><br><h5>  3.2 Try to reduce dependencies between modules. </h5><br>  A module that appeals to many others is much more difficult to maintain, because if changes <br>  interface, it is necessary to change the code wherever this module was used. <br><br>  Remember, ideally, module calls should be a tree and not a graph with cycles.  (from myself. For this, the <a href="https://github.com/RefactoringTools/wrangler">Wrangler</a> refactoring tool has a convenient mechanism based on GraphViz that can draw a function call graph) <br><br>  As a result, the call code should be represented like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/0b7/451/a2a/0b7451a2a2b254dc749e7529c74141cb.gif" alt="image"><br>  But not: <br><img src="https://habrastorage.org/getpro/habr/post_images/5a3/78d/d1c/5a378dd1c95b3ad8f524e90d81289d50.gif" alt="image"><br><br><h5>  3.3 Place only frequently used code in libraries. </h5><br>  In the library (module) there should be a set of related functions only. <br><br>  The task of the developer is to create libraries that contain functions of the same type. <br><br>  Thus, for example, the <i>lists</i> library, which contains the code for working with lists, is an example of good architecture, and <i>lists_and_method</i> , which contains both the code for working with lists and mathematical algorithms, is bad. <br><br>  Best of all, when all the functions in the library do not contain side effects.  Then it can be easily reused. <br><br><h5>  3.4 Isolate the "hacks" and "dirty code" in separate modules </h5><br>  Often the solution to a problem requires the sharing of clean and dirty code. <br>  Separate such areas into different modules. <br><br>  For example, "dirty code": <ul><li>  uses process vocabulary </li><li>  uses <i>erlang: process_info / 1</i> for not quite adequate goals :) </li><li>  doing something that you didn‚Äôt originally intended to do, but you had to </li></ul><br>  Try to write as much clean code as possible, and ‚Äúdirty‚Äù, firstly use as little as possible, and secondly, document all possible side effects and usage problems. <br><br><h5>  3.5 Do not think about how the calling function will use the result. </h5><br>  Do not think about how the calling function will use the result of your execution. <br><br>  For example, suppose you call the <i>route</i> function, passing arguments to it that may not be correct.  The creator of the route function should not think about what we will do when the arguments are not correct. <br>  No need to write code like this: <br><pre><code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do_something</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Args)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> check_args(Args) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ok -&gt; {ok, do_it(Args)}; {error, What} -&gt; String = format_the_error(What), io:format(<span class="hljs-string"><span class="hljs-string">"* error:~s\n"</span></span>, [String]), <span class="hljs-comment"><span class="hljs-comment">%% Don't do this error end.</span></span></code> </pre> <br>  Better to do this: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do_something</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Args)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> check_args(Args) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ok -&gt; {ok, do_it(Args)}; {error, What} -&gt; {error, What} <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>. error_report({error, What}) -&gt; format_the_error(What).</code> </pre><br>  In the first case, the error is always output to the console, in the second, the error description is simply returned.  The application developer can decide for himself what to do with it - ignore or lead to the printed form using <i>error_report / 1</i> .  In any case, he has the right to choose what to do when an error occurs. <br><br><h5>  3.6 Select common patterns and behaviors from code logic </h5><br>  If some code in the code begins to repeat itself, try to separate it into a separate function or module.  So it will be much easier to maintain it than multiple copies scattered around the program. <br>  Do not use "Copy &amp; Paste", use functions! <br><br><h5>  3.7 Design from the top down </h5><br>  Develop a program from top to bottom.  This will allow you to gradually detail the code until you reach the primitive functions.  The code written in this way does not depend on the presentation of the data, since the representation is not yet known when you are developing at a higher level. <br><br><h5>  3.8 No need to optimize code </h5><br>  Do not optimize the code at the initial stage of development.  First make it work properly, and only then, if the need arises, engage in optimization. <br><br><h5>  3.9 Write predictable code </h5><br>  The result of the functions should not be a surprise to the user.  Functions that perform similar actions should look the same, or at least be similar.  The user must be able to predict what the function may return.  If the result of the execution does not meet expectations, then either the name of the function does not match its purpose, or the function code itself does not work correctly. <br><br><h5>  3.10 Try to avoid side effects. </h5><br>  Erlang has several primitives with side effects.  Functions that use them are not easy to reuse, because they depend on the environment and the programmer needs to monitor the state of the stream before the call. <br>  Write as much code as possible without side effects. <br>  Clearly document all possible problems when using non-pure functions.  This greatly facilitates the writing of tests and support. <br><br><h5>  3.11 Do not allow internal data to leave the module </h5><br>  The easiest way to demonstrate an example.  Suppose there is a queue management function: <br><pre> <code class="erlang hljs"><span class="hljs-keyword"><span class="hljs-keyword">-module</span></span><span class="hljs-params"><span class="hljs-params">(queue)</span></span>. -export([add/<span class="hljs-number"><span class="hljs-number">2</span></span>, fetch/<span class="hljs-number"><span class="hljs-number">1</span></span>]). add(Item, Q) -&gt; lists:append(Q, [Item]). fetch([H|T]) -&gt; {ok, H, T}; fetch([]) -&gt; empty.</code> </pre><br>  She describes the queue as a list.  And used like this: <br><pre> <code class="erlang hljs">NewQ = [], <span class="hljs-comment"><span class="hljs-comment">%    Queue1 = queue:add(joe, NewQ), Queue2 = queue:add(mike, Queue1), ....</span></span></code> </pre><br>  Several problems follow from this: <br><ul><li>  need to know that the queue is a list </li><li>  in the future we will not be able to change the presentation to another (when, for example, optimization is needed) </li></ul><br>  Much better to write like this: <br><pre> <code class="erlang hljs"><span class="hljs-keyword"><span class="hljs-keyword">-module</span></span><span class="hljs-params"><span class="hljs-params">(queue)</span></span>. -export([new/<span class="hljs-number"><span class="hljs-number">0</span></span>, add/<span class="hljs-number"><span class="hljs-number">2</span></span>, fetch/<span class="hljs-number"><span class="hljs-number">1</span></span>]). new() -&gt; []. add(Item, Q) -&gt; lists:append(Q, [Item]). fetch([H|T]) -&gt; {ok, H, T}; fetch([]) -&gt; empty.</code> </pre><br>  Now use will look like this: <br><pre> <code class="erlang hljs">NewQ = queue:new(), Queue1 = queue:add(joe, NewQ), Queue2 = queue:add(mike, Queue1), ‚Ä¶</code> </pre><br>  This code is devoid of the disadvantages described above. <br><br>  Now suppose you need to know the length of the queue.  If the user knows that the queue is a list he will write: <br><pre> <code class="erlang hljs">Len = length(Queue) <span class="hljs-comment"><span class="hljs-comment">%   </span></span></code> </pre><br><br>  Again, problems, since the user again tightly links the implementation with the view, such code is hard to maintain and read.  For this case, it is better to provide a separate function and add to the module: <br><pre> <code class="erlang hljs"><span class="hljs-keyword"><span class="hljs-keyword">-module</span></span><span class="hljs-params"><span class="hljs-params">(queue)</span></span>. -export([new/<span class="hljs-number"><span class="hljs-number">0</span></span>, add/<span class="hljs-number"><span class="hljs-number">2</span></span>, fetch/<span class="hljs-number"><span class="hljs-number">1</span></span>, len/<span class="hljs-number"><span class="hljs-number">1</span></span>]). new() -&gt; []. add(Item, Q) -&gt; lists:append(Q, [Item]). fetch([H|T]) -&gt; {ok, H, T}; fetch([]) -&gt; empty. len(Q) -&gt; length(Q).</code> </pre><br>  Now the user will be able to call his <i>queue: len (Queue)</i> instead of his code. <br>  In this code, we "abstracted" from the details of the implementation of the data type queue.  Those.  in other words, the queue is now ‚Äúabstract data type‚Äù. <br>  Why all this trouble?  In practice, it turned out to be an easy mechanism for replacing the internal representation, and now you can change the implementation of your module without fear of breaking backward compatibility with the user code.  For example, for better implementation, the code is rewritten as <br><pre> <code class="erlang hljs"><span class="hljs-keyword"><span class="hljs-keyword">-module</span></span><span class="hljs-params"><span class="hljs-params">(queue)</span></span>. -export([new/<span class="hljs-number"><span class="hljs-number">0</span></span>, add/<span class="hljs-number"><span class="hljs-number">2</span></span>, fetch/<span class="hljs-number"><span class="hljs-number">1</span></span>, len/<span class="hljs-number"><span class="hljs-number">1</span></span>]). new() -&gt; {[],[]}. add(Item, {X,Y}) -&gt; <span class="hljs-comment"><span class="hljs-comment">%   {[Item|X], Y}. fetch({X, [H|T]}) -&gt; {ok, H, {X,T}}; fetch({[], []) -&gt; empty; fetch({X, []) -&gt; %       fetch({[],lists:reverse(X)}). len({X,Y}) -&gt; length(X) + length(Y).</span></span></code> </pre><br><h5>  3.12 Make the code deterministic as much as possible. </h5><br>  Deterministic programs always behave in the same way regardless of how many times they are run.  Non-deterministic can behave differently with each launch.  The first option is much easier to debug and allows you to track down and avoid many mistakes, so try to stick with it. <br>  For example, the program should launch 5 different threads, and then check that they started, and the launch order is not important. <br>  You can start all 5 at once, and then check, but it is better to run them in turn, each time checking whether the stream started and only after that start the next one. <br><br><h5>  3.13 Do not constantly check the correctness of the input data </h5><br>  Often, programmers do not trust the input data for the part of the system they are developing.  Most of the code should not care about the correctness of the data transmitted to it.  Verification should occur only when data is transmitted from outside. <br>  For example: <br><pre> <code class="erlang hljs"><span class="hljs-comment"><span class="hljs-comment">%% Args: Option is all|normal get_server_usage_info(Option, AsciiPid) -&gt; Pid = list_to_pid(AsciiPid), case Option of all -&gt; get_all_info(Pid); normal -&gt; get_normal_info(Pid) end.</span></span></code> </pre><br>  The function will terminate with an error if <i>Option</i> is not <i>normall</i> or <i>all</i> .  So it should be!  Whoever calls this function must control what is passed to it. <br><br><h5>  3.14 Isolate the hardware logic in the driver </h5><br>  Equipment must be isolated from the system using a driver.  The task of the driver is to present the hardware in the system as if it were just an Erlang stream, which, like a simple stream, receives and sends messages and responds to errors. <br><br><h5>  3.15 Cancel actions in the same function as you do. </h5><br>  Suppose there is a code that opens a file, does something from it and then closes it. <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do_something_with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> file:open(File, read) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span>, {ok, Stream} -&gt; doit(Stream), file:close(Stream) <span class="hljs-comment"><span class="hljs-comment">%   Error -&gt; Error end.</span></span></code> </pre><br>  Please note that opening and closing a file occurs in the same function.  The code is easy to read and understand.  But, for example, such code is harder to understand and it is not immediately clear when the file is closed: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do_something_with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> file:open(File, read) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span>, {ok, Stream} -&gt; doit(Stream) Error -&gt; Error <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>. doit(Stream) -&gt; ...., func234(...,Stream,...). ... func234(..., Stream, ...) -&gt; ..., file:close(Stream) <span class="hljs-comment"><span class="hljs-comment">%%   </span></span></code> </pre><br><h4>  4 Error Handling </h4><br><h5>  4.1 Separate processing from normal code </h5><br>  Do not mix the normal code with the error handling code.  You must program the normal behavior.  If something goes wrong, the process should immediately terminate with an error.  Do not try to correct the error and continue.  Error handling must take another process. <br><br><h5>  4.2 Highlight the ‚Äúcore of errors‚Äù </h5><br>  One of the development stages is to determine which part of the system should always function without errors, and which part is allowed. <br>  For example, in operating systems, the kernel should function without errors, while normal applications may fail with an error, but this will not affect the functioning of the system as a whole. <br>  The part that should always work correctly we call the ‚Äúcore of errors‚Äù.  This part, as a rule, constantly stores its intermediate state in the database or on disk. <br><br><h4>  5 Threads, servers and messages </h4><br><h6>  5.1 Implement all code flow in one module </h6><br>  Of course, it should be understood that the thread calls functions from other modules, but here we are talking about the fact that the main loop of the thread should be in one module, and not split into several.  Otherwise, it will be hard to control the progress.  It also does not mean that you should not use <i>generic</i> libraries.  They are just meant to help organize the flow. <br>  Also, do not forget that the code common to several threads must be implemented in a completely separate module. <br><br><h5>  5.2 Use streams to build a system </h5><br>  Flows are the basic structural elements of a system.  But do not use them and sending a message when it is possible to simply call a function. <br><br><h5>  5.3 Logged streams </h5><br>  Threads must be registered under the same name as the name of the module that contains their code.  This will greatly facilitate support.  Register only those streams that you plan to use for a long time. <br><br><h5>  5.4 Create only one thread in the system for each physically parallel action. </h5><br>  Using threads or solving a problem consistently depends directly on the problem we are trying to solve.  But it is desirable to be guided by one main rule: <br>  "Use one thread for every parallel process in the real world." <br>  If you follow this rule, the logic of the program will be easy to understand. <br><br><h5>  5.5 Each stream should have only one ‚Äúrole‚Äù </h5><br>  Threads can perform different roles in the system.  For example, in a client-server architecture, a stream can be both a client and a server, but it is better to separate two roles into two streams. <br>  Other roles: <br><ul><li>  <b>Supervisor ( <i>supervisor</i> )</b> - monitors the flow and restarts them after the fall; </li><li>  <b>worker ( <i>worker</i> )</b> - the usual executive flow, in which errors may occur; </li><li>  <b>A trusted stream (or system <i>worker</i> , <i>trusted worker</i> )</b> is a stream in which no errors should occur. </li></ul><br><br><h5>  5.6 Use <i>generic</i> functions to build servers and work with protocols whenever possible. </h5><br>  In most cases, using <i>gen_server</i> to create servers is the best solution, <i>since</i> this will greatly facilitate the structure of the system.  This is also true for processing data transfer protocols. <br><br><h5>  5.7 Add tags to messages </h5><br>  All messages must have tags.  Tagged messages are easier to manage, since their order in the <i>receive</i> block is not important, and it is easier to add support for new messages. <br>  You should not write such code: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(State)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">receive</span></span> ... {Mod, Funcs, Args} -&gt; <span class="hljs-comment"><span class="hljs-comment">%    apply(Mod, Funcs, Args}, loop(State); ... end.</span></span></code> </pre><br>  If it becomes necessary to add processing of the message <i>{get_status_info, From, Option}</i> and place it under the first block, a conflict will arise and the new code will never be executed. <br>  If the messages are synchronous, the result must also be tagged, but different from the query.  For example: when requested with the <i>get_status_info</i> tag, the <i>status_info</i> response should come.  Compliance with this rule makes debugging much easier. <br>  Here is an example of the correct code: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(State)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">receive</span></span> ... {execute, Mod, Funcs, Args} -&gt; <span class="hljs-comment"><span class="hljs-comment">%    apply(Mod, Funcs, Args}, loop(State); {get_status_info, From, Option} -&gt; From ! {status_info, get_status_info(Option, State)}, %   loop(State); ... end.</span></span></code> </pre><br><h5>  5.8 Clear the queue of messages unknown to your code. </h5><br>  Each server in order to avoid a queue overflow should handle all messages coming to it, for example: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main_loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">receive</span></span> {msg1, Msg1} -&gt; ..., main_loop(); {msg2, Msg2} -&gt; ..., main_loop(); Other -&gt; <span class="hljs-comment"><span class="hljs-comment">%   error_logger:error_msg( "Error: Process ~w got unknown msg ~w~n.",[self(), Other]), main_loop() end.</span></span></code> </pre><br><h5>  5.9 Use tail recursion when writing servers </h5><br>  All servers must be implemented using tail recursion in order to avoid memory overflow. <br>  Do not write like this: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">receive</span></span> {msg1, Msg1} -&gt; ..., loop(); stop -&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span>; Other -&gt; error_logger:log({error, {process_got_other, self(), Other}}), loop() <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>, io:format(<span class="hljs-string"><span class="hljs-string">"Server going down"</span></span>). <span class="hljs-comment"><span class="hljs-comment">%    %    !</span></span></code> </pre><br>  Better this way: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">receive</span></span> {msg1, Msg1} -&gt; ..., loop(); stop -&gt; io:format(<span class="hljs-string"><span class="hljs-string">"Server going down"</span></span>); Other -&gt; error_logger:log({error, {process_got_other, self(), Other}}), loop() <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>. <span class="hljs-comment"><span class="hljs-comment">%     </span></span></code> </pre><br><h5>  5.10 Create an interface to access your server </h5><br>  Use functions to access the server instead of sending direct messages whenever possible. <br>  The messaging protocol is internal information and should not be available to other modules. <br>  Example: <br><pre> <code class="erlang hljs"><span class="hljs-keyword"><span class="hljs-keyword">-module</span></span><span class="hljs-params"><span class="hljs-params">(fileserver)</span></span>. -export([start/<span class="hljs-number"><span class="hljs-number">0</span></span>, stop/<span class="hljs-number"><span class="hljs-number">0</span></span>, open_file/<span class="hljs-number"><span class="hljs-number">1</span></span>, ...]). open_file(FileName) -&gt; fileserver ! {open_file_request, FileName}, <span class="hljs-keyword"><span class="hljs-keyword">receive</span></span> {open_file_response, Result} -&gt; Result <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>. ...&lt;code&gt;...</code> </pre><br><h5>  5.11 Timeouts </h5><br>  Be extremely careful when using <i>after</i> when receiving messages.  Make sure that you have foreseen the situation when the message comes after a timeout.  (see clause 5.8). <br><br><h5>  5.12 Interception of the output signal </h5><br>  As few threads as possible should set the <i>trap_exit</i> flag.  But to use it or not, it still depends on the purpose of the module. <br><br><h4>  6 Recommendations for Erlang code </h4><br><h5>  6.1 Use <i>record</i> to store structures </h5><br>  The data type <i>record</i> is a tagged tuple in the internal representation of Erlang.  He first appeared in Erlang 4.3.  Record is very similar to <i>struct</i> in C or <i>record</i> in Pascal. <br>  If a <i>record</i> is planned to be used in several modules, then its definition should be placed in the header file. <br>  <i>Record is</i> best used to ensure compatibility of modules when transferring data between them. <br><br><h5>  6.2 Use selectors and constructors </h5><br>  Use selectors and constructors to control the <i>record</i> .  Never use a <i>record</i> as a cortege. <br>  Example: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">demo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> P = #person{name = <span class="hljs-string"><span class="hljs-string">"Joe"</span></span>, age = <span class="hljs-number"><span class="hljs-number">29</span></span>}, #person{name = Name1} = P,<span class="hljs-comment"><span class="hljs-comment">% matching ... Name2 = P#person.name. % </span></span></code> </pre><br>  You should not use a <i>record</i> like this: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">demo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> P = #person{name = <span class="hljs-string"><span class="hljs-string">"Joe"</span></span>, age = <span class="hljs-number"><span class="hljs-number">29</span></span>}, {person, Name, _Age, _Phone, _Misc} = P. <span class="hljs-comment"><span class="hljs-comment">%    </span></span></code> </pre><br><h5>  6.3 Return the tagged result of the function </h5><br>  Do not write like this: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">keysearch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Key, [{Key, Value}|_Tail])</span></span></span><span class="hljs-function"> -&gt;</span></span> Value; <span class="hljs-comment"><span class="hljs-comment">%%    ! keysearch(Key, [{_WrongKey, _WrongValue} | Tail]) -&gt; keysearch(Key, Tail); keysearch(Key, []) -&gt; false.</span></span></code> </pre><br>  With this solution, <i>{Key, Value}</i> cannot contain <i>false</i> as a value.  Here is the correct code: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">keysearch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Key, [{Key, Value}|_Tail])</span></span></span><span class="hljs-function"> -&gt;</span></span> {value, Value}; <span class="hljs-comment"><span class="hljs-comment">%%  . keysearch(Key, [{_WrongKey, _WrongValue} | Tail]) -&gt; keysearch(Key, Tail); keysearch(Key, []) -&gt; false.</span></span></code> </pre><br><h5>  6.4 Use with care catch and throw </h5><br>  Do not use <i>catch</i> and <i>throw</i> in case you are not sure what you are doing. <br>  <i>Catch</i> and <i>throw</i> can be useful when processing external input data, or data that require complex processing (for example, text processing by the compiler). <br><br><h5>  6.5 Use process vocabulary with utmost care </h5><br>  Do not use <i>get</i> and <i>put</i> in case you are not sure what you are doing. <br>  Functions that use <i>put</i> and <i>get</i> can be simply rewritten by adding another argument. <br>  Do not write like this: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tokenize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([H|T])</span></span></span><span class="hljs-function"> -&gt;</span></span> ...; tokenize([]) -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> get_characters_from_device(get(device)) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-comment"><span class="hljs-comment">%   get/1! eof -&gt; []; {value, Chars} -&gt; tokenize(Chars) end.</span></span></code> </pre><br>  Better to rewrite: <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tokenize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_Device, [H|T])</span></span></span><span class="hljs-function"> -&gt;</span></span> ...; tokenize(Device, []) -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> get_characters_from_device(Device) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-comment"><span class="hljs-comment">%   eof -&gt; []; {value, Chars} -&gt; tokenize(Device, Chars) end.</span></span></code> </pre><br>  Using <i>put</i> and <i>get</i> makes the function non deterministic.  In this case, debugging is significantly complicated, since  the result of the function depends not only on the input data but also on the process dictionary.  Moreover, Erlang in error (for example, <i>bad_match</i> ) displays in the description only the arguments of function calls, and not the state of the stream dictionary at that time. <br><br><h5>  6.6 Do not use <i>import</i> </h5><br>  The import code is harder to read.  It is better that all the definitions of the module functions were in one file. <br><br><h5>  6.7 Exporting Functions </h5><br>  It is necessary to distinguish between why the functions are exported: <br><ol><li>  To allow external access to them </li><li>  To provide an interface to the user </li><li>  For calls via spawn or apply from within the module itself. </li></ol><br>  <i>Group -export</i> and comment on the reason for export. <br><pre> <code class="erlang hljs"><span class="hljs-comment"><span class="hljs-comment">%%   -export([help/0, start/0, stop/0, info/1]). %%    -export([make_pid/1, make_pid/3]). -export([process_abbrevs/0, print_info/5]). %%    -export([init/1, info_log_impl/1]).</span></span></code> </pre><br><h4>  7. Recommendations for stylistic and lexical code design. </h4><br><h5>  7.1 Do not write heavily embedded code </h5><br>  A strongly nested code is a code in which many <i>case</i> / <i>if</i> / <i>receive</i> blocks are nested in other <i>case</i> / <i>if</i> / <i>receive</i> blocks.  It is considered a bad form to have more than two levels of nesting.  Such code is hard to read.  It is better to break such code into small functions. <br><br><h5>  7.2 Do not write too large modules </h5><br>  A module should not contain more than 400 lines of code.  It is better to break such modules into several small ones. <br><br><h5>  7.3 Do not write functions that are too long </h5><br>  The function should not be longer than 15-20 lines.  Do not try to solve the problem by writing just one line. <br><br><h5>  7.4 Do not write a lot of characters in one line </h5><br>  The number of characters in a line must be no more than 80 (to fit on A4). <br>  In Erlang, lines declared after the transfer are automatically glued together. <br>  For example: <br><pre> <code class="erlang hljs">io:format(<span class="hljs-string"><span class="hljs-string">"Name: ~s, Age: ~w, Phone: ~w ~n"</span></span> <span class="hljs-string"><span class="hljs-string">"Dictionary: ~w.~n"</span></span>, [Name, Age, Phone, Dict])</code> </pre><br><h5>  7.5 Variable naming </h5><br>  Choosing the right (meaningful) name for a variable is quite a difficult task. <br>  If the variable name consists of several words, it is better to separate them either via <i>'_'</i> or use <a href="http://ru.wikipedia.org/wiki/CamelCase">CamelCase</a> <br>  Do not use <i>'_'</i> to ignore a variable in a function; rather, write a variable name starting with <i>'_'</i> , for example <i>_Name</i> . <br><br><h5>  7.6 Naming Functions </h5><br>  The name of the function should clearly reflect its purpose.  The result of the execution should be predictable from the name.  Standard names should be used for standard functions (such as <i>start</i> , <i>stop</i> , <i>init</i> , <i>main_loop</i> ...). <br>  Functions from different modules, but with the same purpose should be called the same (for example, <i>Module: module_info ()</i> ). <br>  The wrong choice of the function name is the most common mistake. <br>  Some conventions for function names make this choice much easier.  For example, the prefix <i>'is_'</i> says that the result of the execution will be <i>true</i> or <i>false</i> . <br><pre> <code class="erlang hljs">is_...() -&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span> | <span class="hljs-literal"><span class="hljs-literal">false</span></span> check_...() -&gt; {ok, ...} | {error, ...}</code> </pre><br><h5>  7.7 Naming Modules </h5><br>  In Erlang, a flat model for naming modules, i.e.  There are no packages, for example, in Java (but, to be precise, they are, but their use in practice brings more problems than benefits). <br>  Usually, the same prefixes are used to indicate that the modules are somehow connected.  For example, ISDN is implemented like this: <br>  isdn_init <br>  isdn_partb <br>  isdn_ ... <br><br><h5>  7.8 Format the code uniformly. </h5><br>  Uniform style allows developers to more easily understand each other‚Äôs code. <br>  All people are used to writing code in different ways. <br>  For example, someone defines the elements of a tuple with a space <br><pre> <code class="erlang hljs">{<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">45</span></span>}</code> </pre><br>  someone without <br><pre> <code class="erlang hljs">{<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">23</span></span>,<span class="hljs-number"><span class="hljs-number">45</span></span>}</code> </pre><br>  Once you have developed a uniform style for yourself - stick to it. <br><br><h4>  8 Documenting the code </h4><br><h5>  8.1 Code Attributes </h5><br>  You must always correctly set the attributes of the module in the header.  Describe where the idea of ‚Äã‚Äãthis module came from, if the code appeared as a result of working on another module, describe it. <br>  Never steal code.  Theft is copying the code without specifying the source. <br>  Attribute examples: <br><blockquote>  -revision ('Revision: 1.14'). <br>  -created ('Date: 1995/01/01 11:21:11'). <br>  -created_by ('eklas @ erlang'). <br>  -modified ('Date: 1995/01/05 13:04:07'). <br>  -modified_by ('mbj @ erlang'). <br></blockquote><br><h5>  8.2 Leave reference to specification </h5><br>  If the code implements a standard, be sure to leave a link to the documentation (for example, RFC). <br><br><h5>  8.3 Document all errors </h5><br>  All errors should be clearly described in a separate document. <br>  In the code in places where logical is possible, call <i>error_logger</i> : <br><blockquote>  <font color="#0000FF"><strong>error_logger</strong></font> : error_msg ( <font color="#19177C">Format</font> , { <font color="#19177C">Descriptor</font> , <font color="#19177C">Arg1</font> , <font color="#19177C">Arg2</font> , ....}) <br></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And make sure that {Descriptor, Arg1, Arg2, ....} are described in the ‚ÄúError Description‚Äù document. </font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.4 Document all types of data that is transmitted in messages. </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use tagged tuples as messages forwarded by streams. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">record</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in messages ensures compatibility between different modules. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Document all these data types in the Message Description document.</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.5 Comment code </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comments should not be wordy, but should be sufficient to understand your code. Always keep them up to date. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comments regarding modules should be indented and begin with </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%%%</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comments regarding functions must be without indents and begin with </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%%</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comments to the code must be aligned as well as it, and begin with </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Such comments should be above the code or in line with it. On one line more preferably (if placed).</font></font><br><blockquote> <font color="#408080"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment about function %%</font></font><br></em></font> <font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> some_useful_functions</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font><font color="#19177C"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UsefulArgugument</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font><font color="#666666"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -&gt;</font></font></font> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> another_functions (</font></font><font color="#19177C"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UsefulArgugument</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ),</font></font><font color="#408080"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> % Comment at end of line </font></font><br></em></font> <font color="#408080"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Comment complicated_stmnt at about the same level of indentation</font></font><br></em></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> complicated_stmnt,</font></font><br>  ... <br></blockquote><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.6 Comment each function </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It is important to document: </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the purpose of this function </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valid input area </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> output area </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If the function implements an algorithm, describe it. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Possible failures of this function, presence of calls </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exit / 1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">throw / 1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , possible errors.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Side effects </font></font></li></ul><br>  Example: <br><blockquote> <font color="#408080"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% ------------------------------------------------ ---------------------- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% Function: get_server_statistics / 2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% Purpose: Get various information from a process. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% Args: Option is normal | all. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% Returns: A list of {Key, Value} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% or {error, Reason} (if the process is dead) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% --------------------- -------------------------------------------------</font></font><br></em></font> <font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> get_server_statistics</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font><font color="#19177C"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Option</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><font color="#19177C"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pid</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font><font color="#008000"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> when</font></font></strong></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pid (</font></font><font color="#19177C"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pid</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font><font color="#666666"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -&gt;</font></font></font> <br>  ... <br></blockquote><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.7 Data Structures </font></font></h5><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Record</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> must be defined along with the description.</font></font> For example: <br><blockquote> <font color="#408080"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% File: my_data_structures.h </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% ----------------------------------------- ---------------------------- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% Data Type: person </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% where: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% name: A string (default is undefined). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% age: An integer (default is undefined). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% phone: A list of integers (default is []). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% dict: A dictionary containing information information about the person. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% A {Key, Value} list (default is the empty list). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% ------------------------------------------------ ----------------------</font></font><br></em></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -</font></font><font color="#999999"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> record</font></font></strong></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font><font color="#A0A000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> person</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , {name, age, phone</font></font><font color="#666666"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [], dict</font></font><font color="#666666"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> []}).</font></font><br></blockquote><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.8 File Header, Copyright </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Each file must begin copyright information. </font></font> For example: <br><blockquote> <font color="#408080"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%%% ----------------------------------------------- ---------------------- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%%% Copyright Ericsson Telecom AB 1996 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%%% </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%%% All rights reserved. </font><font style="vertical-align: inherit;">This is a computer </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">program that allows you to reproduce, </font><font style="vertical-align: inherit;">computerized </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, electronic, mechanical, photocopying, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%%% recording, or </font><font style="vertical-align: inherit;">computer programs. </font><font style="vertical-align: inherit;">otherwise written permission of </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ericsson Telecom AB. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%%% ----------------------------------------------- ----------------------</font></font><br></em></font> <br></blockquote><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.9 File Header Version History </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Each file should have a version history, which shows who made what changes and for what purpose. </font></font><br><blockquote> <font color="#408080"><em>%%%--------------------------------------------------------------------- <br> %%% Revision History <br> %%%--------------------------------------------------------------------- <br> %%% Rev PA1 Date 960230 Author Fred Bloggs (ETXXXXX) <br> %%% Intitial pre release. Functions for adding and deleting foobars <br> %%% are incomplete <br> %%%--------------------------------------------------------------------- <br> %%% Rev A Date 960230 Author Johanna Johansson (ETXYYY) <br> %%% Added functions for adding and deleting foobars and changed <br> %%% data structures of foobars to allow for the needs of the Baz <br> %%% signalling system <br> %%%--------------------------------------------------------------------- <br></em></font> <br></blockquote><br><h5> 8.10  ,  </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each file should begin with a short description of the purpose of the module and a list of exported functions.</font></font><br><blockquote> <font color="#408080"><em>%%%--------------------------------------------------------------------- <br> %%% Description module foobar_data_manipulation <br> %%%--------------------------------------------------------------------- <br> %%% Foobars are the basic elements in the Baz signalling system. The <br> %%% functions below are for manipulating that data of foobars and for <br> %%% etc etc etc <br> %%%--------------------------------------------------------------------- <br> %%% Exports <br> %%%--------------------------------------------------------------------- <br> %%% create_foobar(Parent, Type) <br> %%% returns a new foobar object <br> %%% etc etc etc <br> %%%--------------------------------------------------------------------- <br></em></font> </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you know of any problems with using the code or something is not complete, describe them here. </font><font style="vertical-align: inherit;">This will help further support your code.</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.11 Do not comment on the old code - delete it </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Delete the old code and leave the description in the version control system. </font><font style="vertical-align: inherit;">CSV will help you.</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.12 Use version control systems. </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> All more or less complex projects should use version control (Git, SVN, etc.) </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9 Frequent errors </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Writing functions on a few pages of </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">writing functions with a set of nested </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a case</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the receive</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Writing untagged functions </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Function names do not match and the functional purpose of </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bad variable names, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the use of flow when it is not necessary </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wrong choice of data structures (bad idea) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poor comment or not comment </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code no indenting </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bad message queue control</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10 Documentation </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This section describes the documentation that is necessary for the project for support and administration. </font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10.1 Module Description </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One chapter per module. </font><font style="vertical-align: inherit;">It should contain a description of each module and a description of all the functions it exports:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> purpose </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> input description </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> output description </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">possible use problems and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exit / 1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calls </font><font style="vertical-align: inherit;">.</font></font></li></ul><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10.2 Message Description </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Description of messages used in the system, except those used only inside modules </font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10.3 Description of flows </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description of all registered streams and interfaces to them. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description of all dynamically created threads and interfaces to them.</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10.4 Description of errors </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Description of all possible system errors. </font></font></div><p>Source: <a href="https://habr.com/ru/post/142594/">https://habr.com/ru/post/142594/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142588/index.html">How to make a good promotional video for a startup. Part 2. Right off the bat</a></li>
<li><a href="../142589/index.html">Polynomial hashes and their applications</a></li>
<li><a href="../142590/index.html">7 reasons why AngularJS is cool</a></li>
<li><a href="../142592/index.html">Perlin Noise</a></li>
<li><a href="../142593/index.html">When you connect the IPTV service you</a></li>
<li><a href="../142595/index.html">So, you decided to prohibit copying class objects in C ++.</a></li>
<li><a href="../142596/index.html">Simulator for software testing</a></li>
<li><a href="../142597/index.html">We learn MS SQL Server Reporting Services 2008 R2 to show HTML in reports</a></li>
<li><a href="../142598/index.html">The story of another electric bicycle with their own hands</a></li>
<li><a href="../142599/index.html">The most common SQL injection pattern in PHP is the useless escape of characters.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>