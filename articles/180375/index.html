<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>OData controllers in .NET MVC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The recently released ASP.NET and Web Tools 2012.2 Update declared partial support for the oData protocol in the ASP.NET Web API. I decided to try it ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>OData controllers in .NET MVC</h1><div class="post__text post__text-html js-mediator-article">  The recently released ASP.NET and <a href="http://go.microsoft.com/fwlink/%3FLinkId%3D282650">Web Tools 2012.2 Update</a> declared partial support for the oData protocol in the ASP.NET Web API.  I decided to try it myself, and share it with my colleagues.  In the article I will describe how to use queries and CRUD operations using the oData protocol with several related data model objects.  The Kendo UI framework is used as the front-end client. <br><a name="habracut"></a><br><h5>  Preface. </h5><br>  The article was written in order to consolidate the material studied on the study of new technology.  Due to the complete lack of real experience in creating an application on the .NET MVC platform, I apologize in advance for any flaws.  So‚Ä¶ <br><br><h5>  Initial installation. </h5><br>  Download and install <a href="http://go.microsoft.com/fwlink/%3FLinkId%3D282650">ASP.NET and Web Tools 2012.2 Update</a> (if there is no desire, you can simply install the <a href="http://nuget.org/packages/Microsoft.AspNet.WebApi.OData">Microsoft ASP.NET Web API OData</a> package in the created project).  Create a new <b>ASP.NET MVC 4 Web Application</b> project and name it <b>‚ÄúODataSample‚Äù</b> .  In the <b>New ASP.NET MVC 4 Project</b> dialog <b>,</b> select the <b>Web API</b> template. <br>  Immediately put the <b>KendoUIWeb</b> package and make the necessary settings: you need to include the links to <i>kendo.common.min.css, kendo.default.min.css, kendo.web.min.js in the _Layout.cshtml file.</i> <br><br><h5>  Model. </h5><br>  Following the conventions, create a <b>Category</b> class in the <b>Models</b> folder and add the fields: <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Category</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] [StringLength(<span class="hljs-number"><span class="hljs-number">50</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre> <br>  In the same folder, create the <b>ODataSampleContext</b> context class file: <br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ODataSampleContext</span></span> : <span class="hljs-title"><span class="hljs-title">DbContext</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ODataSampleContext</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"name=ODataSampleContext"</span></span></span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet&lt;Category&gt; Categories { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br>  And we will definitely use the very useful functionality of the Entity Framework Migration - execute in the Package manager console: <br><ul><li>  Enable-Migrations </li><li>  Add-Migration Init </li><li>  Update-Database </li></ul><br>  As a result, we obtain a table in the database with the required fields.  You could certainly not use Migration, but it is very convenient.  I can‚Äôt even imagine how to work differently.  But I'm distracted.  Now we come to the most interesting. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  OData controller. </h5><br>  We have not yet created a template for the OData controller, so select the <b>‚ÄúEmpty API Controller‚Äù</b> template and change the code to the following: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CategoryController</span></span> : <span class="hljs-title"><span class="hljs-title">EntitySetController</span></span>&lt;<span class="hljs-title"><span class="hljs-title">Category</span></span>, <span class="hljs-title"><span class="hljs-title">int</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ODataSampleContext db = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataSampleContext(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> IQueryable&lt;Category&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> db.Categories; ; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> disposing</span></span></span><span class="hljs-function">)</span></span> { db.Dispose(); <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Dispose(disposing); } }</code> </pre><br>  In general, <b>EntitySetController is</b> inherited from <b>ODataController</b> , which in turn is from <b>ApiController</b> .  It turns out that all this is a superstructure over WebApi.  So in general, you can implement any protocol yourself, especially since there are all source codes for the ASP.NET CodePlex project.  <b>EntitySetController</b> accepts two basic types: entity type and entity key type. <br>  And the final touch: you need to make some changes to the <b>WebApiConfig</b> file: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WebApiConfig</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Register</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpConfiguration config</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ... config.EnableQuerySupport(); // ... ODataModelBuilder modelBuilder = new ODataConventionModelBuilder(); modelBuilder.EntitySet&lt;Category&gt;("Category"); Microsoft.Data.Edm.IEdmModel model = modelBuilder.GetEdmModel(); config.Routes.MapODataRoute("ODataRoute", "odata", model); } }</span></span></code> </pre><br>  The <b>EnableQuerySupport</b> method includes OData query options (query options) for methods that return the <b>IQueryable</b> type.  If there is no such need, then you can simply mark with the <b>[Queryable]</b> attribute those methods that you need.  By the way, the following parameters are currently implemented: <i>$ filter, $ inlinecount, $ orderby, $ skip, $ top</i> ;  not enough, but enough for basic purposes, for example, page-by-page partitioning on the server side (server-side paging).  The rest of the code creates an Entity Data Model (EDM) model.  The <b>EntitySet</b> method adds a set of entities to the EDM.  The <b>MapODataRoute</b> method sets the URI and sets the endpoint (endpoint).  This is all so that we can use the link: <a href="http://localhost:52864/odata/Category">http: // localhost: 52864 / odata / Category</a> .  JSON result: <br><pre> <code class="html hljs xml">{ "odata.metadata":"http://localhost:52864/odata/$metadata#Category","value":[ { "ID":1,"Name":"Categoty1" },{ "ID":2,"Name":"Category2" } ] }</code> </pre><br>  To get a specific entry via the link <a href="http://localhost:52864/odata/Category(1)">http: // localhost: 52864 / odata / Category (1)</a> , where the parameter is a key, you must override the <b>GetEntityByKey</b> method: <br><pre> <code class="cs hljs"> <span class="hljs-comment"><span class="hljs-comment">//... protected override Category GetEntityByKey(int key) { return db.Categories.FirstOrDefault(c =&gt; c.ID == key); } //...</span></span></code> </pre><br><br><h5>  Complicate the task. </h5><br>  Now create a <b>Product</b> model associated with <b>Category</b> . <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Product</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ProductID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span> Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CategoryID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> Category Category { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br>  Do not forget to add a string to the context <pre> <code class="hljs actionscript"><code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet Products { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO() { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int ProductID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> decimal Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int CategoryID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string CategoryName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Product ToEntity() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EntitySetController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt; </span></span>{ ODataSampleContext _context = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataSampleContext(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> IQueryable&lt;ProductDTO&gt; Get() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO GetEntityByKey(int key) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    <span class="hljs-string"><span class="hljs-string">""</span></span>. <br>   CRUD     .        : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO CreateEntity(ProductDTO entityDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ModelState.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { HttpResponseMessage response = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; response = Request.CreateResponse(HttpStatusCode.BadRequest, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataError { ErrorCode = <span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>, Message = String.Join(<span class="hljs-string"><span class="hljs-string">";"</span></span>, ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO UpdateEntity(int key, ProductDTO updateDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_context.Products.Any(p =&gt; p.ProductID == key)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> int GetKey(ProductDTO entity) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ActionResult Products() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"Product"</span></span>; Layout = <span class="hljs-string"><span class="hljs-string">"~/Views/Shared/_Layout.cshtml"</span></span>; } &lt;div id=<span class="hljs-string"><span class="hljs-string">"body"</span></span>&gt; &lt;section <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">featured</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrapper</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Product</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Grid</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">style</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">: 380</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">px</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaScript</span></span></span><span class="hljs-class">: </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Script</span></span></span><span class="hljs-class">  </span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="javascript"><span class="hljs-class"><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">document</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ready</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> () </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#Grid"</span></span>).kendoGrid({ columns: [ { field: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Product Name"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"CategoryName"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Category"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"150px"</span></span>, editor: categoryDropDownEditor, template: <span class="hljs-string"><span class="hljs-string">"#=CategoryName#"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"edit"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Edit"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Delete"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, ], pageable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, sortable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, filterable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, editable: <span class="hljs-string"><span class="hljs-string">"popup"</span></span>, toolbar: [<span class="hljs-string"><span class="hljs-string">"create"</span></span>], dataSource: { serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverSorting: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, schema: { data: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.value !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.value; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> response[<span class="hljs-string"><span class="hljs-string">"odata.metadata"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response; } }, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ProductID"</span></span>, fields: { ProductID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, Price: { nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, CategoryID: { type: <span class="hljs-string"><span class="hljs-string">"number"</span></span>,validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, CategoryName: { validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, } }, }, batch: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, error: error, transport: { create: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, }, read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, }, update: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> } }, destroy: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span> }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ console.log(data); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } } } }); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">categoryDropDownEditor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container, options)</span></span></span><span class="hljs-function"> </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'&lt;input data-bind="value:CategoryID"/&gt;'</span></span>) .appendTo(container) .kendoDropDownList({ dataTextField: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, dataValueField: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, optionLabel: <span class="hljs-string"><span class="hljs-string">"--Select Value--"</span></span>, dataSource: { schema: { data: <span class="hljs-string"><span class="hljs-string">"value"</span></span>, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, fields: { ID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, } }, }, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">20</span></span>, transport: { read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Categories"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span> } }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%<span class="hljs-number"><span class="hljs-number">24</span></span>inlinecount=allpages&amp;%<span class="hljs-number"><span class="hljs-number">24</span></span>top=<span class="hljs-number"><span class="hljs-number">5</span></span></b>   <span class="hljs-number"><span class="hljs-number">5</span></span> .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> }</code>   <b>update</b> ,        ,    .     ,         .   <span class="hljs-string"><span class="hljs-string">" </span></span><b><span class="hljs-string"><span class="hljs-string">CategoryName</span></span></b><span class="hljs-string"><span class="hljs-string"> "</span></span>   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.errorThrown === <span class="hljs-string"><span class="hljs-string">"Bad Request"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = JSON.parse(e.xhr.responseText); console.log(response); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>] != <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { alert(response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>].message.value) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert(e.status + <span class="hljs-string"><span class="hljs-string">": "</span></span> + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ <span class="hljs-string"><span class="hljs-string">"odata.error"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"code"</span></span>:<span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>,<span class="hljs-string"><span class="hljs-string">"message"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"lang"</span></span>:<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>,<span class="hljs-string"><span class="hljs-string">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">"  Name."</span></span> } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </pre> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <h5> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </h5> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <pre> <code class="hljs actionscript"><code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet Products { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO() { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int ProductID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> decimal Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int CategoryID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string CategoryName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Product ToEntity() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EntitySetController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt; </span></span>{ ODataSampleContext _context = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataSampleContext(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> IQueryable&lt;ProductDTO&gt; Get() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO GetEntityByKey(int key) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    <span class="hljs-string"><span class="hljs-string">""</span></span>. <br>   CRUD     .        : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO CreateEntity(ProductDTO entityDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ModelState.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { HttpResponseMessage response = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; response = Request.CreateResponse(HttpStatusCode.BadRequest, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataError { ErrorCode = <span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>, Message = String.Join(<span class="hljs-string"><span class="hljs-string">";"</span></span>, ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO UpdateEntity(int key, ProductDTO updateDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_context.Products.Any(p =&gt; p.ProductID == key)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> int GetKey(ProductDTO entity) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ActionResult Products() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"Product"</span></span>; Layout = <span class="hljs-string"><span class="hljs-string">"~/Views/Shared/_Layout.cshtml"</span></span>; } &lt;div id=<span class="hljs-string"><span class="hljs-string">"body"</span></span>&gt; &lt;section <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">featured</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrapper</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Product</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Grid</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">style</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">: 380</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">px</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaScript</span></span></span><span class="hljs-class">: </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Script</span></span></span><span class="hljs-class">  </span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="javascript"><span class="hljs-class"><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">document</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ready</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> () </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#Grid"</span></span>).kendoGrid({ columns: [ { field: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Product Name"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"CategoryName"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Category"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"150px"</span></span>, editor: categoryDropDownEditor, template: <span class="hljs-string"><span class="hljs-string">"#=CategoryName#"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"edit"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Edit"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Delete"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, ], pageable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, sortable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, filterable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, editable: <span class="hljs-string"><span class="hljs-string">"popup"</span></span>, toolbar: [<span class="hljs-string"><span class="hljs-string">"create"</span></span>], dataSource: { serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverSorting: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, schema: { data: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.value !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.value; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> response[<span class="hljs-string"><span class="hljs-string">"odata.metadata"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response; } }, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ProductID"</span></span>, fields: { ProductID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, Price: { nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, CategoryID: { type: <span class="hljs-string"><span class="hljs-string">"number"</span></span>,validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, CategoryName: { validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, } }, }, batch: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, error: error, transport: { create: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, }, read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, }, update: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> } }, destroy: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span> }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ console.log(data); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } } } }); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">categoryDropDownEditor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container, options)</span></span></span><span class="hljs-function"> </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'&lt;input data-bind="value:CategoryID"/&gt;'</span></span>) .appendTo(container) .kendoDropDownList({ dataTextField: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, dataValueField: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, optionLabel: <span class="hljs-string"><span class="hljs-string">"--Select Value--"</span></span>, dataSource: { schema: { data: <span class="hljs-string"><span class="hljs-string">"value"</span></span>, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, fields: { ID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, } }, }, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">20</span></span>, transport: { read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Categories"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span> } }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%<span class="hljs-number"><span class="hljs-number">24</span></span>inlinecount=allpages&amp;%<span class="hljs-number"><span class="hljs-number">24</span></span>top=<span class="hljs-number"><span class="hljs-number">5</span></span></b>   <span class="hljs-number"><span class="hljs-number">5</span></span> .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> }</code>   <b>update</b> ,        ,    .     ,         .   <span class="hljs-string"><span class="hljs-string">" </span></span><b><span class="hljs-string"><span class="hljs-string">CategoryName</span></span></b><span class="hljs-string"><span class="hljs-string"> "</span></span>   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.errorThrown === <span class="hljs-string"><span class="hljs-string">"Bad Request"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = JSON.parse(e.xhr.responseText); console.log(response); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>] != <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { alert(response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>].message.value) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert(e.status + <span class="hljs-string"><span class="hljs-string">": "</span></span> + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ <span class="hljs-string"><span class="hljs-string">"odata.error"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"code"</span></span>:<span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>,<span class="hljs-string"><span class="hljs-string">"message"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"lang"</span></span>:<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>,<span class="hljs-string"><span class="hljs-string">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">"  Name."</span></span> } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </pre> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <pre> <code class="hljs actionscript"><code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet Products { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO() { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int ProductID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> decimal Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int CategoryID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string CategoryName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Product ToEntity() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EntitySetController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt; </span></span>{ ODataSampleContext _context = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataSampleContext(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> IQueryable&lt;ProductDTO&gt; Get() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO GetEntityByKey(int key) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    <span class="hljs-string"><span class="hljs-string">""</span></span>. <br>   CRUD     .        : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO CreateEntity(ProductDTO entityDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ModelState.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { HttpResponseMessage response = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; response = Request.CreateResponse(HttpStatusCode.BadRequest, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataError { ErrorCode = <span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>, Message = String.Join(<span class="hljs-string"><span class="hljs-string">";"</span></span>, ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO UpdateEntity(int key, ProductDTO updateDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_context.Products.Any(p =&gt; p.ProductID == key)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> int GetKey(ProductDTO entity) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ActionResult Products() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"Product"</span></span>; Layout = <span class="hljs-string"><span class="hljs-string">"~/Views/Shared/_Layout.cshtml"</span></span>; } &lt;div id=<span class="hljs-string"><span class="hljs-string">"body"</span></span>&gt; &lt;section <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">featured</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrapper</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Product</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Grid</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">style</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">: 380</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">px</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaScript</span></span></span><span class="hljs-class">: </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Script</span></span></span><span class="hljs-class">  </span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="javascript"><span class="hljs-class"><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">document</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ready</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> () </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#Grid"</span></span>).kendoGrid({ columns: [ { field: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Product Name"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"CategoryName"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Category"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"150px"</span></span>, editor: categoryDropDownEditor, template: <span class="hljs-string"><span class="hljs-string">"#=CategoryName#"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"edit"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Edit"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Delete"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, ], pageable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, sortable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, filterable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, editable: <span class="hljs-string"><span class="hljs-string">"popup"</span></span>, toolbar: [<span class="hljs-string"><span class="hljs-string">"create"</span></span>], dataSource: { serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverSorting: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, schema: { data: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.value !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.value; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> response[<span class="hljs-string"><span class="hljs-string">"odata.metadata"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response; } }, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ProductID"</span></span>, fields: { ProductID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, Price: { nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, CategoryID: { type: <span class="hljs-string"><span class="hljs-string">"number"</span></span>,validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, CategoryName: { validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, } }, }, batch: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, error: error, transport: { create: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, }, read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, }, update: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> } }, destroy: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span> }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ console.log(data); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } } } }); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">categoryDropDownEditor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container, options)</span></span></span><span class="hljs-function"> </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'&lt;input data-bind="value:CategoryID"/&gt;'</span></span>) .appendTo(container) .kendoDropDownList({ dataTextField: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, dataValueField: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, optionLabel: <span class="hljs-string"><span class="hljs-string">"--Select Value--"</span></span>, dataSource: { schema: { data: <span class="hljs-string"><span class="hljs-string">"value"</span></span>, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, fields: { ID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, } }, }, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">20</span></span>, transport: { read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Categories"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span> } }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%<span class="hljs-number"><span class="hljs-number">24</span></span>inlinecount=allpages&amp;%<span class="hljs-number"><span class="hljs-number">24</span></span>top=<span class="hljs-number"><span class="hljs-number">5</span></span></b>   <span class="hljs-number"><span class="hljs-number">5</span></span> .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> }</code>   <b>update</b> ,        ,    .     ,         .   <span class="hljs-string"><span class="hljs-string">" </span></span><b><span class="hljs-string"><span class="hljs-string">CategoryName</span></span></b><span class="hljs-string"><span class="hljs-string"> "</span></span>   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.errorThrown === <span class="hljs-string"><span class="hljs-string">"Bad Request"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = JSON.parse(e.xhr.responseText); console.log(response); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>] != <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { alert(response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>].message.value) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert(e.status + <span class="hljs-string"><span class="hljs-string">": "</span></span> + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ <span class="hljs-string"><span class="hljs-string">"odata.error"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"code"</span></span>:<span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>,<span class="hljs-string"><span class="hljs-string">"message"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"lang"</span></span>:<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>,<span class="hljs-string"><span class="hljs-string">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">"  Name."</span></span> } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </pre> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <pre> <code class="hljs actionscript"><code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet Products { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO() { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int ProductID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> decimal Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int CategoryID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string CategoryName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Product ToEntity() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EntitySetController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt; </span></span>{ ODataSampleContext _context = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataSampleContext(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> IQueryable&lt;ProductDTO&gt; Get() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO GetEntityByKey(int key) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    <span class="hljs-string"><span class="hljs-string">""</span></span>. <br>   CRUD     .        : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO CreateEntity(ProductDTO entityDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ModelState.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { HttpResponseMessage response = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; response = Request.CreateResponse(HttpStatusCode.BadRequest, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataError { ErrorCode = <span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>, Message = String.Join(<span class="hljs-string"><span class="hljs-string">";"</span></span>, ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO UpdateEntity(int key, ProductDTO updateDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_context.Products.Any(p =&gt; p.ProductID == key)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> int GetKey(ProductDTO entity) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ActionResult Products() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"Product"</span></span>; Layout = <span class="hljs-string"><span class="hljs-string">"~/Views/Shared/_Layout.cshtml"</span></span>; } &lt;div id=<span class="hljs-string"><span class="hljs-string">"body"</span></span>&gt; &lt;section <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">featured</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrapper</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Product</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Grid</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">style</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">: 380</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">px</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaScript</span></span></span><span class="hljs-class">: </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Script</span></span></span><span class="hljs-class">  </span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="javascript"><span class="hljs-class"><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">document</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ready</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> () </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#Grid"</span></span>).kendoGrid({ columns: [ { field: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Product Name"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"CategoryName"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Category"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"150px"</span></span>, editor: categoryDropDownEditor, template: <span class="hljs-string"><span class="hljs-string">"#=CategoryName#"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"edit"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Edit"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Delete"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, ], pageable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, sortable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, filterable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, editable: <span class="hljs-string"><span class="hljs-string">"popup"</span></span>, toolbar: [<span class="hljs-string"><span class="hljs-string">"create"</span></span>], dataSource: { serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverSorting: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, schema: { data: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.value !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.value; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> response[<span class="hljs-string"><span class="hljs-string">"odata.metadata"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response; } }, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ProductID"</span></span>, fields: { ProductID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, Price: { nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, CategoryID: { type: <span class="hljs-string"><span class="hljs-string">"number"</span></span>,validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, CategoryName: { validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, } }, }, batch: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, error: error, transport: { create: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, }, read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, }, update: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> } }, destroy: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span> }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ console.log(data); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } } } }); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">categoryDropDownEditor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container, options)</span></span></span><span class="hljs-function"> </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'&lt;input data-bind="value:CategoryID"/&gt;'</span></span>) .appendTo(container) .kendoDropDownList({ dataTextField: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, dataValueField: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, optionLabel: <span class="hljs-string"><span class="hljs-string">"--Select Value--"</span></span>, dataSource: { schema: { data: <span class="hljs-string"><span class="hljs-string">"value"</span></span>, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, fields: { ID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, } }, }, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">20</span></span>, transport: { read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Categories"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span> } }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%<span class="hljs-number"><span class="hljs-number">24</span></span>inlinecount=allpages&amp;%<span class="hljs-number"><span class="hljs-number">24</span></span>top=<span class="hljs-number"><span class="hljs-number">5</span></span></b>   <span class="hljs-number"><span class="hljs-number">5</span></span> .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> }</code>   <b>update</b> ,        ,    .     ,         .   <span class="hljs-string"><span class="hljs-string">" </span></span><b><span class="hljs-string"><span class="hljs-string">CategoryName</span></span></b><span class="hljs-string"><span class="hljs-string"> "</span></span>   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.errorThrown === <span class="hljs-string"><span class="hljs-string">"Bad Request"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = JSON.parse(e.xhr.responseText); console.log(response); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>] != <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { alert(response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>].message.value) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert(e.status + <span class="hljs-string"><span class="hljs-string">": "</span></span> + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ <span class="hljs-string"><span class="hljs-string">"odata.error"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"code"</span></span>:<span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>,<span class="hljs-string"><span class="hljs-string">"message"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"lang"</span></span>:<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>,<span class="hljs-string"><span class="hljs-string">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">"  Name."</span></span> } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </pre> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <h5> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </h5> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <pre> <code class="hljs actionscript"><code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet Products { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO() { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int ProductID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> decimal Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int CategoryID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string CategoryName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Product ToEntity() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EntitySetController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt; </span></span>{ ODataSampleContext _context = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataSampleContext(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> IQueryable&lt;ProductDTO&gt; Get() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO GetEntityByKey(int key) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    <span class="hljs-string"><span class="hljs-string">""</span></span>. <br>   CRUD     .        : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO CreateEntity(ProductDTO entityDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ModelState.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { HttpResponseMessage response = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; response = Request.CreateResponse(HttpStatusCode.BadRequest, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataError { ErrorCode = <span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>, Message = String.Join(<span class="hljs-string"><span class="hljs-string">";"</span></span>, ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO UpdateEntity(int key, ProductDTO updateDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_context.Products.Any(p =&gt; p.ProductID == key)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> int GetKey(ProductDTO entity) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ActionResult Products() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"Product"</span></span>; Layout = <span class="hljs-string"><span class="hljs-string">"~/Views/Shared/_Layout.cshtml"</span></span>; } &lt;div id=<span class="hljs-string"><span class="hljs-string">"body"</span></span>&gt; &lt;section <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">featured</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrapper</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Product</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Grid</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">style</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">: 380</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">px</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaScript</span></span></span><span class="hljs-class">: </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Script</span></span></span><span class="hljs-class">  </span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="javascript"><span class="hljs-class"><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">document</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ready</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> () </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#Grid"</span></span>).kendoGrid({ columns: [ { field: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Product Name"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"CategoryName"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Category"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"150px"</span></span>, editor: categoryDropDownEditor, template: <span class="hljs-string"><span class="hljs-string">"#=CategoryName#"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"edit"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Edit"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Delete"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, ], pageable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, sortable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, filterable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, editable: <span class="hljs-string"><span class="hljs-string">"popup"</span></span>, toolbar: [<span class="hljs-string"><span class="hljs-string">"create"</span></span>], dataSource: { serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverSorting: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, schema: { data: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.value !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.value; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> response[<span class="hljs-string"><span class="hljs-string">"odata.metadata"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response; } }, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ProductID"</span></span>, fields: { ProductID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, Price: { nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, CategoryID: { type: <span class="hljs-string"><span class="hljs-string">"number"</span></span>,validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, CategoryName: { validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, } }, }, batch: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, error: error, transport: { create: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, }, read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, }, update: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> } }, destroy: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span> }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ console.log(data); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } } } }); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">categoryDropDownEditor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container, options)</span></span></span><span class="hljs-function"> </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'&lt;input data-bind="value:CategoryID"/&gt;'</span></span>) .appendTo(container) .kendoDropDownList({ dataTextField: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, dataValueField: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, optionLabel: <span class="hljs-string"><span class="hljs-string">"--Select Value--"</span></span>, dataSource: { schema: { data: <span class="hljs-string"><span class="hljs-string">"value"</span></span>, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, fields: { ID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, } }, }, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">20</span></span>, transport: { read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Categories"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span> } }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%<span class="hljs-number"><span class="hljs-number">24</span></span>inlinecount=allpages&amp;%<span class="hljs-number"><span class="hljs-number">24</span></span>top=<span class="hljs-number"><span class="hljs-number">5</span></span></b>   <span class="hljs-number"><span class="hljs-number">5</span></span> .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> }</code>   <b>update</b> ,        ,    .     ,         .   <span class="hljs-string"><span class="hljs-string">" </span></span><b><span class="hljs-string"><span class="hljs-string">CategoryName</span></span></b><span class="hljs-string"><span class="hljs-string"> "</span></span>   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.errorThrown === <span class="hljs-string"><span class="hljs-string">"Bad Request"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = JSON.parse(e.xhr.responseText); console.log(response); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>] != <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { alert(response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>].message.value) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert(e.status + <span class="hljs-string"><span class="hljs-string">": "</span></span> + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ <span class="hljs-string"><span class="hljs-string">"odata.error"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"code"</span></span>:<span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>,<span class="hljs-string"><span class="hljs-string">"message"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"lang"</span></span>:<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>,<span class="hljs-string"><span class="hljs-string">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">"  Name."</span></span> } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </pre> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <pre> <code class="hljs actionscript"><code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet Products { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO() { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int ProductID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> decimal Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int CategoryID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string CategoryName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Product ToEntity() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EntitySetController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt; </span></span>{ ODataSampleContext _context = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataSampleContext(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> IQueryable&lt;ProductDTO&gt; Get() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO GetEntityByKey(int key) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    <span class="hljs-string"><span class="hljs-string">""</span></span>. <br>   CRUD     .        : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO CreateEntity(ProductDTO entityDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ModelState.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { HttpResponseMessage response = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; response = Request.CreateResponse(HttpStatusCode.BadRequest, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataError { ErrorCode = <span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>, Message = String.Join(<span class="hljs-string"><span class="hljs-string">";"</span></span>, ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO UpdateEntity(int key, ProductDTO updateDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_context.Products.Any(p =&gt; p.ProductID == key)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> int GetKey(ProductDTO entity) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ActionResult Products() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"Product"</span></span>; Layout = <span class="hljs-string"><span class="hljs-string">"~/Views/Shared/_Layout.cshtml"</span></span>; } &lt;div id=<span class="hljs-string"><span class="hljs-string">"body"</span></span>&gt; &lt;section <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">featured</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrapper</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Product</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Grid</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">style</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">: 380</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">px</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaScript</span></span></span><span class="hljs-class">: </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Script</span></span></span><span class="hljs-class">  </span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="javascript"><span class="hljs-class"><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">document</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ready</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> () </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#Grid"</span></span>).kendoGrid({ columns: [ { field: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Product Name"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"CategoryName"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Category"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"150px"</span></span>, editor: categoryDropDownEditor, template: <span class="hljs-string"><span class="hljs-string">"#=CategoryName#"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"edit"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Edit"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Delete"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, ], pageable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, sortable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, filterable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, editable: <span class="hljs-string"><span class="hljs-string">"popup"</span></span>, toolbar: [<span class="hljs-string"><span class="hljs-string">"create"</span></span>], dataSource: { serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverSorting: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, schema: { data: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.value !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.value; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> response[<span class="hljs-string"><span class="hljs-string">"odata.metadata"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response; } }, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ProductID"</span></span>, fields: { ProductID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, Price: { nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, CategoryID: { type: <span class="hljs-string"><span class="hljs-string">"number"</span></span>,validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, CategoryName: { validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, } }, }, batch: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, error: error, transport: { create: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, }, read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, }, update: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> } }, destroy: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span> }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ console.log(data); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } } } }); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">categoryDropDownEditor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container, options)</span></span></span><span class="hljs-function"> </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'&lt;input data-bind="value:CategoryID"/&gt;'</span></span>) .appendTo(container) .kendoDropDownList({ dataTextField: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, dataValueField: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, optionLabel: <span class="hljs-string"><span class="hljs-string">"--Select Value--"</span></span>, dataSource: { schema: { data: <span class="hljs-string"><span class="hljs-string">"value"</span></span>, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, fields: { ID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, } }, }, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">20</span></span>, transport: { read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Categories"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span> } }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%<span class="hljs-number"><span class="hljs-number">24</span></span>inlinecount=allpages&amp;%<span class="hljs-number"><span class="hljs-number">24</span></span>top=<span class="hljs-number"><span class="hljs-number">5</span></span></b>   <span class="hljs-number"><span class="hljs-number">5</span></span> .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> }</code>   <b>update</b> ,        ,    .     ,         .   <span class="hljs-string"><span class="hljs-string">" </span></span><b><span class="hljs-string"><span class="hljs-string">CategoryName</span></span></b><span class="hljs-string"><span class="hljs-string"> "</span></span>   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.errorThrown === <span class="hljs-string"><span class="hljs-string">"Bad Request"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = JSON.parse(e.xhr.responseText); console.log(response); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>] != <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { alert(response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>].message.value) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert(e.status + <span class="hljs-string"><span class="hljs-string">": "</span></span> + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ <span class="hljs-string"><span class="hljs-string">"odata.error"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"code"</span></span>:<span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>,<span class="hljs-string"><span class="hljs-string">"message"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"lang"</span></span>:<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>,<span class="hljs-string"><span class="hljs-string">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">"  Name."</span></span> } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </pre> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <div class="spoiler"> <code><b class="spoiler_title"><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> Script   <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</b></code> <div class="spoiler_text"> <pre> <code class="hljs actionscript"><code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet Products { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO() { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int ProductID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> decimal Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int CategoryID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string CategoryName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Product ToEntity() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EntitySetController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt; </span></span>{ ODataSampleContext _context = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataSampleContext(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> IQueryable&lt;ProductDTO&gt; Get() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO GetEntityByKey(int key) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    <span class="hljs-string"><span class="hljs-string">""</span></span>. <br>   CRUD     .        : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO CreateEntity(ProductDTO entityDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ModelState.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { HttpResponseMessage response = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; response = Request.CreateResponse(HttpStatusCode.BadRequest, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataError { ErrorCode = <span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>, Message = String.Join(<span class="hljs-string"><span class="hljs-string">";"</span></span>, ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO UpdateEntity(int key, ProductDTO updateDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_context.Products.Any(p =&gt; p.ProductID == key)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> int GetKey(ProductDTO entity) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ActionResult Products() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"Product"</span></span>; Layout = <span class="hljs-string"><span class="hljs-string">"~/Views/Shared/_Layout.cshtml"</span></span>; } &lt;div id=<span class="hljs-string"><span class="hljs-string">"body"</span></span>&gt; &lt;section <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">featured</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrapper</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Product</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Grid</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">style</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">: 380</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">px</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaScript</span></span></span><span class="hljs-class">: </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Script</span></span></span><span class="hljs-class">  </span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="javascript"><span class="hljs-class"><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">document</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ready</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> () </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#Grid"</span></span>).kendoGrid({ columns: [ { field: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Product Name"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"CategoryName"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Category"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"150px"</span></span>, editor: categoryDropDownEditor, template: <span class="hljs-string"><span class="hljs-string">"#=CategoryName#"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"edit"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Edit"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Delete"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, ], pageable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, sortable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, filterable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, editable: <span class="hljs-string"><span class="hljs-string">"popup"</span></span>, toolbar: [<span class="hljs-string"><span class="hljs-string">"create"</span></span>], dataSource: { serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverSorting: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, schema: { data: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.value !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.value; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> response[<span class="hljs-string"><span class="hljs-string">"odata.metadata"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response; } }, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ProductID"</span></span>, fields: { ProductID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, Price: { nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, CategoryID: { type: <span class="hljs-string"><span class="hljs-string">"number"</span></span>,validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, CategoryName: { validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, } }, }, batch: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, error: error, transport: { create: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, }, read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, }, update: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> } }, destroy: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span> }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ console.log(data); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } } } }); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">categoryDropDownEditor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container, options)</span></span></span><span class="hljs-function"> </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'&lt;input data-bind="value:CategoryID"/&gt;'</span></span>) .appendTo(container) .kendoDropDownList({ dataTextField: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, dataValueField: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, optionLabel: <span class="hljs-string"><span class="hljs-string">"--Select Value--"</span></span>, dataSource: { schema: { data: <span class="hljs-string"><span class="hljs-string">"value"</span></span>, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, fields: { ID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, } }, }, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">20</span></span>, transport: { read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Categories"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span> } }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%<span class="hljs-number"><span class="hljs-number">24</span></span>inlinecount=allpages&amp;%<span class="hljs-number"><span class="hljs-number">24</span></span>top=<span class="hljs-number"><span class="hljs-number">5</span></span></b>   <span class="hljs-number"><span class="hljs-number">5</span></span> .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> }</code>   <b>update</b> ,        ,    .     ,         .   <span class="hljs-string"><span class="hljs-string">" </span></span><b><span class="hljs-string"><span class="hljs-string">CategoryName</span></span></b><span class="hljs-string"><span class="hljs-string"> "</span></span>   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.errorThrown === <span class="hljs-string"><span class="hljs-string">"Bad Request"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = JSON.parse(e.xhr.responseText); console.log(response); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>] != <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { alert(response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>].message.value) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert(e.status + <span class="hljs-string"><span class="hljs-string">": "</span></span> + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ <span class="hljs-string"><span class="hljs-string">"odata.error"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"code"</span></span>:<span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>,<span class="hljs-string"><span class="hljs-string">"message"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"lang"</span></span>:<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>,<span class="hljs-string"><span class="hljs-string">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">"  Name."</span></span> } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </pre> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </div></div> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <div class="spoiler"> <code><b class="spoiler_title"><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> script   <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</b></code> <div class="spoiler_text"> <pre> <code class="hljs actionscript"><code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet Products { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO() { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int ProductID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> decimal Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int CategoryID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string CategoryName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Product ToEntity() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EntitySetController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt; </span></span>{ ODataSampleContext _context = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataSampleContext(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> IQueryable&lt;ProductDTO&gt; Get() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO GetEntityByKey(int key) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    <span class="hljs-string"><span class="hljs-string">""</span></span>. <br>   CRUD     .        : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO CreateEntity(ProductDTO entityDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ModelState.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { HttpResponseMessage response = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; response = Request.CreateResponse(HttpStatusCode.BadRequest, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataError { ErrorCode = <span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>, Message = String.Join(<span class="hljs-string"><span class="hljs-string">";"</span></span>, ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO UpdateEntity(int key, ProductDTO updateDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_context.Products.Any(p =&gt; p.ProductID == key)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> int GetKey(ProductDTO entity) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ActionResult Products() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"Product"</span></span>; Layout = <span class="hljs-string"><span class="hljs-string">"~/Views/Shared/_Layout.cshtml"</span></span>; } &lt;div id=<span class="hljs-string"><span class="hljs-string">"body"</span></span>&gt; &lt;section <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">featured</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrapper</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Product</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Grid</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">style</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">: 380</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">px</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaScript</span></span></span><span class="hljs-class">: </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Script</span></span></span><span class="hljs-class">  </span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="javascript"><span class="hljs-class"><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">document</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ready</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> () </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#Grid"</span></span>).kendoGrid({ columns: [ { field: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Product Name"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"CategoryName"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Category"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"150px"</span></span>, editor: categoryDropDownEditor, template: <span class="hljs-string"><span class="hljs-string">"#=CategoryName#"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"edit"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Edit"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Delete"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, ], pageable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, sortable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, filterable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, editable: <span class="hljs-string"><span class="hljs-string">"popup"</span></span>, toolbar: [<span class="hljs-string"><span class="hljs-string">"create"</span></span>], dataSource: { serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverSorting: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, schema: { data: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.value !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.value; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> response[<span class="hljs-string"><span class="hljs-string">"odata.metadata"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response; } }, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ProductID"</span></span>, fields: { ProductID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, Price: { nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, CategoryID: { type: <span class="hljs-string"><span class="hljs-string">"number"</span></span>,validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, CategoryName: { validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, } }, }, batch: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, error: error, transport: { create: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, }, read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, }, update: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> } }, destroy: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span> }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ console.log(data); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } } } }); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">categoryDropDownEditor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container, options)</span></span></span><span class="hljs-function"> </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'&lt;input data-bind="value:CategoryID"/&gt;'</span></span>) .appendTo(container) .kendoDropDownList({ dataTextField: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, dataValueField: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, optionLabel: <span class="hljs-string"><span class="hljs-string">"--Select Value--"</span></span>, dataSource: { schema: { data: <span class="hljs-string"><span class="hljs-string">"value"</span></span>, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, fields: { ID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, } }, }, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">20</span></span>, transport: { read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Categories"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span> } }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%<span class="hljs-number"><span class="hljs-number">24</span></span>inlinecount=allpages&amp;%<span class="hljs-number"><span class="hljs-number">24</span></span>top=<span class="hljs-number"><span class="hljs-number">5</span></span></b>   <span class="hljs-number"><span class="hljs-number">5</span></span> .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> }</code>   <b>update</b> ,        ,    .     ,         .   <span class="hljs-string"><span class="hljs-string">" </span></span><b><span class="hljs-string"><span class="hljs-string">CategoryName</span></span></b><span class="hljs-string"><span class="hljs-string"> "</span></span>   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.errorThrown === <span class="hljs-string"><span class="hljs-string">"Bad Request"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = JSON.parse(e.xhr.responseText); console.log(response); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>] != <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { alert(response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>].message.value) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert(e.status + <span class="hljs-string"><span class="hljs-string">": "</span></span> + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ <span class="hljs-string"><span class="hljs-string">"odata.error"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"code"</span></span>:<span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>,<span class="hljs-string"><span class="hljs-string">"message"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"lang"</span></span>:<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>,<span class="hljs-string"><span class="hljs-string">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">"  Name."</span></span> } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </pre> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </div></div> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <pre> <code class="hljs actionscript"><code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet Products { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO() { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int ProductID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> decimal Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int CategoryID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string CategoryName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Product ToEntity() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EntitySetController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductDTO</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt; </span></span>{ ODataSampleContext _context = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataSampleContext(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> IQueryable&lt;ProductDTO&gt; Get() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO GetEntityByKey(int key) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    <span class="hljs-string"><span class="hljs-string">""</span></span>. <br>   CRUD     .        : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO CreateEntity(ProductDTO entityDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ModelState.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { HttpResponseMessage response = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; response = Request.CreateResponse(HttpStatusCode.BadRequest, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ODataError { ErrorCode = <span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>, Message = String.Join(<span class="hljs-string"><span class="hljs-string">";"</span></span>, ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO UpdateEntity(int key, ProductDTO updateDto) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_context.Products.Any(p =&gt; p.ProductID == key)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductDTO(product); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (product == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> int GetKey(ProductDTO entity) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ActionResult Products() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"Product"</span></span>; Layout = <span class="hljs-string"><span class="hljs-string">"~/Views/Shared/_Layout.cshtml"</span></span>; } &lt;div id=<span class="hljs-string"><span class="hljs-string">"body"</span></span>&gt; &lt;section <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">featured</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrapper</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Product</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hgroup</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Grid</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">style</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">: 380</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">px</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaScript</span></span></span><span class="hljs-class">: </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Script</span></span></span><span class="hljs-class">  </span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="javascript"><span class="hljs-class"><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">document</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ready</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> () </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#Grid"</span></span>).kendoGrid({ columns: [ { field: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Product Name"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"CategoryName"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Category"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"150px"</span></span>, editor: categoryDropDownEditor, template: <span class="hljs-string"><span class="hljs-string">"#=CategoryName#"</span></span> }, { field: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"100px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"edit"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Edit"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, { command: <span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, title: <span class="hljs-string"><span class="hljs-string">"Delete"</span></span>, width: <span class="hljs-string"><span class="hljs-string">"110px"</span></span> }, ], pageable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, sortable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, filterable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, editable: <span class="hljs-string"><span class="hljs-string">"popup"</span></span>, toolbar: [<span class="hljs-string"><span class="hljs-string">"create"</span></span>], dataSource: { serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverSorting: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">5</span></span>, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, schema: { data: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.value !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.value; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> response[<span class="hljs-string"><span class="hljs-string">"odata.metadata"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response; } }, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ProductID"</span></span>, fields: { ProductID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, Price: { nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, CategoryID: { type: <span class="hljs-string"><span class="hljs-string">"number"</span></span>,validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, CategoryName: { validation: { required: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, editable: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, } }, }, batch: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, error: error, transport: { create: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, }, read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, }, update: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> } }, destroy: { url: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/odata/Products"</span></span> + <span class="hljs-string"><span class="hljs-string">"("</span></span> + record.ProductID + <span class="hljs-string"><span class="hljs-string">")"</span></span>; }, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span> }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ console.log(data); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } } } }); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">categoryDropDownEditor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container, options)</span></span></span><span class="hljs-function"> </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'&lt;input data-bind="value:CategoryID"/&gt;'</span></span>) .appendTo(container) .kendoDropDownList({ dataTextField: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, dataValueField: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, optionLabel: <span class="hljs-string"><span class="hljs-string">"--Select Value--"</span></span>, dataSource: { schema: { data: <span class="hljs-string"><span class="hljs-string">"value"</span></span>, total: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response[<span class="hljs-string"><span class="hljs-string">'odata.count'</span></span>]; }, model: { id: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, fields: { ID: { editable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"number"</span></span> }, Name: { type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, } }, }, type: <span class="hljs-string"><span class="hljs-string">"odata"</span></span>, serverFiltering: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, serverPaging: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, pageSize: <span class="hljs-number"><span class="hljs-number">20</span></span>, transport: { read: { url: <span class="hljs-string"><span class="hljs-string">"/odata/Categories"</span></span>, dataType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>, contentType: <span class="hljs-string"><span class="hljs-string">"application/json"</span></span> } }, parametermap: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, operation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation === <span class="hljs-string"><span class="hljs-string">"read"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parammap = kendo.data.transports.odata.parametermap(data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parammap; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%<span class="hljs-number"><span class="hljs-number">24</span></span>inlinecount=allpages&amp;%<span class="hljs-number"><span class="hljs-number">24</span></span>top=<span class="hljs-number"><span class="hljs-number">5</span></span></b>   <span class="hljs-number"><span class="hljs-number">5</span></span> .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: <span class="hljs-string"><span class="hljs-string">"return-content"</span></span> }</code>   <b>update</b> ,        ,    .     ,         .   <span class="hljs-string"><span class="hljs-string">" </span></span><b><span class="hljs-string"><span class="hljs-string">CategoryName</span></span></b><span class="hljs-string"><span class="hljs-string"> "</span></span>   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.errorThrown === <span class="hljs-string"><span class="hljs-string">"Bad Request"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = JSON.parse(e.xhr.responseText); console.log(response); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>] != <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { alert(response[<span class="hljs-string"><span class="hljs-string">'odata.error'</span></span>].message.value) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert(e.status + <span class="hljs-string"><span class="hljs-string">": "</span></span> + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ <span class="hljs-string"><span class="hljs-string">"odata.error"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"code"</span></span>:<span class="hljs-string"><span class="hljs-string">"ValidationError"</span></span>,<span class="hljs-string"><span class="hljs-string">"message"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"lang"</span></span>:<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>,<span class="hljs-string"><span class="hljs-string">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">"  Name."</span></span> } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </pre> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> <h5> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </h5> <code><code class="cs"> public DbSet Products { get; set; }    : <i> Add-Migration AddProduct, Update-Database</i> .      . ,         <b>Seed</b>   <b> Migrations/Configuration.cs</b>   : <b> context.Products.AddOrUpdate(‚Ä¶)</b> . <br>     OData.    ,             .     OData      .   OData        <b>$expand</b> ,      ;        Data Tranfer Object (DTO): <br> public class ProductDTO { public ProductDTO() { } public ProductDTO(Product product) { ProductID = product.ProductID; Name = product.Name; Price = product.Price; CategoryID = product.CategoryID; CategoryName = product.Category.Name; } [Key] public int ProductID { get; set; } [Required] public string Name { get; set; } public decimal Price { get; set; } public int CategoryID { get; set; } public string CategoryName { get; set; } public Product ToEntity() { return new Product { ProductID = ProductID, Name = Name, Price = Price, CategoryID = CategoryID }; } }</code> <br> <br>   CRUD  <br>       : <br> <code class="cs"> public class ProductController : EntitySetController&lt;ProductDTO, int&gt; { ODataSampleContext _context = new ODataSampleContext(); public override IQueryable&lt;ProductDTO&gt; Get() { return _context.Products.Include(p =&gt; p.Category) .Select(product =&gt; new ProductDTO { ProductID = product.ProductID, Name = product.Name, Price = product.Price, CategoryID = product.CategoryID, CategoryName = product.Category.Name, }); } protected override ProductDTO GetEntityByKey(int key) { return new ProductDTO(_context.Products.FirstOrDefault(p =&gt; p.ProductID == key)); } protected override void Dispose(bool disposing) { _context.Dispose(); base.Dispose(disposing); } }</code> <br>      ‚Äì   DTO.         ,    "". <br>   CRUD     .        : <br> <code class="cs">protected override ProductDTO CreateEntity(ProductDTO entityDto) { if (ModelState.IsValid) { var entity = entityDto.ToEntity(); _context.Products.Add(entity); _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == entity.ProductID)); } else { HttpResponseMessage response = null; response = Request.CreateResponse(HttpStatusCode.BadRequest, new ODataError { ErrorCode = "ValidationError", Message = String.Join(";", ModelState.Values.First().Errors.Select(e =&gt; e.ErrorMessage).ToArray()) }); throw new HttpResponseException(response); } }</code> <br>          .        <b>HttpStatusCode.BadRequest</b>     <b>ODataError</b> . <br>       ,       JSON.     .    <b>HttpResponseException</b>     . <br>       : <br> <code class="cs"> protected override ProductDTO UpdateEntity(int key, ProductDTO updateDto) { if (!_context.Products.Any(p =&gt; p.ProductID == key)) { throw new HttpResponseException(HttpStatusCode.NotFound); } var update = updateDto.ToEntity(); _context.Products.Attach(update); _context.Entry(update).State = System.Data.EntityState.Modified; _context.SaveChanges(); return new ProductDTO(_context.Products.Include(p =&gt; p.Category).FirstOrDefault(p =&gt; p.ProductID == key)); } protected override ProductDTO PatchEntity(int key, Delta&lt;ProductDTO&gt; patch) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } ProductDTO ProductDTO = new ProductDTO(product); patch.Patch(ProductDTO); _context.Products.Attach(ProductDTO.ToEntity()); _context.SaveChanges(); return new ProductDTO(product); } public override void Delete([FromODataUri] int key) { Product product = _context.Products.FirstOrDefault(p =&gt; p.ProductID == key); if (product == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } _context.Products.Remove(product); _context.SaveChanges(); } protected override int GetKey(ProductDTO entity) { return entity.ProductID; }</code> <br>    ,  .     PatchEntity,     Delta,     ,   . <br> <br>  ‚Äì KendoUI Grid <br>   <b>HomeController</b> : <br> <code class="cs">public ActionResult Products() { return View(); }</code> <br>     View <b>Products.cshtml</b>   <b>View/Home</b> ,     <b>div</b>   <b>Grid</b> : <br> <code class="html">@{ ViewBag.Title = "Product"; Layout = "~/Views/Shared/_Layout.cshtml"; } &lt;div id="body"&gt; &lt;section class="featured"&gt; &lt;div class="content-wrapper"&gt; &lt;hgroup class="title"&gt; &lt;h1&gt;Product&lt;/h1&gt; &lt;/hgroup&gt; &lt;div id="Grid" style="height: 380px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;</code> <br>    JavaScript: <br> <b class="spoiler_title">Script  </b> <code class="javascript">&lt;script&gt; $(document).ready(function () { $("#Grid").kendoGrid({ columns: [ { field: "Name", title: "Product Name", width: "100px" }, { field: "CategoryName", title: "Category", width: "150px", editor: categoryDropDownEditor, template: "#=CategoryName#" }, { field: "Price", title: "Price", width: "100px" }, { command: "edit", title: "Edit", width: "110px" }, { command: "destroy", title: "Delete", width: "110px" }, ], pageable: true, pageSize: 5, sortable: true, filterable: true, editable: "popup", toolbar: ["create"], dataSource: { serverPaging: true, serverFiltering: true, serverSorting: true, pageSize: 5, type: "odata", schema: { data: function (response) { if (response.value !== undefined) return response.value; else{ delete response["odata.metadata"]; return response; } }, total: function (response) { return response['odata.count']; }, model: { id: "ProductID", fields: { ProductID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, Price: { nullable: false, type: "number" }, CategoryID: { type: "number",validation: { required: true }, editable: true}, CategoryName: { validation: { required: true }, editable: true }, } }, }, batch: false, error: error, transport: { create: { url: "/odata/Products", contentType: "application/json", type: "POST", }, read: { url: "/odata/Products", dataType: "json", contentType: "application/json", }, update: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, dataType: "json", contentType: "application/json", type: "PUT", headers: { Prefer: "return-content" } }, destroy: { url: function (record) { return "/odata/Products" + "(" + record.ProductID + ")"; }, contentType: "application/json", type: "DELETE" }, parametermap: function (data, operation) { console.log(data); if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } } } }); }); function categoryDropDownEditor(container, options) { $('&lt;input data-bind="value:CategoryID"/&gt;') .appendTo(container) .kendoDropDownList({ dataTextField: "Name", dataValueField: "ID", optionLabel: "--Select Value--", dataSource: { schema: { data: "value", total: function (response) { return response['odata.count']; }, model: { id: "ID", fields: { ID: { editable: false, type: "number" }, Name: { type: "string", nullable: false }, } }, }, type: "odata", serverFiltering: true, serverPaging: true, pageSize: 20, transport: { read: { url: "/odata/Categories", dataType: "json", contentType: "application/json" } }, parametermap: function (data, operation) { if (operation === "read") { var parammap = kendo.data.transports.odata.parametermap(data); return parammap; } return json.stringify(data); } }, }); } &lt;/script&gt;</code> <br> <br>        Kendo   ,      .        <b>dataSource</b> .  schema       ( <b>data</b> ),    ( <b>total</b> ),     . ¬´ <b>total</b> ¬ª    ,   <b>GET /odata/Products?%24inlinecount=allpages&amp;%24top=5</b>   5 .  <b>transport</b>   CRUD      .      <code>headers: { Prefer: "return-content" }</code>   <b>update</b> ,        ,    .     ,         .   " <b>CategoryName</b> "   <code>editor: categoryDropDownEditor</code> ,       . <br>      : <br> <b class="spoiler_title">script  </b> <code class="javascript">&lt;script&gt; function error(e) { if (e.errorThrown === "Bad Request") { var response = JSON.parse(e.xhr.responseText); console.log(response); if (response['odata.error'] != undefined) { alert(response['odata.error'].message.value) } } else { alert(e.status + ": " + e.errorThrown) } }; &lt;/script&gt;</code> <br> <br>   ,      <b>ODataError</b> , : <br> <code class="html">{ "odata.error":{ "code":"ValidationError","message":{ "lang":"en-US","value":"  Name." } } }</code> <br>       . <br> <br>  <br> <img src="https://habrastorage.org/storage2/ad9/763/5c7/ad97635c77b91f0bfafca393ff8026dd.png" alt="image"> <br>   REST   CRUD , , , ,  ,      ,   .      .net MVC,      . <br> <img src="https://habrastorage.org/storage2/866/36c/a00/86636ca006f78a1bedccd8617cd25888.png" alt="image"> <br> ,   : <br> ‚Ä¢ <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api"> </a> <br> ‚Ä¢ <a href="http://blogs.msdn.com/b/alexj/archive/2012/11/02/odata-in-webapi-microsoft-asp-net-web-api-odata-0-2-0-alpha-release.aspx"> </a> <br> ‚Ä¢ <a href="http://pluralsight.com/training/Courses/TableOfContents/aspnetwebapi-odata"></a> <br> <br> PS    .             SPA (Single page application)    .      ‚Äì     .      ,   ,      .</code> </div><p>Source: <a href="https://habr.com/ru/post/180375/">https://habr.com/ru/post/180375/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180357/index.html">Automated testing of a web application (MS Unit Testing Framework + Selenium WebDriver C #). Part 2.2: Selenium API wrapper - WebElement</a></li>
<li><a href="../180359/index.html">Is the demand for programmers growing and will it grow?</a></li>
<li><a href="../180365/index.html">Angularjs guidelines for beginners. Part 2</a></li>
<li><a href="../180367/index.html">Its cloud backend in one line of code. Overview BaaS platform "Backendless"</a></li>
<li><a href="../180373/index.html">Yahoo has confirmed the purchase of Tumblr for 1.1 billion dollars, Marissa Mayer has promised not to screw it up</a></li>
<li><a href="../180377/index.html">Shadow dom</a></li>
<li><a href="../180379/index.html">The digest of interesting news and materials from the world of PHP over the past two weeks, No. 17 (05/06/2013 - 05/21/2013)</a></li>
<li><a href="../180381/index.html">Images: formats and compression (1/3)</a></li>
<li><a href="../180383/index.html">Flickr gives each user 1 terabyte for storing photos and videos.</a></li>
<li><a href="../180385/index.html">"Sockets" from Jolla</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>