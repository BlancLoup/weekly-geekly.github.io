<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Common Event Format inside</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One by one, manufacturers of software and hardware and software solutions claim to receive a certificate confirming support of the HP ArcSight Common ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Common Event Format inside</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/b61/bb0/a49/b61bb0a49a0f029a7d9fd57463c8959b.png"><br><br>  One by one, manufacturers of software and hardware and software solutions claim to receive a certificate confirming support of the HP ArcSight Common Event Format (CEF) format: <a href="http://www.stonesoft.com/en/press_and_media/releases/en/2011/20062011.html">Stonesoft</a> , <a href="http://www.tripwire.com/company/news/press-release/tripwire-achieves-certified-interoperability-with-hp-arcsight-platform/">Tripwire</a> , <a href="http://investors.citrix.com/releasedetail.cfm%3Freleaseid%3D664714">Citrix</a> , <a href="http://www.imperva.com/news/press/2008/12_09_imperva_and_arcsight_partner.html">Imperva</a> , <a href="http://www.netscout.com/partners/alliance/Pages/ArcSight.aspx">NetScout</a> and a few dozen vendors ... <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  About SIEM </h4><br>  In accordance with the annual reports of Gartner, HP ArcSight (until September 2010 - ArcSight) confidently holds among the leaders in developing solutions of the <a href="http://en.wikipedia.org/wiki/Security_information_and_event_management">SIEM</a> class.  In short, the essence of such decisions is to collect in one place <s>hundreds of</s> <s>thousands of</s> millions of events generated by various information security systems and to make a correlation analysis of these events.  The result of the correlation are security incidents with which a person is already working - an administrator or operator. <br><br>  Each manufacturer of SIEM solutions in their advertising brochures usually indicates the number of supported event sources.  For example, it is claimed that ArcSight ESM supports 300+ devices and applications, while QRadar SIEM has ‚Äúonly‚Äù 200+.  Who is there and according to sources, it does not matter now, because within this article we will be interested in the <i>format of</i> information security events (journals). <br><br><h4>  About magazines </h4><br>  There are no general requirements for the structure of IS logs and events yet.  Therefore, each developer draws magazines as it is more convenient for him. <br><br>  Someone simply writes them to a text file, someone provides the ability to send data to a Syslog server.  One only needs SNMP, and the other wants to put all the logs in a relational database.  There is Microsoft with its .evt format, CheckPoint with its OPSEC.  And do not forget about SDEE. <br><br><h4>  About the problem </h4><br>  And the structure of the logs, and the protocols used for their transmission are different everywhere.  From the point of view of integration with SIEM solutions (and not only with them), this is bad.  Because for a unified log processing, they need to be normalized, i.e.  lead to a single format.  In a single event format easier to store.  Easier to search for data and generate reports. <br><br>  Normalization means parsing and mapping.  Therefore, each connector between the IB system and the SIEM solution is an application that parses and maps in accordance with its configuration settings. <br>  If the SIEM manufacturer does not have the support of the product you need, then you will have to perform the configuration settings yourself.  Develop and test regular expressions.  Study the database structure, master SQL * Plus.  Write matching rules.  Sad, in general ... <br><br><h4>  Proposed solution </h4><br>  ‚ÄúIt would be nice if all the vendors of the information security systems alienated their logs in a way that everyone could understand,‚Äù thought ArcSight and in 2006 presented the CEF format they had developed for general <s>approval</s> .  In my opinion, in this format there is nothing difficult.  Just a few requirements need to be met: <br><br>  <b>Requirement # 1 - Use Syslog as a transport</b> <br><br>  Here, seemingly, it is clear. <br>  I want - I use the UDP protocol, I want - TCP. <br><br>  <b>Requirement number 2 - fill eight required fields</b> <br><br>  Of course, the traditional syslog header should be present at the beginning of the message. <br> <code>Jan 18 11:07:53 host</code> <br> <br>  And behind it - the prefix <code>CEF:</code> and a set of required fields, separated by the symbol "|" <br> <code>CEF:Version|Device Vendor|Device Product|Device Version|Signature ID|Name|Severity|Extension</code> <br> <br>  Here: <br><ul><li>  Version - CEF version </li><li>  Device Vendor, Device Product and Device Version - these lines uniquely identify the source of events.  There are no products that have the same set of these three values. </li><li>  Signature ID - a unique identifier of the event type </li><li>  Name - clear to the person description of the event </li><li>  Severity - the importance of the event (from 0 to 10) </li><li>  Extension - see below </li></ul><br><br>  <b>Requirement 3 - Extension field is filled in accordance with the CEF dictionary</b> <br><br>  The Extension field is a set of key-value pairs.  I will give a few keys from the dictionary: <br><br>  dmac is the Destination Mac Address (for example, 00: 0D: 60: AF: 1B: 65) <br>  spt is the Source Port (port from 0 to 65535) <br>  request is the Request URL (in the case of HTTP-request, the URL is specified) <br><br>  In the <a href="http://mita-tac.wikispaces.com/file/view/CEF%2BWhite%2BPaper%2B071709.pdf">description of the CEF format, the</a> dictionary is given in full, indicating the type of data for each key and the maximum allowable size. <br><br>  At the end of the document are some more general requirements.  In particular, the UTF-8 encoding should be used for the entire message.  It also contains the rules for the design of certain special characters and multi-line entries. <br><br>  As a result, the message drawn up in exact accordance with the CEF format should look like this: <br> <code>May 29 15:26:33 host CEF:0|McAfee|Antivirus|5.2|100|worm successfully stopped|10|src=10.0.0.1 dst=2.1.2.2 spt=1232</code> <br> <br><h4>  What is the benefit? </h4><br>  1. Connecting a new event source turns into ‚Äúplug and play‚Äù <br>  2. Reduces the load on the SIEM system itself <br>  3. Manufacturers of SIEM solutions are no longer measured by the number of supported sources and pay more attention to other aspects (product usability, resiliency, etc.) <br>  4. And in general, this format was invented not only for SIEM.  It is already used in other solutions related to processing logs. </div><p>Source: <a href="https://habr.com/ru/post/151631/">https://habr.com/ru/post/151631/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151623/index.html">The dream program of a novice pit driver</a></li>
<li><a href="../151624/index.html">Human colony on Mars. Detailed study of the Mars One project</a></li>
<li><a href="../151626/index.html">Design Patterns (Head First Design Patterns)</a></li>
<li><a href="../151628/index.html">Neurobiology and artificial intelligence: part one - educational program</a></li>
<li><a href="../151629/index.html">We glue several pdf files into one using Mac OS</a></li>
<li><a href="../151632/index.html">Office 365 sync with AD DS, use AD FS 2.0 to create a Single Sign-On</a></li>
<li><a href="../151633/index.html">2GIS data on Rambler Maps</a></li>
<li><a href="../151634/index.html">About how I ported Java to donet</a></li>
<li><a href="../151635/index.html">Erasmus Mundus Scholarship for Higher Education in Europe</a></li>
<li><a href="../151637/index.html">Apple encodes video using JPEG, JSON and <canvas></a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>