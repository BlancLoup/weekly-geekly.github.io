<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Testing with Microsoft tools - field experience</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article was created by our friends, partners from Kaspersky Lab, and describes the actual experience of using Microsoft's testing tools with reco...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Testing with Microsoft tools - field experience</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <em>This article was created by our friends, partners from Kaspersky Lab, and describes the actual experience of using Microsoft's testing tools with recommendations.</em>  <em>The author is a testing engineer at Kaspersky Lab, Igor Shcheglovitov.</em> </blockquote><br><br>  Hello to all.  I work as a testing engineer at Kaspersky Lab in a team that develops a cloud-based server infrastructure on the Microsoft Azure cloud platform. <br><br>  The team consists of developers and testers (approximately in the ratio of 1 to 3).  Developers write C # code and practice TDD and DDD, thanks to which the code turns out to be testable and loosely coupled.  Tests written by developers are launched either manually from Visual Studio or automatically when building a build on TFS.  To start the build, we have a Gated Check-In trigger installed, so it runs when the Source Control checker is installed.  A special feature of this trigger is that if for some reason (whether it is a compilation error or tests did not pass), the build drops, then the check itself, which launched the build, does not fall into SourceControl. <br>  You, probably, faced the statement that it is difficult to test the code?  Some resort to pair programming.  Other companies have dedicated testing departments.  We have this mandatory code review and automated integration testing.  Unlike modular - integration tests are developed by dedicated testing engineers, which I belong to. <br><a name="habracut"></a><br>  Clients interact with us through remote SOAP and REST API.  Services themselves are based on WCF, MVC, data is stored in Azure Storage.  The Azure Service Bus and Azure Cloud Queue are used to reliably and scale long business processes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>Some lyrics: there is an opinion that a tester is a kind of stage to become a developer.</i>  <i>This is not entirely true.</i>  <i>The line between programmers and testing engineers disappears every year.</i>  <i>Testers should have a great technical background.</i>  <i>But at the same time, have a slightly different thinking than the developers.</i>  <i>Testers should be aimed at the destruction in the first place, the developers to create.</i>  <i>Together, they should try to make a quality product.</i> <br><br>  Integration tests, as well as the main code, are developed in C #.  Simulating the actions of the end user, they check business processes on configured and running services.  To write these tests using Visual Studio and the framework MsTest.  Developers use the same thing.  In the process, testers and developers produce cross-code review, so that team members can always speak the same language. <br><br>  Test scripts (test cases) are live and managed through MTM (Microsoft Test Manager).  The test case in this case is the same TFS entity as a bug or task.  Test cases are manual or automatic.  Due to the specifics of our system, we use only the latter. <br><br>  Automatic test cases are linked by full CLR name with test methods (one case - one test method).  Before the advent of MTM (Visual Studio 2010), I ran tests as modular, limited to the studio.  It was difficult to build reports on testing, manage tests.  Now this is done directly through MTM. <br><br>  Now it is possible to combine test cases into test plans, and inside plans to build flat and hierarchical groups via TestSuite. <br><br>  We have a Feature Branch development, i.e.  major improvements are made in separate branches, stabilization and release.  We created a test plan for each branch (to avoid chaos).  After stabilization is completed in the Feature Branch branch, the code is transferred to the main branch, and the tests are transferred to the corresponding test plan.  Test cases are very easy to add to test plans (Ctrl + C Ctrl + V, or via the TFS query). <br><br>  <i>Some recommendations.</i>  <i>Personally, I try to separate stable tests from new ones for each branch.</i>  <i>This is easy to do through TestSuite.</i>  <i>The peculiarity here is that stable (or regression) tests must pass 100%.</i>  <i>If you are wrong, then it is worth thinking.</i>  <i>Well, after the new functionality becomes stable, the corresponding tests are simply transferred to the regression Test Suite.</i> <br><br>  For me personally, one of the most boring and routine processes was the creation of test cases.  The process of autotest development is different for everyone.  Someone at the beginning writes detailed test scenarios, and then creates auto tests on the basis.  I have the opposite.  I write in the code (in the test class) dummy tests (without logic).  Then there is the implementation of logic, architecture component testing, test data and so on. <br><br>  After the tests are created, they must be transferred to TFS.  It's one thing when there are 10 test pieces, and if it is 50 or 100, you have to spend a lot of time on routinely filling in the steps, associating each new test case with the test method. <br><br>  To simplify this process, Microsoft invented the tcm.exe utility, which can automatically create test scripts in TFS and include it in the test plan.  This utility has several drawbacks, for some reason you cannot add tests from different assemblies to a single test plan or you cannot specify steps and a normal name for a test case.  In addition, the utility itself appeared relatively recently.  When it was not there yet, we created a self-written utility that automates the process of creating test scripts.  Special custom attributes TestCaseName and TestCaseStep are also developed for specifying the name and steps of the test script. <br><br>  The utility itself can both update and create test scenarios, include it in the desired plan.  The utility can work in silent mode, its launch is included in the Worfklow TFS build.  Thus, it starts automatically by itself and adds or updates existing test scripts.  As a result, we have a current test plan. <br>  The status of the test run in the test plan (which is equivalent to the quality of the code) is visible in special reports.  TFS has a set of ready-made report templates that build diagrams based on OLAP data of cubes on test case and test plan statuses.  But we have a self-written and simplified report.  We made it so that everyone who looked at it would immediately understand everything. <br><br>  Here is an example: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ef/7f2/71d/2ef7f271d66a6a6cf380ef60a639e8e7.png"><br>  A special feature of the report is that it is not built on the basis of cubes that are not rebuilt synchronously and may not contain actual data; our report uses data that is pulled directly through the MTM API.  Thus, at any time we get the current status of the test plan. <br>  The report is built in HTML format and sent to the whole team via SmtpClient.  This is all done using a simple utility, the launch of which is included directly in the Workflow build: <a href="http://1drv.ms/1BnMDvE">download the utility</a> . <br><br>  In addition to managing test scripts, MTM is also used to manage test environments and configure agents that run tests.  To speed up the execution of tests (here we are talking about tests that check long asynchronous business processes) we use 6 testing agents, i.e.  due to the horizontal scaling of agents, we achieve parallel test execution. <br><br>  On their own, integration auto tests can be manually launched via either MTM or Visual Studio.  But manual start happens during debugging (either tests or code).  Our team has a reproducing test for almost every bug.  Next, the bug along with the test is passed to the development.  And it is easier for developers to simulate a problem situation and correct it. <br><br>  Now about the process of regression. <br><img src="https://habrastorage.org/getpro/habr/post_images/dfc/11d/831/dfc11d831bc6734dd21a879cc606b2da.png"><br>  In our project there is a special build that initiates a full run of tests, it runs on the trigger as a Rolling Build.  That is, if the successful Gated Checkin build was successful, then the Rolling Build is launched.  The peculiarity of this build is at the same time going to a maximum of one build. <br><br>  The beginning of this build is the same as the previous one - collecting the latest versions of the test and main project, and then the unit tests run. <br><br>  If everything went well, then specially written Power Shell scripts are launched that deploy the package of collected services to Azure.  Deploem uses Azure REST API.  The deployment itself is performed on an intermediate deployment of the cloud service.  If the deployment was successful and the role runs without errors, then start the configuration check scripts.  If everything is good, then the roles switch (the intermediate deployment becomes the main one) and the integration tests themselves are run. <br>  After running the tests, a letter is sent to the whole team, which contains a report on the status of the tests. <br><br>  Before writing tests, classical modular and integration, I recommend reading the books The Art of Unit Testing and xUnit Test Patterns: Refactoring Test Code <br>  These books (I personally love the first) contain a large number of tips and tricks, as it should, and do not write tests on any xUnit framework. <br><br>  I would like to finish my article by listing the basic principles of writing auto tests code in our team: <br><br><ul><li>  <b>The ‚Äúclear‚Äù CLR name of the test method</b> .  Here the basic idea is that by looking at one test name, the programmer can understand what he will check, with what data, and what is expected.  The test name should consist of 3 parts, separated by an underscore, and look something like this: FunctionalUnderTest_Conditions_ExpectedResult </li><li>  <b>Strict dough structure - Arrange-Act-Assert</b> .  Data preparation, some action and verification.  The meaning is that the tests should have the simplest and most compact structure, essentially consisting of 3 steps described earlier.  Due to this, good readability is achieved, as well as ease of support and debugging tests. </li><li>  <b>Tests should not contain conditional logic and cycles</b> .  There are no comments here, if we had such tests, we would have to write tests for tests. </li><li>  <b>One test - one test</b> .  Often, people insert a bunch of Assert`s into their tests, and then they can't figure out which one of them the test fell to.  Try to do one test in the test, it makes debugging and troubleshooting much easier.  Here I will add a little bit that in some cases, after one action, it is required to check the status of several objects, and the state of each of them is characterized by many properties.  In this case, it is advisable to do two tests, and check all properties in separate methods for helpers with a normal name, so that instead of Assert.IsTrue, call your redefined assertion.  Also, while writing property checks, try to write readable error messages.  Here I just gave an example.  In fact, there are lots of different patterns. </li><li>  <b>Tests, even integration tests, should be quick</b> .  Try to write them with this in mind.  I have seen many examples of tests with such inserts: Thread.Sleep (60000).  Avoid this.  If you expect to perform some kind of asynchronous action, then think for yourself how you can track its execution (for example, an asynchronous process changes the state in the database, etc.).  Or maybe it is worth breaking the test into several? </li><li>  You may not be doing this yet, but follow the <b>thread safety</b> tests.  Since  In the future, you will most likely come to the fact that you want to speed up the execution of tests and almost one of the ways to achieve this acceleration will be multithreading. </li><li>  <b>Independence</b>  Tests should not depend on the order of their execution, and from each other.  Write tests taking into account this principle.  Try to clear the test data, as they often lead to various unforeseen consequences and slow down the execution of tests. </li></ul><br>  And finally, I want to add that the right tests really make the development fast and the code quality. </div><p>Source: <a href="https://habr.com/ru/post/248747/">https://habr.com/ru/post/248747/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248733/index.html">Must-read books for 2014 on information security and programming</a></li>
<li><a href="../248735/index.html">Defining voice mail when calling</a></li>
<li><a href="../248737/index.html">Horizontal websocket scaling in Ruby</a></li>
<li><a href="../248741/index.html">Data tidying: Preparing Data Sets for Case-Based Analysis</a></li>
<li><a href="../248745/index.html">Lectures Technopark. 1 semester Web technologies</a></li>
<li><a href="../248753/index.html">How to bypass the main difficulties in porting CAD applications to nanoCAD?</a></li>
<li><a href="../248755/index.html">GPU Particles using Compute and Geometry Shaders</a></li>
<li><a href="../248761/index.html">Browser-in-browser will make the site much safer.</a></li>
<li><a href="../248765/index.html">Microsoft has joined the Student Developer Pack and some other GitHub Education news.</a></li>
<li><a href="../248767/index.html">The digest of interesting materials for the mobile developer # 87 (on January 19-25)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>