<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Integration of Zend_Acl and MVC. Part 1 (simplest use)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So what's wrong with Zend_Acl and the current MVC implementation in the Zend Framework? Nothing wrong, just not too obvious for developers how to achi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Integration of Zend_Acl and MVC. Part 1 (simplest use)</h1><div class="post__text post__text-html js-mediator-article">  So what's wrong with Zend_Acl and the current MVC implementation in the Zend Framework?  Nothing wrong, just not too obvious for developers how to achieve optimal integration between these two important parts of the framework. <br><a name="habracut"></a><br>  First, this article is based on the following sentence ( <a href="http://framework.zend.com/wiki/pages/viewpage.action%3FpageId%3D39025">link</a> ), which is currently at the stage of Awaiting recommendation. <br>  Well, how does it work?  There are two main components in this sentence: <br><ol><li>  Front Controller Plugin: This component decides whether the current user has access to the page being opened. </li><li>  Action Helper: This component allows you to check whether the current user has access inside the controller. </li></ol><br>  Based on these two components, let's try them on an example.  Let's talk about a site like DevZone. <br>  We will need a controller for managing users and another controller for managing articles, as well as 3 types of users (roles): one for guests, one for authors of articles and another for approving articles.  Total, we have: <br><br>  <b>Resources:</b> <br><ol><li>  User Controller. </li><li>  Controller articles. </li></ol><br>  <b>Roles:</b> <ol><li>  Guest (Guest). </li><li>  Author (Writer). </li><li>  Admin. </li></ol><br><h3>  Setting up the Zend_Acl component </h3><br>  After determining what we need to do, the next step is to create an instance of Zend_Acl that reflects our model. <br><pre>  / ** Creating the ACL object * /
 require_once 'Zend / Acl.php';
 $ myAcl = new Zend_Acl ();
</pre><br><h3>  Creating roles </h3><br>  We will now create roles in our Zend_Acl instance. <br><pre>  / ** Creating Roles * /
 require_once 'Zend / Acl / Role.php';
 $ myAcl-&gt; addRole (new Zend_Acl_Role ('guest'))
       -&gt; addRole (new Zend_Acl_Role ('writer'), 'guest')
       -&gt; addRole (new Zend_Acl_Role ('admin'), 'writer');
</pre><br><h3>  Resource creation </h3><br>  We will create the necessary resources (one per controller), as well as their relationship with the roles we have created. <br><pre>  / ** Creating resources * /
 require_once 'Zend / Acl / Resource.php';
 $ myAcl-&gt; add (new Zend_Acl_Resource ('user'))
       -&gt; add (new Zend_Acl_Resource ('article'));
</pre><br><h3>  Privilege creation </h3><br>  Now we have added roles and resources to our instance of Zend_Acl, it's time to explain what actions should be available for which roles. <br><ol><li>  Guests cannot edit, add and publish articles. </li><li>  Authors cannot publish articles. </li><li>  Administrators have full access. </li></ol><br><pre>  / ** Creating permissions * /
 $ myAcl-&gt; allow ('guest', 'user')
       -&gt; deny ('guest', 'article')
       -&gt; allow ('guest', 'article', 'view')
       -&gt; allow ('writer', 'article', array ('add', 'edit'))
       -&gt; allow ('admin', 'article', 'approve');
</pre><br><h3>  Creating a page displayed when not accessed </h3><br>  We will need to create a view (view) and action (action) to which we redirect all users who do not have enough privileges.  First, we will create a new action in our error controller: <br><pre>  class ErrorController extends Zend_Controller_Action
 {
     ....

     public function deniedAction ()
     {
     }

     ....
 }
</pre><br>  Then we will create our view file (/application/views/scripts/error/denied.phtml) with some warning message: <br><pre> &lt;h1&gt; Error &lt;/ h1&gt;
 &lt;h2&gt; Access denied &lt;/ h2&gt;
 &lt;p&gt; You are trying to make sure you are not allowed. &lt;/ p&gt;
</pre><br><h3>  Complete setup </h3><br>  Well, we set up our instance of Zend_Acl.  The next step is to register a controller plugin.  This important part takes the instance of Zend_Acl we created and checks if the current page is accessible to the user. <br><pre>  / ** Setting up the front controller * / 
 require_once 'Zend / Controller / Front.php'; 
 $ front = Zend_Controller_Front :: getInstance (); 
 $ front-&gt; setControllerDirectory ('path / to / controllers'); 
 
 / ** Registering the Plugin object * / 
 require_once 'Zend / Controller / Plugin / Acl.php'; 
 $ aclPlugin = new Zend_Controller_Plugin_Acl ($ myAcl);
 $ aclPlugin-&gt; setRoleName ($ currentUserRole);

 $ front-&gt; registerPlugin (new Zend_Controller_Plugin_Acl ($ acl, 'guest')); 

 / ** Dispatching the front controller * / 
 $ front-&gt; dispatch (); 
</pre><br>  After the configuration is completed, as soon as the user enters our application, depending on his / her role, the requested page will be displayed or a page with a message on access denied will be displayed. <br><br>  For more information on the topic, you can read the following: <br>  <a href="http://framework.zend.com/wiki/pages/viewpageattachments.action%3FpageId%3D39025">Zend_Acl &amp; MVC Integration</a> <br>  and a small example: <br>  <a href="">Source code</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Crosspost: <a href="http://lobach.info/develop/zf/zend_acl-and-mvc-integration-part-i/">http://lobach.info/develop/zf/zend_acl-and-mvc-integration-part-i/</a> </div><p>Source: <a href="https://habr.com/ru/post/31639/">https://habr.com/ru/post/31639/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../31638/index.html">Third companies will be available search technology Yahoo</a></li>
<li><a href="../316380/index.html">FIAS addresses in the PostgreSQL environment. Part 2</a></li>
<li><a href="../316382/index.html">FreeNAS 10 - the new face of the old storage</a></li>
<li><a href="../316386/index.html">Increase attack costs with Immutable Infrastructure</a></li>
<li><a href="../316388/index.html">Never take a counter offer</a></li>
<li><a href="../316392/index.html">Why not Assets Pipeline?</a></li>
<li><a href="../316394/index.html">5 reasons not to use your personal account in freelance</a></li>
<li><a href="../316396/index.html">Ukrainian company has developed a private cloud for Silicon Valley startups</a></li>
<li><a href="../31640/index.html">For online video advertising finally found a niche</a></li>
<li><a href="../316400/index.html">Deploy OpenSource Puppet 4 with multiple puppet masters. Part I. Preparatory</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>