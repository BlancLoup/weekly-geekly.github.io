<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Everything you wanted to know about Shellshock vulnerability (but were afraid to ask)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Remember Heartbleed ? Shellshock can be attributed to the same "weight category", with the same stylish name, albeit without a cool logo (someone from...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Everything you wanted to know about Shellshock vulnerability (but were afraid to ask)</h1><div class="post__text post__text-html js-mediator-article">  Remember <a href="http://www.troyhunt.com/2014/04/everything-you-need-to-know-about.html">Heartbleed</a> ?  Shellshock can be attributed to the same "weight category", with the same stylish name, albeit without a cool logo (someone from the marketing department of this vulnerability would have to do this).  But Shellshock has the potential to become as important a bird as Heartbleed.  And now I would like to put together all the necessary information that will help all who wish to cope with the situation and avoid possible problems due to the seemingly unobvious threat. <br><br>  To begin, let me share with you some information from the <a href="http://blog.erratasec.com/2014/09/bash-shellshock-scan-of-internet.html">blog of Robert Graham</a> , who conducted an excellent vulnerability analysis.  Consider the following HTTP request: <br><br><pre><code class="bash hljs">target = 0.0.0.0/0 port = 80 banners = <span class="hljs-literal"><span class="hljs-literal">true</span></span> http-user-agent = shellshock-scan (http://blog.erratasec.com/2014/09/bash-shellshock-scan-of-internet.html) http-header = Cookie:() { :; }; ping -c 3 209.126.230.74 http-header = Host:() { :; }; ping -c 3 209.126.230.74 http-header = Referer:() { :; }; ping -c 3 209.126.230.74</code> </pre> <br>  If we apply it to the range of vulnerable IP, we get the following result: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/aaa/b43/643/aaab43643851449d8a915ded15592730.png"><br><br>  Simply put, Robert made a bunch of remote machines ping it, simply by sending a specially crafted request to the network.  The concern is that he forced these machines to execute an arbitrary command (in this case, an innocuous ping), which opens up tremendous opportunities. <br><a name="habracut"></a><br><h1>  What is bash and why do we need it? </h1>  You can skip this section if you are already in the subject.  But if you are not familiar with <a href="http://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bash</a> , I recommend reading the information below to understand the overall picture.  Bash is a command shell (interpreter) widely used on Linux and Unix systems, usually connected via SSH or Telnet.  Bash can also work as a parser for CGI scripts on a web server, for example, on Apache.  Bash has its history since the 1980s, where it evolved from earlier implementations of the command shell (the name comes from the <a href="http://en.wikipedia.org/wiki/Bourne_shell">Bourne shell</a> ) and is incredibly popular.  Of course, there are other interpreters, but Bash goes by default on Linux and Mac OS X, which, as you understand, are very widespread.  This interpreter is even <a href="http://www.cnet.com/au/news/bigger-than-heartbleed-bash-bug-could-leave-it-systems-shellshocked/">recognized as</a> "one of the most common utilities in Linux systems."  The prevalence of Bash is the main reason why Shellshock is so dangerous. <br><br>  This <a href="http://news.netcraft.com/archives/2014/09/24/september-2014-web-server-survey.html">graph</a> gives a visual representation of the omnipresence of bash: <br><br><img src="https://habrastorage.org/files/908/f1b/82b/908f1b82b9a64c3ab21266619146510e.png"><br><br>  Half of the Internet works on Apache (usually installed under Linux), and this is really very, very much.  In the same article, it is reported that we have already crossed the line of 1 billion active websites, and since many of them are located on mass hosting, we are dealing with a huge number of installed copies of Bash.  And besides web servers, do not forget about the many other servers and devices running Linux.  But back to this later. <br><br>  Bash is used for a wide range of system tasks, from configuring websites to managing firmware in peripheral devices such as webcams.  Such opportunities should not be open to everyone, and theoretically available only to authorized users who have certain access rights.  In theory. <br><br><h1>  What is the essence of vulnerability? </h1>  The severity of the situation can be estimated from the following quote from <a href="http://web.nvd.nist.gov/view/vuln/detail%3FvulnId%3DCVE-2014-6271">the NIST vulnerability database</a> : <br><br><blockquote>  It is <b>clear that it has been possible to</b> follow the rules of the environment. The HTTP Server has been set to meet the privilege of bash execution. </blockquote><br>  Vulnerability assigned the level of "10 out of 10", that is, there is no place worse.  Add to this the ease of executing an attack (Access Complexity low) and, more importantly, <b>no need for authentication to use Bash using CGI scripts</b> .  Let's understand the essence of the bug itself. <br><br>  The main danger lies in the possibility of arbitrarily setting the environment variables inside the Bash interpreter, which defines the definition of functions.  Problems begin at the moment when Bash continues to process interpreter commands after defining a function, which allows an attack with code injection.  Take only one line from Robert‚Äôs example: <br><br> <code>http-header = Cookie:() { :; }; ping -c 3 209.126.230.74</code> <br> <br>  The function definition is <code>() { :; };</code> <code>() { :; };</code>  and the interpreter command is ping and its parameters.  When processing this line with the Bash interpreter, any command can be executed.  In the context of the web, this can be done through a mechanism such as a CGI script and optionally through the request header.  More information can be found on the <a href="http://seclists.org/oss-sec/2014/q3/650">seclists.org</a> page, it‚Äôs also established that the path and query string can also be a potential attack vector. <br><br>  Of course, the situation can be mitigated simply by <a href="https://blogs.akamai.com/2014/09/environment-bashing.html">disabling the operation of CGI</a> .  But in many cases, this will have a too serious impact on your website and, at a minimum, will require extensive testing to ensure that it works. <br><br>  The above HTTP request is simple and efficient, being only one of many possible uses of this protocol.  If we take into account Telnet and SSH, and, obviously, even DHCP, the scale of the problem grows many times, despite the fact that we are talking only about attacks on web servers.  So far, there is a danger only <a href="https://blogs.akamai.com/2014/09/environment-bashing.html">after authentication with SSH</a> , but later we will find other attack vectors. <br><br>  It must be remembered that the possibilities of intruders extend far beyond the limits of pinging specific addresses, as in the example of Robert, this is just a small example of the very possibility of controlling remote machines.  The question now is this: <b>what harm can attackers do when executing various commands in the interpreters of remote machines?</b> <br><br><h1>  What are the potential consequences? </h1>  Getting access to the interpreter has always been a big victory for an attacker, because it is equivalent to gaining control over the server (with the appropriate rights).  Access to internal data, reconfiguration of the environment, the spread of malware and so on.  The possibilities are almost endless and automated.  There are already many <a href="http://pastebin.com/raw.php%3Fi%3D166f8Rjx">examples of exploits</a> that can be easily applied against a large number of machines. <br><br>  Unfortunately, when it comes to the execution of arbitrary code in the shell of half of the Internet web servers, the possibilities are extremely great.  One of the most obvious and worst is <a href="https://www.invisiblethreat.ca/2014/09/cve-2014-6271/">getting access to internal files</a> .  The files with passwords and configurations will be of the greatest interest, but access will be possible in general to all files. <br><br>  The same applies to the ability to write files to a remote machine.  This is one of the easiest ways to replace pages on someone else‚Äôs website, not to mention the spread of malware.  Or how about this? <br><br> <a href="https://twitter.com/mikko/status/514931909575442432"><img src="https://habrastorage.org/files/05e/04e/c1f/05e04ec1f6ad4ad5910d32a5d8e3d811.png"></a> <br><br>  When it comes to worms, it means malicious software that creates its own copies on the target system.  An example of a very effective worm is the <a href="http://en.wikipedia.org/wiki/Samy_(computer_worm)">Samy</a> XSS worm, which infected millions of web pages in less than one day. <br><br>  The danger of Shellshock is also in the fact that an epidemic of infections may start this way, especially at an early stage, until most of the machines have closed this vulnerability.  The infected machines themselves will look for new victims and infect them.  And all public machines are now subject to danger, and now there will be no salvation anywhere if penetrating corporate firewalls.  <b>People are already exploiting it right now.</b>  The real arms race between those who want to use the gap and those who want to close it is in full swing. <br><br><h1>  What versions of bash are vulnerable? </h1>  All versions for the last almost 25 years, including 4.3.  Compare with Heartbleed, the dangers of which have been exposed to the OpenSSL version for the last two years.  Yes, people update versions, but this is not done systematically, and anyway, Shellshock threatens a <b>much larger</b> number of machines than Heartbleed. <br><br>  Alas, the vulnerability may persist in future versions.  There are already information about <a href="http://www.itnews.com.au/News/396085,bash-bug-could-be-worse-than-heartbleed.aspx">patches that were not very effective</a> .  So this vulnerability needs to be monitored very carefully, it is not one of those things that you can forget about after installing the patch. <br><br><h1>  When was the vulnerability discovered? </h1>  The first mention I found was in a very short note on <a href="http://seclists.org/oss-sec/2014/q3/649">seclists.org</a> , published on Wednesday around 14-00 GMT.  More information was <a href="http://seclists.org/oss-sec/2014/q3/650">posted on the same resource an</a> hour later.  So this is very ‚Äúfresh‚Äù news, and it is too early to talk about the mass appearance of exploits in the ‚Äúwild‚Äù nature.  But this can happen very soon, the probability increases with each passing hour. <br><br>  As mentioned above, the vulnerability exists in all versions of Bash created over the past 25 years.  So, theoretically, all this time, knowledgeable people could use it. <br><br><h1>  Are our devices under threat? </h1>  The question is interesting, because there are many devices that potentially use Bash.  I mean the ‚ÄúInternet of Things‚Äù (IoT), when the assignment of the IP address of every little thing, from <a href="http://www.hapi.com/product/hapifork">plug</a> to <a href="https://lockitron.com/">door lock</a> and <a href="http://au.lifx.co/">light bulb</a> , is becoming more widespread.  Many ‚Äúinternet stuff‚Äù use embedded versions of Linux with bash.  The same devices have already shown serious security holes, for example, <a href="http://www.smh.com.au/digital-life/consumer-security/security-vulnerability-found-in-lifx-smart-light-bulbs-exposes-home-wifi-passwords-20140709-zt12p.html">with LIFX light bulbs you can get identification data via Wi-Fi</a> .  So, even without vulnerabilities like Shellshock, we found ourselves in a situation where, by connecting various devices and objects to the network, we get a lot of new vulnerabilities in areas that were previously completely safe. <br><br>  This poses many new challenges.  For example, does anyone think about putting patches on light bulbs regularly?  Given the "durability" of such devices, it is unlikely someone will be engaged in supporting firmware.  Recall the <a href="http://www.theverge.com/2012/2/3/2767453/trendnet-ip-camera-exploit-4chan">Trendnet camera story</a> a couple of years ago.  Undoubtedly, a huge number of them are still connected to the network, because from the point of view of software updates, they are much easier to install and forget.  There is a Twitter account <a href="https://twitter.com/TRENDnetExposed">entirely dedicated to the publication of images from such cameras</a> , when their owners do not even know that they are being shot.  This is a big problem, because updating the software of peripheral devices is often difficult, so over time more and more devices and objects with all sorts of vulnerabilities will surround us. <br><br>  But the Bash interpreter is also already present in many familiar devices, for example, home routers.  When was the last time you updated its firmware?  Of course, if you are reading this text, then you are probably one of those who regularly deal with such things.  But ordinary users do not even think about it. <br><br><h1>  Everything works on Microsoft software, do we have to worry? </h1>  The short answer is no, the long one is yes.  Despite the fact that there are versions of Bash for Windows, for this ecosystem, this utility is not any widespread.  It is also unclear whether the Shellshock vulnerability has a Windows version of Bash. <br><br>  However, the fact that you are working exclusively in a Windows environment does not mean that Bash is absent on the machines serving the individual tasks of your network.  As an explanatory picture I want to give an illustration from the <a href="http://nickcraver.com/blog/2013/04/23/stackoverflow-com-the-road-to-ssl/">post of Nick Kraver</a> : <br><br><img src="https://habrastorage.org/files/f16/e40/c8c/f16e40c8c0a144fdb885f5f0789bfe42.png"><br><br>  As you can see, traffic passes from your Windows environment through non-Windows devices.  There may be components that have privileges over the firewall, which can be done then with the help of Shellshock? <br><br><h1>  I am a sysadmin, what can I do? </h1>  Firstly, it is very easy to determine if you are at risk.  You just need to execute this command in your interpreter (he allowed himself to change the original command a little - approx. Pkruglov): <br><br><pre> <code class="bash hljs">env X=<span class="hljs-string"><span class="hljs-string">"() { :;} ; echo busted"</span></span> bash -c <span class="hljs-string"><span class="hljs-string">"echo stuff"</span></span></code> </pre><br>  If "busted" is displayed, then the vulnerability is present. <br><br>  Of course, you need to close the hole first.  The patch will significantly reduce the risk of executing someone else's code at the end of the Bash function.  For a number of Linux distributions, for example, <a href="https://access.redhat.com/solutions/1207723">Red Hat</a> , instructions have already appeared, so do this as soon as possible (in fact, patches have already been released for most distributions - pkruglov). <br><br>  Instructions for upgrading intrusion detection systems (IDSs) have already appeared, and they should immediately be adopted by various organizations, especially those in which long-term testing should be carried out before installing patches.  The Qualys provider has <a href="https://community.qualys.com/blogs/securitylabs/2014/09/24/bash-remote-code-execution-vulnerability-cve-2014-6271">offered</a> its own way to detect attacks, and probably many other IDS providers are working on this problem. <br><br>  More cardinal ways include replacing Bash with another interpreter, or blocking the system at risk.  Both methods can have far-reaching consequences, they should not be used thoughtlessly.  But this is what could be the main feature of Shellshock: the <b>quick adoption of difficult decisions that can have a serious impact on the real business, in order to avoid potentially much more significant damage.</b> <br><br>  Another question arises much more acutely: Has Shellshock been exploited by anyone earlier?  It is difficult to determine if the attack vectors were not fixed.  And often this will not happen if the attack is carried out via HTTP or POST request.  To the question ‚Äúwere we attacked through Shellshock?‚Äù The most frequent answer would <a href="https://blogs.akamai.com/2014/09/environment-bashing.html">be</a> : we have no evidence that we have closed this vulnerability.  This leaves website owners and other systems in an unpleasant suspense as to whether they have been compromised. <br><br><h1>  I am a user, what can I do? </h1>  Depends on the specific situation.  If you are using Mac OS X, then this vulnerability will be easily (and, hopefully, quickly) closed using the standard update mechanism.  You can easily check whether you are at risk by using the <a href="http://apple.stackexchange.com/questions/146849/how-do-i-recompile-bash-to-avoid-the-remote-exploit-cve-2014-6271/146851">test</a> : <br><br><img src="https://habrastorage.org/files/d0e/5be/15b/d0e5be15bca14314bf1d87f989aa9f39.png"><br><br>  This is a simple test, although I doubt that the average user Mac will easily follow the advice and recompile Bash. <br><br>  More troubling are devices whose software updates are difficult, for example, routers.  The problem is aggravated by the fact that routers are often leased by providers and users do not have access to the control panel.  Multiply this by a huge number of models.  In this case, the flashing of the router is also not included in the list of usual cases of the average user. <br><br>  In short, the tips to users are as follows: install security updates, do not ignore the advice of your provider and the suppliers of your hardware with firmware.  Beware of letters requesting information or giving instructions on how to launch software, such messages often come during phishing attacks that exploit "trendy" user fears. <br><br><h1>  Total </h1>  Apparently, we are only at the very beginning of our study of the depths of this vulnerability.  Of course, there have been many parallels with Heartbleed, and in some ways it even helped us.  Using the example of Heartbleed, we know that the situation can deteriorate very quickly, and we will rake the consequences <a href="http://www.theguardian.com/technology/2014/jun/23/heartbleed-attacks-vulnerable-openssl">for a very long time</a> . <br><br>  But in this case, things can be much worse than with Heartbleed.  If that vulnerability allowed remote access to a small amount of data in the memory of an infected machine, then Shellshock makes it possible to inject arbitrary code, which is potentially much more dangerous.  In this regard, I agree with Robert: <br><br> <a href="https://twitter.com/ErrataRob/status/514829217595289600"><img src="https://habrastorage.org/files/e53/8d3/eaf/e538d3eafe9d48989a2d77a75f90b251.png"></a> <br><br>  I suppose it will take a day or two, and we will understand that these were still only flowers. <br><br>  <b>UPD.</b>  In continuation, new vulnerabilities have been discovered in bash <a href="http://www.linux.org.ru/news/security/10892232">www.linux.org.ru/news/security/10892232</a> <br>  Universal script for checking for vulnerabilities <a href="https://github.com/hannob/bashcheck">github.com/hannob/bashcheck</a> </div><p>Source: <a href="https://habr.com/ru/post/238475/">https://habr.com/ru/post/238475/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../238463/index.html">In search of free tickets, the study of the game Aeroflot</a></li>
<li><a href="../238467/index.html">OpenCL 2.0 and drivers from AMD and Intel</a></li>
<li><a href="../238469/index.html">We trace removal of files on PowerShell</a></li>
<li><a href="../238471/index.html">The new release of ReadyScript introduces the functionality of warehouses.</a></li>
<li><a href="../238473/index.html">Deploying Go Servers with Docker</a></li>
<li><a href="../238479/index.html">Automatic Radio Secretary, or ARS, or Arsik (1966)</a></li>
<li><a href="../238481/index.html">Why are quantum mechanics and relativity incompatible?</a></li>
<li><a href="../238483/index.html">Why do you need a mouse if you have a keyboard?</a></li>
<li><a href="../238485/index.html">Design in the browser</a></li>
<li><a href="../238487/index.html">Sample Magic Spring Data JPA Audit and Version</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>