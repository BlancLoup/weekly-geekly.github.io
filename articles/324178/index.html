<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Download trusted environment or easy way to paranoia in IT</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Despite the somewhat academic name, the topic is quite a practical one. 
 When we see news headlines about another successful hacking of Telegram or W...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Download trusted environment or easy way to paranoia in IT</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/d27/80e/b98/d2780eb98f71469faec8281b5c573ff4.jpg"></p><br><p>  Despite the somewhat academic name, the topic is quite a practical one. <br>  When we see news headlines about another successful hacking of Telegram or WhatsApp chats (CIA, Iranian intelligence services, Zimperium - underline), people often have to explain that compromising the operating system or user account is not synonymous with the weakness of the application‚Äôs protection, and this is not reason to refuse to use your favorite messenger, because  in its place it can be without any other difference in principle. </p><br><p>  And if, for example, booting from the flash drive you ‚Äúreset‚Äù the administrator's passwords of any of your Windows machines, this does not mean monstrous holes in the ‚ÄúMastdaye‚Äù, and about you - as a super hacker who hacked the brainchild of Microsoft. </p><br><p>  I would like to slightly clarify the issues of the environment, components of trust and threats, to create a holistic picture and to understand what we expect in terms of security from the operating system, BIOS and favorite chat application, so as not to shift responsibility from slander to healthy. </p><br><p>  So, let's start with the practice, there is the following case: </p><a name="habracut"></a><br><p>  You, after successfully celebrating the day of the system administrator, have forgotten all your logins and passwords for logging into the system and cannot work with your computers.  How to return access?  Consider the example of two popular operating systems: Ubuntu and Windows (MacOS consider later). </p><br><h2 id="sbros-zabytogo-parolya-v-os-ubuntu">  Reset a forgotten password in Ubuntu OS </h2><br><h3 id="scenariy-1-est-dostup-k-menyu-vybora-operacionnyh-sistem-grub">  Scenario 1. There is access to the menu for choosing the GRUB operating systems. </h3><br><p>  If you have when you boot your computer, the operating system selection menu appears, then most likely you have an item labeled recovery mode. </p><br><p><img src="https://habrastorage.org/files/98a/da2/00f/98ada200fb5d4c06b24086095731a0f7.png"></p><br><p>  Boot into it, in the Recovery menu, select root to go to the shell superuser. </p><br><p><img src="https://habrastorage.org/files/a88/65b/b6f/a8865bb6f8a3472e9dd776295ad56e3e.png"></p><br><p>  You will run the console as root. </p><br><p>  If you have one operating system, then in order to display the GRUB boot loader menu, you must hold down the Shift button (or ESC on some computers) during the boot process.  If this does not work, then try booting the computer (when you see the Ubuntu screensaver) and pressing the Reset button on the computer‚Äôs system unit; the next time the GRUB menu is displayed, it will be displayed without any manipulations. </p><br><ol><li> First you need to put the root filesystem into write mode. <br> <code>mount -no remount,rw /</code> </li> <li>  Now, to set a new password, just run the command <br> <code>passwd _</code> <br>  where instead of <code>_</code> substitute the name of the desired user, and then execute <br> <code>reboot</code> <br>  to restart the computer. </li></ol><br><p>  If there is no recovery mode item, then: </p><br><ol><li>  choose a line with your system; </li><li>  press the E key; </li><li>  add the word single to the end of the kernel options; </li><li>  press the B key. </li></ol><br><p>  The same terminal will be loaded with superuser rights. </p><br><h3 id="scenariy-2-menyu-vybora-operacionnyh-sistem-grub-nedostupno">  Scenario 2. The GRUB operating system selection menu is not available. </h3><br><p>  If you have for some reason turned off the choice of operating systems at startup, then the password can be reset using any Live CD with Linux.  To do this, you need to boot from the Live CD, mount your root partition, and then reset the password to the user by editing the etc / shadow file on this section. </p><br><blockquote>  <em>Note: Generally speaking, no Ubuntu tools can set an empty password to a user.</em>  <em>All graphical utilities require a password of at least 6 characters, and the passwd program can set any password other than empty.</em>  <em>However, you can reset the user's password, then it will be possible to log in without a password.</em> <br><br>  <em>Note: The ability to enter a blank password is not in vain.</em>  <em>A blank password is a huge potential security hole.</em> </blockquote><p>  We will need to change the system file / etc / shadow, so it is highly recommended to make a backup before performing further actions: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sudo</span></span> cp /etc/shadow /etc/shadow.bak</code> </pre> <br><p>  Now, in any text editor as root, open the / etc / shadow file, find the line starting with the username of the desired user, and delete everything between the first and second colon in this line.  For example, there was this line: </p><br><pre> <code class="hljs perl">admin:$6$eZ1pQKRK$tGvrlJnV7NU/anEFoxRCluIbe5kSNE2x2uqRrw62xHVrQPWKKbfYZ0cvdmgxXAcrGxBngPM7HnrrKxdmNwp<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">14371</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">99999</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>:::</code> </pre> <br><p>  To remove a password, the admin user needs to bring it in both files to the form: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">admin</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::14371</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:0</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:99999</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:7</span></span>:::</code> </pre> <br><p>  After that, the admin user password will be reset. </p><br><p>  Now you can reboot into our system and log in without a password.  Do not forget to set a normal password for the administrator after resetting. </p><br><h2 id="kak-sbrosit-parol-os-windows-10">  How to reset the password of Windows 10 </h2><br><p>  Consider two scenarios for resetting a local user password in Windows 10. </p><br><h3 id="scenariy-1-podmena-ispolnyaemogo-fayla">  Scenario 1. Executable file spoofing. </h3><br><p>  To use this method, you need one of the following: Live CD with the ability to download and access the computer's file system, recovery disk (USB flash drive) or Windows 10, 8.1 or Windows 7 distribution kit. Next, resetting the password using Windows recovery tools on the installation flash drive will be discussed. </p><br><p>  The first step is to boot from one of the specified drives.  After the installation language has been loaded and appears, press Shift + F10.  This will bring up the command line.  If nothing of the kind appears, you can on the installation screen, after choosing a language, select System Recovery at the bottom left, then go to Troubleshooting - Advanced Options - Command Line. </p><br><p>  In the command line, enter the following command in sequence (press Enter after input): </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">diskpart</span></span> list volume</code> </pre> <br><p><img src="https://habrastorage.org/files/dbb/13a/be6/dbb13abe61f04b49b1edd1d137c95ccc.png"></p><br><p>  You will see a list of partitions on your hard disk.  Find the letter of the partition on which Windows 10 is installed. Type Exit and press Enter to exit DiskPart.  Using the letter of the section (C) in the commands, you should enter further: </p><br><p> <code>move c:\windows\system32\utilman.exe c:\windows\system32\utilman2.exe</code> <br> <code>copy c:\windows\system32\cmd.exe c:\windows\system32\utilman.exe</code> </p> <br><p><img src="https://habrastorage.org/files/c6e/586/56b/c6e58656bb1747a9b9bef7e54e52790b.png"></p><br><p>  If everything went well, enter the wpeutil reboot command to restart the computer (you can reboot in a different way).  This time, boot from your system disk, not from a bootable flash drive or disk. </p><br><blockquote>  <em>Note: if you did not use the installation disk, but something else, then your task using the command line, as described above, or by other means, make a copy of cmd.exe in the System32 folder and rename this copy to utilman.exe.</em> </blockquote><p>  After loading, in the password entry window, click on the ‚ÄúSpecial features‚Äù icon at the bottom right.  The Windows 10 command prompt opens. </p><br><p>  At the command prompt, type net user username new_password and press Enter.  If the username consists of several words, use quotes.  If you do not know the username, use the net user command to view a list of Windows 10 usernames. After changing the password, you can immediately log in to the account with a new password. </p><br><h3 id="scenariy-2-pravka-reestra">  Scenario 2. Editing the registry. </h3><br><p>  There is another interesting, simple and working way to reset your password.  It also requires either a bootable distribution with the OS, or a recovery disk, or a third-party Live CD with registry editing tools. </p><br><p>  The essence of the method is as follows: </p><br><ol><li>  Boot from the drive, in the installation program, press Shift + F10 to open the command line. </li><li>  Enter regedit and press Enter to start the registry editor. </li><li>  In the Registry Editor, select the HKEY_LOCAL_MACHINE key and then select ‚ÄúFile‚Äù - ‚ÄúLoad hive‚Äù in the menu and open the file C: \ Windows \ System32 \ config \ system </li><li>  When requesting a section name, specify any. </li><li>  Inside the HKEY_LOCAL_MACHINE of the loaded hive (registry key) with the name you specified, select the setup key and in the right part, change the following values ‚Äã‚Äã(by double clicking on them). </li><li>  CmdLine - set the value of cmd.exe <br><img src="https://habrastorage.org/files/4a2/85f/2af/4a285f2af3fc4551bbf3b29451fadfd6.png"></li><li>  SetupType - set the value to 2. </li><li>  In the Registry Editor, select "File" - "Unload Hive" and confirm the unloading. <br>  After that, close the registry editor, the command line, exit the installation program and boot from the hard disk of the computer.  When you boot into Windows 10, a command prompt opens in which you can reset the password by typing: <br> <code>net user _ _</code> </li> </ol><br><p>  To continue booting the OS, type exit in the command line and press Enter.  There is no need to reset the parameters in any way: the SetupType parameter in the registry will return to the value 0. </p><br><h2 id="chto-eto-bylo">  What was it? </h2><br><p>  This is where issues of the environment and confidence in it emerge. <br>  So what happened above? </p><br><p>  In fact, we removed the operating system from the management and loaded another medium (from the live media or bootloader), which provided us with access to the system media in order to overwrite (reset) the hashes of forgotten passwords. </p><br><p>  Conceptually, this means that a computer system, like a building, is built on a foundation (and not just one), and if security is not ensured at the lowest level, everything will collapse regardless of wall thickness and signaling reliability on the 110th floor. </p><br><p>  In IT, we are actually talking about nested environments; each component is executed inside (in the environment) of a component of a lower level, using its services.  For example, the browser uses operating system calls to allocate memory for a web page, opening / closing ports for network connections. </p><br><p>  Below is the nesting hierarchy of system environments, the task of completely systematizing them was not: </p><br><p><img src="https://habrastorage.org/files/b52/298/cf4/b52298cf4f0a43e6b3a3b27ba8b9632e.png"></p><br><p>  Accordingly, if there is an incorrect configuration or vulnerability of a component of the lower level, such as an error in the BIOS microcode, then closing it at a higher level (for example, at the ‚Äúhost‚Äù OS ‚Äùlevel) is either difficult or almost impossible.  In general, it is as unpromising as it is to hope to seal cracks in the walls of a building with a leaning foundation. </p><br><p>  How do we get a reliable building?  In IT, this is called trusted systems or a trusted platform / platform. </p><br><p>  The concept of ‚Äútrusted environment‚Äù does not currently have an established definition, specialists cannot agree on opinions, and strictly speaking, the term ‚Äútrusted‚Äù is not defined in the regulatory framework.  The concept of "trusted environment" appeared after the "trusted system", introduced back in 1983.  in the so-called Orange Book ( <a href="http://csrc.nist.gov/publications/history/dod85.pdf">TSSEC - Trusted Computer System Evaluation Criteria</a> ), which was the source material for a number of governing documents of the State Technical Commission of the Russian Federation, for example, the <a href="http://fstec.ru/tekhnicheskaya-zashchita-informatsii/dokumenty/114-spetsialnye-normativnye-dokumenty/384-rukovodyashchij-dokument-reshenie-predsedatelya-gostekhkomissii-rossii-ot-30-marta-1992-g">RD AS</a> . </p><br><p>  A trusted system in the standard is a system that uses hardware and software to ensure that a group of users simultaneously process information of different categories of secrecy without violating access rights. </p><br><p>  One of the technical means to ensure a trusted system is a trusted boot tool.  The main function of trusted boot is to boot the system only from predefined media, after successfully completing the integrity check and confirming its credentials, by identifying and authenticating the user. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  In the next articles we will look at ways to protect against the attacks described above using the trusted boot mechanism. To do this, we will study the classic scenario of computer loading and, in general, understand how conceptually the protected systems are built.  Consider the loading of a computer using the means of trusted boot (SDZ) and compare SDZ with the Secure Boot protocol (UEFI). </p><br><h2 id="literatura">  Literature </h2><br><ol><li>  GOST R 54583-2011 / ISO / IEC / TR 154443-3: 2007.  Information technology.  Security measures and means.  M .: Standardinform.  2013 .; </li><li>  GOST R ISO / IEC 15408-3-2002.  Information technology.  Methods and means of security.  Criteria for assessing the security of information technology.  Part 3. Security trust requirements; </li><li>  Tsirlov V.L.  Basics of information security of automated systems, a short course.  - Rostov-on-Don: Phoenix, 2008. - 253 p .; </li><li>  Avezova Ya.E., Fadin A.A.  Issues of ensuring trusted boot in physical and virtual environments // Cyber ‚Äã‚ÄãSecurity Issues.  2016. ‚Ññ 1 (14).  Pp. 24-30; </li><li>  Windows registry information for advanced users, <a href="https://support.microsoft.com/ru-ru/help/256986/windows-registry-information-for-advanced-users">https://support.microsoft.com/ru-ru/help/256986/windows-registry-information-for-advanced-users</a> ; </li><li>  User documentation on Ubuntu, <a href="http://help.ubuntu.ru/wiki/%25D0%25BF%25D1%2583%25D1%2581%25D1%2582%25D0%25BE%25D0%25B9_%25D0%25BF%25D0%25B0%25D1%2580%25D0%25BE%25D0%25BB%25D1%258C">http://help.ubuntu.ru/wiki/power_password</a> ; </li><li>  Trusted Computer System Evaluation Criteria, <a href="http://csrc.nist.gov/publications/history/dod85.pdf">http://csrc.nist.gov/publications/history/dod85.pdf</a> ; </li><li>  Guidance document.  Automated systems.  Protection against unauthorized access to information.  Classification of automated systems and information security requirements.  M .: State Technical Commission of Russia, 1992. </li></ol></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/324178/">https://habr.com/ru/post/324178/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../324166/index.html">Liscript - REPL bots online</a></li>
<li><a href="../324170/index.html">Names or semantics of classes in programming</a></li>
<li><a href="../324172/index.html">Filtering and chaining in functional JavaScript</a></li>
<li><a href="../324174/index.html">What should we build an email marketing service? An inside look, part two</a></li>
<li><a href="../324176/index.html">Create a web application using VueJS and .NET</a></li>
<li><a href="../324180/index.html">Glitch - a new approach to application development</a></li>
<li><a href="../324182/index.html">We solve standard problems for PM on projects. Part 1</a></li>
<li><a href="../324184/index.html">9 interesting services for the web designer. Special selection</a></li>
<li><a href="../324188/index.html">DEV Labs 2017. Online conference for Java and Web developers. March 25</a></li>
<li><a href="../324190/index.html">Haskell: about one method of implementing functions with a variable number of parameters</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>