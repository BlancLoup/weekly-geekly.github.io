<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AUTOSTOP - script to protect the flash drive from autorun-viruses</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I propose my version of the fight against autorun-viruses on flash drives, because Current solutions do not suit me for several reasons. 

 The main e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AUTOSTOP - script to protect the flash drive from autorun-viruses</h1><div class="post__text post__text-html js-mediator-article">  I propose my version of the fight against autorun-viruses on flash drives, because  Current solutions do not suit me for several reasons. <br><br>  The main existing methods can be divided into 3 categories: <br><ul><li>  The installation of a resident monitor on the computer, which, when a flash drive is connected, checks for the presence of the autorun.inf file, and if so, takes action.  Minus - binding to a specific machine </li><li>  Protecting a flash drive with the NTFS rights method is an excellent reinforced concrete method, but its advantages are at the same time its disadvantages - NTFS is not always applicable (for example, in the case of Win9x, or a specific model of car radio or DVD player that read only FAT). </li><li>  The method for creating the AUTORUN.INF directory on the flash drive of the same name.  Of the minuses it can be noted that new viruses have learned to delete this directory, or rename it if it is impossible to remove </li></ul><br>  It was the third method that was taken by me as a basis, and refined.  Outwardly, everything looks like this: <br><br><img src="http://mechanicus.users.photofile.ru/photo/mechanicus/95275418/105281663.gif" alt="Indication">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The principle of the script is as follows: <br><a name="habracut"></a><br>  2 directories are created on the flash drive: AUTORUN.INF and AUTOSTOP.  Each of them is protected from deletion by creating subdirectories with ‚Äúincorrect‚Äù names: <br><br> <code>mkdir "\\?\%~d0\AUTORUN.INF\LPT3" <br> mkdir "\\?\%~d0\AUTORUN.INF\LPT3\.."</code> <br> <br>  With the same attempt to rename the AUTORUN.INF directory with a virus, I am fighting as follows: in the above directory, a <b>desktop.ini</b> file is created with the following content: <br><br> <code>[.ShellClassInfo] <br> IconFile="..\AUTOSTOP\disable.ico" <br> IconIndex=0 <br> InfoTip="  AUTOSTOP" <br></code> <br><br>  The disable.ico icon is placed in the AUTOSTOP directory (in the AUTOSTOP directory itself, a desktop.ini of similar content is created, with a link to the enable.ini icon located in the AUTORUN.INF directory). <br><br>  Thus, the two directories mentioned above result in a ‚Äúround robin‚Äù: when renaming the AUTORUN.INF folder, the indicator icon on the AUTOSTOP folder disappears (see figure), which indicates that the autorun virus has infected the flash drive (i.e., there is a file on the flash drive autorun.inf) and that the computer to which the USB flash drive is currently connected is infected. <br><br>  For objectivity, from inconvenience, I note the need to press F5 in the explorer after connecting the USB flash drive, and before removing it (to update the contents of the USB flash drive, and, therefore, the status of the indicators). <br><br>  The script page in my LiveJournal is <a href="http://mechanicuss.livejournal.com/195192.html">mechanicuss.livejournal.com/195192.html</a> , the download link is also there (I don‚Äôt give a direct link, because I regularly modify and update the script by adding the version number to the file name). <br><br>  For those who ask why they should foster such vegetable gardens - you can use other, simpler and more reliable methods, I will say the following: <br><ul><li>  I want to show that ‚Äúyou can still beat the fascist‚Äù in alternative ways (any alternative is a plus). </li><li>  I love logical tasks, and working on a script is an excellent gymnastics for the mind. </li><li>  The method invented by me (cross-references to icons) can be taken as a basis in many other applied developments. </li></ul><br><br>  - - - - - - - - - - - - - - - - - - - - - - - - - - - <h2>  UPD: </h2><br>  Thanks to the idea of <a href="https://habrahabr.ru/users/floppyformator/" class="user_link">FloppyFormator</a> , which consists in using one directory and the absolute path to the icon ( <font color="green">IconFile = ".. \ AUTORUN.INF \ minus.ico</font> ), the display has been improved, and version 2.1 of the script has been written. Now everything looks like this - much easier and more convenient: <br><br><img src="http://mechanicus.users.photofile.ru/photo/mechanicus/95320970/105325125.gif"><br><br>  I also want to sincerely thank <a href="https://habrahabr.ru/users/dreamhelg/" class="user_link">dreamhelg</a> for the invite, and dedicate version 2.1 to it (release date - March 8 :) <br><br>  Friends, thank you for your attention to the script and ideas for its improvement - thanks to this, the effect of using the script increases. </div><p>Source: <a href="https://habr.com/ru/post/53642/">https://habr.com/ru/post/53642/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../53633/index.html">Open Source gurus go to Microsoft</a></li>
<li><a href="../53634/index.html">Torvalds is now responsible for linux.com</a></li>
<li><a href="../53638/index.html">On-line conference with copywriter Dmitry Kot</a></li>
<li><a href="../53640/index.html">Barcamp Caspian 2009</a></li>
<li><a href="../53641/index.html">Two Tao implementations</a></li>
<li><a href="../53644/index.html">Ecology of business: a few words about the work of file-sharing hosting, or "do not spit in the well"</a></li>
<li><a href="../53647/index.html">Single moose</a></li>
<li><a href="../53649/index.html">Protection against content thieves</a></li>
<li><a href="../53652/index.html">Twitter - search - Google: associative links of new realities?</a></li>
<li><a href="../53653/index.html">Habr's botnetization - instruction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>