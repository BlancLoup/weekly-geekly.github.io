<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SDL2: Basics</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unfortunately, even on the official wiki, it is almost impossible to find any examples of using SDL2.x, what can we say about runet. Trying to figure ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SDL2: Basics</h1><div class="post__text post__text-html js-mediator-article">  Unfortunately, even on the official wiki, it is almost impossible to find any examples of using SDL2.x, what can we say about runet.  Trying to figure it out, I found only a couple of articles that a third of my questions did not cover either. <br>  SDL 2.x is significantly different from 1.x and even if in the past you had to work with it, now you risk not understanding anything. <br><br>  Today we will write a simple program that displays the background and zoomed sprite of a character moving with WASD and arrows.  + We will understand how to work with the mouse in SDL. <br><a name="habracut"></a><br>  <u>To work we need</u> : <br><ul><li>  SDL2.h </li><li>  SDL2_image.h </li><li>  SDL2_mixer.h </li></ul><br>  All this can be easily found on the Internet. <br><br>  Let's start from the beginning: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>SDL Initialization</b> </h4><br>  Let's begin, perhaps, with creation of object of class <b>SDL_DisplayMode</b> . <br>  It is very useful to us if we want to have an application for the whole screen. <br>  This object must be created before initializing the SDL itself. <br><br><pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">SDL_DisplayMode</span></span> displayMode;</code> </pre> <br><br>  After that, you need to <b>initialize</b> the SDL itself: <br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (SDL_Init(SDL_INIT_EVERYTHING) != <span class="hljs-number"><span class="hljs-number">0</span></span>){ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"SDL_Init Error: "</span></span> &lt;&lt; SDL_GetError() &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br><br>  The <code>SDL_INIT_EVERYTHING</code> flag initializes all SDL subsystems.  If you just need something specific, you can find a complete list on the wiki. <br><br>  Now we need to <u>get the monitor settings</u> we work with. <br>  To do this, we create an variable in which 0 will be returned if everything went well and equate it with the functions <code>SDL_GetDesktopDisplayMode(*int displayIndex, SDL_DisplayMode* mode)</code> . <br>  If the first argument is written 0, then the function will refer to the main monitor.  We will be able to read all the received parameters from the <code>displayMode</code> object. <br><pre> <code class="hljs lisp"> int request = SDL_GetDesktopDisplayMode(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-symbol"><span class="hljs-symbol">&amp;displayMode</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code> </pre> <br><br>  It's time to do our <b>window</b> ! <br>  It's all very simple, create a pointer to an object of the <code>SDL_Window</code> class and call the function <br><pre> <code class="hljs objectivec">SDL_Window* SDL_CreateWindow(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* title, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> w, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> h, Uint32 flags)</code> </pre> <br><br>  Everything here is of course clear, but just in case I will explain what's what. <br><ul><li>  title is the name of the window. </li><li>  x, y - coordinates of the window.  If you want to open in full screen, then you need to set <code>0,0</code> </li><li>  w, h - window size.  In <code>displayMode</code> to open the screen, we turn to the <code>displayMode</code> object. </li><li>  flags - here we set the window initialization flags.  You can say that I'm <s>stupid</s> wrong and there is a flag <code>SDL_WINDOW_FULLSCREEN</code> , and here I am inventing a bicycle with my <code>DisplayMode</code> , but no! <br>  By <s>scientifically</s> productive experiments, I noticed that this method is much faster and does not respond to antiviral programs.  At the same <code>SDL_WINDOW_FULLSCREEN</code> avast shouted that they were trying to hack me. </li></ul><br>  SDL_WINDOW_SHOWN - makes the window visible. <br><br>  As a result, the output is the following code: <br><pre> <code class="hljs cpp">SDL_Window *win = SDL_CreateWindow(<span class="hljs-string"><span class="hljs-string">"Hello World!"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, displayMode.w, displayMode.h, SDL_WINDOW_SHOWN); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (win == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>){ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"SDL_CreateWindow Error: "</span></span> &lt;&lt; SDL_GetError() &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br><br>  Now we need to create a <b>renderer</b> : <br><pre> <code class="hljs pgsql">SDL_Renderer* SDL_CreateRenderer(SDL_Window* <span class="hljs-keyword"><span class="hljs-keyword">window</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>, Uint32 flags)</code> </pre> <br><ul><li>  window - the window in which we will work. </li><li>  index - the index of the driver that will use the render.  If you set <code>-1</code> , then the render will use the first suitable driver. </li><li>  flags - render flags.  Full list as always on the wiki. <br>  I will use <code>SDL_RENDERER_ACCELERATED</code> responsible for hardware acceleration and <code>SDL_RENDERER_PRESENTVSYNC</code> responsible for vertical synchronization. </li></ul><br>  Putting it all together and get: <br><pre> <code class="hljs cpp">SDL_Renderer *ren = SDL_CreateRenderer(win, <span class="hljs-number"><span class="hljs-number">-1</span></span>, SDL_RENDERER_ACCELERATED | SDL_RENDERER_PRESENTVSYNC); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ren == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>){ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"SDL_CreateRenderer Error: "</span></span> &lt;&lt; SDL_GetError() &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br>  Now SDL is ready to cooperate with us! <br><br><h4>  <b>Output on display</b> </h4><br>  It's time to take pictures. <br>  First we need to create 2 objects of the <code>SDL_Rect</code> class. <br>  This object will contain the physical parameters of our textures, such as width, height, and position in the window. <br><pre> <code class="hljs ruby">SDL_Rect player_RECT; player_RECT.x = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    player_RECT.y = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   Y player_RECT.w = <span class="hljs-number"><span class="hljs-number">333</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  player_RECT.h = <span class="hljs-number"><span class="hljs-number">227</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  SDL_Rect background_RECT; background_RECT.x = <span class="hljs-number"><span class="hljs-number">0</span></span>; background_RECT.y = <span class="hljs-number"><span class="hljs-number">0</span></span>; background_RECT.w = displayMode.w; background_RECT.h = displayMode.h;</code> </pre><br>  And a couple of lines, so that later we could zoom our character: <br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> player_WIGHT = <span class="hljs-number"><span class="hljs-number">333</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   const int player_HEIGH = 227; //   double TESTtexture_SCALE = 1.0; //  </span></span></code> </pre> <br><br>  And so we got to download textures. <br>  I will show 2 ways: <br><br>  But first, a small digression! <br>  I think those who used to work with SDL1.x didn‚Äôt need explanations, but I‚Äôll tell you how the SDL works, all of a sudden (maybe you never know) someone is not familiar with it. <br>  In SDL there are 4 main classes / structures involved in displaying images on the screen: <u><code>SDL_Texture</code> , <code>SDL_Surface</code> , <code>SDL_Rect</code> , <code>SDL_Render</code></u> . <br><br>  We have already talked about the last 2, let's now briefly discuss the remaining ones. <br><ul><li>  <code>SDL_Surface</code> - working with <code>SDL_mixer.h</code> you can forget about it.  But it‚Äôs silly to work with something without having any idea how it works. <br><div class="spoiler">  <b class="spoiler_title">Details</b> <div class="spoiler_text">  The object of this structure allows you to load into yourself any BMP image for further translation into texture.  However, its unmodifiable use entails limitations. <br><br>  <u>As an example:</u> pure <b>SDL works only with BMP</b> , which supports the alpha channel, only in 32-bit color, and it is not supported for this format on every OS.  And here all benefit from SDL cross-platform is lost. </div></div></li><li>  <code>SDL_Texture</code> - <code>SDL_Texture</code> creating an object of the <code>SDL_Surface</code> structure, we have to turn it into a texture so that the render can do it. </li></ul><br>  After that, this object is sent to the render: <br><pre> <code class="hljs lisp">SDL_RenderCopy(<span class="hljs-name"><span class="hljs-name">SDL_Renderer*</span></span> renderer, SDL_Texture* texture, const SDL_Rect* srcrect, const SDL_Rect* dstrect) SDL_RenderPresent(<span class="hljs-name"><span class="hljs-name">SDL_Renderer*</span></span> renderer)</code> </pre> <br><br>  Well, with the theory figured out, it's time to practice! <br><br>  <u>Option number ONCE:</u> <br>  This method is tied to the libraries <code>SDL_mixer.h</code> and <code>SDL_Image.h</code> , so do not <s>shout at me</s> be surprised when errors will flow to you by connecting only SDL2. <br><br>  Its peculiarity is that it transmits an alpha channel without bicycles. <br><pre> <code class="hljs lisp">SDL_Texture *player = IMG_LoadTexture(<span class="hljs-name"><span class="hljs-name">ren</span></span>,<span class="hljs-string"><span class="hljs-string">"..\\res\\player.png"</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code> </pre> <br>  Now we have the character texture ready to appear on the screen.  But before that, we still need to create a background. <br><br>  <u>Option number TWO:</u> <br>  We will create the background using pure SDL.  Just because we can! <br><div class="spoiler">  <b class="spoiler_title">Code here!</b> <div class="spoiler_text"><pre> <code class="hljs ruby">SDL_Surface *BMP_background = SDL_LoadBMP(<span class="hljs-string"><span class="hljs-string">"..\\res\\background.bmp"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (BMP_background == nullptr){ std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"SDL_LoadBMP Error: "</span></span> &lt;&lt; SDL_GetError() &lt;&lt; std::endl; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } SDL_Texture *background = SDL_CreateTextureFromSurface(ren, BMP_background); SDL_FreeSurface(BMP_background); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (player == nullptr){ std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"SDL_CreateTextureFromSurface Error: "</span></span> &lt;&lt; SDL_GetError() &lt;&lt; std::endl; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre></div></div><br>  When working with pure SDL, you should never forget to check for errors! <br><br>  And finally, Hurray, it's time <b>to bring it to the screen!</b> <br><pre> <code class="hljs dos">SDL_RenderClear(<span class="hljs-built_in"><span class="hljs-built_in">ren</span></span>); //  SDL_RenderCopy(<span class="hljs-built_in"><span class="hljs-built_in">ren</span></span>,background,NULL,&amp;background_RECT); //    SDL_RenderCopy(<span class="hljs-built_in"><span class="hljs-built_in">ren</span></span>, player, NULL, &amp;player_RECT); //    SDL_RenderPresent(<span class="hljs-built_in"><span class="hljs-built_in">ren</span></span>); //!!</code> </pre> <br><br><h4>  <b>Developments</b> </h4><br>  I think it is not necessary to explain that from 2 pictures of the game will not work. <br>  Time to add some dynamics to our miracle! <br><br>  First you need to create a couple of infinite loops that work while there are events and there is no way out: <br><pre> <code class="hljs cs">SDL_Event <span class="hljs-keyword"><span class="hljs-keyword">event</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> quit = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!quit) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(SDL_PollEvent(&amp;<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>)) { SDL_PumpEvents(); <span class="hljs-comment"><span class="hljs-comment">//  . }</span></span></code> </pre> <br><br>  It's time to do events directly. <br>  In SDL, there are 2 ways to read events from controllers: <br><ul><li>  <u>The first way</u> we implement the work with the mouse. <br>  But first, let's add a couple of lines before the cycles: <br><pre> <code class="hljs objectivec">SDL_Texture* ARRAY_textures[<span class="hljs-number"><span class="hljs-number">2</span></span>] = {background, player}; SDL_Rect* ARRAY_rect[<span class="hljs-number"><span class="hljs-number">2</span></span>] = {&amp;background_RECT, &amp;player_RECT}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ARRAY_texturesState[<span class="hljs-number"><span class="hljs-number">2</span></span>] = {<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>};</code> </pre> <br>  This is useful to us to be able to display or not to display a particular texture. <br>  And now we insert this code into the inner loop. <br><div class="spoiler">  <b class="spoiler_title">The code is not CAKE, it's true here!</b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.type == SDL_QUIT) <span class="hljs-keyword"><span class="hljs-keyword">quit</span></span>=true; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.type == SDL_MOUSEBUTTONDOWN) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> == SDL_BUTTON_LEFT &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>.x &lt;=<span class="hljs-number"><span class="hljs-number">10</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>.y &lt;=<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">quit</span></span> = true; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> == SDL_BUTTON_RIGHT) ARRAY_texturesState[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> == SDL_BUTTON_LEFT) &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>.x &gt;= player_RECT.x) &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>.y &gt;= player_RECT.y) &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>.x &lt;= player_RECT.w + player_RECT.x) &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>.y &lt;= player_RECT.h + player_RECT.y)) ARRAY_texturesState[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> </div></div><br>  I think this does not require explanation if you have carefully read and programmed for more than <i>21 days</i> , but I‚Äôll clarify that <code>event.button.button</code> waiting for a special SDL flag that you can easily find on the wiki, and <code>event.type</code> waiting for a flag about the type of event , a complete list of which is all there! <br><br>  We can already close the window by clicking on the upper left corner of the screen!  And even more than that, we can remove and return a character when we want just by clicking on it! <br>  Yes, I also feel how the feeling of power begins to overwhelm us, but not the time to stop, there is still a keyboard ahead! <br><br></li><li>  The second way: <br>  First, before the loop, we need to create one constant: <br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Uint8 *keyboardState = SDL_GetKeyboardState(<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>);</code> </pre> <br>  She needs to keep track of the state of the buttons. <br><br>  Even outside our main function, we need to add a lot of code that will make our program more structured. <br>  (I see someone has already started writing about the need to use classes and libraries, but I want to remind you that this tutorial will not be good if a person gets confused when collecting code, so we will write everything as simple as possible. I apologize to those whose feelings I hurt!) <br><br><div class="spoiler">  <b class="spoiler_title">Lots and lots of code</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">void</span></span> move_UP (SDL_Renderer* render, SDL_Texture* texture, SDL_Rect &amp;destrect, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">offset</span></span> = <span class="hljs-number"><span class="hljs-number">5</span></span>) { destrect.y -= <span class="hljs-keyword"><span class="hljs-keyword">offset</span></span>; SDL_RenderClear(render); SDL_RenderCopy(render, texture,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>,&amp;destrect); } <span class="hljs-type"><span class="hljs-type">void</span></span> move_DOWN (SDL_Renderer* render, SDL_Texture* texture, SDL_Rect &amp;destrect, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">offset</span></span> = <span class="hljs-number"><span class="hljs-number">5</span></span>) { destrect.y += <span class="hljs-keyword"><span class="hljs-keyword">offset</span></span>; SDL_RenderClear(render); SDL_RenderCopy(render, texture,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>,&amp;destrect); } <span class="hljs-type"><span class="hljs-type">void</span></span> move_LEFT (SDL_Renderer* render, SDL_Texture* texture, SDL_Rect &amp;destrect, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">offset</span></span> = <span class="hljs-number"><span class="hljs-number">5</span></span>) { destrect.x -= <span class="hljs-keyword"><span class="hljs-keyword">offset</span></span>; SDL_RenderClear(render); SDL_RenderCopy(render, texture,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>,&amp;destrect); } <span class="hljs-type"><span class="hljs-type">void</span></span> move_RIGHT(SDL_Renderer* render, SDL_Texture* texture, SDL_Rect &amp;destrect, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">offset</span></span> = <span class="hljs-number"><span class="hljs-number">5</span></span>) { destrect.x += <span class="hljs-keyword"><span class="hljs-keyword">offset</span></span>; SDL_RenderClear(render); SDL_RenderCopy(render, texture,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>,&amp;destrect); } <span class="hljs-type"><span class="hljs-type">void</span></span> render_UPDATE(SDL_Renderer* render, SDL_Texture* texture[], SDL_Rect* destrect[], <span class="hljs-type"><span class="hljs-type">int</span></span> states[]) { SDL_RenderClear(render); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(states[<span class="hljs-number"><span class="hljs-number">0</span></span>]) SDL_RenderCopy(render, texture[<span class="hljs-number"><span class="hljs-number">0</span></span>],<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>,destrect[<span class="hljs-number"><span class="hljs-number">0</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(states[<span class="hljs-number"><span class="hljs-number">1</span></span>]) SDL_RenderCopy(render, texture[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>,destrect[<span class="hljs-number"><span class="hljs-number">1</span></span>]); }</code> </pre> </div></div><br><br>  And now we return to the inner loop and add a lot more code: <br><div class="spoiler">  <b class="spoiler_title">Lots and lots of code</b> <div class="spoiler_text"><pre> <code class="hljs ruby"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((keyboardState[SDL_SCANCODE_UP])<span class="hljs-params"><span class="hljs-params">||</span></span>(keyboardState[SDL_SCANCODE_W])) move_UP(ren,player,player_RECT); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((keyboardState[SDL_SCANCODE_DOWN])<span class="hljs-params"><span class="hljs-params">||</span></span>(keyboardState[SDL_SCANCODE_S])) move_DOWN(ren,player,player_RECT); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((keyboardState[SDL_SCANCODE_LEFT])<span class="hljs-params"><span class="hljs-params">||</span></span>(keyboardState[SDL_SCANCODE_A])) move_LEFT(ren,player,player_RECT); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((keyboardState[SDL_SCANCODE_RIGHT])<span class="hljs-params"><span class="hljs-params">||</span></span>(keyboardState[SDL_SCANCODE_D])) move_RIGHT(ren,player,player_RECT); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>ZOOM---------------------------------------------------------------- <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(keyboardState[SDL_SCANCODE_KP_PLUS]) { TESTtexture_SCALE += <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">02</span></span>; player_RECT.h = player_HEIGH * TESTtexture_SCALE; player_RECT.w = player_WIGHT * TESTtexture_SCALE; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(keyboardState[SDL_SCANCODE_KP_MINUS]) { TESTtexture_SCALE -= <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">02</span></span>; player_RECT.h = player_HEIGH * TESTtexture_SCALE; player_RECT.w = player_WIGHT * TESTtexture_SCALE; }</code> </pre> </div></div><br>  Especially nothing new here.  The only thing that was added is the construction of the <code>keyboardState[flag]</code> . <br>  This construction returns <code>true</code> if the button is pressed and <code>false</code> in a callback. <br>  List of flags ... YOU ALREADY TALKED MANY TIMES! </li></ul><br><br>  It remains to display the result on the screen.  To do this, add to the loop: <br><pre> <code class="hljs lisp">render_UPDATE(<span class="hljs-name"><span class="hljs-name">ren</span></span>, ARRAY_textures, ARRAY_rect, ARRAY_texturesState)<span class="hljs-comment"><span class="hljs-comment">; //     SDL_RenderPresent(ren);</span></span></code> </pre> <br>  Close the loop! <br>  And in the end we need only complete our program. <br><br><h4>  <b>A curtain!</b> </h4><br>  Before we finish everything, we need to remove our textures from memory. <br><pre> <code class="hljs lisp">SDL_DestroyTexture(<span class="hljs-name"><span class="hljs-name">player</span></span>)<span class="hljs-comment"><span class="hljs-comment">; SDL_DestroyTexture(background);</span></span></code> </pre> <br><br>  And now you can safely shut down the SDL and programs: <br><pre> <code class="hljs lisp">SDL_DestroyRenderer(<span class="hljs-name"><span class="hljs-name">ren</span></span>)<span class="hljs-comment"><span class="hljs-comment">; SDL_DestroyWindow(win); SDL_Quit(); return 1;</span></span></code> </pre> <br>  Final, ovation!  We wrote the first program on SDL2!  With what I congratulate us! <br><br><h4>  <b>PS</b> </h4><br>  It took me 2 days to create such an elementary program.  There are so few manuals on SDL2 on the Internet that it is easier to shoot yourself than to find something. <br>  I really hope that this article was useful to you and this monster will not take as much time from you as I do. <br><br>  <a href="">Source can be downloaded here.</a> </div><p>Source: <a href="https://habr.com/ru/post/201392/">https://habr.com/ru/post/201392/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../201382/index.html">Live stream from Hackathon - see November 9 and 10</a></li>
<li><a href="../201384/index.html">A virtual Bitcoin-bank inputs.io was robbed by a million dollars</a></li>
<li><a href="../201386/index.html">Flask and file upload: success story</a></li>
<li><a href="../201388/index.html">Dynamic search for potential deadlocks</a></li>
<li><a href="../201390/index.html">Distribution of elephants: Beeline gave free access to its subscribers to the Beeline WI-FI network via the EAP-SIM protocol</a></li>
<li><a href="../201396/index.html">Some useful attributes you might not know about.</a></li>
<li><a href="../201398/index.html">Security of your users: OAuth, SSL, P2P chat with RSA, i2p gate</a></li>
<li><a href="../201400/index.html">Part 1 - Typography. As it was in the Soviet factories</a></li>
<li><a href="../201402/index.html">What does overtime really mean?</a></li>
<li><a href="../201404/index.html">Age of Empires 2 has an add-on (first in 13 years)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>