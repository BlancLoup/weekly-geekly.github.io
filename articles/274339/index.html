<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Network Optimization Practice Stories</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! My colleagues and I optimize the available channels. We are constantly confused with optical seals, sometimes with cable engineers, then, in ge...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Network Optimization Practice Stories</h1><div class="post__text post__text-html js-mediator-article">  Hello!  My colleagues and I optimize the available channels.  We are constantly confused with optical seals, sometimes with cable engineers, then, in general, with loaders. <br><br><img src="https://habrastorage.org/files/ee4/f0b/f66/ee4f0bf66789456e9e7c0cd6833a3810.jpeg"><br><br>  And our work is the analysis of the protocol stack and its complete redesign for the channel features, setting the optimal frame size, collecting several packets on the channel with large latency into one, deduplication, normal compression, SSL parsing and reassembly with the same certificate.  This is solved in the simplest case by installing a special iron on the receiving and transmitting sides.  Since we must get to every point, we also work as field engineers.  And, like any field engineers, our stories are sea.  Below, I will tell you a few, I will only change a number of secondary circumstances so that you cannot recognize the customer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>For example, there are night work in a very large store</b> .  The customer's admin and our engineer went to the server room at one in the morning, they work.  The engineer went to the toilet, returned.  A few minutes later - a knock on the door.  Open - and immediately flies in the GBR with machine guns, immediately with their feet on the body, face into the floor and in handcuffs. <br><br>  Then the police and the main store drive up.  The chief assesses the situation and weightily states: <br>  - I know that this is our admin.  But I do not know.  Take away. <a name="habracut"></a><br>  It ended, fortunately, well.  Admin hissing: <br>  ‚ÄúWe wrote to you!‚Äù <br>  The main one gets the phone, reads: <br>  - There will be night work ... I and such and such ... Ahhh, there you have it, - turns to the police and continues with obvious pity: <br>  - We'll have to let go. <br><br><h4>  Did not notice how it became good </h4><br>  Stuck mobile optimizers on banking machines in one branch.  I must say that the Internet there was so ‚Äúgood‚Äù that we eventually delivered the image of a virtual machine on a disk.  So, in this image was a software agent that works with hardware in this case, in the data center.  They hooked up, distributed trial licenses - and the test deployment began. <br><br>  There is no feedback: well, we think, well, it means that they do not need an optimizer there.  Maybe the channel is corrected.  But!  Three months later they call, they want to complete.  It turned out that the trial was over, and they suddenly noticed how it became bad.  What is interesting is how it became good, they didn‚Äôt even utter a word.  And how bad it became back - users complained about management. <br><br><h4>  Telephone bully </h4><br>  They made a test implementation of network diagnostic systems.  Deployed complex in the data center, he is slowly learning.  And I must say that the local infrastructure grew as a result of the gradual merger of companies, and therefore not very homogeneous.  In a sense, many systems are used, and each shows the situation at its own level, and no one has a whole picture of application traffic. <br><br>  At that moment, they were just launching a new application, which showed itself well in the test segment, but was not yet seen in the industrial network under load.  Implemented, but because of the complex structure, not all IT specialists knew about it.  3-4 days after the service was turned on, problems with ip-telephony began.  A call center was on it.  And calls lost in all directions.  Client.  Half a day they tried to solve the problem with their own means, but they could not catch the cause at all - a floating bug, and then reproduced, then no. <br><br>  Admins knocked us to ask if our diagnostic system can be used as a detective.  There is a "Cascade", he just knows how to disassemble traffic on the fly.  We went into debug mode and began to look for network anomalies. <br><br>  It turned out that the new service used the same ports as the telephony.  New traffic with the same ports began to fall into the priority and crowd out the voice.  After that, we changed the settings for the classification of traffic telephony. <br><br>  A similar situation was in one large call center operator.  The subscriber calls, he hears the operator, but the operator does not.  For more than a month, local networkers were looking for a solution with their own means and forces - I must say that for so long, because the bug was floating, and detecting it was quite nontrivial.  As a result, it came to the Moscow team, more precisely, to their top.  He knocked something on the table and set the deadline.  Contact us.  We brought the same Riverbread diagnostic system.  We collected traffic from different segments - we compared it and in real-time we started watching the voice quality on different segments.  Within 5-6 hours, we found a failed switch that had queues.  There was a strange problem with iron, settings were flying from time to time.  The team already dealt with the body of the hooligan - we just changed the switch, and this completely closed the question. <br><br><h4>  Never update Friday afternoon </h4><br>  With the update, the story was great.  Also a bank, but another one.  Admin updated balancers firmware around 12 at night.  At about two, one of them began silently dropping traffic that he didn‚Äôt like.  Not all.  Random packages.  Found it in a few minutes, when the security guard from Khabarovsk suspected something strange with the transaction.  After another 6 minutes of classic alarm, <a href="http://habrahabr.ru/company/croc/blog/263889/">"X-team, at the exit</a> . <a href="http://habrahabr.ru/company/croc/blog/263889/">"</a>  Moreover, the preliminary diagnosis is a hardware failure in the kernel switch.  As usual, the elevator, the storekeepers with a new switchboard are waiting at the bottom, and cars are waiting for them.  Fortunately, while driving, my colleague, who picked up remotely, figured out and rolled back the balancers' firmware. <br><br><h4>  Power of progress </h4><br>  We put the optimizer in the training mode on the object in the bank.  The local admin was supposed to throw him into battle mode, as he "mastered" with local flows.  Usually from a day to a week for profiling, because there are more features with safes.  There was a need for a small reconnection with a night vigil, so, probably, for two months nothing happened in terms of switching.  Zhelezka received her copy of the traffic and patiently studied.  The bank was in the process of purchasing in several stages, so the main admin used this license for another object.  Like, here and so well so far, closer to the peak set. <br><br>  And then they dropped (and very seriously) the ground channel (and, maybe, it did not fall, and the admin knew about the fact that he would have to change - and therefore did not cut the optimizer in the period when he would have to live without a reserve).  They jumped to the satellite.  The teleport was right on the roof, it was used several times already, therefore, logically, there should be no problems.  It was supposed to wait on it for two weeks until the new land line was let down.  But in the time that has passed since the last long sitting on the satellite, the butt has been slightly updated and has become more demanding of the strip. <br><br>  Simply put, work software has become bad. <br><br>  A day later, customers came.  The service went slowly, the people were confused about who was behind whom, they looped around the queues and were not bad at all being virtualized, occupying several of them at once.  Virtual visitors in the bank stood at three hundred, physical - four times less.  About once every three hours, this entire system of queues had a kernel panic, and it threatened to get to a fight. <br><br>  We urgently requested another license to sell.  So we learned the whole story.  Further, technical progress helped people solve their problems. <br><br><h4>  Thank you, guys </h4><br>  Base replication between Moscow and a very distant Russian city.  The band is a satellite.  Traffic chases compressed base, jerks, non-optimal packets, often lost.  We have proposed optimizers.  With them, replication went faster, the queues of requests did not accumulate, the band (as usual) utilized much more.  But there was still room to grow.  The main point - we really did not like that the compressed base replicated.  Compressed disassemble and accelerate - sense only a few percent.  It was much better to drive a raw base so that the glands themselves could take it apart. <br><br>  The raw base could not be driven for some reason, it did not go beyond the firewall.  We dig deeper in the settings, and after a couple of days, the raw combat base began to fly normally.  Here, the standard capabilities of their hardware were connected, the processor time (leaving for compression) was released - from 27 hours for replication, they began to hit 23. While we were doing 12-14 with optimizers.  And here we are told that everything, thank you, guys, the task was to meet the SLA.  Already fit.  Your optimizers are cool, but for now it's enough. <br><br>  So we ourselves during the execution of the order canceled this order. <br><br><h4>  Server per bottle </h4><br>  We are doing a pilot implementation of the Riverbed‚Äôs traffic optimizer at one particularly large industrial facility.  The device is large, full rack.  The server at the facility on the second floor, and on the first floor, the shop itself, fittings sticking out, are walked by tough grimy men.  Under the server some administrative unit, there is accounting and control. <br><br>  So, we are going through this workshop, and here, from one of the machines, two directly pronounced representatives of the working class are taxiing out.  As it should be - on the face there are traces of either paint or fuel oil in the form of glasses, scratched helmets on their heads.  They say: <br>  - Listen, can you have a piece of iron while you‚Äôre not shooting? <br>  We: <br>  - In terms of?  We are just behind her. <br>  One hesitated: <br>  - And how much does it cost? <br>  The question, of course, was very alarming.  Trying to gain time: <br>  - We have no right to discuss the terms of the contract with you. <br>  The second worker immediately goes to work: <br>  - Well approximately?  We want to buy it ourselves. <br>  Here we are a little horny.  The men did not quite correctly interpret our silence, and decided that everything can be started to bargain: <br>  - Well ... for the box of vodka give? <br><br>  We somehow got rid of them, explained that the optimizer costs several tens of thousands of dollars and quickly reached the server room.  There they began to find out what it was. <br><br>  It turned out that this is not just hard workers, but operators of automated workplaces who are responsible, in particular, for reporting.  And they have such vital periods when they come to work in this administrative block.  There is their ERP, where you need to drive data.  DSL channel, moreover, from those that are not very far from ISDN.  Thin, noisy as an empty freight train, gives away the legacy of the 90s, in general - factory classics.  A modern application, "talkative", chasing a bunch of encrypted traffic.  Therefore, the lag between clicking on the drop-down list and displaying it is 10-20 seconds.  Best case scenario.  And to drive in there hoo how much everything.  The situation is somewhat aggravated by the fact that they knock with one finger and often make mistakes, so you have to go back.  That does not add much joy because of all the same lags. <br><br>  So, they learned that the miracle piece of iron that was dragged with fanfare through the entire plant to the second floor is a traffic optimizer.  In general, they would not understand anything if they did not stand behind the backs of those who tested this device in the next room, where the same riverbird was connected to the pilot.  At that moment they immediately realized everything and asked for a couple of days there for a detailed test.  They were let out. <br><br>  As a result, they for the last 2 days of April made all the necessary report.  This made them very impressed, because a couple of past years they hung out at the factory during the May holidays until at least the 6th.  As a result, they decided that it would be necessary to buy such a piece of iron, maybe even for their own, to be thrown off the salary.  I did not want to stay overtime even if you burst. <br><br>  Naturally, they just did not expect such prices. <br><br>  After a couple of hours we go out to tell the movers that everything is ready, you can take.  At the exit, two of our heroes are already waiting: <br>  - Guys, and let's leave it for tests for another month, eh?  BOX give. <br><br>  What ended - I do not know.  Management of the holding after the test implementation bought a few dozen iron optimizers.  Whether I got a piece of iron to our guys in the end or not, I can‚Äôt say, but I really want to believe that I‚Äôve got it.  Well, or at least they have installed a software agent that can respond to the ‚Äúbig‚Äù server. <br><br><h4>  References: </h4><br><ul><li>  <a href="http://habrahabr.ru/company/croc/blog/214693/">How does all this music work</a> </li><li>  <a href="http://habrahabr.ru/company/croc/blog/215585/">A specific example of a network anomaly search</a> </li><li>  <a href="http://habrahabr.ru/company/croc/blog/267883/">Optimization</a> for a mining company with multiple fields (satellite channels) </li><li>  Unconventional use of virtualizers and optimizers <a href="http://habrahabr.ru/company/croc/blog/270549/">for centralizing the storage of a bank</a> </li><li>  <a href="http://habrahabr.ru/company/croc/blog/229061/">Bikes exit engineers on kernel systems</a> </li><li>  <a href="http://habrahabr.ru/company/croc/blog/263889/">Tales of the X-team</a> </li><li>  <a href="http://habrahabr.ru/company/croc/blog/264237/">Tales of engineers VKS</a> </li><li>  <a href="http://habrahabr.ru/company/croc/blog/268169/">Long-distance trips (cosmonauts-1)</a> </li><li>  <a href="http://habrahabr.ru/company/croc/blog/274237/">More visits "astronauts"</a> </li><li>  <a href="http://habrahabr.ru/company/croc/blog/200830/">Old Support Stories</a> </li><li>  My mail just in case - ARumyantsev@croc.ru </li></ul></div><p>Source: <a href="https://habr.com/ru/post/274339/">https://habr.com/ru/post/274339/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274325/index.html">Mobile Applications and PA-DSS</a></li>
<li><a href="../274327/index.html">Useful add-ons to ReSharper</a></li>
<li><a href="../274329/index.html">Printf Oriented Programming</a></li>
<li><a href="../274333/index.html">How to create a convincing mechanics of death and not screw it up</a></li>
<li><a href="../274335/index.html">AI, BigData & HPC Digest # 3</a></li>
<li><a href="../274349/index.html">The subtle virtues of regular expressions in Python</a></li>
<li><a href="../274353/index.html">Tale of how I wrote my REST framework with web sockets</a></li>
<li><a href="../274357/index.html">Working alone is very difficult.</a></li>
<li><a href="../274359/index.html">Cybersecurity 2015</a></li>
<li><a href="../274361/index.html">How to monitor the appearance of questions on toster.ru ,.stackoverflow.com and stackoverflow.com</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>