<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Backup with Bareos and Relax-and-Recover</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bareos (Backup Archiving Recovery Open Sourced) is a centralized, client-server and cross-platform system for backup, archiving and recovery of data. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Backup with Bareos and Relax-and-Recover</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://www.bareos.org/">Bareos</a> (Backup Archiving Recovery Open Sourced) is a centralized, client-server and cross-platform system for backup, archiving and recovery of data. <br><br><img src="https://habrastorage.org/files/85e/29e/121/85e29e12182b43b195e762e77ba86e17.png"><br><br>  It is a fork of Bacula and is actively developing.  Has clients under Linux and Windows.  Full list of supported features on <a href="https://github.com/bareos/bareos">Github</a> . <br><a name="habracut"></a><br>  The principles of operation and configuration completely coincide with Bacula, therefore I will not dwell on the description of all parameters in detail.  Articles about Bacula are on Habr√© ( <a href="http://habrahabr.ru/post/243719/">‚ÄúStep-by-step modification of the pre-installed Bacula setting‚Äù</a> , <a href="http://habrahabr.ru/post/211755/">‚ÄúBacula: for those who need quick and pictures‚Äù</a> , <a href="http://habrahabr.ru/post/86526/">‚ÄúSetting up and understanding Bacula‚Äù</a> , <a href="http://habrahabr.ru/post/135291/">‚ÄúCentralized backup of Windows and * nix servers using Bacula‚Äù</a> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Hosts: <br>  testbackup-bareos is a Bareos server on which bconsole, bareos-director, file daemon, storage daemon are running.  IP address - 10.11.0.150 <br>  testbackup-client-03 is a client that we back up.  OS Rosa Cobalt 1.0.  It runs the file-daemon.  IP Address - 10.11.0.153 <br><br><h4>  Bareos server setup </h4><br>  I chose Bareos 15.X, since the work with sockets is improved here.  But this instruction is also suitable for the branch 14.X. <br>  Install Bareos from the repository and configure PostgreSQL: <br><br><pre><code class="bash hljs">wget -O /etc/yum.repos.d/bareos.repo http://download.bareos.org/bareos/experimental/nightly/CentOS_6/bareos:master.repo yum install bareos bareos-common bareos-database-postgresql bareos-client bareos-bconsole bareos-storage bareos-filedaemon bareos-director su postgres -c /usr/lib/bareos/scripts/create_bareos_database su postgres -c /usr/lib/bareos/scripts/make_bareos_tables su postgres -c /usr/lib/bareos/scripts/grant_bareos_privileges</code> </pre> <br>  The client configuration is located in the /etc/bareos/bareos-dir.d directory: <br><br><div class="spoiler">  <b class="spoiler_title">testbackup-client-03.conf:</b> <div class="spoiler_text"><pre> <code class="bash hljs">Job { Name = <span class="hljs-string"><span class="hljs-string">"testbackup-client-03-backup"</span></span> Type = Backup Level = Incremental Client = testbackup-client-03-fd FileSet = <span class="hljs-string"><span class="hljs-string">"testbackup-client-03-fileset"</span></span> Schedule = <span class="hljs-string"><span class="hljs-string">"WeeklyCycle"</span></span> Storage = File Messages = Standard Pool = testbackup-client-03-pool-Incremental Priority = 10 Write Bootstrap = <span class="hljs-string"><span class="hljs-string">"/var/lib/bareos/%c.bsr"</span></span> Full Backup Pool = testbackup-client-03-pool-Full Differential Backup Pool = testbackup-client-03-pool-Differential Incremental Backup Pool = testbackup-client-03-pool-Incremental } Job { Name = <span class="hljs-string"><span class="hljs-string">"testbackup-client-03-restore"</span></span> Type = Restore Client = testbackup-client-03-fd FileSet = <span class="hljs-string"><span class="hljs-string">"testbackup-client-03-fileset"</span></span> Storage = File Pool = testbackup-client-03-pool-Incremental Messages = Standard Where = / } Job { Name = <span class="hljs-string"><span class="hljs-string">"testbackup-client-03-backup-mysql"</span></span> Type = Backup Level = Incremental Client = testbackup-client-03-fd FileSet = <span class="hljs-string"><span class="hljs-string">"testbackup-client-03-fileset-mysql"</span></span> Schedule = <span class="hljs-string"><span class="hljs-string">"WeeklyCycle"</span></span> Storage = File Messages = Standard Pool = testbackup-client-03-pool-Incremental Priority = 10 Write Bootstrap = <span class="hljs-string"><span class="hljs-string">"/var/lib/bareos/%c.bsr"</span></span> Full Backup Pool = testbackup-client-03-pool-Full Differential Backup Pool = testbackup-client-03-pool-Differential Incremental Backup Pool = testbackup-client-03-pool-Incremental } Job { Name = <span class="hljs-string"><span class="hljs-string">"testbackup-client-03-restore-mysql"</span></span> Type = Restore Client = testbackup-client-03-fd FileSet = <span class="hljs-string"><span class="hljs-string">"testbackup-client-03-fileset-mysql"</span></span> Storage = File Pool = testbackup-client-03-pool-Incremental Messages = Standard Where = / } FileSet { Name = <span class="hljs-string"><span class="hljs-string">"testbackup-client-03-fileset"</span></span> Include { Options { compression = GZIP Signature = MD5 <span class="hljs-comment"><span class="hljs-comment"># calculate md5 checksum per file } File = "/" File = "/boot" } } FileSet { Name = "testbackup-client-03-fileset-mysql" Include { Plugin = "bpipe:file=/MYSQL/dump.sql:reader=mysqldump -uzabbix -p12345 --single-transaction --add-drop-database -B zabbix:writer=mysql -uzabbix -p12345" Options { Signature = MD5 # calculate md5 checksum per file compression = GZIP } } } Client { Name = testbackup-client-03-fd Address = testbackup-client-03 Password = "Msmn8GRO0CnMyUljLmB9u1wgrbYXoV1rI8MLugI6JJqc " File Retention = 30 days # 30 days Job Retention = 6 months # six months AutoPrune = no # Prune expired Jobs/Files } Pool { Name = testbackup-client-03-pool-Full Pool Type = Backup Recycle = yes # Bareos can automatically recycle Volumes AutoPrune = yes # Prune expired volumes Volume Retention = 365 days Maximum Volume Bytes = 30G Maximum Volumes = 100 Label Format = "testbackup-client-03-pool-Full-" } Pool { Name = testbackup-client-03-pool-Differential Pool Type = Backup Recycle = yes # Bareos can automatically recycle Volumes AutoPrune = yes Volume Retention = 90 days Maximum Volume Bytes = 10G Maximum Volumes = 100 Label Format = "testbackup-client-03-pool-Differential-" } Pool { Name = testbackup-client-03-pool-Incremental Pool Type = Backup Recycle = yes AutoPrune = yes Volume Retention = 30 days Maximum Volume Bytes = 1G Maximum Volumes = 100 Label Format = "testbackup-client-03-pool-Incremental-" }</span></span></code> </pre> </div></div><br>  4 tasks were created here - 2 Job for backup / restore the entire system (/ and / boot) and 2 Job for backup / restore the MySQL Zabbix database using the bpipe.  In our example, the backup database is done only to demonstrate the work of bpipe.  The database dump is not saved locally at the client, it is immediately transmitted over the network. <br><br>  Bpipe structure: <br><br><pre> <code class="bash hljs">Plugin = <span class="hljs-string"><span class="hljs-string">"&lt;plugin&gt;:file=&lt;filepath&gt;:reader=&lt;readprogram&gt;:writer=&lt;writeprogram&gt;"</span></span></code> </pre> <br>  plugin - the name of the plugin without the prefix -fd.so; <br>  filepath - pseudo path in Volume to the backup file.  This path and file name are needed only for a logical representation in the directory tree during restoration; <br>  readprogram is a program whose stdout reads bpipe and sends to the server; <br>  writeprogram is a program in which stpin bpipe transfers data from the server. <br><br>  Director configuration in / etc / bareos: <br><br><div class="spoiler">  <b class="spoiler_title">bareos-dir.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs">@/etc/bareos/bareos-dir.d/testbackup-client-03.conf <span class="hljs-comment"><span class="hljs-comment">#   Director { Name = testbackup-bareos-dir QueryFile = "/usr/lib/bareos/scripts/query.sql" Maximum Concurrent Jobs = 10 Password = "lY/wVlXuC25qk18i15iw10MpOVxLwDLFgOUMtSMpFOC6" Messages = Daemon Auditing = yes Maximum Concurrent Jobs = 20 } Schedule { Name = "WeeklyCycle" Run = Full 1st sat at 21:00 } Storage { Name = File Address = testbackup-bareos Password = "k4dkFWMwJh3zBpnAOpa9+oule1z/OT0GIcE4wZYySgbU" Device = FileStorage Media Type = File } Catalog { Name = MyCatalog dbdriver = "postgresql" dbname = "bareos" dbuser = "bareos" dbpassword = "" } Messages { Name = Standard mailcommand = "/usr/bin/bsmtp -h localhost -f \"\(Bareos\) \&lt;%r\&gt;\" -s \"Bareos: %t %e of %c %l\" %r" mailcommand = "/etc/bareos/scripts/bareoszabbix.bash %i" operatorcommand = "/usr/bin/bsmtp -h localhost -f \"\(Bareos\) \&lt;%r\&gt;\" -s \"Bareos: Intervention needed for %j\" %r" mail = root@localhost = all, !skipped, !audit operator = root@localhost = mount console = all, !skipped, !saved, !audit append = "/var/log/bareos/bareos.log" = all, !skipped, !audit catalog = all, !audit } Messages { Name = Daemon mailcommand = "/usr/bin/bsmtp -h localhost -f \"\(Bareos\) \&lt;%r\&gt;\" -s \"Bareos daemon message\" %r" mail = root@localhost = all, !skipped, !audit console = all, !skipped, !saved, !audit append = "/var/log/bareos/bareos.log" = all, !skipped, !audit append = "/var/log/bareos/bareos-audit.log" = audit }</span></span></code> </pre> </div></div><br>  Bconsole configuration in / etc / bareos directory: <br><div class="spoiler">  <b class="spoiler_title">bconsole.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs">Director { Name = testbackup-bareos-dir DIRport = 9101 address = testbackup-bareos Password = <span class="hljs-string"><span class="hljs-string">"lY/wVlXuC25qk18i15iw10MpOVxLwDLFgOUMtSMpFOC6"</span></span> }</code> </pre> </div></div><br>  Configuration of Storage Daemon in the / etc / bareos directory: <br><br><div class="spoiler">  <b class="spoiler_title">bareos-sd.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs">Storage { Name = testbackup-bareos-sd Maximum Concurrent Jobs = 20 } Director { Name = testbackup-bareos-dir Password = <span class="hljs-string"><span class="hljs-string">"k4dkFWMwJh3zBpnAOpa9+oule1z/OT0GIcE4wZYySgbU"</span></span> } Device { Name = FileStorage Media Type = File Archive Device = /backup LabelMedia = yes; Random Access = yes; AutomaticMount = yes; RemovableMedia = no; AlwaysOpen = no; } Messages { Name = Standard director = testbackup-bareos-dir = all }</code> </pre> </div></div><br>  If the client's name is not resolved, then write to / etc / hosts: <br>  echo "10.11.0.153 testbackup-client-03" &gt;&gt; / etc / hosts <br><br>  Launch Director, File Daemon and Storage: <br><br><pre> <code class="bash hljs">service bareos-dir start service bareos-sd start service bareos-fd start</code> </pre> <br>  This completes the Bareos server setup.  Go to the testbackup-client-03 client setup. <br><br><h4>  Customize client bareos. </h4><br>  Install the bareos repository and set the File Daemon: <br><br><pre> <code class="bash hljs">yum -y install bareos-filedaemon</code> </pre> <br>  File Daemon configuration in / etc / bareos directory: <br><br><div class="spoiler">  <b class="spoiler_title">bareos-fd.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs">Director { Name = testbackup-bareos-dir Password = <span class="hljs-string"><span class="hljs-string">"Msmn8GRO0CnMyUljLmB9u1wgrbYXoV1rI8MLugI6JJqc"</span></span> } FileDaemon { Name = testbackup-client-03-fd Maximum Concurrent Jobs = 20 Compatible = no <span class="hljs-comment"><span class="hljs-comment">#  Bacula ,     bareos-fd } Messages { Name = Standard director = testbackup-client-03-dir = all, !skipped, !restored }</span></span></code> </pre> </div></div><br>  This completes the client setup. <br><br><h4>  Run backup / restore </h4><br>  Go to the testbackup-bareos server and start the backup of the MySQL database and the full backup: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#bconsole *run testbackup-client-03-backup-mysql *run testbackup-client-03-backup</span></span></code> </pre><br>  To restore the database you need to run the corresponding task: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#bconsole *restore</span></span></code> </pre> <br>  And follow the suggested points. <br>  Or, if we know a JobId (for example, 158), then immediately run: <br><br><pre> <code class="bash hljs">*restore restorejob=testbackup-client-03-restore-mysql jobid=158</code> </pre> <br><h4>  Install and configure Relax-and-Recover </h4><br>  <a href="http://relax-and-recover.org/">REAR</a> (Relax-and-Recover) is a Linux BMDR (Bare Metal Disaster Recovery) solution, system recovery for pure iron. <br><br><img src="https://habrastorage.org/files/767/d76/ee8/767d76ee88704d4cb1ef6f15fd63e47c.png"><br><br>  Main features: <br><ul><li>  Restore to pure hardware: physical-to-virtual (P2V), virtual-to-physical (V2P), physical-to-physical (P2P) and virtual-to-virtual (V2V), virtualization systems KVM, Xen, VMware </li><li>  Types of boot devices: ISO, USB, eSATA, OBDR / bootable tape, PXE </li><li>  Data transfer protocols: HTTP, HTTPS, FTP, SFTP, NFS, CIFS (SMB) </li><li>  Types of disk partitioning: HWRAID (HP SmartArray), SWRAID, LVM, multipathing, DRBD, iSCSI, LUKS (encrypted partitions and filesystems) </li><li>  Backends: CommVault Galaxy, EMC NetWorker (Legato), HP DataProtector, IBM Tivoli Storage Manager (TSM), SEP Sesam, Symantec NetBackup, Bacula, Bareos, duplicity / duply </li></ul><br>  The remaining features are on the <a href="http://relax-and-recover.org/about/">site</a> . <br><br>  In our example, we will look at creating a bootable ISO image and fully restoring the client testbackup-client-03 using the Bareos backend. <br><br>  A boot ISO image is created on the client and transferred via NFS to the server (in our case, to the Bareos server) in the nfs folder: //10.11.0.150/backup <br>  For this, you must first configure NFS access on the server. <br>  Then go to the testbackup-client-03 client setup: <br><br>  Install bconsole: <br><br><pre> <code class="bash hljs">yum -y install bareos-bconsole</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">/etc/bareos/bconsole.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs">Director { Name = testbackup-bareos-dir DIRport = 9101 address = testbackup-bareos Password = <span class="hljs-string"><span class="hljs-string">"lY/wVlXuC25qk18i15iw10MpOVxLwDLFgOUMtSMpFOC6"</span></span> }</code> </pre> </div></div><br>  For our distribution of DEW Cobalt we connect the EPEL repository: <br><br><pre> <code class="bash hljs">rpm -ivh http://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm</code> </pre> <br>  Comment out the mirrorlist and uncomment the baseurl in /etc/yum.repos.d/epel.repo: <br><br><div class="spoiler">  <b class="spoiler_title">epel.repo</b> <div class="spoiler_text"><pre> <code class="bash hljs">[epel] name=Extra Packages <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Enterprise Linux 6 - <span class="hljs-variable"><span class="hljs-variable">$basearch</span></span> baseurl=http://download.fedoraproject.org/pub/epel/6/<span class="hljs-variable"><span class="hljs-variable">$basearch</span></span> <span class="hljs-comment"><span class="hljs-comment">#mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;arch=$basearch failovermethod=priority enabled=0 gpgcheck=1 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6</span></span></code> </pre> </div></div><br>  Let's connect the CentOS repository in /etc/yum.repos.d/CentOS-Base.repo: <br><div class="spoiler">  <b class="spoiler_title">CentOS-Base.repo</b> <div class="spoiler_text"><pre> <code class="bash hljs">[base] name=CentOS-<span class="hljs-variable"><span class="hljs-variable">$releasever</span></span> - Base baseurl=http://mirror.centos.org/centos/6.6/os/<span class="hljs-variable"><span class="hljs-variable">$basearch</span></span>/ enabled=1 gpgcheck=1 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</code> </pre> </div></div><br>  And import the GPG key: <br><br><pre> <code class="bash hljs">rpm --import http://mirror.centos.org/centos/6.6/os/x86_64/RPM-GPG-KEY-CentOS-6</code> </pre> <br>  Install REAR and necessary components: <br><br><pre> <code class="bash hljs">yum -y install nfs-utils genisoimage syslinux rear</code> </pre> <br>  In the files <i>ip_addresses</i> and <i>route we</i> add information about ip, interface and default gateway: <br><br><pre> <code class="bash hljs">mkdir /etc/rear/mappings <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"eth0 10.11.0.153/24"</span></span> &gt; /etc/rear/mappings/ip_addresses <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"default 10.11.0.1 eth0"</span></span> &gt; /etc/rear/mappings/route</code> </pre> <br>  In order to avoid problems with the definition of Job names, the Client recommends that the name of the File Daemon client exactly match its hostname.  Those.  If the hostname of the server is testbackup-client-03, then in the bareos-fd.conf in the FileDaemon section should be written: <br>  Name = testbackup-client-03-fd <br><br>  Configuring local.conf from template: <br><br><pre> <code class="bash hljs">cp /usr/share/rear/conf/default.conf /etc/rear/local.conf</code> </pre> <br>  I do not publish the full configuration of local.conf.  I have changed only the following parameters in comparison with default.conf: <br><br><div class="spoiler">  <b class="spoiler_title">local.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs">OS_VENDOR=CentOS OS_VERSION=6.6 BACKUP=BAREOS OUTPUT=ISO BAREOS_CLIENT=$(grep $(hostname -s) /etc/bareos/bareos-fd.conf | awk <span class="hljs-string"><span class="hljs-string">'/-fd/ {print $3}'</span></span> ) OUTPUT_URL=nfs://10.11.0.150/backup USE_STATIC_NETWORKING=y</code> </pre> </div></div><br>  Since I use the Cobalt distribution ROSA (rhel-based version 6.6) and therefore I installed OS_VENDOR and OS_VERSION as for CentOS 6.6. <br><br>  For clarity, I use my name template for Job, File Set, Client, so I need to edit the REAR recovery script, otherwise the script will not find all the necessary data. <br><br><pre> <code class="bash hljs">vi /usr/share/rear/restore/BAREOS/default/40_restore_backup.sh</code> </pre> <br>  Find the line: <br><br><pre> <code class="bash hljs">BAREOS_CLIENT=$(grep $(hostname -s) /etc/bareos/bareos-fd.conf | awk <span class="hljs-string"><span class="hljs-string">'/-fd/ {print $3}'</span></span> )</code> </pre> <br>  And in the same place (before it, for example) we set a new variable: <br><br><pre> <code class="bash hljs">BAREOS_CLIENT_1=$(grep <span class="hljs-string"><span class="hljs-string">"Name =.*-fd"</span></span> /etc/bareos/bareos-fd.conf | awk <span class="hljs-string"><span class="hljs-string">'{print $3}'</span></span> | sed -e <span class="hljs-string"><span class="hljs-string">'s/-fd//g'</span></span> )</code> </pre> <br>  Instead: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"restore client=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$BAREOS_CLIENT</span></span></span><span class="hljs-string"> where=/mnt/local select all done</span></span></code> </pre> <br>  We write: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"restore client=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$BAREOS_CLIENT_1</span></span></span><span class="hljs-string">-fd restorejob=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$BAREOS_CLIENT_1</span></span></span><span class="hljs-string">-restore fileset=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$BAREOS_CLIENT_1</span></span></span><span class="hljs-string">-fileset where=/mnt/local select all done</span></span></code> </pre> <br>  Make a bootable ISO: <br><br><pre> <code class="bash hljs">rear -v -d mkrescue</code> </pre> <br>  For information: the resulting ISO size is about 30-40 MB. <br>  To recover, boot from this image and select Recover testbackup-client-03. <br><br><img src="https://habrastorage.org/files/333/611/567/333611567de84f6a9f44914d05612ff1.png"><br><br>  Run the recovery process: <br><br><pre> <code class="bash hljs">rear -v recover</code> </pre> <br><br><img src="https://habrastorage.org/files/137/ca4/2dc/137ca42dc33b463da47ea0234bb7f7bd.png"><br><br>  At the end of the recovery process, we check our system, which is mounted in / mnt / local. <br>  Make sure everything is in place and reboot: <br><br><img src="https://habrastorage.org/files/1a8/7b6/52e/1a87b652ef374379998fa567d22fcc5e.png"><br><br>  The system is fully restored. <br><br>  Before using a boot image for any OS, I recommend testing it first. </div><p>Source: <a href="https://habr.com/ru/post/260955/">https://habr.com/ru/post/260955/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260943/index.html">Intel Edison on guard of health. Experience "FRUIT MD"</a></li>
<li><a href="../260945/index.html">What you need to know about working with text preview emails</a></li>
<li><a href="../260947/index.html">Monitoring and alerting about events in Windows logs: sending to E-mail in Windows Server 2012 R2</a></li>
<li><a href="../260949/index.html">Why is programming so hard?</a></li>
<li><a href="../260953/index.html">10 Tips for Using ExecutorService</a></li>
<li><a href="../260957/index.html">Who is stronger - an elephant or ... an elephant?</a></li>
<li><a href="../260961/index.html">We write on JS in functional and declarative style</a></li>
<li><a href="../260963/index.html">Generating mapping via t4 templates</a></li>
<li><a href="../260965/index.html">Building a Rubik's Cube with a genetic algorithm online without SMS</a></li>
<li><a href="../260967/index.html">Droidcon Berlin 2015: how it was</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>