<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PSR-14 - the main event in PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last year, PHP-FIG - The PHP Compatibility Concepts Group, has released several new specifications. The last one, PSR-14 , is dedicated to event sched...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PSR-14 - the main event in PHP</h1><div class="post__text post__text-html js-mediator-article">  Last year, <a href="https://www.php-fig.org/">PHP-FIG</a> - The PHP Compatibility Concepts Group, has released several new specifications.  The last one, <a href="https://www.php-fig.org/psr/psr-14/">PSR-14</a> , is dedicated to event scheduling.  Like other PSRs, this is a local specification, but has a great influence on many aspects of standardization. <br><br>  <i>From the translator: This is the translation of the first part of a series of publications in which Larry (Crell) Garfield, one of the members of PHP-FIG, explains what PSR-14 is, what it can do and what it doesn‚Äôt, and how best to use it in their projects.</i> <br><a name="habracut"></a><br><h2>  purpose </h2><br>  Event dispatch has long been used in many languages.  If you have ever used EventDispatcher in <a href="https://symfony.com/doc/current/event_dispatcher.html">Symfony</a> , Event system in <a href="https://laravel.com/docs/5.8/events">Laravel</a> , hooks in Drupal, <a href="https://docs.zendframework.com/zend-eventmanager/">Event Manager</a> in the Zend framework, <a href="https://event.thephpleague.com/">League \ Event</a> package, or something similar, then you know what this is about. <br><br>  In a general sense, all these systems are a form of "observer-mediator".  One code fragment sends a message of the type - ‚Äúevent‚Äù, and the intermediary sends it to other separate code fragments - ‚Äúlisteners‚Äù.  Sometimes the signal is directed only in one direction, sometimes the ‚Äúlistener‚Äù can somehow transmit data back to the caller.  Of course, they are all different and not very compatible with each other. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is a problem for standalone libraries that want to connect to different libraries and applications.  Many libraries can be expanded by sending events in one form or another, so that other code can link to them.  But such an intermediary layer is, in fact, proprietary.  The library that runs the symfony eventDispatcher is then merged with symfony.  Then using it somewhere else requires installing an EventDispatcher and connecting to libraries in the program.  The library that calls the binding system from Drupal <code>module_invoke_all()</code> , then links to Drupal.  And so on. <br><br>  The purpose of PSR-14 is to rid the library of this dependency.  This allows libraries to expand through a thin common layer, and then facilitate their transfer to another environment without additional efforts and costs, for example, in Symfony, Zend Framework, Laravel, TYPO3, eZ Platform or Slim.  As long as the medium has compatibility with the PSR-14, everything will work. <br><br><h2>  Specification </h2><br>  As already mentioned, the specification is quite easy.  These are three interfaces in one method and a meta description of how to use them.  Everything is simple and convenient.  Below is the code of these interfaces (no comments to save space). <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Psr</span></span>\<span class="hljs-title"><span class="hljs-title">EventDispatcher</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EventDispatcherInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispatch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object $event)</span></span></span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListenerProviderInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getListenersForEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object $event)</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">iterable</span></span></span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StoppableEventInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isPropagationStopped</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span></span>; }</code> </pre> <br>  The first two are the core specifications.  <code>StoppableEventInterface</code> is an extension to which we return later. <br><br>  I think <code>EventDispatcher</code> familiar to most of you - it‚Äôs just an object with a method to which you transmit an event - an intermediary, which we have already spoken about.  The event itself, however, is not defined - it can be <b>any PHP object</b> .  More on this later. <br><br>  Most existing implementations have one object or set of functions that act as an intermediary or dispatcher and a place to register the code that receives the event (listeners).  For PSR-14, we consciously divided these two responsibilities into separate objects.  The dispatcher receives a list of listeners from the supplier object that makes this list. <br><br>  Where does the provider get the list of listeners then?  Yes, where he wants from!  There is a billion and one ways to connect the listener and the event, they are all absolutely valid and incompatible.  At the beginning, we decided that the standardization of the ‚ÄúOne True Way‚Äù of registering listeners would be too limited.  However, by standardizing the process of connecting the listener to the dispatcher, you can get excellent flexibility without forcing the user to do something strange and incomprehensible. <br><br>  Also, the code does not indicate what the listener is.  It can be any PHP-capable fragment of a signal: a function, an anonymous function, an object method, anything.  Since the callee can do anything, it means that it is acceptable to have as a listener, say, an anonymous function that performs a deferred loading of the service from the DI container and calls the service method, which actually contains the listening code. <br><br>  In short, a dispatcher is a simple and easy API for library authors.  Listener vendors offer a robust and flexible API for framework integrators, and the relationship between the controller and the provider brings them together. <br><br><h2>  Simple example </h2><br>  In general terms, the scheme of combining all the parts into a whole will look something like this. <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Dispatcher</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EventDispatcherInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ListenerProviderInterface $provider)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;provider = $provider; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispatch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object $event)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;provider-&gt;getListenersForEvent($event) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $listener) { $listener($event); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $event; } } $dispatcher = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dispatcher($provider); $event = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SomethingHappened(); $dispatcher-&gt;dispatch($event);</code> </pre><br>  This small piece of code opens up great possibilities, and it is very flexible.  In the following articles we will talk in detail about its properties, analyze some structural solutions and consider the sets of ways to use such lightweight events. <br><br><h2>  Code </h2><br>  PSR-14 is already supported by main frameworks and applications. <br><br><ul><li>  Matthew Weier O'Phinney has already pledged to introduce PSR-14 support in zend-eventmanager 4.0 in the Zend framework. <br></li><li>  Symfony <a href="https://symfony.com/blog/new-in-symfony-4-3-simpler-event-dispatching">recently announced</a> changes to EventDispatcher for compatibility with PSR-14, which will give full support in 5.0 / 5.1. <br></li><li>  The Yii framework has announced its intention to integrate PSR-14 <a href="">in version 3.0</a> . <br></li><li>  Benni Mack from TYPO3 CMS said that in the next TYPO3 release, all existing ‚Äútrap + signal / slot‚Äù concepts will support PSR-14. <br></li></ul><br>  PSR-14 also has three fully-functional independent implementations that you can already use in any application. <br><br><ul><li>  <a href="https://github.com/crell/tukio">Tukio</a> by Larry Garfield, the author of this article. <br></li><li>  <a href="https://github.com/phly/phly-event-dispatcher">Phly Event Dispatcher</a> by Matthew Weier O'Phinney. <br></li><li>  <a href="https://github.com/bmack/kart-composer-plugin">Kart</a> from Benni Mack, which works as a plug-in. <br></li></ul><br>  The author thanks the entire PSR working group: <a href="https://twitter.com/Crell">Larry Garfield</a> , <a href="https://twitter.com/WyriHaximus">Cees-Jan Kiewiet</a> , <a href="https://twitter.com/bennimack">Benjamin Mack</a> , <a href="https://twitter.com/auroraeosrose">Elizabeth Smith</a> , <a href="https://twitter.com/weaverryan">Ryan Weaver</a> , <a href="https://twitter.com/mwop">Matthew Weier O'Phinney</a> .  Throughout the work, the process was highly productive: everyone worked together, collectively, as it should be.  The result is good, and we would like all further efforts in joint work on the architecture to be just as productive. <br><br><blockquote>  You can learn more details either from the original of the next <a href="https://steemit.com/php/%40crell/psr-14-all-about-events">part</a> and the <a href="https://www.php-fig.org/psr/psr-14/">documentation</a> or on May 17 at <a href="https://phprussia.ru/2019">PHP Russia</a> .  The second option is attractive for several reasons.  For example, the head of the Program Committee, Alexander ( <a href="https://habr.com/ru/users/samdark/" class="user_link">samdark</a> ) Makarov, is among those who have implemented PSR-14 in Yii.  And in principle, the composition of the Program Committee and the <a href="https://phprussia.ru/2019/abstracts">speakers is</a> incredibly strong, there is hardly any topic from the sphere of professional use of PHP that cannot be discussed at this conference. </blockquote></div><p>Source: <a href="https://habr.com/ru/post/450812/">https://habr.com/ru/post/450812/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../4508/index.html">Google opens a development center in St. Petersburg</a></li>
<li><a href="../450804/index.html">3D printing metal in the automotive industry: you need to start small</a></li>
<li><a href="../450806/index.html">When the environment variable speeds up the process 40 times</a></li>
<li><a href="../45081/index.html">Configure CloudFront to work with S3</a></li>
<li><a href="../450810/index.html">Top 7 ways to quickly test the competence of IT-specialists before the interview</a></li>
<li><a href="../450814/index.html">How BGP works</a></li>
<li><a href="../450828/index.html">When the city falls asleep ...</a></li>
<li><a href="../45083/index.html">Small cribs are always at hand!</a></li>
<li><a href="../450834/index.html">Parsing sites - and this is generally legal in Russia?</a></li>
<li><a href="../450838/index.html">Why is the unit not attributed to prime numbers, and when it began to be considered a number</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>