<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Prediction of the departure of loyal players in the IMO</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the last article I described how we in Innova use data mining to predict the departure of newcomers just starting their way into Aion MMORPG based ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Prediction of the departure of loyal players in the IMO</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/c64/2aa/abb/c642aaabb197a77bac677fe8f6e8b355.jpg" align="left">  In the <a href="http://habrahabr.ru/post/134163/">last article</a> I described how we in Innova use data mining to predict the departure of newcomers just starting their way into Aion MMORPG based on the logs of their actions for a couple of hours or days spent in the game.  But we also have veterans who have spent months and years in the game, and they also sometimes leave.  We have already learned with high accuracy to predict the extinction of their interest by the same data mining methods. <br><a name="habracut"></a><br><h2>  Technical details </h2><br>  Nothing has changed from the previous article; under datamining we still have two Dual Xeon E5630 32Gb RAM blades, 10 Tb of cold storage for source and intermediate data, 3 Tb of hot storage in a RAID10 SAS array for working data.  Both servers for MS SQL 2008R2 are one for the database and one for Analysis Services.  The software part of the solution is Microsoft's standard Business Intelligence package included in SQL Server. <br><br>  Input data - activity logs for 6 months for 38,000 enthusiastic players. <br><br><h2>  What is considered care </h2><br>  For beginners, the question did not even stand - a person leaves the game in a couple of minutes or hours, and in fact everything - the player is lost.  On the last day, when a person entered the game, we fixed the day of care and trained our neural networks with this information.  But for veterans, we went through several iterations in order to correctly determine what kind of fact should be considered care and what to predict in the end.  The first assumption was the simplest: a man plays while he likes everything, and then he stops playing.  Noting the days of the game on the calendar, we expected something like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/storage2/ae8/48d/273/ae848d2736fa3f78d6980000891651ee.jpg"></div><br><br>  Our idea was that the last game day is the point of departure that we will predict.  The reality, however, turned out to be much more complex, most players behave like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage2/ee1/95f/3e7/ee195f3e72ae8e83feceb5f94b4768ed.jpg"></div><br><br>  What is considered the moment of departure - August 25, formally the last day of the game?  Or, for example, the 16th, when we have not seen a person in the game for a week already?  Or July 31, the first time she has not started the game for 7 days in a row?  We tried different hypotheses, and the simplest did not work at all.  Predict that a certain day will be the last day of the game, we managed with a sad accuracy of 65%. <br><br>  With a <i>close look</i> at the data, we realized that most players have a long tail of game days, as shown on the last calendar card ‚Äî residual activity for a couple of weeks or even months.  In fact, they <b>have already stopped playing actively</b> , but still sometimes enter the game.  For such people, the actual departure has already taken place - they are no longer happy about the game, but they go by inertia to chat with friends, sell things, or in general their accounts are already used by clan members. <br><br>  The next step was cutting the tail according to the rules of thumb in order to try to get to the true day from which the activity began to fall.  The most effective was the approach ‚Äúthe <i>last day of the game, when the total activity over the last 30 days was less than 9 days,</i> ‚Äù which gave an accuracy of about 80%.  But the empirical approach worked poorly for loyal, but not very active players, so I had to think further. <br><br><h2>  Transition to segmentation </h2><br>  The transition from binary thinking ‚Äúleft / left‚Äù to the use of our already existing activity clusters was a success, from the situation ‚Äúthe player left our game‚Äù to ‚Äúthe player's activity falls below the threshold of probable leaving‚Äù.  We have been using the <i>frequency usage</i> metric (in western literature <i>frequency</i> ) for a couple of years - the number of days of activity over the last 30 calendar days.  Simply put, we see a person in the game every day, every other day, a couple of days a week, or even once a month.  By frequency, we build activity clusters, segmenting the audience: <br><br><img src="https://habrastorage.org/storage2/6ca/d1e/b4e/6cad1eb4ede33f89160667cbfeeb30e0.png"><br><br>  Now we will define the withdrawal as a fall into the Pit, a zone of extreme inactivity bordering on leaving the game.  This redefinition is not only mathematical, but it also makes clear sense from a business point of view - instead of post-factum predicting that our player is no longer with us, we want to predict its <b>future</b> inactivity, a couple of weeks in advance, to have time to figure out the reasons and raising his motivation to play further. <br><br>  A new approach was the prediction of those players who face a fall into the Pit in two weeks, for the segments [7‚Äì9], [10‚Äì15] and [16‚Äì20], and after 3 weeks for the segment [21‚Äì25].  That is, we are looking for players who lose momentum momentum, whose activity should fall sharply over the next couple of weeks: <br><br><img src="https://habrastorage.org/storage2/499/dd9/e9c/499dd9e9cd5193f82e679b29c0083bec.png"><br><br><h2>  Metric selection </h2><br>  From our first data mining project, we learned how critical the metrics of overall activity for predicting exits are.  It is expected that now they will play a significant role, but, nevertheless, we decided to try other, social and game-specific metrics: <br><br><ul><li>  Chat activity - private messages, clan chat and general chat </li><li>  Resource gathering and crafting </li><li>  PvP and PvE instances </li><li>  The remaining days of the paid subscription </li><li>  Maximum character level </li></ul><br><h2>  Maths </h2><br>  Previously, for beginners, game data was used for a day or two, so the model had instantaneous values, the maximum required was normalization of metrics.  But for veterans, we look at the scale of weeks and months, so time aggregation is required - moving averages and sums, derivatives and angles of inclination. <br><br><img src="https://habrastorage.org/storage2/029/e4c/0a0/029e4c0a0df26114f5081670b3749c35.png"><br><br>  For example, we used a rolling amount of gaming days for 30 calendar days, linearly approximated <a href="http://en.wikipedia.org/wiki/Ordinary_least_squares">by the least squares method</a> , which is excellently counted directly in T-SQL.  At the entrance to the data mining model are direct coefficients.  And to analyze the daily time spent in the game, another step was added to throw out the days of inactivity: <br><br><img src="https://habrastorage.org/storage2/5e2/191/112/5e2191112313464b327602e56964be30.png"><br><br>  The ETL was actually redone and all the data was reloaded, but the approach was definitely correct, the first runs were given on a cluster [16-20] on raw, manually unconfigured models with an accuracy of 80%.  Having tried in the end more than 30 different metrics with different periods and methods of aggregation and counting, we came up with 80-90% accuracy of predicting the fall into the Pit for all segments of activity.  Already a good result, but we wanted more.  And a couple of months struggled to improve accuracy, until they came to another idea. <br><br><h2>  Back to the past </h2><br>  If we postpone our data on the time axis, the picture was as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage2/681/88b/cb4/68188bcb45f198f74b3f1a185fbf3fe1.png"></div><br><br>  The zero point is the day in which we make a forecast for 2-3 weeks ahead (depending on the segment, as described earlier).  At the entrance, the models are supplied with various metrics calculated for different periods, for example, the <i>first derivative of the moving average playing time per game day calculated over X days</i> .  What is important: all metrics were counted from the zero point - for 3 days, 5 days, etc. <br><br>  A fresh thought was to look into the past in more detail.  For example, we could calculate the same <i>derivative of the moving average playing time per game day</i> for 7 days, but 14 days ago - two weeks before the zero point.  Remember the long tail of the fading activity of the player?  In fact, we invented tail dissection into its component parts and their independent analysis by datamining models.  We tried several variants of the periods and depths of the past, in particular, the samples (7, -21) were effective - seven days deep 21 days ago, (7, -14), (7, -7) and (14, -14). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage2/97c/259/96e/97c25996e24a48805af364de80d35b24.png"></div><br><br>  This idea was a breakthrough, which increased accuracy to 95% in almost all segments: <br><br><img src="https://habrastorage.org/storage2/249/bad/b7d/249badb7d286e3a41b04c60f1e7f14d7.png"><br><br><h2>  In black box </h2><br>  The most striking result of this project is the final data mining model, with the best results on accuracy and errors of the second kind, entirely based on various mathematical combinations and calculations <b>from just two metrics</b> - daily activity and playing time! <br><br>  For different segments, different metrics were key in the models.  For example, for [21-25] it turned out that we need absolutely all of our calculations from the detailed past.  But for [7‚Äì9], approximations for 30 days along with the nearest past ‚Äî data 3 and 5 days before the zero point turned out to be important.  All models were based on derivatives, values ‚Äã‚Äãat point zero, and linear approximation coefficients ‚Äî everything is much more complicated than simple instantaneous values ‚Äã‚Äãthat we used when making predictions for beginners.  Example of the final model (the <i>image is clickable</i> ): <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/storage2/0d4/68f/f4e/0d468ff4ed58bad86453034663eb0715.jpg"></a> </div><br><br>  And if you have the impression that this is some kind of black box with magic math, then we fully share this opinion, for us it is a <b>black box</b> .  Even with the forecasts for beginners, we were surprised at how little our mining date tells us about the <i>reasons for leaving</i> ;  we predicted the departures with high precision, but we had no idea why this was happening.  But for newbies, we at least got a lot of data on their playing styles and game features used, and based on this data we made our system of individual email prompts.  For veterans, we completely failed to get at least some human-readable results.  It's a beautiful, 95% accurate, but completely opaque black box. <br><br><h2>  Summary </h2><br>  We can predict, in 2-3 weeks, strong drops in the game activity of our loyal players, which will allow our community managers to take care of such players, find out the reasons and do something to increase their interest in the game. <br><br>  This data mining project turned out to be much more complicated than the <a href="http://habrahabr.ru/post/134163/">predictions for beginners</a> .  More time was spent on experiments and fine tuning, but in the end, the 95% accuracy threshold was reached.  The most interesting thing is that in general, no specific metrics for Aion were included in the final models.  Forecasting is based solely on derived metrics from <b>daily activity</b> and time <b>spent in the game</b> , applicable not only for any game, but, I am sure, for any web service. </div><p>Source: <a href="https://habr.com/ru/post/149405/">https://habr.com/ru/post/149405/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149400/index.html">Two Open Source organizations have argued over a logo that could violate a trademark.</a></li>
<li><a href="../149401/index.html">Create a walking robot</a></li>
<li><a href="../149402/index.html">HelloWorld for iOS with jailbreak</a></li>
<li><a href="../149403/index.html">JQuery 1.8 release</a></li>
<li><a href="../149404/index.html">Notify the customer about the selection of the product directly from the Internet office!</a></li>
<li><a href="../149406/index.html">Dynamic creation of a build plan for analyzing .NET project files using FxCop</a></li>
<li><a href="../149407/index.html">How I participated in IndieGala and what I learned from it</a></li>
<li><a href="../149408/index.html">Mental traps</a></li>
<li><a href="../149410/index.html">The growth of version numbers of popular browsers</a></li>
<li><a href="../149411/index.html">NASA Earthly Problems and Stupid YouTube Content ID</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>