<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Translation: Template engines in PHP - debriefing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translation of a Fabien Potencier blog post discussion discussion on PHP templating and Twig. 

 -----------------------------------------------------...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Translation: Template engines in PHP - debriefing</h1><div class="post__text post__text-html js-mediator-article"> Translation of a Fabien Potencier blog <a href="http://habrahabr.ru/blogs/php/75901/">post</a> discussion discussion on PHP templating and Twig. <br><a name="habracut"></a><br> <code>-----------------------------------------------------------------------</code> <br>  My post about <a href="http://fabien.potencier.org/article/34/templating-engines-in-php">template engines in PHP</a> (approx. <a href="http://habrahabr.ru/blogs/php/75901/">Translation</a> ) received more than 70 comments at the moment.  It can be noted that many of them are well thought out and reasoned.  Thanks to everyone who spent their time taking part in a constructive discussion.  I‚Äôm really proud that the PHP community (at least the part of it that reads my blog) is able to discuss this risky topic without starting a flame war!  I am also impressed by the number of people who want to promote their own template engines;) <br><br>  Before starting to answer some questions, I would like to remind you that I like templates in pure PHP.  And remember, symfony uses pure PHP templates from the beginning.  In fact, I defended the use of pure PHP for templates from my first PHP project and never used any third-party template system.  So, I do not mind PHP for templates;  I just realized that the limitations of PHP, as a template engine, became more and more annoying to me. <br><br>  As <a href="http://eliw.wordpress.com/2009/10/07/in-response-to-fabien-potencier-twig-php-templating/">Eli</a> pointed out, ‚ÄúI [Fabien] present PHP templates in this form because I want to promote the template engine that I created‚Äù 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I also liked the comment from Tchalvak: ‚ÄúThe question of whether PHP is better or a template engine is not the most important one is much more important (and which is easier to answer) is to use templates or not.  Templates ‚Äî and presentation highlighting ‚Äî are necessary.  And in what form it is presented, it is not so important.  "He perfectly summed up the issue of discussion. <br><br>  I understand all the points raised in the comments, and, in a simple way, I agree with most of them.  Now I want to answer a few interesting comments. <br><br><h3>  Twig.  Cause. </h3><br>  I started searching for template engine a few months ago.  People who know me know that I don‚Äôt like to reinvent the wheel.  Therefore, I did not want to create my new library from scratch. <br><br>  I searched for good template engines, tried some of them, and eventually found Twig.  And as soon as I started using it, I realized that this is the diamond I was looking for (for its functionality and simple, beautiful architecture).  And, since Twig was not an independent project, I began to rewrite it.  After some improvements, such as the sandbox mode, I decided to contact Armin (Armin) and talk about the future of Twig. <br><br><h3>  Those.  you are not for sale ... still? </h3><br>  Even if you don't believe in my arguments, that's fine.  I do not want to make <a href="http://www.twig-project.org/">Twig a</a> universal template engine for PHP.  I really think that Twig is not alone in the template engine, but I am the first to decide that it will not be used in all new PHP projects! <br><br>  If you are looking for a templating engine on PHP cheat and having a built-in ability to inherit templates, blocks, auxiliary functions (helpers) and other things, the good news is that a few weeks ago I introduced the <a href="http://components.symfony-project.org/templating/">component of symfony templates</a> .  This is a completely independent (standalone) component that does not depend on anything, and I‚Äôm sure that many who want to use PHP in their templates will love this project. <br><br>  And even better - you can use Twig and the symfony templating component to get the best results.  Use the component for all your templates, and Twig if you need a sandbox mode. <br><br><h3>  About syntax </h3><br>  A lot of comments on the topic of <em>syntax</em> , and PHP syntax problems that I raised.  Speech is not the beauty of syntax, and if you think that my arguments are a discussion of <a href="http://www.freebsd.org/doc/en/books/faq/misc.html">‚Äúthe color of bicycle sheds‚Äù</a> (note the <a href="http://www.freebsd.org/doc/ru/books/faq/misc.html">Russian version</a> ), think again. <br><br>  The key point of my argument is that templatelers should strive for a middle sweet spot (?? sweet spot).  Template engines must find a compromise in the availability of opportunities - enough, but not too much.  As I said in the previous post, the template language is related to the <em>presentation logic</em> .  And, of course, simple conditions and cycles are part of the presentation logic.  But do you want to use the <code>array_chunk()</code> function in templates?  Probably not.  This must be implemented in the controller or model, depending on what you want to do. <br><br>  Also in the templates a <em>lot of</em> HTML code with a <em>small</em> PHP content.  And this piece of code is completely unacceptable for me: <br><pre>  &lt;? php
     if ($ items) {
         foreach ($ items as $ item) {
             echo "* {$ item} \ n";
         }
     } else {
         echo "No item has been found. \ n";
     }
 ?&gt; </pre><br><br>  Many seem to like the short PHP tags.  The first is mathematics.  If you compare the <code>&lt;?= $var ?&gt;</code> Entry with the <code>&lt;?php echo $var ?&gt;</code> Entry, you will see a difference of <strong>7</strong> characters, not 2. But this is not the main problem. <br><br>  In addition to problems with XML support and the fact that the configuration parameter <code>short_open_tag</code> differs among hosting providers, it is also a matter of code standardization: <br><ul><li>  <strong>PEAR</strong> : ‚ÄúAlways use <code>&lt;?php ?&gt;</code> To separate PHP code, not a short version <code>&lt;? ?&gt;</code>  <code>&lt;? ?&gt;</code> .  This is mandatory by PEAR agreement and is also the most flexible way to use PHP code on different operating systems and different configurations. ‚Äù <br>  <em>"Always use <code>&lt;?php ?&gt;</code> To delimit PHP code, not the <code>&lt;? ?&gt;</code></em>  <em><code>&lt;? ?&gt;</code> shorthand.</em>  <em>This is the most portable way to include PHP code on differing operating systems and setups. ‚Äù</em> </li><li>  <strong>Zend</strong> : ‚ÄúShort tags are by no means allowed.‚Äù <br>  <em>"Short tags are never allowed."</em> </li></ul><br><br>  Pear and Zend are quite serious projects, so they had reasons to ban short tags, didn't they? <br><br>  But as Eli mentioned in his post, I would also be glad to know that PHP dealt with this problem: "... there are a number of people (including me [Eli]) who are thinking about offering a new feature to the <code>short_tags</code> directive in PHP, which makes it possible not only to include and turn it off. But adding the third option - which will allow <code>&lt;?= ?&gt;</code> , prohibiting <code>&lt;? ?&gt;</code> " <br><br><h3>  About layout designers </h3><br>  (comment. the original web-designers will be translated here and further as a coder) <br><br>  The debate is not whether designers should understand PHP or not.  And, of course, not that the designers are not smart enough.  Of course, they can can learn a little PHP ... until they know too much and start writing code that is not related to their templates (for example, select records directly from the database).  Well, of course, they would not make such a mistake if they knew about the MVC pattern.  But, stop, they are no longer layout designers - they are programmers. <br><br>  Finding a balance is to provide a tool that will help layout designers not to step on a rake.  And, I think everyone will agree with me that PHP did its job poorly in setting these limits. <br><br><h3>  Screening </h3><br>  Some comments advocate that the shielding should be performed in controllers.  It will not work.  As John Campbell wrote: ‚ÄúThe problem is that the controllers do not know what will be displayed, and they also don‚Äôt know exactly how to escape‚Äù <br><br>  The problem itself is not an easy one.  On the one hand, programmers should be engaged in screening, but cannot do it in controllers.  On the other hand, coders should not care about screening, but only in templates it can be done with enough information.  Therefore, automatic shielding is the best compromise for me, plus the fact that the default application is ‚Äúalmost‚Äù safe is also an advantage. <br><br>  Speaking of automatic screening, I can say that I know enough about it, because this has been a possibility in symfony since 2006.  I can tell you that the costs of the speed of this functionality are very large.  In Twig, this is all compiled, and therefore there are no costs. <br><br><h3>  About the sandbox </h3><br>  Sandbox mode is not designed for web designers.  Basically, this refers to situations where people ‚Äúfrom the outside‚Äù can change templates (think of webmasters who customize their CMS templates or blog platforms from a management system). <br><br>  The development of security Dwoo and Smarty is the right step in this direction, but not as powerful as the full sandbox mode.  As far as I understand, all this is mainly about allowing PHP code in templates or not, as well as limiting the available PHP functions (correct me if I am mistaken). <br><br>  Sandbox mode controls everything ‚Äî from valid tags, to allowed object methods (Twig <a href="http://www.twig-project.org/book/03-Twig-for-Developers">documentation</a> explains the concept and how it works) <br><br><h3>  About speed </h3><br>  Most template engines compile templates into PHP code.  Therefore, the speed of lexing (lexing), parsing (parsing) and compilation does not play a big role, what is the speed of execution.  Below is the compiled version of the <code>Hello {{ name }}</code> template <code>Hello {{ name }}</code> : <br><pre>  / * Hello {{name}} * /
 class __TwigTemplate_1121b6f109fe93ebe8c6e22e3712bceb extends Twig_Template
 {
   public function display ($ context)
   {
     $ this-&gt; env-&gt; initRuntime ();<font></font>
<font></font>
     // line 1
     echo "Hello";
     echo (isset ($ context ['name'])? $ context ['name']: null);
   }
 } </pre><br><br><blockquote>  Many are worried about debugging.  As you can see, the generated code is very clean, contains the name and lines of the original template.  This should be more than enough to easily debug all problems. </blockquote><br><br>  You can find it incredibly verbose than the PHP version, and, of course, the PHP version will be incredibly simpler: <br><pre>  Hello &lt;? Php echo $ name?&gt; </pre><br><br>  But pay attention to the generated code of most template engines and you will see that Twig generates the cleanest and shortest version. <br><br>  At the request of many, I rewrote the tests, aligning the compilation and rendering phases.  As I expected, it didn‚Äôt change the numbers much.  Compiling such simple templates is not important by the time they are rendered 10,000 times. <br><br>  I also tested the templates in pure PHP.  Below is the updated table: <br><br><table><tbody><tr><th>  Library </th><th>  Time (sec) </th><th>  Memory (kb) </th></tr><tr><td>  Pure php </td><td>  2.4 </td><td>  114 </td></tr><tr><td>  Twig </td><td>  3 </td><td>  383 </td></tr><tr><td>  Phptal </td><td>  3.8 </td><td>  598 </td></tr><tr><td>  Dwoo </td><td>  6.9 </td><td>  1,645 </td></tr><tr><td>  Smarty 2 </td><td>  12.9 </td><td>  610 * </td></tr><tr><td>  Smarty 3 </td><td>  14.9 </td><td>  799 * </td></tr><tr><td>  Calypso </td><td>  34.3 </td><td>  614 </td></tr><tr><td>  eZ Templates </td><td>  53 </td><td>  2,783 </td></tr></tbody></table><br><blockquote>  Notice that the amount of memory used by Smarty is much less than in my previous test, because I wrapped the whole loop in <code>ob_start()/ob_end_clean()</code> which was unfair to other template engines.  This has now been fixed. </blockquote><br><br>  As expected, PHP is faster than Twig for simple templates.  But the harder they are, the smaller the difference will be, thanks to the purity of the code that Twig generates. <br><br><blockquote>  Test scripts were run from the command line without PHP accelerators, which in this case would still not help, because the entire test takes place in one PHP process. </blockquote><br><br>  Tests you can download here: <a href="">fabien.potencier.org/benchmarks.tgz</a> <br><br><h3>  Twig and symfony </h3><br>  This section is for those interested in implementing Twig in symfony. <br><br><h4>  Symfony 1.3 / 1.4 </h4><br>  Obviously, Twig will not be part of symfony 1.3, because at the end of next week, feature-freeze deadline is suitable, and also because symfony 1.3 is an evolution of symfony 1.2, not a revolution. <br><br><blockquote>  If someone wants to make Twig a plug-in for symfony 1.3, start a discussion on the symfony developer mailing list, and I will help you get started. </blockquote><br><br><h4>  Symfony 2.0 </h4><br>  At the moment, nothing concrete has been decided about Symfony 2, but Twig will not be the default templating engine.  I <em>think</em> Twig will be available as an <em>optional</em> plugin, well integrated with the kernel.  For example, it can be used to generate a backend (admin-generator) - to simplify its configuration (customization). <br><br>  And thanks to the symfony <a href="http://components.symfony-project.org/templating/">templating</a> component, developers will be able to use Twig and pure PHP together, depending on the needs. <br><br>  So, if you do not want to get involved with template engines, use pure PHP;  but if you want to win using Twig you can use it (it will be built in).  And, of course, if you have other plugins, they will not be a problem. <br><br><h3>  Total </h3><br>  I hope that this post answered some questions raised in the comments. </div><p>Source: <a href="https://habr.com/ru/post/76021/">https://habr.com/ru/post/76021/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../76003/index.html">Debian announces official support for DebSrc3.0</a></li>
<li><a href="../76004/index.html">Is the iPhone warranty in Russia a myth or a reality?</a></li>
<li><a href="../76007/index.html">"Predicted" date of announcement 8.0-RELEASE</a></li>
<li><a href="../76010/index.html">Pigeon impossible</a></li>
<li><a href="../76015/index.html">Global warming - the biggest scam in the history of mankind?</a></li>
<li><a href="../76022/index.html">Widgets on iPhone Lockscreen</a></li>
<li><a href="../76023/index.html">Remote Desktop in Linux</a></li>
<li><a href="../76024/index.html">How to do everything</a></li>
<li><a href="../76026/index.html">‚ÄúChinese‚Äù multiplication method</a></li>
<li><a href="../76028/index.html">If Earth had rings like Saturn</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>