<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Packaging a jvm application in a docker image</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All the advantages of the docker for the application have already been described many times on Habr√©, like its architecture. 

 We will solve the prac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Packaging a jvm application in a docker image</h1><div class="post__text post__text-html js-mediator-article">  All the advantages of the docker for the application have already been described many times on Habr√©, like its architecture. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/a1d/6ab/e0e/a1d6abe0e88d459cafac028f9c38a7a9.jpg"></div><br>  We will solve the practical task of packaging the jvm application and get a container with a miniature Linux, JDK and our application, which we publish on hub.docker.com and will be able to run anywhere. <a name="habracut"></a><br><br><h1>  Source application </h1><br>  If your jvm application consists of more than one file and the image needs to be generated regularly / automatically, then you can integrate the build process into maven using the <a href="https://github.com/spotify/docker-maven-plugin">com.spotify</a> plugin <a href="https://github.com/spotify/docker-maven-plugin">: docker-maven-plugin</a> .  If you use Gradle, then <a href="https://github.com/Transmode/gradle-docker">se.transmode.gradle: gradle-docker</a> will help you build the docker image.  An example for maven posted on <a href="https://github.com/igor-suhorukov/gitblit-docker-example">github</a> . <br><br>  In the publication we use jar from the central <a href="">maven repository</a> .  This is its own groove build, which is notable for aether provide packaged to resolve Grape dependencies and extended protocol support for java.net.URL.  For inquisitive minds: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Articles about groovy-grape-aether on Habr√©</b> <div class="spoiler_text">  <a href="https://habrahabr.ru/post/270145/">Street magic in scripts or what connects Groovy, Ivy and Maven?</a> <br>  <a href="https://habrahabr.ru/post/274875/">Debugging Groovy scripts with Grape based on maven aether.</a> <br>  <a href="https://habrahabr.ru/post/276719/">java.net.URL or the old horse will not spoil the furrow.</a> <br></div></div><br>  For me, this is a handy tool that I often use.  As an example, loading a jvm agent into a <a href="https://habrahabr.ru/post/269793/">running JVM</a> , an installer <a href="https://habrahabr.ru/post/274315/">for crate.io</a> , an example of <a href="https://habrahabr.ru/post/272105/">a site parser</a> ... <br><br>  Now groovy-grape-aether is also available in the <i>suckerukov / docker-groovy</i> docker image.  In a similar way, you can pack your jvm application. <br><br><h1>  Dockerfile </h1><br>  Describes on the basis of which existing image and with the help of which commands to form a new image. <br><br>  We use the way <b>frolvlad / alpine-oraclejdk8</b> , with gratitude <a href="https://habrahabr.ru/users/frol/" class="user_link">frol</a> for his work!  This image is based on Alpine Linux image + glibc and Oracle JDK 8u102.14.  <b>Compact</b> enough compared to debian / ubuntu based images.  As an alternative, the popular <b>anapsix / alpine-java</b> image is possible. <br><br><pre><code class="bash hljs">FROM frolvlad/alpine-oraclejdk8 EXPOSE 8080 ENV GROOVY_VERSION=2.4.5.4 RUN mkdir <span class="hljs-string"><span class="hljs-string">"/usr/lib/groovy"</span></span> &amp;&amp; \ wget <span class="hljs-string"><span class="hljs-string">"http://repo1.maven.org/maven2/com/github/igor-suhorukov/groovy-grape-aether/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$GROOVY_VERSION</span></span></span><span class="hljs-string">/groovy-grape-aether-</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$GROOVY_VERSION</span></span></span><span class="hljs-string">.jar"</span></span> -O /usr/lib/groovy/groovy-grape-aether.jar ENTRYPOINT [<span class="hljs-string"><span class="hljs-string">"java"</span></span>,<span class="hljs-string"><span class="hljs-string">"-jar"</span></span>,<span class="hljs-string"><span class="hljs-string">"/usr/lib/groovy/groovy-grape-aether.jar"</span></span>] CMD [<span class="hljs-string"><span class="hljs-string">"--help"</span></span>]</code> </pre> <br>  Here I indicated that port 8080 will listen to the application inside the container.  When starting the container, you can specify the -P parameter and then it will be tied to the dynamic port of the host machine, or the -p parameter and you can specify which port of the host corresponds to the port of the container. <br><br>  ENTRYPOINT determines which command with parameters will be launched at the start of the container.  For the command, it is possible to specify the default parameters using CMD. <br><br><h1>  We collect image locally </h1><br>  Run in the same directory as our Dockerfile command. <br><br><pre> <code class="bash hljs">docker build -t docker-groovy .</code> </pre> <br><h1>  Publish to hub.docker.com </h1><br>  You can skip this section if your project does not openource and you don‚Äôt need to share your image with the world. <br><br><h3>  We publish Dockerfile on github </h3><br>  In your github account, select New Repository and put the prepared Dockerfile there.  This example uses the <a href="https://github.com/igor-suhorukov/docker-groovy">docker-groovy</a> repository. <br><br><h3>  Customize the assembly in hub.docker.com </h3><br>  We create a free account on the <a href="https://hub.docker.com/">main page of</a> hub.docker by filling out the form and clicking "Sign Up".  Be sure to activate it using emails. <br><br>  In your <a href="https://hub.docker.com/account/authorized-services/">account</a> settings, go to the ‚ÄúLinked Accounts &amp; Services‚Äù tab and configure ‚ÄúLink Github‚Äù to your github account (another Bitbucket account option). <br><br>  In the menu at the top of the page, select Create-&gt; Create Automated Build, then click ‚ÄúCreate Auto-build Github‚Äù, select the repository and specify where in the Dockerfile repository.  At the next push to the repository on github, the automatic build will start.  You can also start the build manually. <br><br>  As a result of all the above actions, such a <a href="https://hub.docker.com/r/suhorukov/docker-groovy/">project on hub.docker.com has</a> turned out. <br><br><h1>  Container loading and use </h1><br>  Before use, we will receive an image from hub.docker. <br><br><pre> <code class="bash hljs">docker pull suhorukov/docker-groovy</code> </pre> <br>  And run the container with the gitblit.groovy script parameter. <br><br><pre> <code class="bash hljs">docker run -d -p 8080:8080 suhorukov/docker-groovy https://raw.githubusercontent.com/igor-suhorukov/git-configuration/master/gitblit.groovy</code> </pre> <br>  If an application needs access to resources that are external to the container in the file system (directories of the host machine, NFS, distributed file system), then you need to specify the mount points when creating the image in the VOLUME section of the Dockerfile.  If you need distributed execution and container containers, Kubernetes / Mesos / Swarm / fabric8.io / Rancher is more suitable for this technology that works with docker. <br><br>  Using the jvm application as an example, we created and published a miniature image on hub.docker.com, after which we launched the docker container with the application settings. </div><p>Source: <a href="https://habr.com/ru/post/310530/">https://habr.com/ru/post/310530/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../310520/index.html">Why Augmented Reality Adds Network Risk</a></li>
<li><a href="../310522/index.html">We launch our game on Android TV</a></li>
<li><a href="../310524/index.html">Nursery project on React-redux with diapers</a></li>
<li><a href="../310526/index.html">Step to the left, step to the right - scale. Or from absolute to simple order</a></li>
<li><a href="../310528/index.html">Plan "B": open a cafe or go to programmers?</a></li>
<li><a href="../310532/index.html">Preview Rambler.iOS # 8</a></li>
<li><a href="../310534/index.html">Dynamic DNS in C # and Yandex.API</a></li>
<li><a href="../310536/index.html">Encryption mechanisms in modern ransomware</a></li>
<li><a href="../310540/index.html">Why Google bought Api.ai - a startup with Russian roots</a></li>
<li><a href="../310544/index.html">Layout: display custom content</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>