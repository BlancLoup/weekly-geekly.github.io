<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experience in the development and production of prototypes of BLE sockets</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 

 I want to tell you how I developed and produced prototypes of sockets with the BLE interface. First of all, I would like to note that the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experience in the development and production of prototypes of BLE sockets</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr! <br><br>  I want to tell you how I developed and produced prototypes of sockets with the BLE interface.  First of all, I would like to note that the device was chosen for the experiment - as a workshop on design and programming (to sharpen a pencil for working with 3D design of the case and printed circuit board, and to understand the functioning of the BLE stack from TI).  An additional motivation was the presence of several successful projects on the kickstarter, developing such devices. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b35/8ee/b8d/b358eeb8d372dc5ab6d919ff341d0669.jpg" alt="image"><br><a name="habracut"></a><br><h4>  1. Functional device </h4><br>  It was originally planned to create a device made in the form factor of a conventional socket adapter, that is, the most compact, and the device should be able to: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      - manage the load (on and off - without dimming); <br>  - read current consumption; <br>  - turn on and off by timer / schedule; <br>  - disconnect when communication is lost (when the user conditionally leaves the premises). <br><br><h4>  2. Circuit design and PCB </h4><br>  The circuitry of the device is rather trivial - a transformerless switching power supply, an integral current sensor, a bundle of antimistor + triac for switching the load and the brains of the SoC CC2541 device from Texas Instruments.  At the time of choosing the element base, this was probably the most affordable chip with Bluetooth LE support, adequate debugging and development tools ( <a href="https://estore.ti.com/CC-DEBUGGER-Debugger-and-Programmer-for-RF-System-on-Chips-P1627.aspx">CC-debugger</a> , <a href="https://estore.ti.com/CC2541DK-SENSOR-CC2541-SensorTag-Development-Kit-P3192.aspx">sensortag</a> , <a href="https://estore.ti.com/CC2541DK-MINI-CC2541-Mini-Development-Kit-P4349.aspx">CC2541-DK-mini</a> ) and a proven, though not the most convenient IAR compiler. <br><br>  Altium designer summer 09 versions were used to design the circuitry and circuit board of the device, and later the project was moved to version 14. Despite the general acquaintance and a couple of implemented small projects, the <a href="http://www.youtube.com/user/SabuninAlexey">lessons from Alexey Sabunin</a> helped to move from P-cad to Altium.  I strongly advise. <br><br>  The dimensions of the device were determined based on the requirements of the form factor - hence the dimensions of the boards were determined and drawn (it immediately became clear that all components would not fit on one board - therefore it was decided to make two boards connected via pls-pbs connector. However, the question remains - whether all components fit on the boards, how to assemble them, so that the components from the neighboring boards do not touch each other, so that the power elements also do not touch the components and that all the stuffing fits into the size of the device? SolidWorks came to the rescue  my opinion, the most adequate means of 3D design. <br><br><h4>  3. 3D design and assembly of the device </h4><br>  Fortunately, there is the mutual compatibility of AD with 3D design tools using .step files.  It is noteworthy that only SolidWorks in the sp3 version of 2014 could adequately display the colors of the parts assigned in Altium Designer.  What is the problem for me is still covered in darkness.  So, after drawing in 3D parts of the case and several iterations of changing the layout of the boards, the assembly of the device began to look something like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/845/3ca/942/8453ca9428fdca20d6e76aa2a9647307.jpg" alt="image"><br><br>  Now it remains only to produce a device. <br><br><h4>  4. The first prototype </h4><br>  Traditionally I order exemplary quantities of printed circuit boards in <a href="http://rezonit.ru/">Rezonite</a> .  Not that it is very cheap, but always qualitatively and on time, and industrial batches are produced quite at the market price.  I also traditionally buy electronic components in two places - <a href="http://compel.ru/">Kompele</a> , where there is almost everything, and local <a href="http://promelec.ru/">Promelectronics</a> , where you can almost always buy something that is not in Kompele.  Separate attention deserves the first experience of 3D printing of body parts.  Printing was made familiar to FDM technology.  The result was a surprisingly positive red rosette: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/482/067/4ab/4820674ab810e21539198e47a28aa053.jpg" alt="image"><br><br>  After soldering and assembly of parts: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/402/561/a0c/402561a0cfcd0668167507a2d56b0ffb.jpg" alt="image"><br><br>  While waiting for the boards and electronic components, work began on the BLE profile for the device.  As it turned out, the TI stack for BLE looks much worse than the outside - the implementation of its own applications is not difficult, despite the relatively large amount of code for the 8051 platform. <br><br>  The result was quite a workable device - it really performs all the declared functions, while being placed in the stated envelope.  However, a few problems and questions left the prototype: <br><br>  - how to fasten the case parts to each other?  Should there be a collapsible connection? <br>  - how to make grounding? <br>  - How to improve the quality of the signal from the current sensor?  Is this power noise or is the current sensor inaccurate? <br><br>  I and my friends liked the product so much that it was decided to make a commercially packaged product.  This involved resolving issues: <br><br>  - writing software for smartphones; <br>  - housing for mass production (for the manufacture of the mold); <br>  - increase the maximum switching power (up to 2.5 kW versus 1.2 kW). <br><br><h4>  5. Second iteration of prototyping </h4><br>  And the first thing with which it was necessary to decide - whether to make the case collapsible.  By the will of fate, I do not trust the "latches" and similar compounds, so the option remained essentially the same - screw connection.  But unfortunately, there was no option how to organize such a connection.  Several types of screw rivets were tried, but none of them showed reliable fixation in thin plastic.  In the absence of other options, it was decided to make the new building non-separable - with adhesive bonding.  In addition, several structural elements were added for installing and fixing the ground.  As a result, the assembly began to look something like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dd9/384/574/dd93845748d439dbeec2aa215b8a0deb.jpg" alt="image"><br><br>  The power path was also redesigned for a maximum load of up to 3 kW (in fact, the triac in D2PAK changed the triac in DPAK), which resulted in several more PCB layout operations.  Since printed using the FDM method could not boast of either dimensional accuracy or surface quality, it was decided to print cases using the SLS technology.  The order was placed in the service <a href="http://i.materialise.com/">i.materialise.com</a> (more budget compared to domestic counterparts).  However ... UPS Free Shipping had a black side - the order was in the UPS warehouse in Moscow 26!  days than violated all my plans.  The new circuitry also failed: an elementary error (confused contacts of a triac) cost me a lot of nerves and spoiled the entire internal aesthetics of the prototypes.  In general, the new devices look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ea/722/d2f/6ea722d2fadda44d2e418e18cceabae1.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b7/d00/49e/0b7d0049eedb31f122c435e04e50d3d7.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/85e/66d/221/85e66d2214bf289ea6c1f175d2fa5f55.jpg" alt="image"><br><br>  Now I am busy reworking the board and searching for like-minded people in order to bring the product to the market.  First of all, applications for mobile platforms are needed.  Join now! </div><p>Source: <a href="https://habr.com/ru/post/231289/">https://habr.com/ru/post/231289/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../231277/index.html">We open possibilities of map in nginx</a></li>
<li><a href="../231279/index.html">‚ÄúNo complications‚Äù home video surveillance: AdvoCam-HappyCam review</a></li>
<li><a href="../231281/index.html">Sass maps: responsive design without routine computing</a></li>
<li><a href="../231285/index.html">Financing innovation. Introduction</a></li>
<li><a href="../231287/index.html">Aspect oriented programming in Android</a></li>
<li><a href="../231293/index.html">E-Commerce Today: Art and Science</a></li>
<li><a href="../231295/index.html">Images in the layout. Enough tolerating this</a></li>
<li><a href="../231297/index.html">Squares game</a></li>
<li><a href="../231299/index.html">Overview of manufacturers of consumables for FDM 3D printers</a></li>
<li><a href="../231301/index.html">Migrating VMs from Xen 3.2 to XenServer 6.2 in Hetzner</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>