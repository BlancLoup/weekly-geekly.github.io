<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MS SQL (Win1251) - (?) -> Qt (Unicode)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A small hack to convert windows-1251 encoding to MSSQL to Unicode for Qt5. 

 There are still systems that use mssql in the win encoding. To one such ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MS SQL (Win1251) - (?) -> Qt (Unicode)</h1><div class="post__text post__text-html js-mediator-article">  A small hack to convert windows-1251 encoding to MSSQL to Unicode for Qt5. <br><a name="habracut"></a><br>  There are still systems that use mssql in the win encoding.  To one such system, I wrote an extension to Qt4 and solved the problem with Russian letters simply: by changing the encoding <br><pre><code class="cpp hljs">QTextCodec::setCodecForCStrings(QTextCodec::codecForName(<span class="hljs-string"><span class="hljs-string">"Windows-1251"</span></span>)); QTextCodec::setCodecForTr(QTextCodec::codecForName(<span class="hljs-string"><span class="hljs-string">"Windows-1251"</span></span>)); QTextCodec::setCodecForLocale(QTextCodec::codecForName(<span class="hljs-string"><span class="hljs-string">"Windows-1251"</span></span>));</code> </pre> <br>  Time passes and I translate my projects to Qt5 if possible.  However, the codec change commands were removed there.  Everything should be in unicode, which is correct.  And the solution did not always work and not on every version of the OS win. <br><br>  In my program, I do not directly display the result of the SQL query in the model, so I have solved the problem so far: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   QSqlDatabase db = QSqlDatabase::addDatabase("QODBC"); db.setUserName("&lt;username&gt;"); db.setPassword("&lt;userpass&gt;"); db.setDatabaseName("DRIVER={SQL Server};Server=&lt;servername&gt;;Database=&lt;databasename&gt;;Regional=Yes"); // SQL-,       query-&gt;exec( "select cast(&lt;fieldname&gt; as varbinary) from &lt;tablename&gt;"); //   QTextCodec *codec = QTextCodec::codecForName("Windows-1251"); //          Unicode.      Qt ... = codec-&gt;toUnicode(queryl-&gt;value( 0 ).toByteArray());</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Interestingly, if the field is not converted to a <code>varbinary</code> , then the <code>.toByteArray()</code> method will <code>.toByteArray()</code> already corrupted data. <br><br>  <b>And maybe someone knows the connection string for data in Unicode?</b> </div><p>Source: <a href="https://habr.com/ru/post/234089/">https://habr.com/ru/post/234089/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234073/index.html">Clinical speech signal processing and machine learning. Part 1</a></li>
<li><a href="../234075/index.html">Twitter has begun to introduce extraneous tweets to the tape</a></li>
<li><a href="../234079/index.html">Cup PEGTOP (Cup-Yula) - a funny object or a killer of teaspoons?</a></li>
<li><a href="../234081/index.html">Looking for a Hype Cycle in Google Trends !?</a></li>
<li><a href="../234083/index.html">Redesign concept vk.com</a></li>
<li><a href="../234091/index.html">Club $ 40,000 and a business built on the sale of open-source hardware</a></li>
<li><a href="../234093/index.html">Two years on Mars - what does Curiosity look like now?</a></li>
<li><a href="../234095/index.html">Java and Microsoft Cloud - Brief Essays</a></li>
<li><a href="../234099/index.html">MIT scientists use old acid car batteries to create solar panels</a></li>
<li><a href="../234101/index.html">Reverse engineering and game patch on Unity3d</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>