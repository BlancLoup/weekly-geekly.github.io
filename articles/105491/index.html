<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DNS of your domain: problem and protection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the good old days, our project was repeatedly subjected to DDoS attacks of different types, of different power and duration. We have worked out man...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DNS of your domain: problem and protection</h1><div class="post__text post__text-html js-mediator-article">  In the good old days, our project was repeatedly subjected to DDoS attacks of different types, of different power and duration.  We have worked out many different methods of protection, as well as optimized the very structure of the service, partly in the aspect of hosting and the location of servers.  An important part of a learned lesson was the correct <a href="http://ru.wikipedia.org/wiki/DNS">DNS</a> setting.  As shown by the <a href="http://habrahabr.ru/blogs/announcements/104777/">latest attack on Habr</a> and comments about problems similar to ours, not everyone pays enough attention to protecting the DNS, but is very, very vain. <br><br><a name="habracut"></a><br><br>  Let's start to understand what could be the wrong DNS setup for us in case of problems. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1. ‚ÄúLived happily ever after‚Äù is not about records in the DNS zone.  This is the first thing that causes a problem with an emergency IP change (and not an emergency one either).  Those times have long passed when customers ignored low <a href="http://ru.wikipedia.org/wiki/Time_to_live">ttl</a> and simply did not allow using ttl below a certain value.  Now it‚Äôs quite normal to use a recording lifetime of 5-10 minutes.  Yes, this is expressed in additional traffic, but you must admit that it is insignificant against the background of normal traffic generated by the subsequent http request. <br><br>  This is the most intuitive point.  In the event of an attack, you get the opportunity to quickly switch to other servers (if the attack is on a specific IP).  This will also help to quickly disable the fallen node when using <a href="http://ru.wikipedia.org/wiki/Round_robin_DNS">round-robin</a> . <br><br>  In the event of an attack on a specific IP, we begin to play cat and mouse with the attacker, and the occupation is, frankly, ungrateful and most often useless.  First of all, you need to have enough IP pool in order to transfer the site from one to another, sending the old one just nowhere.  Secondly, an attacker will simply get bored and he will solve the problem at once - your name servers will be attacked, which are responsible for resolving the domain. <br><br>  2. Do you host NS on the same server (s) as the site itself?  Then problems come to you.  By attacking your server, the attacker gets a double benefit: both the site is laid down and the clients have blocked access to updated information about the zone.  Thus, even with a ttl of 60, the site will still remain inaccessible if you switch to the backup IP, because this information cannot be obtained.  Keeping the site and the name server on the same site is detrimental and this will immediately show itself from the worst side at the first problem. <br><br>  3. DNS hosting will not save the father of Russian democracy!  More precisely, not every DNS hosting.  Even using external, paid or free DNS hosting services, you do not protect yourself 100%.  If this service is located on 2, 3 or even 4 geographically remote servers, which supposedly should guarantee 100% reliability, in fact, 4 servers with a 10 mbps unlim channel do not guarantee anything.  They are successfully clogged with a small botnet, which is much cheaper for an attacker (customer) than to attack your super-secure site with a gigabit channel and already established protection schemes.  When using a DNS hosting service, it is important to make sure that the service provider itself has sufficient protection, because it will lie - you will lie down, and this is already thinking much less than about the first paragraph. <br><br>  As a bonus, we offer a table with tariffs for DNS hosting, which we managed to sketch on the results of issuing the first page of Google. <br><table><tbody><tr><td>  provider <br><br></td><td>  # of domains <br><br></td><td>  # of records <br><br></td><td>  # of queries <br><br></td><td>  minimum ttl <br><br></td><td>  cost / month <br><br></td><td>  cost / year <br><br></td></tr><tr><td>  <a href="https://www.neustar.biz/services/ultradns-services/managed-external-dns/store%3Futm_source%3Dultra_landing_page%26utm_medium%3Dbuy_now_banner%26utm_content%3Dexternal_DNS%26utm_campaign%3Dultra_acquistion">neustar</a> <br><br></td><td>  ten <br><br></td><td>  1,000 <br><br></td><td>  100,000 <br><br></td><td><br></td><td>  50 <br><br></td><td><br></td></tr><tr><td>  neustar <br><br></td><td>  100 <br><br></td><td>  5,000 <br><br></td><td>  250,000 <br><br></td><td><br></td><td>  110 <br><br></td><td><br></td></tr><tr><td>  neustar <br><br></td><td>  100 <br><br></td><td>  5,000 <br><br></td><td>  400,000 <br><br></td><td><br></td><td>  160 <br><br></td><td><br></td></tr><tr><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td></tr><tr><td>  <a href="http://zonomi.com/%3Fgclid%3DCP3Wser99KMCFYZo4wod1EK64A">zonomi</a> <br><br></td><td>  one <br><br></td><td>  ten <br><br></td><td><br></td><td><br></td><td>  0 <br><br></td><td>  0 <br><br></td></tr><tr><td>  zonomi <br><br></td><td>  ten <br><br></td><td>  100 <br><br></td><td><br></td><td><br></td><td><br></td><td>  ten <br><br></td></tr><tr><td>  zonomi <br><br></td><td>  15 <br><br></td><td>  150 <br><br></td><td><br></td><td><br></td><td><br></td><td>  ten <br><br></td></tr><tr><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td></tr><tr><td>  <a href="http://www.dnsmax.com/manageddns/purchase.php">dnsmax</a> <br><br></td><td><br></td><td>  25 <br><br></td><td>  20,000 <br><br></td><td>  300 <br><br></td><td>  3 <br><br></td><td>  36 <br><br></td></tr><tr><td>  dnsmax <br><br></td><td><br></td><td>  100 <br><br></td><td>  50,000 <br><br></td><td>  60 <br><br></td><td>  12 <br><br></td><td>  144 <br><br></td></tr><tr><td>  dnsmax <br><br></td><td><br></td><td>  500 <br><br></td><td>  100,000 <br><br></td><td>  one <br><br></td><td>  25 <br><br></td><td>  300 <br><br></td></tr><tr><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td></tr><tr><td>  <a href="http://www.dyndns.com/services/dns/custom/">dyndns</a> <br><br></td><td><br></td><td>  75 <br><br></td><td>  600,000 <br><br></td><td><br></td><td><br></td><td>  thirty <br><br></td></tr><tr><td>  dyndns smb <br><br></td><td>  ten <br><br></td><td>  100 <br><br></td><td>  600,000 <br><br></td><td><br></td><td>  thirty <br><br></td><td><br></td></tr><tr><td>  <a href="http://www.dyndns.com/services/dynectsmb/">dyndns smb</a> <br><br></td><td>  25 <br><br></td><td>  250 <br><br></td><td>  600,000 <br><br></td><td><br></td><td>  60 <br><br></td><td><br></td></tr><tr><td>  <a href="http://dyn.com/enterprise-dynect-platform/dynect-platform-pricing-3">dyndns</a> (custom) <br><br></td><td><br></td><td><br></td><td><br></td><td><br></td><td>  &gt; 195 <br><br></td><td><br></td></tr><tr><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td><td><br></td></tr><tr><td>  <a href="http://www.dnsmadeeasy.com/enterprisedns/pricing.html">dnsmadeeasy</a> <br><br></td><td>  ten <br><br></td><td>  400 <br><br></td><td>  5,000,000 <br><br></td><td><br></td><td><br></td><td>  thirty <br><br></td></tr><tr><td>  dnsmadeeasy <br><br></td><td>  25 <br><br></td><td>  1,000 <br><br></td><td>  10,000,000 <br><br></td><td><br></td><td><br></td><td>  60 <br><br></td></tr><tr><td>  dnsmadeeasy <br><br></td><td>  50 <br><br></td><td>  2,000 <br><br></td><td>  50,000,000 <br><br></td><td><br></td><td><br></td><td>  150 <br><br></td></tr></tbody></table><br><br>  As we can see, a low ttl with a large attendance will cost us a lot of money on all services except dnsmadeeasy, because of the extremely low number of requests allowed by the tariff.  Many services do not allow to use too low ttl, in particular - free ones.  The solution from dyndns, described in the last line, seemed quite good, but expensive. <br><br>  In the table there is no indicator of "protection" of the service, since this issue requires a more detailed study of each individual service.  It is important to understand that quality service will cost you a lot of money.  But if you are ready to invest in the infrastructure for your resource, then along with the cost of hosting, do not forget to pay a lot of money for the reliability of the name servers, which are the first step in visiting your resource.  It's worth it. <br><br>  Let's sum up: <br>  - ttl is better to put logical, in fact, it is individual for each resource.  Too high is dangerous, and too low is expensive. <br>  - name servers are better to use external ones and not exactly located on the same site as the site <br>  - protect the name servers at least as much as the site and take the choice of DNS hosting at least as seriously as hosting the site. <br><br>  In addition to the recommendations written above, you can also discuss such wonderful features of competent work with DNS as round-robin, load-balancing and even DNS-firewall, which can make the life of many administrators easier and more fabulous, but this is a topic for a separate article. </div><p>Source: <a href="https://habr.com/ru/post/105491/">https://habr.com/ru/post/105491/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../105483/index.html">Complaint to the Russian provider from MediaSentry</a></li>
<li><a href="../105484/index.html">From idea to prototype in two days: HackDay # 9 will be held October 23-24 in St. Petersburg</a></li>
<li><a href="../105486/index.html">Tele2 in Omsk</a></li>
<li><a href="../105487/index.html">Verizon will pay its customers 90 million for wrong bills</a></li>
<li><a href="../105489/index.html">Button that you like 10 times more</a></li>
<li><a href="../105492/index.html">RMA-Silicon Trip. Yahoo office: in the wake of the purple cow</a></li>
<li><a href="../105495/index.html">Linux basics from the founder of Gentoo. Part 2 (2/5): Folder Assignments, File Search</a></li>
<li><a href="../105500/index.html">music.ivi.ru - we are fully opened</a></li>
<li><a href="../105501/index.html">Code on the coat of arms of the Governor-General of Canada</a></li>
<li><a href="../105503/index.html">Second Startup Weekend Report</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>