<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Notification of unread incoming letter using Arduino</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! 

 Recently I became interested in the Arduino platform. After the Arduino Mega 2560 board was received as a New Year present, I, like a dec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Notification of unread incoming letter using Arduino</h1><div class="post__text post__text-html js-mediator-article">  Good day! <br><br>  Recently I became interested in the Arduino platform.  After the Arduino Mega 2560 board was received as a New Year present, I, like a decent novice robotics lover, blinked a diode, including through a button (which, by the way, were dropped from an old disassembled computer mouse). <br><br>  It was after such standard experiments that I decided to do something useful.  I was inspired by various videos from youtube, which showed how with the help of Arduino + Python a physical notification was implemented (someone had a blinking light, someone had a checkbox) about receiving a new mail to the gmail box. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/502/493/14b/50249314b1dec9be703b15a773ac9c3b.png" alt="image"><br>  In this article I want to talk about my experience in creating such a ‚Äúnotification‚Äù.  From the "iron" you need very little, here's what I used: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      - Fee Arduino Mega 2560 - 1 pc. <br>  - USB cable for connecting the Arduino to the computer - 1 pc. <br>  - LED - 1 pc. <br><a name="habracut"></a><br>  I implemented the software part in C #.  A program running on a computer does the following: <br><br>  By timer, every 10 seconds the status of the mailbox is checked, if there are unread letters, then the value 1 is transmitted via the COM port, if there are no new letters, the value 2 is transmitted.  To communicate with a C # program with Arduino, the SerialPort component is used, which is a standard Toolbox element in the C # Windows Forms project in Visual Studio 2010. There you can also find a timer. <br><br>  To connect with the gmail mailbox and search for unread emails, use Mail.dll, which can be found on <a href="http://www.lesnikowski.com/">www.lesnikowski.com</a> (I would not call it an advertisement, rather, copyright, but a special thank you to the author).  The DLL is well documented, so we will not dwell on this point in detail.  Consider a code that ‚Äúreads letters‚Äù: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.ComponentModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Data; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Drawing; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Forms; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Lesnikowski.Client.IMAP; //       Mail.dll <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Lesnikowski.Mail; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Lesnikowski.Mail.Headers; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Lesnikowski.Mail.Headers.Constants; namespace Arduino_Mail_Notification { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> partial <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Form1 : Form { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Form1() { InitializeComponent(); } private <span class="hljs-type"><span class="hljs-type">void</span></span> timer1_Tick(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> sender, EventArgs e) //   { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (Imap imap = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Imap()) { imap.ConnectSSL("imap.gmail.com"); //  IMAP- imap.<span class="hljs-keyword"><span class="hljs-keyword">Login</span></span>("__e-mail", ""); //   imap.SelectInbox(); //      List&lt;long&gt; uids = imap.SearchFlag(Flag.Unseen); //    serialPort1.PortName = "COM15"; //  COM-,    Arduino serialPort1.<span class="hljs-keyword"><span class="hljs-keyword">Open</span></span>(); // COM- <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (uids.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) //    serialPort1.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>("1"); //  Arduino  "1" <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> //   serialPort1.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>("2"); //  Arduino  "2" serialPort1.<span class="hljs-keyword"><span class="hljs-keyword">Close</span></span>(); // COM- imap.<span class="hljs-keyword"><span class="hljs-keyword">Close</span></span>(); //   IMAP- } } } }</code> </pre> <br><br>  On the given code, anticipating questions, I will immediately answer some of them.  Yes, it was possible to open the port and connect to the server once, and not by timer, every 10 seconds.  Yes, I use someone else's dll-kami in this project, and not writing my classes.  The reason for this is that at this stage the goal was to create not an ideal C # code and not describe how to check mail in C #, but to make the notification of new letters work, with which this code copes successfully. <br><br>  What happens in Arduino when the numbers ‚Äú1‚Äù or ‚Äú2‚Äù arrive at it on the COM port?  And the following happens in it: <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">int</span></span> ledPin=<span class="hljs-number"><span class="hljs-number">13</span></span>; //     <span class="hljs-number"><span class="hljs-number">13</span></span>    <span class="hljs-type"><span class="hljs-type">int</span></span> ser=<span class="hljs-number"><span class="hljs-number">0</span></span>; //       C# "1"( )  "2" ( ) <span class="hljs-type"><span class="hljs-type">void</span></span> setup() { pinMode(ledPin,OUTPUT); //<span class="hljs-number"><span class="hljs-number">13</span></span>       <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">9600</span></span>);//  COM-   <span class="hljs-number"><span class="hljs-number">9600</span></span> / (      ) } <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> () { ser = <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>();//   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ser == <span class="hljs-string"><span class="hljs-string">'1'</span></span>) //  <span class="hljs-number"><span class="hljs-number">1</span></span> { digitalWrite(ledPin,HIGH); //  } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ser ==<span class="hljs-string"><span class="hljs-string">'2'</span></span>) // <span class="hljs-number"><span class="hljs-number">2</span></span> { digitalWrite(ledPin, LOW);//  } }</code> </pre><br>  Those.  on Arduino, a fairly simple program is written down that practically deals with ‚Äúphysical notification‚Äù - in my case, when an unread letter appears in a box, the LED lights up.  If the user has logged into his mailbox and read the letter, the diode will turn off within the next 10 and seconds of the timer, which will indicate that there are no unread letters. <br><br>  As an example, I will cite one of the many videos that inspired me to create my own ‚Äúnotification‚Äù: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/HYnR_bWVKT4%3Ffeature%3Doembed&amp;xid=17259,15700022,15700043,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhj9lnTNA5WhwuhN3qc0-1_ZgMVUIg" frameborder="0" allowfullscreen=""></iframe><br><br>  This is how my development of the Arduino began.  I hope this project once will find its practical application and not only in my hands. <br><br>  Successes! </div><p>Source: <a href="https://habr.com/ru/post/137179/">https://habr.com/ru/post/137179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137171/index.html">GrSecurity / PaX: preset security level</a></li>
<li><a href="../137172/index.html">Why I won't hire you</a></li>
<li><a href="../137173/index.html">Mozilla Firefox vibrates</a></li>
<li><a href="../137175/index.html">Casio CFX-9850G. Color graphing calculator, 1996</a></li>
<li><a href="../137177/index.html">PlanetLab Overview</a></li>
<li><a href="../137180/index.html">Rescue for paranoids or transfer mail from Gmail to Hotmail</a></li>
<li><a href="../137182/index.html">Copyright and Piracy Psychology</a></li>
<li><a href="../137183/index.html">EnterpriseDB: we will take away ‚Äúour own piece of cake‚Äù of the DBMS market from Oracle!</a></li>
<li><a href="../137184/index.html">Firefox 12 Home page will get a number of additional properties.</a></li>
<li><a href="../137185/index.html">Icons: raster vs vector</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>