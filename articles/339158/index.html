<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sometimes they come back. Mobile Banker BankBot again in Google Play</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The mobile banker, which we first talked about at the beginning of the year, has acquired new opportunities and is again being distributed through Goo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sometimes they come back. Mobile Banker BankBot again in Google Play</h1><div class="post__text post__text-html js-mediator-article">  The mobile banker, which we first <a href="https://habrahabr.ru/company/eset/blog/323068/">talked about</a> at the beginning of the year, has acquired new opportunities and is again being distributed through Google Play. <br><br>  During the year BankBot evolved, its versions appeared on Google Play and on unofficial sites.  Finally, on September 4, we found the first option on Google Play that combines all the features of evolution: improved code obfuscation, complicated functions for delivering the main components, a complex infection mechanism using the accessibility service Android Accessibility Service. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/d2/34/59d234f92d6f2176326187.jpeg"></div><br><a name="habracut"></a>  The ability to use the Android Accessibility Service previously demonstrated several Trojans that were distributed mainly outside of Google Play.  Recent studies by <a href="https://clientsidedetection.com/bankbot_dropper_hiding_on_google_play.html">SfyLabs</a> and <a href="https://www.zscaler.com/blogs/research/malware-google-play-abusing-accessibility-service">Zscaler have</a> confirmed that BankBot operators have added an application to Google Play that uses special features, but without a banker component. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ‚ÄúThe developed puzzle‚Äù with the function of the banker entered Google Play under the guise of the game Jewels Star Classic.  It is important to note that the attackers used the name of the popular legitimate line of games of the developer ITREEGAMER, which is not associated with a malicious campaign. <br><br>  We notified Google security about a malicious application.  However, the application installed approximately 5,000 users before it was removed. <br><br><h3>  Principle of operation </h3><br>  When a user downloads the Jewels Star Classic developer GameDevTony (picture below), he gets a working Android game with hidden add-ons ‚Äî a banker component hiding among game resources and a malicious service waiting in the hour after the predefined time delay. <br><br><img src="https://habrastorage.org/webt/59/d2/34/59d234f791d12487781441.png"><br>  <i>Figure 1. Malicious app on Google Play</i> <br><br>  The malicious service is activated 20 minutes after the first execution of Jewels Star Classic.  The infected device displays a message with a suggestion to include something called Google Service (a malicious notification appears regardless of the user's current activity, with no explicit connection to the game). <br><br>  The only way to remove the notification from the screen is to click "OK".  After that, the user is redirected to the accessibility menu of Android Accessibility, where services with these functions are managed.  Among the legitimate in the list appears a service called Google Service, created by malware.  The service description copies the original Google <a href="https://www.google.com/policies/terms">Terms of</a> Service. <br><br><img src="https://habrastorage.org/webt/59/d2/34/59d234f792029657790686.png" width="350"><br>  <i>Figure 2. A notification prompting the user to enable Google Service</i> <br><br><img src="https://habrastorage.org/webt/59/d2/34/59d234f7da135175906458.png" width="350"><br>  <i>Figure 3. Google Service listed among Android Accessibility services</i> <br><br><img src="https://habrastorage.org/webt/59/d2/34/59d234f8695bd610562889.png" width="350"><br>  <i>Figure 4. Malware description from Google‚Äôs user agreement</i> <br><br>  Deciding to activate the service, the user will see a list of required permissions: watching your actions, getting the contents of the window, turning on Explore by Touch, turning on improved web accessibility and managing gestures (Figure 5). <br><br>  Clicking on the ‚ÄúOK‚Äù button allows the use of special access services.  By giving these permissions, the user gives the banker complete freedom of action that is required to continue his malicious activity. <br><br><img src="https://habrastorage.org/webt/59/d2/34/59d234f88120b031649020.png" width="350"><br>  <i>Figure 5. Permissions required to activate Google Service</i> <br><br>  In practice, after accepting these permissions, the user will be temporarily denied access to the screen due to updating the Google Service;  in fact, it is not related to Google and works as a foreground process (Figure 6). <br><br><img src="https://habrastorage.org/webt/59/d2/34/59d234f8a4209048195667.png" width="350"><br>  <i>Figure 6. Screen that hides malicious activity</i> <br><br>  Malware uses this screen to hide the next steps ‚Äî using the obtained special access permissions.  While the user is waiting for a dummy update to download, the malware performs the following tasks: <br><br><ul><li>  allows installation of applications from unknown sources </li><li>  installs the BankBot from the set and runs it </li><li>  activates administrator rights for BankBot </li><li>  sets BankBot as default SMS exchange application </li><li>  gets permission to show on top of other applications </li></ul><br>  After successfully completing these tasks, the malware can start working on the next one ‚Äî stealing the victim‚Äôs credit card information.  Unlike other BankBot variants that target mobile banking applications and simulate login and password forms, this version ‚Äúspecializes‚Äù exclusively on Google Play, an application preinstalled on every Android device. <br><br>  When a user launches the Google Play application, BankBot enters and overlaps the legitimate application screen with a fake form to fill in the user's credit card information (Figure 7). <br><br><img src="https://habrastorage.org/webt/59/d2/34/59d234f8cc65b493021169.png" width="350"><br>  <i>Figure 7. Simulation of the form to fill in the data of the user's bank card</i> <br><br>  If the user did not recognize the fake and entered the bank card data, the attackers achieved success.  By setting BankBot as the default messaging application, malware intercepts all SMS messages that pass through an infected device.  This allows attackers to bypass the bank‚Äôs two-factor authentication, which is the last possible obstacle between them and the victim‚Äôs bank account. <br><br><h3>  What is dangerous BankBot </h3><br>  In this campaign, attackers put together several techniques that are becoming increasingly popular among malware authors for Android: using the Android Accessibility Service, masking under Google, and setting a timer that defers the execution of malicious activity to bypass Google‚Äôs security measures. <br><br>  These techniques make it difficult to timely recognize the threat of a victim.  Since the malware pretends to be Google and waits 20 minutes before the first notification is shown, the user has little chance of associating her activity with the recently downloaded Jewel Star Classic application.  Finally, many of the names used by malware in the infection process make it difficult to locate the threat and remove it manually. <br><br><h3>  How to clean the infected device? </h3><br>  If you often download apps from Google Play and other sites, you should check the presence / absence of BankBot on your device. <br><br>  Making sure there is no Jewels Star Classic is not enough, since attackers often change the applications used to distribute BankBot.  To find out if the device has been infected, we recommend checking the following symptoms: <br><br><ul><li>  Availability of an application called Google Update (Figure 8: located in the Settings&gt; Application manager / Apps&gt; Google Update menu) </li><li>  An active device administrator called System update (Figure 9: located in Settings&gt; Security&gt; Device administrators). </li><li>  Repeat Google Service Notification (Figure 2) </li></ul><br><br><img src="https://habrastorage.org/webt/59/d2/34/59d234f8f1c85555597382.png" width="350"><br>  <i>Figure 8. Malicious applications in the application manager</i> <br><br><img src="https://habrastorage.org/webt/59/d2/34/59d234f9231ac965237383.png" width="350"><br>  <i>Figure 9. BankBot disguised as a system update in the list of active device administrators</i> <br><br>  Any of these signs indicates a possible infection with a new variant of BankBot. <br>  To remove the malware manually, cancel the device administrator rights for the System update, then remove Google Update and the corresponding trojanized application. <br><br>  The search for a trojanized application that launched an infection (in our case, it is Jewels Star Classic) is difficult due to the 20-minute delay in the start of malicious activity, and also because it works in the expected way.  We recommend using a reliable mobile device security solution to detect and remove a threat with all its components. <br><br>  ESET products detect this BankBot version as Android / Spy.Banker.LA. <br><br><h3>  How to protect yourself? </h3><br>  In addition to using a reliable solution for the security of mobile devices, there are several preventive measures: <br><br><ul><li>  If possible, use official app stores, not alternative sources.  And although they are not perfect, Google Play does apply advanced security mechanisms, which third-party stores do not. </li><li>  Check applications before downloading - view the number of downloads, rating and reviews. </li><li>  After starting any installed application, pay attention to permission requests. </li></ul><br><h3>  Samples / Indicators of compromise <br></h3><br>  <b>Package Name</b> / <b>Hash</b> <br>  com.mygamejewelsclassic.app B556FB1282578FFACDBF2126480A7C221E610F2F <br>  com.w8fjgwopjmv.ngfes.app 4D3E3E7A1747CF845D21EC5E9F20F399D491C724 </div><p>Source: <a href="https://habr.com/ru/post/339158/">https://habr.com/ru/post/339158/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339148/index.html">React 16 server rendering innovations</a></li>
<li><a href="../339150/index.html">Submit the cool project: your API-client from one configuration file</a></li>
<li><a href="../339152/index.html">‚ÄúThe role of the analyst in making important product decisions‚Äù: video recordings of reports from the meeting</a></li>
<li><a href="../339154/index.html">Motivated installations from the USA (Android) - review of options, statistics, opinion</a></li>
<li><a href="../339156/index.html">Two facets of teleportation</a></li>
<li><a href="../339160/index.html">t1ha = Fast Positive Hash</a></li>
<li><a href="../339162/index.html">Text translation from the open door of Kaspersky Lab - Open Day 2017</a></li>
<li><a href="../339164/index.html">How I passed certification at Xamarin University</a></li>
<li><a href="../339166/index.html">How to find the best flights in the interface of Google-table</a></li>
<li><a href="../339170/index.html">How to successfully implement the Help Desk? 12 examples (part 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>