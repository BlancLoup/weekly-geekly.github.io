<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simulator for software testing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, dear habrozhiteli! 



 I'll tell you about my project, which I have been doing in my free time for three years. 

 I work in a compan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simulator for software testing</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, dear habrozhiteli! <br><br><img src="https://habrastorage.org/storage2/179/cb9/554/179cb95545e23e8a54bc8568fcb59bf6.jpg"><br><br>  I'll tell you about my project, which I have been doing in my free time for three years. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I work in a company engaged in automation as a programmer for controllers.  Lately, we mainly use Siemens, SIMATIC S7 PLC and WinCC visualization package, but there is experience from other manufacturers.  The company profile is the oil and gas sector (tank farms, pumping stations, railway racks, mooring complexes, fire extinguishing systems). <br><br>  Probably from the very first project, I was interested in the question of software testing up to the commissioning stage on real hardware.  Not so long ago, the post was <a href="http://habrahabr.ru/post/139180/">on Habr√©</a> - <a href="http://habrahabr.ru/post/139180/">Programming Siemens PLC on Simatic Step7</a> , and the adrenaline, which was mentioned in the comments, is familiar to me firsthand. <br><br>  At the moment, using my software platform, we can get rid of most of the errors and debug automated functions in comfortable office conditions (rather than sitting on a cable reel, in an unheated room, on a frosty winter day). <br><a name="habracut"></a><br><br><h4>  Introduction </h4><br>  In simplified form, our process control system consists of the following components: <br><br><ul><li>  Sensors (pressure, temperature) and actuators (valves, pumps). </li><li>  Programmable logic controller (PLC). </li><li>  Visualization system (SCADA, HMI). </li></ul><br>  From the sensors and actuators, the signals go to the PLC, are processed and transmitted to the visualization system with which the human operator interacts.  Operator commands are transmitted back to the PLC, which generates the necessary signals to control the actuators.  Automated functions and emergency protection (ESD) are implemented in the PLC. <br><br>  We usually have two people involved in the development.  One writes a program for the PLC, the second makes a visualization system.  Now we are trying to use the third one - the tester.  I can not say that we implement very complex control algorithms, but there is a specificity associated primarily with the size of the system.  For example, my current project has a total of about 2300 signals, most of which are input (about 1500). <br><br>  For testing, a stand consisting of a PLC and a visualization system is assembled in the office.  Some manufacturers offer software simulators PLC, so that, sometimes, you can do with conventional computer equipment.  For example, S7PLCSim from Siemens: <img src="https://habrastorage.org/storage2/c42/89a/60d/c4289a60d74ee3b592fec3953b5d9b8c.jpg"><br><br>  The question remains with sensors and actuators that are connected to our system via discrete / analogue input / output signals. <br><br>  Some PLC manufacturers provide tools for software simulation of input signals.  For example, through the Step7 programming environment of Siemens controllers, the value of any input signal can be set in a real PLC, force forced, and if you use a controller simulator, simply install via a graphical interface.  In the above illustration: IB 10 is the input byte, IW 5 is the input word, QB 7 and QW 2 are the output, and MD 123 is a double word in the controller's internal memory. <br><br>  Another approach that needs to be mentioned is the imitation of input signals at the iron level.  For us, this approach is inconvenient - too much time is spent on connection.  In addition, in the office, usually, there is only a processor module from the PLC, and modules for connecting input / output signals, which are placed in separate cabinets, are in stock or have already been sent for installation to the customer. <br><br>  It is clear that by such means, it is possible to conduct a simple check of the passage of signals from the controller to the visualization system and back.  You can debug not very complex automatic algorithms, the benefit is that there are breakpoints in Step7.  But if several pieces of equipment are involved in the algorithm (several pumps + strapping of valves and sensors), this is quite difficult. <br><br><h4>  Idea </h4><br><img src="https://habrastorage.org/storage2/677/146/7e9/6771467e9dc515084dbfc92822394da5.jpg"><br><br>  For several years now, for each of my projects, in addition to the PLC program, I create a software simulator of the object to be automated.  English-language sources sometimes refer to such systems as the Factory Acceptance Test (FAT) simulator (simulator for factory acceptance) and classify them according to the degree of reliability of the simulation.  There is not a lot of information on the creation of such simulators on the network, Matlab + Simulink, LabView are mainly used, someone implements a simulation inside the PLC.  There are special development tools - WinMOD, Mynah MiMiC, Siemens SIMIT, APROS. <br><br>  After some reflection, I decided to try to create my own platform.  First of all, there was a desire to learn something new (.NET and  #).  The circumstances were successful, and our company, for one of the projects, acquired a ready OPC client library.  This allowed me to concentrate on the main task. <br><br>  To create a software simulator for a stand with a real PLC, it is necessary to provide in it a substitution of data obtained from physical inputs to imitation.  Unfortunately, this has to be done in the controller program itself.  The next step is to provide access to this data through the OPC interface.  After that, you can start writing a PLC program and creating a simulator of the object to be automated. <br><br>  If you use S7PLCSim - in the substitution of data is not necessary.  In this case, the visualization system will have to be run on the same machine together with S7PLCSim and the object simulator (S7PLCSim restriction).  In case of power shortage, you can try to post them using the free utility NetToPLCSim. <br><br><h4>  Platform </h4><br>  The platform that I developed is similar to the primitive environment for creating visualization systems.  The work can be divided into three stages: <br><br><ol><li>  Creating variables (Item).  There are only three types: <br><ul><li>  Internal is an internal variable that is used for communication between objects inside the simulator. </li><li>  OPC is a variable associated with an external OPC server.  In this case, the simulator is an OPC client. </li><li>  S7PLCSim - this variable is intended for communication with the SIMATIC S7 controller simulator.  Memory areas I, Q, M and DB are supported. </li></ul>  At the current stage of development, the platform allows connection to only one SIMATIC S7 controller simulator and one OPC server.  On the other hand, all variables are visible by OPC, since the platform is an OPC server. <br><br>  You can add and delete variables while the simulator is running.  The system will not allow to delete a variable that is used. <br><br></li><li>  Creating simulation objects.  Currently, 13 types of objects are implemented.  Among them are quite primitive ones - discrete and analog sensors, and quite complex ones - an analog signal generator and a gate valve.  One of the object types allows you to write scripts in C #.  By configuring each simulation object, the user sets the variables (Item) that the given object will read or write, as well as its other parameters. <br><br>  Objects can be added, deleted and edited by its properties while the simulator is running. <br><br></li><li>  Creating a user interface.  As a base tabbed panel is used (TabControl).  On each created screen you can place the display of simulation objects.  For example, an analog sensor, you can display it as a slider, a field for entering a value or a graph, anywhere on the panel.  The same object can be displayed any number of times, on one or several panels, in different forms. <br><br>  In order to delete a simulation object, you must first delete all its displays on all panels. <br></li></ol><br>  The simulator configuration is saved as an XML file with a simple structure: <br><br><pre> &lt;ProcessSimulator&gt;
     &lt;Items&gt;
          [Variables]
     &lt;/ Items&gt;
     &lt;SimulationObjects&gt;
          [Simulation Objects]
     &lt;/ SimulationObjects&gt;
     &lt;Screens&gt;
          [Panels with simulated objects]
     &lt;/ Screens&gt;
 &lt;/ ProcessSimulator&gt;
</pre><br>  This allows you to edit it manually, generate scripts, for example in Excel, as well as fully utilize the version control system. <br><br>  So the simulator interface may look like: <br><img src="https://habrastorage.org/storage2/6d6/349/42c/6d634942c2388a4766d867a836129eb1.jpg"><br><br><h4>  Opportunities </h4><br>  Creating a simulator of an object to be automated offers many advantages: <br><br><ul><li>  <b>Ease of development and testing.</b>  By creating a program for a PLC and, in parallel with it, an object simulator, I can check every part of the code and simulate almost any situation.  The developer of the visualization system also uses all the conveniences of the simulator, without delving into the PLC program (and without pulling me, every time when he wants to check something).  A more or less normal graphical user interface allows you to bring a person to the test, who did not participate in its creation, and therefore, will find more errors than any of the creators.  In addition, even at the facility, you can switch the system into simulation mode, modify something and check it completely using the software method, without using real equipment. </li><li>  <b>Demonstration of the program part of the system, regardless of the degree of readiness of the rest.</b> </li><li>  <b>Operator training.</b>  The operation of the system in simulation mode allows the operator to study the operation of the system in more detail, and most importantly, without stress, (and find errors). </li><li>  <b>Simplify warranty support system.</b>  If you recreate the conditions of an error, sometimes you can do without a trip to the object. </li></ul><br><h4>  Further development </h4><br>  Since this is my first experience of creating something serious in C #, first of all, I would like to rework the architecture: <br><br><ul><li>  Select the layer responsible for external connections and implement them as plug-ins.  This will allow you to connect to multiple OPC servers and Siemens SIMATIC S7PLCSim instances.  It will also make it easier to add other types of connections, such as Modbus. </li><li>  Implement a class of visual elements not related to simulation objects.  At the moment, any user interface element on the screen is necessarily associated with the object of simulation, which is not very convenient.  Sometimes there really is not enough opportunity to draw something, insert a picture or just write an explanatory text. </li><li>  Create a plug-in system for simulation objects and their mappings.  The main direction of development of the platform is the expansion of the library of simulation objects, so the convenience of their creation and integration is a key factor. </li></ul><br><br><img src="https://habrastorage.org/storage2/e79/9fc/3bd/e799fc3bd260629ae817e016ca3a1fda.jpg"><br><br><h4>  Site </h4><br>  On the <a href="http://automation.ucoz.com/">automation.ucoz.com</a> website you can download a <s>demo version.</s>  <s>It is not limited in time, but in it you can create only 20 variables and 10 simulation objects (all types except C # scripts).</s>  full version (freeware). </div><p>Source: <a href="https://habr.com/ru/post/142596/">https://habr.com/ru/post/142596/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142590/index.html">7 reasons why AngularJS is cool</a></li>
<li><a href="../142592/index.html">Perlin Noise</a></li>
<li><a href="../142593/index.html">When you connect the IPTV service you</a></li>
<li><a href="../142594/index.html">Erlang. Recommendations for code design</a></li>
<li><a href="../142595/index.html">So, you decided to prohibit copying class objects in C ++.</a></li>
<li><a href="../142597/index.html">We learn MS SQL Server Reporting Services 2008 R2 to show HTML in reports</a></li>
<li><a href="../142598/index.html">The story of another electric bicycle with their own hands</a></li>
<li><a href="../142599/index.html">The most common SQL injection pattern in PHP is the useless escape of characters.</a></li>
<li><a href="../142600/index.html">Difficult choice of Python or PHP. And maybe both?</a></li>
<li><a href="../142601/index.html">Umi.CMS developer problem tree, options for slowing growth</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>