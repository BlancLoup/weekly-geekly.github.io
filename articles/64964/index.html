<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Refactoring: mission (not) possible?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What to do if the source of the project resembles a swamp, and it is planned to live in it for a long time? Refactoring project source codes is the mo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Refactoring: mission (not) possible?</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="http://pic.ipicture.ru/uploads/090720/Emu6Bh5yts.jpg">  What to do if the source of the project resembles a swamp, and it is planned to live in it for a long time?  Refactoring project source codes is the more advantageous of the two alternatives to deal with this problem.  The second of the alternatives - throwing away and rewriting everything anew - usually does not suit, for various reasons. <br><br>  And how to do this very refactoring, even if it is not known where to start?  How to drain the swamp code and not to drown it? <br><br>  Of course, the ideal option is to consider refactoring as one of the activities on the project from the very beginning and allocate the project time to it.  In life, oddly enough, but most often it turns out that the previous lead of the project was not much puzzled by this issue, preferring to go with the flow;  perhaps he was hoping someday to relieve this burden of a less fortunate lead ‚Äî before the project fell apart;  or maybe just did not know what to do.  Chief, usyo is gone! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  I'll tell you how I do. <br><br>  <u>Rule number 1: refactoring is a process.</u>  Therefore, first of all, you need to become friends with the thought that it will not be possible to alter the ‚Äúzashib‚Äù either in a week or in two.  After understanding this fact, we take the book by M. Fizer, ‚ÄúWorking Effectively With the Legacy Code‚Äù (Effective Work with Legacy Code), and begin to get acquainted with it.  At the same time, we make sure that we are well accustomed to the source control, which we use, and in parallel with reading the book we put in order the code (primary ‚Äúsweep‚Äù): we delete the commented out and ‚Äúdead‚Äù code, it has no place in the project;  we structure "porridge" by files;  We align with the coding convention.  More serious alterations at this stage it is better not to carry out.  If there is an opportunity to write unit tests, you should think about it (but not to do it, as it‚Äôs usually useless at this stage to write them, let's endure until the next :). <br><br>  <u>Rule number 2: source control around the head</u> .  You will laugh if you know how many people do not know what brunch is.  A good knowledge of source control will help you not to end up a final project if some of your many changes are ‚Äúincompatible with life‚Äù.  In such a situation, only rollback will save the father of Russian democracy.  Sobsna, I recommend the well-known work of SvnBook <a href="http://svnbook.red-bean.com/nightly/ru/svn-book.html">tyts</a> , especially in terms of the brunch, even if you do not have svn.  You can also search online for slides Source control &amp; Agile <a href="http://www.infoq.com/resource/articles/agile-version-control/en/resources/Agile-version-control-with-multiple-teams-InfoQ-v1.3.pdf">and tyts</a> .  Very fun about the source control is written <a href="http://alenacpp.blogspot.com/2008/01/wiki.html">here</a> . <br><br>  <u>Rule number 3: automate the routine, this is a sign - to luck :)</u> This is me to the fact that it is worth acquiring some system autobild, to collect the project could be in one click.  Such a system is really a plus for morality, because I have repeatedly encountered the situation when the project needed to be built by hands from the studio, copying artifacts in a complex sequence through strange shared folders on the network for half an hour, and this situation greatly discouraged people from then change.  I used CruiseControl for a long time (I recommend), TeamBuild from TFS (party policy) is used, but not fundamentally - make / ant / nant, launched from the console, comes down to start. <br><br>  By the time the book is read, the codebase should look decent so that, at least, not sick of the source, and also easily rebuilt.  Of course, oh how far the feeling of the beauty of the project, and the architecture is not that limping - barely walks :) <br><br>  <u>Rule number 4: start small but good</u> .  Namely: the further strategy of working with the project is as follows: for the part of the project we are working on, we select a sandbox in which everything will be ‚Äúas it should be‚Äù - isolate it from the rest of the code, write it _good_ - OOP, best practices in hand.  Unit tests are highly desirable.  Highly because refactoring to a keen eye and an honest word is better never at all :) <br><br>  As we write our code, it will become clear that our subsystem will have to somehow access the rest of the code in some way.  We separate this interaction surface into a separate API (for .net, for example, I create a static class through which methods my code interacts with the old one) and also write unit-tests for it.  How exactly do it and how neatly - it is not fundamental, because we will gradually get rid of it.  After our ‚Äúbeautiful‚Äù code successfully works with this API, and there are tests for this API, you can look behind it, and refactor the existing ‚Äúmeat‚Äù according to the book you read, continuing to cover the tests inwards.  The book to which I referred, also describes techniques that can help if you do not start with your own sandbox, but add functionality to the existing (bad) code. <br>  In general, from here a smoothly expires (swamp well, after all!) <u>Rule 5: it works - do not touch, but write a unit test, then break it</u> .  And that - if our code somehow climbs there. <br><br>  In general, ‚Äúfrom a long distance,‚Äù the process of refining the project should look like a crystallization of the brine ‚Äî it begins at a small point and gradually covers the entire project, dividing it into pieces, which then ‚Äúcrystallize‚Äù.  Your sandbox will be this little point where it all begins.  <u>Rule number 6: divide and conquer - i.e.</u>  <u>figure it out, fix it, change it</u> . <br><br>  I almost forgot - at each stage of your long (do not hesitate;) ways, you may find useful tools for automatic code analysis - (Visual) NDepend, FxCop and Gendarme for .net / mono, simian, all sorts of line counters and others (lint, for example, if you are C / C ++).  Java-, php- and other comrades can enter the required. <br><br>  It seems everything. <br>  In the comments I would like to see your ways of taxiing the ‚Äúbydlokod‚Äù by refactoring - there is nothing to hide useful information. </div><p>Source: <a href="https://habr.com/ru/post/64964/">https://habr.com/ru/post/64964/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../64951/index.html">The winner of the summer special episode FPPP</a></li>
<li><a href="../64954/index.html">Crypto-protection of human images in the CCTV video stream</a></li>
<li><a href="../64956/index.html">Kolobok in SMF</a></li>
<li><a href="../64960/index.html">BrainWork commercial</a></li>
<li><a href="../64961/index.html">Why did the United States and the USSR stop flying to the moon at the same time?</a></li>
<li><a href="../64965/index.html">Digital drugs came up with record companies ... probably</a></li>
<li><a href="../64971/index.html">In Zend We Trust</a></li>
<li><a href="../64972/index.html">Feature position: fixed, or why I had to block side vertical buttons like "Leave your review"</a></li>
<li><a href="../64975/index.html">Pluralization</a></li>
<li><a href="../64976/index.html">Using composite keys to manipulate memcached data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>