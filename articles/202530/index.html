<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tiny Arkanoid in JavaScript (30 lines of code)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Watching how people in 30 lines of javascript fit excel and snake , I decided to keep up with progress, and create something like that. 
 So, ladies a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tiny Arkanoid in JavaScript (30 lines of code)</h1><div class="post__text post__text-html js-mediator-article">  Watching how people in 30 lines of javascript fit <a href="http://habrahabr.ru/post/202304/">excel</a> and <a href="http://habrahabr.ru/post/202476/">snake</a> , I decided to keep up with progress, and create something like that. <br>  So, ladies and gentlemen - 30ti line Arkanoid on pure JS. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/86f/6c1/196/86f6c119618c47ee3b2239f33b9c0d58.png"><br><a name="habracut"></a><br>  Link to <a href="http://jsfiddle.net/martin_/Fq8F4/">fiddle</a> . <br>  I will also duplicate the <a href="http://codepen.io/anon/pen/kIBhj">codepen</a> , and then the fiddle replied the whole night with 500k. <br><br>  Javascript: <br><pre><code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fld, pF, px, py, dx, dy, lifes, score</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cycle = setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bx = pF(ball.style.left = pF(ball.style.left) + dx + <span class="hljs-string"><span class="hljs-string">'px'</span></span>), by = pF(ball.style.top = pF(ball.style.top) + dy + <span class="hljs-string"><span class="hljs-string">'px'</span></span>), row = ((by - <span class="hljs-number"><span class="hljs-number">30</span></span>) / <span class="hljs-number"><span class="hljs-number">14</span></span>) | <span class="hljs-number"><span class="hljs-number">0</span></span>, col = (bx / <span class="hljs-number"><span class="hljs-number">32</span></span>) | <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bx &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; dx &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || bx &gt;= <span class="hljs-number"><span class="hljs-number">314</span></span> &amp;&amp; dx &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) dx *= <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bx + <span class="hljs-number"><span class="hljs-number">6</span></span> &gt;= px &amp;&amp; bx + <span class="hljs-number"><span class="hljs-number">6</span></span> &lt;= px + <span class="hljs-number"><span class="hljs-number">64</span></span> &amp;&amp; by &gt;= <span class="hljs-number"><span class="hljs-number">259</span></span> &amp;&amp; by &lt;= <span class="hljs-number"><span class="hljs-number">264</span></span>) { dy *= <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bx + <span class="hljs-number"><span class="hljs-number">6</span></span> &lt;= px + <span class="hljs-number"><span class="hljs-number">21</span></span>) dx = <span class="hljs-number"><span class="hljs-number">-6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bx + <span class="hljs-number"><span class="hljs-number">6</span></span> &gt;= px + <span class="hljs-number"><span class="hljs-number">43</span></span>) dx = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.abs(dx) == <span class="hljs-number"><span class="hljs-number">6</span></span>) dx = (dx * <span class="hljs-number"><span class="hljs-number">2</span></span> / <span class="hljs-number"><span class="hljs-number">3</span></span>) | <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (by &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) dy *= <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (by &gt;= <span class="hljs-number"><span class="hljs-number">288</span></span> &amp;&amp; !--lifes) clearInterval(cycle), alert(<span class="hljs-string"><span class="hljs-string">'Game over!'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (by &gt;= <span class="hljs-number"><span class="hljs-number">288</span></span> &amp;&amp; lifes) dy *= <span class="hljs-number"><span class="hljs-number">-1</span></span>, lifesNode.innerHTML = lifes; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (by &gt;= <span class="hljs-number"><span class="hljs-number">18</span></span> &amp;&amp; by &lt;= <span class="hljs-number"><span class="hljs-number">100</span></span> &amp;&amp; fld[row * <span class="hljs-number"><span class="hljs-number">10</span></span> + col].className != <span class="hljs-string"><span class="hljs-string">'removed'</span></span>) { dy *= <span class="hljs-number"><span class="hljs-number">-1</span></span>, fld[row * <span class="hljs-number"><span class="hljs-number">10</span></span> + col].className = <span class="hljs-string"><span class="hljs-string">'removed'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dx &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; ((bx | <span class="hljs-number"><span class="hljs-number">0</span></span>) % <span class="hljs-number"><span class="hljs-number">32</span></span> &lt; <span class="hljs-number"><span class="hljs-number">10</span></span> || (bx | <span class="hljs-number"><span class="hljs-number">0</span></span>) % <span class="hljs-number"><span class="hljs-number">32</span></span> &gt; <span class="hljs-number"><span class="hljs-number">22</span></span>)) dx *= <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dx &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; (((bx + <span class="hljs-number"><span class="hljs-number">12</span></span>) | <span class="hljs-number"><span class="hljs-number">0</span></span>) % <span class="hljs-number"><span class="hljs-number">32</span></span> &lt; <span class="hljs-number"><span class="hljs-number">10</span></span> || ((bx + <span class="hljs-number"><span class="hljs-number">12</span></span>) | <span class="hljs-number"><span class="hljs-number">0</span></span>) % <span class="hljs-number"><span class="hljs-number">32</span></span> &gt; <span class="hljs-number"><span class="hljs-number">22</span></span>)) dx *= <span class="hljs-number"><span class="hljs-number">-1</span></span>; scoreNode.innerHTML = ++score; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (score == <span class="hljs-number"><span class="hljs-number">50</span></span>) clearInterval(cycle), alert(<span class="hljs-string"><span class="hljs-string">'Victory!'</span></span>); } }, <span class="hljs-number"><span class="hljs-number">1000</span></span> / <span class="hljs-number"><span class="hljs-number">60</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'mousemove'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ px = (e.pageX &gt; <span class="hljs-number"><span class="hljs-number">40</span></span>) ? ((e.pageX &lt; <span class="hljs-number"><span class="hljs-number">290</span></span>) ? e.pageX - <span class="hljs-number"><span class="hljs-number">40</span></span> : <span class="hljs-number"><span class="hljs-number">256</span></span>) : <span class="hljs-number"><span class="hljs-number">0</span></span>; paddle.style.left = px + <span class="hljs-string"><span class="hljs-string">'px'</span></span>; }, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); }(field.children, <span class="hljs-built_in"><span class="hljs-built_in">parseFloat</span></span>, <span class="hljs-number"><span class="hljs-number">129</span></span>, <span class="hljs-number"><span class="hljs-number">270</span></span>, <span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>));</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In general, I tried to achieve maximum authenticity: <br><ul><li>  the angle of reflection of the ball depends (slightly) on which side of the racket it fell: when falling on the left third the ball flies to the left, when hit on the right third it flies to the right (in both cases the projectile reflects at a slightly larger angle than when hitting the middle) , when it hits the center, the ball flies off at 45 ¬∞ and its direction along the X axis does not change. </li><li>  Scoring (and how without it). </li><li>  Given three lives.  However, when the ball hits the lower edge, the game does not reset, and the ball just bounces and one life is taken away. </li></ul><br><br>  Among the shortcomings: the ball sometimes inadequately behaves and breaks too many bricks. <br><br><h4>  Under the hood </h4><br>  With the layout is simple.  Bricks - inline-blocks, racket and projectile - position: absolute. <br><br>  But with collision detection a little more interesting.  The area where the bricks are located is bounded above and below, which means it makes sense to check the collisions only when the projectile is in this area.  The height and width of the bricks is determined.  Therefore, taking the coordinates of the ball, we can accurately determine the number of the brick in which it fell.  If its coordinates are <code>X</code> and <code>Y</code> , and the width and height of bricks are width and height, then taking the integer part from the particular <code>X / width</code> and <code>Y / height</code> we get exactly the column and row number col and row of the current target.  Knowing this, we can calculate the number of this element: <br>  <code>number = row * rowLength + col</code> . <br>  Fortunately, <code>querySelectorAll</code> returns the elements in exactly the order in which they are arranged in html.  And we can easily remove the current brick: <br>  <code>elements[number].className = 'removed'</code> . <br><br><h4>  setInterval </h4><br>  Despite the fact that the native <code>requestAnimationFrame</code> already <a href="http://caniuse.com/requestanimationframe">implemented</a> in all desktop browsers, it was decided to abandon it in favor of setInterval.  Firstly, it also allows you to cover the old versions, and secondly, it saves one (precious!) Line of code: <br><pre> <code class="javascript hljs">requestAnimationFrame(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">frame</span></span></span><span class="hljs-function"> </span></span>{ requestAnimationFrame(frame); }); <span class="hljs-comment"><span class="hljs-comment">//  var cycle = setInterval(function () { }, delay);</span></span></code> </pre><br><br><h4>  Total </h4><br>  The code, in my opinion, turned out quite compact.  The longest line is 88 characters (including indentation).  The game itself is a bit crooked, well, what else can you expect from 30 lines?) <br>  Now apparently, as someone noticed in the comments to previous posts, it is worth waiting for "Tiny Windows" in 30 lines. </div><p>Source: <a href="https://habr.com/ru/post/202530/">https://habr.com/ru/post/202530/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../202508/index.html">Modem 1200KN-01. Made in USSR</a></li>
<li><a href="../202514/index.html">Sold two million Raspberry Pi</a></li>
<li><a href="../202524/index.html">How to invest $ 100,000 in your own karma (part 2)</a></li>
<li><a href="../202526/index.html">How does Forex work and is it needed?</a></li>
<li><a href="../202528/index.html">Search for various variants of transliteration of Russian texts (full name) in Latin for samples in MySQL</a></li>
<li><a href="../202534/index.html">Problems of transition to middle managers</a></li>
<li><a href="../202536/index.html">Making Hyperboria hotspot. Allowance for picking the router</a></li>
<li><a href="../202538/index.html">Dual Standards for Account Encryption</a></li>
<li><a href="../202540/index.html">Love in pixels or what is Love2d</a></li>
<li><a href="../202544/index.html">KUB-Pico / 220 Socket Controller from Technotronics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>