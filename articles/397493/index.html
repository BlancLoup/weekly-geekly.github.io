<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I made an electronic board for telemetry sensors and for controlling peripherals</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the course of creating a waiter robot, a telepresence robot, a self-photobot, some developments have appeared that are not to be shared with the co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I made an electronic board for telemetry sensors and for controlling peripherals</h1><div class="post__text post__text-html js-mediator-article">  In the course of creating a waiter robot, a telepresence robot, a self-photobot, some developments have appeared that are not to be shared with the community, that is, to make open-source.  One of the working versions was an electronic board, code-named SB version 4.0, using an inexpensive and relatively low-functional Arduino, namely, Nano 3.0.  The SB 4.0 board is quite simple and straightforward in order to consolidate its electronics knowledge and soldering skills in its assembly process, it is functional enough to make its own practical projects (for example, turn on a light bulb using signals from a motion sensor and a light sensor or via your Bluetooth command) and the cost of components with delivery when ordering from our Chinese friends with taobao was about $ 55 (including the sensors themselves). <br><br>  The main purpose of the SB 4.0 board is the hardware interface.  Having collected, you can use it to receive and process data from several pre-installed sensors and further decision making and execution of algorithms.  For debugging convenience, an interface has been created in OS Windows, in which telemetric readings from sensors and power supply, the state of buttons and servo drives are clearly displayed, and you can send commands to the microcontroller. <br><br>  In this publication I will describe the characteristics of the board and one of the examples of its use.  Again, all this is open-source, under the license CC Attribution Non-Commercial Share Alike. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Yes, there are already similar control boards and KITs with sensors (more expensive Arduino boards with shields, Raspberry Pi, amperski iodo), but SB 4.0 differs from them in the presence of a power board and a convenient control program written using the LabView development environment.  That is, SB 4.0 consists of two boards: control + power.  This will be seen in photos and videos. <br><a name="habracut"></a><br>  Photo of both boards, motion sensor, battery: <br><br><img src="https://habrastorage.org/files/f3b/5bb/f14/f3b5bbf14c7f406280a317e1138d6a3b.jpg"><br><br><h4>  Programming </h4><br>  To program the microcontroller, as always, we use C / C ++.  We conduct development in the environment of Arduino IDE. <br><br>  The screenshot shows the interface of the Selfiebot Control Panel, where telemetric readings from sensors and power supply, the state of buttons and servo drives are clearly displayed, and you can send commands to the microcontroller. <br><br>  Screenshot of the interface: <br><br><img src="https://habrastorage.org/files/d3d/c40/b80/d3dc40b80e214cca9f599049adf0de92.jpg"><br><br><h4>  Performance </h4><br>  SB 4.0 uses one of the most inexpensive Arduino Nano 3.0 platforms with the 8-bit ATmega328 microcontroller.  This is sufficient for processing the code and solving problems: controlling robots, the smart home system, etc. <br><br><img src="https://habrastorage.org/files/018/864/920/018864920429492b8e0e999fcacc371b.jpg"><br><br><h4>  Compatibility </h4><br>  Logical voltage - 5 V, which provides electrical compatibility with the Arduino-periphery. <br><br><h4>  I / O ports </h4><br>  Microcontroller control pins available.  In brackets it indicates the pre-installed elements with which the board already knows how to work. <br><ul><li>  2 pins that can be configured as digital input / output and PWM output (for two digital servos); </li><li>  1 pin, digital input / output (for motion sensor); </li><li>  3 pins, digital input / output (for RGB LED); </li><li>  1 pin, digital input / output (for end sensor, button); </li><li>  1 pin, digital output + 5V / 0V (for controlling external load). </li></ul><br>  The I2C bus and the UART port are enabled respectively for the port extender card and the Bluetooth module. <br>  Provides versatility SB 4.0.  Agree on power levels, signal levels, type of input / output!  Replace the pre-installed sensors with your sensors: <br><br><ul><li>  temperatures </li><li>  noise level </li><li>  humidity </li><li>  pressure, etc. </li></ul><br><br>  Input pin works on the principle of closed / open.  Those.  on the pin going to the MK or + 5V, or 0. These values ‚Äã‚Äãare included in the telemetry data that is sent to the software Selfiebot Control Panel. <br><br>  The output pin either issues 5V with a load capacity of 1A, or is disabled - 0V.  To supply voltage or not to this connector is possible only by an external command or by a command of the firmware algorithm. <br><br>  It makes no sense to connect analog sensors to digital pins. <br><br><h4>  Nutrition </h4><br>  Power is supplied through a 2.1 mm power socket, or from Li-Ion batteries with a charge controller.  The source is determined automatically. <br>  In the case of power supply through the socket, the recommended input voltage is 12-12.6 V. The DC-DC voltage converters are supplied to the servos - 7 V, to USB1, USB2 and other loads - 5 V. You can use a power adapter or batteries as a power source. <br>  To power the periphery, use pins 5B.  When using an external power supply, from pin 5B, you can get up to 1A in total. <br><br>  The power supply kit includes: <br><ul><li>  Battery pack 3x18650, 1 pc. </li><li>  Battery 18650, 3.7 V, from 2200 mAh, 3 pcs. </li><li>  Charge controller, 1 pc. </li><li>  Power connector, 1 pc. </li><li>  DC-DC converters, 4 pcs. </li><li>  Hall sensor, 1 pc. </li><li>  Transistors, 3 pcs. </li><li>  Optocouplers and resistors. </li></ul><br><br><img src="https://habrastorage.org/files/8de/0b3/887/8de0b3887e7247568c131ecc2dd8bcca.jpg"><br><br><h4>  Communication </h4><br>  The Arduino Nano microcontroller is programmed via USB using standard free software from the manufacturer‚Äôs MK site.  To transfer data between the SB 4.0 and the computer, as always, I chose the inexpensive common Bluetooth module HC-06, with a data transfer rate of 9600 Kb / s.  Telemetry data and control commands are sent over this wireless channel. <br><br><h4>  Dimensions </h4><br>  I got the dimensions of the electronic board of power supply - 100 √ó 70 √ó 40 mm.  The dimensions of the electronic control board are 90 √ó 70 √ó 45 mm.  But sure, you can still poshamanit and reduce the size. <br><br>  The distance between the contacts is 0.1 ‚Ä≥ (2.54 mm). <br><br><h4>  Microcontroller characteristics </h4><br><ul><li>  Microcontroller: 8-bit ATmega328. </li><li>  Clock frequency: 16 MHz. </li><li>  Flash memory: 32 KB (2 KB used for the bootloader, 30 KB for storing the code of your program). </li><li>  2k ram. </li><li>  EEPROM 1 Kb. </li><li>  Rated operating voltage: 5 V </li></ul><br><br><h4>  Characteristics of the electronic board SB 4.0 </h4><br><ul><li>  Rated operating voltage: 12.6 V </li><li>  Recommended input voltage: 12‚Äì12.6 V. </li><li>  Maximum current from the bus 5 V: 1000 mA </li><li>  General Purpose I / O Ports: 2 </li><li>  PWM ports: 2 </li></ul><br><br>  Management board includes the following elements: <br><br><ul><li>  Bluetooth module HC-06, 1 pc. </li><li>  Electronic board of the microcontroller port expander, 1 pc. </li><li>  Microcontroller Arduino Nano 3.0, 1pc. </li><li>  Electronic board light level, 1 pc. </li><li>  Servo Drives TowerPro MG966R, 2 pcs. </li><li>  Photoresistor, 1 pc. </li><li>  Motion sensor, 1 pc. </li><li>  RGB LED, 1 pc. </li><li>  Button, 1 pc. </li><li>  Fuse, 1 pc. </li><li>  Jumper, 1 pc. </li><li>  Transistor, 1 pc. </li><li>  Capacitor, 1 pc. </li></ul><br><br><img src="https://habrastorage.org/files/e89/2f1/727/e892f1727ca7412db2dd3314cb78c8d6.jpg"><br><br><h4>  Practical use </h4><br>  Options for practical use: <br><br>  1. Open / close windows when temperature changes. <br>  2. Turn on / off the fan when the humidity in the room changes. <br>  3. Turn on / off the light in the presence of movement in the dark. <br>  4. Turn on / off the water supply when the soil moisture changes. <br>  5. The inclusion of IR illumination, in the dark. <br>  6. Transfer of any telemetric data to the server via the Internet connection. <br><br><h4>  Application example for SB 4.0 </h4><br>  Purpose: subject to the pressed button, turn on the light when motion is detected. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tS3hikUysTQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  For this, we will additionally need a relay module, a light bulb (220 ADC or up to 12 VDC). <br><br>  1. Most often we meet the relay 12VDC and 05VDC.  The number indicates which DC voltage value needs to be supplied to the relay input. <br>  2. Consider the work common for Arduino SRD-05VDC relay from Songle. <br>  3. When power is applied to the Vcc pin and the Gnd pin is connected to ground, the green LED lights up. <br>  4. Because  we have a single-channel module, then on the board you will see only one signal pin In1.  If you set the voltage level to LOW in In1, the red LED on the relay module lights up and the relay triggers with a characteristic click.  For Arduino, the digitalWrite (pin, LOW) command is responsible for setting the pin voltage level;  To return the relay to its previous state, use the digitalWrite (pin, HIGH) command; <br>  5. Connect the relay module to the SB 4.0 board, which has a motion sensor pre-installed and a user button. <br>  5.1.  The signal pin In1 of the relay module is connected to pin 13. <br>  5.2.  In the Arduino Nano program code we find: <pre><code class="cpp hljs">*********************************** <span class="hljs-comment"><span class="hljs-comment">//     -   ,       timeout_SnSM if (var_Tlm_SnSM == 1) { time_Move_detect = millis(); } if (millis() - time_Move_detect &lt; timeout_Move_detect) { Move_detect = 1; } else { Move_detect = 0; } ***********************************</span></span></code> </pre> <br><br>  Below these lines we add: <br><pre> <code class="cpp hljs">*********************************** <span class="hljs-comment"><span class="hljs-comment">//     (== 0),     (== 1)     13 (== LOW),   timeout_SnSM if (var_Tlm_BUT == 0) { if (Move_detect == 1) { digitalWrite(PIN_D13, LOW); } else { digitalWrite(PIN_D13, HIGH); } } else { digitalWrite(PIN_D13, HIGH); } ***********************************</span></span></code> </pre><br>  5.3.  Download the new firmware and turn on the board power. <br><br>  If the motion sensor detects a movement, then thanks to our algorithm, the LOW level appears on the external power supply pin, the relay is activated, closing the circuit, and the light comes on. <br><br>  Thus, if a person passes by a motion sensor, the light turns on. </div><p>Source: <a href="https://habr.com/ru/post/397493/">https://habr.com/ru/post/397493/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../397479/index.html">50 shades of stub * ADC and ADC with Microchip microcontroller computer</a></li>
<li><a href="../397481/index.html">Overview of the Draytek 2925 Series Router. Part One: Overview, Features and Tests</a></li>
<li><a href="../397483/index.html">At the end of the month, Adobe will remove links to download Flash from your site.</a></li>
<li><a href="../397487/index.html">Heimdall - an amateur moon companion</a></li>
<li><a href="../397491/index.html">Marine says he served on Mars for 17 years</a></li>
<li><a href="../397495/index.html">Ilon Musk - about hardware improvement of people</a></li>
<li><a href="../397497/index.html">AI decided to engage in commenting on sporting events.</a></li>
<li><a href="../397499/index.html">Wing project drones will deliver fast food to student dormitories at the University of Virginia.</a></li>
<li><a href="../397501/index.html">We know what you will do on the weekend.</a></li>
<li><a href="../397503/index.html">Sony Xperia XCompact goes on sale in Russia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>