<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>First introduction to the Google Maps Javascript API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post I will talk about my experience in using the Google Maps JS API and its implementation in the mobile version of the site with a very larg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>First introduction to the Google Maps Javascript API</h1><div class="post__text post__text-html js-mediator-article">  In this post I will talk about my experience in using the Google Maps JS API and its implementation in the mobile version of the site with a very large attendance. <br><a name="habracut"></a><br>  Most recently, at work, I had to deal with the implementation of a module designed to search for site users within the current coordinates of the visitor (the site‚Äôs subject is dating, not shadowing, as you might think, I won‚Äôt give references and names so as not to reveal secrets and advertise).  Initially, I ran into an existing module implementation.  This version was written a year or two ago and used an outdated version of the API, so when I climbed into the documentation and tried to add something to this module, I naturally got errors. <br>  After registering a free API Key, I updated the library used and began to study help. <br>  I was very pleased with the possibility of creating my own map elements (Overlays), which, in fact, I had to do.  I will give an example of using this feature: <br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestOverlay</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bounds</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._bounds = bounds; } TestOverlay.prototype = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GOverlay(); TestOverlay.prototype.initialize = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">map</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> div = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">"div"</span></span>); div.style.border = <span class="hljs-string"><span class="hljs-string">"2px solid #888888"</span></span>; div.style.position = <span class="hljs-string"><span class="hljs-string">"absolute"</span></span>; map.getPane(G_MAP_MAP_PANE).appendChild(div); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._map = map; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._div = div; } TestOverlay.prototype.remove = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._div.parentNode.removeChild(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._div); } TestOverlay.prototype.copy = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rectangle(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._bounds); } TestOverlay.prototype.redraw = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">force</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!force) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c1 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._map.fromLatLngToDivPixel(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._bounds.getSouthWest()); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c2 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._map.fromLatLngToDivPixel(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._bounds.getNorthEast()); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._div.style.width = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.abs(c2.x - c1.x) + <span class="hljs-string"><span class="hljs-string">"px"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._div.style.height = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.abs(c2.y - c1.y) + <span class="hljs-string"><span class="hljs-string">"px"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._div.style.left = (<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.min(c2.x, c1.x) - <span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"px"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._div.style.top = (<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.min(c2.y, c1.y) - <span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"px"</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GBrowserIsCompatible()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GMap2(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"map_canvas"</span></span>)); map.setCenter(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GLatLng(<span class="hljs-number"><span class="hljs-number">37.4419</span></span>, <span class="hljs-number"><span class="hljs-number">-122.1419</span></span>), <span class="hljs-number"><span class="hljs-number">13</span></span>); map.addControl(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GSmallMapControl()); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bounds = map.getBounds(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> southWest = bounds.getSouthWest(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> northEast = bounds.getNorthEast(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lngDelta = (northEast.lng() - southWest.lng()) / <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> latDelta = (northEast.lat() - southWest.lat()) / <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rectBounds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GLatLngBounds( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GLatLng(southWest.lat() + latDelta, southWest.lng() + lngDelta), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GLatLng(northEast.lat() - latDelta, northEast.lng() - lngDelta)); map.addOverlay(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TestOverlay(rectBounds)); } } ‚Äã</code> </pre> <br><br>  As you can see from this example, custom map elements are created by implementing the GOverlay interface.  To implement this interface, you need to implement 4 of its methods - initialize, remove, copy and redraw. <br>  In addition, very convenient and intuitive classes such as GPoint, GSize, GIcon are used to work with standard map elements.  The latter, for example, allows you to set the size of the icon, add a shadow to the icon, and also set the point of contact for the icon with the map.  All this is possible thanks to a very simple interface: <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> baseIcon = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GIcon(G_DEFAULT_ICON); baseIcon.shadow = <span class="hljs-string"><span class="hljs-string">"http://www.google.com/mapfiles/shadow50.png"</span></span>; baseIcon.iconSize = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GSize(<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>); baseIcon.shadowSize = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GSize(<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>); baseIcon.iconAnchor = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GPoint(<span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>);</code> </pre><br>  The resulting module has become much more convenient and more interesting due to the use of more recent features of the Google Maps API. </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/125118/">https://habr.com/ru/post/125118/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../125107/index.html">ListView inside ScrollView</a></li>
<li><a href="../125112/index.html">Do you have a rutted smartphone?</a></li>
<li><a href="../125114/index.html">New way to transfer funds to QIWI Wallet: by email</a></li>
<li><a href="../125115/index.html">30 years old MS-DOS</a></li>
<li><a href="../125116/index.html">Loginza - authorization through Vkontakte, Facebook, etc. OpenID servers</a></li>
<li><a href="../125120/index.html">Intel developers govodayat too</a></li>
<li><a href="../125122/index.html">How often on sites do you use the icons of ‚Äúhouse‚Äù, ‚Äúmagnifying glass‚Äù and ‚Äúenvelope‚Äù?</a></li>
<li><a href="../125123/index.html">Do you use the "sealed" modifier?</a></li>
<li><a href="../125126/index.html">WM> Bank = Technical Overdraft</a></li>
<li><a href="../125129/index.html">The final version of symfony2 has been released. Hooray!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>