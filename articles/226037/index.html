<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>iBeacon: Guide to Action</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="iBeacon is a new technology based on Bluetooth Low Energy or BLE. While iBeacon is most associated with Apple. Starting in 2013, iBeacon is built into...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>iBeacon: Guide to Action</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/72a/2fe/57c/72a2fe57cbb2faf75a2864bdb749bd1f.jpg"><br><br><blockquote>  iBeacon is a new technology based on Bluetooth Low Energy or BLE.  While iBeacon is most associated with Apple.  Starting in 2013, iBeacon is built into Apple iOS 7. For the first time, a pilot project was launched in Apple stores in December 2013 and in 2014 a significant increase in the use of technology <i>is</i> expected <i>- via <a href="http://www.wi-life.ru/stati/wi-fi/marketingovye-stati-2/what-is-ibeacon-from-apple">Wi-Life</a></i> </blockquote><br>  Good afternoon, dear Habrahabr! <br><br>  Today we will get acquainted with the implementation of BLE functionality for iOS based on <a href="http://roximity.com/">Roximity</a> iBeacon devices.  I searched, asked, whispered, sort of like, no one ever wrote about the practical side of the issue in runet.  I divide the article into two parts: about setting up on Roximity servers and about engine rooms of applications. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Interested please under the cat. <br><a name="habracut"></a><br><h4>  Roximity magic </h4><br>  After buying the bacon, they give you a ‚ÄúMerchant Login‚Äù.  I purchased three bacons;  This is the first page of the bacon admin panel: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a4/d00/68c/7a4d0068caa7f21dd5067aea83c958a8.png"><br><br>  Before going further, it is worth noting that: <br><br><ul><li>  Each bacon can be assigned an unlimited number of tags. </li><li>  Multiple bacon tags can be assigned the same tags. </li><li>  You can create messages that will pop up on a specific action (entry into the coverage area, exit from it, close proximity) </li><li>  Messages can be assigned to specific tags. </li><li>  If the message is assigned to a tag that belongs to several bacons, then these bacons work as one big bacon. </li></ul><br>  The form for creating a message is as follows: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8e6/70a/3c3/8e670a3c31f860e5633a9266cee4eecf.png"><br><br>  Nearby is a memo about the approximate radius of operation of key fobs.  Each message can be assigned: <br><br><ul><li>  The name of the message that does not shine anywhere except this admin </li><li>  The action by which the message is triggered </li><li>  The message itself that the user sees </li><li>  Frequency of occurrence </li><li>  Tags of bacon related to the post </li><li>  Message end date </li></ul><br>  When the messages are configured, we download the SDK, embed them in the application, and move on to the next part of the article.  The SDK is quite young and updated with stable frequency. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8eb/b46/73d/8ebb4673da953b0efa117a9e7403cab8.png"><br><br><h4>  Magic is on our side </h4><br>  Interestingly, the bacon works not only when the application is active, but also in the background, and even closed state!  That is, if you have an application installed with the Roximity SDK, then each time <b>your</b> bacons appear in the phone's visibility, your application will open for 30 seconds with a call to the appropriate methods from the Background Fetch opera. <br><br>  After properly installing the Roximity SDK, the Roximity server will do absolutely everything for you.  The only thing we need to do (if at all) is to subscribe to <i>ROX_NOTIF_MESSAGE_FIRED</i> : <br><br><pre><code class="objectivec hljs">[[<span class="hljs-built_in"><span class="hljs-built_in">NSNotificationCenter</span></span> defaultCenter] addObserver:sharedManager selector:<span class="hljs-keyword"><span class="hljs-keyword">@selector</span></span>(handleNotification:) name:ROX_NOTIF_MESSAGE_FIRED object:<span class="hljs-literal"><span class="hljs-literal">nil</span></span>];</code> </pre> <br>  An example method of handleNotification: might look like this: <br><br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)handleNotification:(<span class="hljs-built_in"><span class="hljs-built_in">NSNotification</span></span> *)rawNotification { <span class="hljs-built_in"><span class="hljs-built_in">NSDictionary</span></span> *notification = rawNotification.userInfo; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *beaconId = notification[<span class="hljs-string"><span class="hljs-string">@"com.roximity.notif"</span></span>][<span class="hljs-string"><span class="hljs-string">@"com.roximity.notification.trigger"</span></span>][<span class="hljs-string"><span class="hljs-string">@"beaconId"</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *event = notification[<span class="hljs-string"><span class="hljs-string">@"com.roximity.notif"</span></span>][<span class="hljs-string"><span class="hljs-string">@"com.roximity.notification.trigger"</span></span>][<span class="hljs-string"><span class="hljs-string">@"event"</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *name = notification[<span class="hljs-string"><span class="hljs-string">@"com.roximity.notif"</span></span>][<span class="hljs-string"><span class="hljs-string">@"com.roximity.notification.trigger"</span></span>][<span class="hljs-string"><span class="hljs-string">@"name"</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">NSLog</span></span>(<span class="hljs-string"><span class="hljs-string">@"Beacon event: %@ - %@ - %@"</span></span>, event, beaconId, name); }</code> </pre><br>  I apologize for the magic lines, unfortunately, I have lost the memo on the relevant definitions.  I remind you that handleNotification: will be called even if your application has been completely closed! <br><br><h4>  Conclusion </h4><br>  That's all!  Use bacon for health and never be afraid to dip into new technologies. <br><br>  If you find any inaccuracies or typographical errors in the article, be sure to write in my habracenter. <br><br>  Ready to answer all your questions! </div><p>Source: <a href="https://habr.com/ru/post/226037/">https://habr.com/ru/post/226037/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../226021/index.html">We invite you to the webinar "Migrating to Kerio Connect"</a></li>
<li><a href="../226023/index.html">Just UBANK in your pocket: how difficult it was</a></li>
<li><a href="../226025/index.html">Switch to Sketch. Part 1</a></li>
<li><a href="../226027/index.html">Ciklum .NET / JS Subbotnik in Dnepropetrovsk, June 21</a></li>
<li><a href="../226035/index.html">EBay data center goes to water cooled doors</a></li>
<li><a href="../226039/index.html">Well, where is the build for Linux?</a></li>
<li><a href="../226041/index.html">Irina Kalashnikova: ‚ÄúWe expect the number of mobile solutions to increase significantly this year‚Äù</a></li>
<li><a href="../226047/index.html">Features of loyalty programs and accruals of aviamil in Russian banks</a></li>
<li><a href="../226049/index.html">TiME - space submarine</a></li>
<li><a href="../226051/index.html">Ciklum PHP Speakers' Corner in Vinnitsa June 19</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>