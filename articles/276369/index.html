<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Machine learning from Octave \ Matlab to Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I decided to get acquainted with such an interesting area for me as Machine learning. After a brief search, I found a fairly popular course at Stanfor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Machine learning from Octave \ Matlab to Python</h1><div class="post__text post__text-html js-mediator-article">  I decided to get acquainted with such an interesting area for me as Machine learning.  After a brief search, I found a fairly popular course at Stanford University Machine learning.  It tells you the basics and gives a broad overview of machine learning, datamining, and statistical pattern recognition.  There was for me a small minus in this course as a Python programmer ‚Äî homework had to be done on Octave \ Matlab.  As a result, I didn‚Äôt regret getting a new programming language idea, but as a learning example I decided to rewrite my homework in Python as a learning example for getting closer acquainted with the relevant libraries.  What happened is on GitHub <a href="https://github.com/mlyundin/Machine-Learning">here</a> . <br><img src="https://habrastorage.org/files/5ac/6c6/06a/5ac6c606a2074d43ad5d8be1eda31bb8.png"><br><a name="habracut"></a><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: data = sio.loadmat(<span class="hljs-string"><span class="hljs-string">'ex6data1.mat'</span></span>) y = data[<span class="hljs-string"><span class="hljs-string">'y'</span></span>].astype(np.float64) X = data[<span class="hljs-string"><span class="hljs-string">'X'</span></span>] visualize_boundary_linear(X, y, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) C = <span class="hljs-number"><span class="hljs-number">1</span></span> model = svm_train(X, y, C, linear_kernel, <span class="hljs-number"><span class="hljs-number">0.001</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) visualize_boundary_linear(X, y, model) C = <span class="hljs-number"><span class="hljs-number">100</span></span> model = svm_train(X, y, C, linear_kernel, <span class="hljs-number"><span class="hljs-number">0.001</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) visualize_boundary_linear(X, y, model) x1 = np.array([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], dtype=np.float64) x2 = np.array([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>], dtype=np.float64) sigma = <span class="hljs-number"><span class="hljs-number">2.0</span></span> sim = gaussian_kernel(x1, x2, sigma); print(<span class="hljs-string"><span class="hljs-string">'Gaussian Kernel between x1 = [1; 2; 1], x2 = [0; 4; -1], sigma = 0.5 : (this value should be about 0.324652)'</span></span>) print(<span class="hljs-string"><span class="hljs-string">'Actual = {}'</span></span>.format(sim)) data = sio.loadmat(<span class="hljs-string"><span class="hljs-string">'ex6data2.mat'</span></span>) y = data[<span class="hljs-string"><span class="hljs-string">'y'</span></span>].astype(np.float64) X = data[<span class="hljs-string"><span class="hljs-string">'X'</span></span>] visualize_data(X, y).show() C = <span class="hljs-number"><span class="hljs-number">1.0</span></span> sigma = <span class="hljs-number"><span class="hljs-number">0.1</span></span> partialGaussianKernel = partial(gaussian_kernel, sigma=sigma) partialGaussianKernel.__name__ = gaussian_kernel.__name__ model= svm_train(X, y, C, partialGaussianKernel) visualize_boundary(X, y, model) data = sio.loadmat(<span class="hljs-string"><span class="hljs-string">'ex6data3.mat'</span></span>) y = data[<span class="hljs-string"><span class="hljs-string">'y'</span></span>].astype(np.float64) X = data[<span class="hljs-string"><span class="hljs-string">'X'</span></span>] Xval = data[<span class="hljs-string"><span class="hljs-string">'Xval'</span></span>] yval = data[<span class="hljs-string"><span class="hljs-string">'yval'</span></span>].astype(np.float64) visualize_data(X, y).show() best_C = <span class="hljs-number"><span class="hljs-number">0</span></span> best_sigma = <span class="hljs-number"><span class="hljs-number">0</span></span> best_error = len(yval) best_model = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> C <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [<span class="hljs-number"><span class="hljs-number">0.01</span></span>, <span class="hljs-number"><span class="hljs-number">0.03</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>]: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> sigma <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [<span class="hljs-number"><span class="hljs-number">0.01</span></span>, <span class="hljs-number"><span class="hljs-number">0.03</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>]: partialGaussianKernel = partial(gaussian_kernel, sigma=sigma) partialGaussianKernel.__name__ = gaussian_kernel.__name__ model= svm_train(X, y, C, partialGaussianKernel) ypred = svm_predict(model, Xval) error = np.mean(ypred != yval.ravel()) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> error &lt; best_error: best_error = error best_C = C best_sigma = sigma best_model = model visualize_boundary(X, y, best_model)</code> </pre> <br><br>  But since Python has its own popular scikit-learn library for this purpose, I tried to rewrite some tasks using this feature (corresponding files with the suffix sklearn).  As expected, the code with the library is fast and looks more compact and clearer (from my point of view). <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: data = sio.loadmat(<span class="hljs-string"><span class="hljs-string">'ex6data1.mat'</span></span>) y = data[<span class="hljs-string"><span class="hljs-string">'y'</span></span>].astype(np.float64).ravel() X = data[<span class="hljs-string"><span class="hljs-string">'X'</span></span>] visualize_boundary(X, y, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) C = <span class="hljs-number"><span class="hljs-number">1</span></span> lsvc = LinearSVC(C=C, tol=<span class="hljs-number"><span class="hljs-number">0.001</span></span>) lsvc.fit(X, y) svc = SVC(C=C, tol=<span class="hljs-number"><span class="hljs-number">0.001</span></span>, kernel=<span class="hljs-string"><span class="hljs-string">'linear'</span></span>) svc.fit(X, y) visualize_boundary(X, y, {<span class="hljs-string"><span class="hljs-string">'SVM(linear kernel) C = {}'</span></span>.format(C): svc, <span class="hljs-string"><span class="hljs-string">'LinearSVC C = {}'</span></span>.format(C): lsvc}) C = <span class="hljs-number"><span class="hljs-number">100</span></span> lsvc = LinearSVC(C=C, tol=<span class="hljs-number"><span class="hljs-number">0.001</span></span>) lsvc.fit(X, y) svc = SVC(C=C, tol=<span class="hljs-number"><span class="hljs-number">0.001</span></span>, kernel=<span class="hljs-string"><span class="hljs-string">'linear'</span></span>) svc.fit(X, y) visualize_boundary(X, y, {<span class="hljs-string"><span class="hljs-string">'SVM(linear kernel) C = {}'</span></span>.format(C): svc, <span class="hljs-string"><span class="hljs-string">'LinearSVC C = {}'</span></span>.format(C): lsvc}) data = sio.loadmat(<span class="hljs-string"><span class="hljs-string">'ex6data2.mat'</span></span>) y = data[<span class="hljs-string"><span class="hljs-string">'y'</span></span>].astype(np.float64).ravel() X = data[<span class="hljs-string"><span class="hljs-string">'X'</span></span>] visualize_boundary(X, y) C = <span class="hljs-number"><span class="hljs-number">1.0</span></span> sigma = <span class="hljs-number"><span class="hljs-number">0.1</span></span> gamma = sigma_to_gamma(sigma) svc = SVC(C=C, tol=<span class="hljs-number"><span class="hljs-number">0.001</span></span>, kernel=<span class="hljs-string"><span class="hljs-string">'rbf'</span></span>, gamma=gamma) svc.fit(X, y) visualize_boundary(X, y, {<span class="hljs-string"><span class="hljs-string">'SVM(rbf kernel) C = {}'</span></span>.format(C): svc}) data = sio.loadmat(<span class="hljs-string"><span class="hljs-string">'ex6data3.mat'</span></span>) y = data[<span class="hljs-string"><span class="hljs-string">'y'</span></span>].astype(np.float64).ravel() X = data[<span class="hljs-string"><span class="hljs-string">'X'</span></span>] Xval = data[<span class="hljs-string"><span class="hljs-string">'Xval'</span></span>] yval = data[<span class="hljs-string"><span class="hljs-string">'yval'</span></span>].astype(np.float64).ravel() visualize_boundary(X, y) C_coefs = [<span class="hljs-number"><span class="hljs-number">0.01</span></span>, <span class="hljs-number"><span class="hljs-number">0.03</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>] sigma_coefs = [<span class="hljs-number"><span class="hljs-number">0.01</span></span>, <span class="hljs-number"><span class="hljs-number">0.03</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>] svcs = (SVC(C=C, gamma=sigma_to_gamma(sigma), tol=<span class="hljs-number"><span class="hljs-number">0.001</span></span>, kernel=<span class="hljs-string"><span class="hljs-string">'rbf'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> C <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C_coefs <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> sigma <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sigma_coefs) best_model = max(svcs, key=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> svc: svc.fit(X, y).score(Xval, yval)) visualize_boundary(X, y, {<span class="hljs-string"><span class="hljs-string">'Best model(C={}, gamma={})'</span></span>.format(best_model.C, best_model.gamma): best_model}) <span class="hljs-comment"><span class="hljs-comment">#Let's do the similar thing but using sklearn feature X_all = np.vstack((X, Xval)) y_all = np.concatenate((y, yval)) parameters = {'C':C_coefs, 'gamma': map(sigma_to_gamma, sigma_coefs)} svr = SVC(tol=0.001, kernel='rbf') clf = GridSearchCV(svr, parameters, cv=2) clf.fit(X_all, y_all) visualize_boundary(X, y, {'Best model(C={}, gamma={})'.format(clf.best_params_['C'], clf.best_params_['gamma']): clf})</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/0d1/b2c/5e5/0d1b2c5e59a2489a8ddc8fbadc08a565.png"><br><br>  PS <br>  For those who are interested in the Sklearn library, I would advise: <br>  <a href="https://www.udacity.com/course/viewer">Udacity course</a> <br>  <a href="https://www.youtube.com/watch%3Fv%3DHjAB45qsx_c">Video 1 with pycon</a> <br>  <a href="https://www.youtube.com/watch%3Fv%3DFOZvHx-43pg">Video 2 with pycon</a> <br><br>  Pps <br>  To develop and run the examples I used <a href="https://www.continuum.io/downloads">the Anaconda distribution.</a> </div><p>Source: <a href="https://habr.com/ru/post/276369/">https://habr.com/ru/post/276369/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276359/index.html">Perl5 plugin version 1.3 released for IntelliJ IDEA</a></li>
<li><a href="../276361/index.html">Census Analyzer 1.0: A New Data Analysis Tool</a></li>
<li><a href="../276363/index.html">How to sell an application that does not make a profit? And how much does it cost?</a></li>
<li><a href="../276365/index.html">How the Zeptolab Game Designer Challenge was created</a></li>
<li><a href="../276367/index.html">Pitfalls of Consciousness: How researchers cheat themselves</a></li>
<li><a href="../276371/index.html">"Digital Rain" for Windows in 314 bytes</a></li>
<li><a href="../276373/index.html">Social CRM. Collecting the interest of Internet users</a></li>
<li><a href="../276377/index.html">Reducing the size of a thin disk in ESXi</a></li>
<li><a href="../276381/index.html">Who should live and who should die: priorities of processes in Android</a></li>
<li><a href="../276383/index.html">Habra graph, community and where did all the karma go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>