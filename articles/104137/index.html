<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How many holes in Adobe caftan? (CVE-2010-2883)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="According to the number of exploited vulnerabilities, Adobe Acrobat Reader is one of the most ‚Äúworn‚Äù and, at the same time, the most popular among att...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How many holes in Adobe caftan? (CVE-2010-2883)</h1><div class="post__text post__text-html js-mediator-article">  According to the number of exploited vulnerabilities, Adobe Acrobat Reader is one of the most ‚Äúworn‚Äù and, at the same time, the most popular among attackers.  Attacks using vulnerabilities in Adobe applications for client-side attacks have long been a trend.  Last time we wrote about loud 0-day vulnerabilities <a href="http://habrahabr.ru/company/eset/blog/96879/">in the summer</a> .  Recently, attackers have a new reason for creativity. <a name="habracut"></a><br><br>  On Thursday, another 0-day for Adobe Reader ( <a href="http://web.nvd.nist.gov/view/vuln/detail%3FvulnId%3DCVE-2010-2883">CVE-2010-2883</a> ) was made public.  This time, the CoolType.dll library, which is responsible for the True Type Font parsing, turned out to be guilty.  Vulnerability manifests itself when processing a font with an incorrect <a href="http://en.wikipedia.org/wiki/OpenType">SING table</a> .  During processing, an insecure sishcat <a href="http://msdn.microsoft.com/ru-ru/library/h1x0y282.aspx">strcat ()</a> function is <a href="http://msdn.microsoft.com/ru-ru/library/h1x0y282.aspx">called</a> , which, under certain conditions, leads to a stack overflow. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/05a/253/5a0/05a2535a0745a907179100bc3e975832.png" width="259" height="640"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first person to notice the malicious <a href="http://www.virustotal.com/file-scan/report.html%3Fid%3Dd55aa45223606db795d29ab9e341c1c703e5a2e26bd98402779f52b6c2e9da2b-1284375791">JS / Exploit.Pdfka.OFZ</a> (9c5cd8f4a5988acae6c2e2dce563446a) that exploited this vulnerability was <a href="http://contagiodump.blogspot.com/">Mila Parkour</a> .  Thanks to her efforts, the right people paid attention to JS / Exploit.Pdfka.OFZ ‚Äã‚Äãand figured out what was wrong. <br><br>  And the sample turned out to be really interesting and, apparently, since the end of August it has already been, what is called, ITW.  It's not clear why Adobe still uses insecure features.  Apparently, the company was counting on the options of the compiler <a href="http://msdn.microsoft.com/en-us/library/8dbf701c%2528VS.80%2529.aspx">/ GS</a> and <a href="http://msdn.microsoft.com/en-us/library/9a89h429%2528VS.80%2529.aspx">/ SAFESEH</a> , with which the CoolType.dll library was compiled.  To bypass all these troubles associated with DEP, and other SAFESEH, the <a href="http://habrahabr.ru/company/eset/blog/98110/">ROP</a> technique is used, but to get around ASLR, the icucnv36.dl module was found, also by Adobe authorship and not compiled with the <a href="http://msdn.microsoft.com/en-us/library/bb384887.aspx">/ DYNAMICBASE</a> option.  It is in this module that we get when performing a ROP chain placed in memory through a <a href="http://habrahabr.ru/company/eset/blog/98110/">heap-spray</a> attack: <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/adf/cc9/717/adfcc9717624827e5fc9045102494f1f.png" width="400" height="281"></a> <br><br>  Further, the WinAPI call chain of functions used by the malware is used. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/830/d28/536/830d28536f6b30c2e7b36c85488f5e79.png" width="400" height="380"></a> <br><br>  Interestingly, the <a href="http://www.virustotal.com/file-scan/report.html%3Fid%3Ddfb116c2c4687fb27ec2c9252e9c5296708c0f201255b7abadaa68e488a60b2a-1284383045">executable file</a> (‚ÄúWin32 / TrojanDownloader.Small.OZS‚Äù) ‚Äúdropped‚Äù from a pdf-file has a legal digital signature: <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/67d/7fa/b9f/67d7fab9f18fd8526890b3f0e887ead7.png" width="400" height="198"></a> <br><br>  The certificate is valid until the end of October and, probably, therefore, the attackers decided to use it right now.  We have already seen games with signed malware when attacking a <a href="http://habrahabr.ru/company/eset/blog/99506/">Win32 / Stuxnet</a> worm.  The ‚Äúdrop‚Äù module is a dynamic library disguised as cpl and has the following imported functions: <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/8e8/d3d/13e/8e8d3d13eab039066d96049aa140a381.png" width="400" height="125"></a> <br><br>  <b>StartUP</b> - downloads from _http: //acad***house.us/from/wincrng.exe and launches this file (Win32 / TrojanDownloader.Small.OZS) <br>  <b>IsAdmin</b> - checks for administrative privileges in the system <br>  <b>DeleteMyself</b> - creates a bat-file that removes this executable from the system <br>  <b>MakeAndShowEgg</b> - restarts Adobe Reader <br><br>  For this vulnerability, an <a href="">exploit</a> for Metasploit appeared rather quickly, which also uses heap-spray for ROP placement and subsequent exploitation. </div><p>Source: <a href="https://habr.com/ru/post/104137/">https://habr.com/ru/post/104137/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../104127/index.html">Brainstorm before Startup Weekend</a></li>
<li><a href="../104128/index.html">Research of the world market of business applications SaaS</a></li>
<li><a href="../104129/index.html">Widget comments widget: bugreport</a></li>
<li><a href="../104135/index.html">18 ways to like the site optimizer</a></li>
<li><a href="../104136/index.html">GoDaddy.com is for sale</a></li>
<li><a href="../104141/index.html">Inventory of computers on the network without getting up from the chair or OCS Inventory + GLPI</a></li>
<li><a href="../104142/index.html">Get Object from form</a></li>
<li><a href="../104143/index.html">Raffle prizes for the Day of the programmer!</a></li>
<li><a href="../104144/index.html">About raised floors in the data center</a></li>
<li><a href="../104145/index.html">How is copyright used in political struggle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>