<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SOC for beginners. SOC tasks: security control</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue the cycle of our articles on cyber attack centers for beginners. In the last article, we talked about Security Monitoring, the SIEM tools ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SOC for beginners. SOC tasks: security control</h1><div class="post__text post__text-html js-mediator-article">  We continue the cycle of our articles on cyber attack centers for beginners.  In the <a href="https://habrahabr.ru/company/solarsecurity/blog/340386/">last article,</a> we talked about Security Monitoring, the SIEM tools and the Use Case. <br><br>  The term Security Operations Center for many is associated exclusively with the monitoring of incidents.  For many service providers, this is, in principle, at hand, so few people say that monitoring has a number of serious limitations in terms of protection against cyber attacks. <br><br>  In this article, we will demonstrate with examples the weak points of monitoring information security incidents, tell you what to do about it, and in the end, as usual, we will give some practical recommendations on how to conduct an infrastructure security audit using our own resources. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/59/e7/1d/59e71dfc73a51846323425.jpeg"><br><a name="habracut"></a><br><h3>  Vulnerability Security Monitoring </h3><br>  What are the strengths and weaknesses of Security Monitoring?  The fact that in the first place he handles security events.  These are either events and triggering of information protection rules, or logs and log files: operating system, database, application software. <br><br>  At the same time, there are a large number of situations in which either the activity is not explicitly recorded in the logs, or the flow of events or the capabilities of the systems do not effectively organize the monitoring process. <br><br>  Let's look at examples. <br><br>  <b>1. Operation of system vulnerabilities</b> <b><br></b> <br>  Consider a fairly typical situation: there is a substantially secure perimeter, a separate DMZ segment and a rather weakly segmented office network of computers.  And so, in this network we have a ‚Äúnew‚Äù host.  Whether this machine belongs to an insider, or is it an ordinary employee‚Äôs laptop infected by social engineering, is not so important.  The attacker begins to engage in exploiting the vulnerability of the RCE on the operating systems of servers and workstations that are accessible to him within the segment. <br><br>  How can I fix this problem?  The lack of network segmentation leaves us hopeless of detecting from network security tools, be it IPS or other systems.  In the logs of the operating system itself, the exploitation of the RCE vulnerability does not carry any special code, and therefore there is no way to distinguish it from the usual authentication attempt in the OS.  One way or another, the logs will launch the svchost.exe system process from the system user. <br><br>  Our only hope remains IDS-modules of host protection, but, as our practice shows, having a working and regularly updated IDS on all infrastructure hosts is a rarity. <br><br>  This is how the exploitation of the ‚Äúpainful‚Äù EternalBlue SMB Remote Windows Kernel Pool Corruption vulnerability (fixed by security update MS17-010) looks like.  Please note that the absence of any of the three sources given in the example will not give us a complete picture and a chance to understand whether there was an attack or not. <br><br><img src="https://habrastorage.org/webt/gh/1p/6p/gh1p6pjfiotrkts-lqgjiqi5bfu.png"><br><br>  As a result, you can hope for a miracle, or you can begin to <b>build the process of managing vulnerabilities and try to localize the problem before it occurs</b> . <br><br>  There are quite a lot of specialized materials on this issue, so we will not focus on it.  Let's designate only a few theses. <br><br>  ‚ÄúWinning the race‚Äù with vulnerabilities and building an infrastructure with up-to-date security updates is a task almost impossible to implement in a large corporate client.  The number of vulnerabilities is growing from year to year, most of which are of medium and high severity level (according to the CVSS v2 rating system). <br><br><img src="https://habrastorage.org/webt/zk/w2/xq/zkw2xqorgbvhndyp6mc3b_pdiy4.png"><br>  Distribution of the number of vulnerabilities by year in terms of their criticality ( <a href="https://nvd.nist.gov/vuln-metrics/visualizations/cvss-severity-distribution-over-time">reference to the source</a> ). <br><br>  When reviewing and compiling a vulnerability elimination map, you must not only adhere to the Pareto principle (i.e., select only the most critical part to eliminate), but also work very carefully with compensating measures ‚Äî with accessibility of vulnerability due to adjustments of protection tools, analysis of possible vectors of etc. <br><br>  But this is not the only task left to the monitoring capabilities. <br><br>  <b>2. Profiling Direct Internet Access</b> <b><br></b> <br>  Periodically, in the eyes of the security service, SIEM turns into a powerful tool that is able to handle any events or data streams.  In this case, the following problem may arise, for example: within the company there is a certain agreed number of routes allowed for direct access to the Internet bypassing proxy servers.  And in order to control the work of network specialists, SIEM is assigned the task: to control all previously uncoordinated opening of direct access by analyzing sessions from the corporate network. <br><br>  It would seem that the task is simple and logical.  But there are several limitations: <br><br><ul><li>  In an average company, the number of ACL rules that allow direct access to the Internet, for various reasons (limiting the work of a proxy, specialized software, etc.) is several hundred.  Creating a profile of such a characteristic in SIEM is not difficult, but here we are faced with the second problem. </li><li>  These rules are constantly changing on a daily basis.  As the current test systems disappear, new ones appear, some of the accesses are opened for testing or maintenance work.  As a result, it creates such a huge flow of incidents every day that it is difficult to handle it. </li><li>  It should be noted that such a rule itself, with all its apparent simplicity, is very ‚Äúheavy‚Äù for the classical correlation in the SIEM.  First of all, this is due to the huge flow of events passing through the firewall towards the Internet. <br><br><img src="https://habrastorage.org/webt/qh/9z/hw/qh9zhwtgind8zyhrifekclgzhwe.png"><br><br><img src="https://habrastorage.org/webt/3q/qn/8d/3qqn8dsw8oelpnrohqfta4lzlru.png"></li></ul><br>  As a result, this question is primarily concerned with configuration management and change control.  And, despite the theoretical possibility of solving this problem with the help of monitoring, it is many times more efficient to operate with specialized means and already in the SIEM to monitor the operation of the process. <br><br>  Collectively, these examples lead us to a more global task: SOC needs to understand the company's infrastructure, its vulnerabilities and processes in a ‚Äúbroad sense‚Äù in detail and decide how to most effectively monitor this infrastructure and how quickly to find out what is in it something has changed - that is, at each moment in time to objectively assess the actual security of the infrastructure from attack. <br><br><h3>  Security Control - Tasks and Technologies <br></h3><br>  In our opinion, the following tasks fall within the scope of security control: <br><br><ul><li>  Determination of the perimeter and services of the company available from the Internet. </li><li>  Analysis of external perimeter vulnerabilities and internal infrastructure. </li><li>  Analysis of critical network and infrastructure equipment configurations. </li><li>  Analysis of server and workstations security policies. </li><li>  Evaluation of the effectiveness of policies implemented on the means of protection, in terms of completeness and functionality. </li><li>  Detection of vulnerabilities in the program code of the applied software. </li><li>  And ideally, an analysis of key business processes for process vulnerabilities that may entail financial losses. </li></ul><br><br>  For each of the designated tasks has its own toolkit: <br><br><ul><li>  security scanners; </li><li>  firewall management systems that effectively manage network equipment; </li><li>  integrity monitoring systems; </li><li>  configuration management systems; </li><li>  code analysis systems; </li><li>  manual checks of overall security using penetration tests. </li></ul><br>  But one of the most important and at the same time most undervalued security resources is its language and communication.  From our practice of working in clients, with a built-in human communication with IT and applied people, even during a conversation in a smoking room, you can learn about future or past changes much more than during a long technical analysis of settings (which, nevertheless, does not negate the importance of this process) . <br><br><h3>  Monitoring and control of security =&gt; Monitoring + control of security <br></h3><br>  One of the important advantages of running parallel monitoring and security monitoring processes in a SOC is the ability to ‚Äúpereopylny‚Äù one process information from another, thereby increasing overall security.  Let us take an example of how this works. <br><br>  <b>Monitoring as a tool for identifying new hosts and assets</b> <b><br></b> <br>  If the company does not build an asset inventory process or IT does not share its results, the emergence of a new system with critical functionality or critical data may pass by information security.  But the situation changes significantly when there is a monitoring process. <br><br>  In 99% of cases, a newly appeared host will ‚Äúshow‚Äù itself without fail: <br><br><ul><li>  Attempts to access the Internet directly or through a proxy. </li><li>  Will try to contact the domain controller. </li><li>  Will attempt to access the DNS. </li></ul><br>  If these sources are connected to monitoring, then using a fairly simple report or script, you can identify such ‚Äúspyware‚Äù hosts. <br><br>  Example: Windows authentication events with filters by known host names.  As a rule, the company has criteria for naming hosts that can be caught. <br><br><img src="https://habrastorage.org/webt/cs/rl/ma/csrlmalzkxh9zefj4s9ob_mgeig.png"><br><br>  And, already possessing the information that new entities have appeared in the company's network, it is quite possible to sort out their tasks, legitimacy or take them into account in the general threat model. <br><br>  Conversely, if it is not possible to close any process or technological vulnerability forever, additional signatures and scenarios that control the exploitation of this vulnerability can be developed as a compensating measure. <br><br>  An example is the process of setting up and servicing technological equipment at a plant (or, for example, a state district power station ‚Äî in other words, in almost any production).  To work with such equipment, as a rule, engineers from the manufacturer are involved, and often these are foreign specialists who need to somehow organize remote access to the site.  Quite often, due to the limitations of the existing network architecture and technology segments, remote access is opened directly from the Internet (via RDP, SSH) to terminal servers, from which equipment is already being set up using specialized software.  And in another way to organize this access is simply not possible.  Yes, it is possible to open access by request and to a strictly defined technological window, limit the addresses from which connections to the terminal server will be allowed, but still there is a risk of interception of the RDP / SSH session, exploitation of OS vulnerabilities from the Internet, penetration into the technological network through AWS commissioning engineer, backdoor infection of this terminal server, etc. <br><br>  Since there is no possibility to ‚Äúclose‚Äù this process vulnerability, as a compensating measure, we can offer enhanced monitoring of terminal server data and activity on them, namely: <br><br><ul><li>  Monitor any activity (including network activity in the OS in the software) outside the agreed technological windows. </li><li>  To configure network activity, and also to collect an authentication profile on these terminal servers, in order to see deviations from the usual process in terms of new connections, authentication from unresolved addresses or accounts. </li><li>  Identify previously unknown / non-profiled processes, installation of services and new software. </li><li>  Monitor changes in critical system directories and registry keys. </li><li>  Detect suspicious and malicious objects through AVPO, correlating them with activity on the host in the vicinity of its launch. </li><li>  Monitor external connections, including unsuccessful attempts to access the host from the outside. </li><li>  Detect events that change the settings of the host firewall, as well as ACL changes on the network firewall, which restricts access to and from this terminal server. </li><li>  Control local account creation, privilege escalation for existing accounts, etc. </li></ul><br>  These measures, although they will not prevent the fact of hacking or illegitimate actions within the framework of the considered process, but will help in time to identify them and respond. <br><br>  <b>Security control - where to start</b> <b><br></b> <br>  We suggest starting the approach to security control tasks with the following actions: <br><br><ul><li>  Perform a comprehensive perimeter inventory - methods and channels of access to the Internet, used external addresses, systems accessible from the Internet, services and protocols.  Even at this step, it is often possible to fix a certain number of forgotten vulnerable services and administrative ports opened from the Internet. <br>  For example, for the outer perimeter, you can conduct an inventory scan and add the results to the SIEM.  In this case, it will immediately be clear what and how is recorded in the logs, and, comparing the results with the output of the scanner, it remains to just fill in the descriptions. <br><br><img src="https://habrastorage.org/webt/dv/zl/pv/dvzlpvuw5kcnez6duoqzsaxku7a.png"></li><li>  Evaluate the general state of basic protection (antivirus, FW, Proxy) in terms of the width of their coverage: do they cover the entire infrastructure, are the policies and signatures used, etc. relevant? </li><li>  In the ‚Äúlarge cell‚Äù draw the network infrastructure of the company - the division by subnets in a functional sense, the presence of segmentation, the possibility of monitoring interactions and separating one segment from another. <br><br>  For example, we primarily try to highlight the following network segments: <br><ul><li>  DMZ. </li><li>  External addressing. </li><li>  Guest Wifi and other networks in which there are hosts that are not controlled by the company's security. </li><li>  Local VPN address pool. </li><li>  Separate closed segments (we have, for example, the Solar JSOC ARM segment, a client bank and a segment for testing Malvari). </li></ul></li><li>  Scan both the perimeter and internal infrastructure for vulnerabilities, look at the general condition, highlight the most critical problems that need to be either closed or put on monitoring. </li><li>  To put on regular control and update the specified information slices.  Alternatively, for starters, you can focus on the reports.  And, gradually analyzing the information and improving the process, come to the alerts. </li></ul><br>  Even this not very laborious slice of information will allow you to make the first approach to understanding the actual security of your infrastructure.  Well, then the road will be mastered by going ... or wait for our next articles :) </div><p>Source: <a href="https://habr.com/ru/post/341530/">https://habr.com/ru/post/341530/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341518/index.html">We sent ETH to the wrong address and were able to return them.</a></li>
<li><a href="../341520/index.html">Conduct elections using the blockchain, user identification by voice and an application for online interviews</a></li>
<li><a href="../341522/index.html">ONLYOFFICE vs. Collabora: why we are sure that our solution is better</a></li>
<li><a href="../341524/index.html">Generic exceptions in lambda functions</a></li>
<li><a href="../341528/index.html">Implementing a CA PPM Project Management System in Mars</a></li>
<li><a href="../341532/index.html">uSpeech - the story of a startup</a></li>
<li><a href="../341536/index.html">ITMO University Digest: our developments in 2017. Part 2</a></li>
<li><a href="../341538/index.html">Crossbrowser layout</a></li>
<li><a href="../341540/index.html">Create your own physical 2D engine: parts 2-4</a></li>
<li><a href="../341542/index.html">How to make friends with UIKit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>