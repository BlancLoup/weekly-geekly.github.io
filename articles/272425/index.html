<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Development of trading systems for FPGA: Pros, cons and analysis of the architecture of the existing library</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many high-frequency trading platforms often run on equipment with high-performance network adapters. However, the disadvantage of such systems is a re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Development of trading systems for FPGA: Pros, cons and analysis of the architecture of the existing library</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/itinvest/blog/272425/"><img src="https://habrastorage.org/files/d29/0fd/d8f/d290fdd8f5774890a40c8a2583f8b7ca.jpg"></a> <br><br>  Many high-frequency trading platforms often run on equipment with high-performance network adapters.  However, the disadvantage of such systems is a relatively high and unpredictable delay - as a result, many traders turned their attention to hardware accelerated hybrid architectures. <br><br>  Experts of Algo-Logic Systems Inc.  Jowhn W. Lockwood, Adwait Gupte and Nishit Mehta published a <a href="http://www.researchgate.net/publication/262293285_A_low-latency_library_in_FPGA_hardware_for_High-Frequency_Trading_(HFT)">paper</a> on how FPGAs are used in online trading to reduce data transmission delays.  We present to you the highlights of this publication. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Why speed is so important in HFT </h4><br>  Modern exchanges broadcast financial information through various data streams.  Traders monitor these flows, analyze prices and demand for specific financial instruments (stocks, futures, options, etc.) to understand when and which deal to make - when the decision is made, an order is sent to the stock exchange to buy or sell the required instrument. <br><br>  With the development of electronic commerce, the so-called high-frequency trading (HFT, High frequency trading) has become increasingly widespread - according to various estimates, already in 2010 on American exchanges more than 70% of transactions were carried out using algorithms. <br><br>  HFT traders are trying to exploit emerging market inefficiencies.  In this way, they not only make money, but also make financial markets more efficient.  However, due to the growing number of high-frequency traders who are trying to capitalize on the same inefficiencies, only the first few traders can really capitalize on a certain opportunity.  So, they need to get ahead of competitors. <br><br>  The second important reason is the concept of slippage - in the case of highly liquid financial instruments (for example, stocks) after sending an order, say, to buy at a given price, the transaction may be less profitable, because until the order reaches the exchange, the price will change.  Accordingly, the longer the delay from the time the order is generated until the moment it is executed, the greater the slippage can be, and as a result, the trader‚Äôs lost profit. <br><br>  Thirdly, there are trading strategies, for example, the latency arbitrage, which essentially boils down to the fact that a trader should be able to get market information and send orders faster than other players.  In this situation, every millisecond won can significantly improve the performance of the strategy. <br><br><h4>  Varieties of HFT-platforms </h4><br>  Currently, most traders and brokers create their own HFT-systems using popular software and hardware technologies.  This allows us to describe algorithms using familiar high-level programming languages ‚Äã‚Äã(we have written <a href="http://habrahabr.ru/post/271493/">here</a> about which of them are used in the field of finance), and they can be quickly changed if necessary. <br><br>  However, the pursuit of speed leads to the fact that the unpredictable response time of software systems becomes an obstacle to successful trading.  Consider the existing software and hardware approaches to the creation of HFT-systems. <br><br><h5>  High Frequency Software Platforms </h5><br>  There is a fairly large number of companies offering high-frequency trading software (for Western exchanges, for example, Mantara, Ulink and QuantHouse).  When using them, most of the delays come from the operation of the operating system on which the software is running, as well as the network stack.  To deal with this, users can use high-performance network cards (for example, from Solarflare or Myricom), which accelerate certain parts of the network stack. <br><br><h5>  Custom HFT hardware platforms </h5><br>  The relatively high latency of software trading platforms has forced industry to look for alternative approaches to reducing delays using special hardware.  As a rule, things like ASIC are not considered in HFT trading, since they lack the flexibility to later reconfigure or work with new protocols.  GPU also can not offer significant speed.  FPGA (Field-Programmable Gate Arrays) technology has become a suitable tool for gaining flexibility and achieving the required speed. <br><br>  FPGA can be used to accelerate financial applications in various ways.  One of them is called Hybrid Computing and is used, for example, in risk management models, option pricing and portfolio modeling ‚Äî when applied, the system‚Äôs speed can increase by three orders of magnitude. <br><br>  This approach complements conventional multi-core processors with FPGA co-processors.  Typically, communication with the CPU is carried out using high-speed connectors like FrontSide Bus (FSB), PCI Express or QPI.  The trade modules themselves are then written in high-level programming languages. <br><br>  Another way to use programmable logic to accelerate is to use the so-called Smart NIC.  Usually, this is a combination of high-speed network interfaces, PCI host interfaces, memory, and FPGA.  Here, the FPGA acts as a NIC controller, acting as a bridge between the host computers and the network and allowing the integration of software logic directly along the data path.  Thus, the Smart NIC can operate as a trading platform under the control of the host machine‚Äôs CPU. <br><br><img src="https://habrastorage.org/files/b34/4c8/29c/b344c829c7a34bba8cae1f7273487b72.png"><br><br><h4>  Pros and cons of FPGA for high-speed trading </h4><br>  With the help of modern FPGA you can implement any aspects of HFT-applications.  Incoming market data can be entirely processed on FPGAs without the need to send them to and from the processor.  The figure below shows a comparison of the FPGA platform with a conventional software platform: <br><br><img src="https://habrastorage.org/files/4ca/aec/e9f/4caaece9ffba41cf8ef400f2113d3fa5.png"><br><br>  In the latter case, you need a network adapter to receive network traffic.  The necessary part of it is then transferred to the processor, which is ‚Äúinterrupted‚Äù to process the application.  After its completion, data is sent back to the network adapter and transmitted over the network.  In this situation, an approach involving interrupts, as well as the presence of unpredictable delays during PCIe transfers and caching, increases network latency and makes it difficult to predict. <br><br>  In contrast, in the case of FPGAs, incoming network data is ‚Äúfed‚Äù directly to a custom, highly optimized system through the MAC and PHY iron blocks.  Moreover, in fact, the necessary information can be extracted even before the package is fully received.  Thus, the use of FPGA allows you to achieve a significant reduction in overall latency. <br><br><img src="https://habrastorage.org/files/ab1/5a1/45a/ab15a145a930476589e9ad995dc2a6b0.png"><br><br><h5>  Cons of using FPGA </h5><br>  The use of FPGA has its drawbacks in comparison with traditional approaches to the development of trading systems.  The root of the problem is the higher complexity of the development flow under FPGA.  Much of the developers of financial systems and traders are not familiar with this technology and they lack the knowledge and expertise to implement hardware-oriented development. <br><br>  Secondly, the development and testing of new hardware solutions due to a lower level of abstraction is a more complex and lengthy process compared to the usual writing of a trading robot.  All of this is illustrated in the figure below: <br><br><img src="https://habrastorage.org/files/b06/8e4/25b/b068e425b1fd4388a689adce407226e1.png"><br><br>  To avoid this, some FPGA-based HFT platforms have special high-level environments that allow you to create trading systems without the need for hardware description languages ‚Äã‚Äã(HDL). <br><br><h4>  How it works: Algo-Logic Library </h4><br>  The low latency library from Algo-Logic is a gateway tool that is compatible with standard FPGA platforms.  This tool processes the financial protocols used by exchanges in the United States, Europe and other countries, extracting information from the packets as they pass through the FPGA.  Library components are used to build trading applications running at high speeds. <br><br>  The library components are divided into two categories - infrastructure components (interfaces for the network, external memory and host software) and financial information processing modules (protocols, parsing processes, etc.). The figure below shows a more detailed description of these blocks: <br><br><img src="https://habrastorage.org/files/099/fe8/4be/099fe84be4344dbeba30d285b211804f.png"><br><br><h5>  Infrastructure components </h5><br>  All infrastructure components use a standardized interface with a 64-bit machine word.  The SRAM controller provides low latency and high-performance storage for small amounts of data. <br><br>  The register interface module monitors and monitors the status of registers into which software running on the host machine is written and read.  It contains registers of various types, including write-only configuration registers, read-status registers, and the like.  Configuration and status data is transmitted and received via UDP.  Access to the register interface can be obtained through the C ++ API on the host or via the web GUI. <br><br><h5>  Financial Information Processing Components </h5><br>  The Algo-Logic library has IP blocks designed to handle high-frequency trading application level messages.  These messages contain orders and reports on the execution of orders sent between clients, brokers and exchanges.  Among these components are: <br><br>  <i>Financial Protocols Parser</i> - receives data from the TCP / IP processing layer and determines the boundaries of the message.  The parser then extracts the individual fields and sets the flag when the values ‚Äã‚Äãof each field are validated.  This allows for a reduction in latency when extracting.  Now in this particular library there are parsers for protocols FIX, OUCH, XPRS, AcaDIirect, Native Trading gateway, which are used on various exchanges from NASDAQ to London Stock Exchange. <br><br>  Consider the work of the parser on the example of the protocol OUCH (NASDAQ).  The received message is sent to the parsers, which retrieves the fields and sets the necessary flags.  For example, a message type field (‚ÄúO‚Äù or ‚ÄúEnter Order‚Äù) and a 14-byte order token are retrieved.  The indicator of purchase or sale is ‚ÄúT‚Äù (Sell Short), the number of shares is 1002, the exchange ticker of the financial instrument is FFHL.  The remaining fields indicate the desired transaction price, as well as information that the order cannot be moved to another market. <br><br><img src="https://habrastorage.org/files/62d/cd0/e49/62dcd0e492794c86b233790dd2977697.png"><br><br>  Parsing market data and storing price data "on a chip" - financial applications need to know the stock price that is used in orders.  To track prices, market data is sent to the card using UDP / IP datagrams.  The FPGA then retrieves price updates and stores this data for each share.  The prices of all 8,000 stocks traded on US exchanges are placed in the FPGA chip memory. <br><br><img src="https://habrastorage.org/files/0ef/964/ae8/0ef964ae839a4b2f9cb4c2ee64a18311.png"><br><br><h4>  Conclusion </h4><br>  In an effort to reduce potential delays in trading and processing financial information, brokers, traders, and the exchanges themselves are learning how to work with new technologies that will allow them to build high-performance platforms. <br>  One of these technologies is FPGA, but it is important to remember that this tool is not a silver bullet - in addition to its speed advantages, it also has difficulties in developing and maintaining the system. <br><br>  Nevertheless, this tool provides good opportunities for increasing the speed of financial applications.  And here it is important that the entire infrastructure used by the trader meets the requirements for minimizing delays - for this, for example, ITinvest clients can use <a href="http://www.itinvest.ru/services/access/">direct connection</a> technology and place their equipment in ITinvest racks in <a href="http://www.itinvest.ru/services/access/razmeshenie/">the</a> Moscow Exchange <a href="http://www.itinvest.ru/services/access/razmeshenie/">colocation zone</a> with a 10 GB / s channel width. </div><p>Source: <a href="https://habr.com/ru/post/272425/">https://habr.com/ru/post/272425/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272413/index.html">Security Week 49: Used certificates, data theft from children's toys, Microsoft blocks unwanted software</a></li>
<li><a href="../272417/index.html">How to cope with problems in an inherited project after 3 other teams</a></li>
<li><a href="../272419/index.html">Alloy Navigator: Co-pilot for IT Infrastructure</a></li>
<li><a href="../272421/index.html">Acquaintance with the programming language Deluge. Creating an arbitrary function in the Zoho CRM system</a></li>
<li><a href="../272423/index.html">Experience of developing an arcade for Android in C ++ and Qt</a></li>
<li><a href="../272427/index.html">Dynamic lights and shadows in my 2d game</a></li>
<li><a href="../272429/index.html">Moore's Law and Storage Technology</a></li>
<li><a href="../272431/index.html">Mobile search inside apps ... which you don't have!</a></li>
<li><a href="../272433/index.html">Software overview and demonstration - HP ONE VIEW and HP Data Protector</a></li>
<li><a href="../272435/index.html">Review of Managing HP 3PAR StoreServ technologies in the MUK classroom</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>