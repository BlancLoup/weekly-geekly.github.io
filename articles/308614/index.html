<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Developing FreePBX Modules</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="FreePBX is the most popular web interface for configuring servers based on Asterisk. FreePBX is a flexible, modular system. Offers a rich functionalit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Developing FreePBX Modules</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/7a8/958/765/7a8958765cd4438aa0fe37860a202c55.png" alt="image"><br><p>  <b>FreePBX</b> is the most popular web interface for configuring servers based on Asterisk.  FreePBX is a flexible, modular system.  Offers a rich functionality for setting up stations.  The best part is the open source project. </p><br><p>  In practice, it is often necessary to solve a unique problem for which typical FreePBX features are not enough. </p><br><p>  Within the framework of this article, I will describe the possibilities of expanding the functionality with additional modules. <br>  I will describe the process of developing a new module ... </p><a name="habracut"></a><br><h4>  When do you need to develop a module? </h4><br><p>  <b>Replicated product</b> - in case you have to support several PBXs of the same type and the same feature is necessary for many.  For example (callback, integration with Bitrix chat) </p><br><p>  <b>Easy configuration</b> - it is easier and faster to load the module than to edit configs manually.  Once laid the logic, and each subsequent installation requires less time. </p><br><p>  <b>We reduce the chance of an error</b> - the basic settings are usually made on a test stand, and when transferring to production, there may be difficulties with dependencies.  We can put all the necessary files into our module and install them with it. </p><br><p>  <b>GREAT OPPORTUNITIES</b> - the development of modules allows you to more flexibly / finely adjust the PBX, for example, it is possible to redefine the diaplan, or add your own lines to the existing one with an accuracy of the priority number. </p><br><h4>  Asterisk - FreePBX - DB operation scheme </h4><br><img src="https://habrastorage.org/files/84c/5ab/dc9/84c5abdc92a24efb811a2eee74ebdd59.png"><br><p>  <b>Asterisk</b> can use a database to store call history. <br>  <b>FreePBX</b> - interacts with the database, saves and receives settings.  FreePBX modules can access the database to analyze call history. </p><br><p>  <b>One of the functions of FreePBX</b> is the creation of configuration files and the delivery of Asterisk AGI scripts.  FreePBX knows all about Asterisk system directories, Asterisk can manage. </p><br><h4>  FreePBX - modular system </h4><br><img src="https://habrastorage.org/files/ebb/bce/72d/ebbbce72d7914ba4a488e1ef10088c8f.png"><br><p>  The basis of FreePBX is the ‚Äú <b>FreePBX Framework</b> ‚Äù module (hereinafter simply the Framework).  At its core, it is a module that controls other modules.  The framework provides a basic web interface: </p><br><ul><li>  Login window </li><li>  Main menu </li><li>  ‚ÄúModule Admin‚Äù page </li></ul><br><img src="https://habrastorage.org/files/10c/ae8/ceb/10cae8ceb10a4fb3a3afe387b1c2ada2.png"><br><p>  Each module can extend the functionality of FreePBX, for example, add configs and extend the web interface. <br>  All modules essentially depend on the Framework, and may not depend at all on other modules.  Examples of modules: </p><br><ul><li>  <b>ore</b> - provides the functionality of <b>‚ÄúTrunk‚Äù / ‚ÄúIn.</b>  <b>rout ‚Äù/‚Äú Out.</b>  <b>routing</b> and <b>‚ÄúApplication‚Äù</b> functionality <b>- ‚ÄúExtensions‚Äù</b> . </li><li>  <b>IVR</b> - provides voice menu features </li><li>  <b>Queues</b> - call queue functions, etc. </li></ul><br><h4>  Saving FreePBX Configuration </h4><br><p>  After we have changed something in the FreePBX settings, the ‚Äú <b>Apply Config</b> ‚Äù button appears.  The diagram below describes the process of generating configuration files. </p><br><img src="https://habrastorage.org/files/926/8d2/1e4/9268d21e4f074b14b4058f023b18fd48.png"><br><h4>  The first is the <b>Framework</b> module. </h4><br><ul><li>  Saving the settings to the database </li><li>  Creates base configs, for example extensions.conf and <b>extensions_additional.conf</b> </li></ul><br><h4>  Further the Framework addresses to additional modules, for example the <b>core</b> module </h4><br><ul><li>  Uses the functionality of the Framework module and supplements the file <b>extensions_additional.conf</b> with its dialplan </li><li>  Creates <b>sip_additional.conf</b> , <b>res_odbc_additional.conf</b> and other files <b>.</b> </li></ul><br><h4>  We, as developers, can add your module </h4><br><ul><li>  Use <b>framework</b> functions to generate <b>extensions_additional.conf</b> </li><li>  Use the functions of other modules, for example, core to edit the configs of this module: <b>sip_additional.conf</b> , res_odbc_additional.conf </li><li>  Create your own configuration files </li><li>  Use your AGI scripts </li><li>  Expand the web interface with your pages / or your web interfaces </li></ul><br><h4>  Module structure </h4><br><p>  <b>module.xml</b> <br>  This file describes the basic properties of the module. <br>  The most important properties: </p><br><ul><li>  ‚Äú <b>Rawname</b> ‚Äù is a unique name for the module; it must not contain special characters </li><li>  ‚Äú <b>Name</b> ‚Äù - the representation of the module, as it will be displayed in the ‚Äú <b>Module admin</b> ‚Äù, must not contain special characters </li><li>  ‚Äú <b>Version</b> ‚Äù - version of the module </li><li>  ‚ÄúCategory‚Äù - the category of the main menu </li><li>  ‚Äú <b>Menuitems</b> ‚Äù is a module representation in the menu, it can contain ‚Äú <b>menuitems</b> ‚Äù tags defining the names of pages </li><li>  ‚Äú <b>Depends</b> ‚Äù - basic module dependencies </li></ul><br><p>  The file structure is described in detail in the <a href="">documentation</a> . <br>  An example file is shown below: </p><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rawname</span></span></span><span class="hljs-tag">&gt;</span></span>pt1ctraining<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rawname</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>AA Training module<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.11.0.6<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">publisher</span></span></span><span class="hljs-tag">&gt;</span></span>telefon1c.ru<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">publisher</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">license</span></span></span><span class="hljs-tag">&gt;</span></span>GPLv3+<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">license</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">licenselink</span></span></span><span class="hljs-tag">&gt;</span></span>http://www.gnu.org/licenses/gpl-3.0.txt<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">licenselink</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag">&gt;</span></span>Applications<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">menuitems</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pt1ctraining</span></span></span><span class="hljs-tag">&gt;</span></span>AA Training module (MIKO LCC)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pt1ctraining</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">menuitems</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">changelog</span></span></span><span class="hljs-tag">&gt;</span></span> *2.11.0.6*   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">changelog</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depends</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phpversion</span></span></span><span class="hljs-tag">&gt;</span></span>5.3.3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phpversion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag">&gt;</span></span>pt1c ge 2.11.3.18<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depends</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  <b>install.php</b> </p><br><p>  In this file we describe the installation instructions for the module. <br>  In this script it is possible to refer to the ‚Äúglobal‚Äù variables of FreePBX. </p><br><p>  The ‚Äú <b>$ db</b> ‚Äù variable allows you to interact with the FreePBX database. <br>  An example of creating a table for storing module settings: </p><br><pre> <code class="php hljs">out(<span class="hljs-string"><span class="hljs-string">"  ."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> $db; $sql = <span class="hljs-string"><span class="hljs-string">"CREATE TABLE IF NOT EXISTS pt1ctraining ( id INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT, pt1ctraining_id INTEGER NOT NULL, description VARCHAR( 150 ), destination VARCHAR( 50 ), content_app text NOT NULL, path_to_php_agi VARCHAR( 50 ) );"</span></span>; $check = $db-&gt;query($sql); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DB::IsError($check)) { die_freepbx( <span class="hljs-string"><span class="hljs-string">"Can not create `pt1ctraining` table: "</span></span> . $check-&gt;getMessage() . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>); }</code> </pre> <br><p>  Please note that there is no need to specify the parameters for connecting to the database. </p><br><p>  The <b>$ amp_conf variable</b> contains FreePBX configuration parameters (usually defined in <b>/etc/freepbx.conf</b> and <b>/etc/amportal.conf</b> ).  Usage example: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">global</span></span> $amp_conf; out(<span class="hljs-string"><span class="hljs-string">"AMPDBENGINET: "</span></span> + $amp_conf[<span class="hljs-string"><span class="hljs-string">"AMPDBENGINE"</span></span>]);</code> </pre> <br><p>  The <b>out ()</b> function allows you to display information about the progress of the module installation in the message window: </p><br><img src="https://habrastorage.org/files/7af/16e/56c/7af16e56c1754c7f8e6c56cb6d8fe86c.png"><br><p>  Example of adding settings to the ‚Äú <b>Settings - Advanced Settings</b> ‚Äù section: </p><br><img src="https://habrastorage.org/files/770/fee/ce3/770feece327d4635a2930ddd09030115.png"><br><pre> <code class="php hljs">$freepbx_conf =&amp; freepbx_conf::create(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$freepbx_conf-&gt;conf_setting_exists(<span class="hljs-string"><span class="hljs-string">'pt1ctraining_test'</span></span>)) { $set = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $set[<span class="hljs-string"><span class="hljs-string">'value'</span></span>] = <span class="hljs-string"><span class="hljs-string">'all'</span></span>; $set[<span class="hljs-string"><span class="hljs-string">'defaultval'</span></span>] = &amp;$set[<span class="hljs-string"><span class="hljs-string">'value'</span></span>]; $set[<span class="hljs-string"><span class="hljs-string">'readonly'</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; $set[<span class="hljs-string"><span class="hljs-string">'hidden'</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; $set[<span class="hljs-string"><span class="hljs-string">'level'</span></span>] = <span class="hljs-number"><span class="hljs-number">3</span></span>; $set[<span class="hljs-string"><span class="hljs-string">'module'</span></span>] = <span class="hljs-string"><span class="hljs-string">'pt1ctraining'</span></span>; $set[<span class="hljs-string"><span class="hljs-string">'category'</span></span>] = <span class="hljs-string"><span class="hljs-string">'AA Test Module'</span></span>; $set[<span class="hljs-string"><span class="hljs-string">'emptyok'</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; $set[<span class="hljs-string"><span class="hljs-string">'sortorder'</span></span>] = <span class="hljs-number"><span class="hljs-number">11</span></span>; $set[<span class="hljs-string"><span class="hljs-string">'name'</span></span>] = <span class="hljs-string"><span class="hljs-string">'Test settings.'</span></span>; $set[<span class="hljs-string"><span class="hljs-string">'description'</span></span>] = <span class="hljs-string"><span class="hljs-string">'Description test settings.'</span></span>; $set[<span class="hljs-string"><span class="hljs-string">'type'</span></span>] = CONF_TYPE_TEXT; $freepbx_conf-&gt;define_conf_setting(<span class="hljs-string"><span class="hljs-string">'pt1ctraining_test'</span></span>,$set,<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); }</code> </pre> <br><h5>  <b>Etc</b> and <b>agi-bin directories</b> </h5><br><p>  When installing the module, the contents of the directories will be copied to the corresponding asterisk directories: </p><br><img src="https://habrastorage.org/files/750/b47/310/750b47310b5746ca8b8c2d3875fd245a.png"><br><h5>  Uninstall.php </h5><br><p>  The script describes the instructions for removing the module.  Clean for yourself. </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!defined(<span class="hljs-string"><span class="hljs-string">'FREEPBX_IS_AUTH'</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'No direct script access allowed'</span></span>); } sql(<span class="hljs-string"><span class="hljs-string">'DROP TABLE pt1ctraining'</span></span>); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br><p>  The example above describes an example of using a global function named ‚Äú <b>sql</b> ‚Äù.  As an argument, we pass a test query to delete the table. </p><br><p>  In addition, the interesting call ‚Äú <b>defined ('FREEPBX_IS_AUTH')</b> ‚Äù is used, check whether the user is authorized.  It is better to use it for all php scripts. </p><br><p>  All scripts and files named <b>index.php</b> are published on the web server and accessed from outside. </p><br><p>  If the user tries to access the script without authorization, he will receive a notification ‚Äú <b>No direct script access allowed</b> ‚Äù </p><br><img src="https://habrastorage.org/files/235/c42/268/235c42268a394157b34108e9a24dd9f2.png"><br><h4>  The heart of the module is <b>functions.inc.php</b> </h4><br><p>  In this file we implement the functions of our module, the key features: </p><br><ul><li>  Create your own configuration files </li><li>  Add ‚Äúdestination‚Äù options </li><li>  Use functions of other modules </li><li>  Edit the file extensions_additional.conf and others </li></ul><br><p>  In <b>functions.inc.php</b> <b>hook</b> <b>functions</b> can be defined that will be called by the framework module when generating configs. </p><br><p>  Such functions are usually referred to as follows: </p><br><pre> <code class="hljs php"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ModuleName_FunctionName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($engine)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// // }</span></span></code> </pre> <br><h5>  Real function example </h5><br><p>  Define dialplan in <b>extensions_additional.conf</b> </p><br><pre> <code class="hljs bash"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> pt1ctraining_get_config(<span class="hljs-variable"><span class="hljs-variable">$engine</span></span>) { global <span class="hljs-variable"><span class="hljs-variable">$ext</span></span>; switch (<span class="hljs-variable"><span class="hljs-variable">$engine</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'asterisk'</span></span>: //   . <span class="hljs-variable"><span class="hljs-variable">$context</span></span> = <span class="hljs-string"><span class="hljs-string">'ext-pt1ctraining'</span></span>; <span class="hljs-variable"><span class="hljs-variable">$exten</span></span> = <span class="hljs-string"><span class="hljs-string">'_X!'</span></span>; <span class="hljs-variable"><span class="hljs-variable">$ext</span></span>-&gt;add(<span class="hljs-variable"><span class="hljs-variable">$context</span></span>, <span class="hljs-variable"><span class="hljs-variable">$exten</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, new ext_agi(<span class="hljs-string"><span class="hljs-string">'pt1ctraining_AGI.php'</span></span>)); <span class="hljs-variable"><span class="hljs-variable">$ext</span></span>-&gt;add(<span class="hljs-variable"><span class="hljs-variable">$context</span></span>, <span class="hljs-variable"><span class="hljs-variable">$exten</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, new ext_hangup(<span class="hljs-string"><span class="hljs-string">''</span></span>)); } }</code> </pre> <br><p>  The ‚Äú <b>get_config</b> ‚Äù function will be called when creating configuration files when the ‚Äú <b>Apply Config</b> ‚Äù button is pressed. <br>  The string ‚Äú <b>$ engine</b> ‚Äù - the name of the engine, usually ‚Äúasterisk‚Äù will be passed as a parameter. </p><br><p>  The global variable ‚Äú <b>$ ext</b> ‚Äù was used to create dialplan, contains an instance of the class ‚Äú <b>extensions</b> ‚Äù, the class is defined in the file ‚Äú <b>/var/www/html/admin/libraries/extensions.class.php</b> ‚Äù and provides us with a set of tools for generating dialplan. </p><br><p>  The result of the work will be added to <b>extensions_additional.conf</b> : </p><br><pre> <code class="hljs erlang-repl">[ext-pt1ctraining] exten =&gt; _X!,<span class="hljs-number"><span class="hljs-number">1</span></span>,AGI(pt1ctraining_AGI.php) exten =&gt; _X!,n,Hangup</code> </pre> <br><p>  The classes <b>ext_agi</b> and <b>ext_hangup are</b> also defined in <b>extensions.class.php</b> . </p><br><h5>  Example of adding to the ‚Äú[globals]‚Äù section of the extensions_additional.conf file </h5><br><pre> <code class="hljs ruby">global $ext; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>      <span class="hljs-string"><span class="hljs-string">"global"</span></span> $ext-&gt;addGlobal(<span class="hljs-string"><span class="hljs-string">'PT1C_TR'</span></span>, <span class="hljs-string"><span class="hljs-string">'test'</span></span>); $ext-&gt;addGlobal(<span class="hljs-string"><span class="hljs-string">"#include extension_add_pt1c.conf"</span></span>.<span class="hljs-string"><span class="hljs-string">"\n;"</span></span>, <span class="hljs-string"><span class="hljs-string">'\n'</span></span>);</code> </pre> <br><p>  Result of work: </p><br><pre> <code class="hljs objectivec">[globals] <span class="hljs-built_in"><span class="hljs-built_in">CFDEVSTATE</span></span> = <span class="hljs-literal"><span class="hljs-literal">TRUE</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CAMPONTOGGLE</span></span> = *<span class="hljs-number"><span class="hljs-number">84</span></span> DNDDEVSTATE = <span class="hljs-literal"><span class="hljs-literal">TRUE</span></span> FMDEVSTATE = <span class="hljs-literal"><span class="hljs-literal">TRUE</span></span> PT1C_TR = test <span class="hljs-meta"><span class="hljs-meta">#include extension_add_pt1c.conf ; = \n QUEDEVSTATE = TRUE</span></span></code> </pre> <br><p>  To connect an additional file I used a trick in the form of a line break - there is no other solution yet. </p><br><h5>  Use the setting from " <b>Advanced Settings</b> " </h5><br><img src="https://habrastorage.org/files/1d7/260/ca0/1d7260ca0f54471db6cc0ac83771db59.png"><br><p>  Getting global FreePBX configuration. </p><br><pre> <code class="hljs ruby">$freepbx_conf =&amp; freepbx_conf::create(); $pt1c_events = $freepbx_conf-&gt;get_conf_setting(<span class="hljs-string"><span class="hljs-string">'pt1ctraining_test'</span></span>,<span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  dialplan $ext-&gt;add(<span class="hljs-string"><span class="hljs-string">'ext-pt1ctraining-test'</span></span>, <span class="hljs-string"><span class="hljs-string">'_X!'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, new ext_noop(<span class="hljs-string"><span class="hljs-string">"$pt1c_events"</span></span>)); $ext-&gt;add(<span class="hljs-string"><span class="hljs-string">'ext-pt1ctraining-test'</span></span>, <span class="hljs-string"><span class="hljs-string">'_X!'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, new ext_hangup(<span class="hljs-string"><span class="hljs-string">''</span></span>));</code> </pre> <br><h6>  The result in the extensions_additional.conf file: </h6><br><pre> <code class="hljs erlang-repl">[ext-pt1ctraining-test] exten =&gt; _X!,<span class="hljs-number"><span class="hljs-number">1</span></span>,Noop(Privet!!!) exten =&gt; _X!,n,Hangup</code> </pre> <br><h5>  Edit res_odbc_additional.conf </h5><br><p>  We use the <b>core</b> module functionality: </p><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">global</span></span> $core_conf, $amp_conf; $section = <span class="hljs-string"><span class="hljs-string">'PT1C_asteriskcdrdb'</span></span>; $core_conf-&gt;addResOdbc($section, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'enabled'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'yes'</span></span>)); $core_conf-&gt;addResOdbc($section, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'dsn'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'MySQL-asteriskcdrdb'</span></span>)); $core_conf-&gt;addResOdbc($section, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'pooling'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'no'</span></span>)); $core_conf-&gt;addResOdbc($section, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'limit'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'1'</span></span>)); $core_conf-&gt;addResOdbc($section, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'pre-connect'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'yes'</span></span>)); $core_conf-&gt;addResOdbc($section, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'username'</span></span> =&gt; $amp_conf[<span class="hljs-string"><span class="hljs-string">'AMPDBUSER'</span></span>])); $core_conf-&gt;addResOdbc($section, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'password'</span></span> =&gt; $amp_conf[<span class="hljs-string"><span class="hljs-string">'AMPDBPASS'</span></span>]));</code> </pre> <br><h6>  Result of work in res_odbc_additional.conf: </h6><br><pre> <code class="hljs php">[PT1C_asteriskcdrdb] enabled=&gt;yes dsn=&gt;MySQL-asteriskcdrdb pooling=&gt;no limit=&gt;<span class="hljs-number"><span class="hljs-number">1</span></span> pre-connect=&gt;yes username=&gt;freepbxuser password=&gt;d52d251931c2</code> </pre> <br><h5>  Create your config </h5><br><p>  You may need to create your own configuration files. <br>  For this purpose, we must define a class with the name ‚Äú <b>ModuleName_conf</b> ‚Äù.  An example of a class is shown below: </p><br><pre> <code class="hljs lua">//       . class pt1ctraining_conf { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_filename</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { $files = array( <span class="hljs-string"><span class="hljs-string">'extension_additional_pt1ctraining.conf'</span></span>, ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $files; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateConf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($file)</span></span></span></span> { switch ($file) { case <span class="hljs-string"><span class="hljs-string">'extension_additional_pt1ctraining.conf'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $this-&gt;generate_conf(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generate_conf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { $<span class="hljs-built_in"><span class="hljs-built_in">output</span></span> = <span class="hljs-string"><span class="hljs-string">"[test] ; row 1 \n; Privet"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $<span class="hljs-built_in"><span class="hljs-built_in">output</span></span>; } }</code> </pre> <br><p>  The ‚Äú <b>get_filename</b> ‚Äù method returns an array of files to be created. <br>  The ‚Äú <b>generateConf</b> ‚Äù method takes the file name as a parameter and returns the text content of this file. </p><br><h5>  Define your <b>destination</b> </h5><br><img src="https://habrastorage.org/files/68c/88b/d6a/68c88bd6ae7343dcbdafcd3454fb3560.png"><br><p>  Everyone who worked with FreePBX saw the Set Destination field.  Each module can add its own point of destination.  To do this, you must define two procedures: </p><br><pre> <code class="hljs bash">//         destination. // <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> pt1ctraining_getdest(<span class="hljs-variable"><span class="hljs-variable">$exten</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> array(<span class="hljs-string"><span class="hljs-string">'pt1ctraining,'</span></span>.<span class="hljs-variable"><span class="hljs-variable">$exten</span></span>.<span class="hljs-string"><span class="hljs-string">',1'</span></span>); } //   <span class="hljs-string"><span class="hljs-string">"application"</span></span>      . // <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pt1ctraining_destinations</span></span></span></span>() { <span class="hljs-variable"><span class="hljs-variable">$extens</span></span>[] = array(<span class="hljs-string"><span class="hljs-string">'destination'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'ext-pt1ctraining,${EXTEN},1'</span></span> , <span class="hljs-string"><span class="hljs-string">'description'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'IVR'</span></span>); <span class="hljs-variable"><span class="hljs-variable">$extens</span></span>[] = array(<span class="hljs-string"><span class="hljs-string">'destination'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'ext-pt1ctraining_2,${EXTEN},1'</span></span>, <span class="hljs-string"><span class="hljs-string">'description'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'IVR_2'</span></span>); <span class="hljs-variable"><span class="hljs-variable">$extens</span></span>[] = array(<span class="hljs-string"><span class="hljs-string">'destination'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'ext-pt1ctraining_3,${EXTEN},1'</span></span>, <span class="hljs-string"><span class="hljs-string">'description'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'IVR_3'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> <span class="hljs-variable"><span class="hljs-variable">$extens</span></span>; }</code> </pre> <br><p>  The ‚Äú <b>pt1ctraining_getdest</b> ‚Äù function should return an array with a single ‚Äú <b>drain</b> ‚Äù value.  The format is ‚Äú <b>array ('ModuleName,'. $ Exten. ', 1')</b> ‚Äù </p><br><p>  The function ‚Äú <b>pt1ctraining_destinations</b> ‚Äù should return an array with destination points. <br>  Each array element is an associative array with two keys: <br>  ' <b>Destination</b> ' - contains Goto compatible parameters, further redirection will be carried out to dialplan using Goto <br>  ' <b>Description</b> ' contains the name of the destination point, this is how the value will be presented to the user. </p><br><h4>  Module pages </h4><br><p>  Any number of files with the format name ‚Äú <b>page.ModuleName.php</b> ‚Äù can be defined in the module directory, an example is ‚Äú <b>page.pt1ctraining.php</b> ‚Äù. </p><br><p>  In these files we can define the html form for user interaction. </p><br><p>  In order for the web interface to ‚Äúlearn‚Äù about the existence of a page, we must indicate the page identifier in the file ‚Äú <b>module.xml</b> ‚Äù in the ‚Äú <b>menuitems</b> ‚Äù tag with the page name tag: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">menuitems</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pt1ctraining</span></span></span><span class="hljs-tag">&gt;</span></span>AA Training module (MIKO LCC)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pt1ctraining</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">menuitems</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h5>  Sample page </h5><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autocomplete</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"off"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"edit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"&lt;?php $_SERVER['PHP_SELF'] ?&gt;"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onsubmit</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"return edit_onsubmit();"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"itemid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"&lt;?php echo $itemid?&gt;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"action"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"&lt;?php echo ($itemid ? 'edit' : 'add') ?&gt;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">colspan</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h5</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h5</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"info"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"description"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"&lt;?php echo($thisItem['description']); ?&gt;"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"info"</span></span></span><span class="hljs-tag">&gt;</span></span>Dialplan:<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>Text dialplan application.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content_app"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cols</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">50</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rows</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">5</span></span></span><span class="hljs-tag">&gt;</span></span><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php">($thisItem[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'content_app'</span></span></span><span class="php">]); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h4>  Module assembly </h4><br><p>  Everything is simple, the module should be packed using tar tools: </p><br><pre> <code class="bash hljs">tar -czf pt1ctraining ‚Äúpt1ctraining-2.11.0.6.tgz<span class="hljs-string"><span class="hljs-string">";</span></span></code> </pre> <br><p>  If the module is prepared for FreePBX 12+, then it is desirable to sign the module with a digital signature by the developer, details are described in the official <a href="http://wiki.freepbx.org/pages/viewpage.action%3FpageId%3D29753662">documentation</a> . </p><br><p>  You can <a href="https://github.com/FreePBX/devtools">sign the</a> module using the <a href="https://github.com/FreePBX/devtools">devtools</a> utility <a href="https://github.com/FreePBX/devtools">package</a> : </p><br><pre> <code class="bash hljs">sign.php pt1ctraining <span class="hljs-string"><span class="hljs-string">"KEY"</span></span></code> </pre> <br><p>  Where, ‚Äú <b>pt1ctraining</b> ‚Äù is a directory with a module. </p><br><h4>  Conclusion </h4><br><p>  FreePBX is an interesting platform.  Offers extensive functionality to configure PBX. <br>  For the case when the FreePBX function is not enough, it is possible to expand the set of functions by means of an additional module. </p><br><p>  Own module will allow to get more fine tuning of PBX: </p><br><ul><li>  Add your own dialplan </li><li>  Addition of existing configs, for example extensions_additional.conf </li><li>  Adding new configuration files </li><li>  Edit dialplan created by other modules </li></ul><br><p>  As sources of knowledge I recommend using: </p><br><ul><li>  <a href="http://wiki.freepbx.org/">wiki.freepbx.org</a> </li><li>  Source Code - <a href="https://github.com/FreePBX">github.com/FreePBX</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/308614/">https://habr.com/ru/post/308614/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../308604/index.html">Mathematics for artificial neural networks for beginners, part 3 - gradient descent continued</a></li>
<li><a href="../308606/index.html">The history of the virus "The program that dismisses people"</a></li>
<li><a href="../308608/index.html">12 tools and websites for UI / UX designers</a></li>
<li><a href="../308610/index.html">Prometheus - practical use</a></li>
<li><a href="../308612/index.html">Heisenbag - New Testing Conference by JUG.ru Group</a></li>
<li><a href="../308616/index.html">Everything has its time</a></li>
<li><a href="../308618/index.html">Security Week 34: Vulnerability in iOS, Powershell Trojan, Collisions against 3DES and Blowfish</a></li>
<li><a href="../308620/index.html">Top developers can have a life outside of programming.</a></li>
<li><a href="../308622/index.html">Hobby projects: lets-meet.ru - where to go on Friday</a></li>
<li><a href="../308626/index.html">The Levenberg-Marquardt algorithm for the nonlinear least squares method and its implementation in Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>