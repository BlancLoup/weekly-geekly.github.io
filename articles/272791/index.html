<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VMware NSX Demo Review</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We offer you an overview of the VMware NSX solution based on the demonstration report at the MUK-Expo 2015 exhibition. Video demonstration in good qua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VMware NSX Demo Review</h1><div class="post__text post__text-html js-mediator-article"><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/cQuvYVIqPUU%3Ffeature%3Doembed&amp;xid=25657,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrFatnPURMT08m1MyJVhBIQdCLUg" frameborder="0" allowfullscreen=""></iframe><br><br>  We offer you an overview of the VMware NSX solution based on the demonstration report at the <a href="http://expo.muk.ua/">MUK-Expo 2015</a> exhibition.  Video demonstration in good quality - 720p - everything is clearly visible.  For those who do not want to watch the video - under the cut decoding demonstrations and screenshots. <br><br><div class="spoiler">  <b class="spoiler_title">Disclaimers:</b> <div class="spoiler_text">  1. Transcript with small editing. <br>  2. Please remember the difference in written and oral speech. <br>  3. Screenshots in large size, otherwise nothing can be disassembled. </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="http://habrahabr.ru/company/muk/blog/272791/"><img src="https://habrastorage.org/files/e4b/21f/578/e4b21f5780904a18bc0f8fcd9076ccad.png"></a> <br><br>  Colleagues, good afternoon.  We are starting a demo of VMware NSX.  So, what would you like to show today.  Our demo infrastructure is deployed on the basis of our distributor MUK.  The infrastructure is rather small - these are three servers, the servers are ESXI, in the 6th version, the update 1 v-center is updated, that is, the freshest that we can offer. <a name="habracut"></a><br><br>  In this structure, before using NSX, we received several Vlans from network engineers MUK, in which you could place a server segment, video desktops, a segment that has access to the Internet, so that you can get access from a video desktop to the Internet, and access to transit networks so that colleagues from MUK can connect from their internal network, right?  Any operations related, for example, if I want for some demo or some pilot to create some more port-group networks there, to make a more complex configuration, I need to contact my colleagues from MUK, ask them on the equipment that something done there. <br>  If I need interaction between segments, then either negotiate with networkers again, or simply - a small machine, a router inside, two interfaces, back and forth, as we all used to do. <br><br>  Accordingly, the use of the NSX 10 has two objectives: on the one hand, it shows how it works not on virtual machines, on hardware, yes, that it really works and it is convenient;  The second point is to really simplify certain of your tasks.  Accordingly, what do we see at the moment?  At the moment, we see what virtual machines appeared in this infrastructure after the NSX was implemented.  Some of them are mandatory, without them it is impossible.  Some came as a result of a certain setup of the infrastructure itself. <br><br>  Accordingly, the NSX-manager is obligatory - it is the main server through which we can interact with the NSX, it provides the V-center web client its graphical interface, it allows you to access it via the rest api in order to automate some actions, which can be done with the NSX or some scripts, or, for example, from various cloud portals.  For example, VMware vRealize Automation or portals of other vendors.  To work technically, the NSX needs a cluster of NSX controllers, that is, these servers perform a service role.  They determine, they know, yes, they keep information about which physical esxi server, which ip-addresses and mac-addresses are present at the moment, which new servers we have added, which ones have fallen off, spread this information to esxi -servers, that is, in fact, when we have a segment created with the help of NSX, L2, which should be available on several esxi -servers and the virtual machine tries to send an ip-package to another virtual machine in the same L2-segment, NSX- controllers know exactly which host is actually network pa  The ket needs to be delivered.  And they regularly give this information to the hosts.  Each host owns a table, which ip, which mac-addresses on which hosts are located, which really, physically packets need to be transmitted. <br><br><img src="https://habrastorage.org/files/3ba/dc3/098/3badc30986874750867292f6f2f56d0e.png"><br><br>  If we open the configuration of a host, we can see the very interface through which packets will be transmitted over the network.  That is, we have the parameters of the VMkernel adapter, this host will be using this IP address in the VXLan network packets.  We have a little monitor here a little bit, so we have to get out. <br><br><img src="https://habrastorage.org/files/c41/2d1/59d/c412d159d2494f39b24344657eb0d981.png"><br><br>  And we see that a separate TCP / IP stack is used to transmit these packets, that is, there may be a separate default gateway that is different from the usual VMkernel interface.  That is, from the point of view of physics: in order to deploy it in a demo, I needed one VLan in which I can place these interfaces;  preferably - and I checked that this VLan not only extends to these three servers, it stretches a little further if a fourth or fifth server appears there, for example, not in the same chassis where these blades are standing, but somewhere separate maybe not even in this VLan, but which is routed here, I can add, for example, a fourth server, which will be on another network, but they will be able to communicate with each other, I will be able to stretch my L2 networks created using NSX from these three servers including this new fourth. <br><br>  Well, now we‚Äôre actually moving on to what the NSX itself looks like, that is: what can we do with it with the mouse and keyboard, right?  We are not talking about rest api now when we want to automate something. <br><br><img src="https://habrastorage.org/files/8cb/203/8e8/8cb2038e8bde4a1ca93e352aad3efad2.png"><br><br>  The Installation section (now we will go there, I hope, we will switch) allows us to see who our manager is, how many controllers, the controllers themselves are deployed from here.  That is, we download the manager from the VMware website, this is the template, we deploy it and implement it in the V-center.  Next, we set up the manager, give him a login-password to connect to the V-center server, so that he can register the plugin here.  After that, we connect to this already interface, saying: ‚ÄúWe need to implement controllers‚Äù. <br><br>  Minimally, if we are talking, for example, about some kind of test bench, the controller may even be one, the system will work, but this is not recommended.  The recommended configuration is three controllers, preferably on different servers, on different stores, so that the failure of some component could not lead to the loss of all three controllers at once. <br><br><img src="https://habrastorage.org/files/985/50c/333/98550c333b034457a44698af11bf3a8c.png"><br><br>  We can also determine which hosts and which clusters managed by this V-center server will interact with the NSX.  In fact, it is not necessary that the entire infrastructure managed by a single V-center server will work with this, there may be some selective clusters.  Having chosen the clusters, we need to install additional modules on them that allow the esxi server to encapsulate / decapsulate VXLan packets, this is done from this interface again.  That is, you don‚Äôt need to go to SSH, you don‚Äôt need to manually copy any modules; <br><br><img src="https://habrastorage.org/files/47a/c1e/f2d/47ac1ef2d3904e019244f3866b4d981a.png"><br><br>  Next, we must choose, strictly speaking, how this setting of the VMkernel interface will occur.  That is, we choose a distributed switch, choose uplinks, that is, where it happens;  we choose load balancing parameters when there are several links, depending on this, when we have only one ip-address of this type on one host, sometimes there may be several.  Now we use mode one by one. <br><br><img src="https://habrastorage.org/files/69e/0ce/6c1/69e0ce6c18d84e2d904966f5b5438e3d.png"><br><br>  Next, we must select the VXLan ID.  That is, VXLan is a technology reminiscent of VLan, but these are additional tags that allow you to isolate different types of traffic in one real segment.  If VLan identifiers are 4 thousand, VXLan identifiers are 16 million. Here we actually choose a certain range of VXLan number of segments that will be assigned to them by automatic creation of logical switches. <br><br>  How to choose them?  In fact, as you wish, from this range, if you have a large infrastructure and there may be several NSX implementations so that they do not overlap.  Quite simply.  Actually, the same as VLan.  That is, I use the range from 18001 to 18999. <br><br><img src="https://habrastorage.org/files/f4b/05d/0b2/f4b05d0b2bf54e29a13a955bffa14d3e.png"><br><br>  Next, we can create a so-called transport zone.  What is a transport zone?  If the infrastructure is large enough, imagine that you have about hundreds of esxi servers there, about 10 servers per cluster, you have 10 clusters.  We can not use all of them to work with the NSX.  Those of them that we have used, we can use as one infrastructure, and we can divide, for example, into several groups.  To say that we have the first three clusters - this is one island, from the fourth to the tenth - this is some other island.  That is, by creating transport zones, we indicate how far this VXLan segment can spread.  I have three servers here, especially you will not get bored, right?  Therefore, everything is simple.  Just all the hosts I get into this zone. <br><br><img src="https://habrastorage.org/files/ef1/935/bec/ef1935bec2ad4924a50cf184373aa6eb.png"><br><br>  And one more important point.  When setting up a zone, we manage how information will be exchanged to search for information about ip-addresses, mac-addresses.  It can be Unicast, it can be Multycast of L2 level, it can be Unicast routed through L3 level.  Again, depending on the network topology. <br><br>  These are some kind of preliminary things, that is, I repeat once again: all that was required of the network infrastructure is that I have all the hosts on which the NSX should work could communicate with each other via ip, using, if necessary, including and normal routing.  And the second point is that the MTU here in this segment, where they interact, was 1600 bytes, and not 1500 - as it usually happens.  If I can‚Äôt get 1600 bytes, so I‚Äôll just have to tweak the MTU, for example in 1400 in all constructions that I create in the NSX, for example, so that I fit in the physical transport in 1500. <br><br><img src="https://habrastorage.org/files/c03/cd7/79c/c03cd779cbc444498c1346f7e046cb92.png"><br><br>  Further.  Using NSX, I can create a logical switch.  This is easiest compared to the traditional network (VLan cut).  The only thing is that no matter how I know where my physical servers are connected, yes, here they are the same switches.  In theory, the network could be more complex.  You may have some servers connected to one switch, some to another, somewhere L2, somewhere L3.  As a result, actually creating a logical switch, we cut the VLan on all the switches through which the traffic will go.  Why?  Because in fact we are creating VXLan, and the actual physical traffic that switches will see is traffic from the ip address on one hypervisor to the ip address of another hypervisor, udp type, inside the VXLan content. <br><br><img src="https://habrastorage.org/files/6c8/85b/e97/6c885be9758445c2be622aa40ca54094.png"><br><br>  That is, in this way, cutting networks is very easy.  We simply say: ‚ÄúCreate a new segment‚Äù, choose the type of unicast transport, choose which transport zone, that is, in fact, on which esxi clusters this segment will be available.  We wait a little bit - and now this segment will appear.  In fact, what happens when we create these segments?  That is, how to connect a virtual machine there?  There are two options for this. <br><br>  Option number one. <br><br><img src="https://habrastorage.org/files/26d/a28/864/26da288645f64850bc62ab90e1141a58.png"><br><br>  We are right from here saying that we connect a virtual machine to the physical network.  And some of our customers said, "Oh, this is what our networkers want."  They go to the network settings, and he says, here you are, the cord from the machine, including the port of the logical switch, right?  And choose, here - the car, here, respectively, the interface. <br><br>  Or the second option.  In fact, when creating a logical switch, the NSX manager accesses the server V-center and creates a port-group on the distributed switch.  Therefore, in fact, we can simply go to the properties of the virtual machine, select the desired port-group, turn on the virtual machine there.  Since the name is generated programmatically, it will include the name of this logical switch, the number of the VXLan segment.  That is, in principle, from the usual V-center-client is quite understandable, you switch on the virtual machine in the logical segment. <br><br><img src="https://habrastorage.org/files/c29/49c/c64/c2949cc64df640a6bd92423baac24d19.png"><br><br>  Further.  A few more machines that were visible at the very beginning, right?  And that's where they come from.  Some functions of the NSX are implemented directly at the module level in the kernel esxi-i.  This, for example, routing between these segments, this is the firewall when switching between these segments, or even within this segment, some functions are implemented using additional virtual machines.  The so-called EDGE gateways or additional services when they are needed.  What do we see here?  We see that there are three of them in my infrastructure, one of them is called NSX-dlr, dlr is the distributed logical router.  This is a service virtual machine that allows the distributed router to work in the NSX, network traffic does not go through it, it is not a date-plan, but if we have a distributed router, for example, bgp, ospf, dynamic routing protocols, from somewhere these all routes should get, other routers should contact someone and share this information.  Someone should be responsible for the status of "running a distributed router or not."  That is, it is actually a kind of management module of a distributed router.  When configuring it, we can specify that it should work reliably, respectively, two virtual machines in the HA pair will be implemented.  If one for some reason became unavailable, then the second one will work in its place.  The other two edges, which are of type NSX edge, are virtual machines through which traffic is routed or routed to external networks that are not controlled by the NSX.  In my scenario, they are used for two tasks: NSX edge is simply connected to the internal networks of the MUK data center, then it eats, for example, my V-center - as it was on the usual standard port-group, it works there.  In order for me to reach a V-center with some kind of virtual machine on an NSX logical switch, I need someone to connect them.  I connect them with this virtual machine.  It has, indeed, one interface connected to a logical switch, the other interface is connected to a regular port-group on a standart switch on esxi, which is called the NSX Internet edge.  Guess what is different?  Approximately the same thing, but the port-group to which it will connect is the port-group that connects to the DNZ network, in which honest white Internet addresses are used.  That is, on it now, on one of its interfaces, a white ip-address is configured and you can connect to this demo environment using NSX Networking.  Accordingly, additional services such as distributed routing, we set up here in the firewall, if we want to do firewalling, if we want to do nat, if we want to do log balancing or, for example, VPN, with an external connection, for this we open the properties internet edge. <br><br><img src="https://habrastorage.org/files/007/ebd/bbd/007ebdbbd73e42a9ba5de4819945a8ae.png"><br><br>  We are a little bit rounded in time, so I will not show everything that I wanted to show. <br>  Accordingly, in the edge properties we can control the firewall, this is the firewall, which will be applied when the traffic through this virtual machine passes, that is, it is actually a kind of our perimeter firewall obtained.  Further, it can have a dhcp-server, or it can do the forwarding as an ip-helper, since dhcp-helper.  He can do NAT - what I need here for the edge, which looks at one side to the honest Internet, and the other to the internal networks.  It has a load balancer.  It can act as a point for a VPN tunnel or as a terminator for client connections.  Here are two bookmarks: VPN and VPN Plus.  VPN is the site of that site, between the edge and the other edge, between the edge and our cloud, between the edge and the provider‚Äôs cloud, which uses our VCNS or NSX technologies.  SSL VPN Plus - there is a client for various operating systems that you can put on your laptop or user, they can connect to the VPN infrastructure. <br><br><img src="https://habrastorage.org/files/712/a13/46c/712a1346c76244d8be5b36fccbf2f4aa.png"><br><br>  Well, just a few last moments.  Distributed firewall, that is, firewall, is applied on each host, as rules we can specify ip-addresses, packet numbers, port numbers, virtual machine names, including masks, for example.  Make a rule that from all machines whose name begins with up, allow to go to 14:33 on all machines whose name begins with db.  allow traffic from a machine that is in the V-center daddy of one, will walk in the other's daddy, connect to the active directory, say that if we have a machine in a certain ad group, then allow this traffic, if not, then deny traffic.  Well, various other options. <br><br><img src="https://habrastorage.org/files/dc0/009/35b/dc000935b41d4cc7a891d31eda9c471c.png"><br><br>  Plus, again, what to do with traffic?  Three actions: allow, deny, deny.  What is different to prohibit refuse?  And one and the other blocks traffic.  But one just does it very quietly, and the second sends back a message that your traffic has been killed.  And much easier then in the diagnosis. <br><br><img src="https://habrastorage.org/files/24f/fe7/a79/24ffe7a79b064523ab1d70e8dbf8f6bd.png"><br><br>  And literally an important addition at the end.  That is, such a component as a service composer.  Here we can integrate NSX with some additional modules, for example, it is an external load balancer, this is an antivirus, this is some kind of IDS / IPS system.  That is, we can register them.  We can see here what configs are there, we can describe those same security groups.  For example, the demoUsers group is a group that includes itself in the machines on which a user from the demoUsers group logged on.  What do we see now?  That now one virtual machine gets to this group.  Where is she?  Here it is. <br><br><img src="https://habrastorage.org/files/a4a/906/9d1/a4a9069d150c4937a3fb138f69306755.png"><br><br>  Virtual desktop, the user is connected there.  I can make a rule in the firewall in which to say what to allow users of one group access to one file servers, and users of another group to allow access to other file servers.  And even if these are two users who access the same, for example, VDI desktop, but at different times, the firewall will dynamically apply different policies to different users.  Thus you can build a much more flexible infrastructure.  There is no need to allocate some kind of network segments, separate machines for different types of users.  That is, network policies can be dynamically reconfigured depending on who is using the network now. <br><br><hr><br>  Distribution of VMware solutions in <a href="http://muk.ua/company/vendors/vmware/">Ukraine</a> , <a href="http://muk.ua/business/BY/ru.php">Belarus</a> , <a href="http://muk.ua/business/GE/ru.php">Georgia</a> , <a href="http://muk.ua/business/">CIS countries</a> <br><br>  <a href="http://training.muk.ua/courses/vmware/">VMware training courses</a> <br><br>  <a href="http://www.service.muk.ua/">MUK-Service - all types of IT repair: warranty, non-warranty repair, sale of spare parts, contract service</a> </div><p>Source: <a href="https://habr.com/ru/post/272791/">https://habr.com/ru/post/272791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272781/index.html">GDG Devfest Krasnoyarsk and Kaliningrad this Saturday</a></li>
<li><a href="../272783/index.html">Phishing applications for Vkontakte on Google Play</a></li>
<li><a href="../272785/index.html">Publishing HTML5 applications in the AppStore without Mac</a></li>
<li><a href="../272787/index.html">Juniper SRX lineup upgrade</a></li>
<li><a href="../272789/index.html">Lost art proof security. Part 1 of 2</a></li>
<li><a href="../272795/index.html">Big educational program: distributed data storage systems in practical binding for administrators of medium and large businesses</a></li>
<li><a href="../272797/index.html">New free courses of virtual academy Microsoft Virtual Academy, December 2015</a></li>
<li><a href="../272799/index.html">School of Data "Beeline", opening the curtain</a></li>
<li><a href="../272803/index.html">The general scheme of building algorithms on the example of the Rubik's Cube</a></li>
<li><a href="../272805/index.html">Non-standard approach to standard add-on development (Add-In) in C #</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>