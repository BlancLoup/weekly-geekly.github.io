<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Photos from rough sketches: how exactly does the NVIDIA GauGAN neural network work?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last month, NVIDIA unveiled a new application at NVIDIA GTC 2019 that turns simple colored balls drawn by the user into gorgeous photo-realistic image...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Photos from rough sketches: how exactly does the NVIDIA GauGAN neural network work?</h1><div class="post__text post__text-html js-mediator-article">  Last month, NVIDIA unveiled a new application at NVIDIA GTC 2019 that turns simple colored balls drawn by the user into gorgeous photo-realistic images. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/p5U4NgVGAwg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  The application is built on the technology of <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D0%25B5%25D0%25BD%25D0%25B5%25D1%2580%25D0%25B0%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25BE-%25D1%2581%25D0%25BE%25D1%2581%25D1%2582%25D1%258F%25D0%25B7%25D0%25B0%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B5%25D1%2582%25D1%258C">generative-competitive networks</a> (GAN), which is based on in-depth training.  NVIDIA itself calls it GauGAN - a pun intended as a reference to artist Paul Gauguin.  At the core of the GauGAN functionality is the new SPADE algorithm. <br><br>  In this article I will explain how this engineering masterpiece works.  And in order to attract as many interested readers as possible, I will try to give a detailed description of how convolutional neural networks work.  Since SPADE is a generative and adversary network, I will tell you more about them.  But if you are already familiar with this term, you can go directly to the section ‚ÄúImage-to-image translation‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Image generation </h3><br>  Let's begin to understand: in most modern applications of deep learning, the neural discriminant type (discriminator) is used, and SPADE is a generative neural network (generator). <br><a name="habracut"></a><br><h4>  Discriminators </h4><br>  The discriminator is engaged in the classification of input data.  For example, an image classifier is a discriminator that takes an image and selects one suitable class label, for example, defines an image as ‚Äúdog‚Äù, ‚Äúcar‚Äù or ‚Äútraffic light‚Äù, that is, selects a label that fully describes the image.  The output obtained by the classifier is usually represented as a vector of numbers. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.455ex" viewBox="0 -520.7 485.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-76" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> v </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-msubsup" id="MJXp-Span-4"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-6" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.927ex" height="1.817ex" viewBox="0 -520.7 829.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-69" x="686" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> v_i </script>  Is a number from 0 to 1, expressing the network‚Äôs confidence in the image belonging to the selected one <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.937ex" viewBox="0 -728.2 345.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-69" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> i </script>  class. <br><br>  A discriminator can also make a whole list of classifications.  It can classify each pixel of an image as belonging to the class of ‚Äúpeople‚Äù or ‚Äúmachines‚Äù (the so-called ‚Äúsemantic segmentation‚Äù). <br><br><img src="https://habrastorage.org/webt/3l/p0/4w/3lp04wdkvwbud56sg6yt_oprpos.png"><br>  <i>The categorizer takes an image with 3 channels (red, green and blue) and matches it with a vector of confidence in every possible class that an image can represent.</i> <br><br>  Since the connection between an image and its class is very complex, neural networks pass it through a stack of multiple layers, each of which processes it a little and transfers its output to the next level of interpretation. <br><br><h3>  Generators </h3><br>  A generative network like SPADE receives a data set and seeks to create new original data that looks as if it belongs to this data class.  In this case, the data can be any: sounds, language or something else, but we will focus on the images.  In general, data entry into such a network is simply a vector of random numbers, with each of the possible sets of input data creating its own image. <br><br><img src="https://habrastorage.org/webt/nw/zn/5k/nwzn5kh_doy7witqnud_uogyahu.png"><br>  <i>The generator based on a random input vector works in fact the opposite of the image classifier.</i>  <i>In the ‚Äúconditional class‚Äù generators, the input vector is, in fact, a vector of a whole class of data.</i> <br><br>  As we have seen, SPADE uses much more than just a ‚Äúrandom vector‚Äù.  The system is guided by a peculiar drawing, which is called a ‚Äúsegmentation map‚Äù.  The latter indicates what and where to post.  SPADE conducts a process inverse to the semantic segmentation mentioned above.  In general, a discriminatory task that translates one type of data into another has a similar task, but follows a different, unaccustomed way. <br><br>  Modern generators and discriminators typically use convolutional networks to process their data.  For a more complete acquaintance with convolutional neural networks (CNNs), see the post <a href="https://ujjwalkarn.me/2016/08/11/intuitive-explanation-convnets/">Uzhval Karna</a> or the <a href="http://cs231n.github.io/convolutional-networks/">work of Andrey Karpati</a> . <br><br>  There is one important difference between the classifier and the image generator, and it lies in how they change the size of the image during its processing.  The image classifier should reduce it until the image loses all spatial information and only classes remain.  This can be achieved by merging the layers, or through the use of convolutional networks through which individual pixels are passed.  The generator, on the other hand, creates an image using the inverse ‚Äúconvolution‚Äù process, called convolutional transposition.  It is often confused with "deconvolution" or <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B2%25D1%2591%25D1%2580%25D1%2582%25D0%25BA%25D0%25B0">"reverse convolution</a> . <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B2%25D1%2591%25D1%2580%25D1%2582%25D0%25BA%25D0%25B0">"</a> <br><br><img src="https://habrastorage.org/webt/cj/ui/wb/cjuiwbfvvmw77lxce8mq7z9xnrc.gif"><br>  Regular convolution of 2x2 in increments of "2" turns each block of 2x2 into one point, reducing the output dimensions by 1/2. <br><br><img src="https://habrastorage.org/webt/ar/3m/su/ar3msu_lrh9hitoa8zzkociyiza.gif"><br>  Transposed convolution of 2x2 with step ‚Äú2‚Äù generates a 2x2 block from each point, increasing the output dimensions by 2 times. <br><br><h3>  Generator training </h3><br>  Theoretically, a convolutional neural network can generate images in the manner described above.  But how do we train it?  That is, if we take into account the set of input data-images, how can we adjust the parameters of the generator (in our case SPADE) to create new images that look as if they correspond to the proposed data set? <br><br>  For this, it is necessary to make a comparison with image classifiers, where each of them has the correct class label.  Knowing the network prediction vector and the correct class, we can use the backpropagation algorithm to determine the network update parameters.  This is necessary to increase its accuracy in determining the desired class and reduce the influence of other classes. <br><br><img src="https://habrastorage.org/webt/bm/e_/o5/bme_o5qesvx-hljrq7ig0jlbwuo.png"><br>  <i>The accuracy of the image classifier can be assessed by comparing its output element by element with the correct class vector.</i>  <i>But for generators there is no ‚Äúright‚Äù output image.</i> <br><br>  The problem is that when the generator creates an image, there are no ‚Äúcorrect‚Äù values ‚Äã‚Äãfor each pixel (we cannot compare the result, as in the case of the classifier on a previously prepared base, - approx. Lane).  Theoretically, any image that looks plausible and looks like target data is valid, even if its pixel values ‚Äã‚Äãare very different from real images. <br><br>  So, how can we tell the generator in which pixels it should change its output, and how can it create more realistic images (i.e., how to give an ‚Äúerror signal‚Äù)?  Researchers have thought a lot about this issue, and in fact it is quite difficult.  Most ideas, such as calculating some average "distance" to real images, give low-quality blurry pictures. <br><br>  Ideally, we could ‚Äúmeasure‚Äù how realistic the generated images look by using the ‚Äúhigh level‚Äù concept, such as ‚ÄúHow difficult is it to distinguish this image from the real one?‚Äù ... <br><br><h3>  Generative competitive networks </h3><br>  That is what was realized in the framework of the work of <a href="https://arxiv.org/pdf/1406.2661.pdf">Goodfellow et al., 2014</a> .  The idea is to generate images using two neural networks instead of one: one network - <br>  the generator, the second - the image classifier (discriminator).  The discriminator‚Äôs task is to distinguish the output images of the generator from the real images from the primary data set (the classes of these images are marked as ‚Äúfake‚Äù and ‚Äúreal‚Äù).  The job of the generator is to trick the discriminator by creating images that most closely resemble the images in the data set.  It can be said that the generator and the discriminator are opponents in this process.  Hence the name: <b><i>generative-adversary network</i></b> . <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="https://adamdking.com/blog/gaugan/images/gan.mp4" type="video/mp4"></video></div></div></div><br>  <i>Generative-adversary network based on random vector input.</i>  <i>In this example, one of the generator outputs tries to trick the discriminator when selecting the ‚Äúreal‚Äù image.</i> <br><br>  How does this help us?  Now we can use an error message based solely on discriminator prediction: a value from 0 (‚Äúfake‚Äù) to 1 (‚Äúreal‚Äù).  Since the discriminator is a neural network, we can share its conclusions about errors and the image generator.  That is, the discriminator can tell the generator where and how he should correct his images in order to better ‚Äúdeceive‚Äù the discriminator (i.e., how to increase the realism of his images). <br><br>  In the process of learning to find fake images, the discriminator provides the generator with the best and best feedback on how the latter can improve its work.  Thus, the discriminator performs the <a href="https://towardsdatascience.com/common-loss-functions-in-machine-learning-46af0ffc4d23">‚Äúlearn a loss‚Äù function</a> for the generator. <br><br><h3>  "Nice Small" GAN </h3><br>  The GAN considered by us in its work follows the logic described above.  His discriminator <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.924ex" height="2.057ex" viewBox="0 -780.1 828.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-44" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> D </script>  analyzes the image <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> x </script>  and gets value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D </font></font></span><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.063ex" height="2.66ex" viewBox="0 -832 2180 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-78" x="1218" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="1790" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> D (x) </script>  from 0 to 1, which reflects his degree of confidence in whether this is a real image, or forged by a generator.  His generator <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-18"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-47" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> G </script>  gets a random vector of normally distributed numbers <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.057ex" viewBox="0 -780.1 723.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-5A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> Z </script>  and displays the image <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-22"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G </font></font></span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.724ex" height="2.66ex" viewBox="0 -832 2034 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-7A" x="1176" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="1644" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> G (z) </script>  which may be deceived by the discriminator (in fact, this image <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D </font></font></span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G </font></font></span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.458ex" height="2.66ex" viewBox="0 -832 3641.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-47" x="1218" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="2004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-7A" x="2394" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="2862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="3252" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> D (G (z)) </script>  ) <br><br>  One of the questions that we didn‚Äôt discuss is how GAN is taught and what <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D1%2583%25D0%25BD%25D0%25BA%25D1%2586%25D0%25B8%25D1%258F_%25D0%25BF%25D0%25BE%25D1%2582%25D0%25B5%25D1%2580%25D1%258C">loss function</a> developers use to measure network performance.  In the general case, the loss function should increase as the discriminator learns and decrease as the generator learns.  The loss function of the original GAN ‚Äã‚Äãused the following two parameters.  The first - <br>  represents the degree of how often the discriminator correctly classifies real images as real.  The second is how well the discriminator detects fake images: <br><br><math> </math> $ inline $ \ begin {equation *} \ mathcal {L} _ \ text {GAN} (D, G) = \ underbrace {E _ {\ vec {x} \ sim p_ \ text {data}} [\ log D ( \ vec {x})]} _ {\ text {accuracy on real images}} + \ underbrace {E _ {\ vec {z} \ sim \ mathcal {N}} [\ log (1 - D (G (\ vec {z}))]} _ {\ text {accuracy on fakes}} \ end {equation *} $ inline $ <br><br>  Discriminator <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.924ex" height="2.057ex" viewBox="0 -780.1 828.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-44" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> D </script>  derives his claim that the image is real.  It makes sense, since <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D </font></font></span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.89ex" height="2.66ex" viewBox="0 -832 3827.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-6F" x="681" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-67" x="1167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-44" x="1647" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="2476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-78" x="2865" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="3438" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> LogD (x) </script>  increases when the discriminator considers x to be real.  When the discriminator detects fake images better, the value of the expression increases. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g </font></font></span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-123"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g </font></font></span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.773ex" height="2.66ex" viewBox="0 -832 6790.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-6F" x="681" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-67" x="1167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="1647" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-31" x="2037" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-2212" x="2759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-64" x="3760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="4283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-67" x="4673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="5153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-7A" x="5543" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="6011" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="6401" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> Log (1-d (g (z)) </script>  (begins to strive for 1), since <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D </font></font></span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G </font></font></span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.458ex" height="2.66ex" viewBox="0 -832 3641.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-47" x="1218" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="2004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-7A" x="2394" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="2862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="3252" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> D (G (z)) </script>  will aim for 0. <br><br>  In practice, we estimate accuracy using whole batches of images.  We take a lot (but not all) of real images. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> x </script>  and many random vectors <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.057ex" viewBox="0 -780.1 723.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-5A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> Z </script>  to get averaged numbers using the formula above.  Then we select common errors and data set. <br><br>  Over time, this leads to interesting results: <br><img src="https://habrastorage.org/webt/fk/is/dl/fkisdlnj8ntp7xgbuiywelik_ga.png"><br>  <i>Goodfellow GAN that mimics the MNIST, TFD and CIFAR-10 data sets.</i>  <i>Contour images are closest in the data set to adjacent counterfeits.</i> <br><br>  All this was fantastic just 4.5 years ago.  Fortunately, as shown by SPADE and other networks, machine learning continues to progress rapidly. <br><br><h3>  Workout problems </h3><br>  Generative-competitive networks are notorious for their complexity in the preparation and instability of work.  One of the problems is that if the generator is too far ahead of the discriminator in the pace of learning, then its selection of images is narrowed down to specifically those that help it to deceive the discriminator.  In fact, as a result, generator training comes down to the creation of a single universal image to deceive the discriminator.  This problem is called ‚Äúcollapse mode‚Äù. <br><br><img src="https://habrastorage.org/webt/q7/o7/-n/q7o7-nzdhklaqmr5zkjit1kyekm.png"><br>  GAN collapse mode is similar to Goodfellow's.  Note that many of these bedroom images look very similar to each other.  <i><a href="https://arxiv.org/pdf/1701.07875.pdf">A source</a></i> <br><br>  Another problem is that when the generator effectively deceives the discriminator <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D </font></font></span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g </font></font></span><span class="MJXp-mo" id="MJXp-Span-148" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.747ex" height="2.66ex" viewBox="0 -832 3335.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-67" x="1218" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="1698" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-7A" x="2088" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="2556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="2946" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> D (g (z)) </script>  , it operates with a very small gradient, therefore <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-152"><span class="MJXp-mtext" id="MJXp-Span-153">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">l</span><span class="MJXp-msubsup" id="MJXp-Span-161"><span class="MJXp-mrow" id="MJXp-Span-162" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">L</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-164" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">t</span><span class="MJXp-mrow" id="MJXp-Span-169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">N</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">G</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-175">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">c</span><span class="MJXp-mrow" id="MJXp-Span-179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">z</span></span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.604ex" height="2.66ex" viewBox="0 -832 12746 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-63" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-61" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-6C" x="3559" y="0"></use><g transform="translate(3857,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-4C" x="0" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-74" x="4889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-65" x="5250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-78" x="5717" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-74" x="6289" y="0"></use><g transform="translate(6651,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-41" x="786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-4E" x="1537" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-47" x="9076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-28" x="9863" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-76" x="10502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-65" x="10988" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-63" x="11454" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-7A" x="11888" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMAIN-29" x="12356" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> \ mathcal {L} _ \ text {GAN} G (\ vec {z}) </script>  can not get enough data to find the true answer, in which this image would look more realistic. <br><br>  The efforts of researchers to solve these problems were mainly aimed at changing the structure of the loss function.  One of the simple changes proposed by <a href="https://arxiv.org/pdf/1611.04076.pdf">Xudong Mao et al., 2016</a> , is to replace the loss function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-mtext" id="MJXp-Span-183">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">l</span><span class="MJXp-msubsup" id="MJXp-Span-191"><span class="MJXp-mrow" id="MJXp-Span-192" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">L</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-194" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">t</span><span class="MJXp-mrow" id="MJXp-Span-199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">N</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.081ex" height="2.298ex" viewBox="0 -780.1 9076.5 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-63" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-61" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-6C" x="3559" y="0"></use><g transform="translate(3857,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-4C" x="0" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-74" x="4889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-65" x="5250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-78" x="5717" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-74" x="6289" y="0"></use><g transform="translate(6651,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-41" x="786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-4E" x="1537" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-20"> \ mathcal {L} _ \ text {GAN} </script>  for a couple of simple functions <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-203"><span class="MJXp-msubsup" id="MJXp-Span-204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-206" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">t</span><span class="MJXp-mrow" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">N</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.976ex" height="2.298ex" viewBox="0 -780.1 6448 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-74" x="933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-65" x="1295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-78" x="1761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-74" x="2334" y="0"></use><g transform="translate(2695,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-53" x="681" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-47" x="1327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-41" x="2113" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-4E" x="2864" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-21"> V_ \ text {LSGAN} </script>  which are based on smaller squares.  This leads to a stabilization of the training process, obtaining higher-quality images and a lower chance of collapse using continuous gradients. <br><br>  Another problem faced by researchers is the difficulty of obtaining high-resolution images, partly because the more detailed image gives the discriminator more information for detecting fake images.  Modern GANs begin to train the network with low-resolution images and gradually add more and more layers until the desired image size is reached. <br><br><img src="https://habrastorage.org/webt/yk/-1/d8/yk-1d8pgyb9jgili9yszw0keeoo.gif"><br>  <i>Gradually adding higher resolution layers during GAN training significantly improves the stability of the entire process, as well as the speed and quality of the resulting image.</i> <br><br><h3>  Image-to-image broadcast </h3><br>  So far we have been talking about how to generate images from random sets of input data.  But SPADE doesn't just use random data.  This network uses an image called a segmentation map: it assigns each pixel a class of material (for example, grass, wood, water, stone, sky).  From this map image, SPADE generates what looks like a photo.  This is called the "Image-to-image broadcast". <br><br><img src="https://habrastorage.org/webt/hu/rp/8j/hurp8ju_zla9v6enpsskq0ntsuq.png"><br>  <i>Six different types of Image-to-image broadcasting, demonstrated by the pix2pix network.</i>  <i>Pix2pix is ‚Äã‚Äãthe forerunner of two networks, which we will examine further: pix2pixHD and SPADE.</i> <br><br>  In order for the generator to learn this approach, it needs a set of segmentation maps and corresponding photos.  We modify the GAN architecture so that both the generator and the discriminator receive a segmentation map.  The generator, of course, needs a map in order to know which way to draw.  It is also necessary for the discriminator to make sure that the generator places the right things in the right places. <br><br>  During training, the generator learns not to plant grass where the sky is indicated on the segmentation map, because otherwise the discriminator will easily identify the fake image, and so on. <br><br><img src="https://habrastorage.org/webt/dh/ov/j1/dhovj1gepl4un4xob0_xo9sjkw4.png"><br>  <i>For image-to-image translation, the input image is received by both the generator and the discriminator.</i>  <i>The discriminator additionally receives either the generator output data or the true output from the training data set.</i>  <i><a href="http://dags.stanford.edu/projects/scenedataset.html">Example</a></i> <br><br><h3>  Development of image-to-image translator </h3><br>  Let's look at the real image-to-image translator: <a href="https://github.com/NVIDIA/pix2pixHD">pix2pixHD</a> .  By the way, SPADE is designed mostly in the image and likeness of pix2pixHD. <br><br>  For the image-to-image translator, our generator creates an image and takes it as an input.  We could just use a map of convolutional layers, but since convolutional layers only combine values ‚Äã‚Äãin small areas, we need too many layers to transmit image information in high resolution. <br><br>  pix2pixHD solves this problem more efficiently with the help of the ‚ÄúEncoder‚Äù, which reduces the scale of the input image, followed by the ‚ÄúDecoder‚Äù, which increases the scale to obtain the output image.  As we will soon see, SPADE has a more elegant solution that does not require an encoder. <br><br><img src="https://habrastorage.org/webt/yt/sm/ar/ytsmarahd57zuest6ccdnpnvkok.png"><br>  <i>The pix2pixHD network scheme is at the ‚Äúhigh‚Äù level.</i>  <i>‚ÄúResidual‚Äù blocks and ‚Äú+ operation‚Äù refer to the ‚Äúskip connections‚Äù technology of the <a href="https://en.wikipedia.org/wiki/Residual_neural_network">Residual neural network</a> .</i>  <i>There are skip blocks in the network that correspond to each other in the encoder and decoder.</i> <br><br><h3>  Batch normalization is a problem. </h3><br>  Almost all modern convolutional neural networks use packet normalization or one of its analogues to speed up and stabilize the training process.  Activating each channel shifts the mean to 0 and the standard deviation to 1 before the pair of channel parameters <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-217"><span class="MJXp-mtext" id="MJXp-Span-218">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.731ex" height="2.057ex" viewBox="0 -780.1 2037 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/447896/&amp;xid=17259,1500004,15700021,15700043,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhXsxwGe_yhTOve_i4Y_-VUuTZRyA#MJMATHI-61" x="1507" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-22"> \ beta </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-223"><span class="MJXp-mtext" id="MJXp-Span-224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ gamma </script>  allow them to denormalize again. <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">y</span><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">c</span><span class="MJXp-mrow" id="MJXp-Span-238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">x</span><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-241">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">m</span><span class="MJXp-mrow" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">E</span></span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">x</span><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0em;">]</span></span><span class="MJXp-mrow" id="MJXp-Span-253"><span class="MJXp-mtext" id="MJXp-Span-254">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">t</span><span class="MJXp-mrow" id="MJXp-Span-259"><span class="MJXp-mtext" id="MJXp-Span-260">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">m</span><span class="MJXp-mrow" id="MJXp-Span-267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">r</span></span><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">x</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mtext" id="MJXp-Span-284">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">a</span><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-291">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> y = \ frac {x - \ mathrm {E} [x]} {\ sqrt {\ mathrm {Var} [x] + \ epsilon}} * \ gamma + \ beta </script><br><br>  Unfortunately, packet normalization damages the generators, making it difficult for the network to implement some types of image processing.  Instead of normalizing a batch of images, pix2pixHD uses the <a href="https://arxiv.org/pdf/1607.08022.pdf">normalization standard</a> , which normalizes each image separately. <br><br><h3>  Learning pix2pixHD </h3><br>  Modern GANs, such as pix2pixHD and SPADE, measure the realism of their output images in a slightly different way than was described for the original design of generative-contention networks. <br><br>  To solve the problem of generating high-resolution images, pix2pixHD uses three discriminators of the same structure, each of which receives an output image at a different scale (normal size, reduced by 2 times and reduced by 4 times). <br><br>  To determine its loss function, pix2pixHD uses <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-296"><span class="MJXp-msubsup" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-299" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">t</span><span class="MJXp-mrow" id="MJXp-Span-304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">N</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> V_ \ text {LSGAN} </script>  and also includes another element designed to make the generator outputs more realistic (regardless of whether it helps to deceive the discriminator).  This item <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-310"><span class="MJXp-mtext" id="MJXp-Span-311">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-319"><span class="MJXp-mrow" id="MJXp-Span-320" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-322" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> \ mathcal {L} _ \ text {FM} </script>  is called ‚Äúfeature matching‚Äù - it causes the generator to make the distribution of layers when simulating discrimination the same between real data and generator outputs, minimizing <math> <a href="https://en.wikipedia.org/wiki/Taxicab_geometry"></a></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-330"><span class="MJXp-msubsup" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-333" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> D </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> L_1 Distance </script>   between them. <br><br>  So, optimization is as follows: <br><br><p><math> </math> $$ display $$ \ begin {equation *} \ min_G \ bigg (\ lambda \ sum_ {k = 1,2,3} V_ \ text {LSGAN} (G, D_k) + \ big (\ max_ {D_1, D_2 , D_3} \ sum_ {k = 1,2,3} \ mathcal {L} _ \ text {FM} (G, D_k) \ big) \ bigg) \ end {equation *}, $$ display $$ </p><br><br>  where losses are summed by three discriminatory factors and coefficient <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-415"><span class="MJXp-mtext" id="MJXp-Span-416">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-423" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-424"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ lambda = 10 </script>  which controls the priority of both elements. <br><br><img src="https://habrastorage.org/webt/ww/aa/pn/wwaapn8danh3icipqdez2ds1sjq.png"><br>  <i>pix2pixHD uses a segmentation map made up of a real bedroom (on the left in each example) to create a fake bedroom (on the right).</i> <br><br>  Although discriminators reduce the scale of the image until the entire image is disassembled, they stop at ‚Äúspots‚Äù measuring 70 √ó 70 (at appropriate scales).  Then they simply summarize all the values ‚Äã‚Äãof these ‚Äúspots‚Äù for the entire image. <br><br>  And this approach works great because the function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-425"><span class="MJXp-mtext" id="MJXp-Span-426">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-434"><span class="MJXp-mrow" id="MJXp-Span-435" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-437" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> \ mathcal {L} _ \ text {FM} </script>  makes sure that the image looks realistic in high resolution, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-445"><span class="MJXp-msubsup" id="MJXp-Span-446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-448" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> V_ \ text {LSGAN} </script>  only required for checking small parts.  This approach also has additional advantages in the form of network acceleration, reducing the number of parameters used and the possibility of using it to generate images of any size. <br><br><img src="https://habrastorage.org/webt/ce/1s/hy/ce1shyval-twwfy_x3wg8csds0s.png"><br>  <i>pix2pixHD generates photorealistic images with appropriate grimaces from simple sketches of faces.</i>  <i>Each example shows a real image from the CelebA dataset on the left, a sketch of this celebrity's facial expression in the form of a sketch and the image created from this data on the right.</i> <br><br><h3>  What is wrong with pix2pixHD? </h3><br>  These results are incredible, but we can do better.  It turns out that pix2pixHD loses a lot in one important aspect. <br><br>  Consider what pix2pixHD does with single-entry, for example, with a map that has grass everywhere.  Since the entrance is spatially uniform, the outputs of the first convolutional layer are also the same.  Then normalization of instances ‚Äúnormalizes‚Äù all (identical) values ‚Äã‚Äãfor each channel in the image and returns <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-459"><span class="MJXp-mn" id="MJXp-Span-460"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> 0 </script>  as a conclusion for all of them.  The Œ≤-parameter can shift this value from zero, but the fact remains: the output will no longer depend on whether the input is ‚Äúgrass‚Äù, ‚Äúsky‚Äù, ‚Äúwater‚Äù or something else. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nv/6w/jo/nv6wjoe1wukuuwvl-djpzlhjmda.png"></div><br>  <i>In pix2pixHD, instance normalization tends to ignore information from the segmentation map.</i>  <i>For images consisting of one class, the network generates the same image independently of this class itself.</i> <br><br>  And the solution to this problem is the main feature of the SPADE design. <br><br><h3>  Solution: SPADE </h3><br>  Finally, we have reached a fundamentally new level in the creation of images from segmentation maps: spatial-adaptive (de) normalization (SPADE). <br><br>  The idea behind SPADE is to prevent the semantic information from being lost in the network, allowing the segmentation map to control the normalization parameters Œ≥, as well as Œ≤, locally, at the level of each individual layer.  Instead of using only one pair of parameters for each channel, they are calculated for each spatial point by submitting a downsampled segmentation map through 2 convolutional layers. <br><br><img src="https://habrastorage.org/webt/nr/ph/io/nrphiofsvu2wonakqdtdgtrqseq.png"><br>  <i>Instead of rolling the segmentation map onto the first layer, SPADE uses its downsampled versions to modulate the normalized output for each layer.</i> <br><br>  The SPADE generator integrates the entire structure into small ‚Äúresidual blocks‚Äù that fit between the upsampling layers (transposed convolution): <br><br><img src="https://habrastorage.org/webt/ch/hc/jk/chhcjkeumb2ukfdb1ifygvf3afu.png"><br>  <i>SPADE high-level generator circuit versus pix2pixHD</i> <br><br>  Now that the segmentation map is being fed from the inside of the network, there is no need to use it as input for the first layer.  Instead, we can return to the original GAN ‚Äã‚Äãscheme, which used a random vector as input.  This gives us an additional opportunity to generate different images from one segmentation map (‚Äúmultimodal synthesis‚Äù).  It also makes unnecessary the entire pix2pixHD ‚Äúencoder‚Äù, and this is a serious simplification. <br><br>  SPADE uses the same loss function as pix2pixHD, but with one change: instead of squaring the values <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-461"><span class="MJXp-msubsup" id="MJXp-Span-462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-464" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> V_ \ text {LSGAN} </script>  it uses <a href="https://en.wikipedia.org/wiki/Hinge_loss">hinge loss</a> . <br><br>  With these changes we get great results: <br><br><img src="https://habrastorage.org/webt/ba/5o/5-/ba5o5-tthdyqh44mt4pfibo3zji.png"><br>  <i>Here the results of SPADE are compared with the results of pix2pixHD</i> <br><br><h3>  Intuition </h3><br>  Let's think about how SPADE can show such results.  In the example below, we have a tree.  GauGAN uses one "tree" class to represent both the trunk and the leaves of the tree.  However, somehow SPADE finds out that the narrow part at the bottom of the ‚Äútree‚Äù is the trunk and should be brown, while the large drop from above should be foliage. <br><br>  The down-sampled segmentation that SPADE uses to modulate each layer provides similar ‚Äúintuitive‚Äù recognition. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="https://adamdking.com/blog/gaugan/images/intuition.mp4" type="video/mp4"></video></div></div></div><br><br>  You may notice that the tree trunk continues in the part of the crown, which refers to the "foliage".  So how does SPADE understand where to place part of the trunk there, and where is the foliage?  After all, judging by the 5x5 map, there should be just a ‚Äútree‚Äù there. <br><br>  The answer is that the area shown can receive information from lower resolution layers, where a 5x5 block contains the entire tree.  Each subsequent convolutional layer also provides some movement of information in the image, which gives a more complete picture. <br><br>  SPADE allows the segmentation map to directly modulate each layer, but this does not hinder the process of connected information distribution between layers, as it happens, for example, in pix2pixHD.  This prevents the loss of semantic information, since it is updated in each subsequent layer at the expense of the previous one. <br><br><h3>  Transmission style </h3><br>  In SPADE, there is another magical solution - the ability to generate an image in a given style (for example, lighting, weather, time of year). <br><br><img src="https://habrastorage.org/webt/k5/yz/qj/k5yzqjyrqgvanm7dlrapd7yzcpa.png"><br>  <i>SPADE can generate several different images on the basis of a single segmentation map, mimicking a given style.</i> <br><br>  It works like this: we skip the images through the encoder and train it to set the generator vectors <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> Z </script>  which in turn will generate similar images.  After the encoder has been trained, we replace the corresponding segmentation maps with arbitrary ones, and the SPADE generator creates images that correspond to the new maps, but in the style of the provided images based on previously received training. <br><br>  Since the generator usually expects to receive a sample on the basis of a multidimensional normal distribution, in order to obtain realistic images, we must train the encoder to derive values ‚Äã‚Äãwith a similar distribution.  In fact, this is the idea of ‚Äã‚Äãvariational <a href="http://anotherdatum.com/vae.html">auto-encoders</a> , which <a href="http://anotherdatum.com/vae.html">is explained by Yoel Zeldes</a> . <br><br>  This is how SPADE / GaiGAN functions.  I hope this article has satisfied your curiosity about how the new NVIDIA system works.  You can contact me via Twitter @AdamDanielKin or by email adam@AdamDKing.com. </div><p>Source: <a href="https://habr.com/ru/post/447896/">https://habr.com/ru/post/447896/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447884/index.html">We understand how 5G will work in the millimeter range on the street and in rooms</a></li>
<li><a href="../447886/index.html">Analyzing Nginx Logs with Amazon Athena and Cube.js</a></li>
<li><a href="../447890/index.html">Thank god i'm not a manager</a></li>
<li><a href="../447892/index.html">Two new PHDays contests: IDS bypass and factory hacking</a></li>
<li><a href="../447894/index.html">MODX Digest # 3 (March 25 - April 8, 2019)</a></li>
<li><a href="../447900/index.html">Close contacts of ADL degree</a></li>
<li><a href="../447902/index.html">GitHub has completely ‚Äúdeleted‚Äù the utility repository for circumventing locks and the entire creator account.</a></li>
<li><a href="../447904/index.html">Positive Technologies Experts Revealed Attempts to Mass Exploit Critical Threats to Confluence</a></li>
<li><a href="../447906/index.html">Actual innovation: what to expect from the data center market in 2019?</a></li>
<li><a href="../447908/index.html">Two ways to collect awards for advertising in mobile games, or robots should work</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>