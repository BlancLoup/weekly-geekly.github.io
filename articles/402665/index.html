<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Neural Network Deep Photo Style Transfer brings style to your photos</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Someday in the future we will be able to wear glasses - and walk around the city, which is rendered in real time in the style we like. Sunlight or lig...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Neural Network Deep Photo Style Transfer brings style to your photos</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/859/a88/f95/859a88f95c494f6c800422fb0869e6b3.jpg"><br><br>  Someday in the future we will be able to wear glasses - and walk around the city, which is rendered in real time in the style we like.  Sunlight or light haze, evening sunset, whatever.  No matter how bleak the architecture is, it will be beautiful with glasses.  Such rendering styles with the transfer of styles opens an amazing program <a href="https://github.com/luanfujun/deep-photo-styletransfer">Deep Photo Style Transfer</a> , which is published in the public domain, as well as the <a href="https://arxiv.org/abs/1703.07511">scientific work</a> underlying it (arXiv: 1703.07511). <br><a name="habracut"></a><br>  Transferring the style from one image to another is an old problem that the developers have tried to solve relatively successfully in the past.  Having correctly selected a sample for transferring a style, you can beautifully transform your photo - as if it was made at a different time of day, under different lighting, in different weather or in a special way artistically processed.  Until now, style transfer techniques using neural networks were relatively limited ‚Äî either they could only work with specific scenes, or the likelihood of style transfer suffered.  The authors of the new program <a href="https://github.com/luanfujun/deep-photo-styletransfer">Deep Photo Style Transfer</a> tried to solve all these problems. <br><br>  The Deep Photo Style Transfer neural network is built according to the Neural Style transfer technique described by <a href="https://geektimes.ru/post/261116/">Gatis</a> , but has been significantly reworked and improved.  The main improvement is photorealism.  In Gatis, even if the original image and the sample are photographs, the final image still resembles a drawing where the clear lines and borders become blurred and the textures are superimposed on neighboring objects.  It looks beautiful, but not very real. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Color space only </h1><br>  The result of Deep Photo Style Transfer is strictly photorealistic.  "Effects of painting" eliminated due to the ban on spatial distortion.  Here the transfer of styles is limited only to the color space.  In other words, the shapes of objects remain exactly the same as in the original.  It is for this reason that in the future the ‚Äúglasses‚Äù, which were mentioned at the beginning of the article, will become possible.  All objects in the surrounding reality will retain their shape, just look in a different style. <br><br>  The authors have achieved the task, using a specific layer of the neural network in the spirit of <a href="http://www.wisdom.weizmann.ac.il/~levina/papers/Matting-Levin-Lischinski-Weiss-CVPR06.pdf">the Kirchhoff matrix</a> (Laplacian matrix) - representation of the graph as a matrix.  As the test showed on photographs with different subjects, this approach successfully suppresses distortion, while at the same time exerting minimal impact on the accuracy of photographs. <br><br>  The most clearly described principle appears in two specially selected examples. <br><br><img src="https://habrastorage.org/files/66f/7a4/fbc/66f7a4fbc44a42b585802373f7c9ddea.jpg"><br><br>  As you can see, the boundaries of objects are clearly preserved.  Conversion occurs only in color space.  In the first case, the style of fire is transferred to the perfume bottle, and in the second case, the texture of the apples changes according to the pattern. <br><br><h1>  Semantic segmentation </h1><br>  The second achievement of the authors of the program is to solve the problem of transferring the style between inappropriate objects in the original photo and the style sample.  This is done through semantic segmentation.  Therefore, the styles of houses are transferred only between houses, and the style of the sky only affects the sky.  In many cases, semantic segmentation works very effectively, if the sample style contains the same semantic objects as the original image. <br><br>  The above two approaches provided extremely realistic photo conversion. <br><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/3b6/c6d/59d/3b6c6d59db9a01013a8da0bddacb5281.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/927/a31/165/927a311653b63ee7d7d0628284ebed5c.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/09c/b5e/22d/09cb5e22d65ee6bc2f53bc5467777cd8.png"><br><br>  Here are some more examples. <br><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/37d/5a1/1de/37d5a11def78044bea12cc93bbca0310.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/0b9/ec2/48e/0b9ec248e0ac0452575f037ce989d64c.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/ba5/e16/d16/ba5e16d16172fce57095424abec877b9.png"><br><br><hr><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/aa5/0a5/d55/aa50a5d55dd91398da8bd12f00f3f7c1.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/99e/2f7/73e/99e2f773e31fe1f91178c519ad7f5566.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/9b4/dfc/310/9b4dfc3102114c8e9101c163f05c5a7f.png"><br><br><hr><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/299/788/54f/29978854fd4ceb0f2331cd68b0c0c9dc.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/d3a/f04/d61/d3af04d6176d08562e7c278c03cb6cc5.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/157/05f/ce3/15705fce3934348e0e190092271734e5.png"><br><br><hr><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/d57/993/806/d57993806db328815a256902a3caa90d.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/9fd/df4/7bf/9fddf47bfc85d97ebb3d9c6ae5df7ec4.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/333/6b2/af4/3336b2af4ab3f3ebb588a5555b66996f.png"><br><br><hr><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/69d/d57/ebf/69dd57ebfb7c7c6640cb9cde0006c2ed.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/158/a68/333/158a68333f6508c2bef06dd96122edc0.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/eed/ad1/a57/eedad1a5774194c932c716a2d2cf440c.png"><br><br><hr><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/448/654/517/448654517e6d96f2bf179eae778d9a09.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/0ac/854/8f1/0ac8548f11eaae85312e89483f1089ed.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/b26/19f/aa5/b2619faa5285ab4bfa944ed33c090198.png"><br><br><hr><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/f2f/923/cf2/f2f923cf2d0113868a5b5fc5307663e3.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/0ae/b54/a69/0aeb54a693c17fc75944b373c5725c94.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/661/149/b8d/661149b8dc53d202bbf9891fd8d8b5e5.png"><br><br><hr><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/c8c/8ba/5c7/c8c8ba5c72de466dad90da3f15f738e9.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/be3/0d8/58a/be30d858a0ca21d2b679699d36d6d61e.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/84f/f50/d2e/84ff50d2e9e44cbc393be7c1f9944754.png"><br><br><hr><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/0d7/f82/43c/0d7f8243c6d43b07827ddfbdfe9cc7cd.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/ca7/1af/271/ca71af2714e95ac1eddd738ca068ba02.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/4dc/0a1/e75/4dc0a1e750d984a40a78f64b49be616d.png"><br><br><hr><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/3c1/45c/373/3c145c373279ad55191b9c88c11a0636.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/f82/271/ecb/f82271ecb419238381b1e27573ca6d0b.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/0a2/47c/4f4/0a247c4f4847f36d9251a14f0ae91cfe.png"><br><br><hr><br>  Original <br><img src="https://habrastorage.org/getpro/geektimes/post_images/6d7/ace/90d/6d7ace90d2e0a7a7d1de176e3783066b.png"><br><br>  Style sample <br><img src="https://habrastorage.org/getpro/geektimes/post_images/c61/49d/7f0/c6149d7f0a5f2a8cc74ce5eb6c38d993.png"><br><br>  Final image <br><img src="https://habrastorage.org/getpro/geektimes/post_images/4c3/171/591/4c31715919fe75f895b37daf6cebc32a.png"><br>  The quality of the work of such an algorithm can only be determined from the results of a survey of users who evaluate photorealism and the accuracy of the transfer of style.  Such a survey would be conducted.  He showed that the level of photo-realism Deep Photo Style Transfer is much higher than the previously presented development of Neural Style and CNNMRF, but inferior to <a href="http://citeseerx.ist.psu.edu/viewdoc/download%3Fdoi%3D10.1.1.524.6154%26rep%3Drep1%26type%3Dpdf">the Piti color transfer system</a> .  According to the reliability of the transfer style Deep Photo Style Transfer is much better than other methods. <br><br><img src="https://habrastorage.org/files/f64/f52/cbd/f64f52cbdb5649b9b410920752af6fac.png"><br><br>  The authors of the scientific work intend to continue research in order to overcome the existing limitations of image segmentation.  They also consider promising the direction of real-time photo processing with a pre-trained neural network. </div><p>Source: <a href="https://habr.com/ru/post/402665/">https://habr.com/ru/post/402665/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../402655/index.html">Ilon Musk creates Neuralink company to develop neural interfaces</a></li>
<li><a href="../402657/index.html">MTS abolishes tariffs with unlimited mobile Internet</a></li>
<li><a href="../402659/index.html">The book "The Science of Resurrection species. How to clone mammoth "</a></li>
<li><a href="../402661/index.html">Spinach leaves have grown human heart muscle cells</a></li>
<li><a href="../402663/index.html">How to swim in a superfluid fluid</a></li>
<li><a href="../402667/index.html">7 major experiments that have not yet found the desired</a></li>
<li><a href="../402669/index.html">Keratoectasia (keratoconus, "bulging cornea"): what is it and what to do with it</a></li>
<li><a href="../402671/index.html">Attempt to return the former or PDA from the flea market. Part 2, the saga of the HP iPAQ rx3715 PDA</a></li>
<li><a href="../402675/index.html">Harvard CS50 course in Russian: lecture twenty-one</a></li>
<li><a href="../402677/index.html">Course Overview - Building robots and other devices on the Arduino (week 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>