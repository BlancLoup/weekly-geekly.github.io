<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Static Analysis in the Video Game Industry: Top 10 Software Errors</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you are developing software in the video game industry and are wondering what else can be done to improve the quality of the product \ simplify the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Static Analysis in the Video Game Industry: Top 10 Software Errors</h1><div class="post__text post__text-html js-mediator-article"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/085/580/22e/08558022e4f82d742e459abf45b100b2.png"></div><br>  If you are developing software in the video game industry and are wondering what else can be done to improve the quality of the product \ simplify the development process, while not using static analysis - it's time to start.  Do you doubt?  Well, I will try to convince you of this.  If it is just interesting for you to look at the mistakes made by the developers in the video game industry, then, again, you got to the address - the most interesting ones were selected for you. <br><a name="habracut"></a><br><h2>  Why you should use static analysis </h2><br>  Despite the fact that the development of video games involves a large number of stages, programming remains one of the main ones.  Even if you do not write thousands of lines of code, one way or another you have to use various tools, the quality of which depends including the convenience of work and the final result.  If you are a developer of such tools (for example, game engines), then everything should be clear to you. <br><br>  Why is static analysis useful in software development in general? <br><br>  There are several main reasons: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  The cost and complexity of correcting an error increases with time.  One of the main advantages of static analysis is the detection of errors in the early stages of development (you can find an error at the time of writing the code).  Therefore, using a static analyzer, you can simplify the life of yourself and your colleagues by detecting and correcting many errors before they become the cause of a headache. </li><li>  Using static analysis, you can identify many different error patterns (copy-paste, typos, misuse of functions, etc.). </li><li>  As a rule, static analysis is good at identifying problems that are poorly identified using dynamic analysis.  However, the converse is also true. </li><li>  Negative moments of use (for example, false positives) are usually 'smoothed out' by the teams that develop serious static analyzers due to various warning suppression functions (single, by pattern, etc.), disabling irrelevant diagnostics, excluding files and directories from the analysis .  This allows you to significantly reduce the percentage of 'noise' by properly configuring the analyzer.  My colleague, Andrey Karpov, demonstrated in an <a href="https://www.viva64.com/ru/b/0523/">article about testing EFL Core Libraries</a> that if the analyzer is configured, the number of false positives will be only 10-15%. </li></ul><br>  But anyway, this is all theory, and you are probably interested in more practical examples.  Well, they are presented below. <br><br><h3>  Static analysis in the Unreal Engine </h3><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/62b/06e/aca/62b06eaca16b544bd66844fc1ad54ce9.png"></div><br>  If you have read up to this point, it‚Äôs not worth telling you what the Unreal Engine is or what kind of company it is - Epic Games - and if these guys do not have authority, write me who then uses it. <br><br>  The PVS-Studio team collaborated several times with the Epic Games team, helping them implement and use static analysis in the Unreal Engine project and correct errors / false positives detected by the analyzer.  I am sure it was an interesting and useful experience for both parties. <br><br>  One of the consequences was the addition of a special flag to the Unreal Engine, which made it possible to conveniently integrate static analysis into the Unreal Engine build system of projects. <br><br>  The key idea is simple - the guys care about the quality of their code and use different approaches for this, one of which was the introduction of static analysis. <br><br><h3>  John Carmack on static analysis </h3><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f9a/777/99c/f9a77799ca0b8bec1119ba800bd0d770.png"></div><br>  John Carmack, one of the most well-known developers in the video game industry, at one time recognized the active use of static analysis techniques as one of his main achievements as a programmer: " <i>The most important thing I have been doing in recent years is to aggressively pursue static code analysis.</i> "The next time someone you know says that static analysis is a tool for newbies, show him this quote.  Carmack described his acquaintance with static analysis in a <a href="https://www.gamasutra.com/view/news/128836/InDepth_Static_Code_Analysis.php">relevant article</a> , which I strongly recommend to read: both for motivation and for general development. <br><br><h3>  Errors found using static analysis in games and game engines </h3><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/127/c5a/68b/127c5a68b6cc1aa927763c1588523233.png"></div><br>  Perhaps one of the best ways to show the benefits of static analysis is to demonstrate its capabilities in practice.  This is done, for example, by the PVS-Studio team, checking open source projects. <br><br>  Everybody wins: <br><br><ul><li>  Project developers are notified of errors and can correct them.  Ideally, of course, the approach should be different than correcting errors in the log \ article - you should check the project yourself with the analyzer and examine the issued warnings.  This is important, if only for the reason that the authors of the articles may lose sight of something or inadvertently focus on errors that are not critical for the project. </li><li>  Analyzer developers can improve the tool according to the results of the analysis, and also demonstrate the analyzer's ability to detect errors. </li><li>  Readers see which error patterns are allowed, gain experience, get acquainted with the method of static analysis. </li></ul><br>  In general - why not proof of effectiveness and benefits? <br><br><h3>  Commands that already use static analysis </h3><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/802/674/d7c/802674d7c39c6bfed3b9da532557856a.png"></div><br>  While someone is pondering whether to embed static analysis in their development process, some teams are already using it and gaining it!  For example, Rocksteady, Epic Games, ZeniMax Media, Oculus, Codemasters, Wargaming and others ( <a href="https://bit.ly/2HYln0t">source</a> ). <br><br><h2>  Top 10 bugs from software code in the video game industry </h2><br>  Immediately it is worth making a reservation that this is not some kind of mega-global 'top', but those errors found by the PVS-Studio analyzer in games and game engines that seemed to me the most interesting. <br><br>  As usual, for more interest, I suggest you first try to find the error in the above code snippet, and only then read the analyzer warning and problem description. <br><br>  <b>Tenth place</b> <br><br>  Source: <a href="https://www.viva64.com/ru/b/0405/">Looking for anomalies in the X-Ray Engine</a> <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1fa/eff/bb2/1faeffbb2e37ea948cabdd1fc65cc9f0.png"></div><br><br>  On the tenth place is the error from the X-Ray Engine game engine used in STALKER games. Those who played the games from this series will surely remember many funny (and not so) bugs that occurred during the game process.  This is especially true of STALKER: Clear Sky, in which it was impossible to play without patches at all (I still remember the bug that 'killed' all the save).  As the analysis of the game engine showed, there are really bugs in the code, and there are quite a lot of them.  Below is one of them. <br><br><pre><code class="cpp hljs">BOOL CActor::net_Spawn(CSE_Abstract* DC) { .... m_States.empty(); .... }</code> </pre> <br>  <b>PVS-Studio</b> <a href="https://www.viva64.com/ru/d/0119/">warning</a> : <a href="https://www.viva64.com/ru/d/0119/">V530</a> The return value of the function is 'empty' is required to be utilized. <br><br>  The problem is simple - do not use the returned logical value of the <i>empty</i> method, indicating whether the container is empty.  Judging by the fact that in the above expression, there is nothing but the method call, we can assume that the developer wanted to empty the container, but made a mistake by calling the <i>empty</i> method instead of <i>clear</i> . <br><br>  Some may say that this is too simple a mistake for the Top 10.  But this is her charm!  In spite of the fact that just like this, from the outside, the error seems quite simple and obvious, such 'simple' errors do not cease to appear (and be discovered) in various projects. <br><br>  <b>Ninth place</b> <br><br>  Source: <a href="https://www.viva64.com/ru/b/0417/">CryEngine V Welcome Check</a> <br><br>  We continue to reveal the theme of errors in game engines.  In ninth place - the code from CryEngine V. In games on this engine, I did not notice as many bugs as in games on the X-Ray Engine, but the ‚Äúshowdown‚Äù showed that the engine contains a lot of suspicious code fragments. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CCryDXGLDeviceContext:: OMGetBlendState(...., FLOAT BlendFactor[<span class="hljs-number"><span class="hljs-number">4</span></span>], ....) { CCryDXGLBlendState::ToInterface(ppBlendState, m_spBlendState); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((*ppBlendState) != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) (*ppBlendState)-&gt;AddRef(); BlendFactor[<span class="hljs-number"><span class="hljs-number">0</span></span>] = m_auBlendFactor[<span class="hljs-number"><span class="hljs-number">0</span></span>]; BlendFactor[<span class="hljs-number"><span class="hljs-number">1</span></span>] = m_auBlendFactor[<span class="hljs-number"><span class="hljs-number">1</span></span>]; BlendFactor[<span class="hljs-number"><span class="hljs-number">2</span></span>] = m_auBlendFactor[<span class="hljs-number"><span class="hljs-number">2</span></span>]; BlendFactor[<span class="hljs-number"><span class="hljs-number">2</span></span>] = m_auBlendFactor[<span class="hljs-number"><span class="hljs-number">3</span></span>]; *pSampleMask = m_uSampleMask; }</code> </pre> <br>  <b>PVS-Studio</b> <a href="https://www.viva64.com/ru/d/0108/">warning</a> : <a href="https://www.viva64.com/ru/d/0108/">V519</a> The 'BlendFactor [2]' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake. <br><br>  As repeatedly mentioned in our articles, no one is immune from typos.  In practice, it has also been repeatedly confirmed that static analysis copes with the detection of copy-paste and typos.  <i>They copied the</i> values ‚Äã‚Äãfrom the <i>m_auBlendFactor</i> array to <i>BlendFactor</i> , but were accidentally sealed and wrote <i>BlendFactor [2]</i> twice.  Because of this confusion, the value from <i>m_auBlendFactor [3</i> <i>]</i> will be recorded in <i>BlendFactor [2]</i> , and the value will not change in <i>BlendFactor [3]</i> . <br><br>  <b>Eighth place</b> <br><br>  Source: <a href="https://www.viva64.com/ru/b/0376/">Unicorn in Space: Checking the source code of 'Space Engineers'</a> <br><br>  Let's change the course a bit and move on from C ++ to C #.  Before us is the code from the Space Engineers project, the sandbox games about building and maintaining space structures.  I myself did not play the game, but as one of the commentators of the article said: " <i>I am not very surprised by the results :)</i> ".  Well, interesting mistakes were really found, below - two of them. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cueName)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_arcade.Hash == MyStringHash.NullOrEmpty &amp;&amp; m_realistic.Hash == MyStringHash.NullOrEmpty) MySandboxGame.Log.WriteLine(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Format( <span class="hljs-string"><span class="hljs-string">"Could not find any sound for '{0}'"</span></span>, cueName)); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_arcade.IsNull) <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Format( <span class="hljs-string"><span class="hljs-string">"Could not find arcade sound for '{0}'"</span></span>, cueName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_realistic.IsNull) <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Format( <span class="hljs-string"><span class="hljs-string">"Could not find realistic sound for '{0}'"</span></span>, cueName); } }</code> </pre> <br>  <b>PVS-Studio warnings</b> : <ul><li>  <a href="https://www.viva64.com/ru/d/0406/">V3010</a> </li><li>  <a href="https://www.viva64.com/ru/d/0406/">V3010</a> </li></ul><br>  As you can see, errors of ignoring return values ‚Äã‚Äãof methods are found not only in C ++ code, but also in C #.  The <i>String.Format</i> method <i>compiles the</i> resulting string based on the format string and the objects to be formatted, and then returns the result as the return value of the method.  In the code above in the <i>else-</i> branch there are two calls to <i>string.Format</i> , but their return values ‚Äã‚Äãare not used.  Most likely, it was necessary to log these messages in the same way as it was done in the <i>then-</i> branch of the <i>if statement</i> , using the <i>MySandboxGame.Log.WriteLine</i> method. <br><br>  <b>Seventh place</b> <br><br>  Source: <a href="https://www.viva64.com/ru/b/0130/">Check Quake III Arena GPL project</a> <br><br>  Did I mention that static analysis well detects typos?  The example below is another confirmation of this. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Terrain_AddMovePoint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... x = ( v[ <span class="hljs-number"><span class="hljs-number">0</span></span> ] - p-&gt;origin[ <span class="hljs-number"><span class="hljs-number">0</span></span> ] ) / p-&gt;scale_x; y = ( v[ <span class="hljs-number"><span class="hljs-number">1</span></span> ] - p-&gt;origin[ <span class="hljs-number"><span class="hljs-number">1</span></span> ] ) / p-&gt;scale_x; .... }</code> </pre> <br>  <b>PVS-Studio</b> <a href="https://www.viva64.com/ru/w/v537/">warning</a> : <a href="https://www.viva64.com/ru/w/v537/">V537</a> Consider reviewing the correctness of the 'scale_x' item's usage. <br><br>  The <i>x</i> and <i>y</i> variables are written, but in both assignments, the value expression expression <i>p-&gt; scale_x is</i> used in the value calculation expression.  It looks very suspicious and it seems that in the second case it is necessary to replace the expression <i>p-&gt; scale_x</i> with <i>p-&gt; scale_y</i> . <br><br>  <b>Sixth place</b> <br><br>  Source: <a href="https://www.viva64.com/ru/b/0568/">Checking the source C # code Unity</a> <br><br>  Unity Technologies recently opened the source code of its own game engine - Unity.  We could not pass by such an event and in the analysis found a lot of interesting places.  Below is one of them. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsValid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> base.IsValid() &amp;&amp; (pageSize &gt;= <span class="hljs-number"><span class="hljs-number">1</span></span> || pageSize &lt;= <span class="hljs-number"><span class="hljs-number">1000</span></span>) &amp;&amp; totalFilters &lt;= <span class="hljs-number"><span class="hljs-number">10</span></span>; }</code> </pre> <br>  <b>PVS-Studio</b> <a href="https://www.viva64.com/ru/w/V3063/">warning</a> : <a href="https://www.viva64.com/ru/w/V3063/">V3063</a> A part of conditional expression is always true if it is evaluated: pageSize &lt;= 1000. <br><br>  We have an invalid range check for <i>pageSize</i> .  Most likely, it was planned to check that the <i>pageSize</i> value lies within [1;  1000].  However, an annoying typo was made: the programmer accidentally wrote '||' instead of the '&amp;&amp;' operator.  It turns out that the subexpression actually does not check anything. <br><br>  <b>Fifth place</b> <br><br>  Source: We <a href="https://www.viva64.com/ru/b/0423/">analyze errors in open components of Unity3D</a> <br><br>  In the next place there is an interesting error from the components of Unity3D.  The source article was written more than a year before the source code of the Unity engine was discovered.  However, even then it was possible to find something interesting. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> CrawledMemorySnapshot </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Unpack</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... var result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CrawledMemorySnapshot { .... staticFields = packedSnapshot.typeDescriptions .Where(t =&gt; t.staticFieldBytes != null &amp; t.staticFieldBytes.Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) .Select(t =&gt; UnpackStaticFields(t)) .ToArray() .... }; .... }</code> </pre> <br>  <b>PVS-Studio</b> <a href="https://www.viva64.com/ru/d/0480/">warning</a> : <a href="https://www.viva64.com/ru/d/0480/">V3080</a> Possible null dereference.  Consider inspecting 't.staticFieldBytes'. <br><br>  Notice the lambda expression passed as an argument to the <i>Where</i> method.  Judging by the code, the <i>typeDescriptions</i> collection can contain elements whose <i>staticFieldBytes</i> member can be <i>null</i> .  That is why, before <i>accessing the</i> <i>Length</i> property, we check that <i>staticFieldBytes! = Null</i> .  That's just when the operators were confused, and instead of '&amp;&amp;', '&amp;' is used.  This means that regardless of the result of evaluating the left expression ( <i>true</i> \ <i>false</i> ), the right expression will also be calculated, which is why, if <i>staticFieldBytes == null</i> , when accessing the <i>Length</i> property, an exception of type <i>NullReferenceException</i> will be <i>thrown</i> .  Using '&amp;&amp;' would not have <i>caused</i> this situation, since, if <i>staticFieldBytes == null</i> , the right side of the expression would not be evaluated. <br><br>  Despite the fact that Unity is the only engine that has fallen into this ‚ÄúTop-10‚Äù twice, this does not prevent enthusiasts from creating great games on it.  Including - about the fight against 'bugs'. <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ba5/5d1/012/ba55d101292addbfb672af5ecf4eacdd.png"></div><br>  <b>Fourth place</b> <br><br>  Source: <a href="https://www.viva64.com/ru/b/0321/">Godot Source Code Analysis</a> <br><br>  Sometimes there are interesting errors associated with missing keywords.  Example: an exception object is created, but not used at all, since the developer forgets to specify the <i>throw</i> keyword.  There are such <a href="https://www.viva64.com/ru/examples/v3006/">errors in C # projects</a> and in <a href="https://www.viva64.com/ru/examples/v596/">C ++ projects</a> .  The missing keyword met in the Godot Engine game engine. <br><br><pre> <code class="cpp hljs">Variant Variant::get(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Variant&amp; p_index, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> *r_valid) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ie.type == InputEvent::ACTION) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (str ==<span class="hljs-string"><span class="hljs-string">"action"</span></span>) { valid=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ie.action.action; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (str == <span class="hljs-string"><span class="hljs-string">"pressed"</span></span>) { valid=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; ie.action.pressed; } } .... }</code> </pre> <br>  <b>PVS-Studio</b> <a href="https://www.viva64.com/ru/d/0222/">warning</a> : <a href="https://www.viva64.com/ru/d/0222/">V607</a> Ownerless expression 'ie.action.pressed'. <br><br>  In the above code snippet, you can see that, depending on the values, <i>ie.type</i> and <i>str</i> wanted to return a specific value of type <i>Variant</i> .  Only once the return expression was written normally - <i>return ie.action.action;</i>  , and the second time forgot the operator <i>return</i> , because of what the desired value will not be returned, and the method will continue its execution. <br><br>  <b>Third place</b> <br><br>  Source: <a href="https://www.viva64.com/ru/b/0120/">PVS-Studio: analyze the Doom 3 code</a> <br><br>  So we got to the "Top 3".  It is closed by a small fragment of the source code from the Doom 3 game. As I said above, the fact that from the side the error looks simple and may be incomprehensible, how can you make such a mistake yet does not mean anything - in practice, what types of errors just cannot be met ... <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Sys_GetCurrentMemoryStatus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( sysMemoryStats_t &amp;stats )</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>( &amp;statex, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>( statex ), <span class="hljs-number"><span class="hljs-number">0</span></span> ); .... }</code> </pre> <br>  <b>PVS-Studio</b> <a href="https://www.viva64.com/ru/w/v575/">warning</a> : <a href="https://www.viva64.com/ru/w/v575/">V575</a> The 'memset' function processes '0' elements.  Inspect the third argument. <br><br>  To better understand the problem, it is worth remembering the <i>memset</i> function signature: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">* dest, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> count)</span></span></span></span>;</code> </pre> <br>  Comparing the signature of the function with its call, you can see that the last two arguments are mixed up in places.  As a result, any block of memory that was required to be reset will remain unchanged. <br><br>  <b>Second place</b> <br><br>  The second place was taken by the error found in the C # code of the Xenko game engine. <br><br>  Source: <a href="https://www.viva64.com/ru/b/0379/">We are looking for errors in the game engine Xenko</a> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> ImageDescription </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateDescription</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TextureDimension dimension, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> width, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> depth, ....)</span></span></span><span class="hljs-function"> </span></span>{ .... } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Image </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">New3D</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> width, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> depth, ....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image(CreateDescription(TextureDimension.Texture3D, width, width, depth, mipMapCount, format, <span class="hljs-number"><span class="hljs-number">1</span></span>), dataPointer, <span class="hljs-number"><span class="hljs-number">0</span></span>, null, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); }</code> </pre> <br>  <b>PVS-Studio</b> <a href="https://www.viva64.com/ru/d/0470/">warning</a> : <a href="https://www.viva64.com/ru/d/0470/">V3065</a> Parameter 'height' is not utilized inside method's body. <br><br>  The error was made by passing arguments to the <i>CreateDescription method</i> .  If you look at its signature, you can see that the second, third, and fourth parameters are named <i>width</i> , <i>height,</i> and <i>depth,</i> respectively.  When called, the arguments are passed in <i>width</i> , <i>width</i> and <i>depth</i> .  Suspicious?  So the analyzer also found this place suspicious enough to issue a warning. <br><br>  <b>First place</b> <br><br>  Source: The <a href="https://www.viva64.com/ru/b/0249/">long-awaited test of Unreal Engine 4</a> <br><br>  Headed by our today's "Top 10" error from the game engine Unreal Engine.  As in the case of the article ‚Äú <a href="https://www.viva64.com/ru/b/0565/">Top 10 errors in C ++ projects for 2017</a> ‚Äù, seeing the error below, I immediately understood who should lead the list of the most interesting errors. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VertInfluencedByActiveBone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( FParticleEmitterInstance* Owner, USkeletalMeshComponent* InSkelMeshComponent, int32 InVertexIndex, int32* OutBoneIndex = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">NULL</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> UParticleModuleLocationSkelVertSurface::Spawn(....) { .... int32 BoneIndex1, BoneIndex2, BoneIndex3; BoneIndex1 = BoneIndex2 = BoneIndex3 = INDEX_NONE; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!VertInfluencedByActiveBone( Owner, SourceComponent, VertIndex[<span class="hljs-number"><span class="hljs-number">0</span></span>], &amp;BoneIndex1) &amp;&amp; !VertInfluencedByActiveBone( Owner, SourceComponent, VertIndex[<span class="hljs-number"><span class="hljs-number">1</span></span>], &amp;BoneIndex2) &amp;&amp; !VertInfluencedByActiveBone( Owner, SourceComponent, VertIndex[<span class="hljs-number"><span class="hljs-number">2</span></span>]) &amp;BoneIndex3) { .... }</code> </pre> <br>  <b>PVS-Studio</b> <a href="https://www.viva64.com/ru/w/v564/">warning</a> : <a href="https://www.viva64.com/ru/w/v564/">V564</a> The '&amp;' operator is applied to bool type value.  You've probably forgotten to include the operator. <br><br>  I would not be surprised if, by comparing the analyzer warning and the above code, you asked the question: ‚ÄúWhere is the use of '&amp;' instead of '&amp;&amp;'?‚Äù.  But, if we note that the last parameter of the <i>VertInfluencedByActiveBone</i> function has a default value, and to simplify the conditional expression of the <i>if</i> operator, everything will become more clear: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!foo(....) &amp;&amp; !foo(....) &amp;&amp; !foo(....) &amp; arg)</code> </pre> <br>  Pay particular attention to the last subexpression: <br><br><pre> <code class="cpp hljs">!VertInfluencedByActiveBone(Owner, SourceComponent, VertIndex[<span class="hljs-number"><span class="hljs-number">2</span></span>]) &amp;BoneIndex3</code> </pre> <br>  The parameter with the default value played a cruel joke - if there were no default values, this code would simply not compile.  But since it is, everything compiles successfully, and the error is no less successfully masked.  This analyzer noticed this suspicious place - an infix operation '&amp;', in which the left operand is of type <i>bool</i> and the right operand is of type <i>bool</i> . <br><br><h2>  Conclusion </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/as/gr/lv/asgrlvze0tx6cn3ifugleggi9oc.png"></div><br>  I hope I managed to show that static analysis will be useful in developing games and game engines and is another answer to the question of improving the quality of the code (and the final product, as a result).  If you are developing in the video game industry, then you simply have to tell your colleagues about static analysis and show this article.  Thinking about where to start?  Start with <a href="https://www.viva64.com/ru/pvs-studio-download/">PVS-Studio</a> . <br><br><p> <a href="https://www.viva64.com/en/b/0570/"><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br>  If you want to share this article with an English-speaking audience, then please use the link to the translation: Sergey Vasiliev.  <a href="https://www.viva64.com/en/b/0570/">Static Analysis in Video Game Development: Top 10 Software Bugs</a> <br><br><div class="spoiler">  <b class="spoiler_title">Read the article and have a question?</b> <div class="spoiler_text">  Often our articles are asked the same questions.  We collected answers to them here: <a href="https://www.viva64.com/ru/a/0085/">Answers to questions from readers of articles about PVS-Studio, version 2015</a> .  Please review the list. </div></div></div><p>Source: <a href="https://habr.com/ru/post/354808/">https://habr.com/ru/post/354808/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354798/index.html">Management Tantrum</a></li>
<li><a href="../354800/index.html">Feature perception filters from your Product Backlog</a></li>
<li><a href="../354802/index.html">Understanding how disk space is used in Linux</a></li>
<li><a href="../354804/index.html">If online stores were chairs</a></li>
<li><a href="../354806/index.html">How to make friends React and D3</a></li>
<li><a href="../354810/index.html">The point of testing is in the process, not in the remaining artifacts. Michael Bolton and Rapid Software Testing</a></li>
<li><a href="../354812/index.html">Fintech Digest: online banking security, 70% of bitcoins extracted, business will lose about $ 2 billion due to RKN blocking</a></li>
<li><a href="../354814/index.html">Domain fronting: what is it?</a></li>
<li><a href="../354816/index.html">Blockchain When should it be applied?</a></li>
<li><a href="../354818/index.html">Synchronous system interface interaction with peripheral blocks in the volume of the crystal VLSI or FPGA. STI 1.0</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>