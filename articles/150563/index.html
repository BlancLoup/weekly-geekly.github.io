<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Logging: Tracing Recommendations</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, I want to share my thoughts / observations / recommendations regarding the implementation of such an important task in software devel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Logging: Tracing Recommendations</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage2/46f/ccd/1af/46fccd1af7ce0fd0a173d2701a5aa318.png">  In this article, I want to share my thoughts / observations / recommendations regarding the implementation of such an important task in software development as logging.  On the Internet there are many articles describing tools for logging, but very little information about which events, and what information, should be recorded in the program operation log. <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  Very often there is the problem of diagnosing defects in a test or production environment where there are no development and debugging tools.  And the only way to understand what the error is is to add lines of code with debugging information and reinstall the application, if such lines have not been added before.  Is it possible to immediately write code so that the information that the application logs would be enough to diagnose the problem? <br>  In the article I will not deal with such issues as logging tools at all.  But in any case, you need to understand that such tools exist and allow you to filter the data recorded in the protocol and customize the record of the protocol in various sources. <br>  The main objective of the article is to give a presentation to the developers on how the logging is carried out, and to give recommendations on where to insert lines of code in the program for logging.  In this article, we will mainly talk about tracing. <habracut><br><h4>  Logging </h4><br><img align="left" src="https://habrastorage.org/storage2/356/de0/bfd/356de0bfdb566102001398958a7671b9.png"><br>  I consider logging much wider than just writing to a log file.  For me, logging is a set of tools and methods that solve such tasks: <br><ul><li>  Be sure that the system is working and working properly. </li><li>  Understand why the system and its data are in their current state </li><li>  Have the ability to quickly find fault </li><li>  Learn how to improve the system. </li></ul><br><br><h4>  Logging Approaches </h4><br>  The above objectives can be specified by highlighting the ‚Äúusers‚Äù of the logging results and the tasks of these ‚Äúusers‚Äù.  Then you can select the tools and methods by which these tasks can be implemented.  So, I see 4 main categories of "users": <br><ul><li>  Developer - a specialist who develops and improves the application. </li><li>  Test engineer - a specialist who is responsible for the quality of the application, the detection and localization of defects during the development period </li><li>  The system administrator is a support service specialist who is responsible for the smooth running of the application in a working environment and the timely detection of errors. </li><li>  The owner of the application is a business user who knows and understands the functionality of the application as a whole and, in fact, is the owner of the application data;  the employee for whom this application was developed </li></ul><br>  The table below for the types of users are the most frequently used methods and means for solving their problems. <br><table border="1"><tbody><tr><td>  <b>Lecture hall</b> </td><td>  <b>Task</b> </td><td>  <b>Means and Methods</b> </td></tr><tr><td>  Developer </td><td><ul><li>  Find the location of the problems and fix them </li><li>  Run optimization </li></ul></td><td><ul><li>  Tracing </li><li>  Performance counters </li><li>  State of objects / processes </li></ul></td></tr><tr><td>  Test engineer </td><td><ul><li>  Be sure the system is working properly. </li><li>  Defect detection </li><li>  As accurately as possible to determine the location and cause of the found defects </li></ul></td><td><ul><li>  The event log </li><li>  Audit trail </li><li>  State of objects / processes </li></ul></td></tr><tr><td>  System Administrator </td><td><ul><li>  Be sure the system is working. </li><li>  If there are errors to understand why (for whose fault, where to fix) </li><li>  If it is slow, understand why </li></ul></td><td><ul><li>  The event log </li><li>  Performance counters </li><li>  State of objects / processes </li></ul></td></tr><tr><td>  Application owner </td><td><ul><li>  Be sure that the system works exactly as it should. </li></ul></td><td><ul><li>  Audit trail </li><li>  State of objects / processes </li></ul></td></tr></tbody></table><br>  The means and methods indicated in the table are briefly described below. <br><ul><li>  Tracing is a tool that is usually called a ‚Äúlog‚Äù, in fact, a repository where detailed information is written about the progress of the program (sequentially, in the order in which events occur).  This is usually a text file or database table.  This tool is needed by the developer, test engineer or support service specialist for a detailed analysis of what is happening in the application. </li><li>  The event log is a tool that shows events in an application from an administrator‚Äôs point of view.  Those.  Events where the system administrator can tell whether the application is running or not.  If we talk about software development for Windows ‚Äî this is most often Windows Event Log or its own application logs.  I‚Äôm in favor of not mixing trace repositories and event logs. </li><li>  Audit log - a tool that allows the application user to understand who performed what actions (or tried to perform) in the system </li><li>  Performance counters are a system administrator tool that helps detect a bottleneck in system performance.  An example of such a tool might be the Performance Monitor built into the Windows operating system.  For other OS there are similar tools. </li><li>  The state of objects / processes is a tool that helps to understand what state (or what stage) the objects or processes in the application are currently in, and how they got into this state or the processing stage. <br>  For example: Imagine an application that processes incoming email messages.  For each such message, you can select the state: received, processed, deleted.  In the "state log of objects / processes" in this case, you should record key information on the letter, the history of the change of states of the letter and the message during its processing.  Thus, important information on the processing of the letter from the "garbage" is completely separated. </li></ul><br>  The selection and implementation of logging methods is a very important task, the implementation of which determines the speed and quality of detection and correction of defects and quality of maintenance.  Therefore, at the planning and development stage, this task needs to be paid ahead of time and selected a sufficient set of logging methods. <br><h4>  Tracing </h4><br><img src="https://habrastorage.org/storage2/afd/183/7f1/afd1837f19b532417c3a2c69daeeb439.png"><br>  <font>* picture taken from <a href="http://lukas.zapletalovi.com/2012/01/lazy-logger-levels.html">Lazy logger levels</a></font> <br><br>  The task of tracing is to quickly find a defect in the operation of an application in any environment (developer environment, testing environment, working environment) by analyzing the operation of each step of the program.  Therefore, it is logical to enter into the tracing log information: <br><ul><li>  about all errors - processed and not processed </li><li>  startup parameters and loaded configuration </li><li>  as well as the events described below. </li></ul><br>  Tracing information is intended mainly for the developer and the test engineer (or in a working environment for the support staff of a very high level of qualification). <br>  A specific feature of tracing is that usually this functionality is not described in the requirements, and therefore it is usually difficult for developers at the beginning of a project to imagine what tracing information may be needed, and therefore it is difficult to understand what should be recorded when. <br>  The most important thing is to understand that tracing in the working environment is enabled only when necessary, i.e.  does not litter the event log.  For the developer and test environments, tracing is most often enabled all the time to monitor the correct operation of the application and debug. <br>  Logging tools usually provide an opportunity to record in the log, indicate exactly where this information will be recorded.  An important element is also the ability to specify in the configuration which entries will be logged and which not ‚Äî usually based on event categories and event levels. <br>  However, a big problem is that, despite the availability of tools, it is rare to find recommendations on how to use them correctly, namely: <br><ul><li>  What events need to be written to the trace log </li><li>  How to choose the level for the event </li><li>  How to choose event categories </li><li>  What information should be recorded when an event occurs </li></ul><br>  This will be discussed further in the article. <br><h5>  What events need to be included in the trace log </h5><br>  An important factor when choosing events to write to the trace log depends, in my opinion, on two factors: <br><ul><li>  Is unit tests used during development? <br>  The use of unit tests can significantly reduce the number of errors in the business logic of methods that do not interact with external systems (external to this layer of the application).  However, when code interacts with an external system (interaction of a business layer code with a database, interaction of business logic layers located on different computers, etc.), unit tests are not effective because the configuration of different layers may be different in different environments.  Based on this, it can be concluded that when using unit tests, it is logical to perform only the trace of interactions between layers and the trace of errors (since we believe that the logic of each layer separately is very well tested).  If there are no unit tests, you need to trace each branch of the program logic (method input, output, error occurring in the method, each branch of the conditional operator) </li><li>  Type of application. <br>  The table shows some types of applications and events for logging to the trace log (it is clear that there are other types of applications). </li></ul><br><table border="1"><tbody><tr><td>  <b>Application Type</b> </td><td>  <b>Logging features</b> </td></tr><tr><td>  Isolated desktop application (doesn't even save anything to disk) </td><td>  If such an application is well tested with modular tests, then there is no point in doing a trace. </td></tr><tr><td>  Application for entering data and receiving reports </td><td>  There is already interaction between the application and the repository, and therefore it is rational to log information about such interaction: requests, number of entries made and received, request processing speed, key parameters for generating reports </td></tr><tr><td>  Application Installer (patches, updates) </td><td>  In this case, the program closely interacts with the external system and therefore each step (attempt to perform and the result of the execution) must be entered into the trace log </td></tr><tr><td>  Integration bus </td><td>  Summary or complete (full data) information on incoming or outgoing data </td></tr><tr><td>  An application that can be greatly modified by the user (or extended by additional modules and plug-ins) </td><td>  All interactions with such external modules (input / output parameters) and the effect of the installed configuration parameters on the program operation </td></tr></tbody></table><br><h5>  What data should be entered in the trace log </h5><br>  In addition to the simple name (description) of the event, additional information is often needed to analyze the work.  The following table shows the data that would be useful to record.  It is clear that it is not always necessary to write events in such detail.  In addition, tracing tools typically allow some of the information below to be recorded automatically. <br><table border="1"><tbody><tr><td>  <b>Data</b> </td><td>  <b>Description</b> </td></tr><tr><td>  date and time </td><td>  Date and time of the event </td></tr><tr><td>  Server </td><td>  The server on which the event occurred (useful when analyzing logs collected from various servers) </td></tr><tr><td>  Process </td><td>  The name of the process where the event occurred.  This is necessary, for example, if different processes use shared libraries. </td></tr><tr><td>  Method </td><td>  Method name, possibly including class and library name </td></tr><tr><td>  Event Category </td><td>  The name of the layer or logic module </td></tr><tr><td>  Level </td><td>  Event detail level </td></tr><tr><td>  Title </td><td>  The name of the event (start or end of the method, error, change of the object state, etc.) </td></tr><tr><td>  Detailed information </td><td>  For example, detailed information about the error (and in case of a critical error there may be detailed information about the system), the value of the parameter (s), the name of the object or a description of the action on the object </td></tr><tr><td>  Account under which the process runs </td><td></td></tr><tr><td>  The user account that triggered the action. </td><td>  The user account that made the initial call that led to this event </td></tr><tr><td>  Stack </td><td>  The stack of method calls that led to this event.  May be useful for detailed event analysis. </td></tr><tr><td>  Process correlation number </td><td>  If the application is multi-user, then it is important to understand what kind of request (user) this or that event record refers to. </td></tr><tr><td>  Correlation number of the initiating process </td><td> If the application is distributed, then this number is used to map events on different servers (or processes).  For example, you can transfer a correlation number from the client to the server and save it when tracing.  In the future, you can match the call to the client application with an event on the server </td></tr></tbody></table><br><h5>  Trace levels </h5><br>  Levels are mainly used to filter events when writing to the log.  This is to prevent logging of data that is not needed in a given period of time. <br>  For example, a tool such as NLog provides 6 levels of events by default (from more detailed to less detailed): trace, debug, info, warn, error, fatal (see <a href="http://nlog-project.org/wiki/Tutorial">NLog</a> documentation for more details) <br>  Further, in the configuration, you can specify that, for example, in the work environment, write Error and Fatal events to the trace log (ignore all others), and when a problem occurs, change the configuration so that all events are recorded. <br>  The following table shows my recommendations for choosing event levels for tracing. <br><table border="1"><tbody><tr><td>  <b>Event</b> </td><td>  <b>Level</b> </td></tr><tr><td>  Loaded configuration / configuration change </td><td>  Info </td></tr><tr><td>  User action </td><td>  Info </td></tr><tr><td>  The beginning and end of each ‚Äúpublic‚Äù method (or a method that implements the logic according to the specification), input / output parameters, the result of the work of such a method </td><td>  Info </td></tr><tr><td>  In public methods, input / output parameters that are data sets </td><td>  Debug </td></tr><tr><td>  Logic (program branches) described by specification </td><td>  Info </td></tr><tr><td>  Start and end of other methods, input / output parameters, work result </td><td>  Trace </td></tr><tr><td>  The steps of the remaining methods </td><td>  Trace </td></tr><tr><td>  Access to external resources (for example: database, web-services) </td><td>  Info </td></tr><tr><td>  Detailed information on requests (commands) for accessing external resources and the result obtained </td><td>  Debug </td></tr><tr><td>  Unexpected exceptions (not critical) </td><td>  Error </td></tr><tr><td>  The exception described in the specification </td><td>  Warn / error </td></tr><tr><td>  Processed exceptions </td><td>  Warn / info / debug </td></tr><tr><td>  Critical exception (processed or not processed) </td><td>  Fatal </td></tr></tbody></table><br><h5>  Select event categories </h5><br>  The second important parameter by which you can configure the filtering of event logging is the categories of events.  These categories should be selected by the developer himself (i.e., the tools do not provide default categories) <br>  I recommend sticking to such recommendations - for each logical level to make a separate category.  For example: interface level (UIControls), business logic level (BusinessLogic), data access level (DAL), search module (Search), configuration software (ConfigManager), and so on. <br>  Further, if you have separate components inside the layer, then you can select individual subcategories to trace them, separating them from the main category with a point. <br>  For example, the visual component for displaying the tag cloud (which is located at the interface level) is UIControls.TagsControl. <br>  Thus, if there is a problem with a component, on the one hand, you can always determine which component has created an event from the log, and on the other, it is more flexible to set up filtering of the event log entry only for the selected component. <br><h4>  Conclusion </h4><br>  Logging is an important function in any application and requires careful analysis and design.  Despite the fact that tracing is usually not described in the requirements, its correct use can greatly speed up the process of detecting and fixing defects on the test and production environment. <br>  These calculations are my practice and observations, and, accordingly, you may have your own experience and your own method of using logging (and tracing in particular).  I am pleased to hear critical feedback and comments to improve the recommendations. <br><h4>  What else to read on tracing </h4><br><ul><li>  Methods for debugging applications: Logging <a href="http://dtf.ru/articles/read.php%3Fid%3D36547">http://dtf.ru/articles/read.php?id=36547</a> </li><li>  What should be the correct log file - <a href="http://www.codeart.ru/2011/02/23/kakim-dolzhen-byt-pravilnyj-log-fajl/">http://www.codeart.ru/2011/02/23/kakim-dolzhen-byt-pravilnyj-log-fajl/</a> </li><li>  What Goes Into A Trace Log?  - <a href="http://www.informit.com/guides/content.aspx%3Fg%3Ddotnet%26amp%3BseqNum%3D228">http://www.informit.com/guides/content.aspx?g=dotnet&amp;seqNum=228</a> </li><li>  Tracing (software) - <a href="http://en.wikipedia.org/wiki/Tracing_(software)">http://en.wikipedia.org/wiki/Tracing_(software)</a> </li><li>  The Art of Logging - <a href="http://www.codeproject.com/Articles/42354/The-Art-of-Logging">http://www.codeproject.com/Articles/42354/The-Art-of-Logging</a> </li><li>  Correct logging in the Microsoft .NET Framework <a href="http://habrahabr.ru/post/98638/">http://habrahabr.ru/post/98638/</a> </li></ul></habracut></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/150563/">https://habr.com/ru/post/150563/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150555/index.html">Formula E: announced a series of races involving electric vehicles</a></li>
<li><a href="../150556/index.html">Med Sensation Diagnostic Gloves</a></li>
<li><a href="../150558/index.html">Release MongoDB 2.2.0</a></li>
<li><a href="../150559/index.html">A few tips on the architecture of a mobile application actively using the network. Part 1</a></li>
<li><a href="../150560/index.html">P2P Broadcasting (organizing your own live broadcasts using Torrent Stream)</a></li>
<li><a href="../150565/index.html">Atari, in partnership with Microsoft, launched its old online games.</a></li>
<li><a href="../150569/index.html">The program Drone + again was not allowed on the App Store</a></li>
<li><a href="../150570/index.html">Launched Steam Greenlight!</a></li>
<li><a href="../150571/index.html">Object.defineProperty or how to make code a bit better</a></li>
<li><a href="../150573/index.html">How to deal with spam in different countries</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>