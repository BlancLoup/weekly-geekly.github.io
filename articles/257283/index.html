<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What prepares us for C # 7 (Part 2. Pattern matching)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing a series of articles on innovations in C # 7, I focus on, perhaps, the main innovations - Pattern matching and Record type (Approximate tra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What prepares us for C # 7 (Part 2. Pattern matching)</h1><div class="post__text post__text-html js-mediator-article">  Continuing a series of articles on innovations in C # 7, I focus on, perhaps, the main innovations - Pattern matching and Record type (Approximate translation "registered types").  These functionals complement each other, so it‚Äôs best to talk about them together. <br><a name="habracut"></a><br>  Let's start with the Record type.  He comes to us from F #.  In essence, this is a quick definition of a class, and with the impossibility of changing its properties, i.e.  all its fields have a readonly parameter, and parameters are set in the constructor.  Describing it for a long time and tedious, so we start immediately with a sample code and by example we will sort everything out.  Here is an example of the definition of a record type: <br><br><pre><code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> class </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Cartesian</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x: X, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y: Y</span></span></span><span class="hljs-function">)</span></span>;</code> </pre> <br><habracut><br>  This is the definition of some class that stores the Cartesian coordinates of a point.  It should be broadcast in this class: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Cartesian</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> $X; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> $Y; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Cartesian</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$X = x; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$Y = y; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> X { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$X; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Y { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$Y; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">operator</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Cartesian c, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y</span></span></span><span class="hljs-function">)</span></span> { x = cX; y = cY; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> obj</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (obj.GetType() != <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Cartesian)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $o = obj <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Cartesian; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>.Equals(X, $oX) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>.Equals(Y, $oY); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetHashCode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> $v = <span class="hljs-number"><span class="hljs-number">1203787</span></span>; $v = ($v * <span class="hljs-number"><span class="hljs-number">28341</span></span>) + X?.GetHashCode().GetValueOrDefault(); $v = ($v * <span class="hljs-number"><span class="hljs-number">28341</span></span>) + Y?.GetHashCode().GetValueOrDefault(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> System.Text.StringBuilder() .Append(‚ÄúCartesian(X: ‚Äú) .Append(X) .Append(‚Äú, Y: ‚Äù) .Append(Y) .Append(‚Äú)‚Äù) .ToString(); } }</code> </pre><br>  Let us examine the properties of the class.  In its definition, we specified two double parameters.  These parameters are translated into two read-only properties, and two read-only fields within the class.  Then a constructor is created with the parameters specified in the class definition.  Also, methods <i>Equals</i> , <i>GetHashCode</i> , <i>ToString are created</i> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Of most interest is the overloaded is operator.  Here it is just more related to Pattern matching.  The is operator now supports an additional comparison, in addition to the usual type-casting test.  It is also possible to additionally call this overloaded operator on the class.  To begin with, how the operator is overloaded and what actions can be performed.  The first parameter in the operator is the class object passed to it, it does not have to be the class of this operator.  Then come the return parameters with which we need to compare or which should be obtained when executing the is operator.  When creating a class through a record type, an is operator is created with the class passed to the record type and the return values ‚Äã‚Äãof this class specified in the definition.  Here is an example of how to convert Cartesian coordinates to polar coordinates using the <i>is</i> operator: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Polar</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">operator</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Cartesian c, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> R, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Theta</span></span></span><span class="hljs-function">)</span></span> { R = Math.Sqrt(cX*cX + cY*cY); Theta = Math.Atan2(cY, cX); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cX != <span class="hljs-number"><span class="hljs-number">0</span></span> || cY != <span class="hljs-number"><span class="hljs-number">0</span></span>; } }</code> </pre><br>  What we get if we pass an object of the <i>Cartesian</i> class to the operator: it will try to convert the data of this class to the data of the <i>Polar</i> class and return the transformed data. <br><br>  Pattern matching (or Pattern Matching; although I don‚Äôt really like the name, the English definition seems more accurate), what is it?  He came to us from languages ‚Äã‚Äãlike Python and F #.  In essence, this is an advanced switch, which not only can compare values ‚Äã‚Äãof one type with constants, but also use type conversion and their conversion to the required structure.  And in all of this, the new overloaded is operator will help us.  Let's start with the new features of the old type-checking operator.  Now instead of this: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> v = expr <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Type; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  v }</span></span></code> </pre><br>  You can write like this: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (expr <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-type"><span class="hljs-type">Type</span></span> v) { <span class="hljs-comment"><span class="hljs-comment">//  v }</span></span></code> </pre><br>  This, of course, shortens the type conversion code.  But let's return to Pattern matching and find out what opportunities it is preparing for us.  Let us write a check to reduce the specific Cartesian coordinates to the polar coordinates and obtain the radius: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-built_in"><span class="hljs-built_in">c</span></span> = <span class="hljs-type"><span class="hljs-type">Cartesian</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-type"><span class="hljs-type">Polar</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-type"><span class="hljs-type">R</span></span>, *)) <span class="hljs-type"><span class="hljs-type">Console</span></span>.<span class="hljs-type"><span class="hljs-type">WriteLine</span></span>(<span class="hljs-type"><span class="hljs-type">R</span></span>);</code> </pre><br>  So, what happens here, let's figure it out.  The variable <i>c is</i> taken, the type of the variable is obtained, and the operator <i>is is</i> searched for, where the first parameter is this type.  Then this statement is called and, if it returns true, the condition is considered to be fulfilled.  Next, we get the local variable <i>R</i> in the condition block.  Here the angle is not important to us, and therefore we passed the second parameter * - this means ignoring the second parameter.  Another possible use of this operator: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-type"><span class="hljs-type">Polar</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>, *)) <span class="hljs-type"><span class="hljs-type">Console</span></span>.<span class="hljs-type"><span class="hljs-type">WriteLine</span></span>(<span class="hljs-string"><span class="hljs-string">"  5"</span></span>);</code> </pre><br>  Here we impose an additional condition on the return value of the radius, and the condition is fulfilled only when the radius is 5. <br><br>  The main use of the new is operator <i>is</i> , of course, in the <i>switch statement</i> .  We give an example of solving algebraic expressions using pattern matching.  We define the classes we need using the record type. <br><br><pre> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Expr</span></span></span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class">(</span><span class="hljs-params"></span><span class="hljs-class"><span class="hljs-params"></span>) </span></span>: <span class="hljs-type"><span class="hljs-type">Expr</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Const</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">double </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Value</span></span></span></span></span><span class="hljs-class">) </span></span>: <span class="hljs-type"><span class="hljs-type">Expr</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Add</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Expr</span></span></span></span><span class="hljs-class"><span class="hljs-params"> </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Left</span></span></span></span><span class="hljs-class"><span class="hljs-params">, </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Expr</span></span></span></span><span class="hljs-class"><span class="hljs-params"> </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Right</span></span></span></span></span><span class="hljs-class">) </span></span>: <span class="hljs-type"><span class="hljs-type">Expr</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mult</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Expr</span></span></span></span><span class="hljs-class"><span class="hljs-params"> </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Left</span></span></span></span><span class="hljs-class"><span class="hljs-params">, </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Expr</span></span></span></span><span class="hljs-class"><span class="hljs-params"> </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Right</span></span></span></span></span><span class="hljs-class">) </span></span>: <span class="hljs-type"><span class="hljs-type">Expr</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Neg</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Expr</span></span></span></span><span class="hljs-class"><span class="hljs-params"> </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Value</span></span></span></span></span><span class="hljs-class">) </span></span>: <span class="hljs-type"><span class="hljs-type">Expr</span></span>;</code> </pre><br>  First, we write a method for taking the derivative: <br><br><pre> <code class="hljs php">Expr Deriv(Expr e) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (e) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> X(): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(*): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Add(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Left, <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Right): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Add(Deriv(Left), Deriv(Right)); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Mult(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Left, <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Right): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Add(Mult(Deriv(Left), Right), Mult(Left, Deriv(Right))); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Neg(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Value): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Neg(Deriv(Value)); } }</code> </pre><br>  Or a simplified expression: <br><br><pre> <code class="hljs php">Expr Simplify(Expr e) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (e) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Mult(<span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>), *): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Mult(*, <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>)): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Mult(<span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Simplify(x); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Mult(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x, <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>)): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Simplify(x); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Mult(<span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> l), <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r)): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(l*r); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Add(<span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Simplify(x); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Add(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x, <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>)): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Simplify(x); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Add(<span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> l), <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r)): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(l+r); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Neg(<span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> k)): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span>(-k); <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> e; } }</code> </pre><br>  In the descriptions of this functional, I met mainly examples related to mathematical calculations.  I will be very happy to see in the comments your examples where this functionality will really be useful not in mathematical calculations. <br><br>  <a href="https://github.com/dotnet/roslyn/issues/206">Here you can read the source</a> </habracut></div><p>Source: <a href="https://habr.com/ru/post/257283/">https://habr.com/ru/post/257283/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../257271/index.html">3D pen: prototyping or not?</a></li>
<li><a href="../257273/index.html">High-performance DEFLATE compression with optimized genomic data sets</a></li>
<li><a href="../257275/index.html">Creating a gulp-plugin on the example of building a dependency graph for Angular JS modules</a></li>
<li><a href="../257279/index.html">STM32. We connect ISO7816 smart cards</a></li>
<li><a href="../257281/index.html">We spread PHP</a></li>
<li><a href="../257285/index.html">Cards, money, two stars</a></li>
<li><a href="../257287/index.html">Head Unit - as a target for a hacker</a></li>
<li><a href="../257291/index.html">Fix corrupted MySQL tables with myisamchk</a></li>
<li><a href="../257293/index.html">Attackers use Linux / Mumblehard to compromise servers, part 2</a></li>
<li><a href="../257295/index.html">Just about corporate IaaS: what it is, for whom, and how it is paid</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>