<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tools for searching annotated classes in Java</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article provides a small overview of the three tools for searching annotated classes in a java project. 



 Training cats 

@Retention(RetentionP...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tools for searching annotated classes in Java</h1><div class="post__text post__text-html js-mediator-article"><p>  The article provides a small overview of the three tools for searching annotated classes in a java project. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/501/122/416/50112241639d6082dcb5779d13b72174.png" alt="image"></p><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Training cats</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Retention</span></span>(RetentionPolicy.RUNTIME) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> MyAnnotation {} <span class="hljs-meta"><span class="hljs-meta">@MyAnnotation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bar</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-meta"><span class="hljs-meta">@MyAnnotation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre> </div></div><br><h2 id="spring">  Spring </h2><br><p>  In Spring, ClassPathScanningCandidateComponentProvider serves for this purpose. </p><br><blockquote>  Feature: climbs into ClassPath, looking for classes that meet specified conditions </blockquote><br><div class="spoiler">  <b class="spoiler_title">Additional features</b> <div class="spoiler_text"><p>  has many other filters (for type, for methods, etc.) </p></div></div><br><h4 id="primer">  Example </h4><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">spring</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ClassPathScanningCandidateComponentProvider scanner = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ClassPathScanningCandidateComponentProvider(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); scanner.addIncludeFilter(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AnnotationTypeFilter(MyAnnotation.class)); List&lt;String&gt; collect = scanner .findCandidateComponents(<span class="hljs-string"><span class="hljs-string">"edu.pqdn.scanner"</span></span>) .stream() .map(BeanDefinition::getBeanClassName) .filter(Objects::nonNull) .collect(Collectors.toList()); assertEquals(collect.size(), <span class="hljs-number"><span class="hljs-number">2</span></span>); assertTrue(collect.contains(<span class="hljs-string"><span class="hljs-string">"edu.pqdn.scanner.test.Bar"</span></span>)); assertTrue(collect.contains(<span class="hljs-string"><span class="hljs-string">"edu.pqdn.scanner.test.Foo"</span></span>)); }</code> </pre> <br><h2 id="reflectionshttpsgithubcomronmamoreflections">  <a href="https://github.com/ronmamo/reflections">Reflections</a> </h2><br><blockquote>  Feature: climbs into ClassPath, looking for classes that meet specified conditions </blockquote><br><div class="spoiler">  <b class="spoiler_title">Additional features</b> <div class="spoiler_text"><ul><li>  get all subtypes of some type </li><li>  get all types / members annotated with some annotation </li><li>  get all resources matching a regular expression </li><li>  parameters, parameter returns and return type </li></ul></div></div><br><div class="spoiler">  <b class="spoiler_title">dependency</b> <div class="spoiler_text"><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.reflections<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>reflections<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>0.9.11<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><h4 id="primer-1">  Example </h4><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reflection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Reflections reflections = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Reflections(<span class="hljs-string"><span class="hljs-string">"edu.pqdn.scanner"</span></span>); Set&lt;Class&lt;?&gt;&gt; set = reflections.getTypesAnnotatedWith(MyAnnotation.class); List&lt;String&gt; collect = set.stream() .map(Class::getCanonicalName) .collect(Collectors.toList()); assertEquals(collect.size(), <span class="hljs-number"><span class="hljs-number">2</span></span>); assertTrue(collect.contains(<span class="hljs-string"><span class="hljs-string">"edu.pqdn.scanner.test.Bar"</span></span>)); assertTrue(collect.contains(<span class="hljs-string"><span class="hljs-string">"edu.pqdn.scanner.test.Foo"</span></span>)); }</code> </pre> <br><h2 id="classindexhttpsgithubcomatteoclassindex">  <a href="https://github.com/atteo/classindex">classindex</a> </h2><br><blockquote>  Feature: Does not climb in ClassPath, instead of this classes are indexed at the compilation stage </blockquote><br><div class="spoiler">  <b class="spoiler_title">dependency</b> <div class="spoiler_text"><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.atteo.classindex<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>classindex<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Training cats</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@IndexMyAnnotated</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> IndexerAnnotation {} <span class="hljs-meta"><span class="hljs-meta">@IndexerMyAnnotation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bar</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-meta"><span class="hljs-meta">@IndexerMyAnnotation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre> </div></div><br><h4 id="primer-2">  Example </h4><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">indexer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Iterable&lt;Class&lt;?&gt;&gt; iterable = ClassIndex.getAnnotated(IndexerMyAnnotation.class); List&lt;String&gt; list = StreamSupport.stream(iterable.spliterator(), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) .map(aClass -&gt; aClass.getCanonicalName()) .collect(Collectors.toList()); assertEquals(list.size(), <span class="hljs-number"><span class="hljs-number">2</span></span>); assertTrue(list.contains(<span class="hljs-string"><span class="hljs-string">"edu.pqdn.scanner.classindexer.test.Bar"</span></span>)); assertTrue(list.contains(<span class="hljs-string"><span class="hljs-string">"edu.pqdn.scanner.classindexer.test.Foo"</span></span>)); }</code> </pre> <br><h2 id="jmh">  Jmh </h2><br><pre> <code class="hljs vhdl">Benchmark Mode Cnt Score <span class="hljs-literal"><span class="hljs-literal">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Units</span></span> ScannerBenchmark.indexer avgt <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">001</span></span> ms/op ScannerBenchmark.reflection avgt <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">157</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">047</span></span> ms/op ScannerBenchmark.spring avgt <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">706</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">294</span></span> ms/op</code> </pre> <br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  As you can see, the indexer is the most productive tool, however, the annotations for which the search is performed must have the stereotype @IndexAnnotated. </p><br><p>  The other two tools are working much slower, but for their work no shamanism with code is needed.  The disadvantage is completely leveled out if the search is needed only at the start of the application. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/424511/">https://habr.com/ru/post/424511/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../424501/index.html">Diagnostic terminals for real welders</a></li>
<li><a href="../424503/index.html">Boot yourself, Spring is coming (Part 1)</a></li>
<li><a href="../424505/index.html">‚ÄúWe have ideas for Maven 4 and even Maven 5‚Äù - an interview with Robert Scholte, a key member of the Maven project</a></li>
<li><a href="../424507/index.html">VI annual hackathon JetBrains: Shiftius Altius Ctrlius</a></li>
<li><a href="../424509/index.html">Using the KOMPAS-3D API ‚Üí Lesson 12 ‚Üí Composite Lines</a></li>
<li><a href="../424513/index.html">About cheap data centers, RKN and DDoS protection</a></li>
<li><a href="../424517/index.html">Implementation of the minimization of logical functions by the Kvayna-Mak'Klaski method with an incomplete input set</a></li>
<li><a href="../424519/index.html">Can Beethoven send removal requests?</a></li>
<li><a href="../424525/index.html">Minidrill speed controller</a></li>
<li><a href="../424531/index.html">Microservices: size matters, even if you have Kubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>