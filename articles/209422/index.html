<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NetApp FAS storage testing using IOMeter load generator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During the testing of storage systems, specialists often encounter performance problems due to the nuances of tuning the entire complex. For load test...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>NetApp FAS storage testing using IOMeter load generator</h1><div class="post__text post__text-html js-mediator-article">  During the testing of <abbr title="Storage System">storage systems,</abbr> specialists often encounter performance problems due to the nuances of tuning the entire complex.  For load testing of <abbr title="Storage System">storage systems,</abbr> it is not enough just to run the load simulator, you need to configure the storage system, network and host.  The bulk of the settings, as a rule, is performed on the host. <br><br>  The purpose of this article is to assist system administrators and system integrators in understanding the settings and nuances when testing NetApp <abbr title="Storage System">storage</abbr> systems.  I also want to note that this article did not have the task of obtaining the highest possible performance of NetApp <abbr title="Fabric-attached storage">FAS</abbr> 2240 controllers, since at the time of testing the demo equipment there were not enough disks (144 maximum) for the <abbr title="Storage System">storage system</abbr> , and there was only one server available.  Those.  Maximum performance is considered here in the context of a specific configuration of the demo stand, in other words, with a larger number of disks, servers and network connections, it is possible to get even better results with the same 2240 controllers. Although all the graphs with performance results are taken from actual configurations of end customers using in tests 2240 controllers, in some tests four <abbr title="Solid state drive">SSD</abbr> 100GB <abbr title="Multi-Level Cell">MLC</abbr> disks were used. <br><br>  Below is a comprehensive description of load testing of <abbr title="Storage System">storage systems</abbr> : <a href="http://sourceforge.net/projects/iometer/">IOMeter</a> simulator settings, NetApp <abbr title="Fabric-attached storage">FAS</abbr> host and <abbr title="Storage System">storage</abbr> configuration methods, load statistics removal, and interpretation of the results.  Using the example of an existing demo stand, the methods of setting up all its components, as well as other possible configuration options using NetApp <abbr title="Fabric-attached storage">FAS,</abbr> will be considered. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/c63/b28/aba/c63b28aba4e1792ba9ff6a10791f3128.jpg" alt="image"><a name="habracut"></a><br><br><h5>  <a href="https://habr.com/ru/post/209422/">Demo Equipment</a> </h5><a name="demo"></a><br>  NetApp <abbr title="Fabric-attached storage">FAS</abbr> HA2240-2 with 4x <abbr title="Fiber channel">FC</abbr> 8 ports 24x600x10k <abbr title="Serial attached SCSI">SAS</abbr> , ONTAP 7-Mode 8.2 <br>  <abbr title="Storage area network">SAN</abbr> switch <br>  Cisco <abbr title="Unified Computing System">UCS</abbr> C210 intel Xeon EM64T 64-bit 2x6 cores 1,999 GHz 32 GB of <abbr title="RAM">RAM</abbr> , VMWare ESXi 5.1 <br>  Windows 2008 R2 x64 RDM virtual machine connecting to the <abbr title="Logical unit number">LUN</abbr> . <br><br><h5>  <a href="https://habr.com/ru/post/209422/">Storage system</a> </h5><a name="Storage"></a><br>  All disks are divided equally between the controllers: 12 to one and 12 to another.  On each disk set, one aggr0 unit is created, on each unit there is one system partition vol0 and one partition vol1 occupying all the free space on the unit, one moon is created on each partition occupying all available free on it.  As a rule, it is recommended to create the largest aggregate of the longest raid groups.  When creating the moon, the geometry was chosen corresponding to the host to which the <abbr title="Logical unit number">LUN</abbr> will be presented. <br><br><h4>  <a href="https://habr.com/ru/post/209422/">SAN network</a> </h4><a name="SAN"></a><br>  For monitoring and troubleshooting the <abbr title="Storage area network">SAN</abbr> switch, it is convenient to use the free <a href="">Brocade SANHealth</a> utility.  So a clogged fiber-optic connector can lead to performance problems.  From real life: a multipassing driver with the included Round-Robin policy, due to a broken link, created huge queues on an <abbr title="Host bus adapter">HBA</abbr> adapter, which resulted in large delays in the I / O system and high <abbr title="Central processing unit">CPU</abbr> utilization. <br>  Also do not forget that the <abbr title="Fiber channel">FC</abbr> link itself, for example, 4G can physically miss no more than 400 MB / s.  When generating more traffic, you will also notice an increase in the utilization of your host‚Äôs <abbr title="Central processing unit">CPU</abbr> .  It is easy to calculate the bandwidth of the link, considering that the coding scheme 8b / 10b is used for <abbr title="Fiber channel">FC</abbr> 1/2/4/8 G  we lose overhead 20%.  For <abbr title="Fiber channel">FC</abbr> 16G, a more economical 64b / 66b coding scheme is used.  Below is an example of calculating the maximum throughput for the FC 4G link. <br>  4Gbit = 500 MByte;  500 MByte * 8/10 = 400 Mbyte is the theoretical maximum throughput of such a channel. <br><br><h5>  <a href="https://habr.com/ru/post/209422/">Oncommand Core + Perfomance Adviser</a> </h5><a name="Oncommand_Core_and_Perfomance_Adviser"></a><br>  It is recommended to install a set of utilities for collecting statistics by displaying it in the form of graphs on Oncommand Core host not performing load testing.  Available for download from <a href="http://support.netapp.com/NOW/cgi-bin/software/">support.netapp.com</a> under Downloads Software (Requires NetApp NOW ID account).  The login and password for logging into the NetApp Managment Console corresponds to the login and password of the host. <br>  Requires a free license from NetApp <abbr title="Storage System">storage</abbr> users.  Performs monitoring of <abbr title="Fabric-attached storage">FAS</abbr> systems.  During installation, choose " <i>Standart Edition</i> ", not " <i>Express</i> ", to enable the function of collecting statistics and displaying graphs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/49c/3d3/ed0/49c3d3ed03231c2f8c9f70634d8f8fca.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/750/670/05c/75067005c9da5b9de9933ddad65ca092.png" alt="image"><br><br><h5>  <a href="https://habr.com/ru/post/209422/">Guest OS</a> </h5><a name="Guest_OS"></a><br>  Windows 2008 R2 x64 <br>  issued 6 processors and 16GB of <abbr title="RAM">RAM</abbr> <br>  Guest <abbr title="Operating system">OS</abbr> for <abbr title="Raw Disk Mapping">RDM</abbr> given both <abbr title="Logical unit number">LUN</abbr> <br>  Windows has the NetApp Host Utilities 6.0.2 utility package installed. <br>  In some cases, <abbr title="Virtual Machine File System">VMFS</abbr> shows better performance than <abbr title="Raw Disk Mapping">RDM</abbr> .  So, in the test with the load index described in the text, IOmeter showed almost 300 MByte / sec using <abbr title="Virtual Machine File System">VMFS</abbr> (see the figure at the very top of the text) and about 200 MByte / sec with <abbr title="Raw Disk Mapping">RDM</abbr> . <br><br><h5>  <a href="https://habr.com/ru/post/209422/">Iometer</a> </h5><a name="IOMeter"></a><br>  All the patterns of the <abbr title="Database">database</abbr> server, Web server, <a href="http://blog.atlantiscomputing.com/2013/08/how-to-use-iometer-to-simulate-a-desktop-workload/">VDI</a> and virtualization server are for IOMeter in the spoiler below.  Start notepad and save the contents of the spoiler, to a file with the <i>icf</i> extension. <br><div class="spoiler">  <b class="spoiler_title">iometer_v110_4k_ALL.icf</b> <div class="spoiler_text">  Version 1.1.0 <br>  'TEST SETUP =============================================== ===================== <br>  'Test Description <br><br>  'Run time <br>  'hours minutes seconds <br>  0 0 0 <br>  'Ramp Up Time (s) <br>  0 <br>  'Default Disk Workers to Spawn <br>  NUMBER_OF_CPUS <br>  'Default Network Workers to Spawn <br>  0 <br>  'Record Results <br>  ALL <br>  'Worker Cycling <br>  'start step step type <br>  1 1 LINEAR <br>  'Disk Cycling <br>  'start step step type <br>  1 1 LINEAR <br>  'Queue Depth Cycling <br>  'start end step step type <br>  1 32 2 EXPONENTIAL <br>  'Test Type <br>  NORMAL <br>  'END test setup <br>  'RESULTS DISPLAY =============================================== ================ <br>  'Record Last Update Results, Update Frequency, Update Type <br>  DISABLED, 0, WHOLE_TEST <br>  'Bar chart 1 statistic <br>  Total I / Os per Second <br>  'Bar chart 2 statistic <br>  Total MBs per Second (Decimal) <br>  'Bar chart 3 statistic <br>  Average I / O Response Time (ms) <br>  'Bar chart 4 statistic <br>  Maximum I / O Response Time (ms) <br>  'Bar chart 5 statistic <br>  % CPU utilization (total) <br>  'Bar chart 6 statistic <br>  Total Error Count <br>  'END results display <br>  'ACCESS SPECIFICATIONS =============================================== ========== <br>  'Access specification name, default assignment <br>  Default, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,67,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4 KiB;  100% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,100,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4 KiB;  75% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,75,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4 KiB;  50% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,50,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4 KiB;  25% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,25,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4 KiB;  0% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,0,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4 KiB aligned;  100% Read;  100% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,100,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4 KiB aligned;  50% Read;  100% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,50,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4 KiB aligned;  0% Read;  100% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,0,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  16 KiB;  100% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  16384,100,100,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  16 KiB;  75% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  16384,100,75,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  16 KiB;  50% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  16384,100,50,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  16 KiB;  25% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  16384,100,25,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  16 KiB;  0% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  16384,100,0,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  32 KiB;  100% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  32768,100,100,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  32 KiB;  75% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  32768,100,75,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  32 KiB;  50% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  32768,100,50,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  32 KiB;  25% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  32768,100,25,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  32 KiB;  0% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  32768,100,0,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  64 KiB;  100% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  65536,100,100,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  64 KiB;  50% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  65536,100,50,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  64 KiB;  0% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  65536,100,0,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  256 KiB;  100% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  262,144,100,100,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  256 KiB;  50% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  262,144,100,50,0,0,1,1,4096,0 <br>  'Access specification name, default assignment <br>  256 KiB;  0% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  262,144,100,0,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  All in one, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,5,100,0,0,1,4096,0 <br>  4096,5,75,0,0,1,4096,0 <br>  4096,5,50,0,0,1,4096,0 <br>  4096,5,25,0,0,1,4096,0 <br>  4096,5,0,0,0,1,4096,0 <br>  4096,5,100,100,0,1,4096,0 <br>  4096,5,50,100,0,1,4096,0 <br>  4096,5,0,100,0,1,4096,0 <br>  16384,4,100,0,0,1,4096,0 <br>  16384,4,75,0,0,1,4096,0 <br>  16384,4,50,0,0,1,4096,0 <br>  16384,4,25,0,0,1,4096,0 <br>  16384,4,0,0,0,1,4096,0,0 <br>  32768,4,100,0,0,1,4096,0 <br>  32768.4.75.0.0.1.4096.0 <br>  32768,4,50,0,0,1,4096,0 <br>  32768.4.25.0.0.1.4096.0 <br>  32768,4,0,0,0,1,4096,0 <br>  65536,4,100,0,0,1,4096,0 <br>  65536,4,50,0,0,1,4096,0 <br>  65536,3,0,0,0,1,4096,0 <br>  262,144.3,100,0,0,1,4096,0 <br>  262144,3,50,0,0,1,4,496,0,0 <br>  262,144.3.0.0.0.1.4096.0 <br>  'Access specification name, default assignment <br>  Database pattern, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  8192,100,67,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  Fileserver pattern (Intel), NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  512,10,80,100,0,1,4096,0 <br>  1024,5,80,100,0,1,4096,0 <br>  2048,5,80,100,0,1,4096,0 <br>  4096,60,80,100,0,1,4096,0 <br>  8192,2,80,100,0,1,4096,0 <br>  16384,4,80,100,0,1,4096,0 <br>  32768.4.80.100.0.1.4096.0 <br>  65536,10,80,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  Workstation pattern (StorageReview.com), NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  8192,100,80,80,0,1,8192,0 <br>  'Access specification name, default assignment <br>  Webserver pattern (unknown), NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  512,22,100,100,0,1,4096,0 <br>  1024,15,100,100,0,1,4096,0 <br>  2048,8,100,100,0,1,4096,0 <br>  4096,23,100,100,0,1,4096,0 <br>  8192,15,100,100,0,1,4096,0 <br>  16384,2,100,100,0,1,4096,0 <br>  32768,6,100,100,0,1,4096,0 <br>  66560,7,100,100,0,1,4096,0 <br>  131072,1,100,100,0,1,4096,0 <br>  524288,1,100,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  VDI, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,20,80,0,1,4096,0 <br>  'END access specifications <br>  'MANAGER LIST =============================================== =================== <br>  'Manager ID, manager name <br>  1, MT-RAKITSKAYANB <br>  'Manager network address <br><br>  'End manager <br>  'END manager list <br>  Version 1.1.0 <br></div></div><br><div class="spoiler">  <b class="spoiler_title">iometer_v20060727_4k_ALL.icf</b> <div class="spoiler_text">  Version 2006.07.27 <br>  'TEST SETUP =============================================== ===================== <br>  'Test Description <br><br>  'Run time <br>  'hours minutes seconds <br>  0 0 0 <br>  'Ramp Up Time (s) <br>  0 <br>  'Default Disk Workers to Spawn <br>  NUMBER_OF_CPUS <br>  'Default Network Workers to Spawn <br>  0 <br>  'Record Results <br>  ALL <br>  'Worker Cycling <br>  'start step step type <br>  1 1 LINEAR <br>  'Disk Cycling <br>  'start step step type <br>  1 1 LINEAR <br>  'Queue Depth Cycling <br>  'start end step step type <br>  1 32 2 EXPONENTIAL <br>  'Test Type <br>  NORMAL <br>  'END test setup <br>  'RESULTS DISPLAY =============================================== ================ <br>  'Update Frequency, Update Type <br>  5, WHOLE_TEST <br>  'Bar chart 1 statistic <br>  Total I / Os per Second <br>  'Bar chart 2 statistic <br>  Total MBs per Second <br>  'Bar chart 3 statistic <br>  Average I / O Response Time (ms) <br>  'Bar chart 4 statistic <br>  Maximum I / O Response Time (ms) <br>  'Bar chart 5 statistic <br>  % CPU utilization (total) <br>  'Bar chart 6 statistic <br>  Total Error Count <br>  'END results display <br>  'ACCESS SPECIFICATIONS =============================================== ========== <br>  'Access specification name, default assignment <br>  Default, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  2048,100,67,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4K;  100% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,100,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4K;  75% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,75,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4K;  50% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,50,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4K;  25% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,25,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  4K;  0% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,0,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  16K;  100% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  16384,100,100,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  16K;  75% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  16384,100,75,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  16K;  50% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  16384,100,50,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  16K;  25% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  16384,100,25,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  16K;  0% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  16384,100,0,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  32K;  100% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  32768,100,100,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  32K;  75% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  32768,100,75,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  32K;  50% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  32768,100,50,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  32K;  25% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  32768,100,25,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  32K;  0% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  32768,100,0,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  64K;  100% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  65536,100,100,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  64K;  75% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  65536,100,75,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  64K;  50% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  65536,100,50,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  64K;  25% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  65536,100,25,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  64K;  0% Read;  0% random, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  65536,100,0,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  All in one, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,5,100,0,0,1,4096,0 <br>  4096,5,75,0,0,1,4096,0 <br>  4096,5,50,0,0,1,4096,0 <br>  4096,5,25,0,0,1,4096,0 <br>  4096,5,0,0,0,1,4096,0 <br>  16384,5,100,0,0,1,4096,0 <br>  16384,5,75,0,0,1,4096,0 <br>  16384,5,50,0,0,1,4096,0 <br>  16384,5,25,0,0,1,4096,0 <br>  16384.5,0,0,0,1,4096,0 <br>  32768,5,100,0,0,1,4096,0 <br>  32768,5,75,0,0,1,4096,0 <br>  32768,5,50,0,0,1,4096,0 <br>  32768,5,25,0,0,1,4096,0 <br>  32768,5,0,0,0,1,4096,0 <br>  65536,5,100,0,0,1,4096,0 <br>  65536,5,75,0,0,1,4096,0 <br>  65536,5,50,0,0,1,4096,0 <br>  65536,5,25,0,0,1,4096,0 <br>  65536,5,0,0,0,1,4096,0 <br>  'Access specification name, default assignment <br>  Database pattern (Intel / StorageReview.com), NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  8192,100,67,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  Fileserver pattern (Intel), NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  512,10,80,100,0,1,4096,0 <br>  1024,5,80,100,0,1,4096,0 <br>  2048,5,80,100,0,1,4096,0 <br>  4096,60,80,100,0,1,4096,0 <br>  8192,2,80,100,0,1,4096,0 <br>  16384,4,80,100,0,1,4096,0 <br>  32768.4.80.100.0.1.4096.0 <br>  65536,10,80,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  Workstation pattern (StorageReview.com), NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  8192,100,80,80,0,1,4096,0 <br>  'Access specification name, default assignment <br>  Webserver pattern (unknown), NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  512,22,100,100,0,1,4096,0 <br>  1024,15,100,100,0,1,4096,0 <br>  2048,8,100,100,0,1,4096,0 <br>  4096,23,100,100,0,1,4096,0 <br>  8192,15,100,100,0,1,4096,0 <br>  16384,2,100,100,0,1,4096,0 <br>  32768,6,100,100,0,1,4096,0 <br>  66560,7,100,100,0,1,4096,0 <br>  131072,1,100,100,0,1,4096,0 <br>  524288,1,100,100,0,1,4096,0 <br>  'Access specification name, default assignment <br>  VDI, NONE <br>  'size,% of size,% reads,% random, delay, burst, align, reply <br>  4096,100,20,80,0,1,4096,0 <br>  'END access specifications <br>  Version 2006.07.27 <br></div></div><br>  Workers (load generating processes) can run on the same machine as the IOMeter graphical interface, and on other machines (including heterogeneous, for example Linux and Solaris) managed from a single interface like a bot-net. <br><br>  At the end of the load, IOMeter will report as a <abbr title="Comma-separated values">CSV</abbr> file.  But practice has shown that this report is not worth believing too much.  IOMeter is good for generating load but not for collecting load statistics. <br><br>  IOMeter is launched, two workers are created, one <abbr title="Logical unit number">LUN is</abbr> given to each. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/25e/9db/c49/25e9dbc490487ed790517515d4c6fb46.png" alt="image"><br><br><ul><li>  block 8K </li><li>  67% read / 33% write </li><li>  100% random </li><li>  Align <abbr title="Input-Output Operation">I / O</abbr> on should always be 4K </li><li>  Outstanding <abbr title="Input-Output Operation">I / O</abbr> 128 </li></ul><br><br>  Align <abbr title="Input-Output Operation">I / O</abbr> on should always be <a href="http://blog.aboutnetapp.ru/archives/794">4K, as the most suitable</a> in the case of modern operating systems and storage systems. <br><br>  Maximum 256 for Outstanding <abbr title="Input-Output Operation">I / O</abbr> , the number 128 for a parameter means a high load similar to a high-loaded <abbr title="Database">database</abbr> .  We create two workers and give one one <abbr title="Logical unit number">LUN</abbr> , the second second. <br><br><img src="https://habrastorage.org/files/332/ad3/b0f/332ad3b0f5524ec3b744a647e25271f7.png"><br>  Set the maximum size of the test file ‚ÄúMaximum Disk Size‚Äù (0 means all free space on the disk), the value is set in sectors, for example 204800 sectors (where one sector is 512 Byte, so 204800 sectors will give 100MByte).  And we set the load pattern in the ‚ÄúWrite IO Data Patern‚Äù field. <br><br><h6>  <a href="http://habrahabr.ru/post/154205/">Compatibility Matrix</a> </h6><br>  I had to upgrade from DataOntap 8.1.4 7-Mode to 8.2, update the <abbr title="Host bus adapter">HBA</abbr> FirmWare on the host.  You also need to <a href="http://habrahabr.ru/post/243153/">set the timeout for the</a> hard disk ( <abbr title="Raw Disk Mapping">RDM</abbr> <abbr title="Logical unit number">LUN</abbr> 'a) in the ESXi environment. <br>  I only got 7 variants based on the demo stand described above.  The first of them approached me.  I open and compare that everything converges.  <a href="http://habrahabr.ru/post/154205/">Make</a> extensive <a href="http://habrahabr.ru/post/154205/">use of the compatibility matrix</a> in your practice to reduce potential problems in the <abbr title="Data processing center">data center</abbr> infrastructure. <br><br><h6>  <a href="https://habr.com/ru/post/209422/">NetApp Host Utilities</a> </h6><a name="Host_Utilities"></a><br>  Do not ignore this item.  The toolkit sets the correct delays, queue size for <abbr title="Host bus adapter">HBAs,</abbr> and other settings on the host.  Displays the connected <abbr title="Logical unit number">LUNs</abbr> and their detailed information from the <abbr title="Storage System">storage</abbr> side.  The set of utilities is free and can be downloaded from the Netta technical support website.  After installation, run the utility. <br><pre><code class="bash hljs">host_config &lt;-setup&gt; &lt;-protocol fcp|iscsi|mixed&gt; &lt;-multipath mpxio|dmp|non&gt; [-noalua]</code> </pre> <br>  She is to be <br>  for solaris <br>  <i>/ opt / NTAP / SANToolkit / bin /</i> <br>  for linux <br>  <i>/ opt / netapp / santools /</i> <br>  for Windows, settings will be added automatically during installation. <br>  After that, most likely, you <b>will need to restart the host.</b> <br><br><h6>  <a href="https://habr.com/ru/post/209422/">MBR</a> </h6><a name="MBR"></a><br>  For Windows 2008, you need to select the ‚ÄúWindows 2008‚Äù disk geometry when creating a <abbr title="Logical unit number">LUN</abbr> . <br>  When initializing a disk with the <abbr title="Master boot record">MBR</abbr> table, it can be used as a block device without formatting or creating a <abbr title="File system">file system</abbr> or <abbr title="File system">file system</abbr> during the test with IOMeter. <br><br><h6>  <a href="https://habr.com/ru/post/209422/">GPT</a> </h6><a name="GPT"></a><br>  <a href="https://library.netapp.com/ecmdocs/ECMP1196995/html/GUID-7D4DD6E3-DB77-4671-BDA2-E393002E9EB2.html">For Windows 2003 with GPT</a> , when creating a <abbr title="Logical unit number">LUN,</abbr> you need to select the ‚ÄúWindows <abbr title="GUID Partition Table">GPT</abbr> ‚Äù disk geometry by creating a file system on it and generating a load by creating a test file (creating the file can take a long time), in such a test the file system layer will be added. <br>  So far, not supported by IOmetr as a block device on the newest <a href="http://habrahabr.ru/post/245859/">version 1.1.0</a> . <br>  IOMeter does not know how to work with block devices initialized as <abbr title="GUID Partition Table">GPT</abbr> .  Therefore, we have two ways: <br><ul><li>  use block access with <abbr title="Master boot record">MBR</abbr> , which can not be more than 2TB, when creating <abbr title="Logical unit number">LUN</abbr> on netap select "Windows 2008", on the host of such a moon initialize as <abbr title="Master boot record">MBR</abbr> . </li><li>  format a <abbr title="GUID Partition Table">GPT</abbr> disk and use it with the file system.  The test over the block device will not work with <abbr title="GUID Partition Table">GPT</abbr> </li></ul><br><h5>  <a href="https://habr.com/ru/post/209422/">Collecting statistics on the host</a> </h5><a name="Statistics"></a><br><h6>  <a href="https://habr.com/ru/post/209422/">Statistics for Unix-like</a> : </h6><a name="unix_statistics"></a><br>  in Solaris, as a rule, there is a utility that collects detailed statistics on the state of the host <br><pre> <code class="bash hljs">/opt/SUNWexplo/bin/explorer</code> </pre><br><br><h6>  <a href="https://habr.com/ru/post/209422/">ESXi performance</a> </h6><a name="ESXI_perfomance"></a><a name="ESXI_performance"></a><br>  The graph with statistics about the load ESXi host, usually coincides with MS perfmon.  Since it does not require separate installation and configuration is very convenient for the initial assessment of the generated load.  From the command line, a handy feature is available for collecting statistics on the size of blocks that the host operates on using the command: <br><pre> <code class="bash hljs">vscsiStats -s -w YYYYY -i XXXX</code> </pre>  Where YYYYY would be the groupID of the virtual machine, and XXXX its Virtual SCSI Disk handleID.  More <a href="http://habrahabr.ru/post/235785/">in this article</a> . <br>  And the load on the disk subsystem for I / O and latency can be collected using the command: <br><pre> <code class="bash hljs">esxtop -b -a -d %SEC% -n %COUNT% | gzip -9c &gt; /root/esxtop.out.gz</code> </pre>  where <i>% SEC%</i> is the number of seconds between measurements, <i>% COUNT%</i> is the number of measurements. <br>  You can download the <a href="http://labs.vmware.com/flings/esxplot"><i>ESXplot</i></a> utility to analyze the resulting log on the VMware website, which can convert output into several formats, including the built-in <i>Windows <a href="http://habrahabr.ru/post/209422/">perfmon</a></i> utility, which is very convenient. <br><img src="https://habrastorage.org/getpro/habr/post_images/90f/8bf/cd8/90f8bfcd89c8f41296e01bd04eb3bbe2.jpg" alt="image"><br><br><h4>  Also pay attention to the following optimization components </h4><br><table><tbody><tr><th>  Linux host with SAN </th><th>  Storage </th><th>  Windows host with SAN </th><th></th></tr><tr><td></td><td><h5>  <a href="http://habrahabr.ru/post/243045/">Interpretation of test results</a> </h5><a name="test_interpretation"></a></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td><h4>  <a href="http://habrahabr.ru/post/245357/">SAN Multipathing Linux Host</a> </h4><a name="SAN_Multipathing"></a></td><td><h4>  <a href="http://habrahabr.ru/post/243045/">SAN Multipathing by Storage</a> </h4><a name="SAN_Multipathing"></a></td><td><h4>  <a href="http://habrahabr.ru/post/243153/">SAN Multipathing Windows Host</a> </h4><a name="SAN_Multipathing"></a></td><td></td></tr><tr><td><h6>  <a href="http://habrahabr.ru/post/245357/">Thin Provitioning for Linux Host with SAN</a> </h6><a name="Thin_Provitioning"></a></td><td><h6>  <a href="http://habrahabr.ru/post/243045/">Thin Provitioning with NAS Storage</a> </h6><a name="Thin_Provitioning"></a></td><td><h6>  <a href="http://habrahabr.ru/post/243153/">Thin Provitioning for Windows Host with SAN</a> </h6></td><td></td></tr><tr><td>  <a href="http://habrahabr.ru/post/245357/">Ethernet</a> </td><td><h4>  <a href="http://habrahabr.ru/post/243119/">Ethernet</a> </h4><a name="Ethernet"></a></td><td>  <a href="http://habrahabr.ru/post/243153/">Ethernet</a> </td><td></td></tr><tr><td></td><td><h5>  <a href="http://habrahabr.ru/post/243045/">Nfs</a> </h5><a name="NFS"></a></td><td></td><td></td></tr><tr><td></td><td><h5>  <a href="http://habrahabr.ru/post/243045/">iSCSI</a> </h5><a name="iSCSI"></a></td><td><h5>  <a href="http://habrahabr.ru/post/243153/">iSCSI</a> </h5></td><td></td></tr><tr><td></td><td><h5>  <a href="http://habrahabr.ru/post/243045/">CIFS</a> </h5><a name="CIFS"></a></td><td></td><td></td></tr><tr><td><h5>  <a href="http://habrahabr.ru/post/245357/">ESXi Host</a> </h5><a name="ESXi_host"></a></td><td><h6>  <a href="http://habrahabr.ru/post/243045/">VAAI &amp; NFS</a> </h6><a name="VAAI_NFS"></a></td><td><h5>  <a href="http://habrahabr.ru/post/243153/">ESXi Host</a> </h5></td><td></td></tr><tr><td><h5>  <a href="http://habrahabr.ru/post/245357/">Guest OS and host BareMetal Linux</a> </h5><a name="Host_OS_and_BareMetal"></a><a name="Linux_elevator"></a><a name="Sysctl_Virtual_Memory"></a><a name="HBA_IO_queue_size"></a></td><td></td><td></td><td></td></tr><tr><td><h6>  <a href="http://habrahabr.ru/post/245357/">File system</a> </h6><a name="FS"></a></td><td></td><td><h6>  <a href="http://habrahabr.ru/post/243153/">File system</a> </h6><a name="FS"></a></td><td></td></tr><tr><td><h6>  <a href="http://habrahabr.ru/post/245357/">Noatime on Khost</a> </h6><a name="Noatime"></a></td><td><h6>  <a href="http://habrahabr.ru/post/243045/">Noatime on NAS Storage</a> </h6></td><td><h6>  <a href="http://habrahabr.ru/post/243153/">Record the last access to the file on the host</a> </h6></td><td></td></tr><tr><td><h6>  <a href="http://habrahabr.ru/post/245357/">Load tables</a> </h6></td><td><h6>  <a href="http://habrahabr.ru/post/243045/">Misalignment</a> </h6><a name="Misalignment"></a></td><td><h6>  <a href="http://habrahabr.ru/post/243153/">Load tables</a> </h6></td><td></td></tr><tr><td></td><td><h6>  <a href="http://habrahabr.ru/post/243045/">Check disk storage</a> </h6><a name="backend_storage_disks_performance"></a><a name="ESXI_performance"></a></td><td></td><td></td></tr><tr><td><h6>  <a href="http://habrahabr.ru/post/245357/">Statistics for Linux</a> </h6><a name="linux_statistics"></a></td><td><h5>  <a href="http://habrahabr.ru/post/243045/">PerfStat</a> </h5><a name="PerfStat"></a></td><td><h6>  <a href="http://habrahabr.ru/post/243153/">Perfmon.exe</a> and <a href="http://habrahabr.ru/post/243153/">Logman</a> </h6></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table><br><h5>  <a href="https://habr.com/ru/post/209422/">PS NOW ID</a> </h5><a name="NOWID"></a><br>  If you do not have a NetApp NOW ID, then you can <a href="http://support.netapp.com/eservice/public/now.do">start</a> it; you do not need storage for this.  Also, to obtain the utilities listed in this post, you can contact your NetApp Distributor, who will download and transfer the most recent versions of them. <br><br><h6>  <a href="https://habr.com/ru/post/209422/">Other load generators</a> </h6><a name="other_simulators"></a><br>  <a href="http://support.netapp.com/NOW/download/tools/sio_ntap/">sio</a> <br>  <a href="http://blog.aboutnetapp.ru/archives/1243">fio</a> <br>  <a href="http://docs.oracle.com/cd/E11882_01/server.112/e16638/iodesign.htm">Oracle Orion</a> <br>  <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D20163">MS SQLIO Disk Subsystem Benchmark Tool</a> <br>  <a href="http://www.iozone.org/">Iozone</a> <br>  <a href="http://www.attotech.com/disk-benchmark/">ATTO Disk Benchmark</a> <br>  <a href="https://github.com/microsoft/diskspd">Microsoft Diskspd</a> <br>  <a href="http://www.oracle.com/technetwork/server-storage/vdbench-downloads-1901681.html">oracle vdbench</a> <br><br>  <b>Comments on errors in the text and suggestions please send to the <abbr title="Private message">LAN</abbr> .</b> </div><p>Source: <a href="https://habr.com/ru/post/209422/">https://habr.com/ru/post/209422/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209412/index.html">C #. Inconsistent comparison</a></li>
<li><a href="../209414/index.html">US Congressmen have to extract secrets from the NSA from Bruce Schneier</a></li>
<li><a href="../209416/index.html">Survey: The level of your education</a></li>
<li><a href="../209418/index.html">How I bought on Amazon worth more than ‚Ç¨ 200</a></li>
<li><a href="../209420/index.html">The first news from Sony this year.</a></li>
<li><a href="../209424/index.html">Translation of Eddie Osmani‚Äôs book Patterns for Scalable JavaScript Applications</a></li>
<li><a href="../209426/index.html">OpenBSD Project at Risk of Closure: No Money to Pay Electricity Bills</a></li>
<li><a href="../209430/index.html">First experience with the Mail.ru cloud</a></li>
<li><a href="../209432/index.html">OwnCloud's own corporate cloud with NGINX on the frontend and several backend servers</a></li>
<li><a href="../209434/index.html">Japanese space agency JAXA is going to hunt space junk with a network in February</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>