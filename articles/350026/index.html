<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>(Non) security monitoring systems: Zabbix</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we will continue to figure out how to behave at the first meeting with the monitoring system during pentest. This time, the old Zabbix came to v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>(Non) security monitoring systems: Zabbix</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/453/3ec/c7e/4533ecc7ea7cf8558021b3a428716644.png" alt="image"><br><br>  Today we will continue to figure out how to behave at the first meeting with the monitoring system during pentest.  This time, the old Zabbix came to visit us. <br><a name="habracut"></a><br><h2>  How it all works </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e19/fb6/a96/e19fb6a9653e26150e33f2a818f28612.png" width="500" alt="image"></div>  <i><font color="99999">At first glance, Zabbix may seem like a complicated monitoring system for a user who encounters it for the first time.</font></i> <br><br>  Over time, this monitoring system has acquired a large number of users and numerous forums will gladly help to understand all aspects of the fine-tuning of this software, but the community rarely helps to create a secure system configuration, these weaknesses will be discussed today. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Check in light </h2><br>  I do not think that you will be surprised to learn that not all system administrators support the versions of their <abbr title="System Monitoring">CMs up</abbr> to date.  So let's start with a simple definition of the system version (you can use one of these scripts <a href="https://github.com/HD421/Monitoring-Systems-Version-Check/blob/master/mScan.py">1</a> or <a href="https://github.com/freeworkaz/zabbix_test/blob/master/zabbix_version_detect.py">2 for this</a> ).  With a certain probability, you will not need to invent something further and you will be able to use one of the well-proven <a href="https://www.rapid7.com/db/modules/exploit/linux/misc/zabbix_server_exec">exploits</a> in order to achieve the goal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/27e/c90/a4d/27ec90a4dae99e46329fe0245399e760.png" width="500" alt="image"></div><br>  But I think you didn‚Äôt look under the cat to read about how to use Metasploit modules, and now, you are inspired by good intentions and research surroundings, come to do your job, connect to the Ethernet outlet and discover a fresh, updated Zabbix.  It does not matter, the system developers thought about you and made the transfer of traffic between the host and the server in an unencrypted form, so if the administrator did not bother with setting up encryption - it's time to recall the old arp spoofing.  A detailed description of the administrator's session interception and posting on the web interface is described <a href="">here</a> , as well all the necessary scripts can be studied <a href="https://github.com/freeworkaz/zabbix_test">here</a> . <br><br><h2>  We need to go deeper </h2><br>  Well, you have already compromised the system, but you know that Zabbix has the functionality of interacting with the observed agents and leaving without trying to capture the subnet would be an unaffordable luxury.  Unlike <a href="https://habrahabr.ru/company/dsec/blog/346966/">Nagios</a> in Zabbix, many of our capabilities are limited to configuration files that are not in a hurry to give us the opportunity to keep a constant shell on the agent, but only the weak ones surrender and in the updated version of our memo it is easy <a href="">to explain how to gain a foothold in the compromised system and the necessary configs</a> for successful escalation on the host regardless of whether we are dealing with Unix or Windows. <br><br>  As you already understood, the purpose of this note was once again to draw the attention of all users of monitoring systems to the problem of their security, as well as to turn their view on our <a href="">Cheat Sheet</a> on the operation of the <abbr title="System Monitoring">SM</abbr> .  The work does not end there, and soon new research in this area will be presented. <br><br><h2>  Thanks </h2><br>  I would like to thank <a href="https://habrahabr.ru/users/shodin/" class="user_link">Shodin</a> for the work done on researching the Zabbix monitoring system (the article of this researcher will be published in our blog soon), without his contribution, our memo would be much leaner.  Respect these guys: <a href="https://habrahabr.ru/users/sabotaged/" class="user_link">sabotaged</a> , <a href="https://habrahabr.ru/users/ro421/" class="user_link">ro421</a> . <br><br>  See you soon! </div><p>Source: <a href="https://habr.com/ru/post/350026/">https://habr.com/ru/post/350026/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350012/index.html">Analysis of the consensus algorithm in Tendermint</a></li>
<li><a href="../350014/index.html">How to make an adequate display of the horizontal scroll bar in a QTreeWidget with one column</a></li>
<li><a href="../350016/index.html">Digital events in Moscow from February 26 to March 4</a></li>
<li><a href="../350018/index.html">You may not need Rust to speed up your JS</a></li>
<li><a href="../350022/index.html">FastTrack Training. "Network Basics". "Basics of switching or switches." Part two. Eddie Martin December 2012</a></li>
<li><a href="../350028/index.html">Code Integrity Protection with PGP. Part 2. Creating a master key</a></li>
<li><a href="../350030/index.html">Searchless method for calculating controller settings using Python</a></li>
<li><a href="../350032/index.html">Additional factors for evaluating spam activity IP / Email addresses in the Anti-Spam / Anti-Fraud API</a></li>
<li><a href="../350034/index.html">Service Workers. Web Push and where they live</a></li>
<li><a href="../350038/index.html">Rake when moving to a virtual platform with physical hardware</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>