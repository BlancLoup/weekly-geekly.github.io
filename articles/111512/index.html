<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Threats Inside: we initialize channels of leakage of corporate information</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inside - perhaps the most flawed phenomenon in the corporate environment. Both literally and figuratively. Now the corporate perimeter is protected no...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Threats Inside: we initialize channels of leakage of corporate information</h1><div class="post__text post__text-html js-mediator-article">  Inside - perhaps the most flawed phenomenon in the corporate environment.  Both literally and figuratively.  Now the corporate perimeter is protected not only and not so much from external violators, but, in fact, from themselves.  We look at this problem from an insider who combines the art of stealing confidential information with the edge of a sharp blade. <a name="habracut"></a><br><br>  At present, business is an ‚Äúarms race‚Äù: who can offer their services faster and with better quality, he occupies a leading position.  ‚ÄúArmaments‚Äù in this area are distinguished by their specificity, but the subject of the ‚Äúrace‚Äù does not change - actual information, if used properly, can both provide its owner with a bright future and put an end to its competitors. <br><br>  Ways of obtaining ‚Äúuseful‚Äù information depend on its type and the infrastructure in which it circulates, so it is difficult to classify its production methods.  However, there are two fundamentally different methods that, one way or another, are engaged in its collection and processing. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ‚Ä¢ <i>Competitive intelligence</i> - collecting and processing information in a ‚Äúlegal‚Äù business environment.  The data is obtained solely by analyzing reports from various media and similar sources within the framework of the law. <br>  ‚Ä¢ <i>Industrial espionage</i> - illegal receipt and (or) use of classified information in the conditions of unfair competition. <br><br>  Both methods are present in all areas and levels of business, but in different manifestations.  I would like to focus on the latter, due to the peculiarities of the used techniques of obtaining confidential information. <br><br>  Of the most common practices of industrial espionage, there are several examples: <br><br>  ‚Ä¢ blackmail of a person or a circle of persons having access to certain information; <br>  ‚Ä¢ bribing the same circle of persons; <br>  ‚Ä¢ theft of media; <br>  ‚Ä¢ <i>Insiding</i> - civil activity associated with the leakage of information and, as a result, in violation of the law. <br><br>  The last point hides a whole class of crimes that can be carried out both intentionally (using specially introduced and trained agents) and unintentionally (crimes committed by employees of the target organization due to their incompetence, etc.). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/701/359/313/701359313337c03ffb0661a0991efe7a.png" alt="Measures applied to employees who have committed a planned information leak (Perimetrix, 2009)"><br><br>  From the point of view of information security, the most dangerous are specifically embedded insiders who have the technical knowledge and means to collect confidential information.  However, as Perimetrix‚Äôs annual research center‚Äôs research shows, both intruders of internal information security receive roughly the same severity of punishment, which depend only on the cost of the lost information: from strict reprimand to dismissal from the company.  Rarely it comes to court.  Perhaps this fact is due to the fact that many companies do not want to spoil their reputation in the eyes of potential customers, but nonetheless, violators do not receive proper punishment, which leads to the ‚Äúillusory‚Äù impunity of insider trading as a means of competition and its dissemination in business. <br><br><h5>  Poisonous usb </h5><br>  A person, himself without realizing it, may become an insider.  For example, as a result of social engineering or in Russian speaking: divorce.  Such individuals are not interesting to us, since most of the time, the information security policies of the company that regulate how to work with the information of each employee cope with them.  Much more dangerous than insiders, specially prepared and having a specific goal. <br><br>  What to say about ordinary users who every day risk getting (and falling) under the hood of Trojans.  And then the insider?  Given that everyone can use the weapon of the ‚Äúmisguided kazachka‚Äù for their own purposes, and in the user environment it is much more efficient to do this than in the corporate one. <br>  The policy of allowing USB devices can play into the hands of an attacker.  Even if many organizations do not think about these issues, then what is happening with ordinary users ... Any flash-drive, player, etc.  usb-device, having available special software, can collect the necessary information from the target PC in such a way that the administrator does not even have any suspicions.  Creating a platform for the operation of such software for usb-devices we will do. <br><br><h5>  Click shutter </h5><br>  The preliminary stage will be the preparation of flash-memory.  First, let's define its characteristics. <br>  Any usb-flash drive has a controller - a chip that acts as a gateway between the memory chip and the USB interface of the computer.  The <b>ChipGenius</b> utility will help determine the type of controller without breaking the case of the flash drive (look for a link to this program in the list of web resources to the article). <br><br>  From the list of USB controllers, select our USB flash drive and in the area ‚ÄúThe details of selected device‚Äù we look at the detailed information.  We need the ‚ÄúChip Vendor‚Äù field, which contains the name of the chip manufacturer;  The ‚ÄúChip Part-Number‚Äù field shows the firmware version.  This information is sufficient for flashing the device. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dad/547/bfa/dad547bfac18e3283047105d46cfab21.jpg" alt="Experimental device. 4 GB of memory in most cases is enough to ‚Äúbackup‚Äù confidential information."><br><br>  In my case (Kingston DataTraveler 4GB): <br>  <i>Chip Vendor: phison</i> <i><br></i>  <i>Chip Part Number: UP10 ~ UP14.</i> <br><br>  Determination of the manufacturer of the memory controller and the approximate version of the firmware: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b71/d4f/081/b71d4f0811e02f8d57a9182ab05c9c19.jpg" alt="Determine the manufacturer of the memory controller and the approximate firmware version"><br><br>  Some time ago on the shelves of stores you could watch USB-flash memory supporting U3 technology.  Nothing fundamentally new such flash drives did not contain, with the exception of special software, which made it possible to run the software contained in the drive's memory in autoload mode.  The main feature is a special section (similar to the CD-ROM section), which was read-only and which contained portable (portable) versions of the programs. <br><br>  Currently, these devices are missing on the shelves, as they contained a specific ‚Äúbug‚Äù that allowed overwriting the area being loaded and running any software or .bat file, which, in some cases, could contribute to the spread of malicious software, put an end to confidential information and, in general, lead to disastrous consequences. <br><br>  The next stage is the modernization of the ‚Äútrigger mechanism‚Äù of our weapons.  It consists in flashing the flash controller.  Current task condition: <br><br>  ‚Ä¢ at the entrance - the usual usb-flash; <br>  ‚Ä¢ output - usb-flash with support for U3. <br><br>  Go to the site <a href="http://flashboot.ru/">flashboot.ru</a> and find the right pack for our controller.  Manufacturer: <i>Phison</i> .  You need to experiment with the version, because each pack contains its own features for each unique device.  You need to create a special CD-ROM partition on a flash drive so that it can support U3 or, in other words, work in 21 mode (Mode 21). <br><br>  Run the ParamEdt-F1-v1.0.20.2.exe utility located in the flashing package and immediately open the F1-1 tab and set everything as in the screenshot: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/92d/81e/520/92d81e52062367c4fdf39ecd2351cfca.jpg" alt="Setting the controller flashing parameters (Mode 21)"><br><br>  Go to the tab "F1-2" and in the CD-ROM field, select the CD image that will be autoload.  This can be any LiveCD operating system.  However, it is worth noting that in the future we will use a specially prepared .iso-image, the creation of which will deal with a little later.  Next, go to the ‚ÄúController‚Äù tab, where in the ‚ÄúIC Type‚Äù area (‚ÄúController type‚Äù) select the ‚ÄúPrevious vision‚Äù item, and in the ‚ÄúUsed MP Tools‚Äù area, select the ‚ÄúLast Version‚Äù item.  We save all settings to the boot.ini file by clicking on the ‚ÄúSave As‚Äù button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d43/3fe/900/d433fe900aa07da40233aeb54e3f34b9.jpg" alt="Select controller type"><br><br>  Run F1_90_v196_00.exe and select the newly created <i>boot.ini</i> .  Click "Start" and watch the process of testing and recording the image.  The process will end when the window is colored green (the drive LED will flicker). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/16c/385/1bb/16c3851bb7fd8a75d237dfc18d6d7033.png" alt="Completing the process of flashing the device"><br><br>  As a result of all the manipulations, we get a flash drive with two partitions: a CD-ROM and a drive of a standard type. <br><br><h5>  Chargeable </h5><br>  From the company Kingston released a patch for U3 flash drives, which is an unprotected RAR-archive that allows you to modify its contents at will.  This is precisely what the author of the above article took advantage of by modifying the autorun file of the protected disk in such a way that he directed the execution of the code first to a special handler and then to the LaunchU3 handler files.  The result of this research was the selection of files that should be present on the protected section of the flash drive.  For details, I recommend referring to the article <a href="http://www.xakep.ru/magazine/xa/126/058/1.asp">"Troyan in the brains of Flash</a> . <a href="http://www.xakep.ru/magazine/xa/126/058/1.asp">"</a> <br><br>  Before writing the files of the grabbing system using the methods described in the previous section to the protected part, transfer them to the .iso image with which you can work with a regular archiver.  Let us turn to the contents of the working part - it is to her (or rather the scripts) that control is transferred from the secure repository.  The basis of the workspace can be found in the archive. <br>  I made the system a bit easier by removing unnecessary functionality (for example, playing music) and deleting non-system files.  Everyone can ‚Äúsharpen‚Äù the contents of the working part to fit their needs (of course, do not forget about copyrights), since in this case, with any change, you will not have to re-flash the device. <br><br><h5>  Shot! </h5><br>  There is no doubt that this system works and does what, in fact, was required to prove.  As long as administrators do not leave their naivety - the data as poured, and will merge.  And this concept is just a proof of this theorem. <br><br>  Noteworthy is the fact that the leakage channel in this case is peripheral devices, in particular usb-carriers (I have not only flash drives, but also any other less "noticeable" devices onboard my microchips).  If you look at the reality in the eyes, in large organizations and organizations that monitor the security of their activities, in general, there is a ban on connecting external media (USB in the first place).  About autoloading while often forget or clog.  Often, there is still the possibility of connecting devices through other ports (LPT, COM) and interfaces (SATA, IDE).  With such an opportunity, this method has the right to exist. <br><br>  The ingenuity of the insider is not limited to the active scheme ‚Äúgot access to the PC -&gt; connected the device -&gt; received the information‚Äù, but develop the classics before the passive infrastructure penetration schemes, for example, ‚Äúleave the USB flash drive in the smoking room -&gt; initialization by the curious victim of the attack vector‚Äù. <br><br><h5>  Integrity control </h5><br>  In large enterprises, specialized software and hardware solutions are often used as a means of protecting information from unauthorized access and monitoring integrity.  On the Russian information security market, one of the most common means of protection is perhaps the Accord software and hardware complex. <br><br>  Once installed on the target computer, the controller is configured by the system administrator using specialized software that creates a software environment for each unique user.  Monitoring hardware integrity with a hardware controller completely prevents an intruder from connecting to peripheral devices or loading his operating system from mobile media.  However, devices of this class often lose all meaning when an attacker has physical access to the target PC on which they are installed. <br>  For example, the aforementioned ‚ÄúAccord‚Äù, which looks like a network card, is built into a computer in the same way.  At the controller configuration stage, the metal attachment to the PC case should be absent in order for the device to record to its memory area and save the settings.  Further, the administrator fastens the metal fastening to the controller with two bolts in order to close the contacts and thereby blocks the further reconfiguration of the controller. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7b/cd1/5ba/c7bcd15ba49e69602bf90c424acbc450.jpg" alt="Hardware and software complex controllers"><br><br>  It is actually enough for an insider to unscrew one bolt to get control to the target PC, bypassing the protection of the software and hardware complex and, alternatively, safely use a ‚Äúpoisonous‚Äù flash drive. <br><br>  The infrastructure in which information circulates is also imperfect to its leaks.  If in serious organizations they began to pay more attention to technical aspects, then the organizational and staffing of information security systems contains potential gaps in almost every single company.  Internal charters of companies, above all, are designed for "convenience of work", rather than to protect information.  Of course, these arguments are very relative, but they allow us to make a conclusion - the proper organization of intra-corporate codes and statutes is often one of the key steps in ensuring information security, along with disabling I / O ports on critical hardware. <br><br>  Distorting ‚Äúcritical‚Äù information is often more dangerous than its theft or loss.  First, the fact of changing the data can roll back the level of the company‚Äôs development, redefining the direction of its business as a whole, and, second, distortion is a difficult to follow procedure that can be avoided only by logging all user actions with ‚Äúcritical‚Äù data and archiving all documents . <br><br>  Even these few facts listed above allow us to conclude: only an integrated approach to ensuring information security allows you to stop attempts of information theft by authorized users. <br><br>  <i>Useful resources:</i> <br><br>  <a href="http://flashboot.ru/index.php%3Fname%3DFiles%26op%3Dview_file%26lid%3D131">http://flashboot.ru/index.php?name=Files&amp;op=view_file&amp;lid=131</a> is a ChipGenius utility that will help in determining the type of flash memory controller. <br>  <a href="http://www.xakep.ru/magazine/xa/126/058/1.asp">http://www.xakep.ru/magazine/xa/126/058/1.asp</a> - article "Trojan in the minds of Flash." <br>  <a href="">http://defec.ru/sites/default/files/System.rar</a> - source codes of the reviewed system (author: Vadim Danshin). <br>  <a href="http://www.xakep.ru/magazine/xa/122/016/1.asp">http://www.xakep.ru/magazine/xa/122/016/1.asp</a> - article "Insider's eyes." <br>  <a href="http://perimetrix.ru/">http://perimetrix.ru/</a> - the official resource of the company Perimetrix </div><p>Source: <a href="https://habr.com/ru/post/111512/">https://habr.com/ru/post/111512/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111507/index.html">Ways of visualization in multi-dimensional games</a></li>
<li><a href="../111508/index.html">Clever cache deletion (php 5 + Mongodb + memcached)</a></li>
<li><a href="../111509/index.html">Role information modeling in programming</a></li>
<li><a href="../111510/index.html">A simple implementation of RC4 in C #</a></li>
<li><a href="../111511/index.html">Android PC Game Controller</a></li>
<li><a href="../111513/index.html">Reverse engineering android applications</a></li>
<li><a href="../111514/index.html">Mt: C language for heavily loaded servers</a></li>
<li><a href="../111515/index.html">Corporate colors of sites and companies</a></li>
<li><a href="../111518/index.html">Where startups are hosted</a></li>
<li><a href="../111523/index.html">Note of a lazy typesetter on SCSS and Compass Framework</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>