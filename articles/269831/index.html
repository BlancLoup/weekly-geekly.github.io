<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>From 0 to 1. We understand with Redux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When Redux version 1.0 was released, I decided to spend some time on a series of stories about my experience with it. Recently, I had to choose the ‚Äúi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>From 0 to 1. We understand with Redux</h1><div class="post__text post__text-html js-mediator-article">  When Redux version 1.0 was released, I decided to spend some time on a series of stories about my experience with it.  Recently, I had to choose the ‚Äúimplementation of Flux‚Äù for a client application and am still happy to work with Redux. <br><br><h4>  Why redux? </h4><br>  Redux positions itself as a predictable state container for JavaScript applications.  Redaks is inspired by <a href="https://facebook.github.io/flux/">Flux</a> and <a href="http://elm-lang.org/">Elm</a> .  If you used Flux before, I advise you to read what Redux has in common with it in the " <a href="http://">Predecessors</a> " section of the new (excellent!) Documentation. <br><br>  Redux offers to think of an application as an initial state modifiable by a sequence of actions, which I consider to be a really good approach for complex web applications that opens up many possibilities. <br><a name="habracut"></a><br>  Of course, you can find more information about Redux, its architecture and the role of each component <a href="https://github.com/rajdee/redux-in-russian">in the documentation</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Create a friend list with React and Redux </h2><br>  Today we will focus on step-by-step building your first application using Redox and React: create a simple list of friends from scratch. <br><br>  You can find the finished code <a href="">here</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dec/409/354/dec40935478eb165dd4572d8ff4683e7.gif" alt="image"><br><br><h4>  For whom? </h4><br>  This article is written for people with no experience with Redux.  Development experience with Flux is also optional.  I will give references to documents when we are confronted with new concepts. <br><br><h5>  1. Installation </h5><br>  The author of Redux, Daniel Abramov, created a great build for development with React, Webpack, ES6 / 7 and React Hot Loader, which you can find <a href="https://github.com/gaearon/react-hot-boilerplate">here</a> . <br><br>  There are builds already installed with Redux, but I think it is important to understand the role of each library. <br><br><pre><code class="javascript hljs">$ git clone https:<span class="hljs-comment"><span class="hljs-comment">//github.com/gaearon/react-hot-boilerplate.git friendlist $ cd friendlist &amp;&amp; npm install $ npm start</span></span></code> </pre> <br>  Now you can open the application at <a href="http://localhost:3000/">http: // localhost: 3000</a> .  As you can see, ‚Äúhello world‚Äù is ready! <br><br><h5>  1.1 Add redux, react-redux and redux-devtools </h5><br>  We need to install three packages: <br><br><ul><li>  Redux: the library itself </li><li>  React-redux: bundle with React </li><li>  Redux-devtools: optional, provides some useful development tools. </li></ul><br><pre> <code class="javascript hljs">$ npm install --save redux@<span class="hljs-number"><span class="hljs-number">1.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>-rc react-redux $ npm install --save-dev redux-devtools</code> </pre><br><h5>  1.2 Directory structure </h5><br>  Although what we are going to do is quite simple, let's create a directory structure as for a real application. <br><br><pre> <code class="javascript hljs">+-- src | +-- actions | +-- index.js | +-- components | +-- index.js | +-- constants | +-- ActionTypes.js | +-- containers | +-- App.js | +-- FriendListApp.js | +-- reducers | +-- index.js | +-- friendlist.js | +-- utils | +-- index.js +-- index.html +-- app.css</code> </pre><br>  We will see in more detail the role of each of the directories when we create the application.  We moved App.js to the containers directory, so we need to set up the statement statement in index.js. <br><br><h5>  1.3 Connecting Redux </h5><br>  <b>Turn on devtools</b> <br><br>  We need to enable devtools only for the development environment, so we modify webpack.config.js like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* webpack.config.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> devFlagPlugin = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.DefinePlugin({ <span class="hljs-attr"><span class="hljs-attr">__DEV__</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(process.env.DEBUG || <span class="hljs-string"><span class="hljs-string">'false'</span></span>)) }); [...] plugins: [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.HotModuleReplacementPlugin(), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.NoErrorsPlugin(), devFlagPlugin ]</code> </pre><br>  When we start our application with <code>DEBUG=true npm start</code> , this will enable the <code>__DEV__</code> flag, which we can use in our application.  We can connect devtools as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/utils/devTools.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> initialCreateStore, compose } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> createStore = initialCreateStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (__DEV__) { createStore = compose( <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'redux-devtools'</span></span>).devTools(), <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'redux-devtools'</span></span>).persistState( <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.href.match(<span class="hljs-regexp"><span class="hljs-regexp">/[?&amp;]debug_session=([^&amp;]+)\b/</span></span>) ), createStore ); } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">renderDevTools</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">store</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (__DEV__) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> {DevTools, DebugPanel, LogMonitor} = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'redux-devtools/lib/react'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">DebugPanel</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">top</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">right</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bottom</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">DevTools</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">store</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{store}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">monitor</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{LogMonitor}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">DebugPanel</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ); } return null; }</span></span></code> </pre><br>  We do two things here.  We override createStore using the created function that allows us to apply multiple <a href="">store enhancers</a> , such as devTools.  We also enable the renderDevTools function, which renders the DebugPanel. <br><br>  <b>Application Container</b> <br><br>  Now we need to modify App.js to connect with redux.  For this we will use the react-redux Provider.  This will make our repository instance available to all components that reside in the Provider component.  No need to worry about a strange looking function, its purpose is to use the ‚Äúcontext‚Äù of the React function to create a repository accessible to all children (components). <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/containers/App.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { combineReducers } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Provider } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore, renderDevTools } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../utils/devTools'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FriendListApp <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./FriendListApp'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> reducers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../reducers'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducer = combineReducers(reducers); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = createStore(reducer);</code> </pre><br>  To create the repository, we use the <code>createStore</code> function, which we defined in the devTools file, as a map of all our reducers. <br><br>  ES6 syntax <code>import * as reducers</code> allows us to get an object in the form {key: fn (state, action), ...}.  This is great for setting arguments for <code>combineReducers</code> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div&gt; &lt;Provider store={store}&gt; {(</span></span></span><span class="hljs-function">) =&gt;</span></span> &lt;FriendListApp /&gt; } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/Provider&gt; {renderDevTools(store)} &lt;/</span></span>div&gt; ); } }</code> </pre><br>  In our application, App.js is an external wrapper for Redux and FriendListApp is the root component for our application.  After creating a simple 'Hello world' in FriendListApp.js, we can finally start our application with redux and devTools.  You should get it (no styles). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f4/f95/a36/5f4f95a36826095cb882a2b8cf26a5b6.png" alt="image"><br><br>  Although this is just the 'Hello world' application, we have Hot Reloading enabled, i.e.  You can modify the text and get an automatic update on the screen.  As you can see, the devtools on the right shows empty vaults.  Fill them in! <br><br><h5>  2. Create an application </h5><br>  Now that all the settings have been made, we can focus on the application itself. <br><br><h5>  2.1 Actions and action generators </h5><br>  <a href="http://">Actions</a> are a structure that passes data from your application to the repository.  By convention, actions must have a <code>type</code> string field that indicates the type of action being performed.  Defining this type in another module is a good practice, and it makes us think in advance about what we will do in our application. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/constants/ActionTypes.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ADD_FRIEND = <span class="hljs-string"><span class="hljs-string">'ADD_FRIEND'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> STAR_FRIEND = <span class="hljs-string"><span class="hljs-string">'STAR_FRIEND'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DELETE_FRIEND = <span class="hljs-string"><span class="hljs-string">'DELETE_FRIEND'</span></span>;</code> </pre><br>  As you can see, this is a very expressive way of defining the scope of our application, which will allow us to add friends, mark them as ‚Äúfavorites‚Äù or remove them from our list. <br><br>  <a href="">Action generators</a> are functions that create actions.  In Redux, action generators are pure functions, which makes them portable and easy to test, because  they have no side effects. <br><br>  We will put them in the action folder, but do not forget that these are different concepts. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/actions/FriendsActions.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> types <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../constants/ActionTypes'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addFriend</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: types.ADD_FRIEND, name }; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deleteFriend</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: types.DELETE_FRIEND, id }; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">starFriend</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: types.STAR_FRIEND, id }; }</code> </pre><br>  As you can see, the actions are pretty minimalistic.  To add an element, we report all properties (here we deal only with name), and for others we refer to id.  In a more complex application, we might have dealt with asynchronous actions, but this is a topic for another article ... <br><br><h5>  2.2 Reducers </h5><br>  <a href="">Reducers</a> are responsible for modifying application states.  These are pure functions with the following view <code>(previousState, action) =&gt; newState</code> .  It is very important to understand that you should <b>never</b> (never at all) change the initial state in the reducer.  Instead, you can create new objects based on the previousState properties.  Otherwise, this may have undesirable consequences.  Also, this is not the place to handle side effects, such as routing or asynchronous calls. <br><br>  We, for a start, define the state view of our application in <code>initialState</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/reducers/friends.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">friends</span></span>: [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>], <span class="hljs-attr"><span class="hljs-attr">friendsById</span></span>: { <span class="hljs-number"><span class="hljs-number">1</span></span>: { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Theodore Roosevelt'</span></span> }, <span class="hljs-number"><span class="hljs-number">2</span></span>: { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Abraham Lincoln'</span></span> }, <span class="hljs-number"><span class="hljs-number">3</span></span>: { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'George Washington'</span></span> } } };</code> </pre><br>  A state can be anything we want, we can just save an array of friends.  But this solution doesn‚Äôt scale well, so we‚Äôll use the id and map friends array.  About this you can read in <a href="https://github.com/gaearon/normalizr">normalizr</a> . <br><br>  Now we need to write a current reducer.  We will use the features of ES6 to set default arguments to handle cases where the state is undefined.  This will help you understand how to write a reducer, in this case I use a switch. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">friends</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = initialState, action</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> types.ADD_FRIEND: <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> newId = state.friends[state.friends.length<span class="hljs-number"><span class="hljs-number">-1</span></span>] + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">friends</span></span>: state.friends.concat(newId), <span class="hljs-attr"><span class="hljs-attr">friendsById</span></span>: { ...state.friendsById, [newId]: { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: newId, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: action.name } } } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state; } }</code> </pre><br>  If you are not familiar with the syntax of ES6 / 7, then it may be difficult to read.  Since  we need to return the new state of the object, usually using an <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/assign">Object.assign</a> or <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator">Spread operator</a> . <br><br>  What happens here: we define a new id.  In the real application, we may take it from the server, or at least make sure that it is unique.  Then we use <code>concat</code> to add this new id to our id list.  Concat will add a new array and will not change the original one. <br><br>  <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer">Computed properties</a> are convenient ES6 features that make it easier for us to create dynamic keys in friendsById objects with <code>[newId]</code> . <br><br>  As you can see, despite the syntax, which can be confusing at first, the logic is simple.  You set the state and get back the new state.  Important: do not change the previous state at any point of this process. <br><br>  Okay, let's go back and create reduers for the other two actions: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> omit <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'lodash/object/omit'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> assign <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'lodash/object/assign'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mapValues <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'lodash/object/mapValues'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> types.DELETE_FRIEND: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">friends</span></span>: state.friends.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function"> =&gt;</span></span> id !== action.id), <span class="hljs-attr"><span class="hljs-attr">friendsById</span></span>: omit(state.friendsById, action.id) } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> types.STAR_FRIEND: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">friendsById</span></span>: mapValues(state.friendsById, (friend) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> friend.id === action.id ? assign({}, friend, { <span class="hljs-attr"><span class="hljs-attr">starred</span></span>: !friend.starred }) : friend }) }</code> </pre><br>  I added lodash to simplify object management.  As usual, in these two examples, it is important not to change the previous state, so we use a function that returns a new object.  For example, instead of <code>delete state.friendsById[action.id]</code> , we use the <code>_.omit</code> function. <br><br>  You may also notice that the spread operator allows us to manipulate only those states that we need to change. <br><br>  Redux doesn't care how you store the data, so you can use <a href="https://facebook.github.io/immutable-js/">Immutable.js</a> . <br><br>  Now you can play with the repository bypassing the interface by manually calling dispatch in our App.js. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/containers/App.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { addFriend, deleteFriend, starFriend } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/FriendsActions'</span></span>; store.dispatch(addFriend(<span class="hljs-string"><span class="hljs-string">'Barack Obama'</span></span>)); store.dispatch(deleteFriend(<span class="hljs-number"><span class="hljs-number">1</span></span>)); store.dispatch(starFriend(<span class="hljs-number"><span class="hljs-number">4</span></span>));</code> </pre><br>  You will see actions in devTools, you can play with them in real time. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f64/4e0/4ba/f644e04ba7f51242dfa9c309017d4ebb.png" alt="image"><br><br><h5>  3. Create an interface </h5><br>  Since  This lesson is not about that, I missed the creation of React-components and focused only on Redax.  We have three simple components: <br><br><ul><li>  <b>FriendList</b> friends list <code><code><br></code></code> <ul><li>  friends: array friends array <br></li></ul><br><br>  <b>FriendListItem</b> element of one friend <code><code><br></code></code> <ul><li>  name: string friend's name </li><li>  <code>starred: boolean</code> shows an asterisk if a friend is marked as selected </li><li>  <code>starFriend: function</code> call that is triggered when a user clicks on asterisks </li><li>  <code>deleteFriend: function</code> call that is triggered when the user clicks on the trash </li></ul><br><br>  <b>AddFriendInput</b> field for entering new names <br><ul><li>  <code>addFriend: function</code> call that is triggered when you press enter </li></ul><br><br><br>  In Redux, it is considered good practice to make most of the components ‚Äústupid‚Äù as possible.  Those.  the fewer components associated with Redux, the better. <br><br>  Here <b>FriendListApp</b> will be the only ‚Äúsmart‚Äù component. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { bindActionCreators } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> FriendsActions <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/FriendsActions'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { FriendList, AddFriendInput } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components'</span></span>; @connect(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">friendlist</span></span>: state.friendlist })) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FriendListApp</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{</code> </pre><br>  This is part of the new syntax of ES7, called the decorator.  This is a convenient way to call a higher order function.  Will be equivalent to <code>connect(select)(FriendListApp);</code>  where <code>select</code> is a function that returns what we have done here. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> propTypes = { <span class="hljs-attr"><span class="hljs-attr">friendsById</span></span>: PropTypes.object.isRequired, <span class="hljs-attr"><span class="hljs-attr">dispatch</span></span>: PropTypes.func.isRequired } render () { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-attr"><span class="hljs-attr">friendlist</span></span>: { friendsById }, dispatch } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actions = bindActionCreators(FriendsActions, dispatch); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;div className={styles.friendListApp}&gt; &lt;h1&gt;The FriendList&lt;/h1&gt; &lt;AddFriendInput addFriend={actions.addFriend} /&gt; &lt;FriendList friends={friendsById} actions={actions} /&gt; &lt;/div&gt; ); } }</code> </pre><br>  We use <code>bindActionCreators</code> to wrap our action generators with a call to dispatch.  The goal is to pass action generators to our other components without providing a dispatch object (keeping them stupid). <br><br>  What happens next is the standard approach for React.  We will bind functions to the onClick, onChange, or onKeyDown properties to handle user actions. <br><br>  If you are interested in how to do this, you can view the <a href="">entire code</a> . <br><br>  Now you can feel the magic of the redux / react application.  As depicted in the GIF, you log all actions. <br>  It is more convenient to develop when you can perform some actions, find bugs, come back, correct them and repeat the already corrected sequence ... <br><br>  Transfer. <br>  Original article <a href="http://www.jchapron.com/2015/08/14/getting-started-with-redux/">http://www.jchapron.com/2015/08/14/getting-started-with-redux/</a> . </li></ul></div><p>Source: <a href="https://habr.com/ru/post/269831/">https://habr.com/ru/post/269831/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269821/index.html">Assembler Intel-4004 - for fun</a></li>
<li><a href="../269823/index.html">PostrgreSQL: Accelerated through intarray</a></li>
<li><a href="../269825/index.html">Perspective video formats. New direction</a></li>
<li><a href="../269827/index.html">AngularJS optimization: working examples</a></li>
<li><a href="../269829/index.html">10 relatively honest ways to hack mail</a></li>
<li><a href="../269833/index.html">Google is going to combine Chrome OS and Android</a></li>
<li><a href="../269835/index.html">Isolation of virtual servers in apache2 - ugidctl</a></li>
<li><a href="../269839/index.html">Organization of development and operation of large projects</a></li>
<li><a href="../269845/index.html">Intel distributes its libraries</a></li>
<li><a href="../269849/index.html">PostgreSQL 9.5: what's new? Part 3. GROUPING SETS, CUBE, ROLLUP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>