<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Homemade curtain drive</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will talk about the design of an automatic drive curtains installed in my balcony. There we grow flowers that are harmful direct sun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Homemade curtain drive</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/2fe/ce4/12c/2fece412cd94f64f8b9ebd78d117d816.png" alt="image" align="right"><br>  In this article I will talk about the design of an automatic drive curtains installed in my balcony.  There we grow flowers that are harmful direct sunlight.  In addition, in summer, if the balcony windows are closed, the air on the balcony quickly overheats in direct sunlight.  However, when there is no direct light, it is advisable to open the curtains - the shadow also does not contribute to the growth of colors.  Therefore, to maintain acceptable illumination on the balcony, I automated the operation of the curtains. <br><a name="habracut"></a><br><br><h4>  Mechanics </h4><br>  The curtains were originally on the balcony.  There are two of them, both of them are suspended on a metal cable, stretched under the ceiling from one wall of the balcony to the other.  It is clear that both curtains need to be moved at once, and due to the friction of the curtains on the cable (it is rather rough), the required force must be large enough.  In addition, sometimes on the way the curtains can meet obstacles, for example, a slightly open balcony window, which further increases the requirements for strength. <br>  Thus, the drive must be sufficiently powerful and reliable - there is often increased humidity on the balcony, a sufficiently large temperature difference is possible in winter and summer.  Therefore, the basis of the drive, I made an automobile window drive.  It has enough power, is capable of delivering large torque (a worm gear is built into it) and is very reliable. <br><br>  Diagram of the mechanical part of the drive is shown below: <br> <a href="http://img-fotki.yandex.ru/get/9328/14557097.1/0_cbbe5_e5e76e3a_orig"><img src="https://habrastorage.org/getpro/habr/post_images/bb6/f4f/f4e/bb6f4ff4e546153b8f2cb6e6de66d5eb.png"></a> <br>  Read more about the design.  A plastic roller with a groove, on which a coil of rope is wound, is fixed on the window lifter drive shaft (on the left in the diagram).  The drive is fixed on one of the walls of the balcony.  On the opposite wall is mounted the same roller, through which the rope is also forwarded. <br>  After that, the rope is stretched, so that the friction of the rope on the drive roller is enough to move the curtains.  The opposite ends of each curtain are attached to the rope so that when the motor rotates, the curtain moves apart or moves. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To test the drive, I made it a reduced model.  A power window drive and an independent roller secured on the board, pulled a rope between them, after which it was possible to check the operation of the electronics and measure the force developed by the drive. <br><br>  Photo of the drive itself on the layout: <br> <a href="http://img-fotki.yandex.ru/get/9150/14557097.1/0_cbbe6_f7b617be_orig"><img src="https://habrastorage.org/getpro/habr/post_images/1b4/fab/53d/1b4fab53d5270eb0608688487b89290d.jpg"></a> <br><br>  As can be seen from the photo, a fairly large thin plate is attached to the power window drive (I used textolite).  A metal corner is fastened to it with two holes through which the rope is passed.  It is needed so that the coil of the rope on the roller is not confused, for this hole in the corner made at different heights relative to the plate. <br>  To the right of the corner are the limit switches needed to stop the curtains to their extreme positions.  In order to mark these positions, two plastic tubes are put on the rope (only one of them is visible in the photo next to the bottom switch).  The tubes are arranged so that when the curtain reaches the extreme position, one of them presses the switch, while for reliable pressing a metal plate is attached next to each of the switches, which presses the tube to the switch. <br>  Three metal racks attached to the plate are needed to fix the drive cover. <br>  Both roll rollers are made from furniture wheels.  Using a drill and a file, in each of them you need to groove a groove, two turns of the rope should be laid in the groove of the drive roller.  The drive roller is mounted on the shaft due to the tension, and the hole in it had to be squandered to a square one, since the drive shaft is square. <br>  The drive is attached to the wall of the balcony with the help of suitable furniture corners (one of them is visible in the photo on the left).  There are enough mounting holes in the power window drive, so there are no problems with mounting. <br><br>  Type of drive already attached to the wall and covered with a lid: <br> <a href="http://img-fotki.yandex.ru/get/9322/14557097.1/0_cbbe7_cf2bbc03_orig"><img src="https://habrastorage.org/getpro/habr/post_images/37a/48d/90c/37a48d90c86425d4f49edbed9e81dc54.jpg"></a> <br><br>  To tighten the rope, use a special screw with a nut, to which the ends of the rope are attached: <br> <a href="http://img-fotki.yandex.ru/get/9808/14557097.1/0_cbbe8_958628f6_orig"><img src="https://habrastorage.org/getpro/habr/post_images/9c0/eb3/feb/9c0eb3febad453a582f57404677f8fec.jpg"></a> <br>  Also attached to it is the end of one of the curtains. <br><br><h4>  Electronics </h4><br>  All my electronics is divided into two parts - power and control.  The main task of the power unit is to provide power to the drive motor.  The power window drive can consume very high current.  To reduce this current, I reduced the drive supply voltage to 5 volts, but even so, the maximum current consumed by the motor can go up to 3A.  To provide such a current, I used a printer power supply capable of delivering a voltage of about 30V and a current of up to 0.7A, as well as a DC-DC converter of up to 5V.  By lowering the voltage DC-DC is quite capable of delivering the desired current. <br>  The motor power is controlled by a powerful relay designed to change the polarity of the signal, and a MOSFET that controls the voltage supply to the motor.  Through the use of MOSFET, you can adjust the rotational speed of the engine, but at the moment this feature is not used. <br>  Also on the power section are installed stabilizers designed to power the control electronics and the engine power control circuit.  The stabilizers are powered by a lower voltage power supply circuit, the voltage there does not exceed 12V. <br><div class="spoiler">  <b class="spoiler_title">Power circuit diagram</b> <div class="spoiler_text"> <a href="http://img-fotki.yandex.ru/get/9932/14557097.1/0_cbbec_3aff48dc_orig"><img src="https://habrastorage.org/getpro/habr/post_images/6e1/096/eec/6e1096eecd8d38298f5e6a9f77a94241.png"></a> <br></div></div><br>  The control electronics is represented by the STM8S microcontroller.  The controller performs quite a lot of functions - measuring the light, making decisions about starting the drive, controlling the position of the curtains by the limit switch, driving power control, driving the drive in manual mode - by remote control commands.  In addition, a radio module on the NRF24L01 and a 1-Wire bus, through which three temperature sensors are connected, are connected to the controller.  Using the radio module, you can control the drive and read the temperature values ‚Äã‚Äãat different points of the balcony and outside, but at the moment the second radio module is connected only to the prototype board, so I will not consider this functionality further. <br><br>  The used power supply unit from the printer has an input for transferring it to the Stand-by state.  I also use it, which reduces the energy consumption of the structure.  The program takes into account that the power supply goes into working mode with a certain delay, and after 30 seconds of inactivity of the drive, the power supply goes back to Stand-by mode. <br><br>  Indication of the drive operation - using a three-color LED (only blue and red diodes are used).  Blue lights up when voltage is applied to the motor, red starts flashing periodically in the presence of errors in the drive.  The number of flashes allows you to determine the error number. <br>  To sound some events (for example, when giving the command to close curtains already closed), the drive motor itself is used.  It receives a PWM signal with a small fill factor, as a result of which the engine beeps loudly enough. <br><div class="spoiler">  <b class="spoiler_title">Control part scheme</b> <div class="spoiler_text"> <a href="http://img-fotki.yandex.ru/get/9748/14557097.1/0_cbc3f_229e8ef_orig"><img src="https://habrastorage.org/getpro/habr/post_images/f84/8ed/e8e/f848ede8e2a0f126f9bca5e33bc928fe.png"></a> <br></div></div><br><br>  A photoresistor attached by a suction cup to the window is used as the light sensor.  Since the suction cup may fall off the window, there is a small button next to the photoresistor.  While the suction cup is holding onto the window, the button is pressed against the window.  If the sucker disappears, the drive automatically stops and the red diode starts flashing.  If the sensor is not connected to the connector, this is also detected by the controller. <br>  View of the light sensor: <br> <a href="http://img-fotki.yandex.ru/get/9748/14557097.1/0_cbc99_2124274f_orig"><img src="https://habrastorage.org/getpro/habr/post_images/771/e9a/f13/771e9af138fd49ec60f26ee24e33476a.jpg"></a> <br><br>  Since the sensor illumination can change dramatically - due to various outbreaks on the street, variable cloudiness, the data from the sensor must be filtered.  I have implemented the following processing algorithm: data from the sensor is digitized at a frequency of 10 Hz, and recorded in an array.  Every second, the value of this array is averaged (first of all, it is necessary for filtering noises and flashes).  Next, the resulting values ‚Äã‚Äãare added to another array of 600 elements, after reaching the end of the array, the recording begins from the beginning.  Also, this array is analyzed every second - the controller calculates what percentage of array elements is less than a certain threshold (as the illumination increases, the voltage at the photosensor output drops).  If the values ‚Äã‚Äãof more than 66% of the elements are less than the specified threshold, then it is considered that the illumination is large enough and the curtains can be closed.  Thus filtering of periodic changes in illumination.  In this case, the frequency of the drive is also limited - in automatic mode, the motor is switched on no more than once every ten minutes. <br><br>  As I mentioned above, it is possible to control the curtains with the remote control.  With the help of the remote, you can fully open and close the curtains, partially open them, start the drive according to the instantaneous light value. When operating from the console, there are no restrictions on the frequency of the drive. <br>  It is also possible to programmatically restart the controller. <br>  When moving the curtains, the controller monitors the state of the limit switches.  If after the start of movement the corresponding switch does not work within 20 seconds, the motor stops working.  To continue the drive after troubleshooting, just need to restart the controller. <br><br>  All electronics are installed in a standard plastic case: <br> <a href="http://img-fotki.yandex.ru/get/9162/14557097.1/0_cbc97_a16a6de4_orig"><img src="https://habrastorage.org/getpro/habr/post_images/8e5/a71/0b0/8e5a710b032e0b0360dce449ab4af52f.jpg"></a> <br>  One of the switches is needed to switch the electronics into automatic mode, the second allows you to completely turn off the power to the motor. <br>  Using the 3.5mm jack jacks, a light sensor, a TSOP for receiving data from the console, and external thermal sensors are connected to the device. <br>  The white cap is closed LED - so it can be seen from any angle. <br><br>  View assembled and installed in its place electronics unit: <br> <a href="http://img-fotki.yandex.ru/get/9108/14557097.1/0_cbc98_8913fba8_orig"><img src="https://habrastorage.org/getpro/habr/post_images/595/004/3f0/5950043f0805a0d2091103008dac7ea1.jpg"></a> <br><br>  Video of the drive (control from the console): <br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/1BK7_tKjZYY%3Ffeature%3Doembed&amp;xid=25657,15700021,15700186,15700191,15700253&amp;usg=ALkJrhiorTKY6BWtbLEgJ7U45gMUwxVm5A" frameborder="0" allowfullscreen=""></iframe><br><br>  <a href="">Source code of the controller program</a> </div><p>Source: <a href="https://habr.com/ru/post/211893/">https://habr.com/ru/post/211893/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../211879/index.html">Modification of UEFI BIOS, part two: useful modifications</a></li>
<li><a href="../211881/index.html">On solving an incomplete cubic equation</a></li>
<li><a href="../211885/index.html">Lightweight Tables or practical tips when designing a database ...</a></li>
<li><a href="../211889/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ95 (February 2 - 8, 2014)</a></li>
<li><a href="../211891/index.html">Unfulfilled hopes: what was planned and what happened in the program ‚ÄúSpace Shuttle‚Äù</a></li>
<li><a href="../211899/index.html">Features of MVP implementation for Windows Forms</a></li>
<li><a href="../211903/index.html">This is our world</a></li>
<li><a href="../211905/index.html">Use Audio API to create vocoder</a></li>
<li><a href="../211909/index.html">Forwarding a video card to a guest OS from a KVM hypervisor using VFIO technology</a></li>
<li><a href="../211911/index.html">Watch the Olympics using IPTV</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>