<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automated testing of a web application (MS Unit Testing Framework + Selenium WebDriver C #). Part 2.2: Selenium API wrapper - WebElement</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Hello! In the previous part, I described the main problems encountered when working with Selenium WebDriver, and also gave an example o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automated testing of a web application (MS Unit Testing Framework + Selenium WebDriver C #). Part 2.2: Selenium API wrapper - WebElement</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/9af/616/ceb/9af616ceb1d0813bbf7dd52ec7507e8a.png" alt="Selenium + C #"><br><h5>  Introduction </h5><br>  Hello!  In the previous part, I described the main problems encountered when working with Selenium WebDriver, and also gave an example of the Browser wrapper.  It seems it was not difficult, huh?) Well, let's go further.  We must deal with the remaining problems: <br><ul><li>  The description of an element occurs simultaneously with its search, i.  at the time of defining the element, it must exist in the browser.  It is often solved by writing a getter for each element.  This is expensive and bad in terms of performance. </li><li>  ISearchContext.FindElements accepts only one parameter of type OpenQA.Selenium.By, i.e.  we cannot search for several properties at once.  Usually, an element is searched for by the first criterion, and then screening begins for the rest. </li><li>  The absence of many seemingly obvious methods and properties.  For example: Exist, SetText, Select, SetCheck, InnerHtml, etc.  Instead, we have to be content with Click, SendKeys and Text. </li><li>  A lot of problems on different browsers, for example, on Firefox and Chrome, the element is clicked, but on IE - not.  You have to write special cases, "crutches" </li><li>  Performance.  Yes, the drivers do not work fast.  IE is ahead of the rest of the planet as usual - the search can take seconds, sometimes tens of seconds </li></ul><br>  In this part we will write the wrapper WebElement, which is entirely aimed at the user, i.e.  on autotest developers.  I admit that at the time of its writing my task was to create a "framework" that should be used by manual testing engineers for writing autotests.  Naturally it was assumed that they have a very modest knowledge of programming.  Therefore, it didn‚Äôt matter how many tons of code would be in the framework itself and how complex it would be inside.  The main thing is that from the outside it is as simple as three letters.  I warn you, there will be a lot of code and few pictures =) <a name="habracut"></a><br><br><h5>  Links </h5><br>  <a href="http://habrahabr.ru/post/178321/">Part 1: Introduction</a> <br>  <a href="http://habrahabr.ru/post/180047/">Part 2.1: Selenium API wrapper - Browser</a> <br>  <a href="http://habrahabr.ru/post/180357/">Part 2.2: Selenium API wrapper - WebElement</a> <br>  <a href="http://habrahabr.ru/post/180705/">Part 3: WebPages - describing pages</a> <br>  <a href="http://habrahabr.ru/post/181558/">Part 4: Finally writing tests</a> <br>  <a href="https://autotests.codeplex.com/">Framework Publishing</a> <br><br><h5>  Forward! </h5><br>  And so, I began to think about how it would be convenient for me, as a developer of autotests, to describe web elements.  Some developers solve the first problem by writing getters, it looks like this: <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IWebElement LoginEdit { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> WebDriver.FindElement(By.Id(<span class="hljs-string"><span class="hljs-string">"Login"</span></span>)); } }</code> </pre> <br>  If there are no unique properties, you will have to search for a set of properties using FindElements, and then filter out using GetAttribute and GetCssValue. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In WebDriver.Support there is such a feature as PageFactory and FindsBy attribute: <br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">FindsBy(How = How.LinkText, Using = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IWebElement HelpLink { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre><br>  The description of the properties is done through the attributes - not bad.  In addition, it is possible to cache the search (CacheLookup).  Cons of such a decision: <br><ul><li>  Still inconvenient, you have to write attributes and getter (well, can we do better?) </li><li>  PageFactory.InitElements does not work quite clearly, there are some nuances.  Carefully read the notes in the documentation.  I have to write my decision (I don‚Äôt want to call it a crutch). </li><li>  IWebElement still sticks out (besides it is often public), which means that every autotest developer will work with him as he pleases.  As a result, centralized refactoring of the code will be difficult. </li></ul><br>  In principle, many people stop at this.  We will go further.  I will formulate some profits that I would like to get at the output. <br><br><h5>  Idea and examples of use </h5><br>  The basic idea is to fill in the search criteria when describing an element, and perform the element search for any actions with it.  In addition, I want to implement caching search results for optimal test performance. <br><br>  It would also be very convenient to describe the elements in one line, but not to create and pass arrays of properties.  And here the pattern ‚Äúcall chain‚Äù comes in handy.  You also need to be able to search for items by entering parameters. <br><br>  Well, for complete happiness, you need to implement group methods over elements in the Linq style, for example, so that you can put all checkboxes according to some criterion or get an array of strings from an array of links. <br><br>  I will try to draw the scheme WebElement: <br><img src="https://habrastorage.org/getpro/habr/post_images/8fc/c68/667/8fcc68667ab865778abf00168d586246.png" alt="image"><br><br>  I note that all the same when testing a complex application, you may encounter situations where the element cannot be recognized with the help of Selenium WebDriver.  To solve this problem, the Browser.ExecuteJavaScript method is provided (see the previous article), i.e.  There is an opportunity to work with elements through JavaScript and jQuery. <br><br>  Before proceeding to the wrapper code, I will show examples of the description: <br><br>  Search by id: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> WebElement TestElement = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebElement().ById(<span class="hljs-string"><span class="hljs-string">"StartButton"</span></span>);</code> </pre><br>  Search by XPath: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> WebElement TestElement = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebElement().ByXPath(<span class="hljs-string"><span class="hljs-string">"//div[@class='Content']//tr[2]/td[2]"</span></span>);</code> </pre><br>  Search for the last item by class: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> WebElement TestElement = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebElement().ByClass(<span class="hljs-string"><span class="hljs-string">"UserAvatar"</span></span>).Last();</code> </pre><br>  Search by value entry in attribute: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> WebElement TestElement = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebElement().ByAttribute(TagAttributes.Href, <span class="hljs-string"><span class="hljs-string">"TagEdit"</span></span>, exactMatch: <span class="hljs-literal"><span class="hljs-literal">false</span></span>);</code> </pre><br>  Search by several parameters: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> WebElement TestElement = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebElement().ByClass(<span class="hljs-string"><span class="hljs-string">"TimePart"</span></span>).ByName(<span class="hljs-string"><span class="hljs-string">"Day"</span></span>).Index(<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br>  Search by tag and by text (entry): <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> WebElement TestElement = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebElement().ByTagName(TagNames.Link).ByText(<span class="hljs-string"><span class="hljs-string">"Hello"</span></span>, exactMach);</code> </pre><br>  Note that a description for a single item is not necessarily stored in TestElement.  If there are several elements, then when I try to click, an exception should occur (but in my implementation, the first element I get will be used).  We also have the ability to specify the index of an element using Index (...), either First () or Last (), so that one element is guaranteed to be found.  In addition, it is not necessary to perform an action with one element; you can perform it with all elements at once (see ForEach in the examples below). <br><br>  And now I will give examples of use: <br><br>  Element click <br><pre> <code class="cs hljs">TestElement.Click();</code> </pre><br>  Click on an item using Selenium WebDriver or using jQuery: <br><pre> <code class="cs hljs">TestElement.Click(useJQuery: <span class="hljs-literal"><span class="hljs-literal">true</span></span>);</code> </pre><br>  Getting text (for example, a link or text field): <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text = TestElement.Text;</code> </pre><br>  Text setting: <br><pre> <code class="cs hljs">TestElement.Text = <span class="hljs-string"><span class="hljs-string">"Hello!"</span></span>;</code> </pre><br>  Dragging an item onto another item: <br><pre> <code class="cs hljs">TestElement1.DragAndDrop(TestElement2);</code> </pre><br>  Sending event to item: <br><pre> <code class="cs hljs">TestElement.FireJQueryEvent(JavaScriptEvents.KeyUp);</code> </pre><br>  Expand all collapsed elements (click on the plus sign): <br><pre> <code class="cs hljs">TestElements.ForEach(i =&gt; i.Click());</code> </pre><br>  Getting the value of all headers: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> subjects = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebElement().ByClass(<span class="hljs-string"><span class="hljs-string">"Subject"</span></span>).Select(i =&gt; i.Text);</code> </pre><br><br>  The applied call chain pattern allows you to simultaneously define an element and perform an action: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebElement().ById(<span class="hljs-string"><span class="hljs-string">"Next"</span></span>).Click(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebElement().ById(<span class="hljs-string"><span class="hljs-string">"Help"</span></span>).Text;</code> </pre><br>  For the end user (the developer of autotests, which will describe the elements of the pages) looks very friendly, is not it?  Nothing sticks out.  Note that we do not even allow the developer to pass arbitrary attributes and tag names as parameters using the enum TagAttributes and TagNames.  This will save code from numerous magic strings. <br><br>  Unfortunately, to provide such an API, you have to write a lot of code.  The WebElement class (partial) will be divided into 5 parts: <br><ul><li>  WebElement.cs </li><li>  WebElementActions.cs </li><li>  WebElementByCriteria.cs </li><li>  WebElementExceptions.cs </li><li>  WebElementFilters.cs </li></ul><br>  As I warned in the previous article, there are no comments in the code, but I will try to comment on the main points under the copy-paste. <br><br><h5>  WebElement.cs </h5><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Autotests.Utilities.WebElement</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WebElement</span></span> : <span class="hljs-title"><span class="hljs-title">ICloneable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> By _firstSelector; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IList&lt;IWebElement&gt; _searchCache; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IWebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindSingle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TryFindSingle(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IWebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TryFindSingle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Contract.Ensures(Contract.Result&lt;IWebElement&gt;() != <span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FindSingleIWebElement(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (StaleElementReferenceException) { ClearSearchResultCache(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FindSingleIWebElement(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidSelectorException) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (WebDriverException) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (WebElementNotFoundException) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> WebElementNotFoundException; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IWebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindSingleIWebElement</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> elements = FindIWebElements(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!elements.Any()) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> WebElementNotFoundException; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> element = elements.Count() == <span class="hljs-number"><span class="hljs-number">1</span></span> ? elements.Single() : _index == <span class="hljs-number"><span class="hljs-number">-1</span></span> ? elements.Last() : elements.ElementAt(_index); <span class="hljs-comment"><span class="hljs-comment">// ReSharper disable UnusedVariable var elementAccess = element.Enabled; // ReSharper restore UnusedVariable return element; } private IList&lt;IWebElement&gt; FindIWebElements() { if (_searchCache != null) { return _searchCache; } Browser.WaitReadyState(); Browser.WaitAjax(); var resultEnumerable = Browser.FindElements(_firstSelector); try { resultEnumerable = FilterByVisibility(resultEnumerable).ToList(); resultEnumerable = FilterByTagNames(resultEnumerable).ToList(); resultEnumerable = FilterByText(resultEnumerable).ToList(); resultEnumerable = FilterByTagAttributes(resultEnumerable).ToList(); resultEnumerable = resultEnumerable.ToList(); } catch (Exception e) { Console.WriteLine(e); return new List&lt;IWebElement&gt;(); } var resultList = resultEnumerable.ToList(); return resultList; } private WebElementNotFoundException WebElementNotFoundException { get { CheckConnectionFailure(); return new WebElementNotFoundException(string.Format("Can't find single element with given search criteria: {0}.", SearchCriteriaToString())); } } private static void CheckConnectionFailure() { const string connectionFailure = "connectionFailure"; Contract.Assert(!Browser.PageSource.Contains(connectionFailure), "Connection can't be established."); } object ICloneable.Clone() { return Clone(); } public WebElement Clone() { return (WebElement)MemberwiseClone(); } } }</span></span></code> </pre><br>  Here the main attention should be paid to FindIWebElements, FindSingleIWebElement and exception handling in TryFindSingle.  In FindIWebElements, we wait for the browser to complete all its affairs (WaitReadyState and WaitAjax), search for items (FindElements), and then filter them according to various criteria.  Also in the code _searchCache appears, this is just our cache (the search is not automatically cached, the element needs to call the CacheSearchResult method). <br><br><h5>  WebElementActions.cs </h5><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Autotests.Utilities.WebElement</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> SelectTypes { ByValue, ByText } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WebElement</span></span> { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> Common properties public int Count { get { return FindIWebElements().Count; } } public bool Enabled { get { return FindSingle().Enabled; } } public bool Displayed { get { return FindSingle().Displayed; } } public bool Selected { get { return FindSingle().Selected; } } public string Text { set { var element = FindSingle(); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (element.TagName == EnumHelper.GetEnumDescription(TagNames.Input) || element.TagName == EnumHelper.GetEnumDescription(TagNames.TextArea)) { element.Clear(); } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { element.SendKeys(Keys.LeftControl + "a"); element.SendKeys(Keys.Delete); } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (string.IsNullOrEmpty(value)) return; Browser.ExecuteJavaScript(string.Format("arguments[0].value = \"{0}\";", value), element); Executor.Try(() =&gt; FireJQueryEvent(JavaScriptEvents.KeyUp)); } get { var element = FindSingle(); return !string.IsNullOrEmpty(element.Text) ? element.Text : element.GetAttribute(EnumHelper.GetEnumDescription(TagAttributes.Value)); } } public int TextInt { set { Text = value.ToString(CultureInfo.InvariantCulture); } get { return Text.ToInt(); } } public string InnerHtml { get { return Browser.ExecuteJavaScript("return arguments[0].innerHTML;", FindSingle()).ToString(); } } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> Common methods public bool Exists() { return FindIWebElements().Any(); } public bool Exists(TimeSpan timeSpan) { return Executor.SpinWait(Exists, timeSpan, TimeSpan.FromMilliseconds(200)); } public bool Exists(int seconds) { return Executor.SpinWait(Exists, TimeSpan.FromSeconds(seconds), TimeSpan.FromMilliseconds(200)); } public void Click(bool useJQuery = true) { var element = FindSingle(); Contract.Assert(element.Enabled); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (useJQuery &amp;&amp; element.TagName != EnumHelper.GetEnumDescription(TagNames.Link)) { FireJQueryEvent(element, JavaScriptEvents.Click); } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { try { element.Click(); } catch (InvalidOperationException e) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (e.Message.Contains("Element is not clickable")) { Thread.Sleep(2000); element.Click(); } } } } public void SendKeys(string keys) { FindSingle().SendKeys(keys); } public void SetCheck(bool value, bool useJQuery = true) { var element = FindSingle(); Contract.Assert(element.Enabled); const int tryCount = 10; for (var i = 0; i &lt; tryCount; i++) { element = FindSingle(); Set(value, useJQuery); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (element.Selected == value) { return; } } Contract.Assert(element.Selected == value); } public void Select(string optionValue) { SelectCommon(optionValue, SelectTypes.ByValue); } public void Select(int optionValue) { SelectCommon(optionValue.ToString(CultureInfo.InvariantCulture), SelectTypes.ByValue); } public void SelectByText(string optionText) { SelectCommon(optionText, SelectTypes.ByText); } public string GetAttribute(TagAttributes tagAttribute) { return FindSingle().GetAttribute(EnumHelper.GetEnumDescription(tagAttribute)); } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> Additional methods public void SwitchContext() { var element = FindSingle(); Browser.SwitchToFrame(element); } public void CacheSearchResult() { _searchCache = FindIWebElements(); } public void ClearSearchResultCache() { _searchCache = null; } public void DragAndDrop(WebElement destination) { var source = FindSingle(); var dest = destination.FindSingle(); Browser.DragAndDrop(source, dest); } public void FireJQueryEvent(JavaScriptEvents javaScriptEvent) { var element = FindSingle(); FireJQueryEvent(element, javaScriptEvent); } public void ForEach(Action&lt;WebElement&gt; action) { Contract.Requires(action != null); CacheSearchResult(); Enumerable.Range(0, Count).ToList().ForEach(i =&gt; action(ByIndex(i))); ClearSearchResultCache(); } public List&lt;T&gt; Select&lt;T&gt;(Func&lt;WebElement, T&gt; action) { Contract.Requires(action != null); var result = new List&lt;T&gt;(); ForEach(e =&gt; result.Add(action(e))); return result; } public List&lt;WebElement&gt; Where(Func&lt;WebElement, bool&gt; action) { Contract.Requires(action != null); var result = new List&lt;WebElement&gt;(); ForEach(e =&gt; { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (action(e)) result.Add(e); }); return result; } public WebElement Single(Func&lt;WebElement, bool&gt; action) { return Where(action).Single(); } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> Helpers private void Set(bool value, bool useJQuery = true) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (Selected ^ value) { Click(useJQuery); } } private void SelectCommon(string option, SelectTypes selectType) { Contract.Requires(!string.IsNullOrEmpty(option)); var element = FindSingle(); Contract.Assert(element.Enabled); switch (selectType) { case SelectTypes.ByValue: new SelectElement(element).SelectByValue(option); return; case SelectTypes.ByText: new SelectElement(element).SelectByText(option); return; default: throw new Exception(string.Format("Unknown select type: {0}.", selectType)); } } private void FireJQueryEvent(IWebElement element, JavaScriptEvents javaScriptEvent) { var eventName = EnumHelper.GetEnumDescription(javaScriptEvent); Browser.ExecuteJavaScript(string.Format("$(arguments[0]).{0}();", eventName), element); } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> } public enum JavaScriptEvents { [Description("keyup")] KeyUp, [Description("click")] Click } }</span></span></code> </pre><br>  Flat list of properties and methods defined for elements.  Some accept the useJQuery parameter, which tells the method that the action should be performed using jQuery (done for complex cases and the ability to perform an action in all three browsers).  In addition, JavaScript execution is much faster.  In some methods, ‚Äúcrutches‚Äù are arranged, for example, a cycle with tryCount in SetCheck.  Of course, for each product tested there will be its own special cases. <br><br><h5>  WebElementByCriteria.cs </h5><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Autotests.Utilities.WebElement</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SearchProperty</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> AttributeName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> AttributeValue { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ExactMatch { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TextSearchData</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Text { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ExactMatch { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WebElement</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IList&lt;SearchProperty&gt; _searchProperties = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;SearchProperty&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IList&lt;TagNames&gt; _searchTags = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;TagNames&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _searchHidden; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _index; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _xPath; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TextSearchData _textSearchData; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ByAttribute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TagAttributes tagAttribute, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> attributeValue, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> exactMatch = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ByAttribute(EnumHelper.GetEnumDescription(tagAttribute), attributeValue, exactMatch); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ByAttribute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TagAttributes tagAttribute, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> attributeValue, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> exactMatch = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ByAttribute(EnumHelper.GetEnumDescription(tagAttribute), attributeValue.ToString(), exactMatch); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ById</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> exactMatch = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ByAttribute(TagAttributes.Id, id, exactMatch); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ById</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> exactMatch = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ByAttribute(TagAttributes.Id, id.ToString(), exactMatch); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ByName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> exactMatch = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ByAttribute(TagAttributes.Name, name, exactMatch); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ByClass</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> className, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> exactMatch = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ByAttribute(TagAttributes.Class, className, exactMatch); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ByTagName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TagNames tagName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> selector = By.TagName(EnumHelper.GetEnumDescription(tagName)); _firstSelector = _firstSelector ?? selector; _searchTags.Add(tagName); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ByXPath</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> xPath</span></span></span><span class="hljs-function">)</span></span> { Contract.Assume(_firstSelector == <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"XPath can be only the first search criteria."</span></span>); _firstSelector = By.XPath(xPath); _xPath = xPath; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ByIndex</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index</span></span></span><span class="hljs-function">)</span></span> { _index = index; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">First</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _index = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Last</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _index = <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IncludeHidden</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _searchHidden = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ByText</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> text, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> exactMatch = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> selector = exactMatch ? By.XPath(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"//*[text()=\"{0}\"]"</span></span>, text)) : By.XPath(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"//*[contains(text(), \"{0}\")]"</span></span>, text)); _firstSelector = _firstSelector ?? selector; _textSearchData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TextSearchData { Text = text, ExactMatch = exactMatch }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> WebElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ByAttribute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tagAttribute, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> attributeValue, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> exactMatch = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xPath = exactMatch ? <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"//*[@{0}=\"{1}\"]"</span></span>, tagAttribute, attributeValue) : <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"//*[contains(@{0}, \"{1}\")]"</span></span>, tagAttribute, attributeValue); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> selector = By.XPath(xPath); _firstSelector = _firstSelector ?? selector; _searchProperties.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SearchProperty { AttributeName = tagAttribute, AttributeValue = attributeValue, ExactMatch = exactMatch }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SearchCriteriaToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = _searchProperties.Select(searchProperty =&gt; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0}: {1} ({2})"</span></span>, searchProperty.AttributeName, searchProperty.AttributeValue, searchProperty.ExactMatch ? <span class="hljs-string"><span class="hljs-string">"exact"</span></span> : <span class="hljs-string"><span class="hljs-string">"contains"</span></span>)).ToList(); result.AddRange(_searchTags.Select(searchTag =&gt; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"tag: {0}"</span></span>, searchTag))); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_xPath != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { result.Add(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"XPath: {0}"</span></span>, _xPath)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_textSearchData != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { result.Add(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"text: {0} ({1})"</span></span>, _textSearchData.Text, _textSearchData.ExactMatch ? <span class="hljs-string"><span class="hljs-string">"exact"</span></span> : <span class="hljs-string"><span class="hljs-string">"contains"</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Join(<span class="hljs-string"><span class="hljs-string">", "</span></span>, result); } } }</code> </pre><br>  Most of the functions are public, with their help, developers will describe the elements in their tests.  For almost all criteria, it is possible to search by occurrence (exactMatch).  As you can see, in the end, it all comes down to XPath (and I do not rule out that XPath is a bit slower than normal search, but I personally did not notice). <br><br><h5>  WebElementExceptions.cs </h5><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Autotests.Utilities.WebElement</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WebElementNotFoundException</span></span> : <span class="hljs-title"><span class="hljs-title">Exception</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WebElementNotFoundException</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message</span></span></span><span class="hljs-function">)</span></span> { } } }</code> </pre><br>  Well, there is just one custom exception. <br><br><h5>  WebElementFilters.cs </h5><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Autotests.Utilities.WebElement</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WebElement</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IEnumerable&lt;IWebElement&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FilterByVisibility</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;IWebElement&gt; result</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !_searchHidden ? result.Where(item =&gt; item.Displayed) : result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IEnumerable&lt;IWebElement&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FilterByTagNames</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;IWebElement&gt; elements</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _searchTags.Aggregate(elements, (current, tag) =&gt; current.Where(item =&gt; item.TagName == EnumHelper.GetEnumDescription(tag))); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IEnumerable&lt;IWebElement&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FilterByText</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;IWebElement&gt; result</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_textSearchData != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { result = _textSearchData.ExactMatch ? result.Where(item =&gt; item.Text == _textSearchData.Text) : result.Where(item =&gt; item.Text.Contains(_textSearchData.Text, StringComparison.InvariantCultureIgnoreCase)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IEnumerable&lt;IWebElement&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FilterByTagAttributes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;IWebElement&gt; elements</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _searchProperties.Aggregate(elements, FilterByTagAttribute); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> IEnumerable&lt;IWebElement&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FilterByTagAttribute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;IWebElement&gt; elements, SearchProperty searchProperty</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> searchProperty.ExactMatch ? elements.Where(item =&gt; item.GetAttribute(searchProperty.AttributeName) != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; item.GetAttribute(searchProperty.AttributeName).Equals(searchProperty.AttributeValue)) : elements.Where(item =&gt; item.GetAttribute(searchProperty.AttributeName) != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; item.GetAttribute(searchProperty.AttributeName).Contains(searchProperty.AttributeValue)); } } }</code> </pre><br>  Filters that are called in FindIWebElements (WebElement.cs file) to filter out items.  I note only that with large datasets Linq works much longer than for and foreach, so it may be worth rewriting this code using classic loops. <br><br><h5>  Conclusion </h5><br>  I will see in the article the mistakes made in the article, as well as any questions in the comments. <br><br><h5>  Remarks </h5><br>  - The article does not provide the code for enum, EnumHelper and Executor.  I will post the full code in the final part. <br>  - the string method used. Contains this extension: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Contains</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> source, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> target, StringComparison stringComparison</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> source.IndexOf(target, stringComparison) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/180357/">https://habr.com/ru/post/180357/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180337/index.html">"Star Trek" at the atomic level</a></li>
<li><a href="../180341/index.html">The beginning of Windows Phone 8 Development: lesson 4. Communication with services and data binding</a></li>
<li><a href="../180347/index.html">AvePoint DocAve for SharePoint</a></li>
<li><a href="../180353/index.html">Pseudo 3D: Animation of the rotation of planets and other ball-like objects</a></li>
<li><a href="../180355/index.html">ICANN approved the Yandex application for the top-level domain zone .yandex</a></li>
<li><a href="../180359/index.html">Is the demand for programmers growing and will it grow?</a></li>
<li><a href="../180365/index.html">Angularjs guidelines for beginners. Part 2</a></li>
<li><a href="../180367/index.html">Its cloud backend in one line of code. Overview BaaS platform "Backendless"</a></li>
<li><a href="../180373/index.html">Yahoo has confirmed the purchase of Tumblr for 1.1 billion dollars, Marissa Mayer has promised not to screw it up</a></li>
<li><a href="../180375/index.html">OData controllers in .NET MVC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>