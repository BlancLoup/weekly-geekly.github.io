<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Configuring public preview VNET Peering in Azure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As promised , after testing VNET peering, I post a small instruction how you can try it out in your Microsoft Azure subscription. 


 Register for the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Configuring public preview VNET Peering in Azure</h1><div class="post__text post__text-html js-mediator-article">  As <a href="https://habrahabr.ru/company/icl_services/blog/306794/">promised</a> , after testing VNET peering, I post a small instruction how you can try it out in your Microsoft Azure subscription. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/e83/357/a84/e83357a84f6d4d4fa94143d0a7beece5.png"></div><br><a name="habracut"></a><br><h3>  Register for the public preview </h3><br>  Since this feature is not yet part of the main service, you need to register your subscription to participate in the public preview for VNET peering.  This can be done using the following PowerShell command: <br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">Register-AzureRmProviderFeature</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-ProviderNameSpace</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Microsoft</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Network</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-FeatureName</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">AllowVnetPeering</span></span>:</code> </pre> <br>  The output of the command will show you that your subscription is now in the status " <b>Registering</b> ".  You will have to wait some time until this process is complete.  Check whether the registration is completed, you can: <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-AzureRmProviderFeature -ProviderNameSpace Microsoft.Network -FeatureName AllowVnetPeering</code> </pre><br>  As a result, you should see the status " <b>Registered</b> ": <br><div style="text-align:center;"><img src="https://habrastorage.org/files/add/a73/417/adda734176874546a66a4bae3521d8b5.PNG"></div><br><br>  If you have not yet registered and have not used the public preview of the network-related functions, then you will also need to register the network functions provider itself: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">Register-AzureRmResourceProvider</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-ProviderNamespace</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Microsoft</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Network</span></span></code> </pre><br><h3>  Configure VNET peering </h3><br>  When configuring VNET peering, it is important to understand that this connection needs to be configured on both sides (this is especially true for setting up peering between subscriptions).  We need a VNET object for which we want to configure the connection and the VNET id with which we want to associate it. <br><br>  An example of setting up peering between two networks in one subscription: <br><pre> <code class="hljs perl">$vnet1 = Get-AzureRmVirtualNetwork -ResourceGroupName TestResourceGroup -Name TestFirstVnet $vnet2 = Get-AzureRmVirtualNetwork -ResourceGroupName TestResourceGroup -Name TestSecondVnet Add-AzureRmVirtualNetworkPeering -Name LinkToSecondVnet -VirtualNetwork $vnet1 -RemoteVirtualNetworkId $vnet2.Id Add-AzureRmVirtualNetworkPeering -Name LinkToFirstVnet -VirtualNetwork $vnet2 -RemoteVirtualNetworkId $vnet1.Id</code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you look at the properties of these links with: <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-AzureRmVirtualNetworkPeering -ResourceGroupName TestResourceGroup -VirtualNetwork TestFirstVnet</code> </pre><br>  Then you will notice that you have some pretty interesting properties that you can, either set when creating a connection, or change later: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/97b/5c7/5ae/97b5c75aec9e43059928a0bfd713485b.JPG"></div><br><br>  <b>AllowVirtualNetworkAccess</b> <br>  Determines whether the address space of the remote VNET is included in the Virtual_network tag. <br>  <b>AllowForwardedTraffic</b> <br>  Defines the behavior (accept / reject) in relation to traffic coming through this connection, but not directly from the remote VNET. <br>  <b>AllowGatewayTransit</b> <br>  Allows the remote network to use the gateway on your network. <br>  <b>UseRemoteGateways</b> <br>  Allows you to use Gateway on a remote network.  AllowGatewayTransit must be enabled on the remote network.  Your network should not have its own gateway. <br><br>  As you can see, the July update made available a new and very interesting tool for organizing virtual networks in the Microsoft Azure cloud. </div><p>Source: <a href="https://habr.com/ru/post/307142/">https://habr.com/ru/post/307142/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307132/index.html">Development of BPEL business process stubs based on Oracle SOA Suite and Weblogic</a></li>
<li><a href="../307134/index.html">Un-FuckUp-able Development Protocol (UDP)</a></li>
<li><a href="../307136/index.html">About clouds and sensors: connecting Intel NUC and Genuino 101 to the IBM Watson IoT platform</a></li>
<li><a href="../307138/index.html">We charge Xcode</a></li>
<li><a href="../307140/index.html">Do it yourself web service with asynchronous queues and parallel execution</a></li>
<li><a href="../307148/index.html">We write microservice on KoaJS 2 in the style of ES2017. Part II: Minimalistic REST</a></li>
<li><a href="../307150/index.html">Solving the problem of binary classification in the XGboost machine learning package</a></li>
<li><a href="../307152/index.html">Install Sailfish OS on your smartphone (for example, Nexus 5)</a></li>
<li><a href="../307154/index.html">Machine learning with TMVA. Reader models</a></li>
<li><a href="../307156/index.html">NIST: SMS can not be used as an authentication tool.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>