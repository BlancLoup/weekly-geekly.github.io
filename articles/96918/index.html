<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mozilla Foundation Product Update</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The free Mozilla Foundation Windows-based e-mail and Internet solutions have long been used in our organization ‚Äî functional, convenient, and relative...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mozilla Foundation Product Update</h1><div class="post__text post__text-html js-mediator-article">  The free Mozilla Foundation Windows-based e-mail and Internet solutions have long been used in our organization ‚Äî functional, convenient, and relatively stable. <br>  And everything would be fine - but sooner or later the question arises about the automation of updating these products. <br>  After surfacing the internet, it was possible to find out that there are several interesting ways to update. <br>  One of them - creating your own update server - is generally a good way for everyone, but it wasn‚Äôt possible to figure it out right off the bat (if someone has the experience, share!).  Available by <a href="https://developer.mozilla.org/en/Setting_up_an_update_server">reference</a> . <br>  I will tell you about another way. <br><a name="habracut"></a><br>  So, we assume that we have a WIN-domain (we do not need group policies in this case) and we are going to update them on machines in the domain.  For definiteness, choose Firefox (in the case of Thunderbird everything is identical). <br>  Initially, we need to go to the update site and download the latest update archive, for example, for version 3.6 you can download it <a href="">here</a> .  The site has two types of updates - incremental and full.  We will use the full, because  Incremental means that we have a previous version of the program (which is not the case in general). <br>  Next, what we have to do is to rename this file to update.mar, create the folder \\ pdc \ netlogon \ packages \ firefox, where pdc is our domain controller.  You will also need to create a installuser user with domain administrator authority. <br>  Unfortunately, my method has a significant disadvantage - the password of this user will be stored in clear text in the .js file code. <br><br>  The contents of the \\ pdc \ netlogon \ packages \ firefox folder will be as follows: <br>  update.bat <br>  psexec.exe <br>  updater.exe <br>  updater.ini <br>  update.mar <br>  psexec.reg <br><br>  So, in order <br>  <b>update.bat</b> : <br><pre><code class="hljs perl"><span class="hljs-keyword"><span class="hljs-keyword">mkdir</span></span> <span class="hljs-string"><span class="hljs-string">"%PROGRAMFILES%\Mozilla Firefox"</span></span> &gt;&gt;nul <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span> cd <span class="hljs-string"><span class="hljs-string">"%PROGRAMFILES%\Mozilla Firefox"</span></span> %1\firefox-update\updater.exe %1\firefox-update <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>psexec.exe</b> is the one psexec.  You can take it on the <a href="http://sysinternals.com/">official website</a> . <br><br>  <b>updater.exe</b> - take in the folder with Firefox (I used version 1.8.1) <br><br>  <b>updater.ini</b> is a small config for updater.exe: <br> <code>; This file is in the UTF-8 encoding <br> [Strings] <br> Title= Firefox <br> Info=  Firefox... <br> [PostUpdateWin] <br> ExeRelPath=uninstall\helper.exe <br> ExeArg=/PostUpdate <br></code> <br><br>  <b>update.mar</b> is the update file. <br><br>  <b>psexec.reg</b> : <br><pre> <code class="hljs tex">REGEDIT4 [HKEY_CURRENT_USER<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Software</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SysInternals</span></span></span></span>] [HKEY_CURRENT_USER<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Software</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SysInternals</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PsExec</span></span></span></span>] "EulaAccepted"=dword:00000001</code> </pre><br><br>  Next, we put in the netlogon setup_firefox_36.js <b>file</b> : <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> WshShell = WScript.CreateObject(<span class="hljs-string"><span class="hljs-string">"WScript.Shell"</span></span>); FSO = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActiveXObject(<span class="hljs-string"><span class="hljs-string">"Scripting.FileSystemObject"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   ,  , //      Firefox var WshProcEnv = WshShell.Environment("PROCESS"); var strTEMP = WshProcEnv("TEMP"); var un = WshProcEnv("USERNAME"); var compname = WshProcEnv("COMPUTERNAME"); var pf = WshProcEnv("PROGRAMFILES"); var firefox_path = pf+"\\Mozilla Firefox"; // ,  IP   //    var pdc = "192.168.1.200"; var domain = "OUR_DOMAIN"; //    -  .   //   ,     -    //       var version = /3\.6\./; //     //      users = new Array(); // users.push('katsy'); comps = new Array(); // comps.push('bdc'); //      -  for (i = 0; i &lt; users.length; i++) if (users[i].toLowerCase() == un.toLowerCase()) WScript.Quit(); for (i = 0; i &lt; comps.length; i++) if (comps[i].toLowerCase() == compname.toLowerCase()) WScript.Quit(); //      try { //   application.ini //   ,    &lt;3 var re = new RegExp("^Version=(.*)$","i"); ForReading = 1; if (FSO.FileExists(firefox_path+"\\application.ini")) { f = FSO.OpenTextFile(firefox_path+"\\application.ini", ForReading); while (!f.AtEndOfStream) { str = f.ReadLine(); if (re.exec(str)) { if (version.exec(RegExp.$1)) WScript.Quit(); } } f.Close(); } } catch(e) {} //   firefox-update,   EULA  psexec -   psexec    //        try { FSO.CreateFolder(strTEMP+"\\firefox-update") } catch(e) {} // for EULA-accept import WshShell.Run("regedit -s \\\\"+pdc+"\\netlogon\\packages\\firefox\\psexec.reg",0,true); WshShell.Run("cmd /C copy /Y \\\\"+pdc+"\\netlogon\\packages\\firefox\\psexec.exe "+strTEMP+"\\firefox-update",0,true); WshShell.Run("cmd /C copy /Y \\\\"+pdc+"\\netlogon\\packages\\firefox\\updater.* "+strTEMP+"\\firefox-update",0,true); WshShell.Run("cmd /C copy /Y \\\\"+pdc+"\\netlogon\\packages\\firefox\\update.* "+strTEMP+"\\firefox-update",0,true); //   ,      ,  Mozilla FireFox   // if (FSO.FolderExists(firefox_path)) { WshShell.CurrentDirectory = strTEMP+"\\firefox-update"; WshShell.Run("psexec.exe -u "+domain+"\\installuser -p  cmd /C "+strTEMP+"\\firefox-update\\update.bat "+strTEMP,0,false); }</span></span></code> </pre><br><br>  And the last thing to do is to write a line in the login script for users: <br>  start wscript \\ pdc \ netlogon \ setup_firefox_36.js </div><p>Source: <a href="https://habr.com/ru/post/96918/">https://habr.com/ru/post/96918/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../96908/index.html">Invisible mouse</a></li>
<li><a href="../96910/index.html">iDharmaClock - clock in the style of the Dharma Initiative for iPhone</a></li>
<li><a href="../96913/index.html">Which distribution do you prefer and for what purpose?</a></li>
<li><a href="../96914/index.html">How Macsolutions my laptop repaired. Part Three, Final</a></li>
<li><a href="../96917/index.html">We get traffic and minimize its cost on the example of browser MMO</a></li>
<li><a href="../96919/index.html">Get rid of stress for a few days in the style of LifeHack</a></li>
<li><a href="../96920/index.html">Automatic copying of CD / DVD to HDD</a></li>
<li><a href="../96932/index.html">Copy of Xperia X10 or Chinese SonyEricsson</a></li>
<li><a href="../96933/index.html">Automating the FreeBSD8 Apache2 + Mysql5 Web Server Part 1</a></li>
<li><a href="../96934/index.html">Check if browser is enabled for caching</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>