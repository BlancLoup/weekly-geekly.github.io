<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Measuring the current-voltage characteristics of the transistor using a Cypress microcontroller</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Step 1: Source Materials 
 From the raw materials at home were: 
 1. Cypress ‚ÄúCY8C29466 - 24PXI" microcontroller and ‚ÄúPSoCEVAL1 RevE‚Äù debug board 

 2...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Measuring the current-voltage characteristics of the transistor using a Cypress microcontroller</h1><div class="post__text post__text-html js-mediator-article"><h4>  Step 1: Source Materials </h4><br>  From the raw materials at home were: <br>  1. Cypress ‚ÄúCY8C29466 - 24PXI" microcontroller and ‚ÄúPSoCEVAL1 RevE‚Äù debug board <br><img src="https://habrastorage.org/getpro/habr/post_images/c65/0f4/038/c650f403825400ac855a9ee1cc709750.jpg" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/73e/4a1/3ba/73e4a13bac53d0fd3aa1cf71fb02ab5c.jpg" alt="image"><br>  2. PSoC MiniProg programmer and USB-miniUSB wire for it <br><img src="https://habrastorage.org/getpro/habr/post_images/39b/3d2/eea/39b3d2eea0eb5b4e4bb1cc48c317e93c.jpg" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/27d/bb8/a84/27dbb8a841f796b236eb44c30982892a.jpg" alt="image"><br>  3. Multimeter and LCD display (very useful when debugging) <br><img src="https://habrastorage.org/getpro/habr/post_images/ddd/ac2/23f/dddac223f3a3d224bc17856146ae1196.jpg" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/2fa/873/258/2fa87325834f5e8a7c07bdc160082981.jpg" alt="image"><br><a name="habracut"></a><br><h4>  Step 2: Wiring Diagram </h4><br>  First of all it was necessary to estimate the switching circuit.  I recall that the task is to measure the current-voltage characteristics of the field-effect transistor.  Namely, the dependence of ICI (drain-source current) on the voltage UZ (at the gate).  Since usually analog-digital converters are tied to voltage measurements, a circuit was needed to indirectly measure the current from a known voltage.  And after a small discussion, the following scheme appeared. <br><img src="https://habrastorage.org/getpro/habr/post_images/12a/c20/926/12ac20926108774992ae38d396e5af4b.jpg" alt="image" align="left">  Where: <br>  Vdd - supply voltage of the microcontroller and board <br>  R1 - workload <br>  Q1 - field effect transistor <br>  DAC and ADC are digital-analog and analog-digital converters, respectively. <br><br><h4>  Step 3: Transistor Selection </h4><br>  It was found in the manuals that the board voltage is Vdd = 5V, and the working range of the digital-to-analog converter ranges from about 0 to 5V.  Based on this data, a transistor (Q1) and operating resistances (R1) were selected.  The choice fell on the KP103M and a resistance of 50 Ohms. <br><br><h5>  Technical characteristics of the KP103M transistor: </h5><br>  ‚Ä¢ Transistor structure: with pn-junction and p-channel; <br>  ‚Ä¢  max - Dissipated power drain-source: 120 mW; <br>  ‚Ä¢ Uzi from - transistor cutoff voltage - voltage between the gate and the source: 2.8 ... 7 V; <br>  ‚Ä¢ Usi max - Maximum drain-source voltage: 10 V; <br>  ‚Ä¢ IC nach - Initial drain current: 3 ... 12 mA; <br>  ‚Ä¢ S - The steepness of the characteristics: more than 1.3 ... 4.4 mA / V; <br>  ‚Ä¢ 11 - Transistor input capacitance - capacitance between the gate and the source: 20 pF; <br>  ‚Ä¢ 12 - Feedback capacitance in the circuit with a common source in case of a short circuit at the AC input: 8 pF; <br>  ‚Ä¢ Ksh - Transistor noise figure: no more than 3 dB at 1 kHz. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Half a day on the market and the following things were bought. <br>  1. Field-effect transistor KP103M and operating resistance 50 Ohm <br><img src="https://habrastorage.org/getpro/habr/post_images/2b2/b11/478/2b2b1147852a6ec2abc009624603d0c9.jpg" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/b5e/ec5/da1/b5eec5da163afdf3a92c520cf55ad9ac.jpg" alt="image"><br>  2. RS 232 cable, useful for transporting data to a computer (I wanted to buy RS232-USB but the price played its role, and even was afraid to work with virtual com ports) <br><img src="https://habrastorage.org/getpro/habr/post_images/844/6a7/eab/8446a7eab8f030bf1405eca7e309f114.jpg" alt="image"><br><br><h4>  Step 4: Programming the microcontroller. </h4><br><h5>  0. Introduction </h5><br>  Programming in the PSoC Designer 5.3 environment is carried out at a sufficiently high level (although it is impossible to call it with programming, this is something between programming and modeling).  The main environment working space is a chip layout.  On which are the free blocks (and if you have already added something that is not free) to install the modules of the microcontroller.  These can be various DACs, ADCs, display controllers, data transceivers, programmable amplifiers, timers, counters, temperature sensors (meaning built-in microchips), user blocks, and so on.  Digital modules are located in the upper part of the workspace, analogue in the lower.  The working area also includes tires, on which the inputs and outputs of analog and digital modules are hung, which in turn are connected to ports (the so-called microcontroller legs).  By simply pulling and clicking the mouse, you can install any of the modules and tie it to the ports, provided that there is a free position for it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/11c/354/418/11c3544183e0c783ebdc24bacd6c5dbe.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/8a7/448/756/8a744875605e2af28e5c17ffec36009e.png" alt="image" align="right"><br>  In the main working tab there is also an important panel ‚ÄúGlobal resources‚Äù.  In which, the main performance characteristics of the chip are located, such as: operating frequency, power mode, some global variable frequency dividers, necessary for the operation of some digital and analog blocks. <br>  Red highlighted the properties that have been changed in the course of the work.  Ref Mux is the voltage range for analog chip units.  VC are the system dividers of the clock frequency of the microcontroller processor; they are needed for synchronized operation of digital blocks and D / A converter blocks. <br><br><h5>  1. DAC </h5><br>  The first step was to install a DAC8 module on the microcontroller (which means 8bit Digital-to-Analog Converter), which means an 8-bit digital-to-analog converter.  The bit width of 8m bits means that the smallest unit of voltage change will be (Vmax-Vmin) / 256, for our case 5V / 256.  Accuracy to measure is more than enough.  The output of the DAC was mapped to the AnalogOutBus_0 bus.  And the bus itself is displayed on one of the free ports of the controller, my DAC is displayed on Port_0_3, alas, it is not visible in the screenshot, but check my word, it is there.  Thus, it turned out about the following picture. <br><img src="https://habrastorage.org/getpro/habr/post_images/2f6/086/2b6/2f60862b695057e2d084d6838d687427.png" alt="image" align="left"><br>  Next, it was necessary to write a small code to run the microcontroller and DAC'p.  An important note is that the device supports C and Assembly. <br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;m8c.h&gt; // part specific constants and macros #include "PSoCAPI.h" // PSoC API definitions for all User Modules void main(void) { DAC8_1_Start(DAC8_1_HIGHPOWER); M8C_EnableGInt ; // Uncomment this line to enable Global Interrupts while(1) { DAC8_1_WriteBlind(255);//  0  255    8       0   5 } }</span></span></span></span></code> </pre> <br><pre>  We collect fee in accordance with the scheme given in step 2. </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/18b/1e2/338/18b1e23387527b120588214cd1e42458.jpg" alt="image" align="right"><br>  We flash the microcontroller.  Debug tester, with different values ‚Äã‚Äãof the function DAC8_1_WriteBlind ();  if the indicators are adequate and linearly dependent, go ahead and deal with the DAC unit. <br><br><h5>  2. ADC </h5><br>  Not to say that DAC'om things went much easier.  To implement it, it took as many as 3 microcontroller modules.  First, it is a PGA (Programmable Gain Amplifier), a programmable opamp.  It is needed not so much for amplification (to be honest, the gain in it is set to 1, and besides, it is not capable of delivering voltages higher than the supply voltage), but rather to increase the input resistance.  Whatever the value of the current in the circuit does not affect the accuracy of the measurement.  One entrance, which was plugged into the ground, and the second hung on port_0_1.  The second module itself became the DAC itself, the full name of the element ADCINC12.  The bit width, which is 12bit, is 4096 quantization steps on the input signal.  One of the inputs of the DAC'pa was connected to the PGA output, the second is connected to the ground by default.  It should also be noted that all these things (including DAC'ka) for synchronous work, should sit on a single clock generator, or to be more precise, a processor clock divider.  Analog blocks are planted on the VC1 clock divider equal to SysClock / 8 (24 MHz / 8).  All the above has approximately the following form. <br><img src="https://habrastorage.org/getpro/habr/post_images/e14/a25/1e1/e14a251e1b66e733365eb4a1b26e3c7b.png" alt="image"><br>  The last module, about which they haven't said anything yet, is the LCD module, an interface for working with the display.  And we need it to debug the work of ADC and PGA, since we cannot check the correctness of the operation of these modules from outside.  Fortunately, it does not occupy space on the working scheme, and from the settings it has only one parameter, LCDPort, we need Port_2, which is already on our debug board. <br>  In case I missed something, I‚Äôll give screenshots of the settings of the above described blocks. <br><img src="https://habrastorage.org/getpro/habr/post_images/e45/deb/4e0/e45deb4e02a8562a9241c75b5e4cb7be.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/7f7/acf/02e/7f7acf02e5843daa9694222c3c738108.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/c5e/2a2/648/c5e2a2648261bb1468cfa187e2045f5d.png" alt="image"><br>  Modifying the code: <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;m8c.h&gt; // part specific constants and macros #include "PSoCAPI.h" // PSoC API definitions for all User Modules void main(void) { DAC8_1_Start(DAC8_1_HIGHPOWER); PGA_1_Start(PGA_1_HIGHPOWER); ADCINC12_1_Start(ADCINC12_1_HIGHPOWER); ADCINC12_1_GetSamples(0); //   -  LCD_Start(); LCD_Position(1,0); //   M8C_EnableGInt ; // Uncomment this line to enable Global Interrupts while(1) { DAC8_1_WriteBlind(255);//  0  255    8       0   5 result = ADCINC12_1_iGetData() + 2048; ADCINC12_1_ClearFlag(); LCD_Position(1,0); LCD_PrHexInt(result); } }</span></span></span></span></code> </pre><br>  The screen has numbers in the range from 0 to 0x0FFF, depending on the applied voltage. Hurray!  Everything is working fine.  Moving on. <br><img src="https://habrastorage.org/getpro/habr/post_images/d02/0d0/e8c/d020d0e8c77edde79a221c1e9688e15f.jpg" alt="image"><br><br><h5>  3. UART </h5><br>  UART is a data transfer protocol.  Best known for RS232 interface.  It was necessary to pull the UART block onto the circuit.  The UART module occupies two digital blocks, one for the RX receiving line, the second for the TX, the transmitting line.  The outputs of these units were connected to specific ports specifically designated for data transport.  Port_2_7 for exit, Port_1_6 for login.  The UART device should operate on the VC3 = SysClock / 156 clock generator, thereby allowing data to be transmitted with a bit rate of 19200. The UART_1_PutSHexInt () function will be used for transmission. <br>  Finally, the final touch was a change from the infinite loop to the while (i &lt;255).  To be able to vary the values ‚Äã‚Äãsupplied to the DAC and each time remove the new voltage. <br>  The final version of the code for the microcontroller looks like this: <br><div class="spoiler">  <b class="spoiler_title">The final version of the code</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//---------------------------------------------------------------------------- // C main line //---------------------------------------------------------------------------- #include &lt;m8c.h&gt; // part specific constants and macros #include "PSoCAPI.h" // PSoC API definitions for all User Modules int result; int i; void main(void) { DAC8_1_Start(DAC8_1_HIGHPOWER); PGA_1_Start(PGA_1_HIGHPOWER); ADCINC12_1_Start(ADCINC12_1_HIGHPOWER); ADCINC12_1_GetSamples(0); LCD_Start(); LCD_Position(1,0); UART_1_Start(UART_PARITY_NONE); M8C_EnableGInt ; // Uncomment this line to enable Global Interrupts while(i&lt;255) { DAC8_1_WriteBlind(i); if(ADCINC12_1_fIsDataAvailable() != 0) { result = ADCINC12_1_iGetData() + 2048; ADCINC12_1_ClearFlag(); LCD_Position(1,0); LCD_PrHexInt(result); UART_1_PutSHexInt(result); /* Print result to UART */ i++; } } }</span></span></code> </pre></div></div><br><habracut><br><h4>  Step 5: Interception of the COM port </h4><br><img src="http://habrastorage.org/storage3/e76/5a4/61f/e765a461f1b0c143546a17fbd3483398.png" alt="image" align="right"><br>  How to check whether data is actually coming to the computer?  First you need to check whether the com-port is turned on and whether your computer is running.  For windows 7 -&gt; the right button My Computer -&gt; Device Manager -&gt; and we should see the picture to the right of the text.  If this does not happen, the com port is most likely disabled, and it should be enabled in the BIOS. <br><br>  Now you need to configure it. <br><br>  We set the fields <br>  Bit per second - 19200 <br>  Data bits - 8 <br>  Parity - None <br>  Stop bits - 1 <br>  Flow control - none <br><br><img src="http://habrastorage.org/storage3/e6a/f5a/012/e6af5a012b802b51070b8f1e30e4bde4.png" alt="image"><br><br>  Download the program HyperTerminal or something similar, maybe even have something standard.  Run it.  Choose our port COM1. <br>  And we get crazy byte sequences. <br><img src="http://habrastorage.org/storage3/6a1/18c/830/6a118c8309dcd5273734491c7d6dc7ae.png" alt="image"><br>  The transmitter works. <br><br><h4>  Step 6: C # client </h4><br>  Run any VisualStudio C #.  Create a console application.  Add there two classes.  One to work with Com is another with Excel (I called them that way).  Add a library to work with Excel (right-click References -&gt; Add Reference ... -&gt; Extensions -&gt; Microsoft.Office.Interop.Excel) to the project.  All conversions from Hex to int and from int to current will be done in Program.cs. <br><div class="spoiler">  <b class="spoiler_title">Program.cs</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> List&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConvInToAmp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; input</span></span></span><span class="hljs-function">)</span></span> { List&lt;<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>&gt; converted = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> stap = <span class="hljs-number"><span class="hljs-number">0.00116822</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Vdd = <span class="hljs-number"><span class="hljs-number">4.8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> R = <span class="hljs-number"><span class="hljs-number">50</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">255</span></span>; i++) { converted.Add(input[i] * stap); converted[i] = Vdd - converted[i]; converted[i] = converted[i] / R; <span class="hljs-comment"><span class="hljs-comment">//Console.WriteLine(converted[i]); } return converted; } public static List&lt;double&gt; CreateVolt() { List&lt;double&gt; volts = new List&lt;double&gt;(); double stap = 0.0188235294117647; for (int i = 0; i &lt; 255; i++) { volts.Add(i*stap); } return volts; } static void Main(string[] args) { Com port = new Com(); port.Strart(); while (!port.Full()) ; port.Stop(); Console.WriteLine("Data transmission complite"); List&lt;int&gt; input = port.GetData(); List&lt;double&gt; converted = ConvInToAmp(input); Console.WriteLine("Conversin complite"); Excel exel = new Excel(CreateVolt(), converted); Console.Read(); } }</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Com.cs</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Com</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SerialPort port = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerialPort(<span class="hljs-string"><span class="hljs-string">"COM1"</span></span>, <span class="hljs-number"><span class="hljs-number">19200</span></span>, Parity.None, <span class="hljs-number"><span class="hljs-number">8</span></span>, StopBits.One); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">received</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, SerialDataReceivedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> buf; buf = port.ReadExisting(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!String.IsNullOrEmpty(buf)) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> str = buf.Substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v = Convert.ToInt32(str, <span class="hljs-number"><span class="hljs-number">16</span></span>); buf = buf.Remove(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>); Console.WriteLine(v); values.Add(v); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Strart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Incoming data:"</span></span>); port.DataReceived += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerialDataReceivedEventHandler(received); port.Open(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Stop</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { port.Close(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Full</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values.Count == <span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> values; } }&lt;source lang=<span class="hljs-string"><span class="hljs-string">"cs"</span></span>&gt;</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Excel.cs</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Excel</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>&gt; xScale; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>&gt; yScale; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Application exApp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Application(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Sheets sheets; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Worksheet worksheet; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Range range; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Excel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; x,List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; y</span></span></span><span class="hljs-function">)</span></span> { xScale = x; yScale = y; exApp.Visible = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; exApp.SheetsInNewWorkbook = <span class="hljs-number"><span class="hljs-number">1</span></span>; exApp.Workbooks.Add(Type.Missing); sheets = exApp.Worksheets; worksheet = (Worksheet)sheets.get_Item(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">255</span></span>; i++) { range = worksheet.get_Range(<span class="hljs-string"><span class="hljs-string">"A"</span></span> + Convert.ToString(i), <span class="hljs-string"><span class="hljs-string">"A"</span></span> + Convert.ToString(i)); range.Value = xScale[i]; range = worksheet.get_Range(<span class="hljs-string"><span class="hljs-string">"B"</span></span> + Convert.ToString(i), <span class="hljs-string"><span class="hljs-string">"B"</span></span> + Convert.ToString(i)); range.Value = yScale[i]; } ChartObjects chartObjs = (ChartObjects)worksheet.ChartObjects(); ChartObject chartObj = chartObjs.Add(<span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">700</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>); Chart xlChart = chartObj.Chart; xlChart.ChartType = XlChartType.xlXYScatterLinesNoMarkers; <span class="hljs-comment"><span class="hljs-comment">//PlotArea. Range xValues = worksheet.Range["A1", "A254"]; Range values = worksheet.Range["B1", "B254"]; SeriesCollection seriesCollection = xlChart.SeriesCollection(); Series series1 = seriesCollection.NewSeries(); series1.MarkerSize = 3; series1.XValues = xValues; series1.Values = values; } } }</span></span></code> </pre></div></div><br><br>  If everything is correctly written and done, the client will write that he accepts the data and at the end will display the graph in Excel. <br><img src="http://habrastorage.org/storage3/a6d/61d/c3c/a6d61dc3ce9f6a4d3671b1b6b3e506d1.png" alt="image"></habracut></div><p>Source: <a href="https://habr.com/ru/post/208016/">https://habr.com/ru/post/208016/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208004/index.html">Full analysis of Apple Mac Pro 2013</a></li>
<li><a href="../208006/index.html">What is so difficult about handling C ++ exceptions?</a></li>
<li><a href="../208008/index.html">Graphene Storage Concept Receives Red Dot Design Awards</a></li>
<li><a href="../208010/index.html">Suspicion of a secret telecommunications hub</a></li>
<li><a href="../208014/index.html">Backdoor in Linksys and Netgear routers</a></li>
<li><a href="../208020/index.html">1058 candidates selected for flight to Mars</a></li>
<li><a href="../208022/index.html">Siemens Logo! - ten years later</a></li>
<li><a href="../208026/index.html">STM32 and USB-HID - it‚Äôs just</a></li>
<li><a href="../208028/index.html">‚ÄúAnd these people forbid us to poke around‚Äù: Huawei and the NSA</a></li>
<li><a href="../208030/index.html">Discoveries of the Outgoing Year - Another Useful Sleep Function</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>