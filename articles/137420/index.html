<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Linux head-end computer - collect it yourself!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article focuses on the self-made head-on computer with the hard-to-name WXHMD, created by a Parisian craftsman named Pascal. This is a Gumstix Ov...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Linux head-end computer - collect it yourself!</h1><div class="post__text post__text-html js-mediator-article">  This article focuses on the self-made head-on computer with the hard-to-name WXHMD, created by a Parisian craftsman named Pascal.  This is a Gumstix Overo Fire computer-on-module computer mounted on the Vuzix VR920 head-mounted display.  The result was a 640x480 stereoscopic image device with audio input and audio output, 3D tilt sensors (3D tilt sensor), 3D magnetic compass, TI OMAP3530 @ 600 MHz processor, Linux OS, WiFi, Bluetooth.  Power - 1 amp @ 3.7 volts.  Weight - 180 grams. <br><a name="habracut"></a><br><img src="https://habrastorage.org/storage2/8e4/c41/9ee/8e4c419ee9371be569811a2cb04043c4.jpg"><br><br><h5>  1. Vuzix VR 920 is a high-quality head-on display priced at around 400 euros. </h5><ul><li>  two 640x480 Kopin display modules; </li><li>  analog video input DB15 VGA; </li><li>  powered by USB (nominally - 5 mA @ 5V, but it also works at reduced voltage, up to 3.7V); </li><li>  built-in stereo headphones and monaural microphone (USB audio profile); </li><li>  three-axis accelerometer and magnetometer (USB HID profile); </li></ul>  Full specifications can be found <a href="http://www.vuzix.com/iwear/products_vr920.html">on the manufacturer's website</a> . <br><br><h5>  2. Single board computer Gumstix Overo Fire </h5><ul><li>  TI OMAP3530 processor, maximum 600 MHz, default 500 MHz </li><li>  256 MB RAM, microSD flash card </li><li>  WiFi, Bluetooth </li><li>  USB OTG (maximum 100 mA) </li><li>  video output for LCD @ 1.8V </li></ul>  A complete description of the device can be found <a href="http://www.gumstix.com/store/catalog/product_info.php%3Fproducts_id%3D227">on the manufacturer's website</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  3. Connection board </h5><br>  To connect a single-board computer with a head-mounted display, it was necessary to design a small board with power connectors, USB and simple digital-to-analog converters (DACs) for analog video output.  DACs are connected to the video output of the computer and create a 12-bit analog signal at the output (4 bits per color component each).  Synchronization signals from the LCD-out are sent directly to the corresponding VGA-contacts (VR 920 could work with a signal of 1.8V, although nominally it should be 5V).  Everything else is done by software on OMAP. Actually, OMAP cannot generate fully VGA-compatible synchronization signals (perhaps HSYNC pulses are insufficiently long), but the VR920 also works with such "wrong" signals. <br><br><img src="https://habrastorage.org/storage2/3bd/00e/369/3bd00e369f59c8207b38dfa67cf87759.gif"><br>  <i>Fig.1.</i>  <i>Scheme: <a href="">wxhmd.sch</a> , <a href="http://www.advegam.com/images/stories/articles/misc/wxhmd.sch.pdf">wxhmd.sch.pdf</a></i> <br><br>  The double-sided printed circuit board was designed in gEDA gschem, diluted in gEDA PCB, and etched using Direct Inkjet Resist Printing technology (read more about it <a href="http://www.pabr.org/pcbprt/pcbprt.en.html">here</a> ). <br><br>  The pinout and footprint of Overo had to be converted to the format gEDA: <a href="">OVERO.sym</a> , <a href="">OVERO.fp</a> .  These files are derived from specifications published by the Gumstix under the Creative Commons Attribution-ShareAlike2.5 license.  Some of the work was done by hand, so it may contain errors. <br><br><img src="https://habrastorage.org/storage2/60d/12d/df1/60d12ddf16dceed2a489dc5a6984df55.gif"><br>  <i>Fig.2.</i>  <i><a href="">Layout</a> : <a href="">wxhmd-2.pcb</a> , <a href="http://www.advegam.com/images/stories/articles/misc/wxhmd-2.pcb.pdf">wxhmd-2.pcb.pdf</a></i> <br><br><h5>  4. Build </h5><br>  Since the OTG USB port in Overo delivers only 100 mA, the head-mounted display is powered via VSYSTEM instead of USBOTG_VBUS. <br><br><img src="https://habrastorage.org/storage2/3e4/e21/64c/3e4e2164c20d2f90e5c2ab4dd68a9d67.jpg"><br>  <i>Fig.3.</i>  <i>Testing performance before embedding boards in the VR920</i> <br><br>  Starting work on the device, the author assumed that the 13-pin connector inside the VR920 would receive ‚Äúraw‚Äù (USB) and USB VGA signals.  But it turned out that the cable splitting into two tails (USB and VGA) contains a small board that processes VGA sync signals. <br><br><img src="https://habrastorage.org/storage2/752/bfc/4d1/752bfc4d10491f6fb049dafd85cc5bab.jpg"><br>  <i>Fig.4.</i>  <i>Board, "hidden" inside the cable</i> <br><br>  Pascal did not try to figure out whether OMAP could be forced to generate a suitable composite sync signal (apparently, it generates a nonstandard).  The author just soldered this board to the computer board.  In addition, the author could not find the connector corresponding to the head-mounted display connector (13 contacts with a step of 1 mm).  The sacrificed cable solved both these problems. <br><br><img src="https://habrastorage.org/storage2/403/a9f/045/403a9f0459a4f6f3eefba6a280e08f87.jpg"><br>  <i>Fig.5.</i>  <i>Final preparations: video synchronization board soldered to computer board</i> <br><br><img src="https://habrastorage.org/storage2/853/398/927/853398927a5b33aa5dc51303486063f4.jpg"><br>  <i>Fig.6.</i>  <i>Testing before final assembly</i> <br><br><h5>  5. Software </h5><br>  <b>Usb</b>  The VR920 USB stack tells the host that it needs 500 mA, so Linux will immediately turn off the headrest.  Usually this problem is solved by connecting an external powered USB hub.  In our case, this is not the best solution, since the headguard is powered by VSYSTEM, we can make Linux ignore checking the power parameters of the USB device using <a href="http://www.advegam.com/images/stories/articles/misc/usb_ignore_power.patch">usb_ignore_power.patch</a> without any threat to the system‚Äôs performance. <br><br>  <b>Frame buffer</b>  In the u-boot environment, you need to set the Linux framebuffer resolution to be 640x480. <br><br>  <b>OMAP LCD configuration.</b>  These commands configure the OMAP LCD subsystem to generate VGA-like signals: <br><br> <code>DISPLAY=:0.0 xset -dpms #    LCD,         <br> devmem2 0x480504fc w 0x00003000 # Polarities <br> devmem2 0x48050464 w 0x02f00f3f # HSYNC <br> devmem2 0x48050468 w 0x02000901 # VSYNC <br> devmem2 0x4805047c w 0x01df027f # Size <br> killall Xorg #   </code> <br> <br>  <b>Hid</b>  The most correct way is to interact with the accelerometer (tilt sensors) of the headband via / dev / hidraw.  This will require recompiling the Gumstix Linux kernel with CONFIG_HIDRAW = y.  Sensor readings can be read in 17-byte chunks containing six 16-bit values ‚Äã‚Äã(little-endian): <br><br> <code>root@overo:~# hexdump -e '4/1 "%02x " 6/2 " %4d " 1/1 " %02x" "\n"' &lt; /dev/hidraw0 <br> 00 02 02 00 -1 403 -60 82 421 189 ab <br> 00 02 02 00 -9 374 -68 65 400 175 ab <br> 00 02 02 00 -8 394 -65 62 396 174 ab <br> 00 02 02 00 -19 378 -78 35 364 158 ab</code> <br> <br><h5>  6. Results </h5><br><img src="http://habrastorage.org/storage2/3c2/18b/915/3c218b915d042eda5f556b433d3141a2.jpg"><br>  <i>Fig.7.</i>  <i>Colored rectangles (on the left - the original image, on the right - in the cap)</i> <br><br>  Smooth color transitions do not work, even when using resistors of the E12 series (with an accuracy of 10%).  It may be worth using not 4, but 5 or more bits per color component. <br><br>  <i><u>Comment LJ user <a href="http://0x8.livejournal.com/">0x8</a> :</u></i> <i><br></i>  <i>‚ÄúThe article mentioned problems with DACs on resistors.</i>  <i>For smoother transitions, more bits of the DAC are needed, not 4 bits per channel, but 6, say (this was the capacity of the first TFT monitors).</i> <i><br></i>  <i>To resist less heat - to increase their resistance times 2 (but the display input should not consume a large current, otherwise you will have to fence the repeater on the transistor).</i>  <i>And even in such circuits, resistors with a deviation of + -1%, rather than 10%, are strongly recommended.</i>  <i>It is necessary for the linear transformation of the digital-analogue.</i>  <i>The more discharges, the more critical the accuracy of resistance.</i>  <i>In Soviet microcircuits, these resistors _after) the manufacture was cut on each chip with a laser to get into the nominal. "</i> <br><br><img src="http://habrastorage.org/storage2/f8d/b99/ee4/f8db99ee4c36331045210b32b7803b82.jpg"><br>  <i>Fig.8.</i>  <i>Firefox on the head-mounted display (X11 launched remotely via WiFi)</i> <br><br>  Not the best quality of the above photos is explained not only by the use of the simplest DAC, but also by the fact that it is quite problematic to place the camera so that the image on the screen of the headgear is exactly in focus. <br><br>  <a href="">vroom920.c</a> - a program that demonstrates a three-dimensional stereo image and work with tracking head position.  It builds a wire image of a cylindrical room around the user. <br><br><img src="http://habrastorage.org/storage2/df2/3e0/dfc/df23e0dfcb72f1baffff1b7a7b319e1f.jpg"><br>  <i>Fig.9.</i>  <i>vroom920 in the head-mounted display</i> <br><br><h5>  7. In conclusion </h5><br>  <b>Attention!</b>  This prototype may violate any technical standards and regulations regarding user safety and electromagnetic coupling. <br><br>  <b>DAC.</b>  It would be better to use quality DAC.  Since this was the first ‚Äúiron‚Äù project of the author, created using printed circuit boards using an inkjet printer, the author tried to avoid any complications by using the simplest DAC on resistors. <br><br>  <b>GPIO.</b>  The DAC on the resistors at the GPIO output, perhaps, slightly distorts the electrical parameters of OMAP, but the problem is not so much in this as in the fact that such DACs quickly heat up.  If the resistors burn the same Overo, the author promises to write about it. <br><br>  <b>Battery life.</b>  The system consumes 1 amp - without optimizing energy consumption.  This is quite acceptable, since there is hardly anyone willing to wear two working microwave transmitters on the head, a heavy lithium battery and glasses that block the view. <br><br>  <b>Improved design.</b>  The VR920 board has many tricky features that were not used in this project - support for various VGA modes and resolutions and even implements on-screen menus overlapping the image.  Of course, you can remove all this and work directly with Kopin LCD modules.  <a href="http://pervasive.researchstudio.at/portal/node/49">[VOGL2008]</a> implemented this for a model with a resolution of 320x240, which has a slightly different analog RGB interface.  The main difficulties here are working with 9-volt signals, the implementation of polarity inversion and the ZIF flex connector. <br><br><h5>  Bibliography </h5><br>  [PCBPRT] Experiments in inkjet PCB printing: <a href="http://www.pabr.org/pcbprt/pcbprt.en.html">http://www.pabr.org/pcbprt/pcbprt.en.html</a> <br><br>  [VOGL2008] Gumstix Video out board :: Kopin K230LV adapter: <a href="http://pervasive.researchstudio.at/portal/node/49">http://pervasive.researchstudio.at/portal/node/49</a> <br><br>  All rights to the structure described in this article and the photos included in the article belong to the author of the structure. <br><br>  Translation of the article is made and posted with the consent of the author of the original article. <br><br>  Original source: <a href="http://www.pabr.org/wxhmd/doc/wxhmd.en.html">http://www.pabr.org/wxhmd/doc/wxhmd.en.html</a> </div><p>Source: <a href="https://habr.com/ru/post/137420/">https://habr.com/ru/post/137420/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137414/index.html">Integration of the physics engine Box2D into the UIKit application for iOS</a></li>
<li><a href="../137415/index.html">User Attributes in Python</a></li>
<li><a href="../137416/index.html">Anonymization and de-anonymization on the Internet</a></li>
<li><a href="../137417/index.html">Because of the new law, popular torrent trackers of Kazakhstan have stopped working</a></li>
<li><a href="../137419/index.html">Vulnerability in ISPSystem Billmanager</a></li>
<li><a href="../137421/index.html">Create transitions for pages using CSS3</a></li>
<li><a href="../137422/index.html">Courses for upgrading SharePoint developers</a></li>
<li><a href="../137423/index.html">Free-to-play games: how to make them successful</a></li>
<li><a href="../137425/index.html">I haven't taken checkers for a long time. Know, know how you play</a></li>
<li><a href="../137426/index.html">Javascript. Sort table</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>