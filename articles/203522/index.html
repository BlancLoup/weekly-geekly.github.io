<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Excel data loading and unloading using OpenXML</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I decided to write an article on how to upload data to an Excel file using a template and read data from Excel. 
 It all started with the fact that at...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Excel data loading and unloading using OpenXML</h1><div class="post__text post__text-html js-mediator-article">  I decided to write an article on how to upload data to an Excel file using a template and read data from Excel. <br>  It all started with the fact that at work, they gave instructions to leave the MS Office for free analogues. <br>  We already had a download system based on the Microsoft.Office library.  Interop.Excel ”and many ready-made templates for uploading certain reports. <br>  Therefore, it was necessary to find a free library that works with the office.  And to make so that the unloading worked on the same system as before.  For I did not want to redo all the templates and structure. <br>  So I came across OpenXML.  And I thought, now I will quickly find a solution on the Internet and everything is ready (since not enough time was allocated for this).  But I did not find a suitable solution, so I decided to write this article, for those who will have the same problem. <br>  The library itself, can be downloaded free of charge from the site of Micrisoft (I used in the OpenXML project sdk 2.5 “OpenXMLSDKV25.msi”) <br>  <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D30425">here</a> <br>  After downloading “OpenXMLSDKV25.msi”, install and go to the folder <br>  “C: \ Program Files \ Open XML SDK \ V2.5 \ lib” there is a library that we need, we will connect it to the project (it will be described below how). <br>  The project was written in Visual Studio 2010 (Framework 4.0). <br>  Below is an example of a template (made for the test) “C: \ Templates \ template.xlsx”. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/2f7/d84/9cf/2f7d849cf052cfb11e3a5c858d5ac4a6.png" alt="image"><br><br>  And an example of the uploaded data (as it will look as a result, after unloading). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/201/6c7/2d2/2016c72d27844afa100d07d8cc4ba32c.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Keywords: <br>  DataField: - Means that our baths will be removed from the DataTable at this place. <br>  DataField: [display field name] <br>  Label: - Means that this place will display data that you need to insert once from the dictionary <br>  Label: [key name in dictionary] <br>  And this is the file from which we will read the data “C: \ Loading \ ReadMePlease.xlsx”. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/087/35f/597/08735f597c195ea4832dd39c22c102ef.png" alt="image"><br><br>  Now we will create in VS2010, the Solution in which there will be 4 projects: <br>  1) OpenXmlPrj is a console project for running a test. <br>  2) Interfaces is a project of the type “Class Library” that will store our data interfaces for uploading. <br>  3) The Framework is a project of the type “Class Library”, here all the work with Excel will be done. <br>  4) Converter is a project of the type “Class Library”, for converting our data into a DataTable (as work happens with a DataTable). <br><img src="https://habrastorage.org/getpro/habr/post_images/765/2c9/b08/7652c9b086e59158c9a781aca67e9439.png" alt="image"><br>  Now in the “Framework” project we create two folders and connect a link to the OpenXML and WindowsBase library: <br>  “Create” - to work with data upload. <br>  “Load” - to work with data loading. <br>  “Lib” - in the folder, add the OpenXML library. <br>  In the folder “Create” create 4 classes. <br>  1) Worker - this will be our main processor. <br><div class="spoiler">  <b class="spoiler_title">class Create.Worker</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Diagnostics; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Globalization; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text.RegularExpressions; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> DocumentFormat.OpenXml; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> DocumentFormat.OpenXml.Packaging; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> DocumentFormat.OpenXml.Spreadsheet; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Framework.Create</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  Excel  </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public class Worker { </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">      </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> private const String TemplateFolder = "C:\\Templates\\"; </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">    (    ) </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> private const String SheetName = "1"; </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">   </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> private const String FileType = ".xlsx"; </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> ,     </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public static String Directory { get { const string excelFilesPath = @"C:\xlsx_repository\"; if (System.IO.Directory.Exists(excelFilesPath) == false) { System.IO.Directory.CreateDirectory(excelFilesPath); } return excelFilesPath; } } public void Export(System.Data.DataTable dataTable, System.Collections.Hashtable hashtable, String templateName) { var filePath = CreateFile(templateName); OpenForRewriteFile(filePath, dataTable, hashtable); OpenFile(filePath); } private String CreateFile(String templateName) { var templateFelePath = String.Format("{0}{1}{2}", TemplateFolder, templateName, FileType); var templateFolderPath = String.Format("{0}{1}", Directory, templateName); if (!File.Exists(String.Format("{0}{1}{2}", TemplateFolder, templateName, FileType))) { throw new Exception(String.Format("     \n\"{0}{1}{2}\"!", TemplateFolder, templateName, FileType)); } //    ( templateName)  ,   ,    var index = (templateFolderPath).LastIndexOf("\\", System.StringComparison.Ordinal); if (index &gt; 0) { var directoryTest = (templateFolderPath).Remove(index, (templateFolderPath).Length - index); if (System.IO.Directory.Exists(directoryTest) == false) { System.IO.Directory.CreateDirectory(directoryTest); } } var newFilePath = String.Format("{0}_{1}{2}", templateFolderPath, Regex.Replace((DateTime.Now.ToString(CultureInfo.InvariantCulture)), @"[^a-z0-9]+", ""), FileType); File.Copy(templateFelePath, newFilePath, true); return newFilePath; } private void OpenForRewriteFile(String filePath, System.Data.DataTable dataTable, System.Collections.Hashtable hashtable) { Row rowTemplate = null; var footer = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Footer&gt;</span></span></span><span class="hljs-comment">(); var firsIndexFlag = false; using (var document = SpreadsheetDocument.Open(filePath, true)) { Sheet sheet; try { sheet = document.WorkbookPart.Workbook.GetFirstChild</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Sheets&gt;</span></span></span><span class="hljs-comment">().Elements</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Sheet&gt;</span></span></span><span class="hljs-comment">().SingleOrDefault(s =&gt; s.Name == SheetName); } catch (Exception ex) { throw new Exception(String.Format("        \"{0}\"!\n",SheetName), ex); } if (sheet == null) { throw new Exception(String.Format("    \"{0}\"!\n",SheetName)); } var worksheetPart = (WorksheetPart)document.WorkbookPart.GetPartById(sheet.Id.Value); var sheetData = worksheetPart.Worksheet.GetFirstChild</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;SheetData&gt;</span></span></span><span class="hljs-comment">(); var rowsForRemove = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Row&gt;</span></span></span><span class="hljs-comment">(); var fields = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Field&gt;</span></span></span><span class="hljs-comment">(); foreach (var row in worksheetPart.Worksheet.GetFirstChild</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;SheetData&gt;</span></span></span><span class="hljs-comment">().Elements</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Row&gt;</span></span></span><span class="hljs-comment">()) { var celsForRemove = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Cell&gt;</span></span></span><span class="hljs-comment">(); foreach (var cell in row.Descendants</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Cell&gt;</span></span></span><span class="hljs-comment">()) { if (cell == null) { continue; } var value = GetCellValue(cell, document.WorkbookPart); if (value.IndexOf("DataField:", StringComparison.Ordinal) != -1) { if (!firsIndexFlag) { firsIndexFlag = true; rowTemplate = row; } fields.Add(new Field(Convert.ToUInt32(Regex.Replace(cell.CellReference.Value, @"[^\d]+", "")) , new string(cell.CellReference.Value.ToCharArray().Where(p =&gt; !char.IsDigit(p)).ToArray()) , value.Replace("DataField:", ""))); } if (value.IndexOf("Label:", StringComparison.Ordinal) != -1 &amp;&amp; rowTemplate == null) { var labelName = value.Replace("Label:", "").Trim(); if (!hashtable.ContainsKey(labelName)) { throw new Exception(String.Format("   \"{0}\"", labelName)); } cell.CellValue = new CellValue(hashtable[labelName].ToString()); cell.DataType = new EnumValue</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;CellValues&gt;</span></span></span><span class="hljs-comment">(CellValues.String); } if (rowTemplate == null || row.RowIndex </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;= rowTemplate.RowIndex || String.IsNullOrWhiteSpace(value)) { continue; } var item = footer.SingleOrDefault(p =&gt;</span></span></span><span class="hljs-comment"> p._Row.RowIndex == row.RowIndex); if (item == null) { footer.Add(new Footer(row, cell, value.IndexOf("Label:", StringComparison.Ordinal) != -1 ? hashtable[value.Replace("Label:", "").Trim()].ToString() : value)); } else { item.AddMoreCell(cell, value.IndexOf("Label:", StringComparison.Ordinal) != -1 ? hashtable[value.Replace("Label:", "").Trim()].ToString() : value); } celsForRemove.Add(cell); } foreach (var cell in celsForRemove) { cell.Remove(); } if (rowTemplate != null &amp;&amp; row.RowIndex != rowTemplate.RowIndex) { rowsForRemove.Add(row); } } if (rowTemplate == null || rowTemplate.RowIndex == null || rowTemplate.RowIndex </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt; 0) { throw new Exception("     ,  !"); } foreach (var row in rowsForRemove) { row.Remove(); } var index = rowTemplate.RowIndex; foreach (var row in from System.Data.DataRow item in dataTable.Rows select CreateRow(rowTemplate, index, item, fields)) { sheetData.InsertBefore(row, rowTemplate); index++; } foreach (var newRow in footer.Select(item =&gt;</span></span></span><span class="hljs-comment"> CreateLabel(item, (UInt32)dataTable.Rows.Count))) { sheetData.InsertBefore(newRow, rowTemplate); } rowTemplate.Remove(); } } private Row CreateLabel(Footer item, uint count) { var row = item._Row; row.RowIndex = new UInt32Value(item._Row.RowIndex + (count - 1)); foreach (var cell in item.Cells) { cell._Cell.CellReference = new StringValue(cell._Cell.CellReference.Value.Replace(Regex.Replace(cell._Cell.CellReference.Value, @"[^\d]+", ""), row.RowIndex.ToString())); cell._Cell.CellValue = new CellValue(cell.Value); cell._Cell.DataType = new EnumValue</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;CellValues&gt;</span></span></span><span class="hljs-comment">(CellValues.String); row.Append(cell._Cell); } return row; } private Row CreateRow(Row rowTemplate, uint index, System.Data.DataRow item, List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Field&gt;</span></span></span><span class="hljs-comment"> fields) { var newRow = (Row)rowTemplate.Clone(); newRow.RowIndex = new UInt32Value(index); foreach (var cell in newRow.Elements</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Cell&gt;</span></span></span><span class="hljs-comment">()) { cell.CellReference = new StringValue(cell.CellReference.Value.Replace(Regex.Replace(cell.CellReference.Value, @"[^\d]+", ""), index.ToString(CultureInfo.InvariantCulture))); foreach (var fil in fields.Where(fil =&gt; cell.CellReference == fil.Column + index)) { cell.CellValue = new CellValue(item[fil._Field].ToString()); cell.DataType = new EnumValue</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;CellValues&gt;</span></span></span><span class="hljs-comment">(CellValues.String); } } return newRow; } private string GetCellValue(Cell cell, WorkbookPart wbPart) { var value = cell.InnerText; if (cell.DataType == null) { return value; } switch (cell.DataType.Value) { case CellValues.SharedString: var stringTable = wbPart.GetPartsOfType</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;SharedStringTablePart&gt;</span></span></span><span class="hljs-comment">().FirstOrDefault(); if (stringTable != null) { value = stringTable.SharedStringTable.ElementAt(int.Parse(value)).InnerText; } break; } return value; } private void OpenFile(string filePath) { if (!File.Exists(filePath)) { throw new Exception(String.Format("    \"{0}\"!", filePath)); } var process = Process.Start(filePath); if (process != null) { process.WaitForExit(); } } } }</span></span></code> </pre> <br></div></div><br>  2) Footer - will contain lines and their cells coming after our data. <br><div class="spoiler">  <b class="spoiler_title">class footer</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> DocumentFormat.OpenXml.Spreadsheet; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Framework.Create</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Footer</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public Row _Row { get; private set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">    </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;CellForFooter&gt;</span></span></span><span class="hljs-comment"> Cells { get; private set; } public Footer(Row row, Cell cell, String cellValue) { _Row = new Row((Row)row.Clone()) { RowIndex = row.RowIndex }; var _Cell = (Cell)cell.Clone(); _Cell.CellReference = cell.CellReference; Cells = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;CellForFooter&gt;</span></span></span><span class="hljs-comment"> { new CellForFooter(_Cell, cellValue) }; } public void AddMoreCell(Cell cell, String cellValue) { var _Cell = (Cell)cell.Clone(); _Cell.CellReference = cell.CellReference; Cells.Add(new CellForFooter(_Cell, cellValue)); } } }</span></span></code> </pre><br></div></div><br>  3) CellForFooter - contains the coordinates of the cell and its value, used in Footer. <br><div class="spoiler">  <b class="spoiler_title">CellForFooter class</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> DocumentFormat.OpenXml.Spreadsheet; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Framework.Create</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CellForFooter</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public Cell _Cell { get; private set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public String Value { get; private set; } public CellForFooter(Cell cell, String value) { _Cell = cell; Value = value; } } }</span></span></code> </pre><br></div></div><br>  4) Field - will contain the index of the line where the DataField is located, the coordinates of the cells with the DataField and the name of the field whose value is to be output. <br><div class="spoiler">  <b class="spoiler_title">Field class</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Framework.Create</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Field</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">   </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public uint Row { get; private set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">   </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public String Column { get; private set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  ,   </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public String _Field { get; private set; } public Field(uint row, String column, String field) { Row = row; Column = column; _Field = field; } } }</span></span></code> </pre><br></div></div><br>  In the folder “Load” create 2 classes. <br>  1) Worker - this will be our main processor. <br><div class="spoiler">  <b class="spoiler_title">class Load.Worker</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text.RegularExpressions; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> DocumentFormat.OpenXml.Packaging; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> DocumentFormat.OpenXml.Spreadsheet; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Framework.Load</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">    Excel </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public class Worker { </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">   (   ) </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> private const String SheetName = "1"; </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">      .xlsx </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;param name="path"&gt;</span></span></span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/param&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;returns&gt;</span></span></span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/returns&gt;</span></span></span><span class="hljs-comment"> public System.Data.DataTable ReadFile(String path) { CheckFile(path); return OpenDocumentForRead(path); } private System.Data.DataTable OpenDocumentForRead(string path) { System.Data.DataTable data = null; using (var document = SpreadsheetDocument.Open(path, false)) { Sheet sheet; try { sheet = document.WorkbookPart.Workbook.GetFirstChild</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Sheets&gt;</span></span></span><span class="hljs-comment">().Elements</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Sheet&gt;</span></span></span><span class="hljs-comment">().SingleOrDefault(s =&gt; s.Name == SheetName); } catch (Exception ex) { throw new Exception(String.Format("        \"{0}\"!\n", SheetName), ex); } if (sheet == null) { throw new Exception(String.Format("    \"{0}\"!\n", SheetName)); } var relationshipId = sheet.Id.Value; var worksheetPart = (WorksheetPart)document.WorkbookPart.GetPartById(relationshipId); var sheetData = worksheetPart.Worksheet.GetFirstChild</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;SheetData&gt;</span></span></span><span class="hljs-comment">(); var firstRow = true; var columsNames = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;ColumnName&gt;</span></span></span><span class="hljs-comment">(); foreach (Row row in sheetData.Elements</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Row&gt;</span></span></span><span class="hljs-comment">()) { if (firstRow) { columsNames.AddRange(GetNames(row, document.WorkbookPart)); data = GetTable(columsNames); firstRow = false; continue; } var item = data.NewRow(); foreach (var line in columsNames) { var coordinates = String.Format("{0}{1}", line.Liter, row.RowIndex); var cc = row.Elements</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Cell&gt;</span></span></span><span class="hljs-comment">().SingleOrDefault(p =&gt; p.CellReference == coordinates); if (cc == null) { throw new Exception(String.Format("    \"{0}\"!", coordinates)); } item[line.Name.Trim()] = GetVal(cc, document.WorkbookPart); } data.Rows.Add(item); } } return data; } private System.Data.DataTable GetTable(IEnumerable</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;ColumnName&gt;</span></span></span><span class="hljs-comment"> columsNames) { var teb = new System.Data.DataTable("ExelTable"); foreach (var col in columsNames.Select(columnName =&gt; new System.Data.DataColumn { DataType = typeof(String), ColumnName = columnName.Name.Trim() })) { teb.Columns.Add(col); } return teb; } private IEnumerable</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;ColumnName&gt;</span></span></span><span class="hljs-comment"> GetNames(Row row, WorkbookPart wbPart) { return (from cell in row.Elements</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;Cell&gt;</span></span></span><span class="hljs-comment">() where cell != null let text = GetVal(cell, wbPart) where !String.IsNullOrWhiteSpace(text) select new ColumnName(text, Regex.Replace(cell.CellReference.Value, @"[\0-9]", ""))).ToList(); } private string GetVal(Cell cell, WorkbookPart wbPart) { string value = cell.InnerText; if (cell.DataType == null) { return value; } switch (cell.DataType.Value) { case CellValues.SharedString: var stringTable = wbPart.GetPartsOfType</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;SharedStringTablePart&gt;</span></span></span><span class="hljs-comment">() .FirstOrDefault(); if (stringTable != null) { value = stringTable.SharedStringTable .ElementAt(int.Parse(value)).InnerText; } break; } return value; } private void CheckFile(String path) { if (String.IsNullOrWhiteSpace(path) || !File.Exists(path)) { throw new Exception(String.Format("  \"{0}\",  !", path)); } } } }</span></span></code> </pre><br></div></div><br>  2) ColumnName - will be the name of the column for the loaded data. <br><div class="spoiler">  <b class="spoiler_title">class ColumnName</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Framework.Load</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ColumnName</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  ,    </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public String Name { get; private set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">   </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public String Liter { get; private set; } public ColumnName(string name, string liter) { Name = name; Liter = liter; } } }</span></span></code> </pre><br></div></div><br>  In the “Interfaces” project we will create the interface of our data IDataForTest. <br><div class="spoiler">  <b class="spoiler_title">IDataForTest interface</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Interfaces</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IDataForTest</span></span> { String A { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } String B { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } String C { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } } }</code> </pre><br></div></div><br>  In the “Converter” project, create a class <br>  ConvertToDataTable - to convert our data into a DataTable. <br><div class="spoiler">  <b class="spoiler_title">class ConvertToDataTable</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Data; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Interfaces; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Converter</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ConvertToDataTable</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataTable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExcelTableLines</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;IDataForTest&gt; lines</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dt = CreateTable(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> lines) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> row = dt.NewRow(); row[<span class="hljs-string"><span class="hljs-string">"AAA"</span></span>] = line.A; row[<span class="hljs-string"><span class="hljs-string">"BBB"</span></span>] = line.B; row[<span class="hljs-string"><span class="hljs-string">"CCC"</span></span>] = line.C; dt.Rows.Add(row); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dt; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Hashtable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExcelTableHeader</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Int32 count</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> head = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;String, String&gt; { { <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, DateTime.Today.Date.ToShortDateString() }, { <span class="hljs-string"><span class="hljs-string">"Count"</span></span>, count.ToString() } }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Hashtable(head); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> DataTable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateTable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataTable(<span class="hljs-string"><span class="hljs-string">"ExelTable"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> col = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataColumn { DataType = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(String), ColumnName = <span class="hljs-string"><span class="hljs-string">"AAA"</span></span> }; dt.Columns.Add(col); col = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataColumn { DataType = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(String), ColumnName = <span class="hljs-string"><span class="hljs-string">"BBB"</span></span> }; dt.Columns.Add(col); col = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataColumn { DataType = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(String), ColumnName = <span class="hljs-string"><span class="hljs-string">"CCC"</span></span> }; dt.Columns.Add(col); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dt; } } }</code> </pre><br></div></div><br>  In the project “OpenXmlPrj” <br>  There will be a class for executing the program. <br><div class="spoiler">  <b class="spoiler_title">Program class</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Data; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">OpenXmlPrj</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   var myData = new List&lt;DataForTest&gt; { new DataForTest("a1","b1","c1"), new DataForTest("a2","b2","c2"), new DataForTest("a3","b3","c3"), new DataForTest("a4","b4","c4"), new DataForTest("a5","b5","c5") }; var ex = new Converter.ConvertToDataTable(); //ex.ExcelTableLines(myData) -     DataTable //ex.ExcelTableHeader(myData.Count) -    Label //template -     -  new Framework.Create.Worker().Export(ex.ExcelTableLines(myData), ex.ExcelTableHeader(myData.Count), "template"); Console.WriteLine("Excel File Has Created!\nFor Read Data From Excel, press any key!"); Console.ReadKey(); //"C:\\Loading\\ReadMePlease.xlsx" -   ,      (  DataTable) var dt = new Framework.Load.Worker().ReadFile("C:\\Loading\\ReadMePlease.xlsx"); var myDataFromExcel = new List&lt;DataForTest&gt;(); //  ,    DataTable foreach (DataRow item in dt.Rows) { myDataFromExcel.Add(new DataForTest(item)); } Console.WriteLine("---------- Data ---------------------"); //   foreach (var line in myDataFromExcel) { Console.WriteLine("{0} | {1} | {2}", line.A, line.B, line.C); } Console.WriteLine("Done. Press any key, for exit!"); Console.ReadKey(); } } }</span></span></code> </pre><br></div></div><br>  And the class for our data is “DataForTest”. <br><div class="spoiler">  <b class="spoiler_title">class DataForTest</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Data; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Interfaces; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">OpenXmlPrj</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DataForTest</span></span> : <span class="hljs-title"><span class="hljs-title">IDataForTest</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> String A { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> String B { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> String C { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DataForTest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">String a, String b, String c</span></span></span><span class="hljs-function">)</span></span> { A = a; B = b; C = c; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DataForTest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DataRow item</span></span></span><span class="hljs-function">)</span></span> { A = item[<span class="hljs-string"><span class="hljs-string">"MyFieldA"</span></span>].ToString(); B = item[<span class="hljs-string"><span class="hljs-string">"MyFieldB"</span></span>].ToString(); C = item[<span class="hljs-string"><span class="hljs-string">"MyFieldC"</span></span>].ToString(); } } }</code> </pre><br></div></div><br>  And the project “OpenXmlPrj” should include links to the following projects: Interfaces, Framework, Converter <br>  Conditions for creating a template: <br>  1. Excel sheet, must necessarily be called “Sheet1” (well, or if you want to rename, then in the code you will need to change the name too). <br>  2. Names after DataField: must strictly coincide with the names of the columns in the DataTable. <br>  3. The template should be saved in “.xlsx” format. <br>  Conditions for the file from which we will read data: <br>  1. Excel sheet, must necessarily be called “Sheet1” (well, or if you want to rename, then in the code you will need to change the name too). <br>  2. The first line should contain the names of the columns by which we will then parse the data. <br><br>  <a href="https://github.com/Voucik/OpenXML">The link to the source in GitHub.</a> </div><p>Source: <a href="https://habr.com/ru/post/203522/">https://habr.com/ru/post/203522/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../203512/index.html">Virtual reality glasses using a tablet</a></li>
<li><a href="../203514/index.html">Pointer events</a></li>
<li><a href="../203516/index.html">Python version manager</a></li>
<li><a href="../203518/index.html">Bitcoin Should I trust?</a></li>
<li><a href="../203520/index.html">Rails redirecting old url</a></li>
<li><a href="../203530/index.html">Bitcoin - an explanation for exponential growth</a></li>
<li><a href="../203532/index.html">Driving LED strip with Raspberry Pi and Android</a></li>
<li><a href="../203536/index.html">Plotagon is his own director</a></li>
<li><a href="../203538/index.html">A brief history of discrete multimedia audio cards</a></li>
<li><a href="../203540/index.html">Angular. Why do not embedded nested</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>