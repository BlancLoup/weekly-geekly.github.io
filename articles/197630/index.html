<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MonoDB vs PostgreSQL performance comparison. Part II: Index</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continued, start here . 

 Experiment II: Index 

 For this experiment, we created indices in the id and floatvalue fields (we omitted the text fields...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MonoDB vs PostgreSQL performance comparison. Part II: Index</h1><div class="post__text post__text-html js-mediator-article">  Continued, start <a href="http://habrahabr.ru/post/197590/">here</a> . <br><br><h4>  Experiment II: Index </h4><br><br>  For this experiment, we created indices in the <b>id</b> and <b>floatvalue fields</b> (we omitted the text fields, we will not touch on the topic of the full-text index, since this is material for a separate article).  Samples from ranges were used as queries: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  10,000 &lt; <b>id</b> &lt;100,000 </li><li>  200,000 &lt; <b>floatvalue</b> &lt;300,000 </li></ul><br><br>  But first, you need to assess how much the insertion speed has dropped after adding indexes.  To do this, add another 250,000 entries to MongoDB and POstgreSQL. <br><br><a name="habracut"></a><br><br>  <b>MongoDB</b> <br><br><pre><code class="bash hljs">Insert 250000 records complete! Total time: 69.453 sec</code> </pre> <br><br>  <b>PostgreSQL</b> <br><br><pre> <code class="bash hljs">psql -d prefTest -f 250k.p5.sql (Total time: 466.153 sec)</code> </pre><br><br>  After simple calculations, it can be understood that MongoDB remained the undisputed leader in the speed of insertion: after adding indexes, its insertion speed dropped by only <b>~ 10%</b> and amounted to <b>3600 objects per second</b> .  Whereas, PostgreSQL insertion speed dropped by <b>~ 30%</b> and amounted to about <b>536 records per second</b> . <br><br>  I would like the sampling situation to be similar.  Perform the following requests: <br><br>  <b>MongoDB</b> <br><br><ol><li> <code>db.tmp.find({$and:[{id:{$gt:10000}},{id:{$lt:100000}}]})</code> </li> <li> <code>db.tmp.find({$and:[{floatvalue: {$lt:300000}},{floatvalue: {$gt:200000}}]})</code> </li> </ol><br><br>  <b>PostgreSQL</b> <br><br><ol><li> <code>select * from tmp where id&gt;10000 and id&lt;100000</code> </li> <li> <code>select * from tmp where floatvalue&lt;300000 and floatvalue&gt;200000</code> </li> </ol><br><br>  However, after comparing the speed of the operations, the situation with the samples changed in favor of PostgreSQL: <br><br><img src="https://habrastorage.org/storage3/6c8/f63/baa/6c8f63baaf514b966113110bad8288a4.png" alt="image"><br><br>  It is also worth noting that when sampling not from a range, but with indication of specific digits (for example, <code>floatvalue=1234567.76545</code> ), both DBMS showed a result in 0 milliseconds.  Therefore, such operations are not even considered here.  This is the question of the reasonable use of indexes in accordance with the planned conditions of the sample.  Here, indexes and queries are used only for the purpose of load testing. <br><br>  Another revelation was that when using MongoDB indexes, the consumption of processor time was so drastically reduced (up to <b>1-2% against 30-40%</b> when searching without indexing), which even outperforms PostgreSQL (down to <b>4-14% against 5-25). %</b> ). <br><br><h4>  Results </h4><br><br>  Before summarizing something, I share it, as promised by the resulting table and resource consumption diagrams for queries: <br><br><img src="https://habrastorage.org/storage3/d2e/585/2fc/d2e5852fc6ebff5f2fdc0f1526cbcb78.png" alt="image"><br><br><img src="https://habrastorage.org/storage3/1e5/5c3/505/1e55c3505140d700d4a32a32b21270d3.png" alt="image"><br><br><img src="https://habrastorage.org/storage3/dd1/e23/e74/dd1e23e740df38250e38c0434a3f039d.png" alt="image"><br><br>  And now about the results. <br><br>  With the naked eye, you can immediately notice one advantage of MongoDB over PostgreSQL: <b>insert speed</b> .  It is almost an order of magnitude higher, both with and without the use of indices.  Moreover, the use of indexes does not significantly reduce it (only <b>~ 10%</b> compared to a <b>30%</b> reduction for PostgreSQL).  This is really an excellent result!  But ... <b>how often do you use the insert relative to the sample (for various conditions)?</b> <br><br>  When sampling from a collection without indices, MongoDB is also in the lead, although not so significantly.  Not bad!  But ... <b>how often do you work with tables without indexes?</b> <br><br>  Do not think that with my questions I am trying to turn you away from noSQL DBMS.  Tables without indices (I do not mean primary) have a place to be in certain solutions.  The priority of insertion speed for some tasks is also very real and, moreover, is sometimes very much in demand.  The question is, <u>does this specifically need you?</u>  Right for your current task?  This (very superficial) testing is not intended to answer the, I will not hide, quite popular question ‚ÄúWhich is better than SQL or noSQL?‚Äù.  It is intended to bring you to thinking, to assess the needs and possibilities when choosing one or another solution for a particular task. <br><br>  Finally, I will say that we, for example, use both types of DBMS, depending on the data structure, goals, and options for working with them.  An integrated approach is much better and allows you to work as optimally as possible with any data. </div><p>Source: <a href="https://habr.com/ru/post/197630/">https://habr.com/ru/post/197630/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197614/index.html">Adaptive English grammar test - learn from personal recommendations with LinguaLeo</a></li>
<li><a href="../197622/index.html">Elektron Octatrack DPS-1 - first impressions</a></li>
<li><a href="../197624/index.html">Backdoor deobfuscation without a single alphanumeric character</a></li>
<li><a href="../197626/index.html">Watson supercomputer trained to diagnose patients and train medical students</a></li>
<li><a href="../197628/index.html">PHP + Java, or In-memory cluster now for PHP developers</a></li>
<li><a href="../197634/index.html">Habrahabr launches startups support program</a></li>
<li><a href="../197638/index.html">Visual specifications</a></li>
<li><a href="../197642/index.html">IT strategy. To be or not to be</a></li>
<li><a href="../197644/index.html">Amazon offers startups up to $ 15,000 for an easy start under the AWS Activate program.</a></li>
<li><a href="../197648/index.html">You can develop your intelligence: 5 ways to maximize your cognitive abilities</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>