<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Microinteractions in iOS. Yandex lecture</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few weeks ago, a special event of the CocoaHeads community took place in the Yandex office - more ambitious than traditional meetings. Developer Ant...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Microinteractions in iOS. Yandex lecture</h1><div class="post__text post__text-html js-mediator-article">  A few weeks ago, a special event of the CocoaHeads community took place in the Yandex office - more ambitious than traditional meetings.  Developer Anton Sergeev spoke at this meeting and talked about the model of micro-interactions that UX-designers usually use, as well as how to put the ideas in it into practice.  Anton paid the most attention to animation. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/JoVBQCwX8ys" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - It is very important for me that I was honored to meet the guests.  I see here those with whom I have been acquainted for a very long time, those with whom I have recently been acquainted, and those with whom I have not yet known.  Welcome to CocoaHeads. <a name="habracut"></a><br><br>  I will tell about microinteractions.  This is a little clickback - we are engineers, developers, let's talk more about the software part, but let's start with a very humanitarian topic, such as microinteraction.  As a result, we will apply this humanitarian theme in the technical part in order to learn more effectively and simply to design very small visual components, such as buttons, small loaders, bars.  They are saturated with animation, and the branched animation code can often look very difficult, it is extremely difficult to maintain. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But first, let's digress a little.  Think about it, do you remember when you decided to become a developer?  I remember that clearly.  It all started with a table.  Once I decided to learn ObjC.  Fashionable language, fun, just like that, without far-reaching plans.  I found the book, it seems, Big Nerd Ranch, and began to read chapter after chapter, perform each exercise, checked, read, until I reached the table.  It was then that I first became acquainted with the delegate pattern, more precisely with its subtype "Data Source", the data source.  This paradigm now seems very simple to me: there is a data source, delegate, everything is simple.  But then it blew my mind: how can I separate a table from completely different data?  You once saw a table on a piece of paper in which you can put an infinite number of lines, completely abstract data.  It affected me a lot.  I realized that programming, development has great opportunities, and it will be very interesting to use them.  Since then, I decided to become a developer. <br><br>  During the development, various patterns were encountered.  Huge, which are called architectures that describe the whole application.  Small, which dozens fit in a small button.  It is important to understand that all these patterns came not from the air, but from the humanitarian industry.  The same delegate pattern.  Delegation appeared long before programming, and programming takes over all these humanitarian things to work more efficiently. <br><br>  Today I will talk about another approach, which adopts another humanitarian thing.  In particular - about microinteraction. <br><br>  It all started with a loader.  In the last work, before Yandex, I had the task to repeat the google material design loader.  There are two of them, one is uncertain, the other is certain.  I had a task to combine them into one, he had to be able to both certain and indefinite, but there were strict requirements for it to be extremely smooth.  At any moment we can go from one state to another, and everything should be smooth and neatly animated. <br><br>  I am a smart developer, I did everything.  I got more than 1000 lines of incomprehensible noodle code.  It worked, but I received a cool remark on the code review: ‚ÄúI really hope that no one will ever rule this code.‚Äù  And for me it is practically incompetent.  I wrote awful code.  It worked cool, it was one of my best animations, but the code was terrible. <br><br>  Today I will try to describe the approach that I discovered after I left that job. <br><br><img src="https://habrastorage.org/webt/w6/93/ez/w693ezlmyrpdyxgcxluxx0scxdo.jpeg"><br><br>  Let's start with the most humanitarian theme - microinteraction models.  How are they embedded and generally where are they hidden in our applications?  We continue with the use of this model in our technical world.  Consider how UIView, which deals with the display and animation, how it works.  In particular, let's talk a lot about the CAAction mechanism, which is closely integrated into UIView, CALayer and works with it.  And then we look at small examples. <br><br>  First definition.  Apparently, the author really liked the ‚Äúmicro‚Äù prefix, but there are no macro or nanointeractions, the size does not matter.  For simplicity, we will simply call them interactions.  This is such a convenient model that allows you to describe any interaction with the application, from beginning to end.  It consists of four points: a trigger, business logic that needs to be implemented in this interaction, feedback to convey something to the user, and a change in the state of the application. <br><br>  I will tell one story with three different roles.  I'll start with the user, as the most important in the development.  When I was preparing for the report, I got sick.  I needed to find a pharmacy, and I opened Yandex.Maps.  I opened the app, look at it, it looks at me, but nothing happens.  I then realized that I‚Äôm the user, I‚Äôm the main user, giving instructions to what the application should do.  I oriented, clicked on the ‚Äúsearch‚Äù button, entered ‚Äúpharmacy‚Äù, clicked ‚ÄúOK‚Äù, the application did the internal work, found the necessary pharmacies that were next to me, and brought it to the screen. <br><br>  I looked for the right one and found that, in addition to the pharmacies, a special button appeared on the screen - to build a route.  Thus, the application has moved to a new state.  I clicked on it, and went to the pharmacy.  I went to this application for some purpose - to find a pharmacy.  I reached it.  I am a happy user. <br><br>  Before this application appeared, and I was able to search for something in it, it was first developed.  What did the UX designer think when he invented this process?  It all started with the need to get out of the dumb scene, when the user and the application look at each other, and nothing happens.  For this was needed some kind of trigger.  Everything has a beginning, and here, too, it was necessary to start somewhere. <br><br>  Trigger was selected - search button.  When clicking on it, it was necessary to solve the problem from a technical point of view.  Request data on the server, parse the response, somehow update the model, analyze.  Request the current position of users and so on.  And so we got this data and know exactly where all the pharmacies are. <br><br>  It would seem that it was possible to finish it.  After all, we solved the problem, found all the pharmacies.  There is only one problem: the user still knows nothing about these pharmacies.  He needs to get it across. <br><br>  Somehow pack our solution to this problem and bring it to him in a beautiful package so that he will understand it.  It so happens that users are people, they interact with the outside world through their senses.  The current state of technology is such that only three senses are available to us, as mobile application developers: vision ‚Äî we can show something on the screen, hearing ‚Äî can reproduce in the speakers, and a tactile sensation, we can push the user into the arm. <br><br>  But the man is much more functional.  But the current state of technology is such that at the moment we can only rely on these three.  And we choose in this case the screen, show on top of the map the nearest pharmacies, and a list with more detailed information about these pharmacies.  And it would seem that everything is exactly there, the user found pharmacies and everything is fine. <br><br>  But there is a problem here.  When the user entered the application, he was in a context in which he does not know where the pharmacies are located.  And the tasks he had to find her.  But now the context has changed, he knows where the pharmacies are, he no longer needs to look for them.  He had the following task - to pave the route to the next pharmacy.  That is why we need to display additional controls on the screen, in particular, this is the button for building a route, that is, to transfer the application to another state in which it is ready to accept new triggers for the next interactions. <br><br>  Imagine, the UX-designer came up with all this, comes to the developer and begins to describe in colors how the user presses the button, how it happens, how it is searched, how the user is satisfied, how we increase the DAU and so on.  The developer‚Äôs stack of unresolved issues overflowed somewhere else on the first sentence, when we first mentioned the button. <br><br>  He listens patiently to everything, and in the end, when it ends, he says that, okay, it's cool, but let's discuss the button.  This is an important element. <br><br>  During the discussion, it turns out that the button is inherently a trigger, it contains within itself the logic by which it can receive messages from the system, in particular about user clicks on the screen.  Based on this click, it can launch a chain of events, which begins with the same button sending messages to different objects about the need to start various processes, in this case request information on the server, some more. <br><br>  When pressed, the button changes its state, it becomes pressed.  When the user releases - ceases to be pressed.  That is, it gives feedback to the user so that he understands what to expect from this button.  And the button can be pressed, not pressed, be active or inactive, in different states, and go through different logic from one state to another. <br><br>  Thus, we looked at the fact that the same microinteraction model, which consists of a trigger, business logic, feedback and state changes, can describe our application at various scales, as in the whole use case, a huge search for the nearest pharmacy, and in terms of a little button. <br><br>  And this is a very convenient model that allows you to simplify the interaction within the team and describe programmatically, to separate four entities: trigger, business logic, feedback, and state change.  Let's see what UIKit provides us to use.  And not just provides, but it uses.  When implementing various animations, a small component of a UIView subclass, it only uses this mechanism and does not follow a different path. <br><br>  Let's start with UIView, how it fits into this model.  Then we will consider CALayer, what it provides to us to maintain these states, and we will consider the mechanism of actions, the most interesting point. <br><br>  Let's start with UIView.  We use it to display some rectangles on the screen.  But in fact, UIView cannot draw itself, it uses another CALayer object for this.  In fact, UIView is responsible for receiving messages about touching the system, as well as other calls, about the API that we have defined in our subclasses of UIView.  Thus, UIView itself implements the trigger logic, that is, the launch of some processes, receiving these messages from the system. <br><br>  Also, UIView can notify its delegates about events that have occurred, and also send messages to subscribers, such as, for example, subclass UIControl with various events.  Thus, the business logic of this UIView is implemented.  Not all of them have business logic; many of them are only display elements and do not have feedback in the sense of business logic. <br><br><img src="https://habrastorage.org/webt/ur/9o/tu/ur9otu78v5xkyy3knr8ze443pl8.jpeg"><br><br>  We looked at two points, a trigger and a business logic.  And where is the feedback and state change hidden in UIView?  To understand this, we must remember that UIView does not exist by itself.  When creating it, it creates itself a backlayer, a subclass of CALayer. <br><br><img src="https://habrastorage.org/webt/_y/dw/wt/_ydwwtnnokhkvxeuj5kl02v4qaa.jpeg"><br><br>  And he appoints himself a delegate.  To understand how UIView uses CALayer, it can exist in different states. <br><br>  How to distinguish one state from another?  They differ in the data set that needs to be stored somewhere.  We will consider what opportunities CALayer provides us with for UIView so that it stores the state. <br><br><img src="https://habrastorage.org/webt/ls/2x/7f/ls2x7f_qs_-ysgeirsunqki1o7o.jpeg"><br><br>  We have a slightly expanded interface, an interaction between UIView and CALayer, and UIView has an additional task - to update the storage inside CALayer. <br><br>  A little-known fact that few people use: CALayer can behave like an associative array, which means that we can write arbitrary data to it on any key as follows: setValue (_: forKey :). <br><br><img src="https://habrastorage.org/webt/hy/l_/r9/hyl_r9663azms_wx4qlf1f12ctw.jpeg"><br><br>  This method is present in all subclasses of NSObject, but unlike many others, when it receives a key that is not redefined by it, it does not fall.  And it records correctly, and then we can count it.  This is a very handy thing that allows, without creating subclasses of CALayer, to write down any data there and then read it in consultation with them.  But this is a very primitive simple repository, in fact, one dictionary.  CALayer is much more progressive.  It supports styles. <br><br>  This is implemented by the Style property that any CALayer has.  By default, it is nil, but we can redefine it and use it. <br><br><img src="https://habrastorage.org/webt/ow/x1/ox/owx1ox1elo1_go_6jxikiuc6fws.jpeg"><br><br>  In general, this is a regular dictionary and nothing more, but it has a peculiarity about how CALayer works with it if we request value forKey, another method that NSObject has.  It acts very interestingly, it searches for the necessary values ‚Äã‚Äãin the style dictionary recursively.  If we pack one style existing in the new style with the style key and write some keys there, it will be searched as follows. <br><br><img src="https://habrastorage.org/webt/xd/m3/z1/xdm3z1vyiscv35nd1jspq5aujve.jpeg"><br><br>  First look at the root, then deep into, and so on, until it makes sense.  When style becomes nil, then there is no sense to look further. <br><br>  In this way, UIView, using the infrastructure provided by CALayer, can organize state changes, update the internal CALayer storage, either using style, a very powerful storage that can simulate a stack, or using a regular associative array, which is also very efficient and very useful . <br><br>  Finished with the repository, start with CAAction.  I will tell you more about him. <br><br><img src="https://habrastorage.org/webt/r7/ay/kz/r7aykzzyhz25wrbcddkax9-oyzm.jpeg"><br><br>  There is a new challenge for UIView - to request actions from CALayer.  What are action games? <br><br><img src="https://habrastorage.org/webt/rk/yi/le/rkyile_6v-vwfrq0d98sgeq4obs.jpeg"><br><br>  CAAction is only a protocol with only one method - run.  Apple generally loves the cinema theme, the action here is like ‚Äúcamera, motor!‚Äù.  This ‚Äúmotor‚Äù is just an action, and it‚Äôs not just that the name was used.  The run method means to launch an action that can start, run and end, which is the most important.  This method is very generic, it has only the string event, and everything else can be of any type.  In ObjC, these are all id and the usual NSDictionary. <br><br><img src="https://habrastorage.org/webt/3u/q-/6z/3uq-6zsnqrcdp_ijgpmbvljcxui.jpeg"><br><br>  Inside UIKit, there are classes that satisfy the CAAction protocol.  First is the animation.  First, we know that you can add animation to a layer, but this is a very low-level thing.  High-level abstraction over it - to launch action with the necessary parameters with a layer. <br><br>  The second important exception is NSNull.  We know that it cannot call any methods, but it satisfies the CAAction protocol, and this is done in order to conveniently look for CAAction on layers. <br><br><img src="https://habrastorage.org/webt/nm/34/9d/nm349dj4-hpwpaf2jshz4bjr6ee.jpeg"><br><br>  As we said before, UIView is a delegate for CALayer, and one of the delegate methods is action (for: forKey :).  The layer has a method, action forKey. <br><br><img src="https://habrastorage.org/webt/xh/1s/wz/xh1swzwsz49zo9iythd65yntg5a.jpeg"><br><br>  We can call it at the layer at any time, and at any time it will give the correct action or nil, as it can also give.  Algorithm is a very unusual search.  Here the pseudocode is written, let's take a look at the lines.  When receiving such a message, he first consults with the delegate.  The delegate can either return nil, which will mean that the search should continue elsewhere, or it can return a valid action, a valid object that satisfies the CAAction protocol.  But there is a logical rule: if it returns an NSNull that satisfies this protocol, then it will later be converted to nil.  That is, if we return Null, in fact it would mean ‚Äústop searching.‚Äù  Action is not and is not necessary. <br><br>  But there is another one.  After he had consulted with the delegate, and the delegate returned nil, he continues to search.  First in the Actions dictionary, which the layer has, and then it will recursively search in the style dictionary, where there can also be a dictionary with the key actions, into which many actions can be written, and it will also be able to search them recursively.  If it doesn‚Äôt work there either, it will request the default action forKey class method, which is defined by CALayer and until recently returned something, but lately it always returns nil in recent iOS versions. <br><br>  Understood with the theory.  Let's see how everything is applied in practice. <br><br>  There are events, they have keys, some actions are taking place on these events.  In principle, two different types of events can be distinguished.  The first is the animation of stored properties.  Suppose when we call View backgroundcolor = red, then it is theoretically possible to animate it. <br><br><img src="https://habrastorage.org/webt/2i/6p/sc/2i6pscholbhv-jvln05rlepz1ru.jpeg"><br><br>  What is the report about patterns without a scheme?  I drew a couple.  UIView has some kind of interface that we defined in subclasses or the one that is received from the system with events.  The task of UIView is to request the necessary action, update the internal store and launch the action that occurred.  The order is very important about the request: the action, only then the update of the action, and only then the update of the store and the action. <br><br><img src="https://habrastorage.org/webt/b4/qu/mm/b4qumm17wvgwfhycn1ld3z7tuka.jpeg"><br><br>  What happens if at UIView we update backgroundColor.  We know that in UIView everything that concerns the display on the screen, it is all the same proxy to CALayer.  It is everything that he receives, just in case, he caches, but at the same time, CALayer broadcasts everything, and CALayer is engaged in all the logic.  What happens inside CALayer when he is asked to change the background?  Everything is a little more complicated here. <br><br><img src="https://habrastorage.org/webt/wd/gd/-p/wdgd-peskdkf3x9pt9ta408lpa8.jpeg"><br><br>  For starters, he will ask for action.  And it is important to understand that the action will be requested first.  This will allow CALayer to ask its current values, including backgroundColor, at the time of the action creation, only then the store will be updated, and when the received action receives the run command, it will be able to consult CALayer and get new values.  Thus, he will have both old and new ones, and this will allow him to create an animation, if there is a need for it. <br><br>  But there is one feature in UIView, if we change the backgroundColor in UIView, if we do it in the animation block, then it is animated, and if outside the animation block, it is not animated. <br><br><img src="https://habrastorage.org/webt/nm/34/9d/nm349dj4-hpwpaf2jshz4bjr6ee.jpeg"><br><br>  It's very simple, there is no magic.  But it suffices to remember that UIView is a delegate to CALayer, it has such a method.  Everything is very simple. <br><br>  If this method was launched in a block of animations, then it will return some kind of action.  If outside the animation block, this method will return NSNull, which means you don‚Äôt need to animate anything.      ,  CALayer      . <br><br>       ,  UIView   ,  .         .       ? <br><br><img src="https://habrastorage.org/webt/hb/bp/j_/hbbpj_qzzphg6b_dvw-mhbmceak.jpeg"><br><br>    ,   .  UIView   ,  read only,      ,  inheritedAnimationDuration.    .      ,      .      . <br><br>    ?          duration,      .        ,   run, ,      . <br><br><img src="https://habrastorage.org/webt/a6/4u/n9/a64un9twddqprjgzjvzwnppwnpk.jpeg"><br><br>       ,   CAAction,  backgroundcolor  opacity,     UIView .  ,      ,  ,  ,  .          .    setValue forKey    ,        ,     ,   ,       ,      ,   . <br><br>     ,       ,    ,   ,   . <br><br>    ‚Äî      . ,    ¬´¬ª  ¬´¬ª   .    . <br><br>    . <br><br><img src="https://habrastorage.org/webt/l6/je/7m/l6je7mjo7fnwwxyvfql1y-yuy0q.jpeg"><br><br>     . ,        ,         ,    .               UIView   CALayer,       ,    , CAAction, ,  ,   . <br><br><img src="https://habrastorage.org/webt/q6/uo/jq/q6uojqtnrhojwxpuuwzxtuentju.jpeg"><br><br><img src="https://habrastorage.org/webt/jg/ax/_s/jgax_s_wow82hbtxeax_29d3brw.jpeg"><br><br> ,     ,    ,       .            ,       .    . <br><br>    .   - . <br><br>             CAAction,    ,   .   ,    ,    ,  . <br><br><img src="https://habrastorage.org/webt/pa/0b/b8/pa0bb8gtuowzwknknhve-btxbsw.jpeg"><br><br>   ,       , ,    home,    .     ,    . ,      . <br><br><img src="https://habrastorage.org/webt/hw/5r/l8/hw5rl8bhdrs4fvmi503inw7iauq.jpeg"><br><br>      .   - . <br><br><img src="https://habrastorage.org/webt/bp/np/di/bpnpdiveiwjnqlxotgrvlr5egj8.jpeg"><br><br>   ,  -    , -   .     ,    ,    .     ,   . <br><br>      ,    ,      . <br><br><img src="https://habrastorage.org/webt/hj/ub/55/hjub55ptyxd7nbmmr9jur-zn3sy.jpeg"><br><br>   ,   CAAction      ,   .     ,   UIControl,  - ,   - ,     ,      ,  -   . <br><br> ,  .  ,  UIView  -,     ,   -   ,       ,   ,      . <br><br>    ‚Äî     .       . <br><br>   ?    .  ,          .      ‚Äî   .      activating,      inactive  active.        ,  ,        . <br><br><img src="https://habrastorage.org/webt/rz/lt/hw/rzlthwfk8lmduvkc_ltfagvorbk.jpeg"><br><br>    .   ,  onOrderIn  onOrderOut.  ,      UIKit,        . <br><br>  ,   -, ‚Äî ,    . <br><br><img src="https://habrastorage.org/webt/q4/8t/2v/q48t2v7xemofbmsmaydyaivlgqw.jpeg"><br><br>    .      UIView  ,      : isActive  progress.        .        CAAction,     . <br><br>   ,   .   ,  , 30 CAACtion,    .          ,   30 ,        NSNull.     15     15 .    .      ‚Äî  .   ,   ‚Äî      . <br><br> ,         .     . <br><br>   .  ,        ,    : , -,     . <br><br>       ,        , .            . ,  UIKit   ,      .   .     ,   ,          ,   .  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/429580/">https://habr.com/ru/post/429580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../429568/index.html">Reduce Zimbra downtime during a server crash with Zextras Backup</a></li>
<li><a href="../429570/index.html">Teaching an agent to play Mario Kart using filters</a></li>
<li><a href="../429572/index.html">Capturing private conversations on Skype with Devicelock DLP</a></li>
<li><a href="../429574/index.html">Free Check Point for Beginners course at CheckMates</a></li>
<li><a href="../429578/index.html">What errors are hiding in the code Infer.NET?</a></li>
<li><a href="../429582/index.html">Analog indicator of computer load</a></li>
<li><a href="../429584/index.html">Yandex launched a rating of Russian sites: the audience is calculated by a mathematical model on machine learning</a></li>
<li><a href="../429586/index.html">How to determine the best time for a transaction on the exchange</a></li>
<li><a href="../429588/index.html">The whole truth about the RTOS. Article # 20. Semaphores: helper services and data structures</a></li>
<li><a href="../429590/index.html">Speech analytics for call centers based on SOLR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>