<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WebRTC # 1 - Meet</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many have already heard about the WebRTC project, some even use it (or are trying to use it in existing projects), while someone maliciously rubs his ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WebRTC # 1 - Meet</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/deb/a57/dfd/deba57dfd758e340ea294ff81d1fbc61.png"><br><br>  Many have already heard about the <a href="http://www.webrtc.org/">WebRTC</a> project, some even use it (or are trying to use it in existing projects), while someone maliciously rubs his hands, anticipating a gradual crackdown on Skype and Flash. <br><br>  Googling in Habr√© (hehe) for some reason I did not find articles that went deep into the technical side of WebRTC, would show examples of its use. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Well, I will try to please you with schemas, code.  In general, precisely the fact that all to taste.  So let's go under the cat, my favorite reader. <br><a name="habracut"></a><br><h4>  What is it? </h4><br>  <abbr title="Web Real-Time Communication">WebRTC</abbr> is a project that allows you to receive media data (audio and video) through a browser and establish a Peer-to-Peer connection between two or more clients, through which regular data and media streams can be transmitted. <br><br>  In essence, WebRTC is: <br>  1. Media Streams (getUserMedia). <br>  2. Peer Connection. <br><br>  Below I will briefly describe these elements, but I still want to leave a detailed description of the following two parts of the article. <br><br><h4>  Media streams </h4><br>  Media Streams - API, allowing access to the camera and microphone through a browser without any plug-ins and flash. <br><br>  Following the WebRTC Public API, we need to use the getUserMedia method of the global navigator object. <br>  It is worth passing three parameters: <br>  - an object with a list of what we need (audio / video) <br>  - success callback <br>  - error callback <br><br>  And while there is a need for crutches due to the presence of prefixes in different browsers: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> getUserMedia; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> browserUserMedia = navigator.webkitGetUserMedia || <span class="hljs-comment"><span class="hljs-comment">// WebKit navigator.mozGetUserMedia || // Mozilla FireFox navigator.getUserMedia; // 2013... if ( !browserUserMedia ) throw 'Your browser doesn\'t support WebRTC'; getUserMedia = browserUserMedia.bind( navigator ); getUserMedia( { audio: true, video: true }, function( stream ) { console.log( stream ); }, function( err ) { console.log( err ); } );</span></span></code> </pre> <br>  Browser nice ask permission. <br><br><img src="https://habrastorage.org/storage2/8d5/713/ef1/8d5713ef1d950ede4110f09414e85cd2.png"><br><br>  Hooray!  We got a stream object with audio and video.  And what to do with it? <br>  We can show this case to the user using the html5 tag "video". <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">video</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"video"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autoplay</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">video</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> videoElement = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById( <span class="hljs-string"><span class="hljs-string">'video'</span></span> ); videoElement.src = URL.createObjectURL( stream );</code> </pre><br>  And a little sugar.  Now you can safely apply html5 filters (webkit) to the video element. <br><br><pre> <code class="css hljs"><span class="hljs-selector-id"><span class="hljs-selector-id">#video</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">-webkit-filter</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">sepia</span></span>(1); }</code> </pre><br>  Cool, isn't it? <br><br><h4>  Peer connection </h4><br>  Peer Connection is the API that allows you to establish a Peer-to-Peer connection between browsers. <br><br>  Below is a simplified diagram of the connection between two clients. <br><img src="https://habrastorage.org/storage2/75f/fad/9d2/75ffad9d2bfa22aff07d8460f477ef8f.png"><br><br>  - The first client sends the so-called Offer to the second client via the server (PeerConnection Observer). <br>  - The second client (Remote Peer) sends a response through the server to the first client. <br>  - Established P2P connection between clients. <br><br>  It is noteworthy that in the future for the operation of such a connection, the server becomes optional.  Those.  after it is turned off, the data will still be transmitted.  Further participation of the PeserConnection Observer is necessary for correct closure of the connection, adding participants to the stream, etc. <br><br>  The specification contains the RTCPeerConnection constructor, but for now we have to use prefixes for various browsers: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> PeerConnection = webkitRTCPeerConnection || <span class="hljs-comment"><span class="hljs-comment">// WebKit mozRTCPeerConnection || // Mozilla FireFox RTCPeerConnection; // 2013... if ( !PeerConnection ) throw 'Your browser doesn\'t support WebRTC';</span></span></code> </pre><br>  Here it is time to consider the server side, but I want to leave the first article more overview. <br><br><h4>  disadvantages </h4><br>  Continuing the "inspection", it is necessary to note the dark side of the project: <br>  1. The API changes because  The project is <a href="http://www.webrtc.org/faq-recent-topics">under active development</a> .  Therefore, sometimes you have to change your code. <br>  2. Before approval of audio and video codecs, problems with cross-platform are possible. <br>  3. Cross-browser compatibility.  We have this picture: <br><table><tbody><tr><th></th><th>  Chrome </th><th>  Firefox </th><th>  Opera </th></tr><tr><td>  getUserMedia </td><td>  Stable (as of version 21) </td><td>  17 </td><td>  12 </td></tr><tr><td>  Peer connection </td><td>  Stable (as of version 23) </td><td>  Nightly </td><td>  - </td></tr></tbody></table><br><h4>  Why then is this all? </h4><br>  I think in the near future we will still get a stable WebRTC API in modern browsers.  This will open up incredible opportunities in web development.  Being interested in this project now, it will be possible to penetrate much more quickly and start using it later. <br>  And no one has canceled projects designed for a specific browser (Chrome Stable, for example).  And it's interesting, right? <br><br><h4>  Further more </h4><br>  Finishing the first part of the series of articles, I would like to make a rough plan: <br>  1. WebRTC # 1 - Meet <br>  2. WebRTC # 2 - Media Streams <br>  3. WebRTC # 3 - Peer Connection: Server Side <br>  4. WebRTC # 4 - Peer Connection: Client Side <br>  five.‚Ä¶ <br><br>  PS If you expect more material, do not swear much.  The topic is very interesting to me, so I am very interested in continuing the cycle, at the same time delving into it. <br><br>  <b>UPD:</b> thanks to <a href="http://habrahabr.ru/users/georp/" class="user_link">GeorP</a> and <a href="http://habrahabr.ru/users/egobrain/" class="user_link">egobrain</a> for the comments. </div><p>Source: <a href="https://habr.com/ru/post/163527/">https://habr.com/ru/post/163527/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../163511/index.html">Pyongyang Racer: the first computer game from North Korea</a></li>
<li><a href="../163515/index.html">ETERNUS DX disk arrays, what's inside. Part 2</a></li>
<li><a href="../163519/index.html">Are you allowed not to go to the office and work from home?</a></li>
<li><a href="../163521/index.html">As children in the experiment secured traffic</a></li>
<li><a href="../163525/index.html">Printing records on a 3D printer</a></li>
<li><a href="../163529/index.html">Docking of the Soyuz-TMA07M with the ISS on the air</a></li>
<li><a href="../163535/index.html">jsFind. Fetching data from an array of objects</a></li>
<li><a href="../163539/index.html">AWS Data Pipeline - data automation</a></li>
<li><a href="../163541/index.html">Getting a passport through the portal gosuslugi.ru</a></li>
<li><a href="../163543/index.html">New type EC2 instance - High-Storage Eight Extra Large</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>