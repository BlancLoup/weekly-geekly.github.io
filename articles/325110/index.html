<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We launch a simple blog on Wagtail CMS (Django) - part 3, final</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The third part about Wagtail CMS, I decided to highlight those moments that helped me again to love Django. Thanks to the large community that develop...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We launch a simple blog on Wagtail CMS (Django) - part 3, final</h1><div class="post__text post__text-html js-mediator-article">  The third part about Wagtail CMS, I decided to highlight those moments that helped me again to love Django.  Thanks to the large community that develops this CMS, anyone will find in it something for themselves. <br><br>  In the final part the following points will be covered: <br><br><ul><li>  Streamfield </li><li>  API + React </li><li>  Development for e-commerce </li></ul><br><img src="https://habrastorage.org/files/2a5/d59/240/2a5d592409df4b8e93bb180e254629b1.png" alt="image"><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://habrahabr.ru/post/303900/">Part 1</a> <br>  <a href="https://habrahabr.ru/post/311756/">Part 2</a> <br><br>  In February 2017, version 1.9.0 was released, in which a lot of new things appeared, and the long-awaited support of the Many-to-Many model. <br><br>  When I first met, I really liked the page editing interface; many things were thought out in it.  But when it took to get something more than the standard Hallo.js plug-in text editor can do, traditional bicycle construction began. <br>  What could be the needs, you ask? <br><br>  For example, add a table, add another style to the line, insert an html tag, insert a picture with style parameters, insert a quote, code, and more.  All this with the standard Hallo.JS plugin cannot be done at all. <br><br><h3>  Streamfield </h3><br>  To solve issues with editing pages, it is better to use the StreamField model built into WagtailCMS. <br><br>  <b>StreamField</b> provides free addition of various elements for a page that does not have a fixed structure ‚Äî for example, blog pages or news pages ‚Äî where text can be mixed with subtitles, images, quotes, video insertion, and more.  It is also suitable for more specialized types of content, such as maps and charts (or, insert HTML on the page).  In this model, different types of content are presented as a sequence of ‚Äúblocks‚Äù that can be repeated and arranged in any order. <br><br>  Now let's see how it looks in code: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.db <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> models <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> wagtail.wagtailcore.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Page <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> wagtail.wagtailcore.fields <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StreamField <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> wagtail.wagtailcore <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> blocks <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> wagtail.wagtailadmin.edit_handlers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FieldPanel, StreamFieldPanel <span class="hljs-comment"><span class="hljs-comment"># StreamFieldPanel from wagtail.wagtailimages.blocks import ImageChooserBlock #  StreamField   class BlogPage(Page): author = models.CharField(max_length=255) date = models.DateField("Post date") body = StreamField([ ('heading', blocks.CharBlock(classname="full title")), ('paragraph', blocks.RichTextBlock()), ('image', ImageChooserBlock()), ]) content_panels = Page.content_panels + [ FieldPanel('author'), FieldPanel('date'), StreamFieldPanel('body'), ]</span></span></code> </pre> <br>  We added StreamField with three blocks to the page - heading, paragraph, image. <br><br>  Now we do not need to use to add text to the page: <br><br><pre> <code class="python hljs">body = RichTextField(blank=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  everything you need is already in the StreamField we created. <br><br>  Migrate - python manage.py makemigrations and python manage.py migrate <br><br>  <b>!</b>  <b>One important note</b> , if you previously had a RichTextField on your page, then you should make small changes to the following instructions before applying migrations: <a href="http://docs.wagtail.io/en/v1.9/topics/streamfield.html">http://docs.wagtail.io/en/v1.9/topics/streamfield.html#streamfield- migrating-richtext</a> <br><br>  Now go to admin.panel and use blocks to add elements to the page. <br><br><img src="https://habrastorage.org/files/738/14b/d22/73814bd222b0438e882fb22f2419f0f7.png" alt="image"><br><br>  Now you need to make changes to the page templates for which the streamfield blocks will be applied. <br><br>  To include this HTML in your page, use the tag: <pre> <code class="python hljs">{% include_block page.body %}</code> </pre> <br><br>  Example: <br><br><pre> <code class="python hljs">&lt;article&gt; {% <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> block <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> page.body %} {% <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> block.block_type == <span class="hljs-string"><span class="hljs-string">'heading'</span></span> %} &lt;h1&gt;{{ block.value }}&lt;/h1&gt; {% <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> %} &lt;section <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">block</span></span></span><span class="hljs-class">-{{ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">block</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">block_type</span></span></span><span class="hljs-class"> }}"&gt; {% </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">include_block</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">block</span></span></span><span class="hljs-class"> %} &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; {% </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> %} {% </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endfor</span></span></span><span class="hljs-class"> %} &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">article</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre> <br>  I showed a simple example with standard blocks, but you have a huge variety of different blocks available, here is a list of some: <br><br><ul><li>  Charblock </li><li>  Textblock </li><li>  Emailblock </li><li>  URLBlock </li><li>  Dateblock </li><li>  RawHTMLBlock </li></ul><br>  I recommend <a href="http://docs.wagtail.io/en/v1.9/topics/streamfield.html">reading the documentation</a> before using StreamField in practice. <br><br><h3>  API + React </h3><br>  If you suddenly need an API for use with React or Vue, then this is not a problem, everything is already implemented in the Wagtail API. <br><br>  To do this, add wagtail.api.v2 to INSTALLED_APPS: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># settings.py INSTALLED_APPS = [ ... 'wagtail.api.v2', ... ]</span></span></code> </pre> <br>  Configure endpoints: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># api.py from wagtail.api.v2.endpoints import PagesAPIEndpoint from wagtail.api.v2.router import WagtailAPIRouter from wagtail.wagtailimages.api.v2.endpoints import ImagesAPIEndpoint from wagtail.wagtaildocs.api.v2.endpoints import DocumentsAPIEndpoint #  . "wagtailapi"   URL. api_router = WagtailAPIRouter('wagtailapi') #     endpoints,    api_router.register_endpoint('pages', PagesAPIEndpoint) api_router.register_endpoint('images', ImagesAPIEndpoint) api_router.register_endpoint('documents', DocumentsAPIEndpoint)</span></span></code> </pre><br>  Next, you need to configure the URL for the API: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># urls.py from .api import api_router urlpatterns = [ ... url(r'^api/v2/', api_router.urls), ... # ,    API  ,  wagtail_urls url(r'', include(wagtail_urls)), ]</span></span></code> </pre><br>  After setting up, the pages will be available at / api / v2 / pages /, images at / api / v2 / images /, and documents when contacting / api / v2 / documents / <br><br>  Optionally, you can also add rest_framework to INSTALLED_APPS.  This will make the API available when viewed using a web browser. <br><br>  Detailed <a href="http://docs.wagtail.io/en/v1.9/advanced_topics/api/index.html">Wagtail API</a> documentation. <br><br>  An excellent example of the implementation of Wagtail CMS + React can be viewed in this project - <a href="https://github.com/emilyhorsman/wagtail-react-blog">https://github.com/emilyhorsman/wagtail-react-blog</a> .  Thanks for the info. <a href="https://habrahabr.ru/users/zpa1972/" class="user_link">Zpa1972</a> <br><br>  <b>Comments plugin</b> <br>  Sometimes it is necessary that the site had comments.  The benefit of ready-made modules for Django is complete, and they are easily integrated into the Wagtail CMS.  But if you decide to implement comments based on Wagtail, then use <a href="https://github.com/takeflight/wagtailcomments">this project</a> . <br><br><h3>  Development for e-commerce </h3><br>  And now we have reached the point that in the Django community causes pain and suffering for many developers.  Development of full-featured e-commerce projects. <br><br>  On one of the projects I needed to create a small online store with an assortment of about 10,000 products, a basket, delivery, order status and an informative admin panel. <br><br>  First of all, I interviewed the community, re-read the forums on the topic, looked through the sources of many projects and decided that the Wagtail CMS would be sawing for a long time, selected Django-oscar. <br><br>  It should be the end of my story, but once again studying the group with questions about Wagtail, I found a developer who was also eager to create a convenient solution for e-commerce based on Wagtail CMS. <br><br>  This is how the project <a href="https://github.com/JamesRamm/longclaw">https://github.com/JamesRamm/longclaw</a> appeared, which James Ramm is actively developing. <br><br>  It is currently under development, but there is already a lot in it.  I think that over time, the Longclaw functionality will be able to fray even Django-oscar. <br><br>  If you have time and desire, I invite you to take part in the development of the project. <br><br><img src="https://habrastorage.org/files/8b6/35a/cf7/8b635acf7266407294b9389f6315ff38.png" alt="image"></div><p>Source: <a href="https://habr.com/ru/post/325110/">https://habr.com/ru/post/325110/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325098/index.html">A new record in speech recognition: the error rate of the algorithm is reduced to 5.5%</a></li>
<li><a href="../325102/index.html">GTK3 applications in a browser with https and basic auth</a></li>
<li><a href="../325104/index.html">Asterisk. Integration with amoCRM, step-by-step guide</a></li>
<li><a href="../325106/index.html">Vivaldi 1.8 - Immersion in history</a></li>
<li><a href="../325108/index.html">‚ÄúFifth Element‚Äù in R. Ecosystem. WYSIWYG Interface for Analysts</a></li>
<li><a href="../325112/index.html">It's time to change: what will happen to working sites and why they are not the same</a></li>
<li><a href="../325114/index.html">The phenomenon of "Taobao villages"</a></li>
<li><a href="../325116/index.html">Git scaling (and some background history)</a></li>
<li><a href="../325118/index.html">Vertical centering of simple divs with data-</a></li>
<li><a href="../325120/index.html">Hello, Schulte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>