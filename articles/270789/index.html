<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sublime Text as IDE for ARM using STM32 as an example</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will explain how to create a Sublime Text assembly with additional programs that can be used as a development environment for microcontro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sublime Text as IDE for ARM using STM32 as an example</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/4e1/f24/c81/4e1f24c8148c4e589aa167766c0b9d37.png" alt="image"><br><br>  This article will explain how to create a Sublime Text assembly with additional programs that can be used as a development environment for microcontrollers, in particular the STM32F10x.  So, we have a task to do with the help of Sublime Text - IDE, which includes: static analysis and code completion at the moment of its writing, project building system using makefile, compiler, linker, microcontroller firmware and debugging.  In addition, the assembly will work without installation. <br><a name="habracut"></a><br><h1>  Creating the directory structure and bat file startup: </h1><br>  First you need to download the necessary programs: <br><br>  1. Actually <a href="http://www.sublimetext.com/3">Sublime Text 3 portable</a> <br>  2. Gul <a href="https://launchpad.net/gcc-arm-embedded/%2Bdownload">ARM Embedded</a> tulchain (archived) <br>  3. <a href="http://llvm.org/releases/download.html">Clang (LLVM)</a> for static code analysis <br>  4. <a href="">Make</a> to automate project build, firmware and debugging <br>  5. <a href="http://www.freddiechopin.info/en/download/category/4-openocd">OpenOCD</a> for flashing and debugging 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Next, create a directory for our assembly and unpack each program into previously created directories.  For Clang, you first need to install the downloaded LLVM, and then just copy the directory from LLVM from the installation path to the directory of our assembly. <br>  Create a bat file in the root of the build directory.  It should look like this: <br><br><img src="https://habrastorage.org/files/a36/ac3/1fb/a36ac31fbe50427299e6a62baacb28a1.png" alt="image"><br><br>  A bat file is needed in order for Sublime Text to start with the PATH variable containing the paths of additional programs.  In the bat file we write the following: <br><br><pre><code class="hljs perl">::  DEVELOP_ROOT,     () bat- set DEVELOP_ROOT=%~dp<span class="hljs-number"><span class="hljs-number">0</span></span> ::    PATH PATH %DEVELOP_ROOT%GCC ARM none eabi\bin;%DEVELOP_ROOT%LLVM\bin;%DEVELOP_ROOT%make;%DEVELOP_ROOT%openOCD\bin;%PATH% :: Sublime Text start <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-string"><span class="hljs-string">"%DEVELOP_ROOT%Sublime Text\sublime_text.exe"</span></span></code> </pre> <br><h1>  Install and configure the necessary plugins: </h1><br>  Install Package Control: Start Sublime Text, go to the Package Control website in the browser <a href="https://packagecontrol.io/installation">Link</a> , insert the Package Control installation line into the console (Ctrl + ~) Sublime Text, reboot Sublime Text. <br><br>  In Sublime Text, install the necessary plugins (using Ctrl + Shift + P, then write Install Pakage): <br><br><ul><li>  Sublimelinter </li><li>  SublimeLinter-contrib-clang </li><li>  SublimeGDB </li><li>  Terminal </li><li>  All autocomplete </li><li>  ARM Assembly </li></ul><br>  All Autocomplete - plugin for code autocompletion on the fly.  Offers suitable combinations of files that are opened in Sublime Text tabs. <br><br>  ARM Assembly - to highlight the syntax of the assembler. <br><br>  Next, you need to register the settings for these plugins.  Settings are below: <br><br>  Preferences-&gt; Package Settings-&gt; SublimeLinter-&gt; Settings - User: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"user"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"debug"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"delay"</span></span>: <span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-attr"><span class="hljs-attr">"error_color"</span></span>: <span class="hljs-string"><span class="hljs-string">"D02000"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gutter_theme"</span></span>: <span class="hljs-string"><span class="hljs-string">"Packages/SublimeLinter/gutter-themes/Default/Default.gutter-theme"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gutter_theme_excludes"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"lint_mode"</span></span>: <span class="hljs-string"><span class="hljs-string">"background"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"linters"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"clang"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@disable"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"args"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"excludes"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"extra_flags"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"include_dirs"</span></span>: [] } }, <span class="hljs-attr"><span class="hljs-attr">"mark_style"</span></span>: <span class="hljs-string"><span class="hljs-string">"outline"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"no_column_highlights_line"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"passive_warnings"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"paths"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"linux"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"osx"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"windows"</span></span>: [] }, <span class="hljs-attr"><span class="hljs-attr">"python_paths"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"linux"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"osx"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"windows"</span></span>: [] }, <span class="hljs-attr"><span class="hljs-attr">"rc_search_limit"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">"shell_timeout"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show_errors_on_save"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show_marks_in_minimap"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"syntax_map"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"html (django)"</span></span>: <span class="hljs-string"><span class="hljs-string">"html"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"html (rails)"</span></span>: <span class="hljs-string"><span class="hljs-string">"html"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"html 5"</span></span>: <span class="hljs-string"><span class="hljs-string">"html"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"javascript (babel)"</span></span>: <span class="hljs-string"><span class="hljs-string">"javascript"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"php"</span></span>: <span class="hljs-string"><span class="hljs-string">"html"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"python django"</span></span>: <span class="hljs-string"><span class="hljs-string">"python"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"warning_color"</span></span>: <span class="hljs-string"><span class="hljs-string">"DDB700"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"wrap_find"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } }</code> </pre><br>  Preferences-&gt; Package Settings-&gt; SublimeGDB-&gt; Settings - User: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"file_group"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"session_group"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"session_open"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"console_group"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"console_open"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"variables_group"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"variables_open"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"callstack_group"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"callstack_open"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"registers_group"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"registers_open"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"disassembly_group"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"disassembly_open"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threads_group"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threads_open"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"breakpoints_group"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">"breakpoints_open"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre><br>  Preferences-&gt; Package Settings-&gt; Terminal-&gt; Settings - User: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"terminal"</span></span>: <span class="hljs-string"><span class="hljs-string">"cmd"</span></span> }</code> </pre><br><h1>  Configure project file: </h1><br>  At this stage, you can already open a <a href="">test project for the STM32F10x</a> .  Below is the content of the test project file (* .sublime-project): <br><br><pre> <code class="hljs bash">{ <span class="hljs-string"><span class="hljs-string">"build_systems"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"cmd"</span></span>: [<span class="hljs-string"><span class="hljs-string">"make"</span></span>], <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"ARM build"</span></span>, <span class="hljs-string"><span class="hljs-string">"working_dir"</span></span>: <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project_path}</span></span></span><span class="hljs-string">"</span></span>, <span class="hljs-string"><span class="hljs-string">"file_regex"</span></span>: <span class="hljs-string"><span class="hljs-string">"^(^\\S.*\\.\\w+):(\\d+):(\\d+): (\\w+ ?\\w+?): (.*)$"</span></span> } ], <span class="hljs-string"><span class="hljs-string">"folders"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"follow_symlinks"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"."</span></span> } ], //   <span class="hljs-string"><span class="hljs-string">"SublimeLinter"</span></span>: { <span class="hljs-string"><span class="hljs-string">"linters"</span></span>: { <span class="hljs-string"><span class="hljs-string">"clang"</span></span>: { // ,    ,   <span class="hljs-string"><span class="hljs-string">"include_dirs"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project}</span></span></span><span class="hljs-string">/CMSIS"</span></span>, <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project}</span></span></span><span class="hljs-string">/StdPeriphLib"</span></span>, <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project}</span></span></span><span class="hljs-string">/user-code"</span></span>, <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project}</span></span></span><span class="hljs-string">/user-code/FatFs"</span></span> ], //   Clang <span class="hljs-string"><span class="hljs-string">"extra_flags"</span></span>:<span class="hljs-string"><span class="hljs-string">"-DSTM32F10X_MD_VL"</span></span> } } }, <span class="hljs-string"><span class="hljs-string">"settings"</span></span>: { <span class="hljs-string"><span class="hljs-string">"sublimegdb_workingdir"</span></span>: <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project_path:out/hex/}</span></span></span><span class="hljs-string">"</span></span>, <span class="hljs-string"><span class="hljs-string">"sublimegdb_commandline"</span></span>: <span class="hljs-string"><span class="hljs-string">"arm-none-eabi-gdb --interpreter=mi *.elf"</span></span> } }</code> </pre><br>  We will analyze this file in more detail.  Define the command that will be launched when building the project (Ctrl + B): <br><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"cmd"</span></span>: [<span class="hljs-string"><span class="hljs-string">"make"</span></span>]</code> </pre><br>  The name of the build_system (can be any): <br><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"ARM build"</span></span></code> </pre><br>  The working directory of the project, relative to this path, runs the command in the "cmd" field: <br><br><pre> <code class="hljs perl"><span class="hljs-string"><span class="hljs-string">"working_dir"</span></span>: <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${project_path}</span></span></span><span class="hljs-string">"</span></span></code> </pre><br>  Regular expression for quick transitions by message in the project build log (for F4, Shift + F4): <br><br><pre> <code class="hljs tex">"file_regex": "^(^<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>S.*<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>.<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>w+):(<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>d+):(<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>d+): (<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>w+ ?<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>w+?): (.*)<span class="hljs-formula"><span class="hljs-formula">$"</span></span></code> </pre><br>  The paths to the directories of the project with the source code are written in the makefile, but since Clang does not remove them from the makefile, in the project settings in the section ‚ÄúSublimeLinter‚Äù -&gt; ‚Äúlinters‚Äù -&gt; ‚Äúclang‚Äù -&gt; ‚Äúinclude_dirs‚Äù - you need to set the paths to these directories that will be passed to Clang for source code analysis.  Otherwise, we get an error from Clang of the form "such a plug-in header file was not found." <br><br>  The same applies to the preprocessor directives, in our case it is "-DSTM32F10X_MD_VL".  This directive is written in a makefile, but we still need to add it to the project settings for Clang: ‚ÄúSublimeLinter‚Äù -&gt; ‚Äúlinters‚Äù -&gt; ‚Äúclang‚Äù -&gt; ‚Äúextra_flags‚Äù.  Otherwise, Clang will not be able to verify this type of code (in the stm32f10x.h file): <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> !defined (STM32F10X_LD) &amp;&amp; !defined (STM32F10X_LD_VL) &amp;&amp; !defined (STM32F10X_MD) &amp;&amp; !defined (STM32F10X_MD_VL) &amp;&amp; !defined (STM32F10X_HD) &amp;&amp; !defined (STM32F10X_HD_VL) &amp;&amp; !defined (STM32F10X_XL) &amp;&amp; !defined (STM32F10X_CL) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Please select first the target STM32F10x device used in your application (in stm32f10x.h file)"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre><br>  Next in the project settings there is a section ‚Äúsettings‚Äù - here are the project settings for the SublimeGDB plugin: <br><br>  Path to elf firmware file: <br><br><pre> <code class="hljs perl"><span class="hljs-string"><span class="hljs-string">"sublimegdb_workingdir"</span></span>: <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${project_path:out/</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">hex</span></span></span></span><span class="hljs-string"><span class="hljs-subst">/}</span></span></span><span class="hljs-string">"</span></span>,</code> </pre><br>  The command to start the debugger: <br><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"sublimegdb_commandline"</span></span>: <span class="hljs-string"><span class="hljs-string">"arm-none-eabi-gdb --interpreter=mi *.elf"</span></span></code> </pre><br>  At this stage we can already build the project.  Press Ctrl + B and see the build log. <br><br><img src="https://habrastorage.org/files/74b/014/fc4/74b014fc4b344560ab151eb7cfc71477.png" alt="image"><br><br>  We also see that in the project directory the ‚Äúout‚Äù directory has been created anew, and in it in the corresponding directories are the firmware files, the listing and the object files. <br><br><h1>  Firmware: </h1><br>  We will flash the microcontroller using openOCD.  There is a feature here: openOCD does not work with standard ST-LINK programmer drivers.  By default, ST-LINK is defined as ‚ÄúUSB storage device‚Äù, that is, we need to replace the USBSTOR driver with WinUSB using the <a href="http://zadig.akeo.ie/">Zadig</a> program.  Download, run, select ‚ÄúList All Devices‚Äù in the options, select the ‚ÄúSTM32 STLink‚Äù device and click on the ‚ÄúReplace Driver‚Äù button. <br><br><img src="https://habrastorage.org/files/753/a5d/6b6/753a5d6b660c4239b20aa1d4f03f68bc.png" alt="image"><br><br><img src="https://habrastorage.org/files/946/2a5/709/9462a5709ada4846830bd5ff99ea416c.png" alt="image"><br><br>  Done!  To flash the microcontroller, you need to connect the programmer, open the terminal in the folder with makefile and execute the ‚Äúmake program‚Äù (you can select the project folder directly in Sublime Text and press Ctrl + Shift + T to quickly open the terminal). <br><br><img src="https://habrastorage.org/files/529/fde/652/529fde65213a430caba5770fb418d5c2.png" alt="image"><br><br>  To use another programmer, you need to change the corresponding lines in the makefile. <br>  It is not always convenient, but if you want the microcontroller to flash automatically when building a project, you need to uncomment the line in the makefile: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># $(MAKE) program</span></span></code> </pre><br>  So, it remains to deal with debugging. <br><br><h1>  Debugging: </h1><br>  We start the GDB server: we open the terminal in the directory with the makefile and execute ‚Äúmake debug‚Äù in it <br><br><img src="https://habrastorage.org/files/51f/204/dca/51f204dca44c41319adbc14553775f87.png" alt="image"><br><br>  Now in Sublime Text just press F5 (you can change it in the settings of SublimeGDB), the interface of the SublimeGDB plugin will open and in the command line enter the following: <br> <code>target remote localhost:3333 <br></code> <br><br><img src="https://habrastorage.org/files/d46/80c/3db/d4680c3db0ef44a4986cb8e6a7a74854.png" alt="image"><br><br>  Is done.  Now you can use debugging.  Here it is worth clarifying: at the moment only the registers of the ARM poison itself are available for viewing, but not the periphery.  I am in search of a solution to this issue, as well as bringing the values ‚Äã‚Äãof the core registers to a normal form.  All hotkeys for debugging can be changed in the settings of the SublimeGDB plugin. <br><br><img src="https://habrastorage.org/files/d55/7fa/715/d557fa7156b04f5aba2b73bde28d7ee6.png" alt="image"><br><br>  To finish debugging in Sublime Text, press Ctrl + F5 (you can also change it in the settings) <br><br><h1>  Creating a new project: </h1><br>  To create a new project based on the existing one, you need: <br><br>  1. Copy the existing project directory with the new project name; <br>  2. Rename the project file * .sublime-project to the name of the new project; <br>  3. In the makefile, change the value of the TARGET variable to the name of the new project: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta">#  : TARGET = STM32-test2-FatFs</span></span></code> </pre><br>  If you need to change the project directory structure, simply change the value of the SRCDIR variable in the makefile: <br><br><pre> <code class="hljs mel">#      : SRCDIR = $(BASE) SRCDIR += $(BASE)\CMSIS SRCDIR += $(BASE)\StdPeriphLib SRCDIR += $(BASE)\user-code SRCDIR += $(BASE)\user-code\FatFs</code> </pre><br>  And the ‚Äúinclude_dirs‚Äù field in the project settings (* .sublime-project). <br><br>  Video explaining all of the above: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/-8scgw_qNLY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  <a href="https://drive.google.com/file/d/0BxFXWStb7G9SdGY1MlNyNWpFUGs">Link</a> for downloading a customized Sublime Text with additional programs. <br><br>  <a href="https://drive.google.com/file/d/0BxFXWStb7G9SWGhzX0JlLUVKV2c">Link</a> to download the test project discussed in this article. <br><br>  <b>UDP 1.</b> In Linux for openocd to work with ST-Link, you need to add a rule for a USB device as follows: from the / usr / share / openocd / contrib directory copy the file ‚Äú99-openocd.rules‚Äù to the /etc/udev/rules.d directory .  Then restart the system. <br><br>  <b>UDP 2.</b> Projects have been added for: <br>  <a href="https://drive.google.com/file/d/0BxFXWStb7G9STjBpNUk3WV9UVTQ">STM32F4</a> , <br>  <a href="https://drive.google.com/file/d/0BxFXWStb7G9SdUNrMmU0dnJCZ2c">MSP430</a> , <br>  <a href="https://drive.google.com/file/d/0BxFXWStb7G9SWTJ6OHpIT1R1Yzg">ESP8266</a> . </div><p>Source: <a href="https://habr.com/ru/post/270789/">https://habr.com/ru/post/270789/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../27078/index.html">MTS connected to the turnstiles</a></li>
<li><a href="../270781/index.html">About UWP Apps for WPF Developers</a></li>
<li><a href="../270783/index.html">The Empire Strikes Back</a></li>
<li><a href="../270785/index.html">666th Post: Fears and Superstitions of IT Professionals</a></li>
<li><a href="../270787/index.html">Early detection of cyber threats in the enterprise</a></li>
<li><a href="../27079/index.html">Business development in startups</a></li>
<li><a href="../270791/index.html">DataTalks # 4: Predictive Analytics</a></li>
<li><a href="../270793/index.html">New formats of mobile advertising, disassembling iOS - Android, and a lot of analytics in the news of the week for mobile developers</a></li>
<li><a href="../270795/index.html">Share experience. FirePOWER Services Integration on Cisco ASA</a></li>
<li><a href="../270797/index.html">We write a simple virtual machine in Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>