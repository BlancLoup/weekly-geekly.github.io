<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Optimization of animations in Unity3D</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Use frame-by-frame animations in Unity3D 
 Surely, you have noticed that creating a new animation in Unity 5 immediately places a link to the SpriteRe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Optimization of animations in Unity3D</h1><div class="post__text post__text-html js-mediator-article"><h4>  Use frame-by-frame animations in Unity3D </h4><br>  Surely, you have noticed that creating a new animation in <b>Unity 5</b> immediately places a link to the <b>SpriteRenderer</b> component's <b>sprite</b> .  <b>Unity</b> calls you to select the prepared frames and drag them to the <b>Animation</b> window. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/09b/560/1ce/09b5601ceabd36c385698865faf40201.png"><br><br>  A couple of mouse movements and new animation decorates your game.  But for 1 second video you need 12 - 30 frames.  And if a character performs a dozen different movements: runs, reads, plants, waters, plays, sunbathes, etc., then the duration of all the animations passes in a minute, and frames per thousand.  And the character is not the only animated object on the level.  Here we also received that not especially difficult scene is loaded longer than a minute, and <b>Unity</b> starts to fly because of an overrun of random access memory.  Yes, of course, you can use the built in <b>Unity SpritePacker to</b> pack sprites into atlases, but this gives only a minor result and an improvement in productivity by 10 - 20%. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/13b/8e7/dbf/13b8e7dbf4459fe22b13e071ccb98641.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Replacing frame-by-frame animations with skeletal </h4><br>  To achieve more tangible results, we decided to replace frame-by-frame animations with skeletal ones.  Instead of a rectangle on which the sprite is drawn, a more complex model is created, on which parts of the character are drawn from the atlas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/41c/e47/407/41ce474075c09ef62296bdf79c9ab43a.jpg"><br><br>  Animation is obtained by the movements of this model.  Do not worry, in fact, everything is simple!  There are several tools for creating skeletal 2d animations for units: <a href="http://ru.esotericsoftware.com/">Spine</a> , <a href="http://dragonbones.com/">DragonBones</a> , <a href="https://anima2d.com/">Anima2D</a> , <a href="https://www.adobe.com/ru/products/animate.html">Adobe Flash</a> , etc. <br>  Since  Our artist did all the animations in <b>Flash</b> for us best suited <a href="https://gafmedia.com/">GAF</a> . <br><br><h4>  Importing animations from <b>Flash</b> to <b>Unity3D</b> </h4><br><ol><li>  Import <a href="https://www.assetstore.unity3d.com/en/">GAF from Unity AssetStore</a> ; </li><li>  Drag the * .swf file into the converter window; </li><li>  Create an object and customize it.  All settings are intuitive: </li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/b5b/ce9/511/b5bce9511f9620027c50087d2b8af27a.jpg"><br><br>  Animations are created automatically, based on the markup made in <b>Flash</b> . <br><br>  To run the necessary animations, we use scripting: <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> GAF.Core;<span class="hljs-comment"><span class="hljs-comment">//   GAF public class Mouse : MonoBehaviour { //      [SerializeField] private GAFMovieClip GAFMovieClip; void Update () { if (Input.GetKeyDown(KeyCode.RightArrow))//   "" GAFMovieClip.setSequence("run", true);//  run  } }</span></span></code> </pre> <br><h4>  Setting transitions in <b>Unity Animator</b> </h4><br>  In the <a href="https://www.assetstore.unity3d.com/en/">Pro-version of GAF</a> , it is possible to use a native <b>Unity</b> animator, which will make development much easier.  However, we must remember that our type of animation does not support mixing.  <b>Unity</b> defaults to mixing clips.  So our animations can break at the transitions between clips.  To make the animation work smoothly turn off the mixing of clips: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c31/4b9/86b/c314b986b757736a5ddc102f4b057be9.jpg"><br><br><h4>  Editing Animated Clips </h4><br>  If it turns out that you did not create the necessary clips in <b>Flash,</b> you can assemble them directly in <b>Unity</b> , by calling the <b>updateToFrameAnimator ()</b> function and specifying the required frame as a parameter. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/363/d66/24f/363d6624f1e67b26093da28447d837cb.png"><br><br><h4>  Results: </h4><br>  So replacing frame-by-frame animations with animations created in <b>Flash</b> , the loading time of scenes has decreased by 10 times!  Accordingly, the consumption of RAM was significantly reduced. <br><br><h4>  Useful links: </h4><br>  <a href="https://youtu.be/cD2Iuv26B9c">Video Tutorial "Using Flash Animations in Unity3D"</a> <br>  <a href="http://unity3d.ru/distribution/viewtopic.php%3Ff%3D16%26t%3D30486">GAF: import of Flash animations in Unity3d</a> </div><p>Source: <a href="https://habr.com/ru/post/322280/">https://habr.com/ru/post/322280/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322270/index.html">In defense, Zuckerberg takes Evan Spiegel "by the throat"</a></li>
<li><a href="../322272/index.html">How to wind 40k views on Habrahabr. Bug or feature?</a></li>
<li><a href="../322274/index.html">Business rule repositories and corresponding code blocks that are embedded in production</a></li>
<li><a href="../322276/index.html">Myths about the CAP theorem</a></li>
<li><a href="../322278/index.html">Web interface for your Asterisk. Statistics for call-centers, sales departments, listening to calls and much more</a></li>
<li><a href="../322282/index.html">‚ÄúOther blogs‚Äù: Lecturers, graduates and students of the ITMO University on Habr√©</a></li>
<li><a href="../322284/index.html">5 hobbies of a real developer</a></li>
<li><a href="../322286/index.html">Advantages of the Interval Memory Method</a></li>
<li><a href="../322288/index.html">Organization of control over the observance of response time to customer calls in the service department</a></li>
<li><a href="../322292/index.html">An open letter to IT recruiters</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>