<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Blacklists: Cyber ‚Äã‚ÄãDefense in the Age of Advanced Sustainable Threats</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Due to the abundance of reports of database theft in trading companies, industrial espionage with the help of advanced persistent threats, the taking ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Blacklists: Cyber ‚Äã‚ÄãDefense in the Age of Advanced Sustainable Threats</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/6b3/ad1/263/6b3ad12634844a458691e6326010c908.jpg"><br><br>  Due to the abundance of reports of database theft in trading companies, industrial espionage with the help of advanced persistent threats, the taking of important data into hostages by ransomware of important data, it becomes clear why many in the field of information security began to refuse preventive measures and focus on the identification of threats and timely response to emergency situations. <br><br>  Most modern security systems are based on blacklists.  However, analyzing signatures, antiviruses and reputation lists of IP addresses prove by their example that technologies based on blacklists are already ineffective.  After all, an attacker does not cost anything to change IP or build a new executable file.  Nevertheless, many companies continue to expand their networks, the security of which depends entirely on blacklists.  And the transfer of efforts to the field of identifying threats and timely response will not help to improve the situation until we learn to reliably block most attacks.  Moreover, it is now very difficult to compile and maintain black lists of IP addresses, because due to the exhaustion of the IPv4 address space, dozens of different domains can use the same address through <a href="https://ru.wikipedia.org/wiki/Content_Delivery_Network">the content delivery network (CDN)</a> . <br><a name="habracut"></a><br>  A striking example of a virus that inflicts heavy losses was <a href="http://blog.emsisoft.com/2013/09/10/cryptolocker-a-new-ransomware-variant/">CryptoLocker</a> .  It is usually distributed via phishing emails with an archived executable file.  When it starts, the application installs itself in the Application Data folder of the current Windows user profile.  The trojan then calls the remote control server, requests the cryptokey and encrypts all data on the computer that it can reach.  After that, the extortion of money begins for the provision of a decryption key.  If the victim does not want or can not pay, then you have to restore the data from the backup.  The authors of the virus took care of the tools to quickly generate new versions of the executable file, which makes all signature-based detection systems ineffective.  And generating a new malicious payload costs almost nothing. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      An effective way to combat CryptoLocker is to use the whitelist of applications on the user's computer.  If the application is not trusted, then its execution should not be allowed.  Unfortunately, most implementations are too uncomfortable and difficult, which is why this approach has not gained much popularity.  On the one hand, all corporate and server versions of Windows have a software restriction policy (Software Restriction Policies) or AppLocker, so additional software costs for the company can be neglected.  However, you need to spend time and effort on the introduction of the mechanism of white lists.  But the cost of its support does not exceed the cost of recovery after the "infection".  Most importantly, whitelisting reduces the risk of a security breach many times over. <br><br>  Since the days of <a href="http://www.tripwire.com/">Tripwire,</a> whitelisting technology has evolved markedly.  For example, static hashes are used to identify changes.  New solutions, like AppLocker, can use signatures, file hashes and path rules to create more flexible rules.  For example, with the help of a signature, you can whitelist any application starting with a certain version, and all other releases will inherit the prescribed policies. <br><br>  Although the control of placement paths is not technically as effective as the control of hashes or publishers, it still makes it difficult for attackers to work, because the white list cannot be edited from under non-administrator accounts.  The attacker cannot simply deceive the user by presenting his virus as a ‚Äúgood‚Äù application, he will have to use vulnerabilities in the transfer of privileges, which makes it difficult to achieve the goal.  In addition, the control of publishers and placement paths can help the weekend support service deal with all after-hour applications without putting them on whitelisting policies.  And as soon as the client machines enter the corporate network, the VPN will allow them to update policies for new applications prepared for remote users. <br><br><h3>  Cost of infection </h3><br>  Consider the cost of recovery after infection with some simple virus.  Most companies rightly believe that once an infected computer can no longer be considered trusted, and its system must be reinstalled from the image.  For example, you can use <a href="https://ru.wikipedia.org/wiki/System_Center_Configuration_Manager">System Center Configuration Manager</a> to create images.  It takes at least two hours to copy data from an infected computer, check it for cleanliness, roll up the system from an image, fill it with data back to a computer and conduct final checks with a technician.  Even if the user is provided with a backup laptop for this time, some time is lost for replacement.  And when a restored car is returned to him, there are temporary losses to bring the system to its usual state.  Suppose a techie‚Äôs work hour costs $ 25, and a user $ 50;  then the total cost of the restoration will be about $ 150, not counting the costs of the work of the infrastructure for restoring images, and eliminating other possible damage.  Idle time can be reduced if you provide a backup laptop to the user, but in any case there will be a loss of performance due to the replacement procedure, the transfer of files and data, and the installation of the necessary software on the laptop. <br><br>  Comparative table of the cost of restoration in a company with 800 employees: <br><br><table><tbody><tr><th>  Cost type </th><th>  Without whitelists </th><th>  With white lists </th></tr><tr><td>  The number of restorations from images and the number of rules </td><td>  Weekly need to restore 1-2 computers </td><td>  Every week you need to explore 2-3 new applications and create rules for them </td></tr><tr><td>  The cost of one incident </td><td>  $ 50 to restore the computer </td><td>  $ 50 per hour sysadmin </td></tr><tr><td>  Performance loss </td><td>  $ 50 user waiting for a backup computer </td><td>  $ 25 user waiting for whitelisting </td></tr><tr><td>  Annual costs </td><td>  $ 5 200‚Äì10 400, not counting the higher risk of a serious security breach </td><td>  $ 5,200‚Äì6,800 </td></tr></tbody></table><br>  Costs increase significantly if the virus manages to get to important data.  Computer and technical expertise can cost hundreds of dollars per hour.  If a whole network is compromised, which often happens during large-scale attacks, a trustworthy examination can exceed $ 100,000. In 2014, the average cost of one data leakage was about $ 3.5 million. This is the nightmare of every company executive. <br><br><h3>  The cost of white lists </h3><br>  Here, the main expenses depend on the time it takes for system administrators to add applications to the white lists.  According to statistics, one application takes less than half an hour.  If at this time the user is forced to wait, then the cost of work doubles.  But even in this case it turns out twice cheaper compared to the simplest recovery after infection.  Add to this another multiple reduction in the risk of data leakage, which can be considered as paying for the costs of using white lists. <br><br>  The annual cost data presented in the table are obtained on the basis of statistics of incidents occurring in the company where Aaron B√∂ring and Kyle Salus work, before and after the introduction of white lists.  Under the conditions of that IT-environment, the cost of supporting white lists does not exceed the cost of recovering from infections, and the risks are much lower. <br><br>  Also note that all calculations were made on the basis of the adopted work processes and the level of remuneration in that company.  Perhaps, in your organization, the cost of supporting white lists will be much lower than the cost of restoration.  In addition, nothing prevents the use of white lists only on the most critical areas, when working with the most important data.  But the most important thing is not to compare costs, but to reduce risks.  This is the main advantage of whitelists, because the cost of their support is not comparable with the possible losses in case of leakage of important data, including reputational data. <br><br><h3>  Introduction of whitelists </h3><br>  For rarely updated systems, such as kiosks or terminals in retail outlets, you can apply a limited AppLocker policy based on the "golden" image.  It allows you to perform only those applications that are <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D40330">available in this image</a> .  In more dynamic systems, standard rules and restriction of administrative privileges can be combined, with permission to launch only from folders that can be filled only by administrators.  To increase the flexibility of the rules, you can use the control of publishers, that is, to run only applications signed by trusted vendors.  This, of course, is not a panacea, this system has its own vulnerabilities.  For example, scripting languages ‚Äã‚Äãor software exploits.  All these possible routes of penetration will need to be given separate attention. <br><br>  According to the <a href="http://www.asd.gov.au/infosec/mitigationstrategies.htm">best information security</a> practices, end users should not be administrators, and should not even have administrative rights on their own computer.  Viruses often use well thought-out approaches from social engineering to infect.  Typical tricks include trying to convince a user to click on a link, open a document, or directly install an application.  There is no way to keep the user from falling into such traps.  This means that in order to protect computers and networks, it is necessary to check and confirm the level of power of attorney of any executable code.  And it should be done by those who can confirm the legitimacy of each application.  It seems that such an idea scares many participants in the information security industry, but it is still the most effective way to protect today.  The idea is not at all revolutionary, it implies only the forced use of policies and procedures that we, as IT security experts, have already created. <br><br>  End users are provided with computers on which approved applications of respective versions are installed, whose functionality and compatibility has been tested.  The use of white lists implies the need to identify programs and provide explicit permission to run them.  Each new application must first be whitelisted and then deployed on a machine or in a networked work environment. <br><br>  With VPN, you can quickly deploy white lists both locally and remotely.  By default, you can run any applications installed in the Program Files or Windows folders.  Publisher control allows you to install and execute any code signed by a trusted vendor.  This reduces the amount of work on supporting whitelists when you only need to create rules for unsigned applications.  When configured correctly, users do not have administrator rights, they cannot change the contents of the Program Files and Windows folders, and cannot install applications.  On each machine, you can set up a separate admin account with a unique password, from which you can install software remotely using the support service. <br><br>  White lists allow you to block common infection vectors and common persistence techniques.  If attackers cannot rely on their droppers, then for remote execution of the code they will have to rely on software exploits.  This usually gives attackers remote access, which, however, will be lost when the system is rebooted or the corresponding process is interrupted.  Attack resistance is usually achieved by installing a backdoor.  Most often it is placed in the user‚Äôs AppData folder, because it does not require administrative rights.  But if the white list prohibits execution from any location other than Program Files and Windows, then the backdoor will not start.  Then the attacker will have to look for ways to extend privileges. <br><br>  Many viruses exploit exploits for known vulnerabilities, infecting user machines while visiting infected sites.  You can usually defend yourself from this attack vector by regularly patching frequently used software.  If an attacker does not have the ability to use known exploits, then you have to develop your own zero-day attacks.  This is not a trivial task, as can be judged by the level of awards in the Bug Bounties programs and prices on the black market.  A reliable zero-day attack can cost more than $ 100,000. At the same time, an attacker needs to use it wisely so that the vulnerability is not known and it is not closed with a patch.  In addition, such an attack should be applied in the case when the potential benefit can recoup the acquisition costs, otherwise the whole point is lost. <br><br>  Using a number of measures, software developers can significantly complicate the task of developing exploits for attackers.  For example, using memory hardening techniques such as DEP ( <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B5%25D0%25B4%25D0%25BE%25D1%2582%25D0%25B2%25D1%2580%25D0%25B0%25D1%2589%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B2%25D1%258B%25D0%25BF%25D0%25BE%25D0%25BB%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25B4%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D1%2585">data execution prevention</a> ), ASLR ( <a href="https://ru.wikipedia.org/wiki/ASLR">address space randomization</a> ), and SEHOP (structural exception handling).  To find out if these technologies were used when compiling the executable files of the applications you use, you can use the <a href="https://blog.netspi.com/verifying-aslr-dep-and-safeseh-with-powershell/">BinScope utility or PowerShell scripts</a> .  If these security techniques have not been used, then the EMET ( <a href="https://en.wikipedia.org/wiki/Enhanced_Mitigation_Experience_Toolkit">Enhanced Mitigation Experience Toolkit</a> ) <a href="https://en.wikipedia.org/wiki/Enhanced_Mitigation_Experience_Toolkit">toolkit</a> can be enforced.  According to research, it is still possible to get around it, but it will require more time and effort. <br><br>  If your company uses <a href="http://www.sans.org/security-resources/idfaq/siem.php">SIEM</a> (Security Information Management System), then you know that there is always a lot of noise on a large and lively network.  SIEM collects the activity logs of all major network participants and end users, normalizes them, correlates events based on several sources of information, and warns of suspicious activity.  If all these steps are used to prevent low and mid-level attacks, the SIEM system can be configured to search for fairly complex events indicating attempts to bypass an EMET, AppLocker, or firewall, with appropriate alerts.  Even if such attacks succeed and attackers penetrate your system, they will be easier to detect and neutralize. <br><br>  Of course, whitelists will not solve all security problems.  Anyway, there remains the possibility that someone will be able to penetrate your network through an unpatched exploit or a zero-day attack.  But even in this case, whitelists reduce the persistence of penetration tools.  In addition, it would be more difficult for attackers to gain access to privileged systems.  That is, you make it so difficult to hack and be present in your network that less advanced hackers will prefer to choose lighter targets. <br><br>  For built-in scripting languages, such as a batch file language, VBScript, and PowerShell, AppLocker runs address scripts that you can use to prevent the installation and launch of the interpreter.  Any whitelist technology has many nuances to consider.  For example, macros in Microsoft Office documents, JavaScript in PDF and web browsers.  But in any case, the whitelists of executable files and dynamic link libraries themselves will block almost all mass viruses and most of the advanced persistent threats.  For example, one of the reports from <a href="http://intelreport.mandiant.com/">Mandiant</a> described a phishing email linked to a ZIP archive with an executable file that has a PDF icon.  Norton Antivirus did not detect it, and the white list would prevent execution. <br><br>  If you can limit the number of those who can penetrate your security system to highly skilled individuals and organizations with sufficient resources to develop a successful attack with white lists and exploit blockers, you will significantly reduce your risks and increase the chances of detecting attacks.  You no longer have to worry about those who simply bought viruses on the black market and send phishing emails.  But the released resources can be sent to detect the activity of more cunning intruders. </div><p>Source: <a href="https://habr.com/ru/post/280706/">https://habr.com/ru/post/280706/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../280692/index.html">PyCon Russia moves to Moscow</a></li>
<li><a href="../280694/index.html">On which framework will you write a PHP application in 2016?</a></li>
<li><a href="../280696/index.html">RUVDS launches affiliate program</a></li>
<li><a href="../280700/index.html">Big Data from A to Z. Part 4: Hbase</a></li>
<li><a href="../280702/index.html">HPE 3PAR StoreServ cloud array monitoring service</a></li>
<li><a href="../280708/index.html">IBM's cognitive service recognizes a photo and tells what is shown in the pictures.</a></li>
<li><a href="../280710/index.html">Automate Personnel Changes on PowerShell</a></li>
<li><a href="../280712/index.html">Bank payment infrastructure protection</a></li>
<li><a href="../280718/index.html">Branded DNS or white labeling on Amazon Route 53</a></li>
<li><a href="../280720/index.html">Sync in online games</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>