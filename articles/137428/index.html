<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Qt parallel compilation in Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Parallel compiling Qt projects under Windows using QtCreator is a mysterious and fastidous beast. In this small article I will tell you how to tame hi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Qt parallel compilation in Windows</h1><div class="post__text post__text-html js-mediator-article"> Parallel compiling Qt projects under Windows using QtCreator is a mysterious and fastidous beast.  In this small article I will tell you how to tame him after all.  Parallel compilation can be done quite simply in theory, in practice, things are not quite smooth, which is supported by an infinite number of topics on forums where various solutions are offered.  None of them, unfortunately, helped us. <br><br><a name="habracut"></a><br>  In theory, for the MinGW case, it suffices to specify <b>the ‚Äìj parameter [number of compilation processes]</b> for the make command, which is represented in mtw32-make in QtSDK MinGW.  For example, the command mingw32-make.exe ‚Äìj10 is obtained. <br><br>  The recommended number of compilation processes is the number of processors + 1.  If the parameter is not specified, it is considered that j = 1.  If you specify too large a number, nothing terrible will happen either.  Make will run exactly as much as a performance boost. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For convenience, you can use the environment variable% NUMBER_OF_PROCESSORS%, which indicates the number of processors in the system.  It turns out a command of the form <br><br> <code>mingw32-make.exe ‚Äìj%NUMBER_OF_PROCESSORS%</code> <br> <br>  However, not all so simple.  Qmake creates three makefiles.  A generic Makefile that, according to certain definees, chooses from the Makefile.Debug and Makefile.Release depending on the release build or debug.  The fact is that <b>the ‚Äìj parameter is not inheritable</b> .  And when make is invoked in QtCreator, it is called for a Makefile.  But to Makefile.Debug or Makefile.Release no longer gets. <br><br>  In order to fix this, you will have to <b>write a command explicitly</b> .  For example, <br><br> <code>mingw32-make.exe ‚Äìj9 ‚Äìf Makefile.Debug.</code> <br> <br>  Not very convenient, but it greatly compensates for the increase in assembly speed.  For example, rebuilding our project on core-i7-2630 without parallelization is done in 12 minutes, with the ‚Äìj9 flag it takes less than two minutes to build.  A performance gain of six times makes you wonder. <br><br>  But even after specifying such build flags, we started working on two machines, but not on two.  On the forums they write that the case may be in the Qt version, in the mingw curve, in the features of qmake, the OS version.  However, the configurations of our machines are such that by the method of elimination it is possible to conclude that the versions of QtSDK, QtCreator, Windows are not related, or the system capacity to all this. <br><br>  The solution is very simple, but at the same time not so obvious.  You need to add the absolute path to mingw32-make to the PATH environment variable.  Just in case, it is better to put a semicolon after the path.  And after that, a parallel compilation miraculously begins to work, and programmers will not have to be distracted for 10 minutes each time some Q_OBJECT is added to the project and its reassembly. <br><br>  All these compilation flags can be set in QtCreator on the Projects tab in the make parameters. <br><br><img src="https://habrastorage.org/storage2/d32/780/cce/d32780cce3d8da910c5366d6074dd8ba.png" alt="image"><br><br>  I hope the article will be useful and will solve the questions of many who have not had a parallel build in QtCreator before. <br><br>  <b>UPD (from comments)</b> : As for Linux / MacOS users, they are much more fortunate - just the -jX switch is enough. <br><br>  Also, if you use the MSVC compiler, then there should be no problems. <br><br>  In the case of QtCreator, you need to add an entry. <br> <code>QMAKE_CXXFLAGS_RELEASE += -MP[ ]</code> <br>  in the .pro project file and setting the environment variable as I described. <br><br>  In the case of Visual Studio, the properties of the VS project are: ‚ÄúProperties‚Äù =&gt; ‚ÄúConfiguration Properties‚Äù =&gt; ‚ÄúC / C ++‚Äù =&gt; ‚ÄúCommand Line‚Äù.  And in the field ‚ÄúAdditional options‚Äù add -MP [number of processes].  Thanks <a href="https://habrahabr.ru/users/ighor/" class="user_link">IGHOR</a> <br><br>  Also when using the MSVC compiler jom can help. <br><br>  The constant part of the flags can be moved to a separate environment variable MAKEFLAGS.  Make will take the set flags from there.  For example, MAKEFLAGS = -j10.  And in the make parameters you just have to remember to specify the file for the assembly.  For example, -f Makefile.Debug.  If you keep on assembling one version all the time, then you can put out all the flags of the pillars in MAKEFLAGS and forget about setting up future projects. <br><br>  Thank you all for the additions. </div><p>Source: <a href="https://habr.com/ru/post/137428/">https://habr.com/ru/post/137428/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137421/index.html">Create transitions for pages using CSS3</a></li>
<li><a href="../137422/index.html">Courses for upgrading SharePoint developers</a></li>
<li><a href="../137423/index.html">Free-to-play games: how to make them successful</a></li>
<li><a href="../137425/index.html">I haven't taken checkers for a long time. Know, know how you play</a></li>
<li><a href="../137426/index.html">Javascript. Sort table</a></li>
<li><a href="../137429/index.html">Kinect for Windows went on sale</a></li>
<li><a href="../137431/index.html">MSP430, learn to program and debug hardware (part 2)</a></li>
<li><a href="../137432/index.html">Sony has received a new head of the company</a></li>
<li><a href="../137433/index.html">Based on what PHP capabilities and how do you develop applications?</a></li>
<li><a href="../137434/index.html">I work for random ()</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>