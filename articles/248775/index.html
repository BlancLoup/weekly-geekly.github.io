<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Age of JIT compiling. Part I. Genesis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The runtime theme of the .NET platform is covered in great detail. However, the work of the JIT itself, the resulting code and interaction with the ru...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Age of JIT compiling. Part I. Genesis</h1><div class="post__text post__text-html js-mediator-article">  The runtime theme of the .NET platform is covered in great detail.  However, the work of the JIT itself, the resulting code and interaction with the runtime environment is not very. <br><br>  Well, fix it! <br><br>  We learn the reasons for the lack of inheritance from structures, the nature of unbound delegates. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And also ... calling any methods on any objects without reflection. <br><a name="habracut"></a><br><h3>  <font color="#7EA9D1">‚ñå</font> Genesis of Value-types </h3><br>  Structures in .NET are, on the one hand, structures in the classical understanding of a given word (layout, mutability, etc.), on the other hand, they support OOP and the .NET environment in principle (methods ToString, GetHashCode; inheritance from System.ValueType, which in turn from System.Object; etc.). <br><br>  To better understand why structures cannot be inherited from other types, it is necessary to go to the level of organization of methods in the CLR. <br><br>  Instance-level methods have an implicit argument this.  In fact, it is clear.  JIT, by compiling code, creates a signature of the following form: <br><br><pre><code class="hljs lisp">ReturnType MethodName(<span class="hljs-name"><span class="hljs-name">Type</span></span> this, ‚Ä¶arguments‚Ä¶)</code> </pre> <br>  But this is for reference types. <br><br>  For significant: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-function">ReturnType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MethodName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Type </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">, ‚Ä¶arguments‚Ä¶</span></span></span><span class="hljs-function">)</span></span></code> </pre> <br>  Yes Yes!  This is done to support the variability of structures, i.e.  so we can modify this. <br><br>  So why not inherit structures from other types? <br><br>  Answer the question: what if this is a virtual method of the base reference class?  How to be a JIT compiler?  No  Constantly guessing and generating various code specializations (with semantics byval and byref), besides dispatching a table of virtual methods, is inefficient.  Boxing is added to properly serve the virtual method. <br><br>  But ... Methods <i>ToString</i> , <i>GetHashCode</i> , <i>Equals</i> are virtual methods of the reference ancestor class <b>System.Object</b> ?! <br><br>  These are exceptions.  JIT knows this and generates a binding and specialization only for these methods. <br><br><h3>  <font color="LimeGreen">‚ñå</font> Unbound Delegates </h3><br>  Reflection in .NET allows us to create a delegate for both static methods and instances. <br>  However, there is a small problem - for instances you need to create a delegate in a new way. <br><br><div class="spoiler">  <b class="spoiler_title">Consider an example:</b> <div class="spoiler_text"><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> calc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Calc() { FirstOperand = <span class="hljs-number"><span class="hljs-number">2</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> addMethodInfo = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Calc).GetMethod(<span class="hljs-string"><span class="hljs-string">"Add"</span></span>, BindingFlags.Public | BindingFlags.Instance); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> addDelegate = (Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;)Delegate.CreateDelegate( <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;), calc, addMethodInfo); Console.WriteLine(addDelegate(<span class="hljs-number"><span class="hljs-number">2</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// 4 } } class Calc { public int FirstOperand = 0; public int Add(int secondOperand) { return FirstOperand + secondOperand; } }</span></span></code> </pre><br></div></div><br>  <b>Unbound delegates</b> come to the <b>rescue</b> , i.e.  unbound  However, they have one feature: a different signature where they add (yes, you guessed correctly) the first argument - a link to the instance. <br><br>  Those.  unbound delegates are references to the ‚Äúreal‚Äù method. <br><br>  So, the signature <i>Add (int secondOperand)</i> turns into <i>Add ( <b>Calc this</b> , int secondOperand)</i> . <br><br><div class="spoiler">  <b class="spoiler_title">Check:</b> <div class="spoiler_text"><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> addMethodInfo = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Calc).GetMethod(<span class="hljs-string"><span class="hljs-string">"Add"</span></span>, BindingFlags.Public | BindingFlags.Instance); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> addDelegate = (Func&lt;Calc, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;)Delegate.CreateDelegate( <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Func&lt;Calc, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;), <span class="hljs-literal"><span class="hljs-literal">null</span></span>, addMethodInfo); Console.WriteLine(addDelegate(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Calc(), <span class="hljs-number"><span class="hljs-number">2</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// 2 } } class Calc { public int FirstOperand = 0; public int Add(int secondOperand) { return FirstOperand + secondOperand; } }</span></span></code> </pre><br></div></div><br>  Remember the question about the signatures of the structure methods?  Declare the type Calc as a <b>struct</b> and run.  ArgumentException?  Yes? <br><br>  We need to pass the argument to <b>this byref</b> to Func &lt;Calc, int, int&gt;, but how ?! <br><br><div class="spoiler">  <b class="spoiler_title">Declare your delegate FuncByRef</b> <div class="spoiler_text"><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> TResult FuncByRef&lt;T1, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> T2, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> TResult&gt;(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> T1 arg1, T2 arg2);</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Change the code:</b> <div class="spoiler_text"><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> TResult FuncByRef&lt;T1, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> T2, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> TResult&gt;(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> T1 arg1, T2 arg2); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> addMethodInfo = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Calc).GetMethod(<span class="hljs-string"><span class="hljs-string">"Add"</span></span>, BindingFlags.Public | BindingFlags.Instance); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> addDelegate = (FuncByRef&lt;Calc, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;)Delegate.CreateDelegate( <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(FuncByRef&lt;Calc, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;), <span class="hljs-literal"><span class="hljs-literal">null</span></span>, addMethodInfo); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> calc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Calc(); calc.FirstOperand = <span class="hljs-number"><span class="hljs-number">123</span></span>; Console.WriteLine(addDelegate(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> calc, <span class="hljs-number"><span class="hljs-number">2</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// 125 } } struct Calc { public int FirstOperand; public int Add(int secondOperand) { return FirstOperand + secondOperand; } }</span></span></code> </pre><br></div></div><br><h3>  <font color="#7F45AA">‚ñå</font> Verification evasion </h3><br>  Consider a simple application: <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { CallTest(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>()); CallTestWithExlicitCasting(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>()); Console.Read(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CallTest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> target</span></span></span><span class="hljs-function">)</span></span> { Program p = target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Program; p.Test(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CallTestWithExlicitCasting</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> target</span></span></span><span class="hljs-function">)</span></span> { Program p = (Program)target; p.Test(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Test</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Test"</span></span>); } }</code> </pre><br>  As you can see, the application will fall from a NullReferenceException when calling CallTest (). <br><br>  Well, correct this situation.  To do this, run <b>ildasm</b> . <br><br> <code>Visual Studio Command Promt -&gt; ildasm</code> <br> <br><img src="https://habrastorage.org/files/40d/ebe/14a/40debe14a1264308bfc616337d82fea9.png"><br><br>  Next <code>File -&gt; Dump -&gt; Save as dialog -&gt; msiltricks_patch.il</code> <br><br>  Open the saved file msiltricks_patch.il in your favorite editor and go to the body of the CallTest method: <br><pre> <code class="hljs pgsql">.<span class="hljs-keyword"><span class="hljs-keyword">method</span></span> private hidebysig static <span class="hljs-type"><span class="hljs-type">void</span></span> CallTest(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> target) cil managed { // Code size <span class="hljs-number"><span class="hljs-number">14</span></span> (<span class="hljs-number"><span class="hljs-number">0xe</span></span>) .maxstack <span class="hljs-number"><span class="hljs-number">1</span></span> .locals init ([<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> MSILTricks.Program p) IL_0000: ldarg<span class="hljs-number"><span class="hljs-number">.0</span></span> IL_0001: isinst MSILTricks.Program IL_0006: stloc<span class="hljs-number"><span class="hljs-number">.0</span></span> IL_0007: ldloc<span class="hljs-number"><span class="hljs-number">.0</span></span> IL_0008: callvirt instance <span class="hljs-type"><span class="hljs-type">void</span></span> MSILTricks.Program::Test() IL_000d: ret } // <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">method</span></span> Program::CallTest</code> </pre><br>  Delete the term IL_0001: isinst MSILTricks.Program, i.e.  call the <b>isinst</b> op code (also <b>known</b> <b>as as</b> in C #). <br><br>  Do the same with the CallTestWithExlicitCasting method: <br><pre> <code class="hljs pgsql">.<span class="hljs-keyword"><span class="hljs-keyword">method</span></span> private hidebysig static <span class="hljs-type"><span class="hljs-type">void</span></span> CallTestWithExlicitCasting(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> target) cil managed { // Code size <span class="hljs-number"><span class="hljs-number">14</span></span> (<span class="hljs-number"><span class="hljs-number">0xe</span></span>) .maxstack <span class="hljs-number"><span class="hljs-number">1</span></span> .locals init ([<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> MSILTricks.Program p) IL_0000: ldarg<span class="hljs-number"><span class="hljs-number">.0</span></span> IL_0001: castclass MSILTricks.Program IL_0006: stloc<span class="hljs-number"><span class="hljs-number">.0</span></span> IL_0007: ldloc<span class="hljs-number"><span class="hljs-number">.0</span></span> IL_0008: callvirt instance <span class="hljs-type"><span class="hljs-type">void</span></span> MSILTricks.Program::Test() IL_000d: ret } // <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">method</span></span> Program::CallTestWithExlicitCasting</code> </pre><br>  Remove the term <code>IL_0001: castclass MSILTricks.Program</code> , i.e.  a call to the <b>castclass opcode</b> (also <b>known</b> as an explicit cast operator in C #). <br><br> <code>Visual Studio Command Promt -&gt; cd [your saved file dir]</code> <br> <code>Visual Studio Command Promt -&gt; ilasm msiltricks_patch.il</code> <br> <br>  Run <b>msiltricks_patch.exe</b> <br><br>  Not a single exception, even <b>AccessViolationException</b> . <br>  Haha <br><br>  The fact is that our <i>Test</i> method has no side effects, and also does not use <b>this</b> in its body. <br><br>  Conclusion: we are working with ‚Äúhardware‚Äù and the variables of reference types are just addresses in memory, i.e.  <b>DWORD</b> ;  type casting, etc.  are nothing more than an abstraction and ‚Äúprotection‚Äù at the compilation stage.  The central processor works with addresses in memory.  The CLR provides these addresses, the JIT compiles the code considering them. <br><br>  Your KO :) <br><br>  And, yes, the <b>callvirt instruction</b> does not check for the ‚Äúcorrectness‚Äù of the object. <br>  To get AccessViolationException, you can add, for example, a virtual method to the Program class and call it in the Test method. <br></div><p>Source: <a href="https://habr.com/ru/post/248775/">https://habr.com/ru/post/248775/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248755/index.html">GPU Particles using Compute and Geometry Shaders</a></li>
<li><a href="../248761/index.html">Browser-in-browser will make the site much safer.</a></li>
<li><a href="../248765/index.html">Microsoft has joined the Student Developer Pack and some other GitHub Education news.</a></li>
<li><a href="../248767/index.html">The digest of interesting materials for the mobile developer # 87 (on January 19-25)</a></li>
<li><a href="../248769/index.html">Wordpress</a></li>
<li><a href="../248777/index.html">Patent Wars. Episode 1. Hidden threat</a></li>
<li><a href="../248779/index.html">When data is really a lot: Vowpal Wabbit</a></li>
<li><a href="../248783/index.html">HTML5 canvas karaoke</a></li>
<li><a href="../248785/index.html">Fundamentals of graphics programming on Apple Metal: Getting started</a></li>
<li><a href="../248787/index.html">WRL and BindableAttribute</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>