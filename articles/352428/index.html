<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Friday JS: minus without minus</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once again, I welcome everyone to my traditional category. Today, you will learn what happened in this special way on December 31, 1969, exactly a mil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Friday JS: minus without minus</h1><div class="post__text post__text-html js-mediator-article">  Once again, I welcome everyone to my traditional category.  Today, you will learn what happened in this special way on December 31, 1969, exactly a millisecond before midnight.  More precisely, you will find out not only this, but only for this example I was able to pick up a picture, and an entertaining article without pictures is nonsense. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ef4/6ec/853/ef46ec85303d069306d995bd7b697434.jpg" alt="image"></div><br><a name="habracut"></a><br>  Recently, I have been teaching a little bit.  In order to expand the consciousness of the student, I asked him the following problem: <br><blockquote>  Write the function sub (a, b), which will find the difference of the numbers a and b.  However, the text of the function should not contain the character "-". </blockquote>  Now it‚Äôs time for the inquisitive reader to postpone reading the article and try to solve the problem on their own.  Therefore, so that he does not accidentally see one of the solutions below, I will insert a picture with a snowflake that does not melt while the clock is twelve beating. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/054/38e/8a2/05438e8a266aeb85fd678b59c44c6d0e.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In formulating the task, I hinted at one particular way related to the topic that we recently went through.  But after that, I wondered: what ways still exist in this language rich in non-obvious possibilities?  I would like to share with you the results of several hours of reflection on this topic. <br><br><h3>  General considerations </h3><br>  The easiest and glitch-free way to do subtraction without subtraction is to somehow get the value ‚Äúminus one‚Äù and then write: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b * minusOne;</code> </pre> <br>  If you somehow get the string "-", you can simply turn it into a minus one: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusOne = (minusChar + <span class="hljs-number"><span class="hljs-number">1</span></span>) | <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br>  If we want to do without these little tricks, we are in for pain.  First of all, we will deliver it with special values ‚Äã‚Äã(Infinity, NaN), and secondly, a possible loss of accuracy with less trivial operations on numbers.  But this does not mean that we do not need to try.  Everything that does not kill us makes us stronger. <br><br><h3>  Most obvious </h3><br>  The first way that, in my mind, should come to mind to a beginner is to use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf">Array # indexOf</a> .  Of course, this is not the first suitable thing that you can stumble upon if you read Flanagana methodically in order.  However, a newcomer does not need to read Flanagan in order, as he quickly drowns in an abundance of unnecessary information.  Array # indexOf successfully combines simplicity and practical utility, because I tend to believe this is the most obvious solution. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusOne = [].indexOf(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b * minusOne; }</code> </pre><br>  The indexOf method, as its name implies, returns the index of the element in the array.  If there is no such element in the array, the special value -1 is returned.  Very handy. <br><br><h3>  Bit operations </h3><br>  And this is the first thing that should have occurred to some stern riffle.  For example: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusOne = ~<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b * minusOne; }</code> </pre><br>  The tilde in javascript symbolizes bitwise negation.  Because of the <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BA%25D0%25BE%25D0%25B4">peculiarities of the</a> internal representation of negative numbers, the bitwise negation of zero magically turns out to be a minus one.  Incidentally, the reverse is also true, which is why some people have a habit of writing the condition for an element to be included in an array as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(~arr.indexOf(elem)){ <span class="hljs-comment"><span class="hljs-comment">//...</span></span></code> </pre><br>  Now, with the advent of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes">Array # includes</a> , this hack is becoming less relevant. <br><br>  Also, minus one can be obtained in more sophisticated ways.  For example, a bitwise shift: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusOne = <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">31</span></span> &gt;&gt; <span class="hljs-number"><span class="hljs-number">31</span></span>;</code> </pre><br><h3>  Math </h3><br>  And this is the first thing that should come to mind math.  The methods of the global Math object provide many ways.  For example: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusOne = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.cos(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.PI); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b * minusOne; }</code> </pre><br>  Or alternative ways: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusOne = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.log(<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.E); <span class="hljs-comment"><span class="hljs-comment">//   minusOne = Math.sign(Number.NEGATIVE_INFINITY);</span></span></code> </pre><br>  By the way, the method with logarithm makes it possible to subtract the numbers "directly", without first obtaining minus one: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.log( <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.E ** a / <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.E ** b); }</code> </pre><br>  However, I already wrote about the problems of this approach in ‚Äúgeneral considerations‚Äù. <br><br><h3>  Strings </h3><br>  There are many ways to get the "-" string.  Perhaps the most obvious one: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusChar = <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCharCode(<span class="hljs-number"><span class="hljs-number">45</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusOne = (minusChar + <span class="hljs-number"><span class="hljs-number">1</span></span>) | <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b * minusOne; }</code> </pre><br>  You can also take advantage of the wonderful features of Unicode <s>; they fell to hell</s> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusChar = <span class="hljs-string"><span class="hljs-string">"\u002d"</span></span>;</code> </pre><br>  In addition, this symbol can be pulled out of the line that already contains it.  For example: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusChar = <span class="hljs-number"><span class="hljs-number">0.5</span></span>.toExponential()[<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// 0.5.toExponential() == "5e-1" minusChar = (new Date(0)).toISOString()[4]. //(new Date(0)).toISOString() == "1970-01-01T00:00:00.000Z"</span></span></code> </pre><br>  By the way, if we get a minus symbol, we don‚Äôt have to get minus one.  Can be done as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusChar = <span class="hljs-string"><span class="hljs-string">"\u002d"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">"("</span></span> + a + <span class="hljs-string"><span class="hljs-string">")"</span></span> + minusChar + <span class="hljs-string"><span class="hljs-string">"("</span></span> + b + <span class="hljs-string"><span class="hljs-string">")"</span></span>); }</code> </pre><br>  For this, of course, you will have to be born in the next life as a ringworm, but if you read this article before the current sentence, obviously, you have nothing to lose. <br><br><h3>  When the year comes young </h3><br>  And since we are talking about dates, here‚Äôs another way to get a minus one: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minusOne = <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.UTC(<span class="hljs-number"><span class="hljs-number">1969</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">59</span></span>, <span class="hljs-number"><span class="hljs-number">59</span></span>, <span class="hljs-number"><span class="hljs-number">999</span></span>);</code> </pre><br>  The fact is that javascript dates ‚Äúunder the hood‚Äù contain so-called  <a href="https://en.wikipedia.org/wiki/Unix_time">Unix time</a> is the number of milliseconds that have elapsed since midnight on January 1, 1970.  Accordingly, on December 31, 1969, at 1159:59 and 999 milliseconds, this value was exactly -1. <br><br><h3>  Do not repeat at home </h3><br>  Finally, I will give a couple of complex and poorly working methods. <br>  If both numbers are positive, finite, and the first is greater than the second, you can use division with the remainder. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> r = a % b; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(r + b &lt; a){ r += b; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r; }</code> </pre><br>  This will work due to the fact that <code>a == a % b + b * n</code> , where n is an integer.  Accordingly, <code>a - b == a % b + b * (n - 1)</code> , which means that by adding b to the remainder, we will sooner or later get the desired value. <br><br>  If you think carefully, you can get rid of the cycle.  Indeed, the cycle passes more than zero iterations only if b fits into a more than once.  This can be avoided as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a + a) % (a + b); }</code> </pre><br>  However, this method still does not work correctly with negative numbers (due to the fact that the operator ‚Äú%‚Äù works with them very strangely), with the subtracted more decreasing and with special values. <br><br>  And finally (drum roll, fanfare), in the best traditions of computational mathematics, we can calculate the difference by the method of half division: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">// . ,       b ,      a var r = 0; //     //  d,  . while(b + d &lt; a){ d *= 2; } //     r,     while(b + r &lt; a){ if(b + r + d &gt; a){ d /= 2; }else{ r += d; } } //       js   -  return r; }</span></span></code> </pre><br>  Again, this method works only if a&gt; = b, and if none of the numbers is infinity or NaN. <br><br>  On this I finish.  If you managed to come up with a method that is significantly different from those given in the article, be sure to write about it in the comments.  Good Friday to you! </div><p>Source: <a href="https://habr.com/ru/post/352428/">https://habr.com/ru/post/352428/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352418/index.html">Overview of KPI automation software</a></li>
<li><a href="../352420/index.html">New Intel microarchitecture: fast, but not free</a></li>
<li><a href="../352422/index.html">Payloads for testing web applications</a></li>
<li><a href="../352424/index.html">Analysis of the results of the presidential election of 2018. At the federal and regional level</a></li>
<li><a href="../352426/index.html">React v.16.3.0 released</a></li>
<li><a href="../352430/index.html">Tarantool application: stored procedures</a></li>
<li><a href="../352432/index.html">Linux distribution from scratch to build Docker images - our experience with dappdeps</a></li>
<li><a href="../352434/index.html">Ransomware is gaining strength</a></li>
<li><a href="../352436/index.html">Blondes, monsters and artificial intelligence addictions</a></li>
<li><a href="../352438/index.html">Java Puzzlers NG S02: Wonderful and Wonderful</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>