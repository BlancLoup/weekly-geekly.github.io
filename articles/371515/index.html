<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The history of creating a home cloud. Part 4. Update 2018 - Debian 9 and Nextcloud 13</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Since the publication of the last three parts, I received some feedback from people who, having never used linux, were able to successfully ‚Äúraise‚Äù th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The history of creating a home cloud. Part 4. Update 2018 - Debian 9 and Nextcloud 13</h1><div class="post__text post__text-html js-mediator-article">  Since the publication of the last three parts, I received some feedback from people who, having never used linux, were able to successfully ‚Äúraise‚Äù their home servers using the instructions provided.  I was not going to make a supplement on updating the software, assuming that there is a good base, starting from which everyone will be able to completely independently, with time and desire, update their web server and cloud engine.  However, after I started this myself, as always there were some moments, the coverage of which can help the newcomer save time.  And I decided to write this "differential" part, departing from the principle of "all in one article."  Therefore, in the first place, this material will be of interest to those who have familiarized in sufficient detail with the three previous articles and / or put them in the bookmarks.  The use of new software invalidates some of the previously described instructions, and the fourth part will contain only updates of such information. <br><br>  Briefly, we are building a new server on Debian 9 instead of 8, changing the SQL to MariaDB open, and PHP 5 to a faster PHP 7. The Nextcloud engine will update from version 11 to 13. I‚Äôll also mention how much we follow the rake - first along and then across. <br><br><img src="https://habrastorage.org/webt/bu/zk/wm/buzkwmzkfbkyj_tfl2euiasfkey.jpeg"><br><a name="habracut"></a><br><hr><a name="chap0"></a><br><h3>  Table of contents </h3><br>  <a href="https://geektimes.ru/post/297093/">Part 1. Setting up a Debian environment for everyday use.</a> <br>  <a href="https://geektimes.ru/post/297601/">Part 2. Creating a server - setting LAMP in Debian</a> <br>  <a href="https://geektimes.ru/post/297969/">Part 3. Creating a personal cloud - installing and configuring Nextcloud</a> <br>  <a href="https://geektimes.ru/post/300907/">Part 4. Update 2018 - Debian 9 and Nextcloud 13</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <hr><br><h3>  Quick chapter navigation </h3><br>  <a href="https://habr.com/ru/post/371515/">Setting up a Debian environment for everyday use</a> <br>  <a href="https://habr.com/ru/post/371515/">Creating a server - setting LAMP in Debian</a> <br>  <a href="https://habr.com/ru/post/371515/">Install and configure Nextcloud</a> <br>  <a href="https://habr.com/ru/post/371515/">A couple of links to read on Nextcloud</a> <br><br><hr><a name="chap1"></a><br><h3>  Setting up a Debian environment for everyday use </h3><br>  The basic setting is described in the <a href="https://geektimes.com/post/297093">first part</a> .  The graphical interface and the software suite as a whole have changed little, and these changes are intuitive. <br><br>  In the control panel, you do not need to assign a button for switching languages ‚Äã‚Äãas the switch is set during the installation of the system.  Instead, you should assign a shortcut key to quickly launch the console: <br><br>  - Keyboard: Shortcut Keys -&gt; Additional Combinations -&gt; Add a new item called ‚ÄúTerminal‚Äù and the ‚Äúx-terminal-emulator‚Äù command.  After adding, click on the label "Off" and enter the combination of two keys: Super (Win) + t. <br><br>  We have the ninth version of the Debian system, codenamed Stretch.  Therefore, the list of repositories will now look like this: <br><blockquote>  deb <a href="http://security.debian.org/debian-security">security.debian.org/debian-security</a> stretch / updates main contrib non-free <br>  deb-src <a href="http://security.debian.org/debian-security">security.debian.org/debian-security</a> stretch / updates main contrib non-free <br><br>  # updates <br>  deb <a href="httpredir.debian.org/debian/">httpredir.debian.org/debian</a> stretch-updates main contrib non-free <br>  deb-src <a href="httpredir.debian.org/debian/">httpredir.debian.org/debian</a> stretch-updates main contrib non-free <br><br>  # binary and source packages <br>  deb <a href="httpredir.debian.org/debian/">httpredir.debian.org/debian</a> stretch main contrib non-free <br>  deb-src <a href="httpredir.debian.org/debian/">httpredir.debian.org/debian</a> stretch main contrib non-free <br><br>  # backports <br>  # deb <a href="httpredir.debian.org/debian">httpredir.debian.org/debian</a> stretch-backports main contrib non-free <br>  # deb-src <a href="httpredir.debian.org/debian">httpredir.debian.org/debian</a> stretch-backports main contrib non-free </blockquote><br>  At the gnome configuration stage, you should delete the file /usr/share/applications/gksu.desktop, because in this version, starting from the terminal menu of the superuser still works once, if at all.  In this respect, we returned to Debian 7. In general, it is not clear why in the eight it worked stably, since in one of the explanations from the developer gnome I understood that such functionality was cut due to its insecurity.  In Debian 9, to access the superuser console, you need to open a normal terminal (Win + T) and enter the command <br>  <b>$ su</b> <br><br>  then enter the password from the superuser. <br><br>  Settings via gnome-tweak-tool have not changed.  But we were able to surprise: in the new version of the gnome environment, it is impossible to configure the computer to turn off by the power button!  Very controversial course of the GUI development team, I did not find a quick solution, so I set up the power section as follows: <br><br>  - Power supply: when you press the power button, set the action to Nothing <br>  - Power supply: ON "Do not put into standby mode when closing the lid" <br><br>  In the first article I did not pay special attention to the feature of the work gksu.  If you run Double Commander [root] from the menu and enter a password, the next calls for some time will not ask for the superuser password.  This caching is not very secure, so the gnome configuration ends with the following actions: <br><br>  - Open the Double Commander favorites menu [root], uncheck the "Remember password" box (now it will be removed by default for all applications) and enter the root password <br>  - Copy shortcuts to the desktop /usr/share/applications/doublecmd.desktop and /usr/share/applications/firefox-esr.desktop and run them, allowing execution. <br><br>  With the assembly of the new Double Commander, the rake field turned out, which I was full of.  Generally speaking, collecting it is not necessary at all - you can download and install ready-made packages.  The point is, if you definitely need a fresh version of the program.  The problems began with the fact that the previously configured IDE did not want to compile the downloaded project.  I had to read the development page and find out that for Double Commander 0.9.x branches it was recommended to use the Lazarus 1.6.4 development environment (the link for downloading packages is listed in the first part): <br><br>  <b># dpkg -i fpc_3.0.2-170225_amd64.deb</b> <b><br></b>  <b># dpkg -i fpc-src_3.0.2-170225_amd64.deb</b> <b><br></b>  <b># dpkg -i lazarus-project_1.6.4-0_amd64.deb</b> <br><br>  Further the source code is downloaded and compiled.  It should be noted that, starting with version 0.8.x, a new component has appeared, so now their list is as follows: <br><blockquote>  - chsdet / chsdet.lpk <br>  - CmdLine / cmdbox.lpk <br>  - multithreadprocs / multithreadprocslaz.lpk <br>  - dcpcrypt / dcpcrypt.lpk <br>  - doublecmd / doublecmd_common.lpk <br>  - KASToolBar / kascomp.lpk <br>  - gifanim / pkg_gifanim.lpk <br>  - synunihighlighter / synuni.lpk <br>  - viewer / viewerpackage.lpk </blockquote><br>  After assembling and installing the package, an unattractive picture opens: there is no list of languages, toolbar icons and file labels in the file panels are not displayed, everything looks crooked.  At first, I thought that somewhere I was wrong with the IDE or the build setup.  After the effect was reproduced a couple of times on a clean system (here it is - the advantage of using stored virtual machines) I had to return to Debian 8.x Wednesday, but even there I had a failure.  I tried to build in Lazarus 1.8.0 / 1.8.2 on Debian 8/9, but it was the same everywhere, except once (!), When I got a normal package.  At the program forum I was not particularly helped, I had to figure it out myself.  If you put assembled ‚Äúbad‚Äù and ‚Äúgood‚Äù packages on two identical systems, you can notice some interesting things that suggest that when you build a package, checkinstall somehow works incorrectly. <br><br>  In / usr / lib / doublecmd there should be symbolic links doc, highlighters, language, pixmaps.  But in reality, these links are located in the same daddy: doc / doc, highlighters / highlighters, etc.  If you manually restore links from these folders to / usr / lib / doublecmd and delete the folders, you get a fully working Double Commander. <br><br>  I resolved this situation by repacking the package with the changes I needed.  Not the best option, frank crutch, but it works. <br><br>  Suppose I got a ‚Äúbad‚Äù package doublecmd_0.9.0-1.gtk2_amd64.deb.  First you need to open (unzip) the resulting package: <br><br>  <b># mkdir dir |</b>  <b>dpkg-deb -R doublecmd_0.9.0-1.gtk2_amd64.deb dir</b> <br><br>  Follow the path dir / usr / lib / doublecmd and see instead of symbolic links to doc, highlighters, language, pixmaps there are real directories that contain the links we need - the package is definitely going to be crooked and you need to copy symbolic links from the appropriate folders, delete folders and transfer links back: <br><br>  <b># cp -P dir / usr / lib / doublecmd / {doc / doc, highlighters / highlighters, language / language, pixmaps / pixmaps} dir /</b> <b><br></b>  <b># rm -R dir / usr / lib / doublecmd / {doc, highlighters, language, pixmaps}</b> <b><br></b>  <b># cp -P dir / {doc, highlighters, language, pixmaps} dir / usr / lib / doublecmd /</b> <b><br></b>  <b># rm dir / {doc, highlighters, language, pixmaps}</b> <br><br>  Build the package back and delete the working directory: <br><br>  <b># dpkg -b dir doublecmd_0.9.0-1.gtk2_amd64.deb_good.deb</b> <b><br></b>  <b># rm -R dir</b> <br><br><hr><a name="chap2"></a><br><h3>  Creating a server - setting LAMP in Debian </h3><br>  Detailed server setup is described in the <a href="https://geektimes.com/post/297601">second part</a> .  The principle of setting and working with a web server has not changed, since its main components have changed little.  Apache has just been updated.  The SQL update on MariaDB is seamless, which is not surprising given the high compatibility with MySQL that is being laid.  PHP, though much prettier, but is updated completely unnoticed.  Perhaps it would be worth changing apache to nginx and abandon the self-signed certificate in favor of the free Let's Encrypt, but, apparently, not this time. <br><br>  Software installation: <br><br>  <b># apt-get install apache2 apache2-doc</b> <b><br></b>  <b># apt-get install mariadb-client mariadb-server phpmyadmin</b> <b><br></b>  <b># apt-get install php7.0 php7.0-mysql libapache2-mod-php7.0</b> <br><br>  When installing phpmyadmin, you need to select a preset for the apache2 server.  When asked to set up the base for the first time, answer affirmatively and set a password for the future phpmyadmin user. <br><br>  Further adjustment occurs in exactly the same way as described in the second part.  Versions of apache2 and openssl have changed slightly, so the SSL configuration code is almost the same: <br><blockquote> # 29-04-2018 / for apache2 2.4.25 &amp; openssl 1.0.1f <br>  # from <a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/">mozilla.github.io/server-side-tls/ssl-config-generator</a> <br>  # parametrs help: <a href="https://raymii.org/s/tutorials/Strong_SSL_Security_On_Apache2.html">raymii.org/s/tutorials/Strong_SSL_Security_On_Apache2.html</a> <br>  # modern configuration, tweak to your needs <br>  SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1 <br>  SSLCipherSuite ECDHE-ECDSA-AES256-GCM-SHA384: ECDHE-RSA-AES256-GCM-SHA384: ECDHE-ECDSA-CHACHA20-POLY1305: ECDHE-RSA-CHACHA20-POLY1305; -AES128-GCM-SHA256: ECDHE-ECDSA-AES256-SHA384: ECDHE-RSA-AES256-SHA384: ECDHE-ECDSA-AES128-SHA256: ECDHE-RSA-AES128-SHA256 <br>  SSLHonorCipherOrder on <br>  SSLCompression off <br>  SSLSessionTickets off <br><br>  # OCSP Stapling, only in httpd 2.3.3 and later <br>  SSLUseStapling on <br>  SSLStaplingResponderTimeout 5 <br>  SSLStaplingReturnResponderErrors off <br>  SSLStaplingCache shmcb: / var / run / ocsp (128000) </blockquote><br>  When configuring PHP for data caching, I installed not only Memcached, but Redis, which is not necessary to customize (the Memcached setting is in the second part): <br><br>  # apt-get install memcached php7.0-memcached php7.0-apcu <br>  # apt-get install redis-server, php-redis <br><br>  At the end of the second part, I provided a useful reference material.  Despite the high compatibility between MySQL and MariaDB, the MySQL reference material becomes somewhat incorrect and requires updating. <br><br>  You should start with the fact that when working from the superuser to the mariadb terminal, it lets us under any password!  By default, when you start the mysql client under the system root user, and when specifying the login -u root, it connects by default through the so-called UNIX Sockets, and does not check the password, even if it is and / or specified.  This situation is corrected as follows. <br><br>  Log into mysql (password - any!): <br><br>  <b># mysql -u root</b> <br><br>  Switch base: <br><br>  <b>MariaDB [(none)]&gt; use mysql;</b> <br><br>  Disable UNIX Sockets: <br><br>  <b>MariaDB [mysql]&gt; update user set plugin = '' where User = 'root';</b> <br><br>  Exit mysql: <br><br>  <b>MariaDB [mysql]&gt; quit;</b> <br><br>  If you now try to enter the mysql terminal, the system will ask for a password.  To enable such functionality back you need to repeat the same actions, but instead of disabling, enable UNIX Sockets: <br><br>  <b>MariaDB [mysql]&gt; update user set plugin = 'unix_socket' where User = 'root';</b> <br><br>  Changing user passwords has become somewhat more complicated.  To install the new password pass123 user user123 (for the root user changes the same way), you must perform the following steps. <br><br>  Log in to mysql: <br><br>  <b># mysql -u root -p</b> <br><br>  Set a new password: <br><br>  <b>MariaDB [(none)]&gt; SET PASSWORD FOR 'user123' @ 'localhost' = PASSWORD ('pass123');</b> <br><br>  Update Privilege Table: <br><br>  <b>MariaDB [(none)]&gt; FLUSH PRIVILEGES;</b> <br><br>  Quit mysql: <br><br>  <b>MariaDB [(none)]&gt; exit</b> <br><br><hr><a name="chap3"></a><br><h3>  Install and configure Nextcloud </h3><br>  The server preparation and installation principle are completely identical to the description of the <a href="https://geektimes.com/post/297969">third part</a> , unless you additionally need to install some modules for PHP7: <br><br>  <b># apt-get install curl libcurl3 libcurl3-dev php7.0-curl</b> <br><br>  Next, deploy the engine and organize a permanent place to connect content.  And here we are waiting for a good rake.  The fact is that if a folder connected via VMWare Shared Folders is used as a place, the previously used command to ‚Äúcorrectly‚Äù mount this folder, as well as the nxcdata_automount.sh script, will refuse to work.  It was unexpected and had to deal with it for some time.  The reason was that for some reason the vmhgfs module was not installed.  Initially, I thought that the problem was that I did not install linux-headers and the vmhgfs module did not compile, but it would be immediately noticeable and ... the VMWare Shared Folders folders are somehow automatically mounted in the system!  Then there was a series of experiments with Debian 8/9 and different versions of vmware-tools, but everything was in vain - it was this module that never appeared in the installed packages in Debian 9. You can find out which packages are installed with a name starting with vm like this: <br><br>  <b># lsmod |</b>  <b>grep -i vm</b> <br><br>  After searching the Internet, which was already pretty broken by the Roskomnadzor, when the technical reference information you need is clearly not terrorist, not extremist or other similarly targeted, a link appears like ‚ÄúThe site is blocked by the decision ...‚Äù, I found the instruction on the VMWare website, in which it was suggested to first install open-vmtools, and then ‚Äúroll in‚Äù the original vmware-tools set.  But it did not help.  The reason was completely different.  On the githaba, I found a topic, from which it was possible to understand that the kernel uses 4.9 instead of 3.16 in Debian 8 and the Shared Folders client was transferred to the connection via <a href="https://ru.wikipedia.org/wiki/FUSE_(%25D0%25BC%25D0%25BE%25D0%25B4%25D1%2583%25D0%25BB%25D1%258C_%25D1%258F%25D0%25B4%25D1%2580%25D0%25B0)">FUSE</a> , so now the mount command will look like this: <br><br>  <b># mount -t fuse.vmhgfs-fuse -o allow_other, umask = 007 .host: / vmw-nxcdata / mnt / vmw-nxcdata</b> <br><br>  Accordingly, my script will also undergo changes: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh # nxcdata_automount.sh 1.1 ### BEGIN INIT INFO # Provides: myscript # Required-Start: # Required-Stop: # Default-Start: 1 2 3 4 5 # Default-Stop: 0 6 # Short-Description: nxcdata_automount.sh 1.1 # Description: nxcdata_automount.sh 1.1 ### END INIT INFO . /lib/lsb/init-functions # Start actions perform_start() { log_daemon_msg ¬´Start nxcdata_automount¬ª sleep 30 mount -t fuse.vmhgfs-fuse -o allow_other,umask=007 .host:/vmw-nxcdata /mnt/vmw-nxcdata #mount -t ntfs-3g -o uid=www-data,gid=www-data,fmask=007,dmask=007 /dev/sdb1 /mnt/sdb1 #mount -t ext4 /dev/sdb1 /mnt/sdb1 log_end_msg 0 return 0 } # Stop actions perform_stop() { log_daemon_msg ¬´Stop nxcdata_automount¬ª umount /mnt/vmw-nxcdata log_end_msg 0 return 0 } case $1 in start) perform_start ;; stop) perform_stop ;; *) echo ‚ÄúUsage: /etc/init.d/myscript {start|stop}‚Äù exit 3 ;; esac</span></span></code> </pre> <br>  After organizing the content storage and initial configuration of the service through the browser, you need to make changes in the config.php.  These changes I will describe fully below. <br><br>  Please note that the nxcdata_automount.sh 1.1 script has failed to restart the service fail2ban.  The fact is that earlier the service was crookedly started due to the fact that when the system was booted, the place where the content was stored was not mounted, which made the nextcloud.log log file unavailable.  The logical solution to the problem is to transfer the log to the / var / log directory.  The problem is that in Nextcloud 11 for some reason I did not manage to transfer the log to another location, but in Nextcloud 13 there were no problems with this. <br><br>  Create a file: <br><br>  <b># touch /var/log/nextcloud.log</b> <br><br>  Configuring access: <br><br>  <b># chmod 644 /var/log/nextcloud.log</b> <br><br>  We change the rights: <br><br>  <b># chown www-data /var/log/nextcloud.log</b> <br><br>  Open the file: <br><br>  <b># nano /var/www/nextcloud/config/config.php</b> <br><br>  Add the following before ‚Äú);‚Äù: <br><blockquote>  'log_type' =&gt; 'file', <br>  'logtimezone' =&gt; '/ Europe / Moscow', <br>  'logfile' =&gt; '/var/log/nextcloud.log', <br>  'loglevel' =&gt; '2', </blockquote><br>  Turn on caching - add the following before ‚Äú);‚Äù: <br><blockquote>  'memcache.local' =&gt; '\\ OC \\ Memcache \\ Redis', <br>  'redis' =&gt; <br>  array ( <br>  'host' =&gt; 'localhost', <br>  'port' =&gt; 6379, <br>  ), <br>  'memcache.distributed' =&gt; '\\ OC \\ Memcache \\ Memcached', <br>  'memcached_servers' =&gt; <br>  array ( <br>  0 =&gt; <br>  array ( <br>  0 =&gt; 'localhost', <br>  1 =&gt; 11211, <br>  ), <br>  ), </blockquote><br>  Please note that we replaced caching with Redis, which will now be used for local caching.  However, Memcached will be used for a distributed cloud storage system. <br><br>  We include the mechanism of safe resolution of the problem of blocked files - we add the following before ");": <br><blockquote>  'filelocking.enabled' =&gt; true <br>  'memcache.locking' =&gt; '\ OC \ Memcache \ Redis', <br>  'redis' =&gt; array ( <br>  'host' =&gt; 'localhost', <br>  'port' =&gt; 6379, <br>  'timeout' =&gt; 0.0, <br>  'password' =&gt; '', // Optional, if not defined no password will be used. <br>  ), </blockquote><br>  Allowing external access to the site - in the trusted_domains section, add the IP address of the server on which NexCloud is installed to the array, for example, for the address 192.168.233.100: <br><blockquote>  'trusted_domains' =&gt; <br>  array ( <br>  0 =&gt; '127.0.0.1', <br>  1 =&gt; '192.168.233.100', <br>  ), </blockquote><br>  It must be remembered that when you start the server from a virtual machine, to access from a local network, you will need to add the IP address of the network interface of the host machine to the list. <br><br>  In accordance with the recommendations on the Nextcloud help page, we enable opcache for PHP. <br><br>  Open the file: <br><br>  <b># nano /etc/php/7.0/apache2/php.ini</b> <br><br>  Add the following to the opcache section: <br><blockquote>  opcache.enable = 1 <br>  opcache.enable_cli = 1 <br>  opcache.interned_strings_buffer = 8 <br>  opcache.max_accelerated_files = 10,000 <br>  opcache.memory_consumption = 128 <br>  opcache.save_comments = 1 <br>  opcache.revalidate_freq = 1 </blockquote><br>  The old fail2ban settings for Nextcloud 13 are no good - I had to adjust the description of the filter nextcloud.conf (/etc/fail2ban/filter.d/nextcloud.conf) and now it looks like this: <br><br> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> <blockquote> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> </blockquote> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> <blockquote> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> </blockquote> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> <hr> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> <h3> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> </h3> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> <hr> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> <hr> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> <div class="spoiler"> <code><b class="spoiler_title"><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br>   1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</b></code> <div class="spoiler_text"> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> </div></div> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> <hr> <code><code>[INCLUDES] <br> failregex = {"reqId":".*","level":2,"time":".*","remoteAddr":".*","user":".*","app":"core","method":"POST","url":".*","message":"Login failed: '.*' \(Remote IP: ''\)","userAgent":".*","version":".*"} <br> ignoreregex = <br> <br> <br>       jail.local: <br> <br> #       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br> maxretry = 6 <br></code> <br> <br>          ,    fail2ban,     maxretry,      .     ,    DEFAULT           LAMP?   ,      . fail2ban      .   DEFAULT   .             . <br> <br>           apache.   ,            /var/www/.htaccess.  ,    default-ssl.conf    /var/www/nextcloud     .          , apache         : <br> [Mon May 07 20:35:42.113958 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/login <br> [Mon May 07 20:35:43.161755 2018] [authz_core:error] [pid 3210] [client 192.168.0.2:50744] AH01630: client denied by server configuration: /var/www/apps <br> [Mon May 07 20:35:43.547090 2018] [authz_core:error] [pid 3212] [client 192.168.0.2:50740] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.610228 2018] [authz_core:error] [pid 3211] [client 192.168.0.2:50738] AH01630: client denied by server configuration: /var/www/js <br> [Mon May 07 20:35:43.618623 2018] [authz_core:error] [pid 3209] [client 192.168.0.2:50743] AH01630: client denied by server configuration: /var/www/apps <br>  fai2ban             /var/www/nextcloud.          ‚Äì     ,     Nextclod   .     /var/www/.htaccess   : <br> Require all granted <br>  ¬´¬ª  Nextcloud,       .       ,   ,   redis.   ‚Äì    ¬´Undefined index‚Ä¶ Storage.php#757¬ª    , ,  .      ,     11            .    ‚Äì   htaccess ‚Äì    .    nextcloud,    .      ,             ,   ¬´¬ª   admin  user   .  ¬´¬ª        ,           ,  user1,        .    ,     500 ( )    .        admin  user,   .  ,  ¬´¬ª       .           . <br> <br>          ‚Äì           ,    Debian 8.     -      .        \var\www\nextcloud\lib\private\Files\Filesystem.php,        $blacklist,  htaccess   . ,      nextcloud  .    \core\signature.json         11,  11- , ,    . ,   13-       . <br> <br>  ,       ,    -    . Nextcloud 13   ,   ,      -,     PHP7      . <br> <br>           .      ,        .                   ,          .              ,     . <br> <br> <a name="chap4"></a> <br>      Nextcloud <br>     Nextcloud. <br> <br> -  Nextcloud 12,             <a href="https://habr.com/users/wtigga/" class="user_link">wtigga</a>    ¬´ <a href="https://habr.com/post/357854">  VPS:  ¬´¬ª Nextcloud</a> ¬ª.       LetsEncrypt        . <br> -  ,    Nextcloud         ? <a href="https://habr.com/users/denismosolov/" class="user_link">denismosolov</a>    ¬´ <a href="https://habr.com/post/349556">Nextcloud Talk</a> ¬ª          Nextcloud 13. <br> <br> <br>  <a href="https://habr.com/ru/post/371515/"> ,  </a> . <br> <br> <br>    .  4.  2018 ‚Äì Debian 9  Nextcloud 13. <br>  : 1.0.0. <br>   : 17.05.2018. <br>   : 17.05.2018. <br> <br> <b class="spoiler_title"> </b> 1.0.0 [17-05-2018] <br>  . <br> <br> <br> ,   ,         - .  ,          .     GT    8  2018   <a href="https://geektimes.com/post/297969/"> </a> .      -  , ,  ,  4     ;)</code> </div><p>Source: <a href="https://habr.com/ru/post/371515/">https://habr.com/ru/post/371515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../371503/index.html">Tesla's battery station saved Australia already $ 30 million</a></li>
<li><a href="../371505/index.html">"Vinyl" digest: 30 materials on the production, practical issues and the history of vinyl</a></li>
<li><a href="../371509/index.html">Energy efficient production of polymers and composites using frontal polymerization</a></li>
<li><a href="../371511/index.html">To Hong Kong for gadgets</a></li>
<li><a href="../371513/index.html">Interview with Doug Ethel, Head of Leucadia Therapeutics</a></li>
<li><a href="../371517/index.html">Top 3D Expo 2018: Professional FDM printing. New materials. New horizons of application</a></li>
<li><a href="../371519/index.html">Laurel / Yanny: audio version of the blue-gold dress</a></li>
<li><a href="../371521/index.html">Ozaki O! Fitness - the cheapest chest heart rate monitor</a></li>
<li><a href="../371523/index.html">Review of the processor Ryzen 7 2700X. Unleash the potential of the flagship 8-core AMD with Kingston HyperX memory</a></li>
<li><a href="../371525/index.html">A retrocomputer badge for participants of the Hackaday conference in Belgrade: dreams come true from the past</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>