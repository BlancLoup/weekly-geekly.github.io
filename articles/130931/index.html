<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google AI Challenge. How to write your bot. Part 1, 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This topic is a translation of the first two parts of the guide on writing your own bot for the Google AI Challenge. 
 All code is written in Python. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google AI Challenge. How to write your bot. Part 1, 2</h1><div class="post__text post__text-html js-mediator-article"><h6>  This topic is a translation of the first two parts of the guide on writing your own bot for the Google AI Challenge. <br>  All code is written in Python. </h6><br><br><h4>  Step 1: How to avoid collisions </h4><br><h5>  Plan </h5><br>  To ants do not come across it is necessary: <br>  1) Prevent the movement of one ant to another; <br>  2) Prevent the movement of two ants to the same point; <br>  3) track the location information of all our ants. <br><a name="habracut"></a><br><h5>  Implementation </h5><br>  To track information about where ants are located, we will use a dictionary (aka HashMap, associative array, JavaScript-object).  Each key of the array will be a position, and the value will be an ant that moves to this point.  The location will be a tuple (list, array) of two values ‚Äã‚Äã- rows and columns on the map.  Then we can check the list before moving so that 2 ants do not move to the same place.  Every time we move an ant, we need to update the list. <br><br>  This check will be useful later in the tutorial, so we will make a function that checks if this step is possible.  It returns a logical (true or false) value. <br><h5>  Code </h5><br>  Let's cut out the comments from the code from the example and insert the new code: new code: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do_turn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, ants)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># track all moves, prevent collisions orders = {} def do_move_direction(loc, direction): new_loc = ants.destination(loc, direction) if (ants.unoccupied(new_loc) and new_loc not in orders): ants.issue_order((loc, direction)) orders[new_loc] = loc return True else: return False # default move for ant_loc in ants.my_ants(): directions = ('n','e','s','w') for direction in directions: if do_move_direction(ant_loc, direction): break</span></span></code> </pre> <br><br>  (Note: Make sure the indents are correct. In Python, indents define blocks of code and scope, so indents must be correct) <br><br>  The Do_move_direction function takes an ant position (tuple (row, column)) and direction ('N', 'e', ‚Äã‚Äã'S' or 'W') and tries to execute the movement.  This function is inside a class method (which is also a function) and this is normal in Python.  (If you are writing in another language, you may need to put the function in a different place) We use some predefined functions from the initial bot: <br><br>  ants.destination takes the location and direction and returns the destination for us.  This function handles the movement of an ant over the edge of the map; we do not need to think about it. <br><br>  ants.unoccupied takes a location and determines if an ant can be moved there.  This is better than ants.passable, which will not allow us to move to food or other ants. <br><br>  The associative orders array is used to track current movements.  The new_loc busy check and its absence in the orders array will help prevent collisions. <br><br><h5>  Result </h5><br>  Let's run the bot again and see: <br> <code>C:\aichallenge&gt;tutorial.cmd <br> running for 60 turns <br> ant_count c_turns climb? cutoff food r_turn ranking_bots s_alive s_hills score w_turn winning <br> turn 0 stats: [1,1,0] 0 [1,1] - 18 0 None [1,1] [1,1] [1,1] 0 None <br> turn 1 stats: [1,1,0] 0 [1,1] - 16 1 [0,0] [1,1] [1,1] [1,1] 1 [0,1] <br> turn 2 stats: [2,1,0] 0 [1,1] - 16 1 [0,0] [1,1] [1,1] [1,1] 1 [0,1] <br> ... <br> turn 60 stats: [1,5,0] 0 [1,1] - 12 1 [0,0] [1,1] [1,1] [1,1] 1 [0,1] <br> score 1 1 <br> status survived survived <br> playerturns 60 60</code> <br> <br>  Repeat: <a href="http://aichallenge.org/ants_tutorial_step_1.php">http://aichallenge.org/ants_tutorial_step_1.php</a> <br><br>  Already better, but still not very good.  One lone ant came out and fought with HunterBot.  This is not a suicide, but an improvement.  In addition, we created a helper function that will come in handy later. <br><br><h4>  Step 2: Collect Food </h4><br><h5>  Plan </h5><br>  We need more than two ants to win, and there is food not far from the starting position of the ant!  Let's try to collect it.  We have to move the ant to the food to collect it.  We also want to do this effectively.  Have you noticed that HunterBot sent half of all its ants for food in the last game?  It seems that this may be ineffective. <br><br>  We are going to implement something similar to the priority queue.  We will make a list of all our ants, and then see how far it is from each meal.  Then we will sort the list and send each ant to the nearest food, but only one ant to one food.  Other ants will be free and will be engaged in other important matters.  We will also get rid of the silly default moves that are left from the starting bot. <br><br><h5>  Implementation </h5><br>  To track information about the food, for which the ants are already going, we need another array.  It will store the location of the target food as a key, and the location of the ants that follow it as a value.  We can check the target key to make sure that we do not send two ants to the same food.  We will create another helper function to make a slightly different type of movement.  Instead of the location of the ants and the direction, we will make the location of the ants and the target location, and the function will figure out the direction. <br><br><h5>  Code </h5><br>  Create the following functions after the do_move_direction function: <br><pre> <code class="python hljs"> targets = {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do_move_location</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(loc, dest)</span></span></span><span class="hljs-function">:</span></span> directions = ants.direction(loc, dest) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> direction <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> directions: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> do_move_direction(loc, direction): targets[dest] = loc <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre> <br>  Array of targets tracks ants and their target is food.  We use another standard bot function to help us: <br>  ants.direction takes the current location and target, and returns a list of the nearest direction "in a straight line".  If the target is at the top left, it will return ['N', 'W'], and we should then try to move our ant in one of these two directions.  If the target is right below, it will return ['S'] - a list of one element. <br><br>  Replace the move function with this: <br><pre> <code class="python hljs"> <span class="hljs-comment"><span class="hljs-comment"># find close food ant_dist = [] for food_loc in ants.food(): for ant_loc in ants.my_ants(): dist = ants.distance(ant_loc, food_loc) ant_dist.append((dist, ant_loc, food_loc)) ant_dist.sort() for dist, ant_loc, food_loc in ant_dist: if food_loc not in targets and ant_loc not in targets.values(): do_move_location(ant_loc, food_loc)</span></span></code> </pre> <br><br>  Here we have a list - ant_dist - which will store for each ant the combination of food and distance as a tuple (distance, ant_loc, food_loc).  The list is built with a nested loop to give us every combination.  Next we sort the list.  Python lists have several useful sorting functions.  To sort a tuple, the python will compare the first values ‚Äã‚Äãof each tuple, and then, if they are the same, move to the second value, and so on.  That is why we saved the distance as the first value to make sure that the shortest distance is first on the list. <br><br>  Next, we loop through the sorted list to check if we have any free ants that can collect food.  Food_loc not in targets checks if the food has an ant that is already following it.  Ant_loc not in targets.values ‚Äã‚Äã() checks that the ant has not yet been given the task.  If the ant is found, we call do_move_location. <br><br><h5>  Result </h5><br>  Let's run the bot again and see: <br> <code>C:\aichallenge&gt;tutorial.cmd <br> running for 60 turns <br> ant_count c_turns climb? cutoff food r_turn ranking_bots s_alive s_hills score w_turn winning <br> turn 0 stats: [1,1,0] 0 [1,1] - 18 0 None [1,1] [1,1] [1,1] 0 None <br> turn 1 stats: [1,1,0] 0 [1,1] - 16 1 [0,0] [1,1] [1,1] [1,1] 1 [0,1] <br> turn 2 stats: [1,1,0] 0 [1,1] - 16 1 [0,0] [1,1] [1,1] [1,1] 1 [0,1] <br> ... <br> turn 60 stats: [4,6,0] 0 [1,1] - 6 1 [0,0] [1,1] [1,1] [1,1] 1 [0,1] <br> score 1 1 <br> status survived survived <br> playerturns 60 60</code> <br> <br>  Repeat: <a href="http://aichallenge.org/ants_tutorial_step_2.php">http://aichallenge.org/ants_tutorial_step_2.php</a> <br><br>  All the food we could see was captured.  If you look closely at the repetition, you can see we still have 3 ant anthill that can not appear.  In the future it is better to take care of this.  If ants can't get out, they can't help us win. <br><br>  Original: <br><ul><li>  <a href="http://aichallenge.org/ants_tutorial_step_1.php">http://aichallenge.org/ants_tutorial_step_1.php</a> </li><li>  <a href="http://aichallenge.org/ants_tutorial_step_2.php">http://aichallenge.org/ants_tutorial_step_2.php</a> </li></ul><br><br>  <b>PS</b> while this article was passing through the sandbox, <a href="https://habrahabr.ru/users/webkumo/" class="user_link">webkumo</a> published a similar <a href="http://habrahabr.ru/blogs/sport_programming/130946/">article</a> .  His article contains Ants Tutorial and Step 1: Avoiding collisions, this is Step 1: Avoiding collisions and Step 2: Gathering Food. </div><p>Source: <a href="https://habr.com/ru/post/130931/">https://habr.com/ru/post/130931/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../130924/index.html">Get configuration version 1c directly from SQL</a></li>
<li><a href="../130925/index.html">Work with contact photos in android 2.1+</a></li>
<li><a href="../130926/index.html">Remote Access with Dynamic IP or Configure DynDNS in Linux</a></li>
<li><a href="../130928/index.html">In Tatarstan, chop air optics</a></li>
<li><a href="../130930/index.html">Seagate GoFlex Satellite: Wireless Winchester for iPad and more</a></li>
<li><a href="../130932/index.html">Vertical screens in digital signage</a></li>
<li><a href="../130933/index.html">Universal plugs</a></li>
<li><a href="../130935/index.html">How to bypass the security code on ipad2 using the smart cover</a></li>
<li><a href="../130936/index.html">Making Releases with Maven in Java</a></li>
<li><a href="../130937/index.html">Deploy billing for a small network from scratch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>