<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Low-level brainfuck</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Building a Brainfuck translator in TurboAssembler. 

 For example, in Pascal. 

 Write it up as a program, using the ascii-code. 

 So, we only need t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Low-level brainfuck</h1><div class="post__text post__text-html js-mediator-article">  <i>Building a Brainfuck translator in TurboAssembler.</i> <br><br>  For example, in Pascal. <br><br>  Write it up as a program, using the ascii-code. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, we only need the bf-commands <b>+</b> and <b>.</b> <br><br><pre><code class="hljs pgsql">var data_mem: <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>[<span class="hljs-number"><span class="hljs-number">1.</span></span><span class="hljs-number"><span class="hljs-number">.10</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-type"><span class="hljs-type">integer</span></span>; // data <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> command_mem: string; // command <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> i: <span class="hljs-type"><span class="hljs-type">integer</span></span>; // <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> command <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> j: <span class="hljs-type"><span class="hljs-type">integer</span></span>; // <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> j:=<span class="hljs-number"><span class="hljs-number">1</span></span>; readln(command_mem); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i:=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> length(command_mem) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> // <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">cycle</span></span> we process the string <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[i]=<span class="hljs-string"><span class="hljs-string">'+'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> data_mem[j]:= data_mem[j]+<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[i]=<span class="hljs-string"><span class="hljs-string">'.'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(chr(data_mem[j])); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  bf-code <b>++++++++++++++++++++++++++++++++.</b>  will issue <b>!</b> <br>  <i>(the ascii-code of the symbol <b>!</b> is <b>33</b> ).</i> <br><br>  You can ensure that the program is correct via <a href="https://ideone.com/1Wa1Dg">the link</a> . <br><a name="habracut"></a><br>  Next, replace the bf-commands <b>- &lt;&gt;</b> . <br><br><pre> <code class="hljs matlab"> LABEL prev,next; var data_mem: array[<span class="hljs-number"><span class="hljs-number">1.</span></span><span class="hljs-number"><span class="hljs-number">.10</span></span>] of integer; command_mem: string; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>,k: integer; begin <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>:=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>:=<span class="hljs-number"><span class="hljs-number">1</span></span>; readln(command_mem); prev: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>&gt;<span class="hljs-built_in"><span class="hljs-built_in">length</span></span>(command_mem) then goto next; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'+'</span></span>) then data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]:= data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'-'</span></span>) then data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]:= data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'&gt;'</span></span>) then <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>:=<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'&lt;'</span></span>) then <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>:=<span class="hljs-built_in"><span class="hljs-built_in">j</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'.'</span></span>) then write(chr(data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>])); <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>:=<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>; goto prev; next: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k:=<span class="hljs-number"><span class="hljs-number">1</span></span> to <span class="hljs-number"><span class="hljs-number">10</span></span> do begin write(data_mem[k]); write(<span class="hljs-string"><span class="hljs-string">' '</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre><br>  <a href="https://ideone.com/tV2CWR">ideone.com</a> <br><br>  Next, let's add <b>[</b> and <b>]</b> <br><br>  Add another variable <i>i_stor</i> for bracket <b>[]</b> loop. <br><br>  If the current item is <i>greater than</i> the current item. <br><br>  (If not the <i>data_mem</i> not equal <i>zero</i> ) <br><br><pre> <code class="hljs matlab"> LABEL prev,next; var data_mem: array[<span class="hljs-number"><span class="hljs-number">1.</span></span><span class="hljs-number"><span class="hljs-number">.10</span></span>] of integer; command_mem: string; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>,k: integer; i_stor: integer; begin <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>:=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>:=<span class="hljs-number"><span class="hljs-number">1</span></span>; readln(command_mem); prev: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>&gt;<span class="hljs-built_in"><span class="hljs-built_in">length</span></span>(command_mem) then goto next; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'+'</span></span>) then data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]:= data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'-'</span></span>) then data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]:= data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'&gt;'</span></span>) then <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>:=<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'&lt;'</span></span>) then <span class="hljs-built_in"><span class="hljs-built_in">j</span></span>:=<span class="hljs-built_in"><span class="hljs-built_in">j</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'.'</span></span>) then write(chr(data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>])); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">'['</span></span>) then begin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> then i_stor:=<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command_mem[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=<span class="hljs-string"><span class="hljs-string">']'</span></span>) then begin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> data_mem[<span class="hljs-built_in"><span class="hljs-built_in">j</span></span>]&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> then begin <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>:=i_stor; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>:=<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>; goto prev; next: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k:=<span class="hljs-number"><span class="hljs-number">1</span></span> to <span class="hljs-number"><span class="hljs-number">10</span></span> do begin write(data_mem[k]); write(<span class="hljs-string"><span class="hljs-string">' '</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre><br>  bf-code <b>+++++ [&gt; + &lt;-]</b> transfers the number to the neighboring cell <b>0 5 0 0 0 0 0 0 0 0</b> <br><br>  <a href="https://ideone.com/83Pala">ideone.com</a> <br><br>  A ‚ÄúHello, World!‚Äù Program looks like <a href="https://ideone.com/8coTQM">ideone.com</a> <br><br>  <i><b>Moving on to TASM</b></i> <br><br>  To put the label on the loop, to put the label on it. <br><br><pre> <code class="hljs vhdl">mov CX, <span class="hljs-number"><span class="hljs-number">28</span></span>h ; count <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the stages <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> prev: ; <span class="hljs-keyword"><span class="hljs-keyword">label</span></span> ; do stuff <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> prev ; go back <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">label</span></span> prev</code> </pre><br><br>  Let's create the data array <i>data_mem</i> . <br>  Let's create the command array <i>command_mem</i> . <br>  Array of data look like. <br><br>  In the <i>loop,</i> the cell is in the <i>loop.</i> <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">text</span></span> segment ; bf1.asm assume cs:<span class="hljs-type"><span class="hljs-type">text</span></span>, ds:data, ss:stk <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>: mov AX,data ; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> the data segment mov DS,AX mov DL, command_mem ; <span class="hljs-keyword"><span class="hljs-keyword">load</span></span> the <span class="hljs-number"><span class="hljs-number">1</span></span>st command <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the DL mov CX, <span class="hljs-number"><span class="hljs-number">0</span></span>Ah ; <span class="hljs-number"><span class="hljs-number">10</span></span> stages prev: cmp DL, <span class="hljs-string"><span class="hljs-string">'+'</span></span> ; the cell contains + jne next ; <span class="hljs-keyword"><span class="hljs-keyword">no</span></span>, go <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the label next: mov BL, <span class="hljs-number"><span class="hljs-number">00</span></span>h ; <span class="hljs-keyword"><span class="hljs-keyword">load</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> BL the <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> data_mem inc data_mem[BX] ; yes, we increase the <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the cell <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> (inc means <span class="hljs-keyword"><span class="hljs-keyword">increment</span></span>) next: inc i ; go to the next character in the array of commands mov BL, i mov DL, command_mem [BX] loop prev mov AX, <span class="hljs-number"><span class="hljs-number">4</span></span>c00h ; terminate the program <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>h <span class="hljs-type"><span class="hljs-type">text</span></span> ends data segment command_mem DB <span class="hljs-string"><span class="hljs-string">'+'</span></span>, <span class="hljs-string"><span class="hljs-string">'+'</span></span>, <span class="hljs-string"><span class="hljs-string">'+'</span></span>, <span class="hljs-string"><span class="hljs-string">'$'</span></span> data_mem DB <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">'$'</span></span> i DB <span class="hljs-number"><span class="hljs-number">0</span></span> ; command_mem <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> data ends stk segment stack db <span class="hljs-number"><span class="hljs-number">100</span></span>h dup (<span class="hljs-number"><span class="hljs-number">0</span></span>) ; reserve <span class="hljs-number"><span class="hljs-number">256</span></span> cells stk ends <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span></code> </pre><br>  Assembling (translation) <i>tasm.exe bf1.asm</i> . <br><br>  Linking is done with the command <i>tlink.exe bf1.obj</i> . <br><br>  You get the data from the data array, you come to the variable <b>i</b> equal <i>0Ah to</i> the <i>turboDebugger</i> . <br><br><img src="https://habrastorage.org/webt/x4/8c/nl/x48cnlebuoswjtyt8qjveh5xira.jpeg"><br><br>  Next, add the bf-commands <b>- &lt;&gt;.</b> <br>  <b>21h</b> to output a single character. <br>  Put the character code in register before calling the interrupt. <br><br><pre> <code class="hljs objectivec"> mov AH,<span class="hljs-number"><span class="hljs-number">2</span></span> mov DL, character_code <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>h</code> </pre><br>  Let's write the program entirely <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">text</span></span> segment ; bf2.asm assume cs:<span class="hljs-type"><span class="hljs-type">text</span></span>, ds:data, ss:stk <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>: mov AX,data ; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> the data segment mov DS,AX mov DL, command_mem mov CX, <span class="hljs-number"><span class="hljs-number">0</span></span>Ah prev: cmp DL, <span class="hljs-string"><span class="hljs-string">'+'</span></span> jne next mov BL, j inc data_mem[BX] next: cmp DL, <span class="hljs-string"><span class="hljs-string">'-'</span></span> jne next1 mov BL, j <span class="hljs-type"><span class="hljs-type">dec</span></span> data_mem[BX] next1: cmp DL, <span class="hljs-string"><span class="hljs-string">'&gt;'</span></span> jne next2 inc j next2: cmp DL, <span class="hljs-string"><span class="hljs-string">'&lt;'</span></span> jne next3 <span class="hljs-type"><span class="hljs-type">dec</span></span> j next3: cmp DL, <span class="hljs-string"><span class="hljs-string">'.'</span></span> jne next4 mov AH,<span class="hljs-number"><span class="hljs-number">2</span></span> mov BL, j mov DL, data_mem[BX] <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>h next4: inc i mov BL, i mov DL, command_mem [BX] <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> prev mov AX, <span class="hljs-number"><span class="hljs-number">4</span></span>c00h ; terminate the program <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>h <span class="hljs-type"><span class="hljs-type">text</span></span> ends data segment command_mem DB <span class="hljs-string"><span class="hljs-string">'+'</span></span>, <span class="hljs-string"><span class="hljs-string">'&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'+'</span></span>, <span class="hljs-string"><span class="hljs-string">'+'</span></span>, <span class="hljs-string"><span class="hljs-string">'$'</span></span> ; data_mem DB <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">'$'</span></span> i DB <span class="hljs-number"><span class="hljs-number">0</span></span> ; command_mem <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> j DB <span class="hljs-number"><span class="hljs-number">0</span></span> ; data_mem <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> data ends stk segment stack db <span class="hljs-number"><span class="hljs-number">100</span></span>h dup (<span class="hljs-number"><span class="hljs-number">0</span></span>) ; reserve <span class="hljs-number"><span class="hljs-number">256</span></span> cells stk ends <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span></code> </pre><br><img src="https://habrastorage.org/webt/ux/go/pu/uxgopu8kbhaufpbzl_sri2os1om.jpeg"><br><br>  The cycle works like this: <br><br>  if not the current element of the <i>command-line</i> memo <b>next:</b> (otherwise, perform <b>+</b> ) <br>  if not the current element of <i>command-mem</i> not equal <b>-</b> then jump to the label <b>next1:</b> <br>  if not the next element of the <b>next2 command line:</b> <br>  not then <b>&lt;</b> next jump to the label <b>next3:</b> <br>  if not the current element of <i>command-mem</i>  then jump to the label <b>next4:</b> <br>  After the label <b>next4:</b> the index of the <i>command_mem</i> and jump to the label <b>prev:</b> (the beginning of the cycle) <br><br>  Next, add <b>[</b> and <b>]</b> <br>  Add the variable <i>i_stor</i> <br>  If the current item has been <i>validated, it was</i> for the item.  otherwise load <b>i</b> to <b>i_stor</b> <br><br><pre> <code class="hljs pgsql">next4: cmp DL, <span class="hljs-string"><span class="hljs-string">'['</span></span> ; the cell contains [ jne next5 ; <span class="hljs-keyword"><span class="hljs-keyword">no</span></span>, go <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the label next5 mov BL, j mov DL, data_mem[BX] cmp DL, <span class="hljs-number"><span class="hljs-number">00</span></span>h ; yes, <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> data_mem element <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> zero jz next5 ; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> zero, jump further mov DL, i ; otherwise <span class="hljs-keyword"><span class="hljs-keyword">load</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> i_stor mov i_stor, DL next5:</code> </pre><br>  (If not the <i>data_mem</i> not equal <i>zero</i> ) <br><br><pre> <code class="hljs pgsql">next5: cmp DL, <span class="hljs-string"><span class="hljs-string">']'</span></span> ; the cell contains ] jne next6 ; <span class="hljs-keyword"><span class="hljs-keyword">no</span></span>, go <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the label next6 mov BL, j mov DL, data_arr[BX] cmp DL, <span class="hljs-number"><span class="hljs-number">00</span></span>h ; yes, <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> data_mem element <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> zero jz next6 ; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> zero, jump further mov DL, i_stor ; otherwise <span class="hljs-keyword"><span class="hljs-keyword">load</span></span> i_stor <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> i mov i, DL next6:</code> </pre><br>  Check the bf-code <b>++++ [&gt; + &lt;-]</b> <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">text</span></span> segment ; bf3.asm assume cs:<span class="hljs-type"><span class="hljs-type">text</span></span>, ds:data, ss:stk <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>: mov AX,data ; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> the data segment mov DS,AX mov DL, command_mem mov CX, <span class="hljs-number"><span class="hljs-number">50</span></span>h prev: cmp DL, <span class="hljs-string"><span class="hljs-string">'+'</span></span> jne next mov BL, j inc data_mem[BX] next: cmp DL, <span class="hljs-string"><span class="hljs-string">'-'</span></span> jne next1 mov BL, j <span class="hljs-type"><span class="hljs-type">dec</span></span> data_mem[BX] next1: cmp DL, <span class="hljs-string"><span class="hljs-string">'&gt;'</span></span> jne next2 inc j next2: cmp DL, <span class="hljs-string"><span class="hljs-string">'&lt;'</span></span> jne next3 <span class="hljs-type"><span class="hljs-type">dec</span></span> j next3: cmp DL, <span class="hljs-string"><span class="hljs-string">'.'</span></span> jne next4 mov AH,<span class="hljs-number"><span class="hljs-number">2</span></span> mov BL, j mov DL, data_mem[BX] <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>h next4: cmp DL, <span class="hljs-string"><span class="hljs-string">'['</span></span> ; the cell contains [ jne next5 ; <span class="hljs-keyword"><span class="hljs-keyword">no</span></span>, go <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the label next5 mov BL, j mov DL, data_mem[BX] cmp DL, <span class="hljs-number"><span class="hljs-number">00</span></span> ; yes, <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> data_mem element <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> zero jz next5 ; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> zero, jump further mov DL, i ; otherwise <span class="hljs-keyword"><span class="hljs-keyword">load</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> i_stor mov i_stor, DL next5: cmp DL, <span class="hljs-string"><span class="hljs-string">']'</span></span> ; the cell contains ] jne next6 ; <span class="hljs-keyword"><span class="hljs-keyword">no</span></span>, go <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the label next6 mov BL, j mov DL, data_mem[BX] cmp DL, <span class="hljs-number"><span class="hljs-number">00</span></span> ; yes, <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> data_mem element <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> zero jz next6 ; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> zero, jump further mov DL, i_stor ; otherwise <span class="hljs-keyword"><span class="hljs-keyword">load</span></span> i_stor <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> i mov i, DL next6: inc i mov BL, i mov DL, command_mem[BX] <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> prev mov AX, <span class="hljs-number"><span class="hljs-number">4</span></span>c00h ; terminate the program <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>h <span class="hljs-type"><span class="hljs-type">text</span></span> ends data segment command_mem DB <span class="hljs-string"><span class="hljs-string">'+'</span></span>,<span class="hljs-string"><span class="hljs-string">'+'</span></span>,<span class="hljs-string"><span class="hljs-string">'+'</span></span>,<span class="hljs-string"><span class="hljs-string">'+'</span></span>,<span class="hljs-string"><span class="hljs-string">'['</span></span>,<span class="hljs-string"><span class="hljs-string">'&gt;'</span></span>,<span class="hljs-string"><span class="hljs-string">'+'</span></span>,<span class="hljs-string"><span class="hljs-string">'&lt;'</span></span>,<span class="hljs-string"><span class="hljs-string">'-'</span></span>,<span class="hljs-string"><span class="hljs-string">']'</span></span>, <span class="hljs-string"><span class="hljs-string">'$'</span></span> data_mem DB <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">'$'</span></span> i DB <span class="hljs-number"><span class="hljs-number">0</span></span> ; command_mem <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> j DB <span class="hljs-number"><span class="hljs-number">0</span></span> ; data_mem <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> i_stor DB <span class="hljs-number"><span class="hljs-number">0</span></span> data ends stk segment stack db <span class="hljs-number"><span class="hljs-number">100</span></span>h dup (<span class="hljs-number"><span class="hljs-number">0</span></span>) ; reserve <span class="hljs-number"><span class="hljs-number">256</span></span> cells stk ends <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span></code> </pre><br><img src="https://habrastorage.org/webt/ar/0w/49/ar0w49wleplzlbnl0k3rrrxo8-a.jpeg"><br><br>  Add the input function <b>3fh</b> interrupt <b>21h</b> <br><br><pre> <code class="hljs pgsql">mov ah, <span class="hljs-number"><span class="hljs-number">3</span></span>fh ; <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> mov cx, <span class="hljs-number"><span class="hljs-number">100</span></span>h ; the number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> bytes you want <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> mov dx,<span class="hljs-keyword"><span class="hljs-keyword">OFFSET</span></span> command_mem <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>h</code> </pre><br>  the <i>loop</i> is finished <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">cmp</span></span> DL, <span class="hljs-string"><span class="hljs-string">'$'</span></span> je exit_loop</code> </pre><br>  Change <i>loop</i> to <i>jmp</i> <br><br><pre> <code class="hljs pgsql">mov ah, <span class="hljs-number"><span class="hljs-number">3</span></span>fh ; <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> mov cx, <span class="hljs-number"><span class="hljs-number">100</span></span>h ; the number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> bytes you want <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> mov dx,<span class="hljs-keyword"><span class="hljs-keyword">OFFSET</span></span> command_mem <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>h mov DL, command_mem ; <span class="hljs-keyword"><span class="hljs-keyword">load</span></span> the <span class="hljs-number"><span class="hljs-number">1</span></span>st command <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the DL ;mov CX, <span class="hljs-number"><span class="hljs-number">100</span></span>h prev: cmp DL, <span class="hljs-string"><span class="hljs-string">'$'</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> command <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-string"><span class="hljs-string">'$'</span></span> je exit_loop ; jump <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> has successfully passed</code> </pre><br>  Add the <i>jups</i> directive. <br><blockquote>  The JUMPS directive enables automatic conditional jump extending in TASM.  TASM converts out.  For example: <br><br><pre> <code class="hljs nginx"> <span class="hljs-attribute"><span class="hljs-attribute">JE</span></span> EQUAL_PLACE becomes: JNE @<span class="hljs-variable"><span class="hljs-variable">@A</span></span> JMP EQUAL_PLACE @<span class="hljs-variable"><span class="hljs-variable">@A</span></span>:</code> </pre><br></blockquote><br>  After all <br><br><pre> <code class="hljs matlab">JUMPS ; bf4.asm text segment assume cs:text,ds:data, ss: stk begin: mov AX,data mov DS,AX ;;; mov ah, <span class="hljs-number"><span class="hljs-number">3</span></span>fh mov cx, <span class="hljs-number"><span class="hljs-number">100</span></span>h mov dx,OFFSET command_mem int <span class="hljs-number"><span class="hljs-number">21</span></span>h ;;; mov DL, command_mem ;mov CX, <span class="hljs-number"><span class="hljs-number">100</span></span>h prev: cmp DL, <span class="hljs-string"><span class="hljs-string">'$'</span></span> je exit_loop cmp DL, <span class="hljs-string"><span class="hljs-string">'+'</span></span> jne next mov BL, <span class="hljs-built_in"><span class="hljs-built_in">j</span></span> inc data_mem[BX] next: cmp DL, <span class="hljs-string"><span class="hljs-string">'-'</span></span> jne next1 mov BL, <span class="hljs-built_in"><span class="hljs-built_in">j</span></span> dec data_mem[BX] next1: cmp DL, <span class="hljs-string"><span class="hljs-string">'&gt;'</span></span> jne next2 inc <span class="hljs-built_in"><span class="hljs-built_in">j</span></span> next2: cmp DL, <span class="hljs-string"><span class="hljs-string">'&lt;'</span></span> jne next3 dec <span class="hljs-built_in"><span class="hljs-built_in">j</span></span> next3: cmp DL, <span class="hljs-string"><span class="hljs-string">'.'</span></span> jne next4 mov AH,<span class="hljs-number"><span class="hljs-number">2</span></span> mov BL, <span class="hljs-built_in"><span class="hljs-built_in">j</span></span> mov DL, data_mem[BX] int <span class="hljs-number"><span class="hljs-number">21</span></span>h next4: cmp DL, <span class="hljs-string"><span class="hljs-string">'['</span></span> jne next5 mov BL, <span class="hljs-built_in"><span class="hljs-built_in">j</span></span> mov DL, data_mem[BX] cmp DL, <span class="hljs-number"><span class="hljs-number">00</span></span> jz next5 mov DL, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> mov i_stor, DL next5: cmp DL, <span class="hljs-string"><span class="hljs-string">']'</span></span> jne next6 mov BL, <span class="hljs-built_in"><span class="hljs-built_in">j</span></span> mov DL, data_mem[BX] cmp DL, <span class="hljs-number"><span class="hljs-number">00</span></span> jz next6 mov DL, i_stor mov <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>, DL next6: inc <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> mov BL, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> mov DL, command_mem[BX] jmp prev exit_loop: MOV AH,<span class="hljs-number"><span class="hljs-number">2</span></span> MOV DL,<span class="hljs-number"><span class="hljs-number">0</span></span>Ah INT <span class="hljs-number"><span class="hljs-number">21</span></span>h mov AX, <span class="hljs-number"><span class="hljs-number">4</span></span>c00h int <span class="hljs-number"><span class="hljs-number">21</span></span>h text ends data segment command_mem DB <span class="hljs-number"><span class="hljs-number">256</span></span>h DUP(<span class="hljs-string"><span class="hljs-string">'$'</span></span>) data_mem DB <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">'$'</span></span> <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> DB <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">'$'</span></span> <span class="hljs-built_in"><span class="hljs-built_in">j</span></span> DB <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">'$'</span></span> i_stor DB <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">'$'</span></span> data ends stk segment para stack db <span class="hljs-number"><span class="hljs-number">100</span></span>h dup (<span class="hljs-number"><span class="hljs-number">0</span></span>) stk ends <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> begin</code> </pre><br>  <a href="https://github.com/demsp/bf/tree/master/ENG">github.com</a> </div><p>Source: <a href="https://habr.com/ru/post/428644/">https://habr.com/ru/post/428644/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../428632/index.html">Understanding React Interceptors</a></li>
<li><a href="../428634/index.html">Porting Quake3</a></li>
<li><a href="../428636/index.html">Roskomnadzor is going to collect a fine from Google</a></li>
<li><a href="../428638/index.html">Hearts Fiery Motor: QardioCore Heart Monitor Review</a></li>
<li><a href="../428640/index.html">With a tube in your pocket: Snom DECT equipment for wireless telephone networks</a></li>
<li><a href="../428646/index.html">Last year's iPhone models also slow down as the battery wears out.</a></li>
<li><a href="../428648/index.html">Anton Arkhipov about effective work with IntelliJ IDEA and TeamCity on jug.msk.ru</a></li>
<li><a href="../428650/index.html">Loyalty system or how to live for free</a></li>
<li><a href="../428652/index.html">MIT course "Computer Systems Security". Lecture 15: "Medical software", part 1</a></li>
<li><a href="../428654/index.html">MIT course "Computer Systems Security". Lecture 15: "Medical software", part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>