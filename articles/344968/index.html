<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Translation - Maximum Usage APK Analyzer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of my favorite recent additions to Android Studio is APK Analyzer , which you can find in the main menu in the Build ‚Üí Analyze APK section . 


 U...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Translation - Maximum Usage APK Analyzer</h1><div class="post__text post__text-html js-mediator-article">  One of my favorite recent additions to Android Studio is <b>APK Analyzer</b> , which you can find in the main menu in the <b><i>Build ‚Üí Analyze APK section</i></b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/37c/cec/c25/37ccecc2566b764916f91cb7efb3a62f.png" alt="image"><br>  <i>Useful tip: you can simply drag and drop the APK files into the editor to open them</i> <br><br>  APK Analyzer allows you to open and check the contents of any APK file that you have on a computer that can be created from your project in Android Studio, or obtained from the build server or another storage.  It is not necessary to <b><i>build the</i></b> APK file ( <b><i>Build ‚Üí Build APK</i></b> ) before this, and you do not need the source code for this APK. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  <b><i>Note</i></b>  APK Analyzer works best with release versions of APK.  If you need to analyze the debug version of your application, make sure that you use an APK that is not intended for Instant run.  To get this APK, <b><i>build</i></b> APK <b><i>Build ‚Üí Build APK</i></b> .  And you can also find out if you opened APK Instant Run by checking the archive file instant-run.zip. </blockquote><a name="habracut"></a><br>  Using APK Analyzer is a great way to review an APK file and learn about <a href="https://developer.android.com/topic/performance/reduce-apk-size.html">its structure</a> , check the contents before you release it, or check out some common problems, such as APK size and DEX problems. <br><br><h3>  Reducing the size of the application using APK Analyzer </h3><br>  APK Analyzer can provide you with a lot of interesting and useful information about the size of the application.  At the top of the screen you can see the <b>size of the raw file</b> - this is the APK size on the disk.  <b>The download size</b> shows how much data will be used to load your application, taking into account the compression that the Play Store does. <br><br>  The list of files and folders is sorted by their size in descending order.  Thanks to this, you are immediately shown as ‚Äúon a blue saucer‚Äù, which can be most easily optimized in the size of an APK.  Moving to any folder in the APK file, you will see the resources and objects that occupy the most space in the APK. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/740/518/e2f/740518e2f8ba7a5b9ab34729c4c7f5d6.png" alt="image"><br>  <b><i>Resources are sorted in descending order of size.</i></b> <br><br>  In this example, while studying the APK for possible size reduction, I was immediately able to notice that the 3-frame PNG animation is the biggest thing in resources, weighing 1.5 MB, and this is for <i>xxhdpi</i> density! <br><br>  Since these images look like ideal candidates for storage in the form of vectors, we found the source files for the illustrations and imported them as VectorDrawables, using the <a href="https://developer.android.com/studio/write/vector-asset-studio.html">new PSD support in the import tool of vector resources Android Studio 2.2</a> . <br><br>  By going through the same process for the other remaining animation ( <i>instruction_touch _ * .png</i> ) and deleting these PNG files in all densities, we were able to save more than 5 MB.  To maintain backward compatibility, we used <a href="https://medium.com/%40chrisbanes/appcompat-v23-2-age-of-the-vectors-91cbafa87c88">VectorDrawableCompat</a> from the support library. <br><br>  Looking through other resource folders, it was easy to detect some uncompressed WAV files that could be converted to OGG, which meant even more savings without touching the line of code. <br><br>  Next in the list of things that need to be checked was the <i>lib /</i> folder, which contains our own libraries for the three ABIs we support. <br>  It was decided to use the <a href="https://developer.android.com/studio/build/configure-apk-splits.html">support of the APK sections</a> in our Gradle assembly to create separate versions of the application for each ABI. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/80e/267/1e0/80e2671e0a62a18020fe58312cc85300.png" alt="image"><br>  <b><i>View other folders in APK</i></b> <br><br>  I quickly looked at <b>AndroidManifest.xml</b> and noticed that the <i>application</i> lacks the <i><a href="https://developer.android.com/reference/android/R.attr.html">android: extractNativeLibs attribute</a></i> .  Setting this attribute to false allows you to save some space on the device, as it prevents copying your own libraries from the APK to the file system.  The only requirement is that these files are paged and uncompressed inside the APK, which are supported by the <a href="http://android-developers.blogspot.com/2016/11/understanding-apk-packaging-in-android-studio-2-2.html">new packer</a> in the Android Gradle plugin version 2.2.0+. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/81f/3b9/ee2/81f3b9ee226b89dcec69578b2b1dfabb.png" alt="image"><br>  <b><i>Full AndroidManifest.xml when viewed in APK Analyzer</i></b> <br><br>  After making these changes, I was curious to compare the new version of the application with the previous one.  To do this, I checked the source from git commit from which I started, compiled the APK and saved it in another folder.  Then I used the <b>‚ÄúCompare with ...‚Äù</b> function to see the difference in size between the old and new builds. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b23/0f2/4d0/b230f24d0093a2c7fbfa3979f8bc8b59.png" alt="image"><br>  <b><i>Comparison APK - access it through the button in the upper right corner</i></b> <br><br>  We walked through resources and native libraries well, saving 17 MB with very few changes in the application.  However, I see that our DEX size regresses, and class2.dex grows by 400 KB. <br><br><h3>  Debugging DEX Problems </h3><br>  In this case, the difference was due to updating our dependencies to newer versions and adding new libraries.  <a href="https://developer.android.com/studio/build/shrink-code.html">Proguard</a> and <a href="https://developer.android.com/studio/build/multidex.html">Multidex</a> have already been included for our assemblies, so this DEX size is not so much.  However, the APK Analyzer is a great tool for debugging any problems with this setting, especially when you first turn on Multidex or Proguard for your project. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba3/dac/b12/ba3dacb12d0c7f0d1ed564d34001b26b.png" alt="image"><br>  <b><i>View the contents of classes.dex</i></b> <br><br>  When you click on any DEX file, you will see information about how many classes and methods it defines, and how many general references to methods it contains (these are the methods that are taken into account in the <a href="https://developer.android.com/studio/build/multidex.html">64K limit</a> in one DEX file).  In this example, a screenshot, the application is about to reach the limit, which means that in the near future it will need MultiDex to separate the classes into separate files. <br><br>  You can view the contents of the packages to find out which of them use all the links.  In this example, we see that the main reasons for the bloated DEX file are the support library and Google Play services. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/779/5b1/653/7795b16532975954d46f71658252181e.png" alt="image"><br>  <b><i>Number of links to the package</i></b> <br><br>  After you have enabled MultiDex and compiled the application, you will see the second file, classes2.dex (and, possibly, classes3.dex, etc.). The MultiDex solution in the Android-Gradle plugin determines which classes are needed to run your application and places them in the main classes.dex file, but in the rare case when it does not work, and you get a ClassNotFoundException exception, you can use APK Analyzer to check DEX files and then <a href="http://google.github.io/android-gradle-dsl/2.2/com.android.build.gradle.internal.dsl.ProductFlavor.html">force the missing classes to the primary DEX file</a> . <br><br>  You will encounter similar problems when you enable Proguard and use classes or methods by reflecting or from XML layouts.  The APK Analyzer can help check the correctness of the Proguard configuration, allowing you to easily check if there are any methods and classes in the APK, and whether they are renamed (during obfuscation).  You can also make sure that the classes you want to delete are actually deleted and are not counted in the method counter. <br><br>  We would be interested to know what other applications you will find for APK Analyzer and what other features you would like to see integrated into this tool! </div><p>Source: <a href="https://habr.com/ru/post/344968/">https://habr.com/ru/post/344968/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344956/index.html">For those who were afraid, but still ready to try. (Excel)</a></li>
<li><a href="../344960/index.html">Phone number without a passport</a></li>
<li><a href="../344962/index.html">Git bottom to top</a></li>
<li><a href="../344964/index.html">FAQ on integration with ESIA</a></li>
<li><a href="../344966/index.html">HyperRAM: Using a HyperBus Memory Interface Chip</a></li>
<li><a href="../344970/index.html">ChatScript Intelligent Chatbots: Development Practice and JavaScript Integration</a></li>
<li><a href="../344972/index.html">Found the largest database of stolen passwords: what you should know</a></li>
<li><a href="../344974/index.html">Solving the problem of class name CSS conflicts in a React application using a webpack loader</a></li>
<li><a href="../344980/index.html">Simplify user action log</a></li>
<li><a href="../344982/index.html">Lectures of the Technosphere. Neural networks in machine learning</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>