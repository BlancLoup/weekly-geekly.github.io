<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Patch everything, that neither getting or Open source in action</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Perhaps many have come across a situation where the program or library from the distribution does not contain some (necessary) functionality that was ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Patch everything, that neither getting or Open source in action</h1><div class="post__text post__text-html js-mediator-article">  Perhaps many have come across a situation where the program or library from the distribution does not contain some (necessary) functionality that was added in the next version.  Or it contains a bug that was fixed in the next version (or its fix was not included in the main branch), and the old version is still contained in the repository of your distribution. <br><br>  It was with such a bug that I encountered, as well as all users of the JuffEd editor (the new version of which, by the way, was released the other day), using the GNOME environment under Linux as the working environment.  This bug lies in the fact that when using autocomplete, its window appears for a moment, after which it disappears, ‚Äútaking‚Äù the focus behind it.  In this example, I will show how you can patch programs from the distribution kit yourself. <br><a name="habracut"></a><br>  The described bug is a bug of the QScintilla library, which manifests itself in all programs that use this component (for example, Eric4 has the same behavior).  If you do not use any of these programs, but itching to try - you can install one of them purely for experimental purposes.  But, I repeat, the bug only appears under GNOME, and under KDE everything works. <br>  I sent the patch to the developers and conducted some testing of it, but if they include this patch, in the next version.  And what about those who do not use the latest distributions?  In this case, the situation is further complicated by the fact that the new version of the library (2.4) is binary incompatible with the previous one (2.3, which is contained, for example, in Ubuntu 9.04), so it will be impossible to simply assemble and install version 2.4 after they solve this problem. - programs compiled using native version 2.3, when using version 2.4, fall in 100% of cases. <br><br>  Well, scared?  :) And now less words, more things! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Cooking ingredients </h3><br>  We will build the ‚Äúnative‚Äù version, but with the patch we need.  I will describe the whole process in case we rule something from scratch, and also talk about shorter paths, in case the patch already exists. <br><br>  So, create a directory for experiments and go into it: <br><br><blockquote><code>$ mkdir -p experiments/qscintilla <br> $ cd experiments/qscintilla</code> </blockquote> <br><br>  First we need the source code of exactly the version that is installed on your system.  This is done not simply, but very simply: <br><br><blockquote> <code>$ apt-get source libqscintilla2-3</code> </blockquote> <br><br>  But for this, you should have the source repositories on par with the main repositories: <br><img src="https://habrastorage.org/getpro/habr/post_images/1e7/f4a/c54/1e7f4ac5415e5bb1016e4da08b9828b9.png"><br><br>  So, we got exactly the source code from which the package that contains the repository was assembled.  Most (if not all) packages have distro-specific patches, which in the case of Debian-based distributions are in the debian / patches subdirectory.  These patches are applied before the build itself, and our task is to put a deb patch there with the correction we need.  For this we need the dpatch utility.  Install it (as well as several other utilities that we will need when building) and go to the main directory with the program: <br><br><blockquote> <code>$ sudo aptitude install dpatch cdbs fakeroot build-essential patch <br> $ cd qscintilla2-2.3.2/</code> </blockquote> <br><br><h3>  Add the main highlight </h3><br>  We see that in the debian / patch directory there are 3 files: the 00list file and 2 files with the .dpatch extension.  As you might guess, the 00list file contains a list of patches, and the remaining files are patches.  To avoid confusion, those patches that are in the debian / patches directory and which are intended for the dpatch program, I will call debuts, and just patches will be called regular fixes that can be created by the diff program and which are usually used by the patch program for making changes. <br><br>  Those who are interested in the result, and the process itself - not really, can download the finished debut patch <a href="http://juffed.googlecode.com/files/03_autocomplete.dpatch">here</a> , put it in the debian / patches directory and go to the paragraph at the end of this section, which begins with the words ‚ÄúIf we now look in the debian / patches directory .... " <br>  Those who are interested in the process themselves, read further the instructions on how to make such a deb patch independently. <br><br>  To create your own deb-patch, being in the main program directory run the command dpatch-edit-patch &lt;patch_name&gt;, where &lt;patch_name&gt; is the name of the new deb-patch.  This will create a temporary copy of the entire source directory, and our shell will be automatically redirected to it.  Here we can edit the source code as we see fit, after which we simply exit this ‚Äúnested shell‚Äù with the exit command, and the result of all these actions will be the necessary deb-patch containing all the changes made.  You can edit both manually and using the patch command (regular patch, not dpatch), applying patches created by someone else. <br><br>  So, I leave the manual edit behind the scenes, because  for everyone, it can be individual (you can remove something unnecessary, or you can simply add to the ‚ÄúPeace, Work, May!‚Äù About dialogue) or show you how to use ready-made patches using the example of the case in question, namely to fix autocompletion in QScintilla.  Here is the patch I sent to the QScintilla developers.  Save it to your disk. <br><blockquote> <code><font color="#298a52"><b>--- Qt4/SciClasses.cpp  2009-10-16 10:09:48.000000000 -0400</b></font> <br> <font color="#298a52"><b>+++ Qt4/SciClasses.cpp  2009-10-16 10:11:01.000000000 -0400</b></font> <br> <font color="#a52829"><b>@@ -128,7 +128,7 @@</b></font> <br> SciListBox::SciListBox(QWidget *parent, ListBoxQt *lbx_) <br> : QListWidget(parent), lbx(lbx_) <br> { <br> <font color="#6b59ce">-    setWindowFlags(Qt::Tool|Qt::FramelessWindowHint);</font> <br> <font color="#008a8c">+    setWindowFlags(Qt::ToolTip|Qt::WindowStaysOnTopHint);</font> <br> setAttribute(Qt::WA_StaticContents); <br> <br> setFocusProxy(parent); <br></code> </blockquote><br>  <a href="http://juffed.googlecode.com/files/qscintilla_autocomplete.patch">Download patch</a> <br><br>  So, now everything that I told above with many incomprehensible words, we will do with the help of short and clear commands :) We are in the main source directory qscintilla2-2.3.2: <br><br><blockquote> <code>$ dpatch-edit-patch 03_autocomplete (  -       ) <br> $ patch -p0 &lt; /path/to/our/qscintilla_autocomplete.patch (   ) <br> $ exit (  " ")</code> </blockquote> <br><br>  If we now look into the debian / patches directory, we will see that another file appeared there named 03_autocomplete.dpatch.  All that remains to be done is to add its name (without the .dpatch extension) to the 00list file.  If you forget to do this, the package will assemble without our changes and will not be any different from what is in the repository. <br><br><blockquote> <code>$ echo "03_autocomplete" &gt;&gt; debian/patches/00list</code> </blockquote> <br><br><h3>  Cook!  That is, we collect </h3><br>  Being still in the main source directory, we execute <br><br><blockquote> <code>$ dpkg-buildpackage -rfakeroot</code> </blockquote> <br><br>  He will surely swear that not all dependencies for the assembly are satisfied.  Install everything he asks.  On a completely clean machine, you will need to download 46.7 MB of archives, after unpacking which will be occupied by 181 MB on the disk.  If you have already installed one of these, then you will have to download less.  The lion's share is Qt4 developer libraries (30.6 MB and 124 MB, respectively). <br><br><blockquote> <code>$ sudo aptitude install libqt4-dev python-all-dev sip4 python-sip4 python-sip4-dev python-qt4-dev python-qt4</code> </blockquote> <br><br>  In the comments below, the arty <a href="https://habrahabr.ru/users/arty/" class="user_link">habrauser</a> quite rightly <a href="http://habrahabr.ru/blogs/ubuntu/72609/">remarked</a> that dependencies can be installed using <br><br><blockquote> <code>apt-get build-dep [package name]</code> </blockquote> <br><br>  and thus do not have to hand enumerate all the required packages. <br>  After installing all the required run the assembly again: <br><br><blockquote> <code>$ dpkg-buildpackage -rfakeroot</code> </blockquote> <br><br>  Now everything should go without questions. <br>  If you did everything correctly in the previous stages, then after some time the build will end (cursing for the lack of a digital signature, but this can be ignored), and several deb packages will appear in the directory level above.  We are interested in one of them: libqscintilla2-3_2.3.2-0ubuntu2_i386.deb.  Install it <br><br><blockquote> <code>$ sudo dpkg -i ../libqscintilla2-3_2.3.2-0ubuntu2_i386.deb</code> </blockquote> <br><br>  and [re] run programs that use this library (for example, JuffEd). <br><br>  Voila!  Autocomplete works! <br><br>  If there are additions or comments - welcome to the comments. <br><br>  For the laziest, the <a href="">already compiled and patched package for Ubuntu 9.04 (i386)</a> <br><br>  <b>UPD1:</b> sorry, flooded the wrong package.  If you downloaded deb, installed it, and still nothing works, download it again: <br>  $ md5sum libqscintilla2-3_2.3.2-patched-1ubuntu2_i386.deb <br>  e5047bb52011d80b06e82fafe5063a73 libqscintilla2-3_2.3.2-patched-1ubuntu2_i386.deb <br><br>  <b>UPD2:</b> patched <a href="">package for Ubuntu 9.10 (i386)</a> </div><p>Source: <a href="https://habr.com/ru/post/72609/">https://habr.com/ru/post/72609/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../72599/index.html">Business Internet. The first day</a></li>
<li><a href="../72603/index.html">HTPC from old trash</a></li>
<li><a href="../72605/index.html">Mac OS X "Snow Leopard" Review</a></li>
<li><a href="../72606/index.html">Steam system statistics</a></li>
<li><a href="../72608/index.html">Webmoney has one of the worst tech support.</a></li>
<li><a href="../72610/index.html">GAE: batch put, distribution and some fraudulent gestures</a></li>
<li><a href="../72612/index.html">How to make a website more iPhone-compatible in 5 steps</a></li>
<li><a href="../72617/index.html">Sip moquito</a></li>
<li><a href="../72618/index.html">Business in the style of Habr - 3. Criticism of pure reason</a></li>
<li><a href="../72619/index.html">Recruitment in the open source command</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>