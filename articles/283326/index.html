<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rebase flow. Method of preparation and its support in GitHub, GitLab, BitBucket</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A bit of history 


 At the very beginning of 2010, Vincent Driessen wrote an excellent article, A successful Git branching model . To understand what...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rebase flow. Method of preparation and its support in GitHub, GitLab, BitBucket</h1><div class="post__text post__text-html js-mediator-article"><h1>  A bit of history </h1><br><p>  At the very beginning of 2010, <a href="http://nvie.com/about/">Vincent Driessen</a> wrote an excellent article, <a href="http://nvie.com/posts/a-successful-git-branching-model/">A successful Git branching model</a> .  To understand what will be discussed further, of course, you need to get acquainted with the article.  And for those who have difficulty with the language of the original article, there is an excellent <a href="https://habrahabr.ru/post/106912/">translation of</a> it in Habr√©. </p><br><p>  From this point on, the described <strong><em>GitFlow</em></strong> branching model begins, as they say, to diverge around the world.  It is adopted by many teams.  Authors write many articles about its successful use.  She gets support in most tools that developers use: </p><br><ul><li>  <a href="https://github.com/nvie/gitflow">Plugin</a> for Git itself </li><li>  Plugins to various IDE: <a href="https://plugins.jetbrains.com/plugin/7315">IDEA</a> , <a href="http://eclipsesource.com/blogs/2015/06/22/git-flow-top-eclipse-mars-feature-3/">Eclipse</a> </li><li>  Native GUI client support: <a href="https://www.sourcetreeapp.com/">SourceTree</a> and <a href="https://gitextensions.github.io/">Git Extensions</a> </li><li>  Plugins for build systems: <a href="https://bitbucket.org/atlassian/jgit-flow/wiki/Home">Maven</a> , <a href="https://github.com/RobWin/jgitflow-gradle-plugin">Gradle</a> , etc. </li><li>  Native support in repository managers: <a href="https://github.com/">GitHub</a> , <a href="https://bitbucket.org/">BitBucket</a> , <a href="https://about.gitlab.com/">GitLab</a> , etc. </li></ul><br><p><img src="https://habrastorage.org/files/967/53a/f7e/96753af7e81345639c32ab3265b48202.jpg" alt="Git"></p><br><p>  It seems that the model is perfect.  Perhaps this is the case, if you have a small team, unchangeable scop releases, high culture of work with <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0_%25D1%2583%25D0%25BF%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25B2%25D0%25B5%25D1%2580%25D1%2581%25D0%25B8%25D1%258F%25D0%25BC%25D0%25B8">VCS</a> .  Then, indeed, <em>GitFlow</em> can and will satisfy all your needs.  But, unfortunately, the conditions described are not suitable for all teams and not all projects.  By the way, to find articles in which the authors would describe the problems of this model is not so easy even in 2016.  But as we all know, <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B1%25D1%2580%25D1%258F%25D0%25BD%25D0%25BE%25D0%25B9_%25D0%25BF%25D1%2583%25D0%25BB%25D0%25B8_%25D0%25BD%25D0%25B5%25D1%2582">there is no silver bullet</a> , and this means that in this model everything is far from being good for everyone. </p><a name="habracut"></a><br><h1>  What's wrong with classic <em>GitFlow</em> ? </h1><br><p>  The story begins with the fact that classic <em>GitFlow</em> involves a large number of <em>merge-</em> commit.  And the problem is not in the <em>merge</em> commits themselves (which, as you will see later, will still be present in the history), but in a huge amount of them.  Debates on the topic ‚Äú <a href="https://git-scm.com/docs/git-merge">Merge</a> vs <a href="https://git-scm.com/docs/git-rebase">Rebase</a> ‚Äù are often found on the Internet (search engines will prompt).  Atlassian, by the way, has a good <a href="https://www.atlassian.com/git/tutorials/merging-vs-rebasing">article</a> that describes the difference between these two approaches.  So what's the deal? </p><br><ol><li><p> The history of commits is just awful.  The photo below is just <strong>one</strong> day of the team. <br><br><img src="https://habrastorage.org/files/116/813/ad5/116813ad5b1d4eb084fc4a1f83ba5c03.png" alt="Git flow history"><br><br>  Yes, we have <code>git log --first-parent</code> and other options to filter the tree, but this doesn‚Äôt help a full analysis of the story.  If the development team, apart from the classic <em>GitFlow</em> , does not have any other agreements on the maintenance of the <em>Git</em> repository, then in this story it will be possible to watch in whole batches of commits with absolutely meaningless messages " <em>fix</em> ", " <em>refactoring</em> ", <em>""</em> , etc.  This will make the commit history almost unusable even for the most superficial analysis. </p><br></li><li><p>  If your release scoop changes (and this is not rare in <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D0%25B8%25D0%25B1%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4%25D0%25BE%25D0%25BB%25D0%25BE%25D0%25B3%25D0%25B8%25D1%258F_%25D1%2580%25D0%25B0%25D0%25B7%25D1%2580%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D0%25BA%25D0%25B8">Agile</a> ), then classic <em>GitFlow</em> is unlikely to work for you.  If in your workflow <strong>there</strong> are <strong>often</strong> phrases that fall under the pattern " <em>The customer urgently needs an assembly, in which [\ w] *</em> ", then with the history of commits, clearly presented in the previous paragraph, your life will turn into hell.  I am not kidding. </p><br></li><li>  Merge commits make it harder to use <a href="https://git-scm.com/docs/git-bisect"><code>git bisect</code></a> </li></ol><br><h1>  And what would you like? </h1><br><p>  It is very difficult to explain why it is so important that the commit history is clean.  Experienced developers do not need an explanation why the source code should be clean, for them this statement is an axiom.  In my opinion, the analogy here is absolutely straightforward.  As well as every line of clean code, every commit of history should be in its place and understandable to anyone, even an outsider, developer.  Yes, dirty code can also be working, but how convenient is it to work with it?  How quickly will a new employee be able to figure it out?  The same with the commit history.  Even a dirty story will know absolutely everything about all the changes in the project, but will it be convenient to work with it? </p><br><p>  In order to work with the <em>Git</em> repository was simple, convenient and understandable, in my opinion only two things are needed: </p><br><ul><li><p>  <strong>Linear change history</strong> .  This property limits the thickness of the commit tree to a constant, making it as simple and intuitive as possible for analysis. </p><br></li><li>  <strong>The logical completeness of each commit</strong> .  This property greatly increases the flexibility of the change history.  In this case, if necessary, individual improvements can be easily transferred with the <a href="https://git-scm.com/docs/git-cherry-pick"><code>git cherry-pick</code></a> command.  Or completely canceled with the <a href="https://git-scm.com/docs/git-revert"><code>git revert</code></a> command, which in the case of a simple commit is much easier than in the case of a <em>merge</em> commit. </li></ul><br><p>  If both properties are executed, the commit tree will look like this: </p><br><p><img src="https://habrastorage.org/files/a2c/ee4/294/a2cee4294bf24872b8a4c1fd1eeb428f.png" alt="Rebase flow history"></p><br><h1>  How to achieve this? </h1><br><p>  You don't need to <em>edit</em> much of classic <em>GitFlow at all</em> .  At the same time, working with <em>develop</em> , <em>master</em> , <em>release</em> and <em>hotfix</em> branches remains exactly the same as in classic <em>GitFlow</em> .  Edits will touch only work with <em>feature-</em> branches. </p><br><ol><li><p>  Before introducing a <em>feature-</em> branch into the final one, it needs to make an interactive <a href="https://git-scm.com/docs/git-rebase"><em>rebase</em></a> with the <code>git rebase -i develop</code> command, with all the intermediate commits in the brunch merged ( <a href="https://git-scm.com/book/ru/v1/%25D0%2598%25D0%25BD%25D1%2581%25D1%2582%25D1%2580%25D1%2583%25D0%25BC%25D0%25B5%25D0%25BD%25D1%2582%25D1%258B-Git-%25D0%259F%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B7%25D0%25B0%25D0%25BF%25D0%25B8%25D1%2581%25D1%258C-%25D0%25B8%25D1%2581%25D1%2582%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B8"><em>squash</em></a> 'it) into one.  There are cases when the history of commits in the <em>feature-</em> branch makes sense to leave, but these cases are very rare in practice.  With a good task decomposition, each small task is an atomic and logically complete change of the system that fits perfectly in one commit.  Considering that all changes within a task can be combined into one commit at the very last moment, while working on a task, the developer can still freely create many of the intermediate commits needed for a potential rollback.  Well, it would not be superfluous to add that there is a great <a href="https://git-scm.com/docs/git-rerere"><em>rerere</em></a> command that helps developers who often perform the <em>rebase</em> operation. </p><br></li><li><p>  You need to upload a <em>feature-</em> branch to a remote repository using the <code>git push --force</code> , as in the previous paragraph we <em>rebranded the</em> branch. </p><br></li><li>  You need to add a <em>feature-</em> branch to the final one with the <code>git merge --ff-only feature</code> command, since only in this case it will be possible to preserve the linearity of the commit history and avoid the appearance of a <em>merge-</em> commit. </li></ol><br><p>  As you can see, there are very few changes in working with the repository.  And, summing up some of this part of the article, I want to share a <a href="https://www.atlassian.com/git/articles/git-team-workflows-merge-or-rebase/">link</a> to a great article, which also discusses the pros and cons of classic <em>GitFlow</em> and <em>Rebase Flow</em> . </p><br><h1>  Rebase Flow support in repository managers </h1><br><p>  As I mentioned at the very beginning of the article, there is support for classic <em>GitFlow</em> in a variety of tools, including various repository managers.  Therefore, I will consider further the question of how things are now with the support of <em>Rebase Flow</em> in popular repository managers.  In this case, my assessment will be in the format of a regular university mark. </p><br><h2>  <a href="https://github.com/">Github</a> </h2><br><p>  <em>Rebase Flow</em> Support: <strong>GOOD</strong> </p><br><p>  In fact, GitHub has almost everything you need.  In the repository settings there is a tick "Allow squash merging". </p><br><p><img src="https://habrastorage.org/files/762/5be/181/7625be181df140a8a8c8d57ab491e572.png" alt="Githubtsettings"></p><br><p>  It allows you to select the appropriate item during the <em>pull request</em> and edit the final message to the commit </p><br><p><img src="https://habrastorage.org/files/83b/21d/2a1/83b21d2a1050492dbe458d4d81c8679c.png" alt="Githubmerge"></p><br><p>  As a result, the <em>pull request</em> will be dead linearly and all the commits will be closed into one. </p><br><p>  The only minus that I see on the side of github is </p><br><ol><li>  inability to merge <em>pull request</em> without merging commits.  Very rarely, but this is still required and, in the case of GitHub, this merge will have to be done manually. </li></ol><br><p>  All of the above applies to <a href="https://enterprise.github.com/home">GitHub Enterprise</a> , which can be deployed on your company's servers. </p><br><h2>  <a href="https://bitbucket.org/">Bitbucket</a> </h2><br><p>  <em>Rebase Flow</em> Support: <strong>UNSPECIFICALLY</strong> </p><br><p>  And in fact it simply is not.  If you want to use <em>Rebase Flow</em> in your work, then BitBucket will not help you with this, you have to do everything yourself. </p><br><p>  And this is surprising, given that in the text of this article I have repeatedly referred to excellent articles from the Atlassian website.  Let's hope that in the future the situation with <em>Rebase Flow</em> support will change, especially since the tasks for this have long been initiated </p><br><ul><li>  <a href="https://bitbucket.org/site/master/issues/6106/forced-non-fast-forward-merge-of-pull">Forced non fast forward merge of pull request?</a> </li><li>  <a href="https://bitbucket.org/site/master/issues/8995/provide-the-option-to-use-git-merge-squash">"Git merge --squash" for pull requests</a> </li><li>  <a href="https://bitbucket.org/site/master/issues/9589/force-fast-forward-only-merges-on-pull">Force fast forwarding</a> </li><li>  <a href="https://bitbucket.org/site/master/issues/6768/detect-and-handle-rebasing-and-auto-merge">Detect and handle rebasing and auto-merge in more situations</a> </li><li>  etc. </li></ul><br><p>  Let's now see what with <em>Rebase Flow</em> support for a paid product from Atlassian. </p><br><h2>  <a href="https://ru.atlassian.com/software/bitbucket/download">Atlassian BitBucket Server</a> (aka Atlassian Stash) </h2><br><p>  <em>Rebase Flow</em> Support: <strong>SATISFACTORY</strong> </p><br><p>  I am considering BitBucket v4.5.2 and maybe in future versions the situation will change for the better.  Now with support in BitBucket Server is somewhat better than in its cloud brother.  If you have access to administrators, you can kindly ask them in the <code>bitbucket.properties</code> file <code>bitbucket.properties</code> change the <em>pull request</em> settings for your project / repository ( <a href="https://confluence.atlassian.com/bitbucketserver/bitbucket-server-config-properties-776640155.html">documentation</a> ) </p><br><ul><li>  <code>plugin.bitbucket-git.pullrequest.merge.strategy.KEY.slug</code> - setting for a specific <code>slug</code> repository in the <code>KEY</code> project. </li><li>  <code>plugin.bitbucket-git.pullrequest.merge.strategy.KEY</code> - setting for a specific <code>KEY</code> project. </li><li>  <code>plugin.bitbucket-git.pullrequest.merge.strategy</code> - global configuration for the entire BitBucket Server. </li></ul><br><p>  The settings may be as follows. </p><br><ul><li>  <code>no-ff</code> - no <em>fast-forward</em> .  This is the default value. </li><li>  <code>ff</code> ‚Äì‚Äì if possible, <em>fast-forward</em> merge will be executed. </li><li>  <code>ff-only</code> - always <em>fast-forward</em> merzh.  You simply cannot <em>pull pull request</em> if it cannot be done linearly. </li><li>  <code>squash</code> - merges all commits into one and does not create a <em>merge</em> commit. </li><li>  <code>squash-ff-only</code> - merges all commits into one and does not create a <em>merge</em> -commit, but does so only if <em>fast-forward</em> merzh is possible. </li></ul><br><p>  As you can see, the settings are quite flexible, but there are two problems. </p><br><ol><li>  There is no web-interface settings, and requests to administrators complicate the work process. </li><li>  You cannot select a behavior for a specific <em>pull request</em> , the minimum configured entity is a repository. </li></ol><br><p>  Once these two problems are resolved, <em>BitBucket‚Äôs</em> support for <em>Rebase Flow</em> will be excellent.  In the meantime ... </p><br><h2>  <a href="https://gitlab.com/">Gitlab</a> </h2><br><p>  <em>Rebase Flow</em> Support: <strong>GOOD</strong> </p><br><p>  Evaluating the support at <a href="https://gitlab.com/">https://gitlab.com</a> , we, in fact, appreciate the support in the <a href="https://about.gitlab.com/pricing/">GitLab EE</a> product, on the basis of which it is implemented.  As for the support of <em>Rebase Flow</em> in <a href="https://about.gitlab.com/downloads/">GitLab CE</a> , it is simply not there. </p><br><p>  To understand how <em>Rebase Flow</em> support is organized, take a look at the project settings. </p><br><p><img src="https://habrastorage.org/files/10b/b4c/3c6/10bb4c3c620b40b684636b6ba2872e19.png" alt="GitLabProjectSettings"></p><br><p>  As you can see, there is even an intermediate version of the semi-linear history, when <em>merge-</em> commits remain, but the ability to accept a <em>pull request</em> appears only if the <em>feature-</em> branch is a linear continuation.  If this option with a semi-linear history or ‚ÄúFast-forward merge‚Äù is selected, we have the additional ability to manage the <em>pull request</em> 'om.  Namely, the ‚ÄúRebase onto ...‚Äù button appears, which allows you to make a <em>feature</em> from the <em>feature</em> branch a linear continuation of the story. </p><br><p><img src="https://habrastorage.org/files/fd3/6b6/1ac/fd36b61ac076407bb436e9ce609d47f4.png" alt="GitLabProjectRebase"></p><br><p>  After that, you can easily accept a <em>pull request</em> , which will be interrupted without creating a separate <em>merge-</em> commit. </p><br><p><img src="https://habrastorage.org/files/db7/28e/4e1/db728e4e1cfd4001a74a6e0d3dc82d13.png" alt="GitLabProjectAccept"></p><br><p>  A more detailed description of this functionality can be found in the documentation ( <a href="http://doc.gitlab.com/ee/workflow/rebase_before_merge.html">one</a> , <a href="http://doc.gitlab.com/ee/workflow/ff_merge.html">two</a> ).  Despite the fact that the screenshots in it are a bit outdated, it has not lost its relevance.  At this, in principle, support <em>Rebase Flow</em> ends.  The fact that it exists at all is, of course, a plus, but it clearly lacks </p><br><ol><li>  Ability to select behavior for a specific <em>pull request</em> .  Yes, before accepting a <em>pull request,</em> you can change the settings of the project itself, but this is not very convenient. </li><li>  Possibilities of automatic merging of commits by <em>feature</em> -branch into one. </li></ol><br><h2>  What is the result? </h2><br><p>  Now the majority of <em>Git</em> repository managers implement <em>Rebase Flow</em> support in some form.  And the convenience of working in them is now much higher than a few years ago.  But still, in my opinion, all the products still have disadvantages, and I continue to believe that they will fix them in the future. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/283326/">https://habr.com/ru/post/283326/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../283314/index.html">Styling React components</a></li>
<li><a href="../283316/index.html">Business program PHDays: a frank discussion of complex issues</a></li>
<li><a href="../283318/index.html">What is a "native application"?</a></li>
<li><a href="../283320/index.html">Targeted attacks on hotel chains: a practical example</a></li>
<li><a href="../283324/index.html">Microsoft fixed major vulnerabilities in Windows</a></li>
<li><a href="../283328/index.html">Creating a touch node for the Internet of things on Intel Edison</a></li>
<li><a href="../283330/index.html">Build your AirFiber yourself Or NxN - the designer of the radio relay line from Ubiquiti</a></li>
<li><a href="../283332/index.html">Announcement! We invite you to take part in the hackathon on machine learning technologies</a></li>
<li><a href="../283334/index.html">Moscow Python Meetup ‚Ññ35 (May 23, 7 pm)</a></li>
<li><a href="../283340/index.html">DevConf-2016: conference program</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>