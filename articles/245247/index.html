<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pebble: add configuration and save options to your application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With increasing functionality and increasing the complexity of the application, it becomes necessary to give the user the ability to customize the par...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pebble: add configuration and save options to your application</h1><div class="post__text post__text-html js-mediator-article">  With increasing functionality and increasing the complexity of the application, it becomes necessary to give the user the ability to customize the parameters he needs.  The application in turn should be able to save these settings and provide the user with an interface for managing them.  What tools and opportunities did Pebble developers give us for this? <br><br>  The documentation for the Pebble project is good and the goal of the above is not to duplicate it.  This is an attempt to collect data storage and application configuration capabilities in one place.  Further, there are brief excerpts from the documentation and some code as an example project. <br><a name="habracut"></a><br><h2>  Data storage </h2><br>  The developers have provided the following options to store application data: <br><ol><li>  Storing application data on the device itself. <br>  For this, there is a separate key-value storage for each application.  Storage size up to 256 bytes, supports storing integers, strings and arrays of bytes.  A distinctive feature is that the data is stored on the watch itself, no pairing with the companion application is required, as a result, the speed of work and energy saving.  <a href="http://developer.getpebble.com/guides/pebble-apps/app-structure/persistent-storage/">[one]</a> </li><li>  Data storage on the phone in the companion application. <br>  In the official mobile application, <i>PebbleKit JavaScript</i> implements the API based on the localStorage object.  <a href="http://developer.getpebble.com/guides/js-apps/pebblekit-js/js-capabilities/">[2]</a> </li></ol><br><br><h2>  Application setup </h2><br>  <i>PebbleKit JavaScript</i> allows you to display on the smartphone screen a configuration window (web application) hosted and accessible at a URL specified by the developer.  <a href="http://developer.getpebble.com/guides/js-apps/pebblekit-js/app-configuration/">[3]</a> <br>  After the user's work with the web application is completed, it calls the special URL ‚Äúpebblejs: // close‚Äù and sends the necessary data to the mobile application. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Implementation </h2><br>  For the application to work properly with the settings, you need to implement the following: <br><ul><li>  persistent storage - to organize a ‚Äúlocal‚Äù storage of settings on the clock, necessary for the autonomous operation of the application; <br></li><li>  local storage - to organize a ‚Äúlocal‚Äù storage of settings in the official mobile application, it will be required to connect the configuration window with the application on the clock; <br></li><li>  make a web-page with a settings management interface; <br></li><li>  organize the transfer of new settings from the mobile application to save on the clock. <br></li></ul><br>  About everything in order, we add in a simple application that shows the time on the screen, the following options: <br><ul><li>  ‚ÄúBeat‚Äù every minute with a vibration signal; <br></li><li>  to signal the loss and restoration of a bluetooth connection with a vibration signal. <br></li></ul><br><br><h3>  Persistent storage </h3><br>  The settings will not be stored as separate parameters, but in a structure. <br>  The data, on the recommendation of the documentation, will be packaged, since the compiler aligns each field of the structure along the 32 bit border. <br>  We will also set default values ‚Äã‚Äã- to vibrate when changing the status of a bluetooth connection and to be silent when changing minutes: <br><br><pre><code class="hljs rust">#define STORAGE_KEY <span class="hljs-number"><span class="hljs-number">99</span></span> typedef <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">persist</span></span></span></span> { <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> vibe_bt; <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> vibe_min; } __attribute__((__packed__)) persist; persist settings = { .vibe_bt = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, .vibe_min = <span class="hljs-literal"><span class="hljs-literal">false</span></span> };</code> </pre> <br>  Reading and writing data will look like this: <br><br><pre> <code class="hljs objectivec"> <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> persist_read_data(STORAGE_KEY, &amp;settings, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(settings)); <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> persist_write_data(STORAGE_KEY, &amp;settings, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(settings));</code> </pre><br>  We set event handlers, subscribe and unsubscribe from events, add a read from the repository at the start of the application and write at the completion of its work: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tick_handler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">struct</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tm *tick_time, TimeUnits units_changed</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((units_changed &amp; MINUTE_UNIT) &amp;&amp; (settings.vibe_min)) { vibes_double_pulse(); }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bt_handler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> connected</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (settings.vibe_bt) { vibes_long_pulse(); }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (persist_exists(STORAGE_KEY)) { persist_read_data(STORAGE_KEY, &amp;settings, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(settings)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { persist_write_data(STORAGE_KEY, &amp;settings, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(settings)); }; <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> window_stack_push(window, animated); tick_timer_service_subscribe(MINUTE_UNIT, tick_handler); bluetooth_connection_service_subscribe(bt_handler); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deinit</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> persist_write_data(STORAGE_KEY, &amp;settings, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(settings)); tick_timer_service_unsubscribe(); bluetooth_connection_service_unsubscribe(); }</code> </pre><br>  Now, when the application is able to save the state of its settings, go to the storage organization on the phone. <br><br><h3>  Local storage and web interface </h3><br>  To display the gear icon by clicking on it, a window with settings is called up, you must enable the corresponding option in <i>appinfo.json</i> : <br><br><pre> <code class="hljs objectivec">{ <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-string"><span class="hljs-string">"capabilities"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"configurable"</span></span> ], <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> }</code> </pre><br>  Clicking on the gear generates a <i>showConfiguration</i> event, the page specified in the <i>pebble-js-app.js</i> handler is loaded into <i>WebView</i> : <br><br><pre> <code class="javascript hljs">Pebble.addEventListener(<span class="hljs-string"><span class="hljs-string">'showConfiguration'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{Pebble.openURL(<span class="hljs-string"><span class="hljs-string">"http://domain.tld/index.html"</span></span>); })</code> </pre><br>  For example, a simple interface of the two checkboxes and the ‚ÄúSubmit‚Äù button, they are not even fundamentally ‚Äúwrapped‚Äù in a form. <br>  First, we read the values ‚Äã‚Äãfrom <i>localStorage</i> and in accordance with this we tick the checkboxes, if the parameter is absent in the storage, initialize it with the default value: <br><br><pre> <code class="javascript hljs">&lt;script&gt; $().ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vibe_bt = <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(localStorage.getItem(<span class="hljs-string"><span class="hljs-string">"vibe_bt"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vibe_min = <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(localStorage.getItem(<span class="hljs-string"><span class="hljs-string">"vibe_min"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">isNaN</span></span>(vibe_bt)) { vibe_bt = <span class="hljs-number"><span class="hljs-number">1</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vibe_bt) { $(<span class="hljs-string"><span class="hljs-string">'#vibe_bt'</span></span>).prop(<span class="hljs-string"><span class="hljs-string">'checked'</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $(<span class="hljs-string"><span class="hljs-string">'#vibe_bt'</span></span>).prop(<span class="hljs-string"><span class="hljs-string">'checked'</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">isNaN</span></span>(vibe_min)) { vibe_min = <span class="hljs-number"><span class="hljs-number">0</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vibe_min) { $(<span class="hljs-string"><span class="hljs-string">'#vibe_min'</span></span>).prop(<span class="hljs-string"><span class="hljs-string">'checked'</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $(<span class="hljs-string"><span class="hljs-string">'#vibe_min'</span></span>).prop(<span class="hljs-string"><span class="hljs-string">'checked'</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); }; }); <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt;</span></span></code> </pre><br>  We follow the button press and send the user a choice to the application, storing new values ‚Äã‚Äãin the repository along the way: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">/*...*/</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> submitButton = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"b_submit"</span></span></span><span class="javascript">); submitButton.addEventListener(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"click"</span></span></span><span class="javascript">, </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ localStorage.setItem(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"vibe_bt"</span></span></span><span class="javascript">, $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_bt'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">) ? </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1</span></span></span><span class="javascript"> : </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">); localStorage.setItem(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"vibe_min"</span></span></span><span class="javascript">, $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_min'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">) ? </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1</span></span></span><span class="javascript"> : </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> result = { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">vibe_bt</span></span></span><span class="javascript">: $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_bt'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">) ? </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1</span></span></span><span class="javascript"> : </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">vibe_min</span></span></span><span class="javascript">: $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_min'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">) ? </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1</span></span></span><span class="javascript"> : </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">, }; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"pebblejs://close#"</span></span></span><span class="javascript">+</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">JSON</span></span></span><span class="javascript">.stringify(result); </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.location = location; }, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Full code pages, it was not done without <i>jquery</i> for executing code when opening the page: <br><br><div class="spoiler">  <b class="spoiler_title">index.html</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js/jquery/jquery.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Configuration window<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vibe_bt"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"checkbox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">checked</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>vibe bluetooth on/off<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vibe_min"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"checkbox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">checked</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>vibe every minute<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b_submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Save"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> $().ready(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> vibe_bt = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">parseInt</span></span></span><span class="javascript">(localStorage.getItem(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"vibe_bt"</span></span></span><span class="javascript">)); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> vibe_min = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">parseInt</span></span></span><span class="javascript">(localStorage.getItem(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"vibe_min"</span></span></span><span class="javascript">)); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">isNaN</span></span></span><span class="javascript">(vibe_bt)) { vibe_bt = </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1</span></span></span><span class="javascript">; }; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (vibe_bt) { $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_bt'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">true</span></span></span><span class="javascript">); } </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> { $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_bt'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">); }; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">isNaN</span></span></span><span class="javascript">(vibe_min)) { vibe_min = </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">; }; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (vibe_min) { $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_min'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">true</span></span></span><span class="javascript">); } </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> { $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_min'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">); }; }); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> submitButton = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"b_submit"</span></span></span><span class="javascript">); submitButton.addEventListener(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"click"</span></span></span><span class="javascript">, </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ localStorage.setItem(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"vibe_bt"</span></span></span><span class="javascript">, $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_bt'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">) ? </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1</span></span></span><span class="javascript"> : </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">); localStorage.setItem(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"vibe_min"</span></span></span><span class="javascript">, $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_min'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">) ? </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1</span></span></span><span class="javascript"> : </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> result = { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">VIBE_BT</span></span></span><span class="javascript">: $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_bt'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">) ? </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1</span></span></span><span class="javascript"> : </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">VIBE_MIN</span></span></span><span class="javascript">: $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#vibe_min'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'checked'</span></span></span><span class="javascript">) ? </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1</span></span></span><span class="javascript"> : </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">, }; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"pebblejs://close#"</span></span></span><span class="javascript">+</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">JSON</span></span></span><span class="javascript">.stringify(result); </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.location = location; }, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Closing the page window raises the <i>webviewclosed</i> event, the handler of which must be registered in <i>pebble-js-app.js</i> : <br><br><pre> <code class="javascript hljs">Pebble.addEventListener(<span class="hljs-string"><span class="hljs-string">'webviewclosed'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ Pebble.sendAppMessage(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(e.response), <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{}); })</code> </pre><br>  They came to the moment when they showed the user everything they wanted, he made his choice and the matter is small, to keep this choice in the application on the clock. <br><br><h3>  AppMessage API </h3><br>  According to the documentation, the AppMessage API implements a push-oriented exchange protocol.  Either the watch or smartphone can initiate the message transfer.  Handling is handled by callbacks. <br>  Each message is a dictionary that contains a list of key-value pairs. <br><br>  In order for both the clock and the smartphone to ‚Äúunderstand‚Äù what they exchange, it is necessary to describe the parameters of this dictionary in at least two places, mainly in the C file: <br><br><pre> <code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VIBE_BT 1 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VIBE_MIN 2</span></span></code> </pre><br>  and in <i>appinfo.json</i> : <br><pre> <code class="hljs objectivec">{ <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-string"><span class="hljs-string">"appKeys"</span></span>: { <span class="hljs-string"><span class="hljs-string">"VIBE_BT"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"VIBE_MIN"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, } <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> }</code> </pre><br>  Register the callback and initialize the AppMessage: <br><br><pre> <code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> app_message_register_inbox_received(in_received_handler); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> inbound_size = <span class="hljs-number"><span class="hljs-number">128</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> outbound_size = <span class="hljs-number"><span class="hljs-number">128</span></span>; app_message_open(inbound_size, outbound_size); <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> }</code> </pre><br>  And the final touch, we describe the callback for incoming messages: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in_received_handler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DictionaryIterator *received, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *context</span></span></span><span class="hljs-function">)</span></span> { Tuple *vibe_bt_tuple = dict_find(received, VIBE_BT); Tuple *vibe_min_tuple = dict_find(received, VIBE_MIN); settings.vibe_bt = (<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>)vibe_bt_tuple-&gt;<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>-&gt;int16; settings.vibe_min = (<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>)vibe_min_tuple-&gt;<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>-&gt;int16; }</code> </pre><br><br>  As a result, when the application is first launched / installed, the application initializes <i>persistent storage</i> , can read and save data, has its own page for setting parameters. <br><br>  <a href="https://bitbucket.org/tmnhy/config-ex/src">Full code of the project</a> on <a href="https://bitbucket.org/">Bitbucket</a> . <br><br>  <a href="http://developer.getpebble.com/guides/pebble-apps/app-structure/persistent-storage/">[1] Pebble Developers // Persisting App Data</a> <br>  <a href="http://developer.getpebble.com/guides/js-apps/pebblekit-js/js-capabilities/">[2] Pebble Developers // Extending App Capabilities // Storing Data</a> <br>  <a href="http://developer.getpebble.com/guides/js-apps/pebblekit-js/app-configuration/">[3] Pebble Developers // App Configuration</a> <br>  <a href="http://ninedof.wordpress.com/2014/04/03/pebble-sdk-2-0-tutorial-8-android-app-integration/">[4] Pebble SDK 2.0 Tutorial # 8: Android App Integration |</a>  <a href="http://ninedof.wordpress.com/2014/04/03/pebble-sdk-2-0-tutorial-8-android-app-integration/">try {work ();</a>  <a href="http://ninedof.wordpress.com/2014/04/03/pebble-sdk-2-0-tutorial-8-android-app-integration/">} finally {code ();</a>  <a href="http://ninedof.wordpress.com/2014/04/03/pebble-sdk-2-0-tutorial-8-android-app-integration/">}</a> <br>  <a href="http://ninedof.wordpress.com/2014/05/24/pebble-sdk-2-0-tutorial-9-app-configuration/">[5] Pebble SDK 2.0 Tutorial # 9: App Configuration |</a>  <a href="http://ninedof.wordpress.com/2014/05/24/pebble-sdk-2-0-tutorial-9-app-configuration/">try {work ();</a>  <a href="http://ninedof.wordpress.com/2014/05/24/pebble-sdk-2-0-tutorial-9-app-configuration/">} finally {code ();</a>  <a href="http://ninedof.wordpress.com/2014/05/24/pebble-sdk-2-0-tutorial-9-app-configuration/">}</a> </div><p>Source: <a href="https://habr.com/ru/post/245247/">https://habr.com/ru/post/245247/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245233/index.html">Processing and processing reports in Excel in PHP</a></li>
<li><a href="../245237/index.html">Sergey Chernyshev: ‚ÄúEvery year the Web only gets slower‚Äù</a></li>
<li><a href="../245239/index.html">Functional CoffeeScript programming with the f_context library</a></li>
<li><a href="../245241/index.html">In search of the Holy Grail of business analysis</a></li>
<li><a href="../245243/index.html">Component Dropbox source for MODX Revolution</a></li>
<li><a href="../245249/index.html">Pyramid of Project Needs or ProjectING</a></li>
<li><a href="../245251/index.html">Hi, I'm a designer, and I want everything to look the same everywhere.</a></li>
<li><a href="../245253/index.html">What prevents web studios from scaling up their business, and how internal projects can help with this?</a></li>
<li><a href="../245255/index.html">Bypassing github.com blocking in Windows using DNSCrypt</a></li>
<li><a href="../245257/index.html">The greenest technopark in the world, or why start an IT business in India?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>