<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Some pitfalls of Android development</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, our team completed the development of an application for Android. In the development process and then support, we encountered some technical...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Some pitfalls of Android development</h1><div class="post__text post__text-html js-mediator-article">  Recently, our team completed the development of an application for Android.  In the development process and then support, we encountered some technical problems.  Some of them are our bugs, which we could have avoided, the other part are quite unobvious features of Android, which are either poorly described in the documentation or not described at all. <br><br>  In this article I would like to consider a few real bugs that have arisen among our users and talk about ways to solve them. <br><br>  The article does not pretend to a detailed analysis of potential problems, it is just a story from the life of one real Android application. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><h5>  RTFM ( <a href="http://en.wikipedia.org/wiki/RTFM">http://en.wikipedia.org/wiki/RTFM</a> ) </h5><br><br>  Since the development of Android should be borne in mind that your application can work on a huge number of different devices, then you need to think about the problems of their compatibility. <br><br>  For example, one of the errors that occurred with our users: <br><br><pre><code class="java hljs">java.lang.NoClassDefFoundError: android.util.Patterns</code> </pre> <br><br>  And the reason is simple, according to the documentation, the <code>android.util.Patterns</code> class is available starting from API version 8 (Android 2.2.x), and the user had version 2.1.  We decided this of course by wrapping this code in <code>try/catch</code> . <br><br>  Here is another similar problem caused by inattentive reading of documentation: <br><br><pre> <code class="java hljs">android.os.NetworkOnMainThreadException at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:<span class="hljs-number"><span class="hljs-number">1077</span></span>) at java.net.InetAddress.lookupHostByName(InetAddress.java:<span class="hljs-number"><span class="hljs-number">477</span></span>) at java.net.InetAddress.getAllByNameImpl(InetAddress.java:<span class="hljs-number"><span class="hljs-number">277</span></span>) at java.net.InetAddress.getAllByName(InetAddress.java:<span class="hljs-number"><span class="hljs-number">249</span></span>)</code> </pre> <br><br>  The fact is that strict mode ( <a href="http://developer.android.com/reference/android/os/StrictMode.html">http://developer.android.com/reference/android/os/StrictMode.html</a> ) has been enabled by default in Android since version 3.0.  This means that your application cannot access the network directly from the main UI flow, as this may take some time and the main flow is blocked and does not respond to other events.  We tried to avoid such behavior, but in one of the places there was still a simple network call.  This problem was solved by the fact that we moved this code to another thread. <br><br><h5>  Rotate the device - what could be easier and more familiar to the user? </h5><br><br>  It would seem that for mobile devices, changing the screen orientation is a thing so often used and familiar that it should be reflected in the API.  Those.  This situation should be handled very simply.  But no.  There are many nuances. <br><br>  Suppose we need to make an application that loads a list of something and displays it on the screen.  Those.  when the <code>Activity</code> starts (in the <code>onCreate()</code> method), we start the stream (not to block the UI stream), which will load the data.  This thread runs for a while, so we will display the boot process in the <code>ProgressDialog</code> .  Everything is simple and works great. <br><br>  But, after loading, the user turned the device and here we find out that <code>ProgressDialog</code> appeared again and we are loading our data again.  But nothing has changed?  It's just easier for a person to look at this list by turning the device. <br><br>  And the thing is that the <code>onCreate()</code> method is called not only when creating an <code>Activity</code> , but also when you rotate the screen!  But we do not want to make the user wait for the download again.  All we need is to show the already loaded data again. <br><br>  If we look on the Internet, we will find many references to the description of this problem and also a huge number of examples of how to solve this problem.  And worst of all, most of these links offer the wrong solution.  Here is an example of this - <a href="http://codesex.org/articles/33-android-rotate">http://codesex.org/articles/33-android-rotate</a> <br><br>  Do not handle screen rotation with <code>onConfigurationChanged()</code> !  This is not true!  Official documentation clearly states that ‚Äú <i>using this attribute should not be avoided.</i>  ‚Äú <a href="http://developer.android.com/guide/topics/manifest/activity-element.html">Http://developer.android.com/guide/topics/manifest/activity-element.html#config</a> <br><br>  But the correct approach is described here - <a href="http://developer.android.com/guide/topics/resources/runtime-changes.html">http://developer.android.com/guide/topics/resources/runtime-changes.html</a> And as practice shows, it is not easy to implement. <br><br>  The idea is that before turning the screen, Android will call the <code>onRetainNonConfigurationInstance()</code> method of your <code>Activity</code> .  And you can return data (for example, a list of loaded objects) from this method, which will be saved between 2 calls of the <code>onCreate()</code> method of your <code>Activity</code> .  Then when you call <code>onCreate()</code> you can call <code>getLastNonConfigurationInstance()</code> which will return the saved data to you.  Those.  when creating an <code>Activity</code> you call <code>getLastNonConfigurationInstance()</code> and if it returned data to you, then this data has already been loaded and you only need to display it.  If you did not return the data, then start the download. <br><br>  But in practice, the situation is as follows.  We can have 2 options when the user turns the device.  The first option is when data is being loaded (our stream is working which loads data and <code>ProgressDialog</code> displayed) or the data has already been loaded and we saved it in the list for display.  It turns out that in the first case, when turning, we must save the link to the working thread, and in the second case, the link to the list that has already been downloaded.  We do that. <br><br>  But this complicates our code and does not seem to me simple and intuitive.  Moreover, when the screen orientation changes and we save the data load stream, we are then forced to restore <code>ProgressDialog</code> again with <code>onCreate()</code> !  And if we add here that in our application the user can download data from different places and we have more than one data download stream, but several ‚Äî the amount of code that serves a simple screen rotation becomes huge. <br><br>  Honestly, I do not understand why it was made so difficult. <br><br><h5>  A little more detail about threads or using AsyncTask. </h5><br><br>  Let's take a look at loading data in another stream in a little more detail, since unexpected ‚Äúsurprises‚Äù also awaited us. <br><br>  A bit of theory: to facilitate the creation and operation in a stream other than the main UI stream, a special class was made - AsyncTask ( <a href="http://developer.android.com/reference/android/os/AsyncTask.html">http://developer.android.com/reference/android/os/AsyncTask.html</a> ) <br><br>  Its essence is that it already has ready methods <code>onPreExecute()</code> and <code>onPostExecute(Result)</code> , which are executed in the main UI thread and which serve to display something and there is a method doInBackground (Params ...) within which the main work and it starts in a separate thread automatically.  Here is an example code like this: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyTask</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AsyncTask</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ProgressDialog spinner; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onPreExecute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     ProgressDialog //       //     UI  spinner = new ProgressDialog(MyActivity.this); spinner.setMessage(" ..."); spinner.show(); } @Override protected Void doInBackground(Void... text) { //         //       } @Override protected void onPostExecute(Void result) { //  .  ProgressDialog. //     UI  spinner.dismiss(); } }</span></span></code> </pre><br><br>  Everything is simple and beautiful. <br><br>  But now - a little practice.  Here is the error from the real user: <br><pre> <code class="java hljs">android.view.WindowManager$BadTokenException: Unable to add window -- token android.os.BinderProxy@<span class="hljs-number"><span class="hljs-number">40515</span></span>bd0 is not valid; is your activity running? at android.view.ViewRoot.setView(ViewRoot.java:<span class="hljs-number"><span class="hljs-number">534</span></span>) at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:<span class="hljs-number"><span class="hljs-number">177</span></span>) at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:<span class="hljs-number"><span class="hljs-number">91</span></span>) at android.view.Window$LocalWindowManager.addView(Window.java:<span class="hljs-number"><span class="hljs-number">424</span></span>) at android.app.Dialog.show(Dialog.java:<span class="hljs-number"><span class="hljs-number">241</span></span>) at ru.reminded.android.social.SocialDataLoader.onPreExecute(SocialDataLoader.java:<span class="hljs-number"><span class="hljs-number">106</span></span>) at android.os.AsyncTask.execute(AsyncTask.java:<span class="hljs-number"><span class="hljs-number">391</span></span>) at ru.reminded.android.util.SocialAdapterUtils.loadAdapterData(SocialAdapterUtils.java:<span class="hljs-number"><span class="hljs-number">52</span></span>) at ru.reminded.android.util.SocialAdapterUtils.access$<span class="hljs-number"><span class="hljs-number">0</span></span>(SocialAdapterUtils.java:<span class="hljs-number"><span class="hljs-number">50</span></span>) at ru.reminded.android.util.SocialAdapterUtils$<span class="hljs-number"><span class="hljs-number">1</span></span>.onComplete(SocialAdapterUtils.java:<span class="hljs-number"><span class="hljs-number">41</span></span>)</code> </pre><br><br>  And this error means that when we call <code>spinner.show()</code> in the <code>onPreExecute()</code> method, this <code>ProgressDialog</code> created with reference to <code>MyActivity</code> already inactive and is not on the screen!  Well, I still understand how this can be when calling <code>onPostExecute()</code> .  Those.  for example, while we were loading data, the user clicked Back and our <code>ProgressDialog</code> left the screen.  But how can this be immediately when a load is called, when this code starts right after the activity is closed - this is unclear to me. <br><br>  But in any case, we have to handle such situations, so we decided to do this with a shell of the spinner.show <code>spinner.show()</code> and <code>spinner.dismiss()</code> methods in <code>try/catch</code> .  The solution is certainly not very beautiful, but in our case it is quite functional. <br><br>  By the way, the same code exists in the Facebook SDK for Android, for example, which was developed by other experienced developers.  And there, too, we had situations when the application crashed while closing <code>ProgressDialog</code> .  We had to add processing to their code.  So this problem is not only in us. <br><br>  Add here another problem that was described earlier.  That when turning the device, it is necessary to recreate <code>ProgressDialog</code> if there was a turn during data loading.  This will also add auxiliary code here. <br><br>  And it is worth remembering that the <code>doInBackground()</code> method is executed in a separate thread and therefore if an error occurred while loading data, then you cannot issue an Alert directly from there, since this is not a UI stream.  It is necessary to save the error, and then after exiting the load stream in the <code>onPostExecute(Void result)</code> method, you can already show something. <br><br>  Those.  again a lot of auxiliary code and not everything is so simple ... <br><br><h5>  Alarmmanager </h5><br><br>  And then there are moments that are not described in the documentation at all.  For example, in our application we use AlarmManager ( <a href="http://developer.android.com/reference/android/app/AlarmManager.html">http://developer.android.com/reference/android/app/AlarmManager.html</a> ) which helps us to issue messages to the user after some time when our application itself is already closed. <br><br>  This AlarmManager is a very useful thing, but the problem is that sometimes it ‚Äúloses‚Äù the notifications created in it!  We spent a lot of time to understand how and why this happens, rummaged through all the documentation and found nothing.  Quite by chance we ‚Äúcame across‚Äù this discussion - <a href="http://stackoverflow.com/questions/9101818/how-to-create-a-persistent-alarmmanager">http://stackoverflow.com/questions/9101818/how-to-create-a-persistent-alarmmanager</a> . <br><br>  It turns out that if the application crashes, or the user himself kills the application through the task manager (which is possible and completely normal), then ALL notifications for this application in the AlarmManager REMOVE!  What a surprise!  Especially, I liked one of the comments there: <i>‚ÄúRe Alarm canceled: Thanks for the clarification.</i>  <i>I‚Äôve asked you to see what the team was doing.</i>  <i>Is it documented anywhere?</i>  " <br><br>  So now when the application starts, we are forced to re-create customized notifications, since even there is no API in the AlarmManager to check if there are such notifications or not. <br><br><h5>  Sometimes it happens... </h5><br><br>  Here are some more errors that we have registered with our users.  In our application, we use OAuth authentication for various social networks and therefore have to launch a regular browser on Android (through which OAuth should work).  At the same time, he periodically ‚Äúfalls‚Äù <br><br><pre> <code class="java hljs">android.util.AndroidRuntimeException: { what=<span class="hljs-number"><span class="hljs-number">1004</span></span> when=-<span class="hljs-number"><span class="hljs-number">14</span></span>ms arg2=<span class="hljs-number"><span class="hljs-number">1</span></span> } This message is already in use. at android.os.MessageQueue.enqueueMessage(MessageQueue.java:<span class="hljs-number"><span class="hljs-number">187</span></span>) at android.os.Handler.sendMessageAtTime(Handler.java:<span class="hljs-number"><span class="hljs-number">457</span></span>) at android.os.Handler.sendMessageDelayed(Handler.java:<span class="hljs-number"><span class="hljs-number">430</span></span>) at android.os.Handler.sendMessage(Handler.java:<span class="hljs-number"><span class="hljs-number">367</span></span>) at android.os.Message.sendToTarget(Message.java:<span class="hljs-number"><span class="hljs-number">349</span></span>) at android.webkit.WebView$<span class="hljs-number"><span class="hljs-number">5</span></span>.onClick(WebView.java:<span class="hljs-number"><span class="hljs-number">1250</span></span>) at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:<span class="hljs-number"><span class="hljs-number">172</span></span>) at android.os.Handler.dispatchMessage(Handler.java:<span class="hljs-number"><span class="hljs-number">99</span></span>) at android.os.Looper.loop(Looper.java:<span class="hljs-number"><span class="hljs-number">130</span></span>) at android.app.ActivityThread.main(ActivityThread.java:<span class="hljs-number"><span class="hljs-number">3703</span></span>) at java.lang.reflect.Method.invokeNative(Native Method) at java.lang.reflect.Method.invoke(Method.java:<span class="hljs-number"><span class="hljs-number">507</span></span>) at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:<span class="hljs-number"><span class="hljs-number">841</span></span>) at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:<span class="hljs-number"><span class="hljs-number">599</span></span>) at dalvik.system.NativeStart.main(Native Method)</code> </pre><br><br>  One more: <br><br><pre> <code class="java hljs">java.lang.NullPointerException at android.os.Message.sendToTarget(Message.java:<span class="hljs-number"><span class="hljs-number">348</span></span>) at android.webkit.WebView$<span class="hljs-number"><span class="hljs-number">4</span></span>.onClick(WebView.java:<span class="hljs-number"><span class="hljs-number">1060</span></span>) at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:<span class="hljs-number"><span class="hljs-number">158</span></span>) at android.os.Handler.dispatchMessage(Handler.java:<span class="hljs-number"><span class="hljs-number">99</span></span>) at android.os.Looper.loop(Looper.java:<span class="hljs-number"><span class="hljs-number">123</span></span>) at android.app.ActivityThread.main(ActivityThread.java:<span class="hljs-number"><span class="hljs-number">4627</span></span>) at java.lang.reflect.Method.invokeNative(Native Method) at java.lang.reflect.Method.invoke(Method.java:<span class="hljs-number"><span class="hljs-number">521</span></span>) at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:<span class="hljs-number"><span class="hljs-number">860</span></span>) at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:<span class="hljs-number"><span class="hljs-number">618</span></span>) at dalvik.system.NativeStart.main(Native Method)</code> </pre><br><br>  And further: <br><br><pre> <code class="java hljs">java.lang.IndexOutOfBoundsException: setSpan (-<span class="hljs-number"><span class="hljs-number">1</span></span> ... -<span class="hljs-number"><span class="hljs-number">1</span></span>) starts before <span class="hljs-number"><span class="hljs-number">0</span></span> at android.text.SpannableStringBuilder.checkRange(SpannableStringBuilder.java:<span class="hljs-number"><span class="hljs-number">949</span></span>) at android.text.SpannableStringBuilder.setSpan(SpannableStringBuilder.java:<span class="hljs-number"><span class="hljs-number">522</span></span>) at android.text.SpannableStringBuilder.setSpan(SpannableStringBuilder.java:<span class="hljs-number"><span class="hljs-number">514</span></span>) at android.text.Selection.setSelection(Selection.java:<span class="hljs-number"><span class="hljs-number">74</span></span>) at android.text.Selection.setSelection(Selection.java:<span class="hljs-number"><span class="hljs-number">85</span></span>) at android.widget.TextView.performLongClick(TextView.java:<span class="hljs-number"><span class="hljs-number">8621</span></span>) at android.webkit.WebTextView.performLongClick(WebTextView.java:<span class="hljs-number"><span class="hljs-number">617</span></span>) at android.webkit.WebView.performLongClick(WebView.java:<span class="hljs-number"><span class="hljs-number">4471</span></span>) at android.webkit.WebView$PrivateHandler.handleMessage(WebView.java:<span class="hljs-number"><span class="hljs-number">8285</span></span>) at android.os.Handler.dispatchMessage(Handler.java:<span class="hljs-number"><span class="hljs-number">99</span></span>) at android.os.Looper.loop(Looper.java:<span class="hljs-number"><span class="hljs-number">150</span></span>) at android.app.ActivityThread.main(ActivityThread.java:<span class="hljs-number"><span class="hljs-number">4389</span></span>) at java.lang.reflect.Method.invokeNative(Native Method) at java.lang.reflect.Method.invoke(Method.java:<span class="hljs-number"><span class="hljs-number">507</span></span>) at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:<span class="hljs-number"><span class="hljs-number">849</span></span>) at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:<span class="hljs-number"><span class="hljs-number">607</span></span>) at dalvik.system.NativeStart.main(Native Method)</code> </pre><br><br><h5>  Conclusion </h5><br><br>  Despite all of the above, I liked the development of Android.  Basically, the API is quite thoughtful and convenient. <br><br>  That's just everywhere it is worth using <code>try/catch</code> .  Even where it is not at all obvious. <br><br>  And more ... Be sure, no - not so, but like this - MANDATORY collect information about errors from users.  We use the free ACRA library ( <a href="http://code.google.com/p/acra/">http://code.google.com/p/acra/</a> ) for this.  Thank you very much to its developers! </div><p>Source: <a href="https://habr.com/ru/post/146632/">https://habr.com/ru/post/146632/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146623/index.html">Express audit of hosting sites</a></li>
<li><a href="../146627/index.html">Upgrade or second wind macbook MB467 (Late 2008)</a></li>
<li><a href="../146629/index.html">Remember everything</a></li>
<li><a href="../146630/index.html">5 useful jQuery API methods you might not know about</a></li>
<li><a href="../146631/index.html">About feedback</a></li>
<li><a href="../146633/index.html">One ring</a></li>
<li><a href="../146634/index.html">Permissions on files in Win7: changing user in current session</a></li>
<li><a href="../146637/index.html">Which online maps (not satellite imagery) do you regularly use?</a></li>
<li><a href="../146638/index.html">HTML5 in HabraStorage</a></li>
<li><a href="../146639/index.html">Scholarship at Brainwashing Ruby on Rails and a chance to work on the ocean</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>