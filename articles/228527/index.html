<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How does international roaming work?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, I will talk about how the international roaming service works and how the call and SMS travels while in roaming. Abbreviations can be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How does international roaming work?</h1><div class="post__text post__text-html js-mediator-article">  In this article, I will talk about how the international roaming service works and how the call and SMS travels while in roaming.  Abbreviations can be read in <a href="http://habrahabr.ru/post/82757/">this</a> article. <br><br><h4>  About the service </h4><br>  <b>Roaming</b> is a service that allows subscribers to make calls, use data transfer service, use other services provided by the operator, being in the networks of other operators, including foreign ones, with which the subscriber operator has a roaming agreement.  In this case, the phone number of the subscriber remains unchanged. <br>  <i>National roaming</i> r - is the ability to use the services of a "foreign" network within the same country. <br>  <i>International roaming</i> is an opportunity to use the services of a mobile network of a foreign operator with which there is an agreement.  The article will describe this type of roaming. <br><br><h5>  Authorization </h5><br>  The first action that occurs when trying to register on the network of a foreign partner is to check the subscriber for ‚Äúvalidity‚Äù.  This is done by the VLR / MSC, in which the MS is located.  After the guest VLR / MSC receives the ‚ÄúLocation Update‚Äù command from MS, knowing the subscriber‚Äôs IMSI, sends the message ‚ÄúSend Authentication Info‚Äù to the HLR via MAP;  he in turn checks that the MS and the received IMSI are valid.  If the verification is successful and the subscriber is ‚Äúvalid‚Äù, the HLR sends the IMSI to the AUC.  AUC generates a triplet (SRES, RAND, Kc) and sends it to the HLR, then the HLR sends this data to the VLR / MSC that serves the MS.  After the VLR / MSC has received this data, the VLR / MSC sends the RAND to the MS.  Upon receiving the RAND request, MS substitutes the received RAND and Ki (recorded on the SIM card) and calculates SRES, which is sent to the VLR / MSC.  If the SRES received from the MS is the same as the SRES received from the AUC, then the MS is considered authorized. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/f24/d6d/be1/f24d6dbe1c39a21ae1d121fee5e7e6ca.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Update Location </h5><br>  After VLC / MSC has authorized MS, it sends an Update Location message to the home HLR.  This message is sent so that the HRL knows which VLR / MSC is in range of the subscriber.  The message ‚ÄúUpdate Location‚Äù contains the subscriber's IMSI and the GT VLR / MSC.  The HLR, after receiving the data, will check if the roaming service is connected.  If the subscriber does not have a ban, the HLR will delete the subscriber profile from the VLR / MSC where the subscriber was registered prior to this procedure, by sending the message ‚ÄúCancel Location‚Äù.  The HLR also sends the subscriber profile to the VLC / MSC requesting this information using the ‚ÄúInsert Subscriber Data‚Äù message.  After the VLR / MSC receives this information, the ‚ÄúUpdate location‚Äù will be completed, and the HLR will keep the VLR / MSC address that requested the Update location in the subscriber profile.  At this stage, the ‚ÄúUpdate Location‚Äù is finished.  When a call or SMS arrives, the HLR knows which VLR / MSC to send it to. <br>  After these procedures, the subscriber is considered to be registered in the network, i.e.  he can make and receive calls, SMS, use other available services.  Let us consider in more detail the procedures of incoming and outgoing call. <br><img src="https://habrastorage.org/getpro/habr/post_images/2f6/a4f/e34/2f6a4fe34c2a346b1d9ec69ac577ed9c.png"><br><br><h5>  Incoming call </h5><br>  From subscriber A, a call is received to subscriber B who is in roaming.  Subscriber A dials the number of subscriber A (MSISDN).  If it is a call from the city network, the ISUP IAM message will go to the GMSC, then the GMSC will determine the HLR address based on the received MSISDN and send the message ‚ÄúsendRoutingInfo‚Äù using the MAP protocol to the HLR.  The HLR, having received MSISND, determines the IMSI of subscriber B, as well as which VLR / MSC the subscriber is in.  The HLR then sends the ProvideRoamingNumber message via the MAP protocol to the VLR / MSC which contains the IMSI of the subscriber B. The ProvideRoamingNumber message is used to request a temporary MSRN number from the pool of numbers registered on the VLR / MSC.  MSRN has the format (GT) of the country in which the subscriber‚Äôs VLR / MSC is located.  MSRN is issued at the time of the call, then again falls into the pool of MSRN numbers. <br>  After the MSRN has been allocated, it is sent to the HLR;  The HLR in turn sends this MSRN to the GMSC.  The GMSC routes this MSRN call to the VLR / MSC serving subscriber B by sending an ISUP IAM message to the dedicated MSRN. <br><img src="https://habrastorage.org/getpro/habr/post_images/be1/586/7eb/be15867eb2fdf9397f22c8bb6a965d2f.png"><br>  The article will not consider the paging and call setup procedure by ISUP. <br><br><h5>  Outgoing call </h5><br>  Subscriber A, while roaming, calls Subscriber B. For an outgoing call, the Authorization and Update Location procedures described above take place first.  First of all, the VLR / MSC in which the subscriber A is registered sends the message ‚ÄúsendRoutingInfo‚Äù (which contains the MSISDN of the caller B) to the GMSC.  The GMSC, in turn, sends an IAM to the MSISDN number via ISUP.  If MSISND belongs to the wired network, then the call goes to the serving PBX number.  If the MSISDN belongs to the cellular operator, then the IAM message goes to the GMSC of subscriber B. Then the GMSC sends the ‚ÄúsendRoutingInfo‚Äù request to the HLR to find out the address of the VLR / MSC serving the subscriber B and its IMSI.  After the HLR has provided this information, the GMSC sends the IAM to this VLR / MSC. <br><br><h5>  Outgoing sms </h5><br>  Subscriber A, while roaming, sends an SMS to subscriber B. After the VLR / MSC has received a message from the subscriber, sends it via the SCCP provider to the SMSC of the home network via the GMSC.  The SMSC sends the ‚ÄúsendRoutingInfoForSM‚Äù message to the subscriber B's HLR, after which the HLR responds with the VLR / MSC address (in which the subscriber B is located) and the IMSI to the SMS center.  The SMSC then sends the ‚Äúforward SM‚Äù message to the VLR / MSC of subscriber B. <br><br><h5>  Incoming SMS </h5><br>  Subscriber A sends an SMS to subscriber B who is roaming.  The principle is similar to that described in the outgoing message.  From the SMSC of subscriber A via the SCCP provider, the message ‚ÄúsendRoutingInfoForSM‚Äù is sent to the GMSC, and then to the VLR / MSC, in the zone of which subscriber B. is located. After that, the VLR / MSC responds to the IMSI and its address.  After this procedure, a forwardSM message is sent from the SMSC of subscriber A.  The VLR / MSC, upon receiving this message, attempts to deliver the message to the subscriber.  If the message is delivered, the VLR / MSC replies "forwardSM END". <br><br>  <b>Home routing</b> <br>  On ‚Äúhomerouting‚Äù, the HLR issues a fake IMSI and a VLR / MSC address.  SMS is sent to the virtual MSC, and then the virtual MSC sends the SMS to the real MSC. </div><p>Source: <a href="https://habr.com/ru/post/228527/">https://habr.com/ru/post/228527/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../228515/index.html">Technology World Cup 2014</a></li>
<li><a href="../228519/index.html">Case: Clouds as a Tool for Optimizing IT Infrastructure</a></li>
<li><a href="../228521/index.html">A new version of the distribution has been released to create a pfSense 2.1.4 firewall.</a></li>
<li><a href="../228523/index.html">How to impose a theme for WordPress</a></li>
<li><a href="../228525/index.html">Structure from Motion - classic implementation</a></li>
<li><a href="../228529/index.html">How does the CROC engineering service work - and what happens if, at 3 am, a cluster breaks somewhere far away</a></li>
<li><a href="../228531/index.html">DMA in general and in particular</a></li>
<li><a href="../228533/index.html">GameDev for quizzes - I brought you a bunch of useless facts and a bit of veterinary</a></li>
<li><a href="../228535/index.html">Month of use of the IBM cloud server: free opportunity to get acquainted with the Softlayer platform</a></li>
<li><a href="../228537/index.html">New AppStore section, the dependence of the number of installations on the weight of the application and the report on the growth of Google Play over the past year - the main mobile news for the week</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>