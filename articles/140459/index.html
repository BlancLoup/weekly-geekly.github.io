<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Android application architecture. Part I - the origins</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article we will look at the architecture of Android applications. 

 Frankly, I find the official Google article on this topic not very useful...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Android application architecture. Part I - the origins</h1><div class="post__text post__text-html js-mediator-article">  In this article we will look at the architecture of Android applications. <br><br>  Frankly, I find the official Google <a href="http://developer.android.com/guide/topics/fundamentals.html">article</a> on this topic not very useful.  Responding in detail to the question ‚Äúhow‚Äù, she doesn‚Äôt explain at all what and why.  So, here is my version, and I hope it will bring some clarity.  Yes, by the way, I fully approve of reading Google articles, because they contain useful information, which I do not intend to repeat. <br><a name="habracut"></a><br><h4>  Android OS architecture - a bit of history </h4><br>  As is often the case in IT, many things cannot be explained in isolation from the history of the emergence of specific software.  That is why we must turn to the origins of the Android OS. <br><br>  The development of the Android OS was launched in 2003 by the young company Android Inc.  In 2005, this company was bought by Google.  I believe that the main features of the Android architecture were identified during this period.  This is not only the credit of Android Inc;  Google‚Äôs architectural concepts and financial resources have had a decisive influence on Android‚Äôs architecture.  Next I will give a few examples. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you remember, 2003-2005 was marked by increased attention to AJAX applications.  I think this had a fundamental impact on the architecture of Android: in many aspects it is closer to the architecture of a typical AJAX application than to the desktop GUI application written in Java, C #, C ++, VB, and so on. <br><br>  I do not know why it happened.  My guess was someone from Google invented at a time when rich Internet applications (Rich Internet Applications, RIA) in the spirit of Google Docs or Gmail were considered to be the solution to all problems.  In my opinion, this idea can not be called neither good nor bad.  Just remember that Android applications are very different from desktop ones. <br><br>  The influence of the architectural philosophy of Eclipse is noticeable in choosing the principle of GUI implementation, which is more like SWT than Swing. <br><br>  In the standards for the design of the Android code there is a ‚ÄúHungarian notation‚Äù, born within the walls of MS.  It can be assumed that the person who wrote these standards was previously engaged in the development under Windows. <br><br><h5>  Android architectural levels </h5><br>  The Android operating system has three very different and highly separated levels: <br><br><ol><li>  It is based on a modified and trimmed version of Linux, as I mentioned in one of my previous <a href="http://wp.me/p1gzYo-1u">articles</a> . </li><li>  Above the Linux level is the application infrastructure layer, which contains <a href="http://en.wikipedia.org/wiki/Dalvik_virtual_machine">the Dalvik virtual machine</a> , a web browser, a <a href="http://www.sqlite.org/">SQLite</a> database, some infrastructure crutches, and a Java API. </li><li>  And finally, the level of Google-written Android applications.  Generally speaking, they are an extension of the infrastructure level, since the developer can use these applications or parts of them as building blocks for their own development. </li></ol><br>  Consider these layers one by one and in more detail. <br><br><h4>  Linux level </h4><br>  Imagine that you are an architect in a young company.  You must develop an OS for a new type of device.  What are you going to do? <br><br>  Roughly speaking, you have two ways: to implement your own ideas, starting from scratch, or use the existing OS and adapt it to your devices. <br><br>  Implementing from scratch always sounds exciting to programmers.  At these moments, we all believe that this time we will do everything better than others do, and even better than we ourselves did before. <br><br>  However, this is not always practical.  For example, the use of the Linux kernel has significantly reduced the cost of development (perhaps somewhere already excessively large).  Agree, if someone decides to create something resembling the Linux kernel in its current state, it will need several million dollars. <br><br>  If you are in charge of Android Inc, then by definition you cannot have that much money.  If you run Google, then you will find that kind of money, but you will most likely think twice before spending it on creating your own OS.  You will also spend several years before you reach the current state of Linux;  several years of delay may be too late to enter the market. <br><br>  In this situation, Apple decided to build a Mac OS based on Free BSD.  Android Inc decided to use Linux as the basis for Android.  Both BSD and Linux sources are freely available and provide a good basis for any development, be it Apple or Google. <br><br>  But at that time it was impossible to launch standard Linux on a mobile device (now this is not the case).  The devices had too little RAM and non-volatile memory.  The processors were significantly slower compared to the processors of computers where Linux is commonly used.  As a result, Android developers decided to minimize Linux system requirements. <br><br>  If you look at Linux at a high level, then this is a combination of the kernel (which you can't do without) and many other optional parts.  You can even run one core, without anything else.  So, Google is forced in any case to use the Linux kernel as part of the Android OS.  In addition, optional parts were considered and the most necessary were selected.  For example, the IPTables network firewall and the Ash shell were added.  It is curious that it was Ash who was added, not Bash, despite the fact that the latter is an order of magnitude more powerful;  this decision was probably based on the fact that Ash is less resource intensive. <br><br>  Android developers have modified the Linux kernel, adding support for hardware used in mobile devices and, more often, inaccessible on computers. <br><br>  The choice of Linux as the basis had a huge impact on all aspects of the Android OS.  Building Android, in fact, is a variation of the Linux build process.  The Android code is under the control of git (a tool developed to manage Linux code).  And so on. <br><br>  Let it all be interesting, but you will most likely never touch all these specific moments until your goal is to develop Android applications.  The only exception may be a review of the file system using the ash commands.  The main thing that you should know when developing applications for Android is the level of application infrastructure. <br><br>  You may ask how to be if you need to develop a native Android application?  Google strongly discourages doing this.  Technically, of course, this is possible, but in the future you will not be able to distribute this application in the normal way.  So think twice before starting native Android development, unless of course you are working on the Android Open Source Project (AOSP), i.e.  Android OS itself. <br><br><h4>  Application Infrastructure Level </h4><br>  Despite some similarities between Apple iOS and Android OS, there are significant differences between the architectural solutions on the infrastructure level of both OSs. <br><br>  Apple decided to use Objective-C as a programming language and iOS application runtime.  Objective-C looks like a more or less natural choice for an OS based on Free BSD.  You can think of Objective-C as regular C ++ with a custom preprocessor that adds some specific linguistic constructs.  Why it is impossible to use standard C ++ on which Free BSD is written?  I think the reason is that Apple is trying to do everything in its ‚ÄúApple‚Äù style. <br><br>  The basic idea is that iOS applications are written more or less in the same language as the OS behind them. <br><br>  Android applications are very different in that sense.  They are written in Java, and this is a completely different technology than C ++ (although the syntax is inherited from C ++). <br><br>  Why is this so?  Why, for example, Android applications are not written in C ++?  From Google, I did not find any explanation, so I can only share my own thoughts. <br><br>  I think the main reason is that the same application needs to work on different hardware.  This problem only occurs for the Android OS;  The guys from Apple have no such problem.  iOS only works on its own production equipment, and Apple fully controls the entire process.  For Android, the opposite is true: Google does not control hardware manufacturers.  For example, the Android OS runs on x86, ARM and Atom processors (in the comments, x86 includes Atom, and Android runs on x86, ARM, PPC and MIPS - <i>translator's note</i> ).  At the binary level, these architectures are incompatible. <br><br>  If the architects of the Android OS chose the same path as the architects from Apple, Android developers would have to distribute several versions of the same application at the same time.  This would be a serious problem that could lead to the collapse of the entire Android project. <br><br>  In order for the same application to work on different hardware, Google used container-based architecture.  In this architecture, the binary code is executed by a software container and is isolated from the details of the specific hardware.  Examples are familiar to all - Java and C #.  In both languages, the binary code does not depend on the specific hardware and is executed by the virtual machine. <br><br>  Of course, there is another way to achieve hardware independence at the binary code level.  As one option, you can use a hardware emulator, also known as <a href="http://en.wikipedia.org/wiki/QEMU">QEMU</a> .  It allows you to emulate, for example, a device with an ARM processor on the x86 platform and so on.  Google could use C ++ as a language for developing applications inside emulators.  Indeed, Google uses this approach in its Android emulators, which are based on QEMU. <br><br>  It is very good that they did not follow this path, because then someone would have to run the OS on an emulator, which requires much more resources, and, as a result, the speed of work would decrease.  For best performance, emulation was left only where it could not be avoided, in our case in Android applications. <br><br>  Be that as it may, Google has decided to use Java as the main language for developing applications and their environment. <br><br>  I think it was a critical architectural solution that put Android apart from the rest of the Linux-based mobile OSs that are currently available.  As far as I know, none of them have binary compatibility at the application level.  Take for example <a href="http://en.wikipedia.org/wiki/MeeGo_%2528operating_system%2529">MeeGo</a> .  It uses C ++ and the <a href="http://en.wikipedia.org/wiki/Qt_%2528framework%2529">Qt framework</a> ;  Despite the fact that Qt is cross-platform, the need to do different builds for different platforms does not disappear. <br><br>  Choosing Java, you had to decide which virtual machine (JVM) to use.  Due to limited resources, using standard JVM was difficult.  The only possible choice was to use a <a href="http://en.wikipedia.org/wiki/Java_ME">Java ME</a> JVM developed for mobile devices.  However, the happiness of Google would be incomplete without developing its own virtual machine, and <a href="http://en.wikipedia.org/wiki/Dalvik_virtual_machine">Dalvik VM</a> appeared. <br><br>  Dalvik VM differs from other Java virtual machines in the following: <br><br><ul><li>  It uses a special DEX format for storing binary codes, as opposed to the JAR and Pack200 formats, which are the standard for other Java virtual machines.  Google has said that the DEX binaries are smaller than the JAR.  I think they might as well have used Pack200, but they decided to go their own way. </li><li>  Dalvik VM is optimized to run multiple processes simultaneously. </li><li>  Dalvik VM uses a register-based architecture against stack architecture in other JVMs, which leads to an increase in execution speed and a decrease in the size of binaries. </li><li>  It uses its own set of instructions (rather than the standard JVM bytecode). </li><li>  It is possible to launch (if necessary) several independent Android applications in one process. </li><li>  Running an application can span multiple Dalvik VM processes in a ‚Äúnatural way‚Äù (later we will discuss what this means).  To support this, added: <br><ul><li>  A special object serialization mechanism based on the Parcel and Parcelable classes.  Functionally, they pursue the same goals as Java Serializable, but as a result, the data is smaller and potentially more tolerant of versioning class changes. </li><li>  A special way to make inter-process calls (inter process calls, IPC), based on Android Interface Definition Language (AIDL). </li></ul></li><li>  Prior to Android 2.2, Dalvik VM did not support JIT compilation, which was a serious performance hit.  Since version 2.2, the speed of execution of frequently used applications <a href="http://www.androidpolice.com/2010/05/11/exclusive-androidpolice-coms-nexus-one-is-running-android-2-2-froyo-how-fast-is-it-compared-to-2-1-oh-only-about-450-faster/">has increased markedly</a> . </li></ul><br>  The guys from Google also reviewed the standard Java JDK API packages.  They removed some of them (for example, everything about Swing) and added some of their own - their name starts with ‚Äúandroid‚Äù. <br><br>  They also added several open source packages that are not part of the standard JDK: <a href="http://www.bouncycastle.org/">Bouncy Castle</a> crypto API, <a href="httpcomponents-client-ga/">HTTPClient</a> with support for HTTP / HTTPS separation on the client side. <br><br>  Google also added a web browser to the application infrastructure layer.  This is not a full-fledged Google <a href="http://en.wikipedia.org/wiki/Google_Chrome">Chrome</a> for mobile devices, but very close to it, because it is based on the same <a href="http://en.wikipedia.org/wiki/WebKit">WebKit engine</a> and uses the JavaScript <a href="http://en.wikipedia.org/wiki/V8_%2528JavaScript_engine%2529">V8 engine</a> from Chrome.  In the end, this is an extremely modern and high-tech browser.  It can be integrated into any Android application. <br><br>  That's all for today.  In the next article we will focus on the architecture of Android applications. <br><br>  <b>Update from the translator.</b>  The original used not quite the correct terminology.  Thanks to all those who pointed out these errors. <br><br>  The following articles: <br><ul><li>  <a href="http://habrahabr.ru/post/140655/">Android application architecture.</a>  <a href="http://habrahabr.ru/post/140655/">Part II - architectural styles and patterns</a> </li><li>  <a href="http://habrahabr.ru/post/141201/">Android application architecture.</a>  <a href="http://habrahabr.ru/post/141201/">Part III - the main parts of the application</a> </li><li>  <a href="http://habrahabr.ru/post/141504/">Android application architecture.</a>  <a href="http://habrahabr.ru/post/141504/">Part IV - integration level</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/140459/">https://habr.com/ru/post/140459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140453/index.html">Droider Chart. Issue 92, experimental</a></li>
<li><a href="../140454/index.html">Mechanical keyboard</a></li>
<li><a href="../140456/index.html">Hooks are easy</a></li>
<li><a href="../140457/index.html">While there is a competition from Microsoft for the best application, we want to know what conditions the ideal application should satisfy, according to habravchan?</a></li>
<li><a href="../140458/index.html">Flight Search API from Eviterra</a></li>
<li><a href="../140461/index.html">Messaging between roles and instances</a></li>
<li><a href="../140462/index.html">iPad 3 - hot new</a></li>
<li><a href="../140464/index.html">iPhone: MiTM-attack out of pocket</a></li>
<li><a href="../140465/index.html">The heaviest mirrorless design by Mark Newson - Pentax K-01</a></li>
<li><a href="../140466/index.html">We invite you to the webinar on March 24th. Subject: Diagnostics of faults in mobile phones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>