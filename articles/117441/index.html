<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How can you use PowerShell?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inspired by q & a: How to play mp3 from the command line in Windows 7? 

 A bit shocked by the suggested answers, which boil down to 'download and ins...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How can you use PowerShell?</h1><div class="post__text post__text-html js-mediator-article">  Inspired by <a href="http://habrahabr.ru/qa/6717/">q &amp; a: How to play mp3 from the command line in Windows 7?</a> <br><br>  A bit shocked by the suggested answers, which boil down to 'download and install additional software' ... and so in the system already under 20GB of <s>some kind of shit</s> something useful that is called an operating system ... I apologize, it broke out. <br><br>  Once in Windows XP, I used the simplest utility mplay for this task, although the GUI but the task scheduler normally starts, but in Windows 7 it was deleted and even sndrec32.  I think it‚Äôs foolish to run a monstrous wmplayer, so I have to turn to scripting languages. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Examples of single-line vbs scripts for windows scripting host can be found on the Internet, here is the simplest example: <blockquote><code><font color="#008000"><strong>Set</strong></font> oVoice <font color="#666666">=</font> CreateObject( <font color="#BA2121">"SAPI.SpVoice"</font> ) <br> <font color="#008000"><strong>set</strong></font> oSpFileStream <font color="#666666">=</font> CreateObject( <font color="#BA2121">"SAPI.SpFileStream"</font> ) <br> oSpFileStream.Open <font color="#BA2121">"c:\Windows\Media\tada.wav"</font> <br> oVoice.SpeakStream oSpFileStream <br> oSpFileStream.Close <br></code> </blockquote><br>  By the way, it‚Äôs a miracle that the code worked on windows 7, since compared to windows xp a number of activex objects disappeared (like WMPlayerClass) and nobody knows when the SAPI class will disappear or how the SAPI class will change, and it‚Äôs not a matter of hammering nails.  Therefore, I think this solution is wrong and not logical, and ActiveX is slowly dying off, it is quite logical to kill .NET environment. <br><a name="habracut"></a><br>  I tried to solve the problem with the new-fashioned PowerShell (I don‚Äôt know how to cook, but I rummaged in the documentation), my hair stood on end on how great ideas were combined with a terrible implementation.  For example, there is no normal possibility to run a script from the command line without creating and signing the file (I understand everything, safety is above all, as a result of questions whether it is worth using it). <br><br>  Here is the simplest code: <blockquote> <code>$s=new-Object System.Media.SoundPlayer;$s.SoundLocation='C:\Windows\Media\tada.wav';$s.Play();</code> </blockquote>  Works great inside powershell, if you insert it and execute it manually! <br><br>  But in this way: <blockquote> <code>powershell -Command $s=new-Object System.Media.SoundPlayer;$s.SoundLocation='C:\Windows\Media\tada.wav';$s.Play();</code> </blockquote>  Nothing happens, because each command is executed in its context (that is, at each step $ s is not defined). <br><br>  I tried to use redirection: <blockquote> <code>echo $s=new-Object System.Media.SoundPlayer;$s.SoundLocation='C:\Windows\Media\tada.wav';$s.Play(); | powershell -command -</code> </blockquote>  And the result was shocked - the registered player was launched by default on a wav file (it turned out to be winamp for me).  Why on earth? <br><br>  And without using -command -: <blockquote> <code>echo $s=new-Object System.Media.SoundPlayer;$s.SoundLocation='C:\Windows\Media\tada.wav';$s.Play(); | powershell</code> </blockquote>  PowerShell starts up and waits for commands to be entered. <br><br>  Okay, give up, try to resolve unsigned scripts (run under the preferred shell): <blockquote> <code>powershell Set-ExecutionPolicy Unrestricted</code> </blockquote>  Create and run a file with the above code (putting it in c: \ a.ps1): <blockquote> <code>powershell c:\a.ps1</code> </blockquote>  And we get nothing!  Silence, and no error messages (when running unsigned scripts is not allowed, I receive a corresponding message). <br><br>  <s><font color="gray">Will the respected habrasoobshchestvo help this task in a simple and <s>racial</s> way in the right way?</font></s>  <s><font color="gray">As I understand it, the last test showed that the epic with certificates is not worth starting because the problem is somewhere else.</font></s> <br><br>  UPD from <a href="http://thebits.habrahabr.ru/">TheBits</a> and <a href="http://paul.habrahabr.ru/">Paul</a> : I didn‚Äôt notice the elephant, the script ends up without completing the play, and the launch of the code from the command line can be organized with the help of grouping and the &amp; symbol: <blockquote> <code>powershell -Command "&amp; {$s=new-Object System.Media.SoundPlayer; $s.SoundLocation='C:/Windows/Media/tada.wav'; $s.Play(); Sleep -Seconds 9}"</code> </blockquote> <br><br>  UPD2 Based on a number of comments: The final decision, of course, may be so, taking into account the automatic determination of the file duration and the exclusion of the $ s variable: <blockquote> <code>powershell -Command (new-object Media.SoundPlayer "C:\Windows\Media\notify.wav").playsync();</code> </blockquote>  But the most important thing is that it does not solve the original problem - System.Media.SoundPlayer cannot play mp3 files, i.e.  you need something more difficult to sculpt, but I did not think the purpose of this post to put the solution to the original problem. </div><p>Source: <a href="https://habr.com/ru/post/117441/">https://habr.com/ru/post/117441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../117435/index.html">Unboxing and test new eeepc 1015b on AMD Fussion</a></li>
<li><a href="../117436/index.html">Impressions of the conference "The State in the XXI century"</a></li>
<li><a href="../117438/index.html">Firefox 6 alpha 1 released</a></li>
<li><a href="../117439/index.html">Plasma Active for portable devices</a></li>
<li><a href="../117440/index.html">Surtout - Ruby on Rails CMS</a></li>
<li><a href="../117443/index.html">Google Apps Engine: A fun mistake or an increase in free quota?</a></li>
<li><a href="../117444/index.html">CoffeeScript became the default language in Rails 3.1</a></li>
<li><a href="../117446/index.html">Are you ready to change your diploma for start-up capital?</a></li>
<li><a href="../117447/index.html">Habr. "Slice" of one day</a></li>
<li><a href="../117448/index.html">Ruby Cross Reference</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>