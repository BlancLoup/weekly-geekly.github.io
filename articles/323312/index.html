<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Authentication and voice identification using Microsoft cognitive services</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cognitive services provide access to various cloud services that allow you to work with visual, voice and textual information. In addition, various Bi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Authentication and voice identification using Microsoft cognitive services</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/f23/7ef/ede/f237efede29d4c2680353dbec2fcf3a9.jpg"></div><br>  Cognitive services provide access to various cloud services that allow you to work with visual, voice and textual information.  In addition, various Bing search functions are available. <br><br>  In order to try cognitive services in action, it is not even necessary to have a Microsoft account.  You can also get a trial key using your GitHub or LinkedIn account.  The trial subscription is not limited in time, but limited in the number of resources used for the period.  Read the online demo at: <a href="https://www.microsoft.com/cognitive-services/en-us/speaker-recognition-api">Speaker Recognition API</a> <br><br>  The following is a description of how to try out user authentication with a voice in action.  Although the service is also able to preview, but despite this, it is already quite interesting. <br>  The service can be used from various platforms, but I will consider creating a C # / XAML UWP application. <br><a name="habracut"></a><br>  You can enter and get a trial key at the link: <a href="https://www.microsoft.com/cognitive-services/en-US/subscriptions">Microsoft Cognitive Services - Get started for free</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/702/e70/12a/702e7012a50b4fd192f872725e53b154.PNG"><br><br>  Click + and select <b>Speaker Recognition - Preview 10,000 transactions per month, 20 per minute</b> . <br><br>  Alternatively, you can get the key from your Azure account (but what about without it).  Find Cognitive Services APIs and create an account with the type Speaker Recognition API. <br><br><img src="https://habrastorage.org/files/810/9b8/719/8109b87199764644b075c17c3ee67d6e.PNG"><br><br>  This method is suitable for those who do not intend to dwell only on trial functions. <br>  Find the key here: <br><br><img src="https://habrastorage.org/files/109/c5e/985/109c5e98560d4ec8b5fcb0eb28c541a2.png"><br><br>  Before proceeding, let's define the terminology within the framework of the task: <br><br>  <b>Verification</b> - confirmation that the speech was uttered by a certain person.  The identity of the speaker. <br>  <b>Identification</b> - determining which of the many users we know has uttered a phrase. <br>  <b>Enrollment</b> is a process during which a service trains to recognize a user's voice.  After the service has received a certain number of example phrases, the user profile becomes registered and can be used for recognition. <br><br><h3>  Description of the configuration and process of voice recognition </h3><br>  Creates a user profile <br>  Enrollment produced.  Repeats of the same phrase are sent to the service several times. <br>  Currently, only the following languages ‚Äã‚Äãare supported: en-US (English US) and zh-CN (Chinese Mandarin). <br><br>  The phrase for the English language can be selected from the following list: <br>  "I can't refuse him anymore." <br>  "Houston we had a problem" <br>  "My voice is my passport verify me" <br>  "Apple juice tastes funny after toothpaste" <br>  "You can get in without your password" <br>  "You can activate security system now" <br>  "My voice is stronger than passwords" <br>  "My password is not your business" <br>  "My name is unknown to you" <br>  "Be yourself everyone else is already taken" <br><br>  The first spoken phrase is attached to the profile.  You can change the phrase only by resetting the Enrollment using ResetEnrollmentsAsync. <br><br>  Let's imagine how a set of phrases could look like in Russian.  I'll start, and you offer options in the comments: <br>  ‚ÄúIs this the apartment of Anton Semenovich Shpak?‚Äù <br>  "Easy, Masha, I am Dubrovsky!" <br>  ‚ÄúI am a smart, handsome, moderately plump man, well, in his prime,‚Äù <br><br><h3>  Creating a UWP Application </h3><br>  Create a UWP application and add the following NuGet <a href="https://www.nuget.org/packages/Microsoft.ProjectOxford.SpeakerRecognition/">Microsoft.ProjectOxford.SpeakerRecognition</a> package <br>  Add a microphone to the Capabilities section of the manifest.  Internet (client) should be added by default.  Configuration is complete and you can go to the code.  The list of required namespaces for working with the service: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.ProjectOxford.SpeakerRecognition; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.ProjectOxford.SpeakerRecognition.Contract; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.ProjectOxford.SpeakerRecognition.Contract.Verification;</code> </pre> <br>  Required namespaces for working with audio: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Windows.Media.Capture; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Windows.Media.MediaProperties; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Windows.Storage.Streams;</code> </pre> <br>  To work with the service you need to create some objects.  Subscription key row and customer verification.  The client will interact with the service. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpeakerVerificationServiceClient _serviceClient; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _subscriptionKey;</code> </pre> <br>  After initializing the page, you need to initialize these variables: <br><br><pre> <code class="cs hljs"> _subscriptionKey = <span class="hljs-string"><span class="hljs-string">"ec186af1f65d428137f9568ec8d896b5"</span></span>; _serviceClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpeakerVerificationServiceClient(_subscriptionKey);</code> </pre> <br>  With the value _subscriptionKey specify your subscription key.  Now, logically, you need to create a user profile: <br><br><pre> <code class="cs hljs"> CreateProfileResponse response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> _serviceClient.CreateProfileAsync(<span class="hljs-string"><span class="hljs-string">"en-us"</span></span>);</code> </pre> <br>  From the response of the service we can get the profile ID: <br><br><pre> <code class="cs hljs"> String _profileId=response.ProfileId;</code> </pre> <br>  The next step in order should be the ‚Äútraining‚Äù of voice recognition.  Let us explain how to create a stream of audio.  The easiest way is to read the file from the disk: <br><br><pre> <code class="cs hljs"> Windows.Storage.Pickers.FileOpenPicker picker = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Windows.Storage.Pickers.FileOpenPicker(); picker.FileTypeFilter.Add(<span class="hljs-string"><span class="hljs-string">".wav"</span></span>); Windows.Storage.StorageFile fl = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> picker.PickSingleFileAsync(); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _selectedFile = fl.Name; AudioStream = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fl.OpenAsync(Windows.Storage.FileAccessMode.Read);</code> </pre><br>  The phrase should be written in mono with a frequency of 16 kHz. <br><br>  The second option is to record the voice from the microphone.  Starting voice recording: <br><br><pre> <code class="cs hljs"> MediaCapture CaptureMedia = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MediaCapture(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> captureInitSettings = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MediaCaptureInitializationSettings(); captureInitSettings.StreamingCaptureMode = StreamingCaptureMode.Audio; <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> CaptureMedia.InitializeAsync(captureInitSettings); MediaEncodingProfile encodingProfile = MediaEncodingProfile.CreateWav(AudioEncodingQuality.High); encodingProfile.Audio.ChannelCount = <span class="hljs-number"><span class="hljs-number">1</span></span>; encodingProfile.Audio.SampleRate = <span class="hljs-number"><span class="hljs-number">16000</span></span>; IRandomAccessStream AudioStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InMemoryRandomAccessStream(); CaptureMedia.RecordLimitationExceeded += MediaCaptureOnRecordLimitationExceeded; CaptureMedia.Failed += MediaCaptureOnFailed; <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> CaptureMedia.StartRecordToStreamAsync(encodingProfile, AudioStream);</code> </pre> <br>  The following parameters are required: <br><br><pre> <code class="cs hljs"> encodingProfile.Audio.ChannelCount = <span class="hljs-number"><span class="hljs-number">1</span></span>; encodingProfile.Audio.SampleRate = <span class="hljs-number"><span class="hljs-number">16000</span></span>;</code> </pre> <br>  Stop recording after some period of time: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> CaptureMedia.StopRecordAsync(); Stream str = AudioStream.AsStream(); str.Seek(<span class="hljs-number"><span class="hljs-number">0</span></span>, SeekOrigin.Begin);</code> </pre> <br>  and sending the stream to the enrollment service: <br><br><pre> <code class="cs hljs"> Guid _speakerId = Guid.Parse(_profileId); Enrollment response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> _serviceClient.EnrollAsync(str, _speakerId);</code> </pre> <br>  From the <b>response,</b> we can get the following data: <br>  <b>response.Phrase</b> - spoken phrase <br>  <b>response.RemainingEnrollments</b> - the number of remaining repetitions of the phrase <br><br>  Recognition differs from enrollment only in using the VerifyAsync method: <br><br><pre> <code class="cs hljs"> Guid _speakerId = Guid.Parse(_profileId); Verification response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> _serviceClient.VerifyAsync(str, _speakerId);</code> </pre> <br>  The source code of the resulting application is available on <a href="https://github.com/programmersommer/Recognize_Me_App">GitHub.</a> <br><br>  A screenshot of what happened below: <br><br><img src="https://habrastorage.org/files/6d1/ebd/232/6d1ebd2325264d598842322b6a0fcb1e.PNG"><br><br>  As the only method of protection, voice authentication is probably not the most reliable option.  But as one of the elements of multifactor authentication it can be used. <br><br>  Again, the possibility of identification is interesting, the code of which is similar, but with some changes. <br><br>  Since the time interval during which the recording is performed can be long, in order to give the service time to complete the operation, the check is started in a loop.  Enrollment operation example: <br><br><pre> <code class="cs hljs"> _speakerId = Guid.Parse((lbProfiles.SelectedItem <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ListBoxItem).Content.ToString()); OperationLocation processPollingLocation; processPollingLocation = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> _serviceClient.EnrollAsync(str, _speakerId); EnrollmentOperation enrollmentResult = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> numOfRetries = <span class="hljs-number"><span class="hljs-number">10</span></span>; TimeSpan timeBetweenRetries = TimeSpan.FromSeconds(<span class="hljs-number"><span class="hljs-number">5.0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (numOfRetries &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> Task.Delay(timeBetweenRetries); enrollmentResult = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> _serviceClient.CheckEnrollmentStatusAsync(processPollingLocation); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (enrollmentResult.Status == Status.Succeeded) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (enrollmentResult.Status == Status.Failed) { txtInfo.Text = enrollmentResult.Message; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } numOfRetries--; }</code> </pre> <br>  For identification, <a href="https://www.nuget.org/packages/Microsoft.ProjectOxford.SpeakerRecognition/">the same NuGet package is used</a> . <br>  The source code of the identification application is also posted on <a href="https://github.com/programmersommer/Who_Is_Talking_App">GitHub</a> . <br><br>  The official example of a WPF project on GitHub, which can also be useful: <br>  <a href="https://github.com/Microsoft/Cognitive-SpeakerRecognition-Windows">Microsoft Speaker Recognition API: Windows Client Library &amp; Sample</a> <br>  Example in Python: <a href="https://github.com/Microsoft/Cognitive-SpeakerRecognition-Python">Microsoft Speaker Recognition API: Python Sample</a> <a href="https://github.com/Microsoft/Cognitive-SpeakerRecognition-Python"><br><br></a>  You can also find the <a href="https://github.com/Microsoft/Cognitive-SpeakerRecognition-Android">Android SDK for Microsoft Speaker Recognition API</a> on GitHub </div><p>Source: <a href="https://habr.com/ru/post/323312/">https://habr.com/ru/post/323312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323302/index.html">Encryption algorithm based on elementary cellular automata</a></li>
<li><a href="../323304/index.html">We are looking for and analyzing errors in the code Media Portal 2</a></li>
<li><a href="../323306/index.html">How IT professionals work. Leonid Vyhovsky, systems architect, LiveTex</a></li>
<li><a href="../323308/index.html">We repeat the design of applications that have received Apple award</a></li>
<li><a href="../323310/index.html">The book ‚ÄúGrokayem algorithms. Illustrated manual for programmers and curious</a></li>
<li><a href="../323314/index.html">Proper communication on the example of volleyball</a></li>
<li><a href="../323316/index.html">Gatling load testing</a></li>
<li><a href="../323318/index.html">LocoLaser: translate apps in Google Sheets</a></li>
<li><a href="../323320/index.html">The impact that GitHub has on your career</a></li>
<li><a href="../323322/index.html">Marketing email marketing: the main metric that you safely forgot about</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>