<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Windows Deployment Services and DHCP server on Linux + a couple of features</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Fab-people! 

 Being a novice administrator, I strive to learn everything new and how to absorb information through a sponge. I also appreciate the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Windows Deployment Services and DHCP server on Linux + a couple of features</h1><div class="post__text post__text-html js-mediator-article">  Hi Fab-people! <br><br>  Being a novice administrator, I strive to learn everything new and how to absorb information through a sponge.  I also appreciate the order in the IT infrastructure of the enterprise, consistency, accessibility and versatility.  In an effort to achieve the latter, (to use for DNS Nix DNS - BIND) not so long ago suffered a fiasco, but do not stop there.  I would like to share with you information regarding the role of <b>Windows Deployment Services</b> in Windows Server 2012 and setting it up to work with a <b>third-party DHCP server</b> on Ubuntu Server. <br><a name="habracut"></a><br><h4>  Part 1. Setting up a DHCP server </h4><br>  The entire network in our organization is built on UNIX-systems, and for, even if modest by IT standards, a fleet of 50 pcs.  still want to use all the modern benefits and convenience of administration.  The question arose: how to deploy Windows on users' PCs over the network, when will the TFTP server be separate from DHCP?  The task, albeit a simple one, made me fluently study the operation and setup of a DHCP server on Ubuntu.  Versatility is important to us.  :) Do not raise the same for the "screw" DHCP. <br><br>  All that was required, when describing the network, was to indicate with the <i>next-server</i> command that the TFTP server was on a different host.  Here is the DHCP config fragment using the example of the 192.168.1.0/24 network: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">shared-network 2_Users { subnet 192.168.1.0 netmask 255.255.255.0 { range 192.168.1.2 192.168.1.254; default-lease-time 3600; max-lease-time 7200; option domain-name <span class="hljs-string"><span class="hljs-string">"test.jp"</span></span>; option domain-name-servers 192.168.1.1; option routers 192.168.1.1; next-server 192.168.2.2; <span class="hljs-comment"><span class="hljs-comment">#   ,    DHCP,  TFTP-  PXE-    .       , ,    . option tftp-server-name "addc1.test.jp"; #DNS-     WDS.    ,   . option bootfile-name "boot\\x86\\wdsnbp.com"; #,         . }</span></span></code> </pre> <br>  That's all.  <i>/etc/init.d/isc-dhcp-server restart</i> .  We proceed to configure WDS. <br><br><h4>  Part 2: Configure the Windows Deployment Services Role </h4><br>  About the installation of the role can hardly say something.  It is simple, does not require a reboot, and asks you to specify which components to install.  We need both components: <b>Deployment Server</b> and <b>Transport Server</b> . <br><br>  After the role is installed, its console will be available in the Administration list of the Windows Server Control Panel and is called <b>Windows Deployment Services</b> . <br><img src="https://habrastorage.org/getpro/habr/post_images/cd1/f4a/22b/cd1f4a22b0495445854e044b6636ac4b.png" alt="image"><br><br>  Initially, the server needs to be configured.  PCM on the server on the left and select "Configure Server".  Setting is not a big deal, I‚Äôll only talk about important, in my opinion, points: <br><br>  If you use Active Directory Domain Services in your network, then when setting up the server, you can specify whether the server will be isolated or run in AD.  It will be much more important to note later that the DHCP server is in a different place and there is no need to listen to the connections on the ports of our WDS server. <br><ul><li>  You will need to specify whether to integrate the server into AD </li><li>  Specify the installation image storage location </li><li>  Select answer policy for clients.  Here is a little more detail. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/a4b/0b9/96e/a4b0b996e779aba38c532cffbcd56abf.png" alt="image"><br><br>  If we restrict ourselves only to installing the system, then you can select the item ‚ÄúAnswer all ...‚Äù because, installing Windows will require a login / password pair from the server from which it is being booted.  Unauthorized installation of "Windows on the grid" is not a ride. <br><ul><li>  At the end you will be asked to add the first image </li></ul><br>  I want to draw your attention to the tab "DHCP Protocol" server properties. <br><img src="https://habrastorage.org/getpro/habr/post_images/251/acd/478/251acd478cb7f5e9e6ee228d4d903be4.png" alt="image"><br><br>  Here you just need to remove the birds if you use a third-party DHCP server.  And on the "Client" tab, you can specify whether to bring new users to the domain. <br><img src="https://habrastorage.org/getpro/habr/post_images/cb3/1aa/303/cb31aa3037c245aad5772fa342995030.png" alt="image"><br><br><h4>  Part 3. Interesting </h4><br>  As you know, Windows images are added to the WDS server in two stages: adding a boot image (boot.wim) and an installation image (install.wim).  Here I noticed a small and interesting feature.  Our company uses Windows, starting with Windows 7, Server 2008R2 and ending with Windows 8.1 and Server 2012. As you know, the contents of boot.wim are what we see by running the Windows installation from the disk.  And if at installation from a disk only drivers for the HDD controller are important, then for a network installation, drivers for a network adapter are also important.  <a href="http://did5.ru/zhizn/kak-integrirovat-drajvera-v-boot-wim.html">This article</a> describes well how to integrate drivers into a distribution using a WAIK.  But when I added the boot image from the Windows 8.1 distribution and checked it, I noticed that the database of drivers for network adapters was expanded.  But the main feature is not the point.  :) Using one, the latest Windows boot image (even if you collected it yourself using WAIK), you can install any editions of Windows, starting with Windows Vista, ending with Windows Server 2012R2.  You do not need to add a bunch of images to download - choose one, versatile and modern.  You can add only install images (install.wim), choosing which editions of Windows you need. <br><br>  You can create image groups in the WDS management console ... <br><img src="https://habrastorage.org/getpro/habr/post_images/304/7f9/08d/3047f908d8f22de6588f5d93f7544a21.png" alt="image"><br><br>  ... and as a result, when installing, you will receive a list of all operating systems, from the Desktop and Servers groups, select the required one and install it.  <b>Do not forget</b> , to install, you need to enter the server administrator login / password. <br><br>  The contents of the directory where the installation images are stored will look like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/216/7ad/4f4/2167ad4f49af0c13324b0b85b0e7f6a6.png" alt="image"><br><br>  Despite the banality of what is happening, it will not prevent you from installing any of the Windows you added to the server. <br><br>  That is, in fact, all that I wanted to share with you.  If you want to expand the capabilities of WDS, on Habr√© there is an article " <a href="http://habrahabr.ru/post/171329/">Add WDS universality"</a> , where there is an even bigger fan of this very "universality", tells how to make WDS use GRUB2, and hence the installation of Linux and reanimation utilities ... In general, everything so that the modern admin does not carry a flash drive with him. <br><br>  I am for sharing Windows and Linux.  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/203364/">https://habr.com/ru/post/203364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../203354/index.html">LG will stop watching SmartTV users</a></li>
<li><a href="../203356/index.html">Extend cartridge life</a></li>
<li><a href="../203358/index.html">Once again about Security in Symfony2 the user-resource-privilege approach</a></li>
<li><a href="../203360/index.html">CMS Textpattern development and who needs it</a></li>
<li><a href="../203362/index.html">Knapsack problem and gray code</a></li>
<li><a href="../203366/index.html">9th Habravstrecha in Kiev</a></li>
<li><a href="../203368/index.html">Android In-app purchasing: paid ad disconnection in your application</a></li>
<li><a href="../203372/index.html">Say thanks to WINAMP ‚Ä¢ thxwinamp.com</a></li>
<li><a href="../203374/index.html">Someone made a $ 160 million bitcoin transaction</a></li>
<li><a href="../203376/index.html">Home all-in-one server - success story</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>