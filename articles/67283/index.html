<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>LVM is easy!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Actually, I want to just and easily tell about such a wonderful thing as Logical Volume Management or Logical Volume Management. 
 Since I‚Äôve been usi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>LVM is easy!</h1><div class="post__text post__text-html js-mediator-article">  Actually, I want to just and easily tell about such a wonderful thing as Logical Volume Management or Logical Volume Management. <br>  Since I‚Äôve been using LVM for a long time, I‚Äôll tell you what it means for me, not looking at manuals and pulling quotes from wiki in my own words so that it is clear to those who don‚Äôt know anything about it.  I will try not to immediately talk about all sorts of "advanced" functions such as stripes, snapshots, etc. <br><a name="habracut"></a><br>  LVM is an additional layer of abstraction from iron, which allows you to collect heaps of dissimilar disks into one, and then again to break this one exactly as we want. <br><br>  There are 3 levels of abstraction: <br>  1. PV (Physical Volume) - physical volumes (these can be partitions or whole "non-broken" disks) <br>  2. VG (Volume Group) - a group of volumes (we unite the physical volumes (PV) into a group, we create a single disk, which we will further break as we like) <br>  3. LV (Logical Volume) - logical partitions, the actual partition of our new ‚Äúsingle disk‚Äù aka Group of Volumes, which we then format and use as a normal partition, a regular hard disk. <br>  this is probably the whole theory.  :) now practice: <br>  To work, you need lvm2 packages and the ability to work with root privileges, therefore: <br>  $ sudo bash <br>  # apt-get install lvm2 <br><br>  Let's say we have a 40GB hard drive in our computer and we managed to scrape together some money and finally buy a TERRAIN DAY!  :))) The system is already up and running, and the first disk is broken into one partition (/ dev / sda1 as /), the second one is the largest one we just connected - not / dev / sdb at all ... <br>  I suggest that you unload the root disk a little bit, and at the same time speed up (the new disk is faster than the old one) and ‚Äúsecure‚Äù the system using lvm. <br>  You can create partitions on the second disk and add them to volume groups (if we need several volume groups), <br>  but you can not do partitions on the disk at all and make the whole device a physical partition (PV) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      root @ ws: ~ # pvcreate / dev / sdb <br>  Physical volume "/ dev / sdb" successfully created <br><br>  We create a volume group with a talking name, for example, by the name of the machine ‚Äúws‚Äù, so that when we drag this disk to another machine there are no conflicts with the names of the volume groups: <br><br>  root @ ws: ~ # vgcreate ws / dev / sdb <br>  Volume group "vg0" successfully created <br><br>  It is advisable to make folders such as / usr / var / tmp / home from the root partition in order not to defragment the root partition once again and in no case overflow it, so we create partitions: <br><br>  root @ ws: ~ # lvcreate -n usr -L10G ws # here we create a partition called ‚Äúusr‚Äù, 10Gb in size <br>  Logical volume "usr" created <br>  by analogy, we do the same for / var, / tmp, / home: <br>  root @ ws: ~ # lvcreate -n var -L10G ws <br>  root @ ws: ~ # lvcreate -n tmp -L2G ws <br>  root @ ws: ~ # lvcreate -n home -L500G ws <br>  we still have some free space in the volume group (for example, for a future backup section) <br>  see how much you can command: <br>  root @ ws: ~ # vgdisplay <br>  information on created logical volumes <br>  root @ ws: ~ # lvdisplay <br>  information on physical volumes <br>  root @ ws: ~ # pvdisplay <br><br>  the sections that we created will appear in the / dev / [vg_name] / folder, or rather there will be links to files, <br>  lrwxrwxrwx 1 root root 22 2009-08-10 18:35 swap -&gt; / dev / mapper / ws-swap <br>  lrwxrwxrwx 1 root root 21 2009-08-10 18:35 tmp -&gt; / dev / mapper / ws-tmp <br>  lrwxrwxrwx 1 root root 21 2009-08-10 18:35 usr -&gt; / dev / mapper / ws-usr <br>  lrwxrwxrwx 1 root root 21 2009-08-10 18:35 var -&gt; / dev / mapper / ws-var <br>  etc‚Ä¶ <br><br>  Then lvm is almost ending ... we format our partitions into favorite file systems: <br>  root @ ws: ~ # mkfs.ext2 -L tmp / dev / ws / tmp <br>  root @ ws: ~ # mkfs.ext4 -L usr / dev / ws / usr <br>  root @ ws: ~ # mkfs.ext4 -L var / dev / ws / var <br>  root @ ws: ~ # mkfs.ext4 -L home / dev / ws / home <br><br>  By the way, it would not be bad to do a swap partition: <br>  root @ ws: ~ # lvcreate -n swap -L2G ws <br>  root @ ws: ~ # mkswap -L swap / dev / ws / swap <br>  root @ ws: ~ # swapon / dev / ws / swap <br><br>  create a folder and connect the newly formed volumes in turn, copy the necessary contents into them: <br>  root @ ws: ~ # mkdir / mnt / target <br>  root @ ws: ~ # mount / dev / ws / home / mnt / target <br>  copy everything from the / home folder to your favorite file manager (with the same permissions), for example;): <br>  root @ ws: ~ # cp -a / home / * / mnt / target / <br>  root @ ws: ~ # umount / mnt / target / <br>  By the way, for the temp folder you only need to correct the rights, copy something there is not necessary: <br>  root @ ws: ~ # mount / dev / ws / tmp / mnt / target &amp;&amp; chmod -R a + rwx / mnt / target &amp;&amp; umount / mnt / target / <br>  add the necessary lines in / etc / fstab, for example: <br>  / dev / mapper / ws-home / home ext4 relatime 0 2 <br>  / dev / mapper / ws-tmp / tmp ext2 noatime 0 2 <br>  / dev / mapper / ws-swap none swap sw 0 0 <br>  and reboot ... (advanced gentlemen can do without rebooting;)) <br><br>  On tasty, I want to offer a more advanced thing: <br>  Suppose we have a system with a partition on LVM, and the hard disk began to fail, then we can move the entire system to another hard disk / partition without rebooting: <br><br>  # On-line adding / removing hard drives using LVM (example) <br><br>  root @ ws: ~ # pvcreate / dev / sda1 # our bad disk emulator <br>  Physical volume "/ dev / sda1" successfully created <br><br>  root @ ws: ~ # pvcreate / dev / sdb1 # our rescue disk emulator <br>  Physical volume "/ dev / sdb1" successfully created <br><br>  root @ ws: ~ # vgcreate vg0 / dev / sda1 # create a volume group vg0 <br>  Volume group "vg0" successfully created <br><br>  root @ ws: ~ # lvcreate -n test -L10G vg0 # create a partition for "important" information <br>  Logical volume "test" created <br><br>  root @ ws: ~ # mkfs.ext2 / dev / vg0 / test # create a file system on a partition <br>  root @ ws: ~ # mount / dev / mapper / vg0-test / mnt / tmp / # mount partition <br>  ... # I fill it with information, open several files on it, etc. <br><br>  root @ ws: ~ # vgextend vg0 / dev / sdb1 # expand our volume group to a rescue disk <br>  Volume group "vg0" successfully extended <br><br>  root @ work: ~ # pvmove / dev / sda1 / dev / sdb1 # move the contents from the dying disk to the rescue <br>  / dev / sda1: Moved: 0.9% <br>  / dev / sda1: Moved: 1.8% <br>  ... <br>  / dev / sda1: Moved: 99.7% <br>  / dev / sda1: Moved: 100.0% <br><br>  root @ work: ~ # vgreduce vg0 / dev / sda1 # remove the "dying" disk from the volume group. <br>  Removed "/ dev / sda1" from volume group "vg0" <br><br>  Total: <br>  I created a logical partition, formatted it, mounted it and filled it with the necessary data, then moved it from one device to another, while the section remained mounted and the data remained available all the time! <br>  Likewise, I managed to transfer the entire system from a dying disk to a reed array without rebooting.  :) <br><br>  And this is my favorite link on LVM: <a href="http://xgu.ru/wiki/LVM">xgu.ru/wiki/LVM</a> <br><br>  PS Please forgive me for typos, I was constantly distracted =)) <br><br>  PPS Oh yes !!!  The most important and biggest LVM minus is that it is not readable by grub. <br>  therefore, the / boot partition must be outside LVM on a separate hard disk partition, <br>  otherwise the system will not boot. </div><p>Source: <a href="https://habr.com/ru/post/67283/">https://habr.com/ru/post/67283/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../67274/index.html">Safari & Mouse gestures</a></li>
<li><a href="../67275/index.html">Zombie Attack: A Mathematical Model of Infection</a></li>
<li><a href="../67279/index.html">Theoretically, car parking in Riga is 5 times cheaper</a></li>
<li><a href="../6728/index.html">Let's develop Google Reader;)</a></li>
<li><a href="../67280/index.html">And you say the crisis ...</a></li>
<li><a href="../67284/index.html">Xbox Mi—Åro</a></li>
<li><a href="../67285/index.html">Improving performance: how I got rid of insomnia</a></li>
<li><a href="../67286/index.html">Haiku plans to release the first alpha version on September 9</a></li>
<li><a href="../67287/index.html">system migration to RAID + LVM (short summary)</a></li>
<li><a href="../67289/index.html">Couchsurfing.org or hospitality clubs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>