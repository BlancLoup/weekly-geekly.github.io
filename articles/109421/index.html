<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Come in! Login without login and password</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Who is guilty? 
 One of the frequently arising tasks in the development of web projects is to let the user onto the site without entering a login and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Come in! Login without login and password</h1><div class="post__text post__text-html js-mediator-article"><h4>  Who is guilty? </h4><br>  One of the frequently arising tasks in the development of web projects is to let the user onto the site without entering a login and password, while authorizing him. <br><br>  Here are some examples of such situations: <br><ul><li>  Link to activate your account just registered user. </li><li>  Link to password recovery. </li><li>  Invitation (return) to the site of a user who has not visited for a long time. </li></ul><br>  In each of these cases, we need to create a key for the user and add it to the URL sent in the letter. <a name="habracut"></a><br><br>  As a rule, this key should be: <br><ul><li>  unique; </li><li>  URL safe; </li><li>  difficult (impossible) fake; </li><li>  reasonable length. </li></ul><br>  I have seen many solutions (and I used to resort to them myself) based on adding a service field or a whole table to the database, in which generated keys were placed and some additional information that allows you to authorize the user when he comes to the site with this key.  Usually this key is the result of some hash function.  For example: sha1 ($ userId. ‚ÄúSecret_key‚Äù. Time ()); 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Very often, this decision comes first.  In fact, his place is at the very end. <br><br>  I offer your solution, which allows you to do "little blood" - do not require working with the database. <br><br><h4>  What to do? </h4><br>  In addition to the above properties of the key, other restrictions are often imposed on it.  From them, in fact, have to dance. <br><br>  In the simplest cases, you can do with constructions of the form: sha1 ($ userId. "Secret_key");  or sha1 ($ userId. "secret_key". "confirm_code"); <br><br>  If a user comes with such a key to a site using a URL like <a href="http://example.com/users/%25user_id%25%3Ft%3D%25key%25">example.com/users/%user_id%?t=%key%</a> , we can easily check it. <br><br>  Disadvantages of this approach: <br><ul><li>  for each user, the key will always be the same; </li><li>  such a key will always be valid, it cannot be limited in time; </li><li>  You must explicitly pass the user id into the URL. </li></ul><br>  The disadvantages are significant and therefore, in most cases, this solution will not work. <br>  But this is not a reason to store data in the database.  They can be stored in the key.  Store safely - in encrypted form. <br>  In php, encryption functions are implemented in the Mcrypt library, which can be easily installed from pecl or your OS repositories. <br>  You yourself can implement your favorite algorithm.  This is not important - the main thing is that we have functions allowing us to encrypt and decrypt arbitrary text. <br><br>  The idea is simple.  In the line we place the necessary data, encrypt it with our secret key, bring it to a URL-safe form and insert it as a key into the link that the user will use to get to us. <br><br>  It must be remembered that the more data we want to put in the key, the longer the key itself will be, because  this is no longer a fixed-length hash. <br><br>  For my solution, I allocated such data for storage in the key: <br><ul><li>  user id (4 bytes); </li><li>  key creation time (4 bytes); </li><li>  key validity time (4 bytes); </li><li>  mode (1 byte) - a variable with which we can divide the assignment of keys (password recovery / registration confirmation / just an invitation); </li><li>  Random number (1 byte) - add uniqueness; </li><li>  Checksum (4 bytes). </li></ul><br>  Looking ahead, I'll show an example of the resulting key: <b>67147328f43d69f7784770a2d9c84b181a8c</b> . <br>  What you will keep in the key depends on your task.  Here I showed that the key of an acceptable length can easily fit 18 bytes of information. <br><br>  We turn to the implementation.  I implemented this solution in the same class with two static methods. <br><br> <code><code><a href="http://s-c.me/10276/s"></a> <a href="http://s-c.me/10276/h"></a> <a href="http://www.php.net/manual/en/function.sprintf.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.hexdec.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.sprintf.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.hexdec.php"></a> <a href="http://www.php.net/manual/en/function.intval.php"></a> <a href="http://www.php.net/manual/en/function.intval.php"></a> <a href="http://www.php.net/manual/en/function.intval.php"></a> <a href="http://www.php.net/manual/en/function.time.php"></a> <a href="http://www.php.net/manual/en/function.ceil.php"></a> <a href="http://www.php.net/manual/en/function.mt-rand.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.mcrypt-encrypt.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.sprintf.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.hexdec.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.mcrypt-decrypt.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.time.php"></a> <font color="black">Copy Source | Copy HTML&lt;br/&gt; <font color="#cc6633">&lt;?php</font> &lt;br/&gt; &lt;br/&gt; <font color="#0000ff">class</font> AuthToken {&lt;br/&gt; <font color="#0000ff">private static</font> <font color="#cc6633">$key</font> = <font color="#008000">" "</font> ;&lt;br/&gt; <font color="#0000ff">private static</font> <font color="#cc6633">$iv</font> = <font color="#008000">"    ,       "</font> ;&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">private static function</font> int2char( <font color="#cc6633">$int</font> ) {&lt;br/&gt; <font color="#cc6633">$char</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#cc6633">$hex</font> = sprintf( <font color="#008000">"%08x"</font> , <font color="#cc6633">$int</font> );&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#008000">4</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$char</font> .= chr(hexdec(substr( <font color="#cc6633">$hex</font> , <font color="#cc6633">$i</font> * <font color="#008000">2</font> , <font color="#008000">2</font> )));&lt;br/&gt;        }&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$char</font> ;&lt;br/&gt;    }&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">private static function</font> char2int( <font color="#cc6633">$char</font> ) {&lt;br/&gt; <font color="#cc6633">$int</font> = <font color="#008000">0</font> ;&lt;br/&gt; <font color="#cc6633">$hex</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#008000">4</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$hex</font> .= sprintf( <font color="#008000">"%02x"</font> , ord( <font color="#cc6633">$char</font> { <font color="#cc6633">$i</font> }));&lt;br/&gt;        }&lt;br/&gt; <font color="#cc6633">$int</font> = hexdec( <font color="#cc6633">$hex</font> );&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$int</font> ;&lt;br/&gt;    }&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">public static function</font> create( <font color="#cc6633">$id</font> , <font color="#cc6633">$expire</font> = <font color="#008000">0</font> , <font color="#cc6633">$mode</font> = <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#cc6633">$id</font> = intval( <font color="#cc6633">$id</font> );&lt;br/&gt; <font color="#cc6633">$expire</font> = intval( <font color="#cc6633">$expire</font> );&lt;br/&gt; <font color="#cc6633">$mode</font> = intval( <font color="#cc6633">$mode</font> );&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$id</font> &lt; <font color="#008000">0</font> || <font color="#cc6633">$expire</font> &lt; <font color="#008000">0</font> || <font color="#cc6633">$mode</font> &lt; <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#0000ff">return null</font> ;&lt;br/&gt;        }&lt;br/&gt; &lt;br/&gt; <font color="#cc6633">$info</font> = <font color="#0000ff">array</font> ();&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ] = <font color="#cc6633">$id</font> ;&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] = time();&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] = <font color="#cc6633">$expire</font> ;&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] = <font color="#cc6633">$mode</font> ;&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ] = ceil(mt_rand( <font color="#008000">0</font> , <font color="#008000">255</font> ));&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"sum"</font> ] = <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ];&lt;br/&gt; <font color="#cc6633">$info</font> = self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ]) . self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ]) . self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ]) . chr( <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ]) . chr( <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ]) . self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"sum"</font> ]);&lt;br/&gt; &lt;br/&gt; <font color="#cc6633">$token</font> = mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5(self:: <font color="#cc6633">$key</font> ), <font color="#cc6633">$info</font> , MCRYPT_MODE_OFB, md5(self:: <font color="#cc6633">$iv</font> ));&lt;br/&gt; <font color="#cc6633">$tokenHex</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#cc6633">$tokenLength</font> = strlen( <font color="#cc6633">$token</font> );&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#cc6633">$tokenLength</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$tokenHex</font> .= sprintf( <font color="#008000">"%02x"</font> , ord( <font color="#cc6633">$token</font> { <font color="#cc6633">$i</font> }));&lt;br/&gt;        }&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$tokenHex</font> ;&lt;br/&gt;    }&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">public static function</font> check( <font color="#cc6633">$tokenHex</font> , <font color="#cc6633">$mode</font> = <font color="#0000ff">null</font> ) {&lt;br/&gt; <font color="#cc6633">$token</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#cc6633">$tokenHexLength</font> = strlen( <font color="#cc6633">$tokenHex</font> ) / <font color="#008000">2</font> ;&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#cc6633">$tokenHexLength</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$token</font> .= chr(hexdec(substr( <font color="#cc6633">$tokenHex</font> , <font color="#cc6633">$i</font> * <font color="#008000">2</font> , <font color="#008000">2</font> )));&lt;br/&gt;        }&lt;br/&gt; <font color="#cc6633">$info</font> = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, md5(self:: <font color="#cc6633">$key</font> ), <font color="#cc6633">$token</font> , MCRYPT_MODE_OFB, md5(self:: <font color="#cc6633">$iv</font> ));&lt;br/&gt; <font color="#0000ff">if</font> (strlen( <font color="#cc6633">$info</font> ) == <font color="#008000">18</font> ) {&lt;br/&gt; <font color="#cc6633">$info</font> = <font color="#0000ff">array</font> ( <font color="#008000">"id"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">0</font> , <font color="#008000">4</font> )), <font color="#008000">"time"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">4</font> , <font color="#008000">4</font> )), <font color="#008000">"expire"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">8</font> , <font color="#008000">4</font> )), <font color="#008000">"mode"</font> =&gt; ord( <font color="#cc6633">$info</font> { <font color="#008000">12</font> }), <font color="#008000">"rnd"</font> =&gt; ord( <font color="#cc6633">$info</font> { <font color="#008000">13</font> }), <font color="#008000">"sum"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">14</font> , <font color="#008000">4</font> )));&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"sum"</font> ] == <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ]) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] &gt; <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] + <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] &lt; time()) {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;                    }&lt;br/&gt;                }&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] &gt; <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$mode</font> !== <font color="#0000ff">null</font> ) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] != <font color="#cc6633">$mode</font> ) {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;                        }&lt;br/&gt;                    }&lt;br/&gt;                }&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ];&lt;br/&gt;            } <font color="#0000ff">else</font> {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;            }&lt;br/&gt;        } <font color="#0000ff">else</font> {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt; &lt;br/&gt; <font color="#cc6633">?&gt;</font> &lt;br/&gt; &lt;br/&gt;</font> <br></code></code> <blockquote> <code><code><font color="black"><a href="http://s-c.me/10276/s"></a> <a href="http://s-c.me/10276/h"></a> <a href="http://www.php.net/manual/en/function.sprintf.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.hexdec.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.sprintf.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.hexdec.php"></a> <a href="http://www.php.net/manual/en/function.intval.php"></a> <a href="http://www.php.net/manual/en/function.intval.php"></a> <a href="http://www.php.net/manual/en/function.intval.php"></a> <a href="http://www.php.net/manual/en/function.time.php"></a> <a href="http://www.php.net/manual/en/function.ceil.php"></a> <a href="http://www.php.net/manual/en/function.mt-rand.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.mcrypt-encrypt.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.sprintf.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.hexdec.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.mcrypt-decrypt.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.time.php"></a> Copy Source | Copy HTML&lt;br/&gt; <font color="#cc6633">&lt;?php</font> &lt;br/&gt; &lt;br/&gt; <font color="#0000ff">class</font> AuthToken {&lt;br/&gt; <font color="#0000ff">private static</font> <font color="#cc6633">$key</font> = <font color="#008000">" "</font> ;&lt;br/&gt; <font color="#0000ff">private static</font> <font color="#cc6633">$iv</font> = <font color="#008000">"    ,       "</font> ;&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">private static function</font> int2char( <font color="#cc6633">$int</font> ) {&lt;br/&gt; <font color="#cc6633">$char</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#cc6633">$hex</font> = sprintf( <font color="#008000">"%08x"</font> , <font color="#cc6633">$int</font> );&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#008000">4</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$char</font> .= chr(hexdec(substr( <font color="#cc6633">$hex</font> , <font color="#cc6633">$i</font> * <font color="#008000">2</font> , <font color="#008000">2</font> )));&lt;br/&gt;        }&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$char</font> ;&lt;br/&gt;    }&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">private static function</font> char2int( <font color="#cc6633">$char</font> ) {&lt;br/&gt; <font color="#cc6633">$int</font> = <font color="#008000">0</font> ;&lt;br/&gt; <font color="#cc6633">$hex</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#008000">4</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$hex</font> .= sprintf( <font color="#008000">"%02x"</font> , ord( <font color="#cc6633">$char</font> { <font color="#cc6633">$i</font> }));&lt;br/&gt;        }&lt;br/&gt; <font color="#cc6633">$int</font> = hexdec( <font color="#cc6633">$hex</font> );&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$int</font> ;&lt;br/&gt;    }&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">public static function</font> create( <font color="#cc6633">$id</font> , <font color="#cc6633">$expire</font> = <font color="#008000">0</font> , <font color="#cc6633">$mode</font> = <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#cc6633">$id</font> = intval( <font color="#cc6633">$id</font> );&lt;br/&gt; <font color="#cc6633">$expire</font> = intval( <font color="#cc6633">$expire</font> );&lt;br/&gt; <font color="#cc6633">$mode</font> = intval( <font color="#cc6633">$mode</font> );&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$id</font> &lt; <font color="#008000">0</font> || <font color="#cc6633">$expire</font> &lt; <font color="#008000">0</font> || <font color="#cc6633">$mode</font> &lt; <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#0000ff">return null</font> ;&lt;br/&gt;        }&lt;br/&gt; &lt;br/&gt; <font color="#cc6633">$info</font> = <font color="#0000ff">array</font> ();&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ] = <font color="#cc6633">$id</font> ;&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] = time();&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] = <font color="#cc6633">$expire</font> ;&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] = <font color="#cc6633">$mode</font> ;&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ] = ceil(mt_rand( <font color="#008000">0</font> , <font color="#008000">255</font> ));&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"sum"</font> ] = <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ];&lt;br/&gt; <font color="#cc6633">$info</font> = self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ]) . self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ]) . self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ]) . chr( <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ]) . chr( <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ]) . self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"sum"</font> ]);&lt;br/&gt; &lt;br/&gt; <font color="#cc6633">$token</font> = mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5(self:: <font color="#cc6633">$key</font> ), <font color="#cc6633">$info</font> , MCRYPT_MODE_OFB, md5(self:: <font color="#cc6633">$iv</font> ));&lt;br/&gt; <font color="#cc6633">$tokenHex</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#cc6633">$tokenLength</font> = strlen( <font color="#cc6633">$token</font> );&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#cc6633">$tokenLength</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$tokenHex</font> .= sprintf( <font color="#008000">"%02x"</font> , ord( <font color="#cc6633">$token</font> { <font color="#cc6633">$i</font> }));&lt;br/&gt;        }&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$tokenHex</font> ;&lt;br/&gt;    }&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">public static function</font> check( <font color="#cc6633">$tokenHex</font> , <font color="#cc6633">$mode</font> = <font color="#0000ff">null</font> ) {&lt;br/&gt; <font color="#cc6633">$token</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#cc6633">$tokenHexLength</font> = strlen( <font color="#cc6633">$tokenHex</font> ) / <font color="#008000">2</font> ;&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#cc6633">$tokenHexLength</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$token</font> .= chr(hexdec(substr( <font color="#cc6633">$tokenHex</font> , <font color="#cc6633">$i</font> * <font color="#008000">2</font> , <font color="#008000">2</font> )));&lt;br/&gt;        }&lt;br/&gt; <font color="#cc6633">$info</font> = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, md5(self:: <font color="#cc6633">$key</font> ), <font color="#cc6633">$token</font> , MCRYPT_MODE_OFB, md5(self:: <font color="#cc6633">$iv</font> ));&lt;br/&gt; <font color="#0000ff">if</font> (strlen( <font color="#cc6633">$info</font> ) == <font color="#008000">18</font> ) {&lt;br/&gt; <font color="#cc6633">$info</font> = <font color="#0000ff">array</font> ( <font color="#008000">"id"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">0</font> , <font color="#008000">4</font> )), <font color="#008000">"time"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">4</font> , <font color="#008000">4</font> )), <font color="#008000">"expire"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">8</font> , <font color="#008000">4</font> )), <font color="#008000">"mode"</font> =&gt; ord( <font color="#cc6633">$info</font> { <font color="#008000">12</font> }), <font color="#008000">"rnd"</font> =&gt; ord( <font color="#cc6633">$info</font> { <font color="#008000">13</font> }), <font color="#008000">"sum"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">14</font> , <font color="#008000">4</font> )));&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"sum"</font> ] == <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ]) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] &gt; <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] + <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] &lt; time()) {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;                    }&lt;br/&gt;                }&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] &gt; <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$mode</font> !== <font color="#0000ff">null</font> ) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] != <font color="#cc6633">$mode</font> ) {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;                        }&lt;br/&gt;                    }&lt;br/&gt;                }&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ];&lt;br/&gt;            } <font color="#0000ff">else</font> {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;            }&lt;br/&gt;        } <font color="#0000ff">else</font> {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt; &lt;br/&gt; <font color="#cc6633">?&gt;</font> &lt;br/&gt; &lt;br/&gt; <br></font></code></code> </blockquote> <code><code><a href="http://s-c.me/10276/s"></a> <a href="http://s-c.me/10276/h"></a> <a href="http://www.php.net/manual/en/function.sprintf.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.hexdec.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.sprintf.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.hexdec.php"></a> <a href="http://www.php.net/manual/en/function.intval.php"></a> <a href="http://www.php.net/manual/en/function.intval.php"></a> <a href="http://www.php.net/manual/en/function.intval.php"></a> <a href="http://www.php.net/manual/en/function.time.php"></a> <a href="http://www.php.net/manual/en/function.ceil.php"></a> <a href="http://www.php.net/manual/en/function.mt-rand.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.mcrypt-encrypt.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.sprintf.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.chr.php"></a> <a href="http://www.php.net/manual/en/function.hexdec.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.mcrypt-decrypt.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.ord.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.time.php"></a> <font color="black">Copy Source | Copy HTML&lt;br/&gt; <font color="#cc6633">&lt;?php</font> &lt;br/&gt; &lt;br/&gt; <font color="#0000ff">class</font> AuthToken {&lt;br/&gt; <font color="#0000ff">private static</font> <font color="#cc6633">$key</font> = <font color="#008000">" "</font> ;&lt;br/&gt; <font color="#0000ff">private static</font> <font color="#cc6633">$iv</font> = <font color="#008000">"    ,       "</font> ;&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">private static function</font> int2char( <font color="#cc6633">$int</font> ) {&lt;br/&gt; <font color="#cc6633">$char</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#cc6633">$hex</font> = sprintf( <font color="#008000">"%08x"</font> , <font color="#cc6633">$int</font> );&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#008000">4</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$char</font> .= chr(hexdec(substr( <font color="#cc6633">$hex</font> , <font color="#cc6633">$i</font> * <font color="#008000">2</font> , <font color="#008000">2</font> )));&lt;br/&gt;        }&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$char</font> ;&lt;br/&gt;    }&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">private static function</font> char2int( <font color="#cc6633">$char</font> ) {&lt;br/&gt; <font color="#cc6633">$int</font> = <font color="#008000">0</font> ;&lt;br/&gt; <font color="#cc6633">$hex</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#008000">4</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$hex</font> .= sprintf( <font color="#008000">"%02x"</font> , ord( <font color="#cc6633">$char</font> { <font color="#cc6633">$i</font> }));&lt;br/&gt;        }&lt;br/&gt; <font color="#cc6633">$int</font> = hexdec( <font color="#cc6633">$hex</font> );&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$int</font> ;&lt;br/&gt;    }&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">public static function</font> create( <font color="#cc6633">$id</font> , <font color="#cc6633">$expire</font> = <font color="#008000">0</font> , <font color="#cc6633">$mode</font> = <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#cc6633">$id</font> = intval( <font color="#cc6633">$id</font> );&lt;br/&gt; <font color="#cc6633">$expire</font> = intval( <font color="#cc6633">$expire</font> );&lt;br/&gt; <font color="#cc6633">$mode</font> = intval( <font color="#cc6633">$mode</font> );&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$id</font> &lt; <font color="#008000">0</font> || <font color="#cc6633">$expire</font> &lt; <font color="#008000">0</font> || <font color="#cc6633">$mode</font> &lt; <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#0000ff">return null</font> ;&lt;br/&gt;        }&lt;br/&gt; &lt;br/&gt; <font color="#cc6633">$info</font> = <font color="#0000ff">array</font> ();&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ] = <font color="#cc6633">$id</font> ;&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] = time();&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] = <font color="#cc6633">$expire</font> ;&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] = <font color="#cc6633">$mode</font> ;&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ] = ceil(mt_rand( <font color="#008000">0</font> , <font color="#008000">255</font> ));&lt;br/&gt; <font color="#cc6633">$info</font> [ <font color="#008000">"sum"</font> ] = <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ];&lt;br/&gt; <font color="#cc6633">$info</font> = self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ]) . self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ]) . self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ]) . chr( <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ]) . chr( <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ]) . self::int2char( <font color="#cc6633">$info</font> [ <font color="#008000">"sum"</font> ]);&lt;br/&gt; &lt;br/&gt; <font color="#cc6633">$token</font> = mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5(self:: <font color="#cc6633">$key</font> ), <font color="#cc6633">$info</font> , MCRYPT_MODE_OFB, md5(self:: <font color="#cc6633">$iv</font> ));&lt;br/&gt; <font color="#cc6633">$tokenHex</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#cc6633">$tokenLength</font> = strlen( <font color="#cc6633">$token</font> );&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#cc6633">$tokenLength</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$tokenHex</font> .= sprintf( <font color="#008000">"%02x"</font> , ord( <font color="#cc6633">$token</font> { <font color="#cc6633">$i</font> }));&lt;br/&gt;        }&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$tokenHex</font> ;&lt;br/&gt;    }&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">public static function</font> check( <font color="#cc6633">$tokenHex</font> , <font color="#cc6633">$mode</font> = <font color="#0000ff">null</font> ) {&lt;br/&gt; <font color="#cc6633">$token</font> = <font color="#008000">""</font> ;&lt;br/&gt; <font color="#cc6633">$tokenHexLength</font> = strlen( <font color="#cc6633">$tokenHex</font> ) / <font color="#008000">2</font> ;&lt;br/&gt; <font color="#0000ff">for</font> ( <font color="#cc6633">$i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$i</font> &lt; <font color="#cc6633">$tokenHexLength</font> ; <font color="#cc6633">$i</font> ++) {&lt;br/&gt; <font color="#cc6633">$token</font> .= chr(hexdec(substr( <font color="#cc6633">$tokenHex</font> , <font color="#cc6633">$i</font> * <font color="#008000">2</font> , <font color="#008000">2</font> )));&lt;br/&gt;        }&lt;br/&gt; <font color="#cc6633">$info</font> = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, md5(self:: <font color="#cc6633">$key</font> ), <font color="#cc6633">$token</font> , MCRYPT_MODE_OFB, md5(self:: <font color="#cc6633">$iv</font> ));&lt;br/&gt; <font color="#0000ff">if</font> (strlen( <font color="#cc6633">$info</font> ) == <font color="#008000">18</font> ) {&lt;br/&gt; <font color="#cc6633">$info</font> = <font color="#0000ff">array</font> ( <font color="#008000">"id"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">0</font> , <font color="#008000">4</font> )), <font color="#008000">"time"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">4</font> , <font color="#008000">4</font> )), <font color="#008000">"expire"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">8</font> , <font color="#008000">4</font> )), <font color="#008000">"mode"</font> =&gt; ord( <font color="#cc6633">$info</font> { <font color="#008000">12</font> }), <font color="#008000">"rnd"</font> =&gt; ord( <font color="#cc6633">$info</font> { <font color="#008000">13</font> }), <font color="#008000">"sum"</font> =&gt; self::char2int(substr( <font color="#cc6633">$info</font> , <font color="#008000">14</font> , <font color="#008000">4</font> )));&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"sum"</font> ] == <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"rnd"</font> ] - <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ]) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] &gt; <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"expire"</font> ] + <font color="#cc6633">$info</font> [ <font color="#008000">"time"</font> ] &lt; time()) {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;                    }&lt;br/&gt;                }&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] &gt; <font color="#008000">0</font> ) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$mode</font> !== <font color="#0000ff">null</font> ) {&lt;br/&gt; <font color="#0000ff">if</font> ( <font color="#cc6633">$info</font> [ <font color="#008000">"mode"</font> ] != <font color="#cc6633">$mode</font> ) {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;                        }&lt;br/&gt;                    }&lt;br/&gt;                }&lt;br/&gt; <font color="#0000ff">return</font> <font color="#cc6633">$info</font> [ <font color="#008000">"id"</font> ];&lt;br/&gt;            } <font color="#0000ff">else</font> {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;            }&lt;br/&gt;        } <font color="#0000ff">else</font> {&lt;br/&gt; <font color="#0000ff">return false</font> ;&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt; &lt;br/&gt; <font color="#cc6633">?&gt;</font> &lt;br/&gt; &lt;br/&gt;</font></code> <br></code> <br>  <b>The keys self :: $ key and self :: $ iv, for security reasons, are best kept away from the algorithm.</b> <br><br>  (string) AuthToken :: create ($ id, $ expire = 0, $ mode = 0) <br>  Creates a key. <br><br>  (mixed) AuthToken :: check ($ tokenHex, $ mode = null) <br>  Checks the validity of the key.  In case of successful verification returns the user ID, otherwise the logical FALSE. <br><br>  If you do not specify $ expire and / or $ mode - they will not be taken into account when checking the key.  If you do not specify $ mode when checking - it will also not be taken into account. <br><br><h4>  If nothing helps? </h4><br>  Such a solution is not suitable if you need a one-time key.  But it can be solved with small crutches.  For example, setting the check key of such a key in memchache in combination with a limited key validity time will give the desired result in most cases. <br><br>  Well, then - either a fantasy or a database. </div><p>Source: <a href="https://habr.com/ru/post/109421/">https://habr.com/ru/post/109421/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../109413/index.html">Viacom appeals against YouTube</a></li>
<li><a href="../109414/index.html">Master class "Effective automation of testing Java UI. Jemmy library ¬ª</a></li>
<li><a href="../109417/index.html">Goodbye, ViewState - 2, or To the base of it!</a></li>
<li><a href="../109418/index.html">ASP.NET Profiler Overview</a></li>
<li><a href="../109419/index.html">Opera Habragosti: Past, Present and Future of Opera</a></li>
<li><a href="../109424/index.html">Notion Ink Adam or why am I waiting for the New Year</a></li>
<li><a href="../109425/index.html">Base of all settlements and regions of Russia</a></li>
<li><a href="../109426/index.html">NewsWave.com.ua: Reader of Ukrainian news. Theory and practice</a></li>
<li><a href="../109427/index.html">Leningrad NPP from the inside</a></li>
<li><a href="../109428/index.html">Hg Init: Part 6. Repository Architecture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>