<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Open lesson "Feature Engineering on the example of the classic dataset of the Titanic"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello again! 

 In December, we will start training the next Data Scientist group , so there are more and more open lessons and other activities. For ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Open lesson "Feature Engineering on the example of the classic dataset of the Titanic"</h1><div class="post__text post__text-html js-mediator-article">  Hello again! <br><br>  In December, we will start training the next <a href="https://otus.pw/hm0k/">Data Scientist group</a> , so there are more and more open lessons and other activities.  For example, just recently, a webinar was held under the long title ‚ÄúFeature Engineering on the example of the classic Titanic dataset‚Äù.  It was conducted by <a href="https://otus.pw/rMgh/">Alexander Sizov</a> - an experienced developer, Ph.D., an expert on Machine / Deep learning and a participant in various commercial international projects related to artificial intelligence and data analysis. <br><br>  Open lesson took about one and a half hours.  During the webinar, the teacher spoke about the selection of signs, the transformation of the source data (coding, scaling), setting parameters, training the model and much more.  In the course of the lesson, the participants were shown a Jupyter Notebook.  Open source data from the <a href="https://www.kaggle.com/c/titanic">Kaggle</a> platform (a classic dataset about ‚ÄúTitanic‚Äù, from which many begin their acquaintance with Data Science) was used for work.  Below we offer a video and transcript of the past event, and <a href="https://otus.ru/media/12/48/features-1801-1248d1.ipynb%3Ffilename%3Dfeatures.ipynb">here</a> you can pick up the presentation and codes in the Jupiter's laptop. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/tOAAwpK2O80" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>  <b>Feature selection</b> <b><br></b> <br>  The topic was chosen, although classical, but still a bit gloomy.  In particular, it was necessary to solve the problem of binary classification and predict according to the available data whether a passenger will survive or not.  The data itself was divided into two samples, Training and Test.  The key variable is Survival (survived / not survived; 0 = No, 1 = Yes). <br><br>  Input training data: <br><br><ol><li>  ticket class; </li><li>  age and sex of the passenger; </li><li>  marital status (are there any relatives on board); </li><li>  ticket price; </li><li>  cabin number; </li><li>  port of landing. </li></ol><br>  As you can see, the types of variables are different: numeric, text.  From this kaleidoscope it was necessary to form a dataset for the upcoming training of the model. <br><br>  We summarize: <br><br><ul><li>  train.csv - training set - training data set.  They know the answer - survival - binary sign 0 (did not survive) / 1 (survived); </li><li>  test.csv - test set - test data set.  The answer is unknown.  This is a sample to send to the kaggle platform to calculate the model quality metric; </li><li>  gender_submission.csv is an example of the format of the data that needs to be sent to kaggle. </li></ul><br>  Work algorithm <br><br><ol><li>  The work took place in stages: </li><li>  Analyze data from train.csv. </li><li>  Handling missing values. </li><li>  Scaling. </li><li>  Coding categorical traits. </li><li>  Building a model and selecting parameters, choosing the best model on the converted data from train.csv. </li><li>  Fixation of the transformation method and model. </li><li>  Apply the same transformations on test.csv using the pipeline. </li><li>  Apply the model to test.csv. </li><li>  Saving to the file the results of the application in the same format as in gender_submission.csv. </li><li>  Sending results to the kaggle platform. </li></ol><br>  <b>The practical part of the webinar</b> <br><br>  The first thing that needed to be done was to read the dataset and display our data on the screen: <br><br><img src="https://habrastorage.org/webt/eu/7p/vm/eu7pvmx66rypokyjafuw8kmyn3k.png"><br><br>  For data analysis, a little-known but quite useful profiling library was used: <br> <code>pandas_profiling.ProfileReport(df_train)</code> <br> <br>  <b>Read more about profiling</b> <br><br>  This library does everything that can be done a priori without knowing the details about the data.  For example, display statistics on data (how many variables and what type they are, how many lines, missing values, etc.).  Moreover, separate statistics are given for each variable with the reduction of the minimum and maximum, the distribution graph, and other parameters. <br><br>  As you know, in order to make a good model, you need to understand the process that we are trying to model and understand which features are key.  And by no means always in our data there is everything that is needed, or, more precisely, almost never they lack all the necessary, fully determining and determining our process.  As a rule, we always need to combine something, perhaps, to add additional features that are not represented in the dataset (say, the weather forecast).  It is to understand the process and need data analysis, which can be done using the profiling library. <br><br>  <b>Missing values</b> <br><br>  The next step is to solve the problem of missing values, because in most cases the data is not completely filled. <br>  There are the following solutions to this problem: <br><br><ul><li>  delete rows with missing values ‚Äã‚Äã(you need to consider that you can lose some important values); </li><li>  remove the sign (relevant if there is too little data on it); </li><li>  replace missing values ‚Äã‚Äãwith something else (median, average ...). </li></ul><br>  An example of a simple conversion using the fillna method, which assigns the values ‚Äã‚Äãof the median variable to only those cells that are not filled: <br><br><img src="https://habrastorage.org/webt/sj/ir/yl/sjirylzgnphmwoba3e2jnnicflc.png"><br><br>  In addition, the teacher showed examples of using Imputer and pipeline. <br><br>  <b>Feature scaling</b> <br><br>  The work of the model and the final decision depends on the scale of the signs.  The fact is that it is not a fact that any sign, which has a larger scale, is more important than a sign, which has a smaller scale.  That is why models need to submit attributes that are scaled in the same way, that is, having the same weight for the model. <br><br>  There are different scaling techniques, but the format of the open lesson allowed us to consider in more detail only two of them: <br><br><img src="https://habrastorage.org/webt/jj/jm/h_/jjjmh_mkrlg5n73lo9l5nabgl7q.png"><br><br>  <b>Combinations of signs</b> <br><br>  Combinations of existing features using arithmetic operations (sum, multiplication, division) allow to obtain any feature that makes the model more efficient.  This is not always possible, and we do not know which combination will give the desired effect, but practice shows that it makes sense to try.  It is convenient to apply transformations of signs using the pipeline. <br><br>  <b>Coding</b> <br><br>  So, we have data of different types: numeric and text.  Currently, most models on the market cannot work with textual data.  As a result, all categorical features (textual) must be converted to a numerical representation, for which encoding is used. <br><br>  <b>Label encoding</b> .  This is the mechanism implemented in many libraries, which can be called and applied: <br><br><img src="https://habrastorage.org/webt/tf/xd/kh/tfxdkh3eypfrqjuihl4w_60vfzq.png"><br><br>  Label encoding assigns a unique identifier to each unique value.  Minus - we bring order into some variable that was not ordered, which is not good. <br><br>  <b>OneHotEncoder.</b>  Unique text variable values ‚Äã‚Äãare expanded as columns, which are added to the source data, where each column is a binary variable in the form of 0 and 1. This approach has no disadvantages of Label encoding, but has its own minus: if there are many unique values, we add too many columns and in some cases the method is simply not applicable (it increases too much). <br><br>  <b>Model training</b> <br><br>  After performing the above actions, a final pipeline is drawn up with a set of all necessary operations.  Now it is enough to take the source dataset and apply the final pipeline on this data using the fit_transform operation: <br> <code>x_train = vec.fit_transform(df_train)</code> <br> <br>  As a result, we get dataset x_train, which is ready for use in the model.  The only thing that needs to be done is to separate the value of our target variable so that we can conduct the training. <br><br>  Next, select the model.  As part of the webinar, the teacher proposed a simple logistic regression.  The model was trained using the fit operation, which resulted in a model in the form of a logistic regression with certain parameters: <br><br><img src="https://habrastorage.org/webt/xs/tc/dc/xstcdche3jydmlahruszn6txahi.png"><br><br>  In practice, in practice, several models are usually used that seem to be the most effective.  And the final solution is often a combination of these models with the help of stacking techniques and other approaches to the ensemble of models (using several models within one hybrid model). <br><br>  After training, the model can be applied on test data, assessing its quality within a metric.  In our case, the quality within accuracy_score was 0.8: <br><br><img src="https://habrastorage.org/webt/ka/ut/dj/kautdjopfjqa1dbgkii10wptcfs.png"><br><br>  This means that on the received data the variable is correctly predicted in 80% of cases.  Having obtained the learning results, we can either improve the model (if the accuracy is not satisfactory), or go directly to the forecast. <br><br>  This was the end of the main topic of the lesson, but the teacher told in more detail about the features of using the model in different tasks and answered questions from the audience.  So if you do not want to miss anything, watch the webinar completely if you are interested in this topic. <br><br>  As always, we are waiting for your comments and questions that you can leave here or ask <a href="https://otus.pw/rMgh/">Alexander</a> about them by visiting him on an <a href="https://otus.pw/MPxK/">open day.</a> </div><p>Source: <a href="https://habr.com/ru/post/433084/">https://habr.com/ru/post/433084/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../433074/index.html">Switching to Kotlin in the Android project: Tips and Tricks</a></li>
<li><a href="../433076/index.html">How we made our Android Gallery library to view media content</a></li>
<li><a href="../433078/index.html">We write trading robots using the StockSharp graphic framework. Part 2</a></li>
<li><a href="../433080/index.html">Pocket OLAP in Javascript and IndexedDB Performance</a></li>
<li><a href="../433082/index.html">Bleeding someone else's accounts has become a criminal offense in South Korea</a></li>
<li><a href="../433086/index.html">Tinkoff and everything, everything, everything: IoT, analytics and observation for banks</a></li>
<li><a href="../433088/index.html">How do you like it, Ilon Musk: BMW and Porsche have developed a charge that adds 100 km of travel in 3 minutes</a></li>
<li><a href="../433090/index.html">Oracle Bitmap Index Techniques</a></li>
<li><a href="../433092/index.html">Level 80 CG-modeling: photorealistic real-time characters in Unreal</a></li>
<li><a href="../433094/index.html">Numerical modeling in a large industrial company</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>