<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Evolution of Zeus. Part II</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Start here . 

 File infector 
 The idea of ‚Äã‚Äãinfecting files was developed in the PE_LICAT malware detected by Trend Micro in October 2010. PE_LICAT ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Evolution of Zeus. Part II</h1><div class="post__text post__text-html js-mediator-article">  Start <a href="http://habrahabr.ru/post/161707/">here</a> . <br><br><h4>  <b>File infector</b> </h4><br>  The idea of ‚Äã‚Äãinfecting files was developed in the PE_LICAT malware detected by Trend Micro in October 2010.  PE_LICAT is an advanced Zeus dropper, its main function is to download and launch new Zeus files from remote servers.  1771 bytes of malicious code are embedded in executable files.  PE_LICAT uses the same mechanisms as Zeus 2.1.0.10 - DGA with the same algorithm and signature verification procedure for the file being downloaded.  A detailed description of the DGA is provided in the Trend Micro report <a href="http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp__file-partching-zbot-varians-zeus-2-9.pdf">‚ÄúFile-Patching ZBOT Variants‚Äù</a> pdf, eng). <br><br>  In short, DGA uses the hash creation function from the Windows Crypto API.  The list of domains was formed at launch using a special algorithm by hashing the current date and minute (the hour was not used).  By the way, many sources erroneously write 800 or 1020 unique domains (these constants are actually used in the algorithm).  In fact, there were only 60 per day (the minutes were multiplied by 17 and the remainder of the division by 1020, 1020/17 = 60 was taken).  The hashes were translated into ASCII codes and the prefixes of the top-level domains .biz, .info, .org, .com, .net, and the string / forum were added to them.  It should be noted that PE_LICAT is not a virus in the direct sense of the word (as it is classified by Kaspersky Lab) - it is not able to independently infect files.  The launch of the file infection procedure initiates Zeus from the 2.1 family, called TSPY_ZBOT.BYZ in the Trend Micro classification. <br><a name="habracut"></a><br>  The complete distribution cycle looked like this: <br>  TSPY_ZBOT.BYZ is launched (automatically by visiting the site or as a result of updating with a previous version of Zeus); <br>  TSPY_ZBOT.BYZ gets PE_LICAT out of itself; <br>  TSPY_ZBOT.BYZ infects executable files (including on removable media) with PE_LICAT. <br>  In the future, TSPY_ZBOT.BYZ and PE_LICAT downloaded the Zeus version TSPY_ZBOT.SMEQ file (according to Trend Micro classification) from the domains created by DGA. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>Zeus followers</b> </h4><br>  Despite the announcement of Slavik about the <a href="http://habrahabr.ru/post/113356">transfer of the entire code</a> , the source code of Zeus 2.0.8.9, since February 2011, has been offered for sale.  In the end, in May 2011, the source codes of this version leaked to free access.  Some files were missing from the source archive: <br><br><ul><li>  peinfector.cpp; </li><li>  peinfector.h; </li><li>  peloader32.asm; </li><li>  worm.cpp; </li><li>  worm.h. </li></ul><br>  It is assumed that this is the PE_LICAT module (Murofet). <br><br>  Naturally, immediately there were people who wanted to continue what they started on the basis of these sources.  For example, we can mention the project <a href="http://www.securelist.com/ru/blog%3Fprint_mode%3D1%26weblogid%3D40696">‚ÄúICE IX‚Äù</a> (named as a virus from the movie ‚ÄúRecruit‚Äù?), Which did not offer anything new and was an attempt to make money on a well-known name.  But a ‚Äúworthy‚Äù follower was found, this is a Citadel project.  Its key feature was the creation of an online platform organized on the principle of a social network.  Here, customers can request new features, report errors and add their own modules, which makes the development process a kind of opensource project.  A customer support system is also organized, which is reflected in the ongoing support of Citadel in its current state.  Thus, the authors report that they are striving to make the Citadel update cycle less than the release cycle of new anti-virus databases, which allows for a long time not to be detected on the infected computer.  According to the developers, Citadel has corrected all the flaws in earlier versions of Zeus, including the data collection module when working in Google Chrome.  In addition, the ability to record and transfer video was added. <br><br>  For the first time, a botnet based on Citadel was discovered in December 2011 by researchers at Securlet, now the number of botnets based on Citadel is in the tens. <br><br>  Then the basic package Citadel was sold for $ 2399, the price of the "rent" was $ 125 per month, additional modules are purchased separately.  For example, $ 395 is a module that allows the bot to update automatically.  Updates are distributed via Jabber, each update costs $ 15. <br><br>  In October 2012, Citadel version 1.3.4.5 (bot designer and control panel) was seen in the public domain.  Perhaps this version leak is a kind of advertising campaign, since this month a new version of Citadel 1.3.5.1 ‚ÄúRain Edition‚Äù was released.  The user manual for this version is available <a href="http://www.xylibox.com/2012/10/citadel-1351-rain-edition.html">on the XyliBox</a> personal <a href="http://www.xylibox.com/2012/10/citadel-1351-rain-edition.html">blog</a> , from which you can learn more about the features, innovations, installation and configuration of individual modules.  The price of the basic kit of the latest version is $ 3,391, which is 41% more than the original price a year ago.  As before, monthly rent and modules are paid separately. <br><br>  Of the latest "high-profile" events, we can note the discovery of a Citadel bot modified by Trusteer company in August 2012, modified to attack the airport infrastructure.  With Citadel, attackers can gain control over a secure VPN connection between airport PCs operating remotely and computer system interfaces designed to support airport operations.  What kind of airport was the target of the attack is not reported.  The attack is carried out as follows - first, the password and user name are intercepted, entered into the VPN connection form.  Next, a simplified one-factor authentication mode is used instead of two-factor authentication (by clicking on the ‚ÄúGet Image‚Äù button).  As a result, instead of confirmation by SMS, the user will be shown a picture (verification code) with ten digits.  The user then matches his password with a string of numbers in the image to create a ‚Äúone-time‚Äù password.  Thus, getting the numbers from the verification image (by screenshots) and the password, as well as knowing the algorithm for generating the ‚Äúone-time‚Äù password, you can easily calculate it and enter the system. <br><br>  An interesting fact is that if the Russian or Ukrainian keyboard layout is used on the attacked computer, Citadel is automatically deactivated.  Earlier it was noted that the Zeus family is being developed by Russian-language programmers.  What really drives the creators is either a kind of ‚Äúpatriotism‚Äù, or because of the reluctance to get in the field of view of domestic law enforcement agencies (as it is known, the legal norms of the country where the crime occurred are applied to criminals).  On the other hand, the spread of Internet banking and electronic payment systems via the Internet in Russia is delayed compared to Western countries, so the spread of banking Trojan programs would not have a large financial return. <br><br><h4>  <b>Zeus, version 3 - Gameover</b> </h4><br>  In version 2.1 of Zeus, an attempt was made to get away from the hard-coded command center and the transition to a more protected from the actions of antivirus companies control system (using DGA).  As it turned out, the creators of Zeus continued their research in this area. <br><br>  In October 2011, Roman Hussy, the creator of <a href="http://zeustracker.abuse.ch/">ZeusTracker</a> , while investigating the latest version of Zeus, noticed the presence of strange UDP traffic.  Further analysis <a href="http://www.abuse.ch/%3Fp%3D3499">showed</a> that the new version of Zeus had several IP addresses in the configuration block, and computers with these IPs responded to the infected system.  Within 24 hours, about 100,000 unique IP addresses were identified with which the new modification was associated.  Most of the infected computers were located in India, Italy and the USA.  So it was found that Zeus switched to using the P2P update mechanism itself and its configuration data blocks.  Due to the use of the script name gameover.php when contacting the command center, the name Gameover Zeus is used for this version.  This is quite symbolic - as you can see, the ‚Äúgames‚Äù with Zeus are long over. <br><br>  The mechanism of Zeus P2P (ZP2P) was based on the Kademlia protocol.  The computer (node) in the ZP2P network was identified by a unique identifier (UID) that was created during the first run.  Each instance of Zeus in the ZP2P had a ‚Äúneighbor table‚Äù stored in memory.  This array contains a list of about 30 neighbors in a ZP2P network ‚Äî their UID, IP address, and UDP port number.  The ZP2P network used several types of connections: <br><br><ul><li>  to exchange information about the version of the configuration data block (UDP); </li><li>  to exchange information about the nodes in the "table of neighbors" (UDP); </li><li>  for the exchange of binary data - the main module and configuration data blocks (using the TCP protocol). </li></ul><br>  DGA has undergone some changes, in particular, the top-level domains became 6 - ru, com, biz, info, org, net ( <a href="http://www.cert.pl/news/4711/langswitch_lang/en">source</a> ).  DGA was used as a ‚Äúsafety‚Äù option if the connection could not be established by means of ZP2P.  In the end, configuration data blocks were distributed only through ZP2P, which made it difficult to identify control centers.  By the way, the control centers are now more a repository of stolen information and statistics, than a panel to give commands to bots. <br><br>  In February 2012, researchers at Symantec <a href="http://www.symantec.com/connect/blogs/zeusbotspyeye-p2p-updated-fortifying-botnet">discovered</a> another version of Zeus using the ZP2P.  This modification contained the built-in web-server based on Nginx.  Communication protocols in ZP2P have begun to use only UDP, to make it difficult to track Zeus data flows.  Now the bot was able to download executable files via HTTP from other bots.  Thus, each bot could act as a kind of command center or act as an intermediary (proxy) in the control chain.  The same technique was used in the Waledac / Kelihos botnet version C, which revived in early 2012 - two years after it was closed with the help of Microsoft and a number of antivirus companies in 2010. <br><br>  Interestingly, the ZP2P botnet was used to distribute two third-party malware - a fake antivirus and a proxy server, which Zeus hadn‚Äôt noticed before.  In order to assess the distribution of this version of Zeus, Symantec specialists <a href="http://www.secureworks.com/cyber-threat-intelligence/threats/The_Lifecycle_of_Peer_to_Peer_Gameover_ZeuS">monitored the</a> performance of the ZP2P network.  In the period from April to July 2012, 678,205 unique UIDs and 1,570,871 unique IPs were recorded.  Not all of the IP data was available, which is explained by being behind a firewall or nat.  In addition, Internet providers use a pool of dynamic addresses, so a single IP address from a pool range could be assigned to the same UID.  The largest number of infections occurred in the United States (29.2%). <br><br>  As before, the main source of infection was email containing links to malicious sites, most often redirecting browser requests for BlackHole exploit packs.  Due to this, the installation of malware occurs without any user action (except for viewing the infected page).  But this time, BlackHole did not download P2P Zeus itself onto computers, but Trojan downloader Pony.  Pony is another crimeware, the main function of which is to download and launch malware bypassing anti-virus protection.  Pony has its own admin panel, which displays the statistics of successful downloads and launches.  Thus, the installation of P2P Zeus was made as follows: <br><br><ul><li>  the user receives an email with a link to the malicious site; </li><li>  going to this site, BlackHole initiates the launch of the Pony loader on the user's computer; </li><li>  Pony communicates with his command servers and receives instructions from him to download the Zeus file itself (from three different servers). </li></ul><br>  As you can see, the developers of Zeus have done a great job of improving the management of their ‚Äúbrainchild‚Äù.  Management mechanisms went through several stages in their development: <br><br><ul><li>  hard-coded servers (ver 1 and 2); </li><li>  using DGA to refer to dynamically generated domain names (ver 2.1 or 2+); </li><li>  DGA and hybrid P2P scheme, where the bots were communicating between themselves and the server (version 3 or Gameover Zeus). </li></ul><br>  Continued <a href="http://habrahabr.ru/post/247265/">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/161861/">https://habr.com/ru/post/161861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../161849/index.html">Framework in Marmalade (part 2)</a></li>
<li><a href="../161853/index.html">The shortest overview of the mechanical keyboard Matias Tactile Pro 4.0</a></li>
<li><a href="../161855/index.html">Bitcoin has an official bank</a></li>
<li><a href="../161857/index.html">The need for proper goal setting</a></li>
<li><a href="../161859/index.html">Inferno Shell</a></li>
<li><a href="../161863/index.html">STM32 + linux</a></li>
<li><a href="../161865/index.html">Windows Store opened in Ukraine</a></li>
<li><a href="../161867/index.html">‚ÄúQuote‚Äù button for iOs</a></li>
<li><a href="../161875/index.html">Simple technique Parallax Scrolling</a></li>
<li><a href="../161877/index.html">Creating a link resolution plugin for PhpStorm (IntelliJ IDEA)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>