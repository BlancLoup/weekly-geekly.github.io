<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Install, configure and use WPKG</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="More recently, I watched as IT experts everywhere tried to implement open source software, while management resisted and demanded the use of Microsoft...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Install, configure and use WPKG</h1><div class="post__text post__text-html js-mediator-article">  More recently, I watched as IT experts everywhere tried to implement open source software, while management resisted and demanded the use of Microsoft products.  Unlicensed products, but nonetheless.  Now, I increasingly see the opposite: management requires the introduction of open source software, and IT departments beat out budget expansion for purchasing licenses.  The reasons for the changed views of the management are clear - these are regular police raids that do not allow the use of the stolen, and the successful introduction of open source software in other companies, and the ability to save a lot of money.  I am talking now, first of all, about the popular Microsoft Office replacement with Outlook'om bundled on OpenOffice.org and Mozilla Thunderbird. <br><br>  But what is the reason for the decline in interest in open source software from IT specialists?  Accompanying.  If the management at the meeting hour for the hour before the end of the working day made a decision that requires changing the software settings on all workstations by the next morning, in a homogeneous MS software environment, the admin simply needs to launch the ‚ÄúManage Group Policy Management‚Äù snap-in, make a few clicks and go home.  Software not from Microsoft is usually not configured by politicians ... And the admin "ran" over a hundred workstations.  At home, the mother / wife / children / dog again in the corner shat (underline the necessary).  Or, for example, the Thunderbird update.  WSUS does not download, it does not spread across workstations and will not install itself.  This is updated every month. <br><br>  Well, if the admin likes to reinvent the wheel.  Even better if you can.  Then, under all non-updated and non-customizable crutches are being built and it is all shaky, but worth it.  Until the admin quits.  Then usually with a crash crashes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It's great when there is a fighter.  Young and with strong legs.  The routine task is written to the fighter, and the fighter performs it, replacing both the GPO, WSUS, and many other useful pieces. <br><br>  These are not our methods.  We want a rational use of labor resources, standardization of infrastructure and transparent IT business processes.  Therefore, the settings and updates will be distributed centrally.  Using WPKG.  It is strange that on Habr√© there was not a single article about him. <br><a name="habracut"></a><br><br>  WPKG is a WSH script, a set of xml configuration files and a client service that periodically executes this very script.  You can do without the client part, but I will describe a typical solution. <br><br>  The implementation object is a company with three offices and 112 workstations.  Of these, 6 are running 64-bit Windows 7, 4 are running Windows XP, 63 are running Windows Vista and the rest are running Windows 7. Every office has a server with WSUS on board - SRV-1, SRV-2, SRV -3.  That's right next to WSUS, and we will be building WPKG. <br><br>  First of all, we create a WPKG directory and a corresponding WPKG $ network folder with read access for everyone on each server.  Download <a href="">wpkg.org/files/stable/1.3.x/wpkg-1.3.0-bin.zip</a> and unpack it into the above directories.  In the same directories, I created software and client subdirectories.  The first is for software distributions that we will install and update - UltraVNC, Thunderbird and OpenOffice.  The second for the WPKG client side. <br><br><h5>  WPKG Client </h5><br>  The client part of WPKG is a Windows service that starts every time the computer boots and executes wpkg.js from the network folder specified in the settings.  Everything is very simple. <br><br>  Download the client installation package <a href="http://wpkg.org/Download">from here</a> and put it in the appropriate directory - client.  There you also need to put the client configuration file - settings.xml.  But first you need to do it.  To do this, you need to install the client, run C: \ Program Files \ wpkg \ wpkginst.exe, fill in the fields and click the ‚ÄúExport settings‚Äù button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/95d/4c5/444/95d4c5444876bc485c3e387facdaa960.png" alt="image"><br><br>  I got something like this: <br><blockquote>  <font color="#009900"><font color="#000000">&lt;? xml</font> <font color="#000066">version</font> = <font color="#ff0000">"1.0"</font> <font color="#000066">encoding</font> = <font color="#ff0000">"UTF-8"</font> <font color="#000000">?&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;configuration <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;file <font color="#000000">&gt;</font></font></font> \\ SRV-1 \ WPKG $ \ wpkg.js <font color="#009900"><font color="#000000">&lt;/ file <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;net-use-machine-account <font color="#000000">&gt;</font></font></font> YES <font color="#009900"><font color="#000000">&lt;/ net-use-machine-account <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;exec-user <font color="#000000">&gt;</font></font></font> SYSTEM <font color="#009900"><font color="#000000">&lt;/ exec-user <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;exec-password</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;parameters <font color="#000000">&gt;</font></font></font> / synchronize / nonotify / quiet <font color="#009900"><font color="#000000">&lt;/ parameters <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;silent <font color="#000000">&gt;</font></font></font> YES <font color="#009900"><font color="#000000">&lt;/ silent <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;pre-action</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;post-action</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;show-GUI <font color="#000000">&gt;</font></font></font> NO <font color="#009900"><font color="#000000">&lt;/ show-GUI <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;logon-delay <font color="#000000">&gt;</font></font></font> 0 <font color="#009900"><font color="#000000">&lt;/ logon-delay <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;logon-message-title <font color="#000000">&gt;</font></font></font> WPKG Software Deployment <font color="#009900"><font color="#000000">&lt;/ logon-message-title <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;logon-message-logo-picture</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;logon-message-1 <font color="#000000">&gt;</font></font></font> WPKG is installing applications and applying settings ... <font color="#009900"><font color="#000000">&lt;/ logon-message-1 <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;logon-message-2 <font color="#000000">&gt;</font></font></font> Please wait, don‚Äôt restart or power off your computer ... <font color="#009900"><font color="#000000">&lt;/ logon-message-2 <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;script-variable</font> <font color="#000066">name</font> = <font color="#ff0000">"SOFTWARE"</font> <font color="#000000">&gt;</font></font> \\ SRV-1 \ WPKG $ \ software <font color="#009900"><font color="#000000">&lt;/ script-variable <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;priority <font color="#000000">&gt;</font></font></font> normal <font color="#009900"><font color="#000000">&lt;/ priority <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;stop-service-after-done <font color="#000000">&gt;</font></font></font> NO <font color="#009900"><font color="#000000">&lt;/ stop-service-after-done <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;laptop-mode <font color="#000000">&gt;</font></font></font> NO <font color="#009900"><font color="#000000">&lt;/ laptop-mode <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;server-connecting-method <font color="#000000">&gt;</font></font></font> standard <font color="#009900"><font color="#000000">&lt;/ server-connecting-method <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;server-connecting-ip</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;server-connecting-timeout <font color="#000000">&gt;</font></font></font> 3 <font color="#009900"><font color="#000000">&lt;/ server-connecting-timeout <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;server-connecting-script-timeout <font color="#000000">&gt;</font></font></font> 3 <font color="#009900"><font color="#000000">&lt;/ server-connecting-script-timeout <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;server-connecting-script-file</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;log-file</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;run-on-shutdown <font color="#000000">&gt;</font></font></font> NO <font color="#009900"><font color="#000000">&lt;/ run-on-shutdown <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;shutdown-delay <font color="#000000">&gt;</font></font></font> 10 <font color="#009900"><font color="#000000">&lt;/ shutdown-delay <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;logon-interrupt-password <font color="#000000">&gt;</font></font></font> OJzMGd0PqAMI2Vc = <font color="#009900"><font color="#000000">&lt;/ logon-interrupt-password <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;repeat-count-on-failure <font color="#000000">&gt;</font></font></font> 0 <font color="#009900"><font color="#000000">&lt;/ repeat-count-on-failure <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ configuration <font color="#000000">&gt;</font></font></font> <br></blockquote><br><br>  The parameters are interesting here - file and script-variable.  The first one indicates what the client part should run.  The second is the client variable, which in our case stores the path to the software repository.  It will come in handy later when writing a configuration for a WPKG server.  In the meantime, you need to create two more copies of the configuration for SRV-2 and SRV-3 and correct the file and script-variable parameters in them accordingly. <br><br>  We will install client part on workstations through <a href="http://support.microsoft.com/kb/816102/en-us">GPO</a> .  In order for the client to be installed with our settings, you will have to create a transformation of the installation package and add the line SETTINGSFILE with the value \\ SRV-1 \ WPKG $ \ client \ settings.xml to the Properties table.  This can be done with <a href="http://support.microsoft.com/kb/255905/ru">Orca</a> .  Naturally, for each server you need to make your transformation file and put it there, in the client directory. <br><br><h5>  Distributions </h5><br>  Prepare a set of distributions.  In the software directory, I created the following directory structure: <br><img src="https://habrastorage.org/getpro/habr/post_images/b21/301/e30/b21301e301f5fe3582675b9308f522c4.png" alt="image"><br><br><h6>  Thunderbird </h6><br>  In the Thunderbird directory, I created two more subdirectories - configuration and extensions.  We put Thunderbird Setup 9.0.1.exe in the root.  In the configuration files all.js and autoconf.cfg (you can read about it <a href="http://habrahabr.ru/blogs/sysadm/101905/">here</a> ).  Thunderbird extensions in extensions should be put unpacked.  You can unpack xpi by the archiver, but I did not bother and just copied the folders from my profile - C: \ Users \% USERNAME% \ AppData \ Roaming \ Thunderbird \ Profiles \ abc1defg.default \ extensions. <br><br><h6>  Openoffice </h6><br>  Run the OpenOffice installation, wait for the installer to unzip the files in software \ Std \ all \ OpenOffice, finish the installation.  Orca will again come in handy to wean the installation package to require running setup.exe.  Open openofficeorg33.msi, find the LaunchCondition table and delete the row containing the SETUP_USED condition in it. <br><br><h6>  VNC </h6><br>  In the software \ Std \ x86 \ VNC we put the 32-bit version of the distribution kit, in x64, respectively, 64-bit.  In both catalogs we put uvnc.inf and ultravnc.ini.  The first one can be obtained by running the installation with the / saveinf key, but it is primitive: <br><br> <code>[Setup] <br> Lang=en <br> Dir=C:\Program Files\UltraVNC <br> Group=UltraVNC <br> NoIcons=0 <br> SetupType=server_silent <br> Components=ultravnc_server_s <br> Tasks=installservice,startservice <br></code> <br><br>  The second is the result of setting up an already installed UltraVNC, you can take it in C: \ Program Files \ UltraVNC. <br><br><h5>  WPKG server </h5><br>  Now it remains to configure WPKG itself.  There are three main files for this: host.xml, profiles.xml and packages.xml, describing who to install, what to install and how to install. <br><br>  When launched on the client side, WPKG searches for the name of the workstation on which it is running in the hosts.xml file.  The name supports regular expressions.  In my case, the file contains the names of 64-bit workstations and the template for all the others. <br><br><blockquote>  <font color="#009900"><font color="#000000">&lt;host</font> <font color="#000066">name</font> = <font color="#ff0000">"WKS-088"</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"StdX64"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;host</font> <font color="#000066">name</font> = <font color="#ff0000">". +"</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"StdX86"</font> <font color="#000000">/&gt;</font></font> </blockquote><br><br>  Having found the name of the workstation in host.xml, WPKG gets the name of the installation profile for this workstation.  Profile descriptions are stored in profiles.xml.  The profile lists packages for installation and dependencies on other profiles.  For example: Profile for the workstation WKS-088 - StdX64.  StdX64 depends on Std profile.  Therefore, first all packages from the Std profile will be installed on the WKS-088, and then only from StdX64. <br><br><blockquote>  <font color="#009900"><font color="#000000">&lt;profile</font> <font color="#000066">id</font> = <font color="#ff0000">"Std"</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"Thunderbird"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"Lightning"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"MinTrayR"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"OpenOffice"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ profile <font color="#000000">&gt;</font></font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;profile</font> <font color="#000066">id</font> = <font color="#ff0000">"StdX64"</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;depends</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"Std"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"VNCx64"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ profile <font color="#000000">&gt;</font></font></font> </blockquote><br><br>  Packages are described in packages.xml.  Each package is a set of instructions for checking whether the software is installed, for installing the software, for updating the software, and for uninstalling the software.  Take for example the Lightning package, which describes the installation of an extension for Thunderbird: <br><br><blockquote>  <font color="#009900"><font color="#000000">&lt;package</font></font> <br>  <font color="#009900"><font color="#000066">id</font> = <font color="#ff0000">"Lightning"</font></font> <br>  <font color="#009900"><font color="#000066">name</font> = <font color="#ff0000">"Lightning"</font></font> <br>  <font color="#009900"><font color="#000066">revision</font> = <font color="#ff0000">"2012.01.10"</font></font> <br>  <font color="#009900"><font color="#000066">reboot</font> = <font color="#ff0000">"false"</font></font> <br>  <font color="#009900"><font color="#000066">priority</font> = <font color="#ff0000">"0"</font> <font color="#000000">&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;variable</font> <font color="#000066">name</font> = <font color="#ff0000">"version"</font> <font color="#000066">value</font> = <font color="#ff0000">"1.1"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;depends</font> <font color="#000066">package-id</font> = <font color="#ff0000">"Thunderbird"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;check</font> <font color="#000066">type</font> = <font color="#ff0000">"file"</font> <font color="#000066">condition</font> = <font color="#ff0000">"exists"</font> <font color="#000066">path</font> = <font color="#ff0000">"% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103} \ install.rdf"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C xcopy / Q / I / E / Y / V / Z "% SOFTWARE% \ Std \ all \ Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103}" "% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103} "'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C xcopy / Q / I / E / Y / V / Z "% SOFTWARE% \ Std \ all \ Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103}" "% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103} "'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C rmdir / S / Q "% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103}"'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ package <font color="#000000">&gt;</font></font></font> </blockquote><br><br>  The package has a header containing the package ID, name, revision and priority.  The package identifier is used in the WPKG configuration, to associate the package with a profile and specify dependencies between packages.  The package name is used to display messages in the Windows event log.  WPKG processes packets in the order of priority specified.  Priority is not recommended, it is better to use dependencies.  You can use several formats to specify the package revision: simple number format - 1, 2, 3, etc., format with dots - 1.1, 2.1.4, 3.200.3987, etc., alphanumeric format - 1.2RC1, 1.5 I32, 2.73M24, 1.65.b, etc., but I decided to use the date in the format - YYYY.MM.DD.  In my opinion, this is easier and more reliable.  WPKG compares the list of packages for this profile with the list from its last launch.  If a new package appears in the list, the package check instructions are executed in sequence.  If none of them found the installed application, then install instructions are also executed sequentially.  If the package has disappeared from the list, then the remove statements are executed.  If the revision has changed, the upgrade instructions are executed sequentially. <br><br>  Packages, like profiles, may depend on each other.  This dependency is defined by the depends directive.  In our example, the Lightning package will not be installed until Thunderbird is installed. <br><br>  The instructions contain variables framed with percent signs (%).  These can be system environment variables, WPKG client-side variables (for example, the variable% SOFTWARE% was defined by us in settings.xml) and the variables described in the configuration files.  The latter are described by the variable directive. <br><br><h5>  Full working system configuration files: </h5><br><h6>  host.xml </h6><br><blockquote>  <font color="#009900"><font color="#000000">&lt;? xml</font> <font color="#000066">version</font> = <font color="#ff0000">"1.0"</font> <font color="#000066">encoding</font> = <font color="#ff0000">"UTF-8"</font> <font color="#000000">?&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;hosts: wpkg</font> <font color="#000066">xmlns: hosts</font> = <font color="#ff0000">" <a href="http://www.wpkg.org/hosts%2522">www.wpkg.org/hosts"</a></font> <font color="#000066">xmlns: wpkg</font> = <font color="#ff0000">" <a href="http://www.wpkg.org/wpkg%2522">www.wpkg.org/wpkg"</a></font></font> <br>  <font color="#009900"><font color="#000066">xmlns: xsi</font> = <font color="#ff0000">" <a href="http://www.w3.org/2001/XMLSchema-instance%2522">www.w3.org/2001/XMLSchema-instance"</a></font></font> <br>  <font color="#009900"><font color="#000066">xsi: schemaLocation</font> = <font color="#ff0000">" <a href="http://www.wpkg.org/hosts%25C2%25A0xsd/hosts.xsd%25C2%25A0%2522">www.wpkg.org/hosts xsd / hosts.xsd"</a></font> <font color="#000000">&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;host</font> <font color="#000066">name</font> = <font color="#ff0000">"WKS-088"</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"StdX64"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;host</font> <font color="#000066">name</font> = <font color="#ff0000">"WKS-109"</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"StdX64"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;host</font> <font color="#000066">name</font> = <font color="#ff0000">"WKS-112"</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"StdX64"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;host</font> <font color="#000066">name</font> = <font color="#ff0000">"WKS-114"</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"StdX64"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;host</font> <font color="#000066">name</font> = <font color="#ff0000">"WKS-115"</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"StdX64"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;host</font> <font color="#000066">name</font> = <font color="#ff0000">"WKS-121"</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"StdX64"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;host</font> <font color="#000066">name</font> = <font color="#ff0000">". +"</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"StdX86"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;/ hosts: wpkg <font color="#000000">&gt;</font></font></font> <br></blockquote><br>  <a href="">Download</a> <br><br><h6>  profiles.xml </h6><br><blockquote>  <font color="#009900"><font color="#000000">&lt;? xml</font> <font color="#000066">version</font> = <font color="#ff0000">"1.0"</font> <font color="#000066">encoding</font> = <font color="#ff0000">"UTF-8"</font> <font color="#000000">?&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;profiles: profiles</font> <font color="#000066">xmlns: profiles</font> = <font color="#ff0000">" <a href="http://www.wpkg.org/profiles%2522">www.wpkg.org/profiles"</a></font></font> <br>  <font color="#009900"><font color="#000066">xmlns: wpkg</font> = <font color="#ff0000">" <a href="http://www.wpkg.org/wpkg%2522">www.wpkg.org/wpkg"</a></font> <font color="#000066">xmlns: xsi</font> = <font color="#ff0000">" <a href="http://www.w3.org/2001/XMLSchema-instance%2522">www.w3.org/2001/XMLSchema-instance"</a></font></font> <br>  <font color="#009900"><font color="#000066">xsi: schemaLocation</font> = <font color="#ff0000">" <a href="http://www.wpkg.org/profiles%25C2%25A0xsd/profiles.xsd%25C2%25A0%2522">www.wpkg.org/profiles xsd / profiles.xsd"</a></font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;profile</font> <font color="#000066">id</font> = <font color="#ff0000">"Std"</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"Thunderbird"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"Lightning"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"MinTrayR"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"OpenOffice"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ profile <font color="#000000">&gt;</font></font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;profile</font> <font color="#000066">id</font> = <font color="#ff0000">"StdX86"</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;depends</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"Std"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"VNCx86"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ profile <font color="#000000">&gt;</font></font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;profile</font> <font color="#000066">id</font> = <font color="#ff0000">"StdX64"</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;depends</font> <font color="#000066">profile-id</font> = <font color="#ff0000">"Std"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">package-id</font> = <font color="#ff0000">"VNCx64"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ profile <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ profiles: profiles <font color="#000000">&gt;</font></font></font> <br></blockquote><br>  <a href="">Download</a> <br><br><h6>  packages.xml </h6><br><blockquote>  <font color="#009900"><font color="#000000">&lt;? xml</font> <font color="#000066">version</font> = <font color="#ff0000">"1.0"</font> <font color="#000066">encoding</font> = <font color="#ff0000">"UTF-8"</font> <font color="#000000">?&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;packages: packages</font> <font color="#000066">xmlns: packages</font> = <font color="#ff0000">" <a href="http://www.wpkg.org/packages%2522">www.wpkg.org/packages"</a></font></font> <br>  <font color="#009900"><font color="#000066">xmlns: wpkg</font> = <font color="#ff0000">" <a href="http://www.wpkg.org/wpkg%2522">www.wpkg.org/wpkg"</a></font> <font color="#000066">xmlns: xsi</font> = <font color="#ff0000">" <a href="http://www.w3.org/2001/XMLSchema-instance%2522">www.w3.org/2001/XMLSchema-instance"</a></font></font> <br>  <font color="#009900"><font color="#000066">xsi: schemaLocation</font> = <font color="#ff0000">" <a href="http://www.wpkg.org/packages%25C2%25A0xsd/packages.xsd%2522">www.wpkg.org/packages xsd / packages.xsd"</a></font> <font color="#000000">&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;package</font></font> <br>  <font color="#009900"><font color="#000066">id</font> = <font color="#ff0000">"Thunderbird"</font></font> <br>  <font color="#009900"><font color="#000066">name</font> = <font color="#ff0000">"Mozilla Thunderbird"</font></font> <br>  <font color="#009900"><font color="#000066">revision</font> = <font color="#ff0000">"2012.01.10"</font></font> <br>  <font color="#009900"><font color="#000066">reboot</font> = <font color="#ff0000">"false"</font></font> <br>  <font color="#009900"><font color="#000066">priority</font> = <font color="#ff0000">"0"</font> <font color="#000000">&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;variable</font> <font color="#000066">name</font> = <font color="#ff0000">"version"</font> <font color="#000066">value</font> = <font color="#ff0000">"9.0.1"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;variable</font> <font color="#000066">name</font> = <font color="#ff0000">"architecture"</font> <font color="#000066">value</font> = <font color="#ff0000">"x86"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;variable</font> <font color="#000066">name</font> = <font color="#ff0000">"locale"</font> <font color="#000066">value</font> = <font color="#ff0000">"en"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;check</font> <font color="#000066">type</font> = <font color="#ff0000">"uninstall"</font> <font color="#000066">condition</font> = <font color="#ff0000">"exists"</font> <font color="#000066">path</font> = <font color="#ff0000">"Mozilla Thunderbird% version% (% architecture%% locale%)"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'"% SOFTWARE% \ Std \ all \ Thunderbird \ Thunderbird Setup% version% .exe" -ms'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C copy / v / y / z% SOFTWARE% \ Std \ all \ Thunderbird \ configuration \ all.js "% PROGRAMFILES% \ Mozilla Thunderbird \ defaults \ pref \"'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C copy / v / y / z% SOFTWARE% \ Std \ all \ Thunderbird \ configuration \ autoconf.cfg "% PROGRAMFILES% \ Mozilla Thunderbird \"'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'taskkill / F / IM thunderbird.exe'</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">"0"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">"128"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ upgrade <font color="#000000">&gt;</font></font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'"% SOFTWARE% \ thunderbird \ Thunderbird Setup% version% .exe" -ms'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C copy / v / y / z% SOFTWARE% \ Std \ all \ Thunderbird \ configuration \ all.js "% PROGRAMFILES% \ Mozilla Thunderbird \ defaults \ pref \"'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C copy / v / y / z% SOFTWARE% \ Std \ all \ Thunderbird \ configuration \ autoconf.cfg "% PROGRAMFILES% \ Mozilla Thunderbird \"'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'taskkill / f / im thunderbird.exe'</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">"0"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">"128"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ remove <font color="#000000">&gt;</font></font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C if exist "% PROGRAMFILES% \ Mozilla Thunderbird \ uninstall \ helper.exe" "% PROGRAMFILES% \ Mozilla Thunderbird \ uninstall \ helper.exe" -ms'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ package <font color="#000000">&gt;</font></font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;package</font></font> <br>  <font color="#009900"><font color="#000066">id</font> = <font color="#ff0000">"Lightning"</font></font> <br>  <font color="#009900"><font color="#000066">name</font> = <font color="#ff0000">"Lightning"</font></font> <br>  <font color="#009900"><font color="#000066">revision</font> = <font color="#ff0000">"2012.01.10"</font></font> <br>  <font color="#009900"><font color="#000066">reboot</font> = <font color="#ff0000">"false"</font></font> <br>  <font color="#009900"><font color="#000066">priority</font> = <font color="#ff0000">"0"</font> <font color="#000000">&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;variable</font> <font color="#000066">name</font> = <font color="#ff0000">"version"</font> <font color="#000066">value</font> = <font color="#ff0000">"1.1"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;depends</font> <font color="#000066">package-id</font> = <font color="#ff0000">"Thunderbird"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;check</font> <font color="#000066">type</font> = <font color="#ff0000">"file"</font> <font color="#000066">condition</font> = <font color="#ff0000">"exists"</font> <font color="#000066">path</font> = <font color="#ff0000">"% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103} \ install.rdf"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C xcopy / Q / I / E / Y / V / Z "% SOFTWARE% \ Std \ all \ Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103}" "% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103} "'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C xcopy / Q / I / E / Y / V / Z "% SOFTWARE% \ Std \ all \ Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103}" "% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103} "'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C rmdir / S / Q "% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ {e2fda1a4-762b-4020-b5ad-a41df1933103}"'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ package <font color="#000000">&gt;</font></font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;package</font></font> <br>  <font color="#009900"><font color="#000066">id</font> = <font color="#ff0000">"MinTrayR"</font></font> <br>  <font color="#009900"><font color="#000066">name</font> = <font color="#ff0000">"MinimizeToTray revived"</font></font> <br>  <font color="#009900"><font color="#000066">revision</font> = <font color="#ff0000">"2012.01.10"</font></font> <br>  <font color="#009900"><font color="#000066">reboot</font> = <font color="#ff0000">"false"</font></font> <br>  <font color="#009900"><font color="#000066">priority</font> = <font color="#ff0000">"0"</font> <font color="#000000">&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;variable</font> <font color="#000066">name</font> = <font color="#ff0000">"version"</font> <font color="#000066">value</font> = <font color="#ff0000">"1.0"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;depends</font> <font color="#000066">package-id</font> = <font color="#ff0000">"Thunderbird"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;check</font> <font color="#000066">type</font> = <font color="#ff0000">"file"</font> <font color="#000066">condition</font> = <font color="#ff0000">"exists"</font> <font color="#000066">path</font> = <font color="#ff0000">"% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ mintrayr@tn123.ath.cx \ install.rdf"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C xcopy / Q / I / E / Y / V / Z "% SOFTWARE% \ Std \ all \ Thunderbird \ extensions \ mintrayr@tn123.ath.cx" "% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ mintrayr@tn123.ath.cx "'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C xcopy / Q / I / E / Y / V / Z "% SOFTWARE% \ Std \ all \ Thunderbird \ extensions \ mintrayr@tn123.ath.cx" "% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ mintrayr@tn123.ath.cx "'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C rmdir / S / Q "% PROGRAMFILES% \ Mozilla Thunderbird \ extensions \ mintrayr@tn123.ath.cx"'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ package <font color="#000000">&gt;</font></font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;package</font></font> <br>  <font color="#009900"><font color="#000066">id</font> = <font color="#ff0000">"OpenOffice"</font></font> <br>  <font color="#009900"><font color="#000066">name</font> = <font color="#ff0000">"OpenOffice.org 3.3"</font></font> <br>  <font color="#009900"><font color="#000066">revision</font> = <font color="#ff0000">"2012.01.11"</font></font> <br>  <font color="#009900"><font color="#000066">reboot</font> = <font color="#ff0000">"false"</font></font> <br>  <font color="#009900"><font color="#000066">priority</font> = <font color="#ff0000">"0"</font> <font color="#000000">&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;variable</font> <font color="#000066">name</font> = <font color="#ff0000">"version"</font> <font color="#000066">value</font> = <font color="#ff0000">"3.3.9567.500"</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;variable</font> <font color="#000066">name</font> = <font color="#ff0000">"code"</font> <font color="#000066">value</font> = <font color="#ff0000">"{4218E1CD-CDB6-448C-8036-2871403BDE57}"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;check</font> <font color="#000066">type</font> = <font color="#ff0000">"file"</font> <font color="#000066">condition</font> = <font color="#ff0000">"versionequalto"</font> <font color="#000066">path</font> = <font color="#ff0000">"% PROGRAMFILES% \ OpenOffice.org 3 \ program \ soffice.exe"</font> <font color="#000066">value</font> = <font color="#ff0000">"% version%"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C if exist "% PROGRAMFILES% \ OpenOffice.org 3 \ program \ soffice.exe" msiexec / qn / x% code%'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'msiexec / qn / i "% SOFTWARE% \ Std \ all \ OpenOffice \ openofficeorg33.msi" ALLUSERS = 1 ADDLOCAL = ALL REMOVE = gm_o_Quickstart, gm_o_Onlineupdate'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C copy / v / y / z% SOFTWARE% \ Std \ all \ OpenOffice \ bootstrap.ini "% PROGRAMFILES% \ OpenOffice.org 3 \ program \"'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'msiexec / qn / i "% SOFTWARE% \ Std \ all \ OpenOffice \ openofficeorg33.msi" ALLUSERS = 1 ADDLOCAL = ALL REMOVE = gm_o_Quickstart, gm_o_Onlineupdate'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / C copy / v / y / z% SOFTWARE% \ Std \ all \ OpenOffice \ bootstrap.ini "% PROGRAMFILES% \ OpenOffice.org 3 \ program \"'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'msiexec / qn / x% code%'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ package <font color="#000000">&gt;</font></font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">id</font> = <font color="#ff0000">"VNCx86"</font> <font color="#000066">name</font> = <font color="#ff0000">"Ultra VNC (x86)"</font> <font color="#000066">revision</font> = <font color="#ff0000">"2012.01.11"</font> <font color="#000066">priority</font> = <font color="#ff0000">"0"</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;variable</font> <font color="#000066">name</font> = <font color="#ff0000">"version"</font> <font color="#000066">value</font> = <font color="#ff0000">"1.0.9.6"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;check</font> <font color="#000066">type</font> = <font color="#ff0000">"file"</font> <font color="#000066">condition</font> = <font color="#ff0000">"versionequalto"</font> <font color="#000066">path</font> = <font color="#ff0000">"% PROGRAMFILES% \ UltraVNC \ winvnc.exe"</font> <font color="#000066">value</font> = <font color="#ff0000">"% version%"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% SOFTWARE% \ Std \ x86 \ vnc \ UltraVNC_1.0.9.6.1_Setup.exe / verysilent /loadinf="%SOFTWARE%\Std\x86\vnc\uvnc.inf "'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / c copy / Y% SOFTWARE% \ Std \ x86 \ vnc \ ultravnc.ini "% PROGRAMFILES% \ UltraVNC \"'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'net stop uvnc_service'</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">'0'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">'2'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ upgrade <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'sc delete uvnc_service'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% SOFTWARE% \ Std \ x86 \ vnc \ UltraVNC_1.0.9.6.1_Setup.exe / verysilent /loadinf="%SOFTWARE%\Std\x86\vnc\uvnc.inf "'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / c copy / Y% SOFTWARE% \ Std \ x86 \ vnc \ ultravnc.ini "% PROGRAMFILES% \ UltraVNC \"'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'net stop uvnc_service'</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">'0'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">'2'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ remove <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'sc delete uvnc_service'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'"% PROGRAMFILES% \ UltraVNC \ unins000.exe" / verysilent / norestart'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / c rmdir / S / Q "% PROGRAMFILES% \ UltraVNC"'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ package <font color="#000000">&gt;</font></font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;package</font> <font color="#000066">id</font> = <font color="#ff0000">"VNCx64"</font> <font color="#000066">name</font> = <font color="#ff0000">"Ultra VNC (x64)"</font> <font color="#000066">revision</font> = <font color="#ff0000">"2012.01.11"</font> <font color="#000066">priority</font> = <font color="#ff0000">"0"</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;variable</font> <font color="#000066">name</font> = <font color="#ff0000">"version"</font> <font color="#000066">value</font> = <font color="#ff0000">"1.0.9.6"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;check</font> <font color="#000066">type</font> = <font color="#ff0000">"file"</font> <font color="#000066">condition</font> = <font color="#ff0000">"versionequalto"</font> <font color="#000066">path</font> = <font color="#ff0000">"% PROGRAMFILES% \ UltraVNC \ winvnc.exe"</font> <font color="#000066">value</font> = <font color="#ff0000">"% version%"</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% SOFTWARE% \ Std \ x64 \ vnc \ UltraVNC_1.0.9.6.1_x64_Setup.exe / verysilent / downloadinf</font> = <font color="#ff0000">"%SOFTWARE%\Std\x64\vnc\uvnc.inf "'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;install</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / c copy / Y% SOFTWARE% \ Std \ x64 \ vnc \ ultravnc.ini "% PROGRAMFILES% \ UltraVNC \"'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'net stop uvnc_service'</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">'0'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">'2'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ upgrade <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'sc delete uvnc_service'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% SOFTWARE% \ Std \ x64 \ vnc \ UltraVNC_1.0.9.6.1_x64_Setup.exe / verysilent / downloadinf</font> = <font color="#ff0000">"%SOFTWARE%\Std\x64\vnc\uvnc.inf "'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;upgrade</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / c copy / Y% SOFTWARE% \ Std \ x64 \ vnc \ ultravnc.ini "% PROGRAMFILES% \ UltraVNC \"'</font> <font color="#000000">/&gt;</font></font> <br><br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'net stop uvnc_service'</font> <font color="#000000">&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">'0'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;exit</font> <font color="#000066">code</font> = <font color="#ff0000">'2'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ remove <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'sc delete uvnc_service'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'"% PROGRAMFILES% \ UltraVNC \ unins000.exe" / verysilent / norestart'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;remove</font> <font color="#000066">cmd</font> = <font color="#ff0000">'% COMSPEC% / c rmdir / S / Q "% PROGRAMFILES% \ UltraVNC"'</font> <font color="#000000">/&gt;</font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ package <font color="#000000">&gt;</font></font></font> <br>  <font color="#009900"><font color="#000000">&lt;/ packages: packages <font color="#000000">&gt;</font></font></font> </blockquote><br>  <a href="">Download</a> <br><br>  All the packages were taken by me from the site <a href="http://wpkg.org/">wpkg.org</a> .  But they are easy and self-write. <br><br>  Also easily diagnosed and solved problems, in case of their occurrence.  While running, WPKG logs events in the Windows event log and logs to% SYSTEMROOT% \ System32 \ wpkg.xml <br><br>  The system administrator only needs to download the latest software versions to the software directory on time and monitor the correct operation of the packages. </div><p>Source: <a href="https://habr.com/ru/post/136314/">https://habr.com/ru/post/136314/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136307/index.html">World map from old motherboards (another way to add garbage)</a></li>
<li><a href="../136309/index.html">Call for applications for LVEE winter 2012 is open</a></li>
<li><a href="../136310/index.html">The introduction of ECM-solutions: what to talk with the client</a></li>
<li><a href="../136312/index.html">Data leak 6pm.com and Zappos.com</a></li>
<li><a href="../136313/index.html">bash: Backup without extra software</a></li>
<li><a href="../136315/index.html">How a web programming company should work</a></li>
<li><a href="../136316/index.html">Neural network in scheme</a></li>
<li><a href="../136317/index.html">LTE: Inside Look</a></li>
<li><a href="../136318/index.html">TV / PC video band problem</a></li>
<li><a href="../136319/index.html">We disassemble iPhone Core Data Recipes. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>