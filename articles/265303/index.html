<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with a SQLite database using SQLitePCL wrapper</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SQLite is a cross-platform (Windows, iOS, Android, Python, Mono, etc.) open source database engine. It supports multiple tables, indexes, triggers, an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with a SQLite database using SQLitePCL wrapper</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/8f4/0aa/a10/8f40aaa1026b4ce18df19b9c94fbcf98.jpg"></div><br>  <b>SQLite</b> is a cross-platform (Windows, iOS, Android, Python, Mono, etc.) open source database engine.  It supports multiple tables, indexes, triggers, and views. <br>  ACID transactions are supported (Atomicity / Atomicity, Consistency / Consistency, Isolation / Isolation, Durability / Reliability). <br>  <b>SQLitePCL</b> is an open source Portable Class Library available at <a href="https://sqlitepcl.codeplex.com/">https://sqlitepcl.codeplex.com/</a> , which allows you to work with SQLite databases in the same way in .Net applications and in WP, Windows Store, UAP, and Android / iOS (using Xamarin).  In other words, it is the C wrapper / wrapper that simplifies development and saves time.  The wrapper is pretty new.  Previously, <a href="https://github.com/praeclarum/sqlite-net">sqlite-net</a> wrapper could be used for .Net and Windows Store applications. <br><a name="habracut"></a><br>  Articles on how to use SQLite-net: <br>  <a href="http://habrahabr.ru/post/151479/">Work with data in WinRT.</a>  <a href="http://habrahabr.ru/post/151479/">Part 2. Working with the database on the example of SQLite</a> <br>  <a href="http://www.sergechel.info/ru/content/using-sqllite-with-c-sharp-part-1-preparing-tools">Using SQLite in C #</a> <br><br>  There is an article on Habr√© describing a slightly less well-known wrapper: <br>  <a href="http://habrahabr.ru/post/254313/">SQLite.</a>  <a href="http://habrahabr.ru/post/254313/">Getting ready for Windows 10 (Universal App Platform)</a> <br><br>  And earlier there was such an article about a wrapper called SQLite-net PCL: <br>  <a href="http://habrahabr.ru/company/microsoft/blog/228193/">SQLite is now for mobile C # applications for any platform</a> <br>  It would seem that this is SQLitePCL, especially since the project‚Äôs URL is the same, but in reality it turned out to be a wrapper with a completely different syntax. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We still consider exactly the current version of SQLitePCL. <br>  First we need to add SQLite to the UAP project.  You can do it this way: <br><br><img src="https://habrastorage.org/files/2b7/cec/8e8/2b7cec8e8d2f4745a7530b8449f8a54b.PNG"><br><br><img src="https://habrastorage.org/files/2c7/153/b45/2c7153b452d2405aba2d44c1ac47a660.PNG"><br><br>  After installation, you must restart Visual Studio for the changes to take effect. <br><br>  Alternatively, the .vsix extension can be downloaded from this link: <br>  <a href="https://visualstudiogallery.msdn.microsoft.com/4913e7d5-96c9-4dde-a1a1-69820d615936">SQLite for Universal App Platform</a> <br>  or from the SQLite website by finding the .vsix file for the Universal App Platform <br>  <a href="http://sqlite.org/download.html">SQLite Download Page</a> <br>  Then install. <br><br>  Now in the project you need to set a link to SQLite: <br><br><img src="https://habrastorage.org/files/71f/92c/c92/71f92cc929ea4a5195262dad012d68f1.PNG"><br><br><img src="https://habrastorage.org/files/29a/735/185/29a735185b1f4eb886e91549edb15c42.PNG"><br><br>  Tim Heuer in his <a href="http://timheuer.com/blog/archive/2012/08/07/updated-how-to-using-sqlite-from-windows-store-apps.aspx">article</a> on SQLite and applications, Windows 8 also recommends adding a link to the Microsoft Visual C ++ Runtime Package, arguing that the C ++ Runtime is unlikely to be missing on the client machine, but if this link is not added, the application will fail certification tests before publishing in the Windows Store. <br><br>  The SQLite library itself and the link to it we added, now we need to add SQLitePCL wrapper.  We do this by going to the menu Tools - Package Manager NuGet - Package Management NuGet to solve ... Find SQLitePCL search and install: <br><br><img src="https://habrastorage.org/files/195/e5f/953/195e5f953cf148df88a0172bf7207769.PNG"><br><br>  Or, you can install PCL using the package manager console (Tools - NuGet Package Manager - Package Manager Console) using the command: <br>  <b><i>Install-Package SQLitePCL</i></b> <br><br>  Now everything is ready for work.  If suddenly your project when deploying will give a message that the deployment is skipped: <br><br><img src="https://habrastorage.org/files/dec/568/bc1/dec568bc1b75418fa1798030052fe401.PNG"><br><br>  So it is necessary that in the configuration manager: <br><br><img src="https://habrastorage.org/files/474/00a/f67/47400af67d424c889ec757bda0624733.PNG"><br><br>  The configuration was intended for deployment (and, if necessary, for the assembly): <br><br><img src="https://habrastorage.org/files/65c/35d/e1a/65c35de1abb643cb99b60c2695511c5e.PNG"><br><br><h4>  Some introductory information about SQLite, which will be useful when you first met this database: </h4><br>  Each row of SQLite tables (with the exception of the WITHOUT ROWID tables) has a 64-bit signed integer key called ROWID.  You can get the value of this column by one of the following register independent aliases: ‚Äúrowid‚Äù, ‚Äúoid‚Äù or ‚Äú_rowid_‚Äù. <br>  According to the official <a href="http://www.sqlite.org/datatype3.html">SQLite Datatypes In SQLite Version 3</a> website, data is stored in one of the following classes: <br>  <b>NULL</b> Value is NULL <br>  <b>INTEGER</b> The value of the signed integer can be stored in 1,2,3,4,6 or 8 bytes, depending on the value of the number. <br>  <b>REAL</b> The value of a floating-point number is stored in an 8-byte IEEE floating-point number. <br>  <b>TEXT</b> Value is a text string that is stored using database encoding (UTF-8, UTF-16BE or UTF-16LE). <br>  <b>BLOB</b> Values ‚Äã‚Äãare blob data that is entered as it was entered. <br><br>  A data class has a broader meaning than a data type.  Let's say the class INTEGER contains 6 data types of different lengths. <br><br>  In SQLite databases there is no type BOOLEAN.  Instead of this type, the INTEGER type is used with values ‚Äã‚Äãof 1 and 0. <br><br>  Time and date can be saved in types TEXT, REAL or INTEGER: <br>  1. As text as ISO8601 string (‚ÄúYYYY-MM-DD HH: MM: SS.SSS‚Äù). <br>  2. In the form of REAL, floating-point numbers as the number of days in the Julian calendar, starting from half a day according to GMT on November 24, 4714 BC in accordance with the pro-septic Gregorian calendar. <br>  3. As an integer INTEGER as Unix time, is the number of seconds elapsed since 1970-01-01 00:00:00 UTC. <br><br>  In order to achieve maximum compatibility with other databases, SQLite supports the so-called type affinity concept.  There is a rule order that matches the data types of other databases and SQLite.  Let's say the first rule goes that if the string ‚ÄúINT‚Äù is in the string of the foreign database's data type, this type will be mapped to the SQLite INTEGER type.  If this rule is not executed, then the second rule is checked - does the string of the data type contain the text ‚ÄúCHAR‚Äù, ‚ÄúCLOB‚Äù or ‚ÄúTEXT‚Äù.  If it does, then the data type is mapped to the SQLite TEXT type.  And so on‚Ä¶ <br><br>  And after such a relatively large introduction, most of the information which in one way or another has already been encountered in runet, we will finally move on to the code of examples of working with SQLitePCL <br><br>  To work, we need to add a link to the namespace: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> SQLitePCL;</code> </pre> <br>  You can create a table in the database as follows: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> conn = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SQLiteConnection(<span class="hljs-string"><span class="hljs-string">"Storage.db"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> sql = <span class="hljs-string"><span class="hljs-string">@"CREATE TABLE IF NOT EXISTS People ( ID INTEGER NOT NULL PRIMARY KEY, FirstName NVARCHAR(50), LastName NVARCHUAR(50));"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statement = conn.Prepare(sql)) { statement.Step(); } }</code> </pre><br>  The primary key column is specified using the <b>PRIMARY KEY</b> expression and there can only be one in the table. <br>  <b>UNIQUE</b> is a constraint that requires that a column contain only unique values.  There can be several such columns in the table. <br>  <b>NOT NULL</b> is a constraint that forbids the presence of null values ‚Äã‚Äãin a column. <br>  <b>CHECK</b> - sets the condition to be checked.  Example: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">CREATE TABLE IF NOT EXISTS </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">People</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> ID INTEGER NOT NULL PRIMARY KEY, FirstName TEXT CHECK (FirstName NOT IN (</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span></span><span class="hljs-function">)), LastName TEXT NOT NULL UNIQUE)</span></span></code> </pre><br>  If the table has a foreign key, then it is necessary to create an index for it.  Also, indexes are desirable to create to optimize the search speed on large tables.  For primary key columns, an index is created automatically.  You can create an index like this: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statement = conn.Prepare(<span class="hljs-string"><span class="hljs-string">@"CREATE INDEX IF NOT EXISTS lastname_indx ON People (LastName)"</span></span>)) { statement.Step(); }</code> </pre><br>  More information about the SQL syntax for creating tables is available at: <a href="http://sqlite.org/lang_createtable.html">SQLite Query Language: CREATE TABLE</a> <br><br>  Among the minuses of SQLitePCL, it can be noted that it does not support the creation of foreign keys ( <a href="https://www.sqlite.org/foreignkeys.html">SQLite Foreign Key Support</a> ). <br>  If you need to add relationships between the tables creating them on the fly, then you can use some other wrapper.  By the way, foreign keys are disabled by default in SQLite. <br><br>  You can add an entry to the table by a simple query: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statement = conn.Prepare(<span class="hljs-string"><span class="hljs-string">"INSERT INTO People (FirstName, LastName) VALUES ('', '')"</span></span>)) { statement.Step(); }</code> </pre><br>  And you can use the parameters: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statement = conn.Prepare(<span class="hljs-string"><span class="hljs-string">"INSERT INTO People (FirstName, LastName) VALUES (?, ?)"</span></span>)) { statement.Bind(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); statement.Bind(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); statement.Step(); }</code> </pre><br>  We can add the following user to the table using the exact same structure, or we can perform the following actions inside <b><i>using</i></b> this structure after <b><i>Step ()</i></b> : <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//  statement    statement.Reset(); statement.ClearBindings(); //      statement.Bind(1, ""); statement.Bind(2, ""); //   statement.Step();</span></span></code> </pre><br>  It is also possible, instead of specifying the parameter number, to use an alias: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statement = conn.Prepare(<span class="hljs-string"><span class="hljs-string">"INSERT INTO People (FirstName, LastName) VALUES (@fName, @lName)"</span></span>)) { statement.Bind(<span class="hljs-string"><span class="hljs-string">"@fName"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); statement.Bind(<span class="hljs-string"><span class="hljs-string">"@lName"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); statement.Step(); }</code> </pre><br>  Deletion is similar to adding or updating records: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> fname =<span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statement = conn.Prepare(<span class="hljs-string"><span class="hljs-string">"DELETE FROM People WHERE FirstName=?"</span></span>)) { statement.Bind(<span class="hljs-number"><span class="hljs-number">1</span></span>, fname); statement.Step(); }</code> </pre><br>  The process of reading entries is slightly different: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statement = conn.Prepare(<span class="hljs-string"><span class="hljs-string">"SELECT LastName, FirstName FROM People WHERE FirstName=''"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (statement.Step() == SQLiteResult.ROW) { txtInfo.Text = txtInfo.Text + (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)statement[<span class="hljs-number"><span class="hljs-number">0</span></span>] + Environment.NewLine; } }</code> </pre><br>  Transactions can be started manually using ‚ÄúCOMMIT TRANSACTION‚Äù or ‚ÄúROLLBACK TRANSACTION‚Äù.  To do this, before the list of requests we perform: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statement = conn.Prepare(<span class="hljs-string"><span class="hljs-string">"BEGIN TRANSACTION"</span></span>)) { statement.Step(); }</code> </pre><br>  And after the requests we confirm with: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statement = conn.Prepare(<span class="hljs-string"><span class="hljs-string">"COMMIT TRANSACTION"</span></span>)) { statement.Step(); }</code> </pre><br><br>  The application database itself is on the desktop at <br>  <b>% USERPROFILE% \ AppData \ Local \ Packages \ {PackageId}</b> <br><br>  To view the base on your mobile device, you need a utility. <br>  For example, you can use <a href="https://wptools.codeplex.com/">Power Tools for WP8.1</a> <br>  I managed with this utility to access SQLite databases and on a Windows 10 phone: <br><br><img src="https://habrastorage.org/files/69c/6c0/b34/69c6c0b349a447ca9b50a55ce4899d2c.PNG"><br><br>  On the official website, you can find <a href="http://www.sqlite.org/cvstrac/wiki%3Fp%3DManagementTools">tools for working with SQLite.</a> <br>  I liked the Polish program <a href="http://sqlitestudio.pl/">SQLite Studio</a> , which has support for the Russian language and does not require installation under Windows (.zip archive) <br>  In addition, you can highlight the free <a href="http://sqlite2009pro.azurewebsites.net/">SQLite2009 Pro Enterprise Manager</a> <br>  The personal version of <a href="http://www.sqliteexpert.com/">SQLite Expert is</a> free for personal and commercial use. <br><br>  Materials that helped me: <br>  <a href="http://www.microsoftvirtualacademy.com/training-courses/a-developers-guide-to-windows-10">Course on MVA "A Developer's Guide to Windows 10"</a> <br>  <a href="https://marcominerva.wordpress.com/2014/02/13/the-new-portable-class-library-for-sqlite/">Article "The new Portable Class Library for SQLite"</a> </div><p>Source: <a href="https://habr.com/ru/post/265303/">https://habr.com/ru/post/265303/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265289/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ173 (August 16 - 23, 2015)</a></li>
<li><a href="../265291/index.html">PHP Digest number 68 - interesting news, materials and tools (July 27 - August 24, 2015)</a></li>
<li><a href="../265293/index.html">Frontend Union Conf conference this Saturday</a></li>
<li><a href="../265295/index.html">PostgreSQL support in Meteor</a></li>
<li><a href="../265301/index.html">Single-layer perceptron for beginners</a></li>
<li><a href="../265305/index.html">Wake on Lan Telegram bot</a></li>
<li><a href="../265307/index.html">Writing a Labyrinth on XNA 4.0 C #</a></li>
<li><a href="../265309/index.html">Python cryptography: encrypting information and creating digital signatures with the PyCrypto package</a></li>
<li><a href="../265311/index.html">Safe as in a safe</a></li>
<li><a href="../265313/index.html">How to configure the iOS device and RAD Studio XE8 (Delphi, C ++ Builder)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>