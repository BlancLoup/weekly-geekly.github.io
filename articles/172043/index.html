<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Correlations for beginners</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Update for those who find the article useful and add to favorites. There is a decent chance that the post will go into a minus, and I will be forced t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Correlations for beginners</h1><div class="post__text post__text-html js-mediator-article">  Update for those who find the article useful and add to favorites.  There is a decent chance that the post will go into a minus, and I will be forced to carry it into drafts.  Keep a copy! <br><br>  Brief and simple material for non-specialists, telling in visual form about the various methods of finding regression dependencies.  This is all close and not academic, but I hope that is understandable.  Rolled as a mini-manual on data processing for students of natural science specialties that math is not well known <s>, but like the author</s> .  Calculations in Matlab, data preparation in Excel - so happened in our area <br><img src="https://habrastorage.org/storage2/3f1/2c1/ffa/3f12c1ffa3aaab073ac1d2156d494544.jpg"><br><br><h4>  Introduction </h4><br>  Why is this even necessary?  In science and around it, very often there is the problem of predicting some unknown parameter of an object based on the known parameters of this object (predictors) and a large set of similar objects, the so-called training set.  Example.  Here we choose an apple in the market.  It can be described by such predictors: redness, weight, number of worms.  But as consumers, we are interested in taste, measured in parrots on a five-point scale.  From life experience we know that taste with decent accuracy is equal to 5 * redness + 2 * weight-7 * number of worms.  That's about the search for this kind of dependencies, we talk.  To make the training easier, let's try to predict the weight of a girl based on her 90/60/90 and height. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Initial data </h4><br>  As the object of the study I will take the data on the parameters of the figure of the girls of the month of Playboy.  Source - <a href="http://www.wired.com/special_multimedia/2009/st_infoporn_1702">www.wired.com/special_multimedia/2009/st_infoporn_1702</a> , slightly ennobled and translated from inches to centimeters.  I remember a joke about the fact that 34 inches is like two seventeen-inch monitors.  Also separated records with incomplete information.  When working with real objects, they can be used, but now they only hinder us.  But they can be used to verify the adequacy of the results.  All our data is continuous, that is, roughly float.  They are converted to integers just to keep the screen cluttered.  There are ways to work with discrete data - in our example, for example, it can be skin color or nationality, which takes one of a fixed set of values.  This has more to do with the methods of classification and decision making, which draws on another manual.  <a href="https://docs.google.com/file/d/0B_vFocZhMNUDeXJ0SjhGTFN0dTA/edit%3Fusp%3Dsharing">Data.xls</a> The file has two sheets.  On the first one, the data itself, on the second, the screened incomplete data and a set to test our model. <br><br><h4>  Legend </h4><br>  W - real weight <br>  W_p - weight predicted by our model <br>  S - bust <br>  T - waist <br>  B - hips <br>  L - height <br>  E - model error <br><br><h4>  How to evaluate the quality of the model? </h4><br>  The task of our exercise is to obtain a certain model that describes an object.  The method of obtaining and the principle of operation of a particular model does not concern us yet.  It's just a function f (S, T, B, L), which gives the weight of a girl.  How to understand which function is good and qualitative, and which is not very?  For this, the so-called fitness function is used.  The most classic and frequently used is the sum of the squares of the difference between the predicted and real values.  In our case, this will be the sum (W_p - W) ^ 2 for all points.  Actually, hence the name ‚Äúleast squares method‚Äù.  The criterion is not the best and not the only, but quite acceptable as a default method.  Its peculiarity is that it is sensitive to emissions and thus, considers such models to be of lower quality.  There are all sorts of methods for the smallest modules, etc., but for now we don‚Äôt need it yet. <br><br><h4>  Simple linear regression </h4><br>  The easiest case.  We have one predictor variable and one dependent variable.  In our case, it can be for example height and weight.  We need to construct the equation W_p = a * L + b, i.e.  find the coefficients a and b.  If we carry out this calculation for each sample, then W_p will coincide as much as possible with W for the same sample.  That is, we will have the following equation for each girl: <br>  W_p_i = a * L_i + b <br>  E_i = (W_p-W) ^ 2 <br><br>  The total error in this case will be sum (E_i).  As a result, for optimal values ‚Äã‚Äãof a and b, the sum (E_i) will be minimal.  How to find the equation? <br><br><h4>  Matlab </h4><br>  To simplify, I highly recommend putting an Excel plugin called Exlink.  It is in the matlab / toolbox / exlink folder.  Very easy to transfer data between programs.  After installing the plugin, another menu appears with an obvious name, and Matlab automatically starts.  The transfer of information from Excel to Matlab is initiated by the command ‚ÄúSend data to MATLAB‚Äù, back, respectively, - ‚ÄúGet data from MATLAB‚Äù.  We send numbers to the Matlab from column L and separately from W, without headers.  Variables are called the same.  The linear regression calculation function is polyfit (x, y, 1).  The unit indicates the degree of the approximation polynomial.  We have it linear, so the unit.  We finally get the regression coefficients: <code>regr=polyfit(L,W,1)</code> .  a we can get as regr (1), b - as regr (2).  That is, we can get our values ‚Äã‚ÄãW_p: <code>W_p=L*repr(1)+repr(2)</code> .  Let's get them back to Excel. <br><br><h4>  Graphic </h4><br><img src="https://habrastorage.org/storage2/1e7/484/dc4/1e7484dc4d2606b4769cfeac391561c1.png"><br>  Hmm, sparsely.  This is a graph of W_p (W).  The formula on the graph shows the relationship of W_p and W. Ideally, there will be W_p = W * 1 + 0. The sampling of the initial data has come out - a cloud of checkered points.  Neither the correlation coefficient is in an arc ‚Äî the data are weakly correlated with each other, i.e.  Our model poorly describes the relationship of weight and height.  On the graph it can be seen as points located in the form of a weakly stretched along a straight cloud.  A good model will give a cloud stretched into a narrow lane, even worse - just a chaotic set of points or a round cloud.  The model must be supplemented.  About the correlation coefficient should be told separately, because it is often used completely wrong. <br><br><h4>  Matrix calculation </h4><br>  It is possible to cope with the construction of regression without any polyphytes, if we slightly add a column with growth values ‚Äã‚Äãwith one more column filled with units: <code>L(:,2)=1</code> .  Deuce shows the number of the column in which the units are written.  Then the regression coefficients can be found using the following formula: <code>repr=inv(L'*L)*L'*W</code>  And back, find W_p: <code>W_p=L*repr</code> .  When you realize the magic of matrices, it becomes unpleasant to use functions.  A single column is needed to calculate the free regression term, that is, simply a term without multiplying by a parameter.  If you do not add it, then there will be only one member in the regression: W_p = a * L.  It is quite obvious that it will be worse in quality than a regression with two terms.  In general, it is necessary to get rid of a free member only if it is definitely not needed.  By default, it is still present. <br><br><h4>  Multiline regression </h4><br>  In the Russian-language literature of the past years it is referred to as MMNK, the method of multiple least squares.  This is an extension of the least squares method for several predictors.  That is, not only growth, but also all the other horizontal dimensions, so to speak, go into our business.  The preparation of the data is exactly the same: both matrices in matlab, adding a column of units, calculation using the same formula.  For lovers of functions, there is <code>b = regress(y,X)</code> .  This feature also requires the addition of a column of units.  We repeat the calculation according to the formula from the section about the matrix, we send it to Excel, we look. <br><br><h4>  Attempt number two </h4><br><img src="https://habrastorage.org/storage2/528/238/ef1/528238ef11b72d41fe988c7e1bba8d7f.png"><br>  And so better, but still not very.  As you can see, cellularity remained only horizontally.  Nowhere is it, the initial weights were whole numbers in pounds.  That is, after conversion to kilograms, they fall on the grid in increments of about 0.5.  Total final view of our model: <br><br>  W_p = 0.2271 * S + 0.1851 * T + 0.3125 * B + 0.3949 * L - 72.9132 <br><br>  Volumes in centimeters, weight in kg.  Since we have all the values ‚Äã‚Äãexcept for growth in some units of measurement and about the same order of magnitude (except for the waist), we can estimate their contributions to the total weight.  The reasoning is approximately like this: the coefficient at the waist is the smallest, as well as the values ‚Äã‚Äãthemselves in centimeters.  This means that the contribution of this parameter to the weight is minimal.  In the bust, and especially in the hips, it is larger;  a centimeter at the waist gives less weight gain than on the chest.  And most of all the weight affects the volume of the ass.  However, any interested man knows this.  That is, at least, our model of real life does not contradict. <br><br><h4>  Model validation </h4><br>  The name is loud, but we will try to get at least the approximate weights of those girls for whom there is a full set of sizes, but no weight.  Their 7: from May to June 1956, July 1957, March 1987, August 1988. We find the weight predicted by the model: <code>W_p=X*repr</code> <br><img src="https://habrastorage.org/storage2/f79/d0d/ae3/f79d0dae3af5ac8493216c1fd80585b9.png"><br>  Well, at least in text form it looks plausible.  And how much this corresponds to reality - <a href="http://en.wikipedia.org/wiki/List_of_Playboy_Playmates_of_the_Month">you decide</a> <br><br><h4>  Applicability </h4><br>  In short, the resulting model is suitable for objects similar to our data set.  That is, according to the obtained correlations, one should not consider the parameters of the figures of women with a weight of 80+, an age that is very different from the average for the hospital, etc.  In real-world applications, we can assume that the model is suitable if the parameters of the object being studied are not too different from the average values ‚Äã‚Äãof the same parameters for the initial data set.  There may be (and will be) problems if we have predictors that are strongly correlated with each other.  That is, for example, this is the height and length of the legs.  Then the coefficients for the corresponding values ‚Äã‚Äãin the regression equation will be determined with low accuracy.  In this case, you need to throw away one of the parameters, or use the principal component method to reduce the number of predictors.  If we have a small sample and / or a lot of predictors, then we risk falling into a model redefinition.  That is, if we take 604 parameters for our sample (and there are only 604 girls in the table), then we can analytically obtain an equation with 604 + 1 terms, which will exactly describe what we have thrown into it.  But the predictive power of him will be very small.  Finally, not all objects can be described by multiline dependence.  There are logarithmic and power, and all sorts of complex.  Their search is another question. <br><br><h4>  Future plans </h4><br>  If it goes well, I will try in the same style to describe the principal component method for reducing the dimensionality of the data, regression on the main components, the PLS method, the beginning of cluster analysis and methods for classifying objects.  If the habrapublic is not very well received, then I will try to take into account the comments.  If there is any way at all, I will score for the enlightenment of Shirnarmass in general, I have enough of my students.  See you again! </div><p>Source: <a href="https://habr.com/ru/post/172043/">https://habr.com/ru/post/172043/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../172023/index.html">Headtracker accessory for Carl Zeiss Cinemizer OLED glasses presented at CeBIT 2013</a></li>
<li><a href="../172027/index.html">New service from MegaFon - reading remote SMS</a></li>
<li><a href="../172029/index.html">Successful surgery to replace the skull with an implant printed on a 3D printer</a></li>
<li><a href="../172033/index.html">Open game development - report number 0</a></li>
<li><a href="../172037/index.html">Govnokod or super hierarchy? First govnokod, and then evolutionary refactoring!</a></li>
<li><a href="../172045/index.html">Replacing 'on' and back with one click</a></li>
<li><a href="../172051/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ47 (March 2 - 8, 2013)</a></li>
<li><a href="../172053/index.html">Video lectures of the course "Operating Systems" with Alexei Bragin in MSTU. Bauman</a></li>
<li><a href="../172055/index.html">Philips O'Neill The Stretch - Sport Headphones</a></li>
<li><a href="../172065/index.html">Universal rating or every voice is important to us</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>