<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Object in a case or Optional in Java 8 and Java 9. Part 4: ‚ÄúHow to close a hole in Java with a double bottom case‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the fourth article in the series on the use of the Optional class when processing objects with dynamic structure. The first article was about ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Object in a case or Optional in Java 8 and Java 9. Part 4: ‚ÄúHow to close a hole in Java with a double bottom case‚Äù</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/post/347836/"><img src="https://habrastorage.org/webt/ys/0h/kg/ys0hkgszo0x804sxkfr0q6svqcm.jpeg" alt="Object in the case"></a> <br><br>  This is the fourth article in the series on the use of the Optional class when processing objects with dynamic structure.  The <a href="https://habrahabr.ru/post/347480/">first article</a> was about ways to avoid NullPointerException in situations where you can‚Äôt or don‚Äôt want to use Optional.  <a href="https://habrahabr.ru/post/347576/">The second article is</a> devoted to the description of the methods of the class Optional as it appeared in Java 8. <a href="https://habrahabr.ru/post/347748/">The third</a> is to the methods added to the class in Java 9. <br>  Well, in the <a href="https://habrahabr.ru/post/350904/">fifth article</a> I tell about where the Optional should be used inside the class, summarize and give every reader who has read the series to the end, a valuable gift. <br>  The class about which I want to tell in this article arose while trying to find a solution to a real problem.  At the abstract level, the formulation of the problem is as follows: you are accessing a certain service, which, if successful, must return the object.  But the request may end in failure.  There may be several reasons for failure.  And the logic of further processing of the error situation depends on what was the cause of the failure. <br><br>  If the service returns an Optional, we know nothing about the reason.  So you need to use something similar to Optional, but containing information about the error in the event of failure. <a name="habracut"></a><br>  In the example of the electric kettle, discussed in the <a href="https://habrahabr.ru/post/347576/">second article of</a> this cycle, we received boiled water, if at the entrance we have both water and electricity.  In the absence of water or electricity, we received an Optional.empty () object. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the case of an electric kettle, it is not difficult to determine the cause of failure.  But if our device prepares various types of coffee, in case of failure it would be nice to know the reason.  For example, what ingredient is missing. <br><br>  To do this, we need to be able to return not only the result of processing if successful, but also information about the detected problem in case of failure.  For clarity, I compared in previous articles Optional case.  Developing this analogy, in this case we need a double bottom case. <br><br>  Unfortunately, Java allows you to use strictly one object as the return value of a method.  And we, as we see, need to be able to return either one or another object. <br>  With all due respect to the creators of Java and understanding all the difficulties of making decisions about extending the language with new features, I consider this one of the shortcomings of a language that could be fixed long ago. <br><br>  But until this is done, I suggest using the Result &lt;SUCCESS, FAILURE&gt; class, the development of which was inspired by reading one of the chapters of the book: <br><blockquote>  Functional Programming in Java.  How to improve your Java programs.  Pierre-Yves Saumont.  Manning Pubn.  ISBN 9781617292736 </blockquote>  I strongly advise you to read this book if you have not read it yet.  So, we proceed to the consideration of the class. <br><br><h3>  How to use it inside the method (as a return value)? </h3><br>  The class allows you to pack into your objects (instances) immediately the result of processing in case of success, or information about an error in case of failure.  Therefore, the class is parametrized by two types: Result &lt;SUCCESS, FAILURE&gt;. <br><br>  The trick is that it allows you to pack either one or the other, but not both. <br>  And then everything is simple: in case of successful processing, we write the result of your method as an object of type SUCCESS and in case of failure, as an object of type FAILURE. <br><br><h3>  How to use it outside (in the method call)? </h3><br>  Depending on the situation, a simple or more elegant approach can be used to process the result. <br><br>  A simple two-step approach.  First, you determine whether the processing was successful.  And then, depending on this, you understand separately either with a positive result or with an error. <br><br>  An elegant approach is to use functional programming elements from the Java 8 arsenal. <br><br>  But let's move on to the examples. <br><br><h3>  Modify the electric kettle </h3><br>  We will push away from the model of the electric kettle from the example with the electric kettle, discussed in the <a href="https://habrahabr.ru/post/347576/">second article of</a> this cycle. <br><br>  Its source code as well as the source code of the example discussed in this article can be found in <a href="https://github.com/vsirotin/Smartenesse-Java">my GitHub project</a> . <br>  In the example, we tried using Java 8 Optional to simulate the operation of a stationary boiler, which can be found in the offices of some companies. <br><br>  His diagram is shown in the picture below: <br><br><img src="https://habrastorage.org/webt/ap/uc/b1/apucb1yne-dfcnjut0ghbaunu0o.png" alt="Boiler"><br><br>  As you can see, the boiler needs water and electricity to work.  At the outlet, the boiler can produce raw or boiled water. <br><br><div class="spoiler">  <b class="spoiler_title">A brief reminder to those who forgot or did not read the second article of the cycle</b> <div class="spoiler_text">  We modeled raw water with a class: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CupOfWater</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> CupOfBoiledWater </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">boil</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CupOfBoiledWater();} }</code> </pre> <br>  As we can see, we can get boiled from raw water using the boil () method.  This assumption has caused fair complaints from readers.  But it is made for reasons of simplicity of the code. <br><br>  Well, the class modeling boiled water is quite simple: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CupOfBoiledWater</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre> <br></div></div><br>  The input of the modified device can be described with this interface: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBoilerInput2</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAvailability</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Nullable CupOfWater water, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> powerAvailable)</span></span></span></span>; }</code> </pre> <br>  Do not be surprised to the numbers-suffixes in the names of the interfaces.  In the series I considered different alternatives for the implementation of the kettle model. <br><br>  The output of the device, we define like this: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBoilerOutput3</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">Result&lt;CupOfWater, String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCupOfWater</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">Result&lt;CupOfBoiledWater, String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCupOfBoiledWater</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br>  If successful, we get an object modeling raw or boiled water.  And in case of failure - the text of the error.  Of course, instead of text, we could use a more complex object with an error code, a list of errors, etc. <br><br>  The behavior of the class is described by the interface: <br><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBoiler3</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBoilerInput2</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBoilerOutput3</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre> <br>  Compared to the old version, we can see that instead of Optional &lt;CupOfBoiledWater&gt; we now use Result &lt;CupOfBoiledWater, String&gt;. <br><br>  To make the test codes discussed below understand more clearly, we first agree on the error texts that our class can issue: <br><br><pre> <code class="java hljs">... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String WATER_NOT_AVAILABLE = <span class="hljs-string"><span class="hljs-string">"Water not available."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String POWER_NOT_AVAILABLE = <span class="hljs-string"><span class="hljs-string">"Power not available."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String BOTH_NOT_AVAILABLE = WATER_NOT_AVAILABLE + <span class="hljs-string"><span class="hljs-string">" "</span></span> + POWER_NOT_AVAILABLE;</code> </pre><br>  We write the test: <br><br><div class="spoiler">  <b class="spoiler_title">JUnit test Boiler3Test</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Boiler3Test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IBoiler3 boiler; <span class="hljs-meta"><span class="hljs-meta">@Before</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ boiler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Boiler3(); } <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testBothNotAvailable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ boiler.setAvailability(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); assertFalse(boiler.getCupOfWater().isSuccess()); boiler.getCupOfWater().ifFailure(message-&gt;assertEquals(message, Boiler3.WATER_NOT_AVAILABLE)); assertFalse(boiler.getCupOfBoiledWater().isSuccess()); boiler.getCupOfBoiledWater().ifFailure(message-&gt;assertEquals(message, Boiler3.BOTH_NOT_AVAILABLE)); } <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testPowerAvailable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ boiler.setAvailability(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); assertFalse(boiler.getCupOfWater().isSuccess()); boiler.getCupOfWater().ifFailure(message-&gt;assertEquals(message, Boiler3.WATER_NOT_AVAILABLE)); assertFalse(boiler.getCupOfBoiledWater().isSuccess()); boiler.getCupOfBoiledWater().ifFailure(message-&gt;assertEquals(message, Boiler3.WATER_NOT_AVAILABLE)); } <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testWaterAvailable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ boiler.setAvailability(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CupOfWater(), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); assertTrue(boiler.getCupOfWater().isSuccess()); assertFalse(boiler.getCupOfBoiledWater().isSuccess()); boiler.getCupOfBoiledWater().ifFailure(message-&gt;assertEquals(message, Boiler3.POWER_NOT_AVAILABLE)); } <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testBothAvailable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ boiler.setAvailability(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CupOfWater(), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); assertTrue(boiler.getCupOfWater().isSuccess()); assertTrue(boiler.getCupOfBoiledWater().isSuccess()); } }</code> </pre></div></div><br>  And here is the implementation of the electric kettle class using our new Result &lt;SUCCESS, FAILURE&gt; class: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Boiler3</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBoiler3</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String WATER_NOT_AVAILABLE = <span class="hljs-string"><span class="hljs-string">"Water not available."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String POWER_NOT_AVAILABLE = <span class="hljs-string"><span class="hljs-string">"Power not available."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String BOTH_NOT_AVAILABLE = WATER_NOT_AVAILABLE + <span class="hljs-string"><span class="hljs-string">" "</span></span> + POWER_NOT_AVAILABLE; <span class="hljs-meta"><span class="hljs-meta">@Nullable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CupOfWater water; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> powerAvailable; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAvailability</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Nullable CupOfWater water, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> powerAvailable)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.water = water; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.powerAvailable = powerAvailable; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Result&lt;CupOfWater, String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCupOfWater</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> water == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ? Result.failure(WATER_NOT_AVAILABLE) : Result.success(water); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Result&lt;CupOfBoiledWater, String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCupOfBoiledWater</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Result&lt;CupOfWater, String&gt; resultStep1 = getCupOfWater(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> resultStep1.isSuccess() ? powerAvailable ? Result.success(resultStep1.getSuccess().boil()) : Result.failure(POWER_NOT_AVAILABLE) : powerAvailable ? Result.failure(WATER_NOT_AVAILABLE) : Result.failure(BOTH_NOT_AVAILABLE); } }</code> </pre><br>  Note the setting of values ‚Äã‚Äãin the getCupOfWater () method depending on what the method should return. <br><br>  A simple method for processing the result is shown in the third line of the getCupOfBoiledWater () method.  First we will find out what the result is with resultStep1.isSuccess ().  And then, depending on the answer, we continue processing. <br><br>  The test demonstrated a more functional way of processing using the ifFailure method: <br><br><pre> <code class="java hljs">boiler.getCupOfWater().ifFailure(message-&gt;assertEquals(message, Boiler3.WATER_NOT_AVAILABLE));</code> </pre> <br>  The method will be called only if the result of the processing was erroneous.  In this case, information about the error (in this case, this message) will be automatically provided to your handler. <br><br>  As you can see, everything is very simple. <br><br>  Well, in the end - the source code of the Result class itself: <br><br><div class="spoiler">  <b class="spoiler_title">Result class</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Result</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SUCCESS</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FAILURE</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> SUCCESS </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> FAILURE </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> Result&lt;SUCCESS, FAILURE&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ifSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Consumer consumerSuccess)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> Result&lt;SUCCESS, FAILURE&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ifFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Consumer consumerFailure)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Success</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SUCCESS</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FAILURE</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Result</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SUCCESS</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FAILURE</span></span></span><span class="hljs-class">&gt;</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> SUCCESS _success; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Success</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SUCCESS success)</span></span></span><span class="hljs-function"> </span></span>{ _success = success; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SUCCESS </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _success; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> FAILURE </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IllegalStateException(<span class="hljs-string"><span class="hljs-string">"getFailure called on Success"</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Success [_success="</span></span> + _success + <span class="hljs-string"><span class="hljs-string">"]"</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Result&lt;SUCCESS, FAILURE&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ifSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Consumer consumerSuccess)</span></span></span><span class="hljs-function"> </span></span>{ consumerSuccess.accept(_success); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Result&lt;SUCCESS, FAILURE&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ifFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Consumer consumerFailure)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Failure</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SUCCESS</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FAILURE</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Result</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SUCCESS</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FAILURE</span></span></span><span class="hljs-class">&gt;</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> FAILURE _failure; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Failure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FAILURE failure)</span></span></span><span class="hljs-function"> </span></span>{ _failure = failure; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SUCCESS </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IllegalStateException(<span class="hljs-string"><span class="hljs-string">"getSuccess called on Failure"</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> FAILURE </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _failure; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Failure [_failure="</span></span> + _failure + <span class="hljs-string"><span class="hljs-string">"]"</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Result&lt;SUCCESS, FAILURE&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ifSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Consumer consumerSuccess)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Result&lt;SUCCESS, FAILURE&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ifFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Consumer consumerFailure)</span></span></span><span class="hljs-function"> </span></span>{ consumerFailure.accept(_failure); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> &lt;SUCCESS, FAILURE&gt; <span class="hljs-function"><span class="hljs-function">Result&lt;SUCCESS, FAILURE&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">failure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FAILURE failure)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Failure&lt;&gt;(failure);} <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> &lt;SUCCESS, FAILURE&gt; <span class="hljs-function"><span class="hljs-function">Result&lt;SUCCESS, FAILURE&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">success</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SUCCESS success)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Success&lt;&gt;(success);} }</code> </pre></div></div><br>  Use, the code is completely free. <br><br>  As in the case of past examples, you will find the source code of the <a href="https://github.com/vsirotin/Smartenesse-Java">project on GitHub</a> . <br><br>  In the last article in the series, we‚Äôll talk about some of the subtleties of using the Optional class. <br><br>  I also plan to reward your patience with a gift.  How?  You will learn about this in the next article. <br><br>  Illustration: <a href="https://pixabay.com/de/k%25C3%25A4tzchen-tier-haustiere-katze-491013/">ThePixelman</a> </div><p>Source: <a href="https://habr.com/ru/post/347836/">https://habr.com/ru/post/347836/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347826/index.html">Chromium typos</a></li>
<li><a href="../347828/index.html">IOS App Development: Start Your Career</a></li>
<li><a href="../347830/index.html">100 interviews per hour, virtual space and 23 million rubles: the results of the pilots in the MEGA Accelerator 2017</a></li>
<li><a href="../347832/index.html">How multichannel phone numbers work</a></li>
<li><a href="../347834/index.html">Anatomy of a thousand fonts</a></li>
<li><a href="../347838/index.html">How we manage data quality</a></li>
<li><a href="../347840/index.html">Android Application Development: Start Your Career</a></li>
<li><a href="../347842/index.html">Old-new holes of e-Government of Kazakhstan</a></li>
<li><a href="../347844/index.html">DCShadow - Active Directory Attack Technique</a></li>
<li><a href="../347846/index.html">The book "Microservices on the .NET platform"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>