<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to use custom fonts on the web and not go crazy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Has it happened that you see pictures and design on a web page, but you do not see the text - does it appear a couple (tens) seconds later? This is lo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to use custom fonts on the web and not go crazy</h1><div class="post__text post__text-html js-mediator-article">  Has it happened that you see pictures and design on a web page, but you do not see the text - does it appear a couple (tens) seconds later?  This is loaded with custom web fonts.  We explain why this happens and how to avoid it. <br><br><blockquote>  <i>The classic question on the interview of ops-engineers and programmers: you wrote in the address bar of the browser meduza.io and pressed Enter.</i>  <i>What will happen?</i>  <i>(The <a href="https://github.com/alex/what-happens-when">answer is 10 pages</a> )</i> </blockquote><br><h3>  Ok, we have specified font-family: PFRegal, "Times New Roman" for our text.  What will happen? </h3><br>  The browser will see if there is a font-face ad for PFRegal.  If it is, the font file will start downloading.  What will readers see those seconds (tens of seconds on 3G) while downloading is taking place? <br><a name="habracut"></a><br>  <b>In Safari: your text will take place on the page, but will remain transparent</b> , that is, invisible to the reader.  To calculate the occupied space, use the fallback font (standard font, in our case, Times New Roman), more on that below. <br><br>  <b>Chrome and Firefox have 3 seconds of transparent text</b> , then the system fallback font is used. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  In IE, the fallback font will immediately appear. </h3><br><blockquote>  <i>IE is not so bad!</i> <i><img src="https://habrastorage.org/getpro/habr/post_images/bf4/956/d1d/bf4956d1dca38a48a059f7f7b8f97bfa.png" alt="image"><br><br></i>  <i>All three approaches <a href="https://www.w3.org/TR/css-fonts-3/">comply with the standard</a> : ‚ÄúIn case where it is rendered, it‚Äôs renowned if it‚Äôs not. of text using a fallback font. "</i> </blockquote><br><h3>  How to deal with transparent text in Safari and Chrome? </h3><br>  There are several ways: <br><br><ol><li>  <b>Make a separate css-file with inline font, connect it after the html code with text.</b>  The HTML document is processed (and displayed on the screen) from the beginning of the file to the end, as it is loaded.  This makes it possible to manage fonts even without using JavaScript.  It is important to make exactly inline, and not connect an external font file.  The method does not work in Desktop Safari and may not work, if there is not enough time between the text rendering request and the css font connection, experiment. <br><br></li><li>  <b>Use <a href="http://keithclark.co.uk/articles/loading-css-without-blocking-render/">javascript hack with invalid media type</a> .</b>  This method allows you to immediately show the text in a fallback font, but in our tests the fallback font hangs a little longer than in the first method.  This approach has problems in IE and FF, but otherwise it seems the most logical to date. <br><br></li><li>  <b>Use the <a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/webfont-optimization">Font Loading API</a></b> , this allows you to start a non-blocking font download immediately upon opening the page.  This is a new js-API and it is supported only by <a href="http://caniuse.com/">Chrome and the latest Safari</a> . </li></ol><br>  All these methods are needed to show the text as soon as it is received by the browser, without delay, using one of the fonts available in the standard OS (fallback font).  <a href="https://meowni.ca/font-style-matcher/">There is a service</a> for selecting the most similar fallback-font. <br><br><h3>  Now it blinks when refreshing! </h3><br>  Yes, solving one problem we created another.  Now the text <i>blinks</i> when it is refreshed, the font changes in front of the reader.  We have to choose - which is more important for us. <br><br>  We in Medusa are optimizing the main page for people opening it using a bookmark in the browser: the first discovery is slow, the subsequent ones are instantaneous without blinking.  Pages of materials are mainly opened from social networks on phones where there is no cache, and we optimize the time the text appears on the screen when it is first loaded. <br><br>  <b>It is important not to forget some system things:</b> <br><br><ol><li>  Configure normal server-side caching (cache headers). <br><br></li><li>  Enable gzip-compression on the server, it saves a lot of mobile traffic, and the readers processors are already powerful enough to overlook the decoding overhead. </li></ol><br><h3>  How to check that everything is working fine?  I have too fast internet </h3><br><ol><li>  Use the built-in Google Chrome. <br><br><img src="https://habrastorage.org/files/646/567/fb3/646567fb38a2447db73b14343a1a5940.png" alt="image"><br>  <font color="#999999">Ability to emulate bad internet.</font>  <font color="#999999">Good 3G - our choice for debugging Medusa</font> <br><br><img src="https://habrastorage.org/files/e65/898/e4a/e65898e4a2e7449e8f821e628e54955e.png" alt="image"><br>  <font color="#999999">Reset the cache by the right mouse button (works only if the Developer Tools are open)</font> <br><br>  As well as superknowledge how to block downloading a specific address or even an address mask in Chrome: enable Developer Tools Experiments in chrome: // flags ‚Üí Open Chrome Developer Tools ‚Üí Settings (hidden in three points in the upper right corner) ‚Üí Experiments ‚Üí <b>Press Shift 6 times</b> ‚Üí Check <i>Request blocking</i> . <br><br><img src="https://habrastorage.org/files/57e/9b6/3bd/57e9b63bd1714074b286615063b42716.png" alt="image"><br>  <font color="#999999">Now you can do it like this</font> <font color="#999999"><img src="https://habrastorage.org/files/2fa/10b/fe1/2fa10bfe184a4658b38ae732754a94db.png"><br></font> <br></li><li>  To debug in Desktop Safari, you need to install <a href="https://developer.apple.com/download/more/%3Fq%3DAdditional%2520Tools">Network Link Conditioner</a> (Apple Developer Account is required for download).  To debug iOS Safari and iOS Webview, use Network Link Conditioner in the settings of your device ( <i>Settings ‚Üí Developer ‚Üí Network Link Conditioner</i> ).  Keep in mind that the speed limit settings will apply to the entire system, not just Safari. </li></ol><br><h3>  How about a new standard? </h3><br>  You're welcome.  Here is the <a href="https://developers.google.com/web/updates/2016/02/font-display">font-display</a> property available in Chrome Canary.  It solves all the problems listed in the article.  Another 2-3 years and you can breathe easy. <br><br><h3>  I am a perfectionist, is there anything else to improve? </h3><br>  Of course!  Squeeze the font file, customizing it for yourself.  Cut out glyphs that you do not use in texts (Regal has over 800 by default).  Disable extra <a href="https://www.microsoft.com/typography/otspec/featurelist.htm">Open Type Features</a> .  For all this you need special software <a href="https://fontforge.github.io/en-US/">[1]</a> , <a href="https://birdfont.org/">[2]</a> or <a href="https://glyphsapp.com/">[3]</a> and an understanding of how the fonts are arranged. <br><br><h3>  Conclusion? </h3><br>  Incorrectly connected custom font worsens page load time, and this leads to the fact that your page is seen by fewer people who do not wait for the download.  There is no ideal way to connect custom fonts on the web, but there are quite good hacks from which you need to choose the most suitable for a particular situation. </div><p>Source: <a href="https://habr.com/ru/post/316640/">https://habr.com/ru/post/316640/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316624/index.html">Recipes. How to install software on servers using VMmanager and DCImanager</a></li>
<li><a href="../316628/index.html">The main thing from the conference for those who create new media - MediaMakers-2016</a></li>
<li><a href="../316630/index.html">As a developer to open your business. Planning</a></li>
<li><a href="../316634/index.html">What is a DBMS in RAM and how it effectively stores data</a></li>
<li><a href="../316636/index.html">What happens to teams when using BaseCamp, Trello, YouTrack, Smartsheet, Slack, YouGile. Review Part 1</a></li>
<li><a href="../316646/index.html">State programming in UIControl</a></li>
<li><a href="../316648/index.html">Monopoly on DDoS: Two hackers have created a botnet of 1 million devices based on Mirai</a></li>
<li><a href="../316650/index.html">Pseudo-encapsulation of legacy include when there is no time to refactor</a></li>
<li><a href="../316652/index.html">Using memcached and redis in high-load projects</a></li>
<li><a href="../316654/index.html">How to become a product manager. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>