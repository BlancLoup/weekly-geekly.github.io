<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we made a board game with a remote control</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Board games - one of the oldest entertainment, which gathers around itself friends, families and just lovers of live communication and emotions during...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we made a board game with a remote control</h1><div class="post__text post__text-html js-mediator-article">  <b>Board games</b> - one of the oldest entertainment, which gathers around itself friends, families and just lovers of live communication and emotions during the game. <br><br>  Today I want to tell you about how my friend and I decided to create our board game, but not simple, but <b>‚Äúsmart‚Äù</b> . <br><br><img src="https://habrastorage.org/webt/hi/un/uj/hiunujcvlkae3fuwpevgcryeyac.jpeg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The second part can be found here: <a href="https://habr.com/post/427227/">link</a> <br><br>  <b><font color="#cc0000">Attention!</font></b>  A lot of pictures on. <br><br><a name="habracut"></a>  Our game is a tabletop <abbr title="Multiplayer Online Battle Arena">MoBA</abbr> , in which each of the players controls their unique hero, with their own characteristics and abilities.  At the moment we have the first version of the prototype, made from Arduino and plywood. <br><br>  The main feature of our game is that there is no need to touch the pieces during the game, the game should move them and display all the abilities used.  The player can only watch and control his hero from a mobile phone. <br><br><div class="spoiler">  <b class="spoiler_title">Several gifs of gameplay</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/2i/db/cf/2idbcfejndeup1axezazvaydgru.gif" alt="gif"><br><br><img src="https://habrastorage.org/webt/im/ty/cg/imtycg9_rhxv4qmycwgdudlbz2c.gif" alt="gif"><br><br><img src="https://habrastorage.org/webt/pa/tk/yb/patkybq5wrm2jsj2a5nqen9gdqq.gif" alt="gif"><br><br><img src="https://habrastorage.org/webt/mz/q6/lt/mzq6ltrawq3xrjgojs8w3yndpau.gif" alt="gif"><br></div></div><br><h3>  What should be able to do "smart" game: </h3><br><ul><li>  Independently move the figures across the field. </li><li>  Highlight the playing field (in whole or in a separate block) in any color. </li><li>  Display the player what he can / cannot / should do, thereby making the rules of the game transparent. </li><li>  Share data with each player's smartphone. </li></ul><br>  This is what our first build build looks like: <br><br><img src="https://habrastorage.org/webt/z8/9c/fw/z89cfwt73jven3ng835kbkzyd4g.jpeg" alt="image"><br><br><h3>  How did the idea </h3><br>  Once I bought a desktop ‚ÄúHorror Arkham‚Äù.  After the store, immediately went to friends to play.  However, unfortunately, none of us had played it before, and we could not master the 26 pages of rules. <br><br>  That is what made me think that it would be great to make a board game that will independently monitor the implementation of the rules, calculate the necessary values ‚Äã‚Äã(without cubes, rulers and a written sheet of paper), etc. <br><br>  One of my friends really liked the idea, and he agreed to participate. <br><br><h3>  Implementation </h3><br>  We had no experience at all in the development of hardware devices (none of us even held Arduino in our hands), and the programming experience was limited to the university and the development of small Android applications.  However, it only added interest and desire. <br><br>  After discussing all the details, we came to the following: <br><br><ul><li>  The figures across the field are driven by CoreXY, on whose carriage a 12V electromagnet is located. </li><li>  For the movement are responsible two stepper motors Nema 17 17HS4401 and drivers DRV8825. </li><li>  The LED strip with pixel addressing WS2812b is used to highlight the field. </li><li>  Arduino Mega 2560 is responsible for management, on which the shield developed by us is installed. </li><li>  4 BLE-modules HM10 are responsible for transferring data between the game and the players' smartphones. </li><li>  It powers all this power supply unit at 12V, 120W power and 5V DC-DC converter. </li><li>  On the side of the smartphone is a mobile application (currently under Android), which in fact is the core of the whole game.  From him on the <abbr title="Bluetooth Low Energy">BLE</abbr> are commands for the movement, on / off of the magnet and LEDs. </li></ul><br><h3>  Mechanics </h3><br>  We didn‚Äôt come to CoreXY right away.  At the very beginning, when implementing kinematics, we were inspired by various DIY guides on the assembly of 3D printers. <br><br>  Below is a photo of our very first attempt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xu/wh/ei/xuwhei7l1e6kvp950-foq3zdqyk.png" alt="image"></div><br>  To create components, we bought a cheap, used 3D printer on which we printed already 6200 meters of plastic and it works fine to this day. <br><br>  However, this option had a lot of flaws: <br><br><ul><li>  The assembly was painful - the slightest inaccuracy in the location of the shafts - the carriage stopped driving. </li><li>  At least one bad bearing - the carriage stopped driving. </li><li>  The height of the whole structure is too high. </li><li>  We did not like the idea that the engine should be located on a moving part. </li></ul><br>  At one point, we came across an article describing the kinematics of CoreXY and decided to choose it.  She has both pluses: <br><br><ul><li>  The assembly is simple, because  All ‚Äúcustom‚Äù parts are created on a CNC or 3D printer. </li><li>  Small height of the structure, which is limited by the height of the stepper motor. </li><li>  Stepper motors are fixed. </li></ul><br>  So and cons: <br><br><ul><li>  Big sizes.  From the picture with the 3D model, it is clear that the total area is much larger than the area of ‚Äã‚Äãthe working surface. </li><li>  Long straps that you need to manage to pull. </li><li>  The specific way to move the carriage, which I will discuss below. </li></ul><br>  To avoid all the problems to the maximum, we made our model in Tinkercad, after which we started ordering and printing components. <br><br><img src="https://habrastorage.org/webt/b5/wy/op/b5wyopk0cg1zu7d-cfaosmh_04a.png" alt="image"><br><br>  The game currently has the following physical parameters: <br>  <b>Width:</b> 780 mm <b>Length:</b> 700 mm <b>Height:</b> 85 mm <br>  <b>Game field:</b> square with a side of 462 mm. <br>  <b>Basis:</b> plywood 12 mm thick, with cut-out holes on the CNC for fastening parts and engines. <br><br><img src="https://habrastorage.org/webt/-f/qe/kc/-fqekc2uul8svmuhp_oy8ys0qoy.png" alt="image"><br><br>  When the model was ready, she seemed tiny and light ... However, when she was alive, she was very big and heavy.  Now we understand that the whole structure should be optimized: <br><br><ul><li>  Replace plywood for a lighter and thinner material. </li><li>  The length and width of the outer contour should not greatly exceed the size of the playing field (you may have to change the kinematics). </li></ul><br>  Below I will describe the features that we encountered during assembly: <br><br><ul><li>  So that the movement of the internal contour and the carriage is smooth and without extraneous sounds, it is important that the belts are parallel to the shafts.  It is also desirable to lubricate the shafts.  We used ordinary oil for sewing machines. </li><li>  At first, we used Uncle Liao's LM8UU as linear bearings, but we often come across defective specimens that had luffing, instantly crumbled and scratched the shaft.  Therefore, it was decided to change them to graphite bushings. </li><li>  There are some features in motion using the kinematics of CoreXY.  So, if we start only 1 stepper motor, then the carriage will go diagonally.  For horizontal movement it is necessary to start the engines in the same direction.  For vertical - in opposite directions. </li></ul><br>  To calculate the distance in X and Y, you must use the following formula: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yc/ke/dy/yckedyvid4iakldgt-qiynerppe.png" alt="image"></div><br><h3>  Playing field </h3><br>  To highlight the playing field, we chose the LED strip with pixel addressing WS2812b, which is great for our purposes. <br><br>  The WS2812b is a 4-pin RGB LED in an SMD5050 package: VDD, VSS, DIN and DOUT. <br><br>  What are the requirements for the field: <br><br><ul><li>  Small thickness, so that the electromagnet could drag the figure behind him. </li><li>  Smooth surface on which the slide will be carried out without problems. </li></ul><br>  As a result, the playing field conventionally consists of 3 parts: the substrate, to which the LED tape is attached, the tape itself and the surface coating, along which the figures slide. <br><br>  The main problem we are facing is what to make the substrate from? <br>  At the moment we are using plexiglass, in which we have cut out recesses under the tape with a depth of 2 mm (height of the tape and the LED) on the CNC.  Naturally, this sheet has completely lost at least some stiffness and flexes strongly along the cutting lines.  Therefore, we simply glued the substrate to the surface.  Perhaps in the next version we replace plexiglass with monolithic polycarbonate. <br><br><img src="https://habrastorage.org/webt/dt/wg/sl/dtwgslb4nrue7fzadqak0fny0pw.jpeg" alt="image"><br><br>  As the surface, we also chose all plexiglas, which was lying around after repair on a balcony, 4 mm thick, milky, with good dispersion. <br><br>  As a result, after sitting in the evening with a soldering iron, we got the following: <br><br><img src="https://habrastorage.org/webt/q-/m7/_1/q-m7_1zqignjoubsexhsuv4_yro.jpeg" alt="image"><br><br>  There are tapes with different density of LEDs.  Usually it is: 144, 90, 60, 30 per meter.  We stopped on the tape with 30 LEDs per meter, because  using a tape with a higher density of LEDs - it is difficult to move the figures without collisions and the power required for power increases. <br><br>  It is worth noting that the LEDs are connected in series.  Therefore, if your first LED fails, the rest will not work. <br><br>  Our field has a size - 14 * 14 cells, only 196 pixels.  The tape works with a voltage of 5V.  One pixel in the tape consists of 3 LEDs - R, G, B, each of which consumes 20 mA at maximum brightness.  It‚Äôs easy to calculate that if we want to light all 196 pixels in white, then we need almost 12 A ... <br><br>  Finding a compact power supply unit or DC-DC converter that can deliver such a current at 5V is very problematic.  Therefore, we decided that in our game the field should not be filled by more than 60%, and do not use white / gray color (the color at which all 3 LEDs turn on), i.e.  40 mA maximum per 1 pixel.  The result is that the table should not consume more than 5 A. <br><br>  Often I saw a recommendation that it is necessary to feed the tape from two sides so that there is no voltage loss.  But we connect to the tape on the one hand, every 100 LEDs, and we do not observe visible voltage subsidence. <br><br><h3>  Electronics </h3><br>  Management of all parts of the game takes place with the help of the Arduino Mega 2560. The following functions are assigned to it: <br><br><ul><li>  Perform a calibration, as a result of which we will know how many steps a stepping motor must take to overcome 1 cell. </li><li>  Receive commands and data from the mobile application and send the execution status back to BLE. </li><li>  Move the carriage from point A to point B according to the coordinates of the data received from the mobile application. </li><li>  Turn on / off the electromagnet. </li><li>  Light a certain pixel on the table in a certain color.  The pixel number and color is transmitted by the mobile application. </li></ul><br>  The first prototype was assembled on a breadboard and included the following components: <br><br><ul><li>  Arduino Mega 2560; </li><li>  2 drivers of stepping motor DRV8825; </li><li>  4 limit switches; </li><li>  BLE-module HM-10; </li><li>  Transistor IRF530N - to control the electromagnet; </li><li>  BP MeanWell 12V 10A; </li><li>  DC-DC MeanWell down converter from 12V to 5V, 10A; </li></ul><br><img src="https://habrastorage.org/webt/jk/gn/od/jkgnodh2zjzrvfiaes_tkimqpl4.jpeg" alt="image"><br><br>  After we were convinced that everything was working, we decided that we had to make our own shield for the Arduino Mega and finally get rid of the installation and the heap of wires. <br><br>  In connection with the lack of experience in the development of software, we decided to entrust this business to a professional.  As a result, one of our friends fully developed the board and made the installation of all components.  The result can be seen below: <br><br><img src="https://habrastorage.org/webt/sk/fl/pe/skflperthnt8v-cjuurkqviluyy.jpeg" alt="image"><br><br>  I can not judge the quality of performance due to lack of experience, but the board works without complaints.  Schematic diagram can be found <a href="https://drive.google.com/file/d/1JvkRnWktiraghZn6E__7R14AK7k-Y0-w/view%3Fusp%3Dsharing"><b>here</b></a> . <br><br><h3>  Mobile app </h3><br>  Mobile application - the "brain" of our game.  It is the application that contains all the information about the state of the game, characters, etc.  Anroid was chosen as the development platform, the main requirement is BLE support (since it is planned to add a version of the game for iOS in the future). <br><br>  Unlike electronics, we had little experience in developing mobile applications, so we planned to complete this stage fairly quickly.  However, as usual, everything did not turn out as planned. <br><br><img src="https://habrastorage.org/webt/av/c0/ow/avc0ow5y6otmc1xha2fgv6i04ci.jpeg" alt="image"><br><br>  We quickly realized that in fact we would have to write a full-fledged mobile game, in which the means of displaying information is not only the screen of a mobile phone, but also the surface of a board game. <br><br>  The main functionality of the current application: <br><br><ul><li>  Search for BLE devices, identification of a suitable device for connection.  Identification includes ‚Äúhandshakes‚Äù - the phone must make sure that the connected device is really a bluetooth module of the board game, not a TV. </li><li>  The choice of players (at least 2) of the available characters, which currently 4. </li><li>  Providing all the necessary information to the current player: about available abilities, about their <abbr title="ability recovery time">cooldowns</abbr> , about opponents, etc. </li><li>  Making moves - each player controls his own moves with the help of a ‚Äújoystick‚Äù, which he selects cells for applying abilities, moving, etc. </li></ul><br>  We have no feelings of beauty, as well as friends of UX / UI-designers, so they did the design themselves as best they could.  In the future, we plan to add a lore, a description, as well as a <abbr title="Player versus environment">PVE</abbr> mode in which players will fight against the bosses in the arena. <br><br><h3>  Result </h3><br>  At the moment we have a fully functional prototype in which you can play (albeit on 1 smartphone), and on which we polish the rules and mechanics of the game.  We spent about a year creating it, working on weekends and occasional evenings, when there was free time. <br><br>  Our plan is ambitious: to find like-minded people, to refine the prototype, to completely ‚Äúlick‚Äù the balance and rules of the game and try to get on <b>Kickstarter</b> , because  it will be just a fantastic experience. <br><br>  If it is interesting, in the next article I will tell you more about the mobile application, the game itself, how we made our miniatures and what came of it. </div><p>Source: <a href="https://habr.com/ru/post/425629/">https://habr.com/ru/post/425629/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../425619/index.html">Multi-armed gang problem - compare epsilon-greedy strategy and Thompson sampling</a></li>
<li><a href="../425621/index.html">A company that recycles atmospheric carbon dioxide starts methane production.</a></li>
<li><a href="../425623/index.html">Photo tour of the "Key" coworking</a></li>
<li><a href="../425625/index.html">Spent, or why localizers fucking translate games</a></li>
<li><a href="../425627/index.html">IaaS for developing services: who and why switched to virtual infrastructure</a></li>
<li><a href="../425631/index.html">The social network "Vkontakte" told about how and why it provides user data</a></li>
<li><a href="../425633/index.html">Volkswagen + Microsoft = Internet technology for a comfortable ride</a></li>
<li><a href="../425635/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ333 (October 1 - 7, 2018)</a></li>
<li><a href="../425637/index.html">Algorithm for establishing a connection in the SSH protocol</a></li>
<li><a href="../425641/index.html">Residents of the Canadian city have developed a "Uber-service" with buses, not cars</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>