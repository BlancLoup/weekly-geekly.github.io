<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What will happen in Rancher 2.0 and why does it switch to Kubernetes?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A week ago, the developers of Rancher presented a preliminary release of their future major version - 2.0, - simultaneously announcing the transition ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What will happen in Rancher 2.0 and why does it switch to Kubernetes?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/59/d3/1a/59d31af5695b1007077590.png"><br><br>  A week ago, the developers of Rancher <a href="http://rancher.com/announcing-rancher-2-0/">presented a</a> preliminary release of their future major version - 2.0, - simultaneously announcing the transition to Kubernetes as a single basis for container orchestration.  What prompted the developers to go this way? <a name="habracut"></a><br><br><h2>  Background: Cattle </h2><br>  Rancher 1.0 was released in March last year, and today in the world, according to the company Rancher Labs, there are more than 10 thousand of its existing installations and more than 100 commercial users.  The first version of Rancher included <a href="https://github.com/rancher/rancher/wiki/Overview%253A-What-is-Cattle">Cattle</a> , which, being a ‚Äúhigh-level component written in Java‚Äù, was called the ‚Äúbasic orchestration engine‚Äù and ‚Äúthe main loop of the entire system‚Äù.  In essence, Cattle was not even a framework for orchestrating containers, but a special layer managing metadata (+ resources, relationships, states, etc.) and transmitting all real tasks for execution to external systems. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Cattle supported many solutions available on the market: Docker Swarm, Apache Mesos, Kubernetes, because, as the authors themselves write, ‚ÄúRancher users liked the idea of ‚Äã‚Äãimplementing a management platform that gives them the freedom to choose a framework to orchestrate containers‚Äù. <br><br>  However, the growing popularity of Kubernetes has contributed to the emergence of more and more new requirements imposed by Rancher users for the capabilities and convenience of interaction with this system.  At the same time, Rancher Labs management‚Äôs view on current Kubernetes problems and its prospects also changed. <br><br><h2>  Kubernetes: yesterday, today, tomorrow </h2><br>  In 2015, when Ranber Labs started working with Kubernetes, i.e.  adding its support to its platform, the main problem in K8s, according to the developers, was the installation and initial configuration of the system.  Therefore, the pride of the Kubernetes primary support announcement in the Rancher v0.63 release (March 17, 2016) sounded like this: ‚ÄúNow you can start the Kubernetes environment in one click and in 5-10 minutes get access to a fully deployed cluster‚Äù. <br><br>  Time passed, and the next major obstacle to the use of Kubernetes, in the opinion of the head of Rancher Labs, was the continued operation and updating of clusters.  By the end of last year, this problem ceased to be serious - thanks to the active development of utilities such as <a href="https://github.com/kubernetes/kops">kops</a> and the emerging trend of offering Kubernetes as a service (Kubernetes-as-a-Service).  This confirmed the <a href="https://www.nextplatform.com/2015/10/16/stacking-up-a-modern-platform/">thoughts of</a> Joe Beda, founder of the Kubernetes project at Google, and now the CEO of Heptio, that Kubernetes will be the next platform for launching modern applications, or rather ‚ÄúKubernetes will become a key part of this platform, but the story on it definitely won't end. ‚Äù <br><br>  But more recent events, such as the <a href="https://mesosphere.com/blog/kubernetes-dcos/">support of Kubernetes</a> in DC / OS from Mesosphere and the official connection to the Kubernetes ecosystem of IT giants like <a href="https://azure.microsoft.com/en-us/blog/announcing-cncf/">Microsoft</a> and <a href="https://blogs.oracle.com/developers/oracle-joins-cncf-doubles-down-further-on-kubernetes">Oracle,</a> can serve as another and more objective confirmation.  The latest addition to CNCF alone prompted the online publication ARCHITECHT <a href="http://news.architecht.io/issues/with-oracle-on-board-kubernetes-has-to-be-the-de-facto-standard-for-container-orchestration-73880">to state</a> that "now, from Oracle on the ship, Kubernetes should become the de facto standard for container orchestration." <br><br>  At Rancher Labs, they are ‚Äúputting‚Äù on the fact that the next step on the path of Kubernetes will be to turn it into a ‚Äúuniversal standard for infrastructure‚Äù, which will happen when the notorious Kubernetes-as-a-Service becomes a typical service for most infrastructure providers: <br><br><blockquote>  ‚ÄúThe DevOps team will no longer need to manage the Kubernetes clusters independently.  The only difficulty that remains is to manage and use Kubernetes clusters accessible from everywhere. ‚Äù </blockquote><br>  The engineers of the company took up the thoughts about this for a major update of Rancher - version 2.0. <br><br><h2>  Rancher 2.0 </h2><br>  As in Rancher 1.0, in version 2.0, the platform consists of a server (to manage the entire installation) and agents (installed on all accepted hosts).  The main difference of Rancher 2.0 from 1.0 is that Kubernetes is now built into the server.  This means that when you start the Docker-image <code>rancher/server</code> Kubernetes cluster starts, and each new host you add becomes a part of it (it has a <i>kubelet</i> ).  In addition, you can create additional clusters in addition to this wizard, as well as import existing clusters using kops or from external providers like Google (GKE).  The Rancher agent runs on all embedded and imported clusters. <br><br>  Above all these many Kubernetes clusters, Rancher implements common layers for centralized management (authentication and RBAC, provisioning, updates, monitoring, backups) and interaction with them (web user interface, API, CLI): <br><br><img src="https://habrastorage.org/webt/59/d2/28/59d228e88b490280345338.png"><br><br>  In more detail (up to the host level), the Rancher 2.0 architecture looks like this: <br><br><img src="https://habrastorage.org/webt/59/d2/fd/59d2fde2ee3b2094610386.png"><br><br>  Among other features of this solution, I will highlight the following: <br><br><ul><li>  The <i>Netes-agent shown</i> in the diagram is a component that is responsible for implementing the definitions of Rancher containers in Kubernetes.  This agent connects to all Kubernetes clusters, making them manageable. </li><li>  Kubernetes wizard built into Rancher 2.0 is its own distribution kit including <i>API Server</i> , <i>Scheduler</i> , <i>Controller Manager</i> .  These three components are combined into a single process running in a single container.  By default, the database backend of all clusters is placed in one database (‚Äúthis greatly simplifies the management of embedded clusters in Rancher‚Äù). </li><li>  There is only one component left in Rancher written in Java (all the others are written in the Go language) - this is the <i>Core controller</i> .  It implements Rancher services in Kubernetes: services, load balancers, DNS records.  Along with <i>Websocket proxy</i> and <i>Compose executor,</i> it is part of the <i>Rancher Controller</i> , launched on the Rancher server (see the diagram above). </li><li>  Tom Rancher is <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">PersistentVolumeClaims</a> (PVC).  There are three types of volumes that differ in their life cycle: <i>Container scoped</i> (created when creating a container, deleted when removing a container), <i>Service scoped</i> (similarly for services), <i>Environment scoped</i> (exist while there is an environment). </li><li>  Rancher IPSec or VXLAN overlay solutions (existed before), as well as third-party <a href="https://habrahabr.ru/company/flant/blog/329830/">CNI plug</a> - <a href="https://habrahabr.ru/company/flant/blog/329830/">ins</a> for embedded clusters are supported for the network.  Two new network modes are also offered for launching containers in isolated space: ‚Äúlayer 3 routed‚Äù (per host subnet) and ‚Äúlayer 2 flat‚Äù. </li><li>  Rancher 2.0 is positioned as a solution that works with "standard SQL-DBMS, such as MySQL."  To do this, you are offered both to use ready-made Database-as-a-Service solutions (for example, RDS from AWS), and to customize them yourself using Galera Cluster for MySQL or MySQL NDB Cluster. </li><li>  Planned scalability limits: 1000 clusters, 1000 hosts per cluster (and 10 thousand hosts on all clusters), 30 thousand containers per cluster (and 300 thousand containers on all clusters). </li><li>  Currently supported Docker versions are: 1.12.6, 1.13.1, 17.03-ce, 17.06-ce <i>(which is close to the compatibility list of <a href="https://habrahabr.ru/company/flant/blog/338230/">Kubernetes 1.8</a> released recently)</i> . </li></ul><br>  Details about the technical device Rancher 2.0 are available in <a href="https://cdn2.hubspot.net/hubfs/468859/Whitepapers/Rancher%25202.0%2520Technical%2520Architecture%2520-%2520Sept%25202017.pdf">this PDF document</a> . <br><br>  In addition, of course, the developers have taken care of improvements in the interface for the end user, making Rancher UI (and the application catalog) even easier and leaving advanced users access to kubectl and Kubernetes dashboard.  A 15-minute <a href="https://www.youtube.com/watch%3Fv%3DMa6FsuWI2Nc">Rancher 2.0 presentation</a> has been posted on YouTube, demonstrating both internal and external changes. <br><br>  The current version of Rancher 2.0, positioned as a tech preview and released a week ago, is <a href="https://github.com/rancher/rancher/releases/tag/v2.0.0-alpha6">v2.0.0-alpha6</a> .  The final release is scheduled for the 4th quarter of 2017. <br><br><h2>  CoreOS and fleet </h2><br>  I will finish the story about Rancher 2.0 with a completely different example - from CoreOS.  The fact is that with their <a href="https://github.com/coreos/fleet">fleet</a> ‚Äî a fairly well-known Open Source product in the DevOps world ‚Äî a similar story happened when viewed in the context of the ubiquitous adaptation of Kubernetes.  Characterized as a ‚Äúdistributed init system‚Äù, fleet tied systemd and etcd to use systemd on a cluster scale (instead of a single machine).  It was created in order to become "the basis for a higher level orchestration". <br><br>  At the end of last year, the fleet project <a href="https://github.com/coreos/fleet/commit/9635dbb7333e0c5bcd5ce70dc15052cac0b1463f">changed its</a> status from ‚Äútested in production‚Äù to ‚Äúno longer being developed or maintained‚Äù, and at the beginning of this year they clarified that the fleet image would cease to be part of Container Linux from February 1, 2018.  Why? <br><br><blockquote>  Instead, CoreOS recommends installing Kubernetes for all cluster needs. </blockquote><br>  A <a href="https://coreos.com/blog/migrating-from-fleet-to-kubernetes.html">note</a> on the CoreOS blog (dated February 2017) on this topic clarifies that Kubernetes "is becoming the de facto standard for orchestrating open source containers."  The authors also claim: "For a number of technical and market reasons, Kubernetes is the best tool for managing container infrastructure and its automation on a large scale." <br><br><h2>  PS </h2><br>  Read also in our blog: <br><br><ul><li>  Kubernetes success story in production: ‚Äú <a href="https://habrahabr.ru/company/flant/blog/334140/">No. 1: 4,200 pods and TessMaster from eBay</a> ‚Äù, ‚Äú <a href="https://habrahabr.ru/company/flant/blog/334770/">No. 2: Concur and SAP</a> ‚Äù, ‚Äú <a href="https://habrahabr.ru/company/flant/blog/335814/">No. 3: GitHub</a> ‚Äù; </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/338230/">Kubernetes 1.8: review of major innovations</a> ‚Äù; </li><li>  " <a href="https://habrahabr.ru/company/flant/blog/331188/">Our experience with Kubernetes in small projects</a> " <i>(video of the report, which includes an introduction to the technical device Kubernetes);</i> </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/327338/">Why do you need Kubernetes and why is it more than PaaS?</a>  ". </li></ul></div><p>Source: <a href="https://habr.com/ru/post/339120/">https://habr.com/ru/post/339120/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339108/index.html">Profiling PL / SQL code with IDE PL / SQL Developer</a></li>
<li><a href="../339110/index.html">In the paragraph, everything should be fine</a></li>
<li><a href="../339112/index.html">What follows the web?</a></li>
<li><a href="../339116/index.html">3 cases of real estate data analysis. Data Science Week 2017. Review. Part 1</a></li>
<li><a href="../339118/index.html">Three career paths in IT: founder, leader or employee</a></li>
<li><a href="../339122/index.html">Debugging PL / SQL code for an external DB session</a></li>
<li><a href="../339124/index.html">We write the generator of ip-addresses in Python with whistles, dudels and Tkinter GUI</a></li>
<li><a href="../339126/index.html">Docker security issues</a></li>
<li><a href="../339128/index.html">VMware vCloud Director. What's new in version 9.0?</a></li>
<li><a href="../339136/index.html">A selection of interesting events for the week in Moscow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>