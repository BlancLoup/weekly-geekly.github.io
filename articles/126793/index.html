<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Irregular windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Start 
 Sometimes it is necessary to have a window of ‚Äúirregular‚Äù (not rectangular) shape, be it a splash screen, or a desktop widget. 




 The Windo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Irregular windows</h1><div class="post__text post__text-html js-mediator-article"><h4>  Start </h4><br>  Sometimes it is necessary to have a window of ‚Äúirregular‚Äù (not rectangular) shape, be it a splash screen, or a desktop widget. <br><br><img src="http://image.kz/img/9d/9d7734348250f52e45a73bd3ce2b0c5d.png" alt="image"><br><a name="habracut"></a><br><br>  The Windows API has several functions with the help of which you can create "wrong" windows, such as: <strong>CreateEllipticRgn</strong> , <strong>CreateRectRgn</strong> , <strong>CreatePolygonRgn</strong> , <strong>CreateRoundRectRgn</strong> , <strong>CombineRgn</strong> , etc. unpleasant teeth, it is impossible to make a full-fledged shadow, and writing code that creates a window of complex shape sometimes requires a lot of effort. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Starting with Windows 2000, the windows have an expanded <strong>WS_EX_LAYERED</strong> style that makes the window multi-layered, and several API functions were added to work with such windows, one of which is <strong>UpdateLayeredWindow</strong> that updates the position, size, shape, content and transparency of a multi-layered window.  This function allows you to create a window based on the image, including <strong>PNG</strong> , taking into account the alpha channel.  Creating a window shape based on a previously prepared image is much more convenient and easier than working with regions, but this method also has its drawback.  It is not possible to display any components, such as buttons, text fields, etc., on a multi-layered window. This is a consequence of the fact that the operating system takes over the entire window redrawing process and the standard <strong>WM_PAINT</strong> message is no longer sent to the window.  For the most part, all kinds of screensavers, widgets and other decorations do not require the presence of any additional components, or require them in a minimum number of, and therefore you can close your eyes to the disadvantage. <br><br><h4>  Example </h4><br>  Next, I would like to give a small clear example of the use of multilayer windows.  Since it all comes down to calling API functions, a programming language can be any, but I have Visual Studio installed at work, so I will write in <strong>VB.NET</strong> .  I will not describe the functions used by the API; I‚Äôd rather give below the links to the description from the MSDN site, since the purpose of the article is to show their practical application. <br><br><ol><li>  First you need to draw our future window in your favorite graphics editor, I painted in Photoshop, always of irregular shape and always with transparency, in order to feel all the delights of multi-layered windows, and save it in <strong>PNG format</strong> .  I got this sticker: <br><img src="http://image.kz/img/43/436d1a6029ab6ee8861516839062931d.png" alt="image"><br></li><li>  Next, we create a new project in Visual Studio and add our image to the resource under the name ‚ÄúSticker‚Äù; in the only form in the project we remove all unnecessary headers and borders. <br></li><li> You need to define the API functions and structures that will be needed in the process.  I usually do this in a separate class. <br><pre> <code class="hljs pgsql"><code>Namespace <span class="hljs-keyword"><span class="hljs-keyword">System</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Win32API <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Const WS_EX_LAYERED = &amp;H80000 <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Const ULW_ALPHA <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32 = &amp;H2 <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Const AC_SRC_OVER <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte = &amp;H0 <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Const AC_SRC_ALPHA <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte = &amp;H1 <span class="hljs-string"><span class="hljs-string">' ()'</span></span> &lt;StructLayout(LayoutKind.Sequential)&gt; _ <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Structure <span class="hljs-type"><span class="hljs-type">Point</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32 <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> y <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32 <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Sub <span class="hljs-built_in"><span class="hljs-built_in">New</span></span>(ByVal x <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32, ByVal y <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32) Me.x = x Me.y = y <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Structure <span class="hljs-string"><span class="hljs-string">''</span></span> &lt;StructLayout(LayoutKind.Sequential)&gt; _ <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Structure Size <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> cx <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32 <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> cy <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32 <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Sub <span class="hljs-built_in"><span class="hljs-built_in">New</span></span>(ByVal cx <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32, ByVal cy <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32) Me.cx = cx Me.cy = cy <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Structure <span class="hljs-string"><span class="hljs-string">'     '</span></span> &lt;StructLayout(LayoutKind.Sequential, Pack:=<span class="hljs-number"><span class="hljs-number">1</span></span>)&gt; _ <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Structure BLENDFUNCTION <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> BlendOp <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> BlendFlags <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> SourceConstantAlpha <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> AlphaFormat <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Sub <span class="hljs-built_in"><span class="hljs-built_in">New</span></span>(ByVal BledOp <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte, ByVal BlendFlags <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte, ByVal SourceContrastAlpha <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte, ByVal AlphaFormat <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte) Me.BlendOp = BledOp Me.BlendFlags = BlendFlags Me.SourceConstantAlpha = SourceContrastAlpha Me.AlphaFormat = AlphaFormat <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Structure <span class="hljs-string"><span class="hljs-string">'         '</span></span> &lt;DllImport("user32.dll")&gt; _ <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Shared <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetDC(ByVal hWnd <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-string"><span class="hljs-string">'     '</span></span> &lt;DllImport("gdi32.dll")&gt; _ <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Shared <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> CreateCompatibleDC(ByVal hDC <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-string"><span class="hljs-string">' '</span></span> &lt;DllImport("user32.dll", ExactSpelling:=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)&gt; _ <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Shared <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> ReleaseDC(ByVal hWnd <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr, ByVal hDC <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Integer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-string"><span class="hljs-string">' '</span></span> &lt;DllImport("gdi32.dll")&gt; _ <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Shared <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> DeleteDC(ByVal hdc <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-string"><span class="hljs-string">'    '</span></span> &lt;DllImport("gdi32.dll", ExactSpelling:=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)&gt; _ <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Shared <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> SelectObject(ByVal hDC <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr, ByVal hObject <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-string"><span class="hljs-string">' '</span></span> &lt;DllImport("gdi32.dll")&gt; _ <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Shared <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> DeleteObject(ByVal hObject <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-string"><span class="hljs-string">'  '</span></span> &lt;DllImport("user32.dll")&gt; _ <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Shared <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> UpdateLayeredWindow(ByVal hwnd <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr, ByVal hdcDst <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr, ByRef pptDst <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Win32API.Point, ByRef psize <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Win32API.Size, ByVal hdcSrc <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr, ByRef pprSrc <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Win32API.Point, ByVal crKey <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32, ByRef pblend <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Win32API.BLENDFUNCTION, ByVal dwFlags <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Int32) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Namespace</code></code> </pre><br></li><li>  <strong>We write this and all subsequent code to the class of our only form in the project.</strong>  First you need to describe a few local variables, we need them in the process. <br><pre> <code class="hljs php"> <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> _ScreenDC <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr = IntPtr.Zero <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> _MemDC <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr = IntPtr.Zero <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> _BitmapHandle <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr = IntPtr.Zero <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> _OldBitmapHandle <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> IntPtr = IntPtr.Zero <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> _Size <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Win32API.Size = Nothing <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> _PoinSource <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Win32API.Point = Nothing <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> _TopPos <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Win32API.Point = Nothing <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> _Blend <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Win32API.BLENDFUNCTION = Nothing <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> _Opacity <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte = <span class="hljs-number"><span class="hljs-number">255</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> bmpDest <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Bitmap = Nothing <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> bmpSrc <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Bitmap = Nothing</code> </pre><br></li><li>  Making the window multi-layered.  In .NET, you can assign some window properties just before creating it (calling the <strong>CreateWindowEx</strong> function API) by overriding the property of the <strong>CreateParams</strong> class. <br><pre> <code class="hljs pgsql"> Protected Overrides ReadOnly Property CreateParams() <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Forms.CreateParams <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> Dim CP <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> CreateParams = MyBase.CreateParams CP.ExStyle = CP.ExStyle <span class="hljs-keyword"><span class="hljs-keyword">Or</span></span> Win32API.WS_EX_LAYERED <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> CP <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Property</code> </pre><br></li><li>  Creating an update function for a multi-layered window based on the image and the degree of overall transparency (from 0 to 255). <br><pre> <code class="hljs pgsql"> <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Sub SetImage(ByRef Bitmap <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Bitmap, ByVal Opacity <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Byte) <span class="hljs-string"><span class="hljs-string">'    '</span></span> _ScreenDC = Win32API.GetDC(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-string"><span class="hljs-string">'    '</span></span> _MemDC = Win32API.CreateCompatibleDC(_ScreenDC) <span class="hljs-string"><span class="hljs-string">' '</span></span> _BitmapHandle = IntPtr.Zero <span class="hljs-string"><span class="hljs-string">'  '</span></span> _OldBitmapHandle = IntPtr.Zero Try <span class="hljs-string"><span class="hljs-string">'  '</span></span> _BitmapHandle = Bitmap.GetHbitmap(Color.FromArgb(<span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-string"><span class="hljs-string">'     '</span></span> _OldBitmapHandle = Win32API.SelectObject(_MemDC, _BitmapHandle) <span class="hljs-string"><span class="hljs-string">'  ,      '</span></span> _Size = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Win32API.Size(Bitmap.Width, Bitmap.Height) _PoinSource = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Win32API.Point(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) _TopPos = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Win32API.Point(Me.Left, Me.Top) <span class="hljs-string"><span class="hljs-string">'  BLENDFUNCTION'</span></span> _Blend = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Win32API.BLENDFUNCTION(Win32API.AC_SRC_OVER, <span class="hljs-number"><span class="hljs-number">0</span></span>, Opacity, Win32API.AC_SRC_ALPHA) <span class="hljs-string"><span class="hljs-string">'  '</span></span> Win32API.UpdateLayeredWindow(Me.Handle, _ScreenDC, _TopPos, _Size, _MemDC, _PoinSource, <span class="hljs-number"><span class="hljs-number">0</span></span>, _Blend, Win32API.ULW_ALPHA) Finally Win32API.ReleaseDC(IntPtr.Zero, _ScreenDC) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> _BitmapHandle &lt;&gt; IntPtr.Zero <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Win32API.SelectObject(_MemDC, _OldBitmapHandle) Win32API.DeleteObject(_BitmapHandle) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> Win32API.DeleteDC(_MemDC) _Size = <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> _PoinSource = <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> _TopPos = <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> _Blend = <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Try <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub</code> </pre><br></li><li>  When loading an instance of a form, we form an image (we write the text on a sticker, just a static) and then we transfer it to the update function. <br><pre> <code class="hljs pgsql"> Private Sub FormSticker_Load(ByVal sender <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>, ByVal e <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.EventArgs) Handles Me.<span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> bmpSrc = My.Resources. bmpDest = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Bitmap(bmpSrc.Width, bmpSrc.Height) <span class="hljs-keyword"><span class="hljs-keyword">Using</span></span> g <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Graphics = Graphics.FromImage(bmpDest) <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> g .InterpolationMode = Drawing2D.InterpolationMode.NearestNeighbor .SmoothingMode = Drawing2D.SmoothingMode.AntiAlias .TextRenderingHint = Drawing.Text.TextRenderingHint.AntiAlias <span class="hljs-string"><span class="hljs-string">' '</span></span> .DrawImage(bmpSrc, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, bmpSrc.Width, bmpSrc.Height) <span class="hljs-string"><span class="hljs-string">' '</span></span> Dim sf <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> StringFormat(StringFormatFlags.LineLimit) sf.Alignment = StringAlignment.Center sf.LineAlignment = StringAlignment.Center .DrawString("       ", Me.Font, <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> SolidBrush(Me.ForeColor), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Rectangle(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, bmpDest.Width - <span class="hljs-number"><span class="hljs-number">20</span></span>, bmpDest.Height - <span class="hljs-number"><span class="hljs-number">20</span></span>), sf) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Using</span></span> Me.SetImage(bmpDest, Me._Opacity) bmpDest.Dispose() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub</code> </pre><br></li></ol><br>  Well, that seems to be all, we launch and see what we have done (the result on the first image). <br><br><h5>  Links </h5><br><ol><li>  Descriptions of the structures and functions used <br>  <a href="http://msdn.microsoft.com/ru-ru/library/dd162805(v%3DVS.85).aspx">Point</a> , <a href="http://msdn.microsoft.com/ru-ru/library/dd183393(v%3DVS.85).aspx">Size</a> , <a href="http://msdn.microsoft.com/ru-ru/library/dd183489(v%3DVS.85).aspx">GetDC</a> , <a href="http://msdn.microsoft.com/en-us/library/dd162920(VS.85).aspx">ReleaseDC</a> , <a href="http://msdn.microsoft.com/ru-ru/library/dd183533(v%3DVS.85).aspx">DeleteDC</a> , <a href="http://msdn.microsoft.com/en-us/library/dd162957(VS.85).aspx">SelectObject</a> , <a href="http://msdn.microsoft.com/en-us/library/dd183539(VS.85).aspx">DeleteObject</a> , <a href="http://msdn.microsoft.com/ru-ru/library/ms633556(v%3DVS.85).aspx">UpdateLayeredWindow</a> </li><li>  <a href="http://ifolder.ru/25251681">Sample Source</a> </li></ol><br><h4>  To be continued... </h4></div><p>Source: <a href="https://habr.com/ru/post/126793/">https://habr.com/ru/post/126793/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126787/index.html">Headset with PS3 Headset Overview</a></li>
<li><a href="../126788/index.html">5 useful tricks</a></li>
<li><a href="../126790/index.html">WPF Applications Deployment: merging .NET assemblies into a single executable file</a></li>
<li><a href="../126791/index.html">In the wake of the post "Rapid development of web applications in Java"</a></li>
<li><a href="../126792/index.html">Spender or Home Bookkeeping for those who are desperate to keep it</a></li>
<li><a href="../126795/index.html">What to do if there is no time to write a business plan</a></li>
<li><a href="../126796/index.html">Radically redesigned Evernote extension for Firefox</a></li>
<li><a href="../126797/index.html">New groups connect to Chrome Hackathons and GTUGs and Google!</a></li>
<li><a href="../126799/index.html">Red Calendar Day: New Startup Weekend</a></li>
<li><a href="../126800/index.html">Spin XSS on Yandex (fixed)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>