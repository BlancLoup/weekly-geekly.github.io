<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About the power interchange with examples</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When I participated in the 7400 contest , I realized that many of the presented logic circuits for reliable operation lack the simplest security featu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About the power interchange with examples</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/632/b37/955/632b37955c8065b4bad1b91413adc720.jpg" align="left">  When I participated in the <a href="http://www.7400contest.com/">7400 contest</a> , I realized that many of the presented logic circuits for reliable operation lack the simplest security features.  One of the most common design flaws was the lack of blocking tanks.  Later, after reading <a href="http://www.maxim-ic.com/app-notes/index.mvp/id/4429">an article on Murphy's law</a> , I decided to write a little about decoupling and blocking capacitors. <br><a name="habracut"></a><br>  As a person who can be called an old-timer in the field of electronics, I became acquainted with the problem of lack of isolation from my own experience.  I collected my first high-speed circuit as an intern at a major electronics company.  That scheme, a digital frequency meter, was assembled on the logic of the 74Fxx family and operated at a frequency of 11 MHz (at that time it was considered very much).  It was a 23 √ó 16 cm board (Double <a href="http://en.wikipedia.org/wiki/Eurocard_(printed_circuit_board)">Eurocard</a> ) containing about 40 microcircuits connected by <a href="http://en.wikipedia.org/wiki/Wire_wrap">wire wrap</a> .  When it came time to turn it on, I saw that the circuit was not working as it should, but it gave out complete nonsense. <br><br>  After checking the assembly several times, I told my manager about the problem, and he glanced at the board and said: ‚ÄúThere are not enough blocking capacitors.  Put them on food near each microcircuit, then we'll talk. ‚ÄùCompletely confused, I did, as was said, and - lo and behold!  - it all worked right away.  Why the seemingly unimportant capacity made the circuit work?  My supervisor told me about the surge current when switching, the inductance of the conductors and the decoupling.  I admit that several years passed before I really understood what he was saying then, but the lesson was learned: always to put capacitors on the power of digital microcircuits. <br><br>  The terms ‚Äúblocking capacitor‚Äù and ‚Äúdecoupling‚Äù are not random words, but have a definite meaning in this context: <br>  <em>decoupling</em> is an action aimed at (partial) separation of the power supply circuits of the microcircuit from the common power source; <br>  <em>blocking capacitor</em> - a capacitor installed in such a way that it shunts the power supply to the microchip and acts as a local power source. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Why is this all so important?  Look, for example, here: <br><br><img src="https://habrastorage.org/storage2/39f/819/97e/39f81997e656f99c943fdaf3328eb37d.jpg"><br>  <i>Figure 1. No blocking capacitors.</i> <br><br>  Does it look like a <em>digital</em> signal?  This nonsense you get without blocking capacitors. <br><br>  Please note that the <b>clock frequency is not important</b> .  The problem lies in the rising and falling edges of the signal.  So, the same considerations apply to systems operating at 1 Hz, 20 kHz or 50 MHz.  The frequencies used in the examples below are chosen so that they can be conveniently observed on an oscilloscope. <br><br>  It should be noted that at high frequency failure occurs faster than at low, due to a larger number of fronts per unit time.  However, this does not mean that low-frequency circuits will work reliably.  Far from it, they will fail just as easily, according to Murphy's law.  Oh, and by the way, have you thought about your small microcontrollers operating at 16 MHz? <br><br><h1>  Current Surge Measurement </h1>  To see what is happening, you need to measure the currents flowing through the circuit.  Here is a simple experimental setup assembled for illustration: <br><br><img src="https://habrastorage.org/storage2/0b8/eab/a17/0b8eaba17f375be6908d86b69e11f6ae.png"><br>  <i>Figure 2. Connecting the inverter.</i> <br><img src="https://habrastorage.org/storage2/f59/a63/153/f59a63153cc38d2145043fd6a59e336a.png"><br>  <i>Figure 3. Measuring circuit.</i> <br><br>  The pulse generator is connected to an inverter 74HC04, loaded on a capacitor of 10 pF.  The signal at the inverter output, TP1, is shown in the upper waveform.  The power source is connected to the terminals of the microcircuit 7 and 14. In the gap of the earth conductor a current-measuring resistor 10 Ohm is included. <br><br>  The voltage at TP2 is proportional to the current consumed by the chip and is displayed on the lower oscillogram.  The blocking capacitor can be connected or disconnected if necessary.  The oscilloscope probes are equipped with 1:10 dividers, so the vertical scale of the oscillogram must be multiplied by 10. All unused inputs 74HC04 are grounded.  The installation looks like this: <br><br><img src="https://habrastorage.org/storage2/ea9/bbd/471/ea9bbd471def3a3e2d7705a4d6d7565f.jpg"><br>  <i>Figure 4. Installation assembled on a breadboard.</i> <br><br>  Figure 5 shows problems at high and low frequencies.  Pictures on the left - without a blocking capacitor, on the right - with him. <br><br><img src="https://habrastorage.org/storage2/b17/316/8d6/b173168d65f95c87742563564a6a80fb.jpg"><br>  <i>Figure 5. Output voltage (upper channel) and current consumption (lower channel).</i> <i><br></i>  <i>Above - the clock frequency of 330 kHz, below - 3.3 MHz.</i> <i><br></i>  <i>On the left - without a blocking capacitor, on the right - with it.</i> <br><br>  Some observations from Figure 5: <br><ul><li>  The measured current is only the current through the GND foot and the blocking capacitor.  It does not exactly match the current consumed by the chip.  It is difficult to measure the current through the legs of Vcc and GND at the same time <i>(limitations imposed by the design of the oscilloscope. - <b>Appro. Transl.</b> )</i> .  However, measuring current through a GND pin is sufficient for illustrative purposes. </li><li>  With a logical ‚Äú1‚Äù, a high-frequency ‚Äúringing‚Äù is observed at the output.  Its span is greater than 2 V, and emissions exceed the supply voltage.  Adding a blocking capacitor reduces the ‚Äújingle‚Äù to an almost insignificant level.  Emission still remains, but decays much faster. </li><li>  The signal fronts correspond to outliers (‚Äúneedles‚Äù) of the current consumed.  Adding a blocking capacitor reduces these outliers and makes them symmetrical with up and down fronts.  The emission range is from -22 to +45 mA without a blocking capacitor and from -32 to +36 mA with it. </li><li>  The symmetrical form of the current in the presence of a blocking capacitor says that energy is stored and removed back.  This is a very important feature. </li><li>  The residual HF ring largely depends on the position of the oscilloscope probe (not shown), which suggests that the circuit contains spurious LC elements and radio frequency antennas.  The location on the board and the relative position of the connecting wires have a significant effect on the amplitude and frequency of oscillations.  This interference can not be completely eliminated, but it can be greatly reduced by properly spreading the printed circuit board. </li></ul><br>  Take a closer look at the signal fronts: <br><br><img src="https://habrastorage.org/storage2/e04/ee8/4e9/e04ee84e90c2bb9d5ccbd93eb10cf608.jpg"><br>  <i>Figure 6. Output voltage fronts (upper channel) and current consumption (lower channel).</i> <i><br></i>  <i>From above - the back (falling) front, from below - the front (rising) front.</i> <i><br></i>  <i>On the left - without a blocking capacitor, on the right - with it.</i> <br><br><h1>  Current consumption estimate </h1>  The 74HC04 chip is made using CMOS technology.  This means that the static current consumption is close to zero.  The current is consumed only when switching from "0" to "1" and from "1" to "0".  When switching all load and stray capacitances must be reloaded.  For the experimental circuit, the load has a capacity of 10 pF.  Here you need to add the capacitance of the conclusions and parasitic capacitances, which are approximately 5 + 2 pF.  The oscilloscope probe has a capacity of 10 pF, which must also be taken into account.  Thus, the total load capacitance at the output of the inverter is approximately 27 pF. <br><br>  The output capacitance needs to be charged from 0 to 5 V in about 4.3 ns.  Taking for simplicity that the charging current is constant, we estimate its value: <br>  <i>Q = I ¬∑ t = C ¬∑ U</i> <br>  <i>I</i> = (5 ¬∑ 27 ¬∑ 10 <sup>-12</sup> ) / (4.3 ¬∑ 10 <sup>-9</sup> ) = 31.4 mA <br><br>  This means that a huge current <i>(by the CMOS standards. - <b>Appro. Transl.</b> )</i> Current flows in or out through the inverter output at each switch.  Where does the energy come from?  Of course, from the power source.  Figure 6 clearly shows that the current does not occur instantaneously, but rises to a certain level, and then drops again.  This behavior clearly indicates the presence of inductive elements. <br><br>  This is best seen in Figure 6 on the right, where the current reaches a maximum at the moment when the output voltage drops to zero.  The current then drops, causing the output voltage to dip.  The calculated current coincides quite well with the measured, given that only the simplest estimate was made. <br><br><h1>  So why do you need a blocking capacitor? </h1> Once again, take a close look at the lower half of Figure 6. On the left, the output voltage does not reach 5 V for some time, and on the right, it reaches almost immediately.  Without a blocking capacitor, the microcircuit lacks the power supply to form a steep front, and the voltage is stuck at 4 volts.  The blocking capacitor provides the necessary instantaneous power for a while. <br><br>  The blocking capacitor is about 4000 times larger than the load capacitance, which means that it should be expected that the supply voltage drop will be 4000 times lower <i>(than the output voltage swing. - <b>Approx. Transl.</b> )</i> - about 1-2 mV. <br><br>  When switching back from ‚Äú1‚Äù to ‚Äú0‚Äù, as in Figure 6 above, the blocking capacitor acts as a reservoir for receiving the released energy.  The load capacity is discharged and the current must flow to the ground.  However, the energy cannot be instantaneously transferred to the power source, and the blocking capacitor will temporarily store it. <br><br><h1>  Local power supply </h1>  The main power supply cannot provide the chip with sufficient power due to the inductance of the conductors.  Each wire has a parasitic inductance, which prevents the change in current.  From the definition of inductance: <br>  <i>U = L ¬∑ dI / dt ‚áí dI = U ¬∑ dt / L</i> <br><br>  From this equation it can be seen that the change in current is inversely proportional to the inductance.  In other words, if the inductance increases, it becomes more difficult to change the current for a given period of time, all other parameters being equal.  In addition, a change in current causes a voltage drop across the inductance.  The longer the wire (or track on the board), the higher the inductance it has, the more it resists the rapid change in current, and the greater the voltage drop. <br><br>  The blocking capacitor is a local energy storage.  It should always be installed as close as possible to the power supply pins of the microchip to minimize the inductance of the conductors from the capacitor to the microcircuit.  Such a scheme unleashes the common and local supply chains. <br><br><h1>  Increase the load </h1>  The microcircuit consists of six inverters, so the circuit can be changed so as to increase the current consumption: <br><br><img src="https://habrastorage.org/storage2/260/5ea/f57/2605eaf578f9d35778c557b0ec4bba03.png"><br>  <i>Figure 7. Experimental scheme with additional load.</i> <br><br><img src="https://habrastorage.org/storage2/35a/af2/b5c/35aaf2b5c5bc5ffa71c44d003bf46c4e.jpg"><br>  <i>Figure 8. Output voltage (upper channel) and current consumption (lower channel) for the circuit with additional load.</i> <i><br></i>  <i>Above - the clock frequency of 330 kHz, below - 3.3 MHz.</i> <i><br></i>  <i>On the left - without a blocking capacitor, on the right - with it.</i> <br><br>  <em>Note the different scale along the Y axis for the current measurement channel, compared to Figures 5 and 6.</em> <br><br>  The current through the GND pin now has emissions of about 70 mA in the absence of a blocking capacitor.  If the latter is installed, we again observe a symmetrical form of emissions with an amplitude of ¬± 50 mA with rising and falling fronts. <br><br>  Notice that the signal front, as seen in Figure 8 below left, is now much more gentle.  The microcircuit simply does not have enough energy to switch quickly.  Installing a blocking capacitor (figure 8 on the right) restores the steepness of the front to an acceptable level. <br><br><img src="https://habrastorage.org/storage2/722/0a1/121/7220a1121d31ab24892c3456a2728738.jpg"><br>  <i>Figure 9. Output voltage fronts (upper channel) and current consumption (lower channel).</i> <i><br></i>  <i>Left - the rear (falling) front, on the right - the front (rising) front.</i> <i><br></i>  <i>Interlock capacitor installed.</i> <br><br>  A detailed examination of the signal fronts reveals an increase in duration of the current surge, which is caused by the large energy requirements.  The chip load is about six times higher than before (the first inverter is loaded on the input capacitances of the remaining inverters, which are 5 times 5 pF). <br><br>  It was just a simple example - a microchip of six inverters.  And now extrapolate the above to a complex logic circuit containing many elements and many internal connections.  It has a lot of parasitic capacitances, which must be recharged each time the input signals change.  Finally, imagine a microcontroller consisting of many thousands of gates. <br><br><h1>  Grounding </h1>  The above explanations and illustrations should give a clear understanding that the blocking capacitor is an important element that performs its special function.  It stores the energy of the power source locally, gives it out if necessary, and also accepts excess energy. <br><br>  Local energy storage is constantly replenished from the main power source via the Vcc conductor.  At the same time, the excess energy must be discharged to the power supply through the GND conductor.  The discharge of energy into the blocking capacitor increases the voltage on it, and, in fact, briefly creates a local area on the circuit with a different potential.  The elimination of this imbalance is very important and is carried out by grounding.  <i>(Here, grounding is not a connection to the mass of our planet, but a connection to the common wire of the power source. - <b>Appro. Transl.</b> )</i> <br><br>  Printed circuit boards often have separate grounded layers, which are very effective for connecting elements with a common power supply conductor.  Well-designed wiring of the earth is of paramount importance for the discharge of excess energy.  But be careful, eddy currents can occur in a solid grounded layer, and numerous connections with a common wire can form a so-called.  ground loops. <br><br>  It will always be a good idea to contact a familiar developer with experience.  Most mistakes have already been made before by anyone, and there is no need to repeat them ad infinitum. </div><p>Source: <a href="https://habr.com/ru/post/146987/">https://habr.com/ru/post/146987/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146980/index.html">How to quickly "throw" 100,500 new users in Active Directory (raised on MS Windows Server 2003) or Script to add user accounts to Active Directory</a></li>
<li><a href="../146982/index.html">% username%, and where did you start immersion in programming?</a></li>
<li><a href="../146983/index.html">Web development on node.js and express. We study node.js in practice</a></li>
<li><a href="../146984/index.html">Integration tests with Maven, JUnit and Spring</a></li>
<li><a href="../146986/index.html">Tutoronline.ru: online tutorial call on the Internet. How it works?</a></li>
<li><a href="../146988/index.html">Working with Java VisualVM during load testing</a></li>
<li><a href="../146989/index.html">What paper periodicals do you read,%% username?</a></li>
<li><a href="../146990/index.html">Scalaxi again offers to go somewhere ...</a></li>
<li><a href="../146991/index.html">Up to Windows 8 you can upgrade for $ 39.99</a></li>
<li><a href="../146993/index.html">Using OpenCL in Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>