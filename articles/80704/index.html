<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>First steps with QML</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="QML is a new markup language for creating user interfaces. Its main task is to provide the ability to easily and quickly create applications with a be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>First steps with QML</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="http://sauron.me/images/other/logo.png">  QML is a new markup language for creating user interfaces.  Its main task is to provide the ability to easily and quickly create applications with a beautiful, animated interface. <br>  Not so long ago there <a href="http://labs.trolltech.com/blogs/2009/12/14/qt-declarative-for-qt-460-released/">was a</a> public version.  This means that the API as a whole has stabilized, and the version can be safely tested and used. <br>  The Declarative UI is planned to be included in the Qt 4.7 release, for now you can find all the necessary files and installation instructions for <a href="">ftp</a> trolls. <br>  In this article I would like to show how you can use C ++ objects (QObject) in qml. <br><br><a name="habracut"></a><br>  First you need to download from ftp and build qt-4.6.0-declarative.tar.gz.  Alternatively, you can use the already compiled QtCreator, which contains the necessary libraries <br>  <strong>Let's create a project:</strong> <br>  The easiest way to create a Qt4 application through QtCreator GUI is that QWidget is perfect as a base class. <br><h4>  qmltest.pro </h4><br> <code>SOURCES += main.cpp \ <br> widget.cpp \ <br> myobject.cpp <br> HEADERS += widget.h \ <br> myobject.h <br> #     ,       qt-declarative <br> QT += declarative \ <br> script <br> #INCLUDEPATH += #  ,      include/qt-declarative/ <br></code> <br>  The header file of our widget <br><h4>  widget.h </h4><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#ifndef WIDGET_H <br> <font color="#0000ff">#define</font> WIDGET_H <br> <br> #include &lt;QWidget&gt; <br> <font color="#0000ff">class</font> QmlView; <br> <font color="#0000ff">class</font> MyObject; <br> <font color="#0000ff">class</font> Widget : <font color="#0000ff">public</font> QWidget <br> { <br> Q_OBJECT <br> <font color="#0000ff">public</font> : <br> <font color="#0000ff">explicit</font> Widget(QWidget *parent = 0); <br> <font color="#0000ff">private</font> : <br> QmlView *view; <br> MyObject * <font color="#0000ff">object</font> ; <br> <font color="#0000ff">private</font> slots: <br> <font color="#0000ff">void</font> onSceneResized(QSize size); <br> }; <br> <br> <font color="#0000ff">#endif</font> <font color="#008000">// WIDGET_H</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  For a start, it would be nice to remove the system header and make the background transparent: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">setWindowFlags(Qt::FramelessWindowHint); <br> setAttribute(Qt::WA_TranslucentBackground); <br> setAttribute(Qt::WA_NoSystemBackground); <br> view = <font color="#0000ff">new</font> QmlView( <font color="#0000ff">this</font> ); <br> view-&gt;viewport()-&gt;setAutoFillBackground( <font color="#0000ff">false</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Now we initialize our QML viewer and give it the path to the file that we are going to execute. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">view-&gt;setFocus(); <br> QString filename = qApp-&gt;applicationDirPath() + <font color="#A31515">"/qmlpopups/default/popup.qml"</font> ; <br> view-&gt;setUrl(QUrl::fromLocalFile(filename));//url - main.qml</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Now the most interesting thing comes: make the properties of a C ++ object visible from the qml file.  For this, it is necessary that the object be inherited from QObject.  Using the Q_PROPERTY macro, properties are made available from qml objects and javascript. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Q_PROPERTY(QString text READ text WRITE setText NOTIFY textChanged)</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  READ indicates which function to use to get the value. <br>  WRITE indicates which function is used to change <br>  NOTIFY indicates which signal is triggered when the value changes, is used in binders. <br>  By preparing the object accordingly, we can access these properties from qmlya. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">view-&gt;rootContext()-&gt;setContextProperty( <font color="#A31515">"MyObject"</font> , <font color="#0000ff">object</font> ); <br> view-&gt;rootContext()-&gt;setContextProperty( <font color="#A31515">"MyText"</font> , <font color="#A31515">"Hello, QML!"</font> ); <br> view-&gt;rootContext()-&gt;setContextProperty( <font color="#A31515">"Avatar"</font> ,qApp-&gt;applicationDirPath() + <font color="#A31515">"/qmlpopups/default/star.png"</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Adding new objects is done via QmlContext, the pointer to which is returned by the rootContext () function.  You can add both individual properties and whole objects. <br>  Now let's move on to the qml file: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Rectangle { <br> id: rect <br> width:250 <br> height: 100 <br> height: Behavior { NumberAnimation { duration: 1000; easing: <font color="#A31515">"InOutQuad"</font> } } <br> color: <font color="#A31515">"transparent"</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The code draws us a rectangle 250x100 with a transparent fill.  There would be nothing tricky here if it were not for the strange property: <br> <code>height: Behavior { NumberAnimation { duration: 1000; easing: "InOutQuad" } }</code> <br>  The Behavior property indicates the behavior of an object when the height value changes.  In this case, it should be an animation.  For any action that sets a new height value, the rectangle will not immediately accept this value, but only by performing a certain sequence of actions, which is very convenient when creating an animated gui. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">BorderImage { <br> source: <font color="#A31515">"background.png"</font> <br> height: rect.height <br> width: rect.width <br> border.left: 20 <br> border.top: 20 <br> border.bottom: 20 <br> border.right: 20 <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  This block demonstrates how to create a background image with a frame.  And this is all from one picture, you no longer need to cut it with your hands, everything will be done for you, you just need to specify the size of the borders.  <s>I think many web designers are now jealous.</s> <br>  In order for the picture to automatically resize to fit the rectangle, you can use property binding in qml objects, its essence is that the value of one parameter is tied to the value of another and automatically changes as the value of the original parameter changes. <br>  Now we will write the text <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Text { <br> id: title <br> text: MyText <br> font.pointSize: 14 <br> wrap: <font color="#0000ff">true</font> <br> color: <font color="#A31515">"white"</font> <br> <br> effect: DropShadow { <br> color: <font color="#A31515">"white"</font> <br> blurRadius: 2 <br> offset.x: 0 <br> offset.y: 0 <br> } <br> <br> anchors.top: rect.top <br> anchors.topMargin : 5 <br> anchors.left: avatar.right <br> anchors.leftMargin : 5 <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Anchors are used to place elements in qml, which indicate the position of the object relative to other objects, which is very convenient.  Various effects can be applied to the text, for example, the shadow effect.  The text itself is taken from the context that we indicated earlier.  A wrap value indicates that line wraps are necessary. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Text { <br> id: body <br> text: MyObject.text <br> font.pointSize: 12 <br> wrap: <font color="#0000ff">true</font> <br> color: <font color="#A31515">"white"</font> <br> <br> <font color="#008000">//ancors</font> <br> anchors.top: title.bottom <br> anchors.topMargin: 5 <br> anchors.right: rect.right <br> anchors.rightMargin: 5 <br> anchors.left: avatar.right <br> anchors.leftMargin : 5 <br> <br> onTextChanged: rect.height = calculateMyHeight(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  In this block there is a slot that is activated when any text changes, and it calls the javascript function, recalculating the height of the entire rectangle in which our scene is enclosed.  And the text can be changed simply by calling the setText function on our C ++ object. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Script { <br> <font color="#0000ff">function</font> calculateMyHeight() { <br> console.log( <font color="#A31515">"height : "</font> + (body.y + body.height + 20)); <br> <font color="#0000ff">return</font> (edit.y + edit.height + 20); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  In the scripts block, you can describe javascript'y, through which you can interact in any qml objects <br>  The remaining code can be found <a href="">here.</a> <br>  In the end, you should get such a nice little window: <br><img src="http://sauron.me/images/other/qml.png"><br>  That's all for today.  Other features can be found by <a href="http://qt.nokia.com/doc/qml-snapshot/declarativeui.html">looking at the documentation</a> and looking at <a href="http://www.youtube.com/view_play_list%3Fp%3D084A46CE1D502DB3%26search_query%3Dqml">examples.</a> <br>  PS <br>  They sent a screenshot from Win7, could not put it out, use <a href="http://habrahabr.ru/blogs/qt_software/69820/">qtwin</a> to create blur <br><img src="http://img193.imageshack.us/img193/1276/pic3nm.png"><br><br></div><p>Source: <a href="https://habr.com/ru/post/80704/">https://habr.com/ru/post/80704/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../80695/index.html">Another fun version of Yandex.Money identification</a></li>
<li><a href="../80696/index.html">Google declares war on China</a></li>
<li><a href="../80698/index.html">Dreyfus Skills Acquisition Model</a></li>
<li><a href="../80701/index.html">Printing books on home programming</a></li>
<li><a href="../80702/index.html">Scopetris</a></li>
<li><a href="../80705/index.html">AsciiCamera</a></li>
<li><a href="../80706/index.html">We charge mobile phones with brute force</a></li>
<li><a href="../80713/index.html">Nokia 5800 has finally added kinetic scrolling!</a></li>
<li><a href="../80716/index.html">Visual Studio 2005/2008 PasteBin via C #</a></li>
<li><a href="../80717/index.html">Simultaneous use of two providers on cisco routers (continued)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>