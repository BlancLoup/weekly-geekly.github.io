<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Grunt quick setup for comfortable development</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During the development of our service bitcalm.com , we needed to organize an automatic assembly of the project. Our goal was to improve the performanc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Grunt quick setup for comfortable development</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a79/0de/487/a790de4872c64597a97fa2f1af833c4b.png" alt="Grunt quick setup for comfortable development"><br><br>  During the development of our service <a href="http://bitcalm.com/">bitcalm.com</a> , we needed to organize an automatic assembly of the project.  Our goal was to improve the performance of the frontend-part of our application, as well as to optimize the development and deployment processes on the server. <br><br>  The main tasks to be solved were: <br><ol><li>  Combining and minifying scripts </li><li>  Combining and minifying styles </li><li>  Compress png-images </li><li>  Creating sprites from all images (with the possibility of convenient use and with support for two types of sprites for devices with different PPI) </li><li>  Building different versions of html-documents for development and for production </li></ol><br>  The first three points look quite trivial, so I will try to focus on working with sprites and processing html. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  Briefly tell what plugins are used for the first three points.  <a href="https://github.com/gruntjs/grunt-contrib-concat">Grunt-contrib-concat</a> and <a href="https://github.com/gruntjs/grunt-contrib-uglify">grunt-contrib-uglify are</a> used to optimize the scripts.  Working with styles is done with <a href="https://github.com/gruntjs/grunt-contrib-cssmin">grunt-contrib-cssmin</a> .  Image compression is made <a href="https://github.com/gruntjs/grunt-contrib-imagemin">possible</a> by <a href="https://github.com/gruntjs/grunt-contrib-imagemin">grunt-contrib-imagemin</a> . <br><br>  One trick to mention when working with grunt-contrib-concat.  The fact is that if you simply specify all the files in the directory ( <i>src: ["/scripts/*.js"]</i> ) in the <i>src</i> parameter, then the files will not necessarily be joined in the order you need.  This is often the case if a file of a library follows the file in which this library is used.  The easiest and most reliable way out in this case is to specify the script processing order manually. <br><br>  Here is an example of how we do it: <br><pre><code class="javascript hljs">dist: { <span class="hljs-attr"><span class="hljs-attr">src</span></span>: [ <span class="hljs-string"><span class="hljs-string">'/scripts/lib/*.js'</span></span>, <span class="hljs-string"><span class="hljs-string">'/scripts/app/modules/*.js'</span></span>, <span class="hljs-string"><span class="hljs-string">'/scripts/app/*js'</span></span> ], <span class="hljs-attr"><span class="hljs-attr">dest</span></span>: <span class="hljs-string"><span class="hljs-string">'/dist/scripts.min.js'</span></span> }</code> </pre> <br><br><h2>  Automatic creation of sprites </h2><br>  To create sprites, we use the <a href="https://github.com/Ensighten/grunt-spritesmith">grunt-spritesmith plugin</a> .  He takes all the images from a specific folder, sticks them together in one sheet and creates a css-file for the resulting sprite.  Due to this, any of the source images can be accessed by a specific CSS selector (for convenience, ` <i>.icon- &lt;source_file_name&gt;</i> ` is used). <br><br>  <b>A small example:</b> <br><br>  Source files are taken from the raw folder. <br><br><pre> ‚îÄ‚îÄ‚îÄimg
 ‚îÇ ‚îî‚îÄ‚îÄraw
 ‚îÇ ‚îú‚îÄ‚îÄimg-1.png
 ‚îÇ ‚îú‚îÄ‚îÄimg-2.png
 ‚îÇ ‚îî‚îÄ‚îÄimg-3.png
</pre><br>  After the task is executed, two files appear: directly the <b>spritesheet spritesheet.png</b> itself the <b>spritestyles.css</b> style <b>file</b> . <br><br><pre> ‚îÄ‚îÄ‚îÄimg
 ‚îÇ ‚îú‚îÄ‚îÄraw
 ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄimg-1.png
 ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄimg-2.png
 ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄimg-3.png
 ‚îÇ ‚îÇ
 ‚îÇ ‚îî‚îÄ‚îÄ‚îÄspritesheet.png
 ‚îÇ
 ‚îú‚îÄ‚îÄ‚îÄstyles
 ‚îÇ ‚îî‚îÄ‚îÄspritestyles.css
</pre><br><br>  The <b>spritestyles.css</b> file contains styles for sprite usage. <br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.icon-img-1</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>: <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-number"><span class="hljs-number">0px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: <span class="hljs-number"><span class="hljs-number">40px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">40px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.icon-img-2</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>: -<span class="hljs-number"><span class="hljs-number">129px</span></span> <span class="hljs-number"><span class="hljs-number">0px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: <span class="hljs-number"><span class="hljs-number">95px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">80px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.icon-img-3</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>: -<span class="hljs-number"><span class="hljs-number">42px</span></span> <span class="hljs-number"><span class="hljs-number">0px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: <span class="hljs-number"><span class="hljs-number">85px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">85px</span></span>; }</code> </pre><br>  In addition, the general style for using this sprite is described at the beginning of this file: <br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.sprite</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>: inline-block; <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(../img/spritesheet.png); <span class="hljs-attribute"><span class="hljs-attribute">background-repeat</span></span>: no-repeat; }</code> </pre><br>  As a result, we can use any of our images in the layout with the help of a pair of classes: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùsprite</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">icon-img-1</span></span></span><span class="hljs-tag">‚Äù&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><h2>  Creating sprites for devices with large PPI </h2><br>  In order for our images to look good on devices with high pixel density, you need to create an enlarged version of the sprite.  In fact, it would be easy to use only a large version of the sprite for all screens.  However, this approach is not entirely correct, because a large sprite is several times "heavier" than usual. <br><br>  So, how are sprites of different sizes created: images for ordinary devices should be in the <i>img / raw</i> folder, and <i>img / raw @ 2x</i> <i>folders</i> should be enlarged copies of the same images.  For screens with a pixel ratio ‚â• 2, a separate <b>spritesheet@2x.png</b> and a stylesheet <b>spritestyles@2x.css are created</b> .  Thanks to the use of media queries, the browser chooses which sprite it needs to use. <br><br>  Here is what <b>spritestyles@2x.css</b> looks <b>like</b> : <br><pre> <code class="css hljs">@<span class="hljs-keyword"><span class="hljs-keyword">media</span></span> only screen and (-webkit-min-device-pixel-ratio: <span class="hljs-number"><span class="hljs-number">2</span></span>), only screen and (-moz-min-device-pixel-ratio: <span class="hljs-number"><span class="hljs-number">2</span></span>), only screen and (-o-min-device-pixel-ratio: <span class="hljs-number"><span class="hljs-number">2</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span>), only screen and (min-device-pixel-ratio: <span class="hljs-number"><span class="hljs-number">2</span></span>), only screen and (min-resolution: <span class="hljs-number"><span class="hljs-number">192dpi</span></span>), only screen and (min-resolution: <span class="hljs-number"><span class="hljs-number">2dppx</span></span>) { <span class="hljs-selector-class"><span class="hljs-selector-class">.sprite</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>: inline-block; <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(../img/spritesheet@2x.png); <span class="hljs-attribute"><span class="hljs-attribute">background-repeat</span></span>: no-repeat; } <span class="hljs-selector-class"><span class="hljs-selector-class">.icon-img-1</span></span> { ... } <span class="hljs-selector-class"><span class="hljs-selector-class">.icon-img-2</span></span> { ... } <span class="hljs-selector-class"><span class="hljs-selector-class">.icon-img-3</span></span> { ... } }</code> </pre><br><br>  In order for the grunt-spritesmith plugin to perform all of the above, it was necessary to create your own Mustache template or write a JS function that creates CSS.  Since there was no time to deal with the first decision, I decided to quickly write a couple of functions and postpone the creation of templates for later. <br><br><div class="spoiler">  <b class="spoiler_title">Code taska</b> <div class="spoiler_text"><pre> <code class="javascript hljs">sprite: { <span class="hljs-attr"><span class="hljs-attr">normal</span></span>: { <span class="hljs-attr"><span class="hljs-attr">src</span></span>: <span class="hljs-string"><span class="hljs-string">'img/raw/*.png'</span></span>, <span class="hljs-attr"><span class="hljs-attr">destImg</span></span>: <span class="hljs-string"><span class="hljs-string">'img/spritesheet.png'</span></span>, <span class="hljs-attr"><span class="hljs-attr">destCSS</span></span>: <span class="hljs-string"><span class="hljs-string">'styles/spritestyles.css'</span></span>, <span class="hljs-attr"><span class="hljs-attr">padding</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">cssTemplate</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">params</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-string"><span class="hljs-string">'.sprite {display: inline-block; background-image: url(../img/spritesheet.png); background-repeat: no-repeat;}'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, ii = params.items.length; i &lt; ii; i += <span class="hljs-number"><span class="hljs-number">1</span></span>) { result += <span class="hljs-string"><span class="hljs-string">'.icon-'</span></span> + params.items[i].name + <span class="hljs-string"><span class="hljs-string">'{'</span></span> + <span class="hljs-string"><span class="hljs-string">'background-position: '</span></span> + params.items[i].px.offset_x + <span class="hljs-string"><span class="hljs-string">' '</span></span> + params.items[i].px.offset_y + <span class="hljs-string"><span class="hljs-string">';'</span></span> + <span class="hljs-string"><span class="hljs-string">'width: '</span></span> + params.items[i].px.width + <span class="hljs-string"><span class="hljs-string">';'</span></span> + <span class="hljs-string"><span class="hljs-string">'height: '</span></span> + params.items[i].px.height + <span class="hljs-string"><span class="hljs-string">';'</span></span> + <span class="hljs-string"><span class="hljs-string">'}\n'</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }, <span class="hljs-attr"><span class="hljs-attr">large</span></span>: { <span class="hljs-attr"><span class="hljs-attr">src</span></span>: <span class="hljs-string"><span class="hljs-string">'img/raw@2x/*.png'</span></span>, <span class="hljs-attr"><span class="hljs-attr">destImg</span></span>: <span class="hljs-string"><span class="hljs-string">'img/spritesheet@2x.png'</span></span>, <span class="hljs-attr"><span class="hljs-attr">destCSS</span></span>: <span class="hljs-string"><span class="hljs-string">'styles/spritestyles@2x.css'</span></span>, <span class="hljs-attr"><span class="hljs-attr">padding</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">cssTemplate</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">params</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-string"><span class="hljs-string">'.sprite {display: inline-block; background-image: url(../img/spritesheet@2x.png); background-repeat: no-repeat;}'</span></span>; result += <span class="hljs-string"><span class="hljs-string">'@media only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (-moz-min-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min-device-pixel-ratio: 2), only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx) {\n'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, ii = params.items.length; i &lt; ii; i += <span class="hljs-number"><span class="hljs-number">1</span></span>) { result += <span class="hljs-string"><span class="hljs-string">'.icon-'</span></span> + params.items[i].name + <span class="hljs-string"><span class="hljs-string">'{'</span></span> + <span class="hljs-string"><span class="hljs-string">'background-position: '</span></span> + params.items[i].offset_x/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-string"><span class="hljs-string">'px '</span></span> + params.items[i].offset_y/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-string"><span class="hljs-string">'px;'</span></span> + <span class="hljs-string"><span class="hljs-string">'background-size: '</span></span> + params.items[i].total_width/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-string"><span class="hljs-string">'px '</span></span> + params.items[i].total_height/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-string"><span class="hljs-string">'px;'</span></span> + <span class="hljs-string"><span class="hljs-string">'width: '</span></span> + params.items[i].width/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-string"><span class="hljs-string">'px;'</span></span> + <span class="hljs-string"><span class="hljs-string">'height: '</span></span> + params.items[i].height/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-string"><span class="hljs-string">'px;'</span></span> + <span class="hljs-string"><span class="hljs-string">'}\n'</span></span> } result += <span class="hljs-string"><span class="hljs-string">'}'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } } }</code> </pre><br></div></div><br>  As can be seen from the code of this task, the creation of a large sprite differs only by adding a media query, specifying the background-size property, and reducing all the sizes in half. <br><br>  Having set up such a system, you can absolutely not be distracted by working with images during the layout.  It is especially convenient to use this method in combination with the plugin for Photoshop - <a href="http://retinize.it/">Retinize It</a> . <br><br><h2>  Building different versions of html documents </h2><br>  Surely, many people are familiar with the situation when many styles and scripts are connected to the development in the html file, and for production it is necessary to replace them with minified versions.  Manually changing the file or reinventing the wheel is a dubious pleasure, so it was decided to call for help from Grunt. <br><br>  Short searches led to <a href="https://github.com/dciccale/grunt-processhtml">grunt-processhtml</a> .  Consider the basic principles of working with this plugin. <br><br>  The processed html-file is in the root.  It is in this file that you need to perform any operations, because it generates an html document in the <i>dist</i> folder. <br><br><pre> templates
 ‚îÄ‚îÄ‚îÄdist
 ‚îî‚îÄ‚îÄ‚îÄapp.html
 ‚îÄ‚îÄ‚îÄapp.html
</pre><br><br>  The <i>app.html</i> file in the <i>dist</i> folder should be loaded into the browser, that is, all server routings should point to it, and not to the <i>app.html</i> file in the root.  Setting up this task in grunt is very simple: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> templates = { <span class="hljs-attr"><span class="hljs-attr">cwd</span></span>: <span class="hljs-string"><span class="hljs-string">'templates/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">src</span></span>: [<span class="hljs-string"><span class="hljs-string">'*.html'</span></span>], <span class="hljs-attr"><span class="hljs-attr">dest</span></span>: <span class="hljs-string"><span class="hljs-string">'templates/dist/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">ext</span></span>: <span class="hljs-string"><span class="hljs-string">'.html'</span></span> }; ... processhtml: { <span class="hljs-attr"><span class="hljs-attr">dev</span></span>: { <span class="hljs-attr"><span class="hljs-attr">files</span></span>: [templates] }, <span class="hljs-attr"><span class="hljs-attr">dist</span></span>: { <span class="hljs-attr"><span class="hljs-attr">files</span></span>: [templates] } }</code> </pre><br>  We only indicate in which folder the source files are located and in which folder the processed files are stored.  Also, in the task itself there are <i>dev</i> and <i>dist</i> containers, which allow using different files and settings for different versions of the build.  With the help of these containers, conditional constructions inside files are processed: some or other pieces of code are removed, depending on which assembly mode was selected. <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- build:remove:dev --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dist/styles.min.css"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- /build --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- build:remove:dist --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"styles/styles-1.css"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"styles/styles-2.css"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"styles/styles-3.css"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- /build --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- build:remove:dev --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dist/scripts.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- /build --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- build:remove:dist --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"scripts/scripts-1.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"scripts/scripts-2.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"scripts/scripts-3.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- /build --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The contents of the <i>build: remove: dev</i> blocks are removed at design time, and the contents of <i>build: remove: dist</i> at build time for production.  For ease of development, you can use these aliases: <br><pre> <code class="javascript hljs">grunt.registerTask(<span class="hljs-string"><span class="hljs-string">'dev'</span></span>, [<span class="hljs-string"><span class="hljs-string">'processhtml:dev'</span></span>]); grunt.registerTask(<span class="hljs-string"><span class="hljs-string">'default'</span></span>, [<span class="hljs-string"><span class="hljs-string">'processhtml:dist'</span></span>, ...]);</code> </pre><br>  Now to create a production version, it is enough to execute the <i>grunt</i> command in the console, and for development you should run <i>grunt dev</i> . <br><br>  The main disadvantage of this method is that after any change in the html file, you must manually run grunt in order to update the final file.  The solution to this problem is very simple: use <a href="https://github.com/gruntjs/grunt-contrib-watch">grunt-contrib-watch</a> .  This plugin tracks changes to files, and then runs the necessary task (in our case, it's <i>dev</i> ). <br><pre> <code class="javascript hljs">watch: { <span class="hljs-attr"><span class="hljs-attr">html</span></span>: { <span class="hljs-attr"><span class="hljs-attr">files</span></span>: [<span class="hljs-string"><span class="hljs-string">'templates/*.html'</span></span>], <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: [<span class="hljs-string"><span class="hljs-string">'dev'</span></span>] } }</code> </pre><br><br><h2>  Conclusion </h2><br>  I tried to show how simply and quickly you can start using Grunt on an already running project.  This system has accelerated the development and deployment of updates on the server, and also significantly optimized the frontend-part of our service. <br><br>  This third article from the series is about how we did the cloud backup server <a href="http://bitcalm.com/">bitcalm.com service</a> . <br><br>  First article: <a href="http://habrahabr.ru/company/bitcalm/blog/234861/">Developing your own Django billing system</a> <br>  Second article: <a href="http://habrahabr.ru/company/bitcalm/blog/239479/">How we made an application framework on AngularJS and Django</a> </div><p>Source: <a href="https://habr.com/ru/post/244725/">https://habr.com/ru/post/244725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244711/index.html">Optional types? Only if very necessary</a></li>
<li><a href="../244713/index.html">10 opportunities to be more productive with Eclipse for Java developers</a></li>
<li><a href="../244715/index.html">The script collapsing comments on Habr√©</a></li>
<li><a href="../244721/index.html">Revised Grunt Beginner's Guide</a></li>
<li><a href="../244723/index.html">Hacker's guide to neural networks. Schemes of real values. Strategy # 1: Random local search</a></li>
<li><a href="../244727/index.html">Why 1C is bad and why 1C programmers don‚Äôt like it so much</a></li>
<li><a href="../244729/index.html">Expanding the canvas of Van Gogh's ‚ÄúStarry Night‚Äù with the help of the Wolfram Language (Mathematica)</a></li>
<li><a href="../244731/index.html">GPS monitoring for personal use (part 2. Systems overview)</a></li>
<li><a href="../244735/index.html">Is Telegram Safe? v2</a></li>
<li><a href="../244737/index.html">rusEfi: results of 2014 and plans</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>