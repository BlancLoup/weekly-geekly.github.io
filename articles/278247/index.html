<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Preparing an ASP.NET Core: Creating Your Cross-Platform Modular Framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue our column on the topic ASP.NET Core by another publication from Dmitry Sikorsky ( DmitrySikorsky ) - the head of the company ‚ÄúYubreinians...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Preparing an ASP.NET Core: Creating Your Cross-Platform Modular Framework</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <i>We continue our column on the topic ASP.NET Core by another publication from Dmitry Sikorsky ( <a href="https://habrahabr.ru/users/dmitrysikorsky/" class="user_link">DmitrySikorsky</a> ) - the head of the company ‚ÄúYubreinians‚Äù from Ukraine.</i>  <i>This time, Dmitry talks about his experience in developing a modular cross-platform framework based on ASP.NET Core.</i>  <i>Previous articles from the column can always be read on the link <a href="http://habrahabr.ru/search/%3Fq%3D%255B%2523aspnetcolumn%255D%26target_type%3Dposts">#aspnetcolumn</a> - Vladimir Yunev</i> </blockquote>  Due to the specifics of my task, lately, quite a lot has to reflect on the modular and extensible architecture of web applications on ASP.NET Core (and before that - on ASP.NET of the previous version).  As a result, ExtCore appeared - a small open-source cross-platform framework that allows you to literally simply connect a NuGet-package to turn your web application into a modular and extensible. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/57b/2c3/924/57b2c39241ed46259315ba7d0d5177b1.jpg"></div><br><h3>  Main features </h3><br>  ExtCore can detect and use types (as well as views and static content) defined both in projects (as source code or NuGet packages), which are explicitly referenced, and in projects that are located in a specific folder in compiled dll assemblies. <br><br>  For convenience, optionally, these projects can be conditionally combined into extensions (i.e., each extension can consist of one or many projects).  Also, each extension can have a class (in one of the projects) that implements the IExtension interface, and ExtCore, in turn, allows at any time to get an accessible set of instances of all classes that implement this interface.  You can use these classes to provide metadata describing extensions, initializing extensions (for example, registering routes), and so on. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Although the framework itself does not contain any functionality related to working with data, all that is necessary for this (including the common storage context for all extensions) is implemented in the ExtCore.Data extension, which is described below. <br><a name="habracut"></a><br><blockquote> <a href="https://github.com/ExtCore/ExtCore-Sample"><img title="aspnetcolumngithub" alt="aspnetcolumngithub" src="https://habrastorage.org/files/e5a/eff/108/e5aeff1080f44ada899062dee76a3e24.png" width="240" align="right" height="88"></a>  <b>Tip!</b>  You can try everything yourself or by downloading the source code from GitHub <a href="https://github.com/ExtCore/ExtCore-Sample">https://github.com/ExtCore/ExtCore-Sample</a> . </blockquote><br><h3>  How it works </h3><br><img align="left" width="200" src="https://habrastorage.org/files/d95/b5a/572/d95b5a57242042df838a95a75f67c013.png">  During application startup, ExtCore detects all assemblies (those that are explicitly referenced, and those that are not explicitly referenced, but which are located in a specific folder).  Only assemblies that contain a link to ExtCore.Infrastructure are selected and loaded. <br><br>  Further, all detected assemblies that meet the selection criteria are placed in the container container ExtensionManager, from where they can be obtained from anywhere at any time (that is, from the main application project or from any other project).  These assemblies are ‚Äúregistered‚Äù as sources for searching for controllers (all controllers from assemblies that are explicitly referenced are detected by ASP.NET automatically, but the rest must be reported additionally, ‚Äúmanually‚Äù), views (and in the form of resources, and compiled) and static content. <br><br>  After that, a number of IExtension methods are executed among instances of the available implementations of this interface.  So extensions can run their code during the execution of ConfigureServices, Configure, and so on. <br><br><h3>  Recommended Expansion Structure </h3><br>  To simplify understanding and preserve uniformity, it is convenient to adhere to the following structure when developing your own extensions (where X is the name of your extension): <br><br><ul><li>  YourApplication.X; </li><li>  YourApplication.X.Frontend; </li><li>  YourApplication.X.Backend; </li><li>  YourApplication.X.Data.Models; </li><li>  YourApplication.X.Data.Abstractions; </li><li>  YourApplication.X.Data.SpecificStorageA; </li><li>  YourApplication.X.Data.SpecificStorageB; </li><li>  YourApplication.X.Data.SpecificStorageC; </li><li>  and so on. </li></ul><br>  <b>YourApplication.</b>  <b>X</b> <br><br>  The main expansion project.  Contains a class that implements the IExtension interface, as well as general classes used in other projects.  If the extension does not contain different areas (for example, frontend and backend), then things related to the user interface (controllers, view models, views, etc.) can also be placed in this project. <br><br>  <b>YourApplication.X.Frontend and</b> <b>YourApplication.X.Backend</b> <br><br>  The projects are named for example only.  It seems to me convenient to separate different parts of the user interface in this way (especially during team work).  Also, if a web application consists of a large number of extensions, you can take common elements of the frontend and backend into basic projects and then refer to them in all the others.  Thus, for example, all extensions can have a uniform appearance or a set of basic controls with the ability to simply replace it by copying one or another DLL file. <br><br>  ExtCore supports two options for working with views (at the same time): representations in the form of resources and precompiled representations.  In short, I recommend using the second option.  You can read more about methods of working with views applied in ExtCore in the article <a href="https://habrahabr.ru/company/microsoft/blog/276061/">Preparing ASP.NET Core:</a> let's <a href="https://habrahabr.ru/company/microsoft/blog/276061/">talk about non-standard approaches when working with views</a> . <br><br>  Working with static content is also easy.  In the article <a href="https://habrahabr.ru/company/microsoft/blog/277235/">Preparing ASP.NET Core: how to present static content as resources</a> describes the method used in ExtCore.  To summarize the article, the necessary static content is placed into assemblies as resources and then these assemblies are ‚Äúregistered‚Äù as file providers, which makes it possible to use resources almost like ordinary physical files (including direct access via HTTP ). <br><br>  Interestingly, the scope of both views and static content is the entire application.  This means that some extensions can use the contents of other extensions and vice versa.  Moreover, extensions can use views and static content from the main web application.  In this way, you can, for example, describe the logic in extension projects, but allow the user to determine how everything will look, right in the main application. <br><br>  <b>YourApplication.</b>  <b>X.</b> <b>Data. *</b> <br><br>  Projects that describe working with data.  More on this below. <br><br>  <b>Work with data</b> <br><br>  ExtCore additionally has an optional ExtCore.Data extension that implements all the necessary basic functionality for working with data.  The central element of the extension is the interface IStorage (unit of work).  This interface describes only 2 methods: GetRepository and Save.  The GetRepository implementation detects and returns an accessible instance of the repository that implements the requested interface (as well as the IRepository) and ensures that all repositories have a single storage context (IStorageContext interface). <br><br>  If you need some kind of registration of entity types from different extensions (as in the case of EntityFramework, for example), this can be easily achieved using something like the IModelRegistrar interface, which is used in ExtCore.Data.EntityFramework.Sqlite and ExtCore.Data .EntityFramework.SqlServer.  A test project (link to it at the end of the article) illustrates this approach. <br><br>  The expansion structure is as follows: <br><br><ul><li>  ExtCore.Data; </li><li>  ExtCore.Data.Models.Abstractions; </li><li>  ExtCore.Data.Abstractions; </li><li>  ExtCore.Data.EntityFramework.Sqlite; </li><li>  ExtCore.Data.EntityFramework.SqlServer. </li></ul><br>  <b>ExtCore.Data</b> <br><br>  The project contains a class that implements the IExtension interface.  When the application is started, this class executes code that detects an available implementation of the IStorage interface (see below) and registers it in the ASP.NET Core DI embedded so that any controller can then get an instance of it if necessary.  Conveniently, you can change the type of supported storage by simply changing the link in the dependencies or copying the DLL file. <br><br>  <b>ExtCore.</b>  <b>Data.</b>  <b>Models.</b>  <b>Abstractions</b> <br><br>  The project describes the IEntity interface, which all entities in all extensions must implement. <br><br>  <b>ExtCore.</b>  <b>Data.</b>  <b>Abstractions</b> <br><br>  The project describes the key interfaces IStorageContext, IStorage and IRepository, which I described above.  In my own extensions, in projects with names like YourApplication.X.Data.Abstractions, I put repository interfaces to then work through them without reference to the implementation of a specific repository. <br><br>  <b>ExtCore.</b>  <b>Data.</b>  <b>EntityFramework.</b>  <b>Sqlite and</b> <b>ExtCore.</b>  <b>Data.</b>  <b>EntityFramework.</b>  <b>SqlServer</b> <br><br>  The project contains classes that implement interfaces from ExtCore.Data.Abstractions for specific storages (in this case, Sqlite and SqlServer). <br><br><h3>  findings </h3><br>  At the moment - this is only the alpha version.  I have many plans for the development of the project (connecting and disconnecting extensions at any time and general optimization; I also want to work on the ExtensionManager class, add a convenient opportunity to get available implementations of specified interfaces, and not just IExtension).  I use this framework in my project (CMS).  As far as I can tell, it‚Äôs convenient and flexible.  I will be glad to hear comments and criticism.  Thank! <br><br>  Here is the link to the source: <a href="https://github.com/ExtCore/ExtCore">https://github.com/ExtCore/ExtCore</a> . <br><br>  And here is the link to the finished test project: <a href="https://github.com/ExtCore/ExtCore-Sample">https://github.com/ExtCore/ExtCore-Sample</a> . <br><br><h3>  To authors </h3><br>  Friends, if you are interested in supporting the column with your own material, please write to me at <a href="">vyunev@microsoft.com</a> to discuss all the details.  We are looking for authors who can interestingly tell about ASP.NET and other topics. <br><br><img align="right" width="250" src="https://habrastorage.org/files/afc/bc1/126/afcbc1126db747c8977cf60207b9c6fa.jpg"><h3>  about the author </h3><br>  <b>Sikorsky Dmitry Alexandrovich</b> <br>  Jubreynians Company ( <a href="http://ubrainians.com/">http://ubrainians.com/</a> ) <br>  Owner, Head <br>  <a href="https://habrahabr.ru/users/dmitrysikorsky/" class="user_link">DmitrySikorsky</a> <br><br><h3>  Announcement!  Deep Intense at the DevCon 2016 Conference </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/9c6/250/db7/9c6250db75fac2d4e28fac55d5eb951e.png" alt="image"><br><br>  We are pleased to announce the holding of a deep intensive course on ASP.NET Core at the [DevCon 2016 conference] (https://events.techdays.ru/DevCon/2016/registration).  This course will take place on the second day of the conference and will take a full day of the conference for 6 hours. <br><br>  <b>Development of modern web applications on the open platform ASP.NET 5</b> <br>  As part of this intense, participants will take part in an exciting and adventurous journey dedicated to developing web applications on the latest ASP.NET platform 5. We will go all the way from zero to a full-fledged application deployed in the cloud.  And on the way, participants will be able to stop to explore the internal structure of ASP.NET, work with relational and NoSQL databases using the Entity Framework 7, develop applications on the MVC framework, build models, views and business logic, create a REST API, and organize continuous development processes. and testing using Git and Visual Studio Online, as well as deploying using Azure and Docker containers.  At the end of the trip, all participants will pass the dedication and become deserved knights of ASP.NET. <br><br>  Registration for the DevCon 2016 conference is already open!  <a href="https://events.techdays.ru/DevCon/2016/registration">Sign up here</a> . </div><p>Source: <a href="https://habr.com/ru/post/278247/">https://habr.com/ru/post/278247/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278233/index.html">Java programmer cheat sheet 7.1 Typical tasks: The optimal way to convert an InputStream to a string</a></li>
<li><a href="../278235/index.html">Rules of life of the sysadmin</a></li>
<li><a href="../278237/index.html">Pub-Sub implementation examples: Azure Topics, EventHub, ZeroMQ, microServiceBus, etc</a></li>
<li><a href="../278243/index.html">Tales of "engineering special forces", well, or just our fun work</a></li>
<li><a href="../278245/index.html">Stack chases with a stack, or bytecode conversion of a Java virtual machine into a Phantom OS bytecode.</a></li>
<li><a href="../278251/index.html">Preparing an ASP.NET Core: Creating Your Own Tag Helper</a></li>
<li><a href="../278253/index.html">Zephyr Project - real-time open source OS</a></li>
<li><a href="../278255/index.html">Comparing SSL Certificates with Domain Verification</a></li>
<li><a href="../278257/index.html">Passport scanner do it yourself</a></li>
<li><a href="../278261/index.html">VMware NSX and Nutanix: build a fully software-defined data center (Software-Defined Datacenter)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>