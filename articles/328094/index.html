<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Learn and love Xdebug</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Already 15 years have passed since the first release of Xdebug. A great reason to re-introduce this system to the world and explain how and why it doe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Learn and love Xdebug</h1><div class="post__text post__text-html js-mediator-article">  Already 15 years have passed since the first release of Xdebug.  A great reason to re-introduce this system to the world and explain how and why it does what it does. <br><img src="https://habrastorage.org/web/abd/cda/36a/abdcda36ad674722b2b5344656f9dbc7.png" alt="image"><br>  Xdebug is an extension for PHP (must be compiled and installed during the PHP installation process) which presents the following debugging functionality to the developer: <br><a name="habracut"></a><br><ul><li>  Stack traces - output a detailed path that led the application to the error received, including the parameters passed to the functions, in order to easily track the error </li><li>  A more pleasant var_dump output that creates code highlighting and a structured view along with a dump of superglobal variables, by analogy with <a href="https://www.sitepoint.com/var_dump-introducing-symfony-vardumper/">VarDumper</a> . </li><li>  Profiler for searching for bottlenecks of the code with the possibility of visualized presentation of performance graphs by external tools.  The result is a graph similar to the graphics from <a href="https://www.sitepoint.com/an-in-depth-walkthrough-of-supercharging-apps-with-blackfire/">Blackfire</a> . </li><li>  Remote debugger that can be used when connecting to Xdebug to run and execute code in the IDE or browser line by line through break points. </li><li>  ‚ÄúCode Coverage‚Äù which shows how much of the code was executed during the request process.  This function is needed mostly for unit tests and getting information about how well your code is covered with tests. </li></ul><br><h3>  How do i use it? </h3><br>  Xdebug comes with detailed installation instructions that take into account almost all possible uses, although if you want to experiment with the functionality presented below, we recommend using <a href="http://www.sitepoint.com/quick-tip-get-homestead-vagrant-vm-running/">Homestead Improved</a> since Xdebug is installed and activated by default. <br><br><h3>  Why do I need Xdebug when there is a modern IDE and Blackfire? </h3><br>  Modern IDEs provide extensive code search capabilities, so the usefulness of <a href="https://xdebug.org/docs/all_settings">link formatting</a> functionality seems dubious.  There are all kinds of logging systems capable of handling errors and exceptions.  Also, tracing and profiling functions are perfectly implemented in Blackfire.  In spite of all this, formatting links to files is only one of the functions of Xdebug, and using Blackfire is associated with its own difficulties - installing an extension, setting hotkeys, and paying for saving trace history.  And the use of loggers requires care, as adding them to the application at a later stage is not an easy task. <br><br>  But the use of Xdebug is not limited to this.  It is still needed for proper unit testing (testing frameworks are dependent on its code coverage reports), it is far from easy to debug through remote breakpoints by other means, and this tool is so old and stable that it has been polished to near ideal. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Of course, there is no need to use Xdebug if your current toolkit can provide everything that it provides, or if you do not need its capabilities, but I have not had a single project that could be completed as effectively without using it. <br><br><h3>  let's try </h3><br>  It is assumed that at this stage you already have an environment with Xdebug running.  If not, try using <a href="http://www.sitepoint.com/quick-tip-get-homestead-vagrant-vm-running/">Homestead Improved</a> . <br><br>  Let's create a new project consisting of a single index.php file and display the nonexistent $ foo variable: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $foo;</code> </pre> <br>  Here is what we get: <br><br><img src="https://habrastorage.org/web/c51/d42/107/c51d42107b8d48c3b3d8acc4eeb40b45.png" alt="image"><br><br><h3>  Disable Xdebug </h3><br>  Blocks of notifications like this are so commonplace nowadays that most people do not even understand that they are already styled with Xdebug.  To prove it, let's see how this message looked without Xdebug.  To disable Xdebug, edit the /etc/php/7.1/fpm/conf.d/20-xdebug.ini file in <a href="http://www.sitepoint.com/quick-tip-get-homestead-vagrant-vm-running/">Homestead Improved</a> , and comment out the first line: <br><br><pre> <code class="bash hljs">;zend_extension=xdebug.so xdebug.remote_enable = 1 xdebug.remote_connect_back = 1 xdebug.remote_port = 9000 xdebug.max_nesting_level = 512</code> </pre> <br>  Then you need to restart PHP-FRM: <br><br><pre> <code class="bash hljs">sudo service php7.1-fpm restart</code> </pre> <br>  <i><b>Note:</b> if you are using a development environment with a different version of PHP, your Xdebug settings file will most likely be in a different place.</i>  <i>Check the system documentation to find it or ask a question in the comments.</i> <br><br><img src="https://habrastorage.org/web/a82/8bb/e9a/a828bbe9a9f44ab797f0d11e483ab450.PNG" alt="image"><br><br>  Looks pretty meager, right?  The entire call stack disappeared from the output.  Of course, for now this information is not very useful, since we work with only one line in a single file, but later we will use it quite often. <br><br>  Now re-activate Xdebug, uncommenting the line in the previously edited file, and continue.  Do not forget to restart PHP! <br><br><h3>  File transitions </h3><br>  If you have a favorite IDE (I have, for example, PhpStorm), the ability to go to the files in it with a simple click in the stack trace would definitely be useful and would significantly increase the debugging speed.  I will demonstrate how to implement this feature for PhpStorm. <br><br>  Let's open the 20-xdebug.ini file again and add the following to it: <br><br><pre> <code class="bash hljs">xdebug.file_link_format = phpstorm://open?%f:%l</code> </pre> <br>  Note that not all browsers will work.  For example, Opera will have problems with the phpstorm: // link and it will happily fall, while Firefox and Chrome handle such links perfectly. <br><br>  If we now update our PHP error page, we‚Äôll get the IDE opening links immediately at the exact location of the error: <br><br><img src="https://habrastorage.org/web/319/b05/faa/319b05faa7094d129d6069be309d6002.png" alt="image"><br><br>  The setup for working with other IDEs and editors is exactly the same. <br><br><h3>  Xdebug, Vagrant and PhpStorm </h3><br>  Why stop at this?  Many people today use <a href="http://www.sitepoint.com/re-introducing-vagrant-right-way-start-php/">virtual machines</a> for development, allowing them to be sure that no part of the PHP runtime will affect the main machine while keeping everything fast and smooth.  How does Xdebug behave in such cases?  In addition, is it possible, in principle, to debug with break-points when you go through your code and check each line separately? <br><br>  Fortunately, Xdebug perfectly supports the use of break points when remotely connecting.  We have covered this process above, and you can find a fully illustrated setup guide in <a href="https://www.sitepoint.com/install-xdebug-phpstorm-vagrant/">this article</a> . <br><br><h3>  Using the profiler. </h3><br>  In the end, let's look at one of the frequently ignored functions: the profiler.  To do this, we need some large application, for example Laravel: <br><br><pre> <code class="bash hljs">composer create-project --prefer-dist laravel/laravel xdebug</code> </pre> <br>  Again, we need to make changes to the 20-xdebug.ini file, adding the following: <br><br><pre> <code class="bash hljs">xdebug.profiler_enable_trigger = 1 xdebug.profiler_output_dir = /home/vagrant/Code/</code> </pre> <br>  Note that we do not use xdebug.profiler_enable = 1, because we don‚Äôt want it to remain on all the time.  Instead, we use the trigger parameter in the ‚ÄúXDEBUG_PROFILE‚Äù request for selective activation.  We also output the cache profile to the main shared folder of our virtual machine, getting the opportunity to work with it in the host operating system. <br><br>  After restarting PHP, we can verify this by running homestead.app/?XDEBUG_PROFILE (replace homestead.app with the name of the virtual host you chose or the virtual machine IP address).  Of course, the file is where it was expected: <br><br><img src="https://habrastorage.org/web/cbe/af0/dc6/cbeaf0dc630e404fbc3949bf2571c4c4.png" alt="image"><br><br>  Each operating system has its own cache inspector, for OS X, for example, you can use qcachegring, which is easily installed via Homebrew.  After installation‚Ä¶ <br><br><pre> <code class="bash hljs">brew install qcachegrind --with-graphviz</code> </pre> <br>  ... and opening the file, we see a convenient flow split: <br><br><img src="https://habrastorage.org/web/0c4/66f/916/0c466f916e0e401788fb8eec02e5dd88.png" alt="image"><br><br>  Profiler provides detailed access to many data and the ability to thoroughly study the behavior of your code, as well as in Blackfire.  However, with local profiler output, it is much easier to automate continuous monitoring of performance and complexity of execution. <br><br><h3>  Forcing Xdebug to Laravel </h3><br>  By default, Laravel has its own error reports and rendering settings.  An error, like the one that we called earlier with an undefined variable, in Laravel will look like this: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Http</span></span>\<span class="hljs-title"><span class="hljs-title">Request</span></span>; Route::get(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Request $request)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $foo; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> view(<span class="hljs-string"><span class="hljs-string">'welcome'</span></span>); });</code> </pre> <br><img src="https://habrastorage.org/web/38b/317/e43/38b317e430c94d0499241a5c981731eb.png" alt="image"><br><br>  Although the symfony error screen (which Laravel uses in this case) can work just as well with the Xdebug transitions (try it! You can click on these files and their lines!), I really miss the memory information output (Xdebug by default displays a report on memory usage at each time point in the trace).  Let's go back to the Xdebug screen in design mode to track this parameter. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Http</span></span>\<span class="hljs-title"><span class="hljs-title">Request</span></span>; Route::get(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Request $request)</span></span></span></span>{ ini_set(<span class="hljs-string"><span class="hljs-string">'display_errors'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); restore_error_handler(); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $foo; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> view(<span class="hljs-string"><span class="hljs-string">'welcome'</span></span>); });</code> </pre> <br>  As you can see, we updated our default routing so that first it activates the error display (the screen we saw earlier does not show an error as soon as it appears, but saves it to the stack of exceptions that was later extracted and visualized), then we return the error handler to its default value overriding the Laravel value. <br><br>  After the update, of course, our old screen is back - just take a look at this stack trace and memory consumption sheet. <br><br><img src="https://habrastorage.org/web/b93/7bf/2a5/b937bf2a553f4dba8a0e909b884ca750.png" alt="image"><br><br>  I advise you to continue to explore further on your own - review the documentation, play around with the settings, find out how much you can learn about your applications. <br><br><h3>  Conclusion </h3><br>  Xdebug is a valuable tool in the collection of any developer.  This powerful extension fully corresponds to its name, making the language with which we work daily, more detailed, friendly and less mysterious when errors occur. <br><br>  Over the 15 years of its existence, Xdebug has set high standards for debugging tools.  I would like to <a href="https://flattr.com/thing/565889">thank Derik</a> for developing and supporting all this time, and I‚Äôll be happy if you decide to write one or two guides about in-depth use, pitfalls, or hidden combinations of functions that nobody has ever thought about before.  Let's help its spread and development in the next 15 years. <br><br>  Happy Birthday, Xdebug! </div><p>Source: <a href="https://habr.com/ru/post/328094/">https://habr.com/ru/post/328094/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328084/index.html">On the issue of restrictions</a></li>
<li><a href="../328086/index.html">Distributed data structures [part 1, overview]</a></li>
<li><a href="../328088/index.html">Using the KOMPAS-3D API ‚Üí Lesson 1 ‚Üí Basics</a></li>
<li><a href="../328090/index.html">.NET API in web development: past and future</a></li>
<li><a href="../328092/index.html">CI & CD Fengshun Automation with Jenkins and Jira</a></li>
<li><a href="../328096/index.html">Why is your email list ineffective?</a></li>
<li><a href="../328098/index.html">Headquarters Touch Instinct. Tour of the St. Petersburg office</a></li>
<li><a href="../328100/index.html">Security Week 18: A hole in all systems with Intel Core, Apple took away a certificate from a Trojan, ran the wizard flooded the planet</a></li>
<li><a href="../328102/index.html">Phase modulation of the radio signal in the FPGA</a></li>
<li><a href="../328104/index.html">A detailed commentary by Dan Abramov on the article ‚ÄúThings that no one will tell you about React‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>