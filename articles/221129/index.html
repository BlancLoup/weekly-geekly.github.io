<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>EMET, prevention of operation and non-obvious settings</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have already written many times about EMET [ 1 , 2 , 3 , 4 ] and about the "Advanced Protected Mode" (EPM) of the Internet Explorer 10+ [ 1 , 2 ], ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>EMET, prevention of operation and non-obvious settings</h1><div class="post__text post__text-html js-mediator-article">  We have already written many times about EMET [ <a href="http://habrahabr.ru/company/eset/blog/184428/">1</a> , <a href="http://habrahabr.ru/company/eset/blog/177265/">2</a> , <a href="http://habrahabr.ru/company/eset/blog/209694/">3</a> , <a href="http://habrahabr.ru/company/eset/blog/194184/">4</a> ] and about the "Advanced Protected Mode" (EPM) of the Internet Explorer 10+ [ <a href="http://habrahabr.ru/company/eset/blog/200156/">1</a> , <a href="http://habrahabr.ru/company/eset/blog/204084/">2</a> ], and about 64-bit processes for tabs [ <a href="http://habrahabr.ru/company/eset/blog/200156/">1</a> , <a href="http://habrahabr.ru/company/eset/blog/204084/">2</a> ], and innovations Windows 8 / 8.1 [ <a href="http://habrahabr.ru/company/eset/blog/202548/">1</a> ], which use protection against exploitation.  Despite the fact that Microsoft, in recent times, has devoted enough effort to integrate protection against exploits in Windows, many of the settings entered are turned off by default.  Obviously, the approach practiced by the company is that it puts the compatibility of applications with the OS in the first place, and the inclusion of security settings leaves on the shoulders of users (because of the declared compatibility problems). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f71/b07/e48/f71b07e4877fda2d7ad642648c8542c3.jpg"><br><br>  For example, a recent <a href="http://blogs.technet.com/b/msrc/archive/2014/04/26/microsoft-releases-security-advisory.aspx">post</a> on the MSRC for SA 2963983 contains the following sentence. <br><blockquote>  Our online review has revealed that it has been an <b>experience of the</b> Internet Explorer 10 and Internet Explorer 11. </blockquote><br><a name="habracut"></a>  This is despite the fact that the company released last year an update <a href="https://technet.microsoft.com/library/security/ms13-088">MS13-088</a> (see <a href="https://support.microsoft.com/kb/2907803/en-us">KB2907803</a> ), which disables the use of EPM by default for Internet Explorer 11 with the wording: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  During the preview of Internet Explorer 11, it has been enabled by the Internet Explorer.  <b>This is what you‚Äôre incompatible with Enhanced Protected Mode.</b> </blockquote><br>  Thus, before using Internet Explorer for the first time, be sure to check if your security settings are enabled, which the company declares as ‚Äúbasic to be safe‚Äù, but which are disabled by default. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/30f/94b/f21/30f94bf21e534daf9f49f71c82f00ac7.png"><br>  Fig.  IE11 on Windows 8.1 with MS13-088 installed, on the left, manually installed security options, then the restore default settings function was activated. <br><br>  Similar settings exist in EMET. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf9/07e/80e/bf907e80e74e8a5133e5e3a5eef9911c.png"><br>  Fig.  EMET v4.1 Release in ‚ÄúMaximum security settings‚Äù mode, ‚ÄúDeep Hooks‚Äù setting is disabled.  Used to block exploit actions for CVE-2014-1776.  See <a href="http://blogs.technet.com/b/srd/archive/2014/04/26/more-details-about-security-advisory-2963983-ie-0day.aspx">More Details about Security Advisory 2963983 IE 0day</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/456/b75/b13/456b75b13db6a234489795949bd181a1.png"><br>  Fig.  EMET v5.0 TP, the default settings are Deep Hooks and ASR. <br><br>  We have not stopped in detail on EMET 5.0 TP, users can download it from the <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D41963">MS Security TechCenter website</a> .  This version contains two new options called <b>Attack Surface Reduction (ASR)</b> and <b>Export Address Table Filtering Plus (EAF +)</b> .  As seen in the screenshot above, ASR is enabled for Internet Explorer and can be used to prevent the use of CVE-2014-1776.  Due to the fact that this version of EMET has the status of Technical Preview, the company delivers it with the ‚ÄúDeep Hooks‚Äù setting already enabled. <br><br>  <b>Attack Surface Reduction</b> <br><br>  In a narrower sense, ASR applies to Internet Explorer and uses browser-based URL Security Zones to block or allow the execution of plug-ins, such as Oracle Java or Adobe Flash Player, depending on which zone a user is visiting.  More broadly, it is applied to applications in order to forcibly prohibit for them the activation of the corresponding plug-ins that can be used for operation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/efe/fd0/998/efefd09987febf754790ab7461dce502.png"><br>  Fig.  Security Zones URLs that distinguish IE and are used for EMET Attack Surface Reduction. <br><br>  The main meaning of ASR EMET for IE is that it allows the use of potentially unsafe Java and Flash Player plug-ins for websites that are on the organization‚Äôs network (intranet) and prohibits them for the Internet, where the content may be potentially unsafe.  In addition, plug-ins are allowed to use in the Trusted zone (Trusted sites), see below. <br><br>  By default, EMET 5.0 TP includes ASR for the following applications: <br><br><ul><li>  MS Internet Explorer; </li><li>  MS Excel; </li><li>  MS Word. </li></ul><br>  Blocking of plug-ins is done by mask, or by the full name of the library. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d6a/561/c48/d6a561c485da54f8080a7c8391b67f63.png"><br>  Fig.  ASR for IE blocks Java activation (npjpi * .dll, jp2iexp.dll), Vector Markup Language DLL (vgx.dll) (see <a href="https://technet.microsoft.com/en-US/library/security/2963983">SA 2963983</a> ) and Flash Player (flash * .ocx). <br><br>  ASR in EMET 5.0 TP can work only for the three programs listed above. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/221/852/9a3/2218529a3239e6b2ac6cff2d951c5506.png"><br><br>  The zone setting is set by the asr_zones registry parameter, which can have the following values: Local (0), Intranet (1), Trusted (2), Internet (3), Untrusted (4). <br><br>  In such a configuration, when you try to open a document with a Flash Player (SWF) object in Word or Excel, it will be forcibly blocked (or the user will be notified, see Application Configuration ‚Äî Stop on exploit or Audit only). <br><br>  <b>Export Address Table Filtering Plus</b> <br><br>  Customization requiring more detailed technical considerations, see <a href="http://blogs.technet.com/b/srd/archive/2014/02/25/announcing-emet-5-0-technical-preview.aspx">Announcing EMET 5.0 Technical Preview</a> .  Extends the existing <a href="http://habrahabr.ru/company/eset/blog/184428/">EAF setting</a> , which is used to protect against the shell code and allows access to exports of system library modules (kernel32.dll &amp; ntdll.dll) only to the code of known EMET executable modules. <br><br>  EAF + adds to the list of checked libraries and kernelbase.dll (the list can be expanded, see the setting below). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fab/853/156/fab8531567e3f5e53d7e34f06dc95737.png"><br>  Fig.  EAF + is activated by default for EMET 5.0 TP.  But it is used <b>only for the Internet Explorer browser</b> , see the screenshot below. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aff/3c4/c26/aff3c4c26165600abaf8274bd548a8f9.png"><br>  Fig.  By default, EAF + is activated only for IE and is configured to protect the kernelbase, kernel32 and ntdll export tables from the code of the following modules: Image Rendering DLL (mshtml.dll), Flash Player objects (flash * .ocx), JScript DLL (jscript.dll), VBScript DLL (vbscript.dll) and Vector Markup Language DLL (vgx.dll).  Modules were used in attacks to build chains of ROPs. <br><br>  EAF + also blocks access to import tables for a suspicious code that has already been used in attacks (for example, see IE CVE-2013-3163 and CVE-2014-0322) when accessing export addresses via ActionScript (SWF).  See option <a href="http://blogs.technet.com/b/srd/archive/2014/02/25/announcing-emet-5-0-technical-preview.aspx">EAF +</a> . <br><br><blockquote>  ... this is where the mitigation is used. </blockquote><br>  Normal EAF is activated for all applications from the list, see the Application Configuration -&gt; Other -&gt; EAF parameter and is used to protect only kernel32 and ntdll. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fa3/663/c56/fa3663c56725b71647d0abe1169d3187.png"><br>  Fig.  EAF in EMET 4.1 Release is active by default for all processes and is used to block unauthorized access to the EAT (export tables) of the kernel32 and ntdll libraries. </div><p>Source: <a href="https://habr.com/ru/post/221129/">https://habr.com/ru/post/221129/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../221115/index.html">IBM introduced new servers based on Power8 processors</a></li>
<li><a href="../221117/index.html">Clash of Clans - mechanisms for monetizing game time</a></li>
<li><a href="../221119/index.html">Home Connect - one app for all brands</a></li>
<li><a href="../221121/index.html">Trends in online education</a></li>
<li><a href="../221123/index.html">Why do we need reflection in C ++ 1y</a></li>
<li><a href="../221133/index.html">JSR 133 (Java Memory Model) FAQ (translation)</a></li>
<li><a href="../221135/index.html">Viewaide: now web service</a></li>
<li><a href="../221137/index.html">Genetic algorithms in faces</a></li>
<li><a href="../221139/index.html">Bad advice from the creators of the Yandex.Maps API. How to make everything so bad</a></li>
<li><a href="../221141/index.html">Torrent Updater - OS X Open Source program for checking new versions of .torrent files on popular trackers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>