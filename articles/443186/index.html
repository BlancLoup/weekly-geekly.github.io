<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Technical support 3CX answers - 5 rules of IP-PBX security</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hacking PBX 3CX, which lead to serious consequences, happen quite rarely. However, our clients sometimes fall victim to scammers. As practice has show...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Technical support 3CX answers - 5 rules of IP-PBX security</h1><div class="post__text post__text-html js-mediator-article">  Hacking PBX 3CX, which lead to serious consequences, happen quite rarely.  However, our clients sometimes fall victim to scammers.  As practice has shown, this is mainly due to either incorrect system settings or the use of the outdated version of 3CX.  In this article we will look at the most common mistakes that can lead to hacking your PBX, and explain how to prevent them. <a name="habracut"></a><br><br><h3>  How do phone scammers work? </h3><br>  Telephony fraud is rather trivial - outsiders or a robot-dealer make calls through your PBX at your expense.  This usually happens late at night or on non-working days.  Challenges continue for as long as possible, with high frequency and on the most expensive international destinations.  And at the end of the month, you receive a bill from a telecoms operator for a huge amount that you must pay or challenge in court. <br><br>  Calls to the most expensive international destinations were the main goal of hackers in the early period of development of program PBXs.  One might think that this type of fraud is a thing of the past, especially given the cheapening of international negotiations.  However, this is currently being done by well-organized international groups that are looting customers and operators on an industrial scale. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now PBX hack to make thousands of calls to the "expensive" numbers of various paid automatic services, which are controlled by the same scammers.  In this case, the attacker receives a profit in the form of a commission from the operator for each minute of a paid call.  This fraud is also called International Revenue Sharing Fraud (IRSF). <br><br>  Another way to make illegal money is to sell the stolen credentials of SIP clients on ‚Äúunderground‚Äù online exchanges.  Further, such access is used in different ways - or to compete with legal telecom operators, which makes it possible to sell minutes much cheaper than the market price, or for some personal needs of the buyer. <br><br>  3CX has several security levels, the default settings of which prevent most known types of attacks.  However, some system administrators change or disable these settings without even realizing what the consequences are. <br><br>  Let's look at the most common mistakes in security settings that 3CX administrators make. <br><br><h3>  Weak user credentials </h3><br>  The first error is the ‚Äúweak‚Äù account credentials that are used by 3CX applications, IP phones and users. <br><br>  When you create a user (extension) in 3CX, secure credentials are automatically generated for it at all levels of access.  These are complex SIP password and web client login password, randomly generated passwords for accessing the IP phone's web interface, random voice mail PIN, etc ... Be sure to use only these secure credentials, because random long passwords guarantee protection against attacks with password pickup (also called brute force attacks). <br><br>  Starting from 3CX v15.5, the system will not allow you to set an extension password weaker than is required by modern security rules.  However, often weak account passwords are inherited from backups of previous versions of 3CX.  Therefore, 3CX now warns the administrator if there are extension numbers with weak passwords in the system ‚Äî a warning appears near such numbers.  If you hover over it, additional information will appear. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a45/d60/7c1/a45d607c16ba76b93ef3fcbd317ad14c.png"><br><br>  By the way, we strongly do not recommend setting weak passwords for testing purposes.  As a rule, people forget to change them and leave the PBX "full of holes". <br><br><h3>  Enabled SIP Remote Access to an Extension Number </h3><br>  The second mistake is disabling the option ‚ÄúDeny connection from the public network‚Äù and not turning it back on when the user does not need it anymore. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/85b/6aa/c5d/85b6aac5d6519d065624dd17afdadf40.png"><br><br>  This option is enabled by default in 3CX and prevents any users outside your local network from logging in.  Please note - you can use 3CX applications or web client without enabling remote access, since they use <a href="https://www.3cx.ru/docs/3cx-tunnel-session-border-controller/">tunneling</a> technology to connect to the PBX.  This option should be disabled only if someone needs a direct SIP connection for a hardware IP phone. <br><br>  <b>Try to avoid direct SIP-connections to your PBX or allow them only from certain IP addresses specified in the firewall.</b> <br><br><h3>  Many allowed directions for calls </h3><br>  When installing 3CX, the Initial Setup Wizard asks which countries need to allow outgoing calls.  The same list of countries can be seen (and changed) in the section Settings - Security - Allowed international country codes.  You should allow only those countries (prefixes) to which your users are actually calling.  By default, 3CX allows calls only to the country that was specified as the installation location of the PBX. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c3a/575/676/c3a575676fa7db66ab7d4c679b38be15.png"><br><br>  A very dangerous practice is to allow all countries to install a PBX, and limit them later.  Usually they forget about it, allowing the attacker to call in all directions as soon as he received the credentials of the PBX user. <br><br><h3>  Outgoing rules too loose </h3><br>  Another bad practice is the use of too general outgoing rules that allow any user (3CX Default organizational group) to call in any allowed direction.  Some administrators, in order not to complicate their lives, create for this one universal rule. <br><br>  In fact, you should create outgoing rules with the minimum necessary permissions, according to the same principle, according to which they are created, for example, in a firewall.  Specifically, list the prefixes, set the minimum and maximum length of the number, explicitly specify the group of extensions that are allowed to call in this direction. <br><br><h3>  Invalid processing parameters E164 </h3><br>  In the Parameters - Numbers section, E164 sets the number processing, in which the ‚Äú+‚Äù symbol at the beginning of the number is replaced with the international dialing code.  Substitution rules are determined for the country that is listed as the place where the PBX is installed.  In most countries, "+" is replaced by 00, and for America - by 011. Substitution conforms to ITU standards. <br><br>  The parameters of E164 are important because they are used to determine prohibited directions (prefixes), which we discussed above.  For example, if the blocked country is Albania, 3CX will analyze and block numbers starting with 00355xxx and + 355xxx. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cef/2da/7f0/cef2da7f0b06aeaa7be3778a055d451b.png"><br><br>  If you incorrectly specify the international dialing code for your country, this will lead not only to the erroneous substitution of ‚Äú+‚Äù, but also to the incorrect operation of the blocking function of countries. <br><br><h3>  New security features in 3CX v16 </h3><br>  The <a href="https://www.3cx.ru/ip-pbx/download-atc/">3CX v16</a> adds two interesting security features. <br><br>  The first is to restrict access by IP address to the 3CX management interface.  It is configured in the section Settings - Security - Restricting access to the interface.  By default, all IP addresses are allowed, but if IP protection is enabled, access will be allowed only from the local network and explicitly specified external IP addresses.  Please note that this restriction does not affect the operation of other 3CX web services, such as auto phone configuration, web client, etc. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/142/3b5/8ec/1423b58ec839a8952e04cb8879f8a33a.png"><br><br>  The second security feature is a self-learning global blacklisting of IP addresses supported by 3CX.  It is included in the section Settings - Security Settings - Anti-hacking.  If this option is enabled, the PBX will automatically transmit suspicious activity information to our central server, including the source IP address.  After analyzing the event, information about this IP address will be automatically transferred to all 3CX systems in the world that also have this feature enabled.  Thus, suspicious traffic will be blocked due to ‚Äúcollective intelligence‚Äù.  Today, our global list already contains more than 1000 IPv4 IP addresses, with which scanning or hacking attempts have been consistently repeated.  We strongly recommend to enable this feature on your PBX! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b67/5b3/aa0/b675b3aa03b05d6b1535af94728921a3.png"><br><br><h3>  Conclusion </h3><br>  We noticed that the hacking of the system is preceded by several errors taken together.  We practically did not observe situations when serious consequences arose only because of one error. <br><br>  Well, if you still hacked - do not panic!  It is very important to collect server logs before taking radical actions.  Subsequently, it will help conduct a qualitative investigation of the incident.  To collect logs, go to the Support section - Create a file for technical support.  A zip archive will be generated, the link to which will be sent to your e-mail.  Attach this file and the incident description to contacting 3CX technical support. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/149/17c/cf8/14917ccf821caade2629806edf87b1f2.png"><br><br>  You should contact technical support if you have any reasonable questions about 3CX security or you want to report a hack that has already taken place.  To understand the situation and get the necessary recommendations, open an appeal to the category "Security - Fraud".  These appeals are treated with the highest priority.  You can also get 3CX security advice in our <a href="https://www.3cx.ru/forum/">user forum</a> . </div><p>Source: <a href="https://habr.com/ru/post/443186/">https://habr.com/ru/post/443186/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../443166/index.html">Creating and updating mailing lists in Zimbra Collaboration OSE based on Active Directory groups and users</a></li>
<li><a href="../443174/index.html">hellOGL: OpenGL hello world</a></li>
<li><a href="../443176/index.html">7 chrome extensions for learning English</a></li>
<li><a href="../443182/index.html">Pull YPbPr from Commodore 64</a></li>
<li><a href="../443184/index.html">From love to control one step</a></li>
<li><a href="../443188/index.html">Three eyes hang on a pole, or the tale that ATtiny13 has five legs</a></li>
<li><a href="../443194/index.html">WFIRM engineers invented a bioprinter that prints the skin directly on the wound.</a></li>
<li><a href="../443198/index.html">Mark Zuckerberg said Facebook is working on a neurointerface to read thoughts</a></li>
<li><a href="../443200/index.html">Iranian hackers stole terabytes of data from Citrix</a></li>
<li><a href="../443202/index.html">Rally against Runet isolation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>