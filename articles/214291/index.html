<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Wattmeter absorbed microwave power and my participation in its development</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear readers. I registered on Habr√© for a long time, but did not dare to issue my first post. 

 I wanted to write something that might seem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Wattmeter absorbed microwave power and my participation in its development</h1><div class="post__text post__text-html js-mediator-article">  Good day, dear readers.  I registered on Habr√© for a long time, but did not dare to issue my first post. <br><br>  I wanted to write something that might seem interesting.  Time passed, and ideas never came. <br><br>  And so, just the other day, I finished work on one of my first projects, after which, I had the idea to make a video review and write a small article about the device, on which I worked for a rather long period of time.  I did not work alone, but it will be about the part that ‚Äúhung‚Äù entirely on me. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  For starters, I‚Äôll give you some dry technical information. </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/6bb/2fb/58d/6bb2fb58da186adbe51f086e46d90f60.jpg" alt="image"><br><br><a name="habracut"></a><blockquote>  The wattmeter of the absorbed microwave power M3-114 is designed to measure in the coaxial path the average power of continuous and pulsed modulated microwave signals when powered from an industrial power network of 220 V, 50 Hz, and in standalone mode, from an internal or external battery 12 V. The device uses a four-line high-brightness vacuum-luminescent text display.  Preparation of the device for operation is carried out in the dialogue mode, which simplifies operation.  The device is equipped with an RS-232 port, which allows you to display data on a computer. <br><br>  The operating frequency range is from 0.00 to 17.85 GHz. <br><br>  The measurement range of average power from 1.0 ¬µW to 100 watts. <br><br>  In the range of the measured power of more than 10 mW at frequencies from 0 to 12.05 GHz, the limit of the basic error of the wattmeter does not exceed ¬± 4%, and in the frequency range from 12.05 GHz to 17.85 GHz - ¬± 6%. <br><br>  KSVN wattmeter no more: <br>  1.3 in the frequency range from 0.02 to 12.05 GHz; <br>  1.4 in the frequency range above 12.05 to 17.85 GHz. <br><br>  The instability of the wattmeter, taking into account the drift of the ‚Äúelectric zero‚Äù is not more than 40 ŒºW / min. <br><br>  The power consumed by the wattmeter from the mains voltage of 220 ¬± 22 V, frequency 50 ¬± 0.5 Hz when working with PPK1 - PPK3, not more than 12 VA, when working with PPK 4 - not more than 15 VA, when operating from an independent power source 6, 5 VA </blockquote><br><habracut text=""><br><h4>  Now let's go directly to the tasks that were set for me </h4><br>  First, it was necessary to develop a program that controls the charger.  It consists largely of the ADUC814 microcontroller with a built-in analog-digital converter, five LEDs responsible for the battery charge level and the charge button.  Everything is quite simple, I do not see the point of describing in detail.  By interrupting the ADC, we get data that is then converted to volts, then using this value, the program makes certain decisions, such as what diodes to light, what to do at critical charge levels, etc., as well as watching the charge enable button. <br><br>  Secondly, and this is actually the most difficult part for me, it was necessary to develop a program that controls the information processing and display unit.  The components include the display, the keyboard, a pair of auxiliary LEDs and the AT89C51RC2 microcontroller (IC_BOI) controlling all of this.  An overview of all the main functions of the power meter is presented in the video. <br><br>  One of four transducers is connected to the wattmeter, depending on the measured power.  The data from the converter is transferred to the analog-to-digital converter of the company Analog Devices and then transmitted via RS232 to another ADUC814 (MK_ATCP), in which they undergo preliminary processing.  Program Prev  processing and communication directly with the ADC was not developed by me. <br><br>  MK_ATSP via RS232 receives from MK_BOI one of several commands, each of which consists of three bytes, then it analyzes the command and, depending on it, sends back three bytes of the command number and the requested result.  This may be the number of the transducer or, for example, measurement results that are subjected to further mathematical processing.  Some commands are responsible for zero correction or ADC calibration.  There are about 8-9 teams in total, I don‚Äôt see the point either. <br><br>  In the end, I would like to write a little about the functionality, which you can read more on video. <br>  The main part of the keyboard buttons performs a dual function, auxiliary LEDs make it easier to navigate in the operating modes, of which there are only two, this is the menu mode, the upper diode is on and the operating mode is on, the lower diode is on. <br><br><h5>  A number of functions can be performed using the menu. </h5><br><ul><li>  Control display brightness </li><li>  Select the frequency range on which measurements are made.  Depending on the selected range, certain correction factors are applied that affect the final result.  The coefficients are calculated by comparing with the reference instrument. </li><li>  To establish a certain value P, with which the measured value is compared.  The result is displayed in percent. </li><li>  Set the range of the measured value, when exiting from it, the corresponding message &lt;Pmin,&gt; Pmax is displayed </li></ul><br><h5>  In the operation mode, the user can: </h5><br><ul><li>  Perform zero correction and ADC calibration. </li><li>  Enable averaging of the measured value or turn it off. </li><li>  ‚ÄúFreeze‚Äù the display by pressing the STOP button </li></ul><br><br>  All necessary information is displayed on the display.  The value of the measured value, which also translates into dBm and dB, during the zero drift, negative values ‚Äã‚Äãare also encountered, in these cases the message Err is displayed.  The result of comparing the power with the value of Pc.  The number of the connected inverter.  Information that the STOP button is pressed, as well as when a specific transmitter is out of the possible measuring range, a corresponding message is also displayed. <br><br>  I would also like to add that in addition to frequency correction coefficients, there is also a dynamic correction factor, calculated individually for each specific measurement. <br><br>  That's all, I hope that there will be people who will enjoy this post, as well as I would like to see comments of a critical nature, maybe someone will have interesting ideas that I can implement in the future as part of this project, given what is planned replacing the MC_BOGI with a similar one, with a large memory capacity, since these 32 KB are packed to capacity. <br><br>  Thanks for attention. <br><br><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/87843232&amp;xid=17259,15700023,15700043,15700186,15700190,15700253&amp;usg=ALkJrhg1483MpPQqlWEnTLBnYM9ut6o-4w" width="560" height="315" frameborder="0" title="Powermeter" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe><br><br><h4>  CODING </h4><br>  I apologize for the long break.  In the comments there were questions about the process of programming itself, in this regard, I want to update this article and add code here. <br><br><h5>  Display alphabet </h5><br>  Information output on the display was organized as follows.  A list of duplicate phrases was compiled and the ‚ÄúalphabetLCD.h‚Äù library was written for them: <br><br><pre><code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">void</span></span> m3114(); // " -114" <span class="hljs-type"><span class="hljs-type">void</span></span> noSignalADC(); // "   " <span class="hljs-type"><span class="hljs-type">void</span></span> wait(); // "" <span class="hljs-type"><span class="hljs-type">void</span></span> norma(); //  <span class="hljs-type"><span class="hljs-type">void</span></span> PPK1(); <span class="hljs-type"><span class="hljs-type">void</span></span> PPK2(); <span class="hljs-type"><span class="hljs-type">void</span></span> PPK3(); <span class="hljs-type"><span class="hljs-type">void</span></span> PPK4(); <span class="hljs-type"><span class="hljs-type">void</span></span> prepareToWorkOnPPKEnter(); //           "" <span class="hljs-type"><span class="hljs-type">void</span></span> heating(); //  <span class="hljs-number"><span class="hljs-number">6</span></span> ? <span class="hljs-number"><span class="hljs-number">34</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> ifTNorm(); //  =<span class="hljs-number"><span class="hljs-number">15</span></span><span class="hljs-number"><span class="hljs-number">-25</span></span>  ""    "" <span class="hljs-type"><span class="hljs-type">void</span></span> Kcoeff(); //   <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">000</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> preparationOfMeasurement(); //    <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> resetMenuParams(); //     <span class="hljs-type"><span class="hljs-type">void</span></span> readyToMeasurement(); //     <span class="hljs-type"><span class="hljs-type">void</span></span> menuSet1(); //    ***   ***    ***   <span class="hljs-type"><span class="hljs-type">void</span></span> switchOffSVCHAndPressEnter(); // "      void preparationOfMeasurementCorrection0(); //    "<span class="hljs-number"><span class="hljs-number">0</span></span>"  void preparationOfMeasurementCooling(); //    30  void preparationOfMeasurementStop32(); //   32 ? 24 void preparationToWork(); //          void hertzType0(); // 0-1 1-4 4-8 8-12 void hertzType1(); // 12-15 15-17.85 void setPCompare(); //  .  ? 1,000 mW void setPCompareChange(); //  .  -    : , void allowenceControlMin(); //   min:  ? , W void allowenceControlMax(); //   max:  ? , W void setAllowenceControlMin(); //  min  -    : , void setAllowenceControlMax(); //  max  -    : , void menuSet2(); //     4 8 16 void brightnessSet(); // 25% 50% 75% 100% void fault(); // !!! void incorrectValue(); //  !   void overload(); // !!!   &gt;   </code> </pre> <br><br><h6>  I will give an example of the implementation of one of the functions from ‚ÄúalphabetLCD.‚Äù </h6><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">void</span></span> noSignalADC() // "   " { writeData(<span class="hljs-string"><span class="hljs-string">'H'</span></span>); writeData(<span class="hljs-string"><span class="hljs-string">'E'</span></span>); writeData(<span class="hljs-string"><span class="hljs-string">'T'</span></span>); writeData(<span class="hljs-string"><span class="hljs-string">' '</span></span>); writeData(<span class="hljs-string"><span class="hljs-string">'C'</span></span>); writeData(<span class="hljs-string"><span class="hljs-string">'B'</span></span>); writeData(<span class="hljs-number"><span class="hljs-number">0x99</span></span>); writeData(<span class="hljs-number"><span class="hljs-number">0x8D</span></span>); writeData(<span class="hljs-number"><span class="hljs-number">0x8E</span></span>); writeData(<span class="hljs-string"><span class="hljs-string">' '</span></span>); writeData(<span class="hljs-string"><span class="hljs-string">'C'</span></span>); writeData(<span class="hljs-string"><span class="hljs-string">' '</span></span>); writeData(<span class="hljs-string"><span class="hljs-string">'A'</span></span>); writeData(<span class="hljs-number"><span class="hljs-number">0x90</span></span>); writeData(<span class="hljs-number"><span class="hljs-number">0x85</span></span>); }</code> </pre><br>  Since sometimes I had to display the results of the calculations implemented in ‚Äúmain.c‚Äù, I used the <code>extern</code> keyword: <br><pre> <code class="hljs pgsql">extern <span class="hljs-type"><span class="hljs-type">bit</span></span> hertzType; extern <span class="hljs-type"><span class="hljs-type">float</span></span> xdata calibrFl; extern unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata ppkNumberCh; //   <span class="hljs-type"><span class="hljs-type">char</span></span> extern <span class="hljs-type"><span class="hljs-type">float</span></span> xdata pCompareFl; extern <span class="hljs-type"><span class="hljs-type">float</span></span> xdata pMinFl; //    <span class="hljs-type"><span class="hljs-type">float</span></span> extern <span class="hljs-type"><span class="hljs-type">float</span></span> xdata pMaxFl; //    <span class="hljs-type"><span class="hljs-type">float</span></span></code> </pre><br><h5>  Let's move on to the main program. </h5><br>  The following are all the main "main.h" functions: <br><pre> <code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialization</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delay2s</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zeroCorrection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calibration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">measurement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">//****UART**** void sendData (unsigned char); // send to UART //unsigned char recvData(); // recive from UART void iToA (int , char * ); void getPPKnumber(); //****Keyboard**** void keyboardInit(); void keyboardPolling(); void downZero(); void upCalibr(); void lessAveraging(); void morePC(); void commaStop(); void cancel(); void enter(); void menu(); //****Display**** void dispInit(); void writeCmd(int); void writeData(char); void readBF(); void returnHome(); void clearDisp(); void reloadDisp(); void moreLessCheck();</span></span></code> </pre><br><h6>  Macros </h6><br>  For the convenience of programming the display, calling its commands, moving the cursor in rows, etc.  Macros were actively used: <br><pre> <code class="hljs cs"><span class="hljs-comment"><span class="hljs-comment">/* __________MAKROS BLOCK__________ */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> FIRST_LINE 0x80 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SECOND_LINE 0xC0 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> THIRD_LINE 0x94 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> FOURTH_LINE 0xD4 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CURSOR_HOME 0x02 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CLEAR_DISP 0x01 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DISP_OFF 0x08 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DISP_ON_CB_OFF 0x0C // Disp ON cursore &amp; blink OFF #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DISP_ON_CB_ON 0x0F #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> FIRST_SIMBOL 0xD4 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SECOND_SIMBOL 0xD5 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> THIRD_SIMBOL 0xD6 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> FOURTH_SIMBOL 0xD7 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> FIFTH_SIMBOL 0xD8 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SIXTH_SIMBOL 0xD9 /* __________MAKROS BLOCK END__________ */</span></span></code> </pre><br><h6>  Configuring the processor legs </h6><br><pre> <code class="hljs markdown"><span class="hljs-bullet"><span class="hljs-bullet">* </span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span>PINS BLOCK<span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span> <span class="hljs-emphasis"><span class="hljs-emphasis">*/ sbit E = P3^4; sbit RS = P3^6; sbit RW = P3^5; sbit workLed = P3^2; sbit menuLed = P3^3; sbit enterBut = P1^6; sbit cancelBut = P1^5; sbit uartPC = P3^7; /*</span></span> <span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span>PINS BLOCK END<span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span> */</code> </pre><br><h6>  Variable description </h6><br><pre> <code class="hljs pgsql"><span class="hljs-comment"><span class="hljs-comment">/* __________VARIABLES BLOCK__________ */</span></span> unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> keyPressed = <span class="hljs-number"><span class="hljs-number">0</span></span>; // key pressed <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-type"><span class="hljs-type">bit</span></span> keyFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; // software flag unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata uartDataRecv = <span class="hljs-number"><span class="hljs-number">0</span></span>; //     unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata uartDataSend = <span class="hljs-number"><span class="hljs-number">0</span></span>; //     <span class="hljs-type"><span class="hljs-type">char</span></span> xdata uartRecvCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      <span class="hljs-type"><span class="hljs-type">bit</span></span> menuFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //    ,  <span class="hljs-number"><span class="hljs-number">1</span></span> -  ,  <span class="hljs-number"><span class="hljs-number">0</span></span> -  <span class="hljs-type"><span class="hljs-type">char</span></span> xdata <span class="hljs-keyword"><span class="hljs-keyword">move</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>; //     <span class="hljs-type"><span class="hljs-type">bit</span></span> signalFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //          <span class="hljs-type"><span class="hljs-type">char</span></span> xdata enterFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //     <span class="hljs-type"><span class="hljs-type">char</span></span> xdata cancelFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //     <span class="hljs-type"><span class="hljs-type">bit</span></span> modeFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //       <span class="hljs-type"><span class="hljs-type">bit</span></span> brightnessFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; // ,       <span class="hljs-type"><span class="hljs-type">char</span></span> xdata brightnessMove = <span class="hljs-number"><span class="hljs-number">1</span></span>; //       <span class="hljs-type"><span class="hljs-type">char</span></span> xdata brightnessSetFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //   ,    <span class="hljs-type"><span class="hljs-type">bit</span></span> hertzFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; // ,       <span class="hljs-type"><span class="hljs-type">char</span></span> xdata hertzSetFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-type"><span class="hljs-type">char</span></span> xdata menuStep = <span class="hljs-number"><span class="hljs-number">0</span></span>; //   <span class="hljs-type"><span class="hljs-type">char</span></span> xdata hertzMove = <span class="hljs-number"><span class="hljs-number">1</span></span>; //       <span class="hljs-type"><span class="hljs-type">bit</span></span> hertzType; //     <span class="hljs-type"><span class="hljs-type">bit</span></span> compareFlag; //     <span class="hljs-type"><span class="hljs-type">char</span></span> xdata compareFlagEnter = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      <span class="hljs-type"><span class="hljs-type">char</span></span> xdata compareFlagCancel = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      <span class="hljs-type"><span class="hljs-type">char</span></span> xdata moreLess = <span class="hljs-number"><span class="hljs-number">0x30</span></span>; //       <span class="hljs-type"><span class="hljs-type">char</span></span> xdata moreLessFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //       <span class="hljs-type"><span class="hljs-type">bit</span></span> moreFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //  <span class="hljs-number"><span class="hljs-number">1</span></span>    moreLess -= <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-type"><span class="hljs-type">bit</span></span> lessFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //  <span class="hljs-number"><span class="hljs-number">1</span></span>    moreLess +=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-type"><span class="hljs-type">char</span></span> xdata wattFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      <span class="hljs-type"><span class="hljs-type">bit</span></span> commaFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //            unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata pCompare[<span class="hljs-number"><span class="hljs-number">10</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; //    <span class="hljs-type"><span class="hljs-type">float</span></span> xdata pCompareFl = <span class="hljs-number"><span class="hljs-number">1.0</span></span>; //<span class="hljs-type"><span class="hljs-type">float</span></span> xdata pCompareFlTemp = <span class="hljs-number"><span class="hljs-number">1.0</span></span>; //        . // ,   !!! <span class="hljs-type"><span class="hljs-type">bit</span></span> controlFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //     <span class="hljs-type"><span class="hljs-type">char</span></span> xdata controlFlagEnter = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      <span class="hljs-type"><span class="hljs-type">char</span></span> xdata controlFlagCancel = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata pMin[<span class="hljs-number"><span class="hljs-number">10</span></span>]; //   min unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata pMax[<span class="hljs-number"><span class="hljs-number">10</span></span>]; //   max <span class="hljs-type"><span class="hljs-type">float</span></span> xdata pMinFl = <span class="hljs-number"><span class="hljs-number">0</span></span>; //    <span class="hljs-type"><span class="hljs-type">float</span></span> <span class="hljs-type"><span class="hljs-type">float</span></span> xdata pMaxFl = <span class="hljs-number"><span class="hljs-number">0</span></span>; //    <span class="hljs-type"><span class="hljs-type">float</span></span> <span class="hljs-type"><span class="hljs-type">bit</span></span> pMinFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      min <span class="hljs-type"><span class="hljs-type">bit</span></span> pMaxFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      max unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata zeroCoef1 = <span class="hljs-number"><span class="hljs-number">50</span></span>; //    <span class="hljs-number"><span class="hljs-number">50</span></span> - <span class="hljs-number"><span class="hljs-number">200</span></span> unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata zeroCoef2 = <span class="hljs-number"><span class="hljs-number">30</span></span>; //    <span class="hljs-number"><span class="hljs-number">50</span></span> - <span class="hljs-number"><span class="hljs-number">200</span></span> unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata zeroCoef3 = <span class="hljs-number"><span class="hljs-number">30</span></span>; //    <span class="hljs-number"><span class="hljs-number">50</span></span> - <span class="hljs-number"><span class="hljs-number">200</span></span> unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata zeroCoef4 = <span class="hljs-number"><span class="hljs-number">100</span></span>; //    <span class="hljs-number"><span class="hljs-number">50</span></span> - <span class="hljs-number"><span class="hljs-number">200</span></span> unsigned long xdata zero; //     unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata calibrCoef1 = <span class="hljs-number"><span class="hljs-number">50</span></span>; //   <span class="hljs-number"><span class="hljs-number">50</span></span> - <span class="hljs-number"><span class="hljs-number">200</span></span> unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata calibrCoef2 = <span class="hljs-number"><span class="hljs-number">30</span></span>; //   <span class="hljs-number"><span class="hljs-number">50</span></span> - <span class="hljs-number"><span class="hljs-number">200</span></span> unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata calibrCoef3 = <span class="hljs-number"><span class="hljs-number">30</span></span>; //   <span class="hljs-number"><span class="hljs-number">50</span></span> - <span class="hljs-number"><span class="hljs-number">200</span></span> unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata calibrCoef4 = <span class="hljs-number"><span class="hljs-number">100</span></span>; //   <span class="hljs-number"><span class="hljs-number">50</span></span> - <span class="hljs-number"><span class="hljs-number">200</span></span> unsigned long xdata calibr; //      <span class="hljs-type"><span class="hljs-type">float</span></span> xdata calibrFl; //      unsigned <span class="hljs-type"><span class="hljs-type">int</span></span> xdata PPK1CalibrPower; //     <span class="hljs-number"><span class="hljs-number">1</span></span>   unsigned long xdata PPK23CalibrPower; //     <span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-number"><span class="hljs-number">2</span></span>   unsigned long xdata PPK4CalibrPower; //     <span class="hljs-number"><span class="hljs-number">4</span></span>   <span class="hljs-type"><span class="hljs-type">float</span></span> xdata PPK1CalibrStandart; //       (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-type"><span class="hljs-type">float</span></span> xdata PPK2CalibrStandart; //       (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-type"><span class="hljs-type">float</span></span> xdata PPK3CalibrStandart; //       (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-type"><span class="hljs-type">float</span></span> xdata PPK4CalibrStandart; //       (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>) unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata uartData[<span class="hljs-number"><span class="hljs-number">10</span></span>]; //          unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> xdata ppkNumberCh; //   <span class="hljs-type"><span class="hljs-type">char</span></span> <span class="hljs-type"><span class="hljs-type">float</span></span> xdata measurementResult = <span class="hljs-number"><span class="hljs-number">0</span></span>; //    <span class="hljs-type"><span class="hljs-type">bit</span></span> averagingFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; //   <span class="hljs-type"><span class="hljs-type">bit</span></span> averaging4 = <span class="hljs-number"><span class="hljs-number">0</span></span>; //   <span class="hljs-number"><span class="hljs-number">4</span></span>- <span class="hljs-type"><span class="hljs-type">bit</span></span> averaging8 = <span class="hljs-number"><span class="hljs-number">0</span></span>; //   <span class="hljs-number"><span class="hljs-number">8</span></span>- <span class="hljs-type"><span class="hljs-type">char</span></span> xdata averagingMove = <span class="hljs-number"><span class="hljs-number">1</span></span>; //      <span class="hljs-type"><span class="hljs-type">float</span></span> idata hertzRate = <span class="hljs-number"><span class="hljs-number">1</span></span>; //      <span class="hljs-number"><span class="hljs-number">6</span></span>() * <span class="hljs-number"><span class="hljs-number">4</span></span>() = <span class="hljs-number"><span class="hljs-number">24</span></span>  <span class="hljs-type"><span class="hljs-type">float</span></span> idata dynamicRate = <span class="hljs-number"><span class="hljs-number">1</span></span>; //    //   <span class="hljs-number"><span class="hljs-number">4</span></span>() * <span class="hljs-number"><span class="hljs-number">4</span></span>() = <span class="hljs-number"><span class="hljs-number">16</span></span>  <span class="hljs-type"><span class="hljs-type">char</span></span> idata stop = <span class="hljs-number"><span class="hljs-number">0</span></span>; //   <span class="hljs-number"><span class="hljs-number">1</span></span>       ,  <span class="hljs-number"><span class="hljs-number">0</span></span>    <span class="hljs-type"><span class="hljs-type">char</span></span> idata pc = <span class="hljs-number"><span class="hljs-number">0</span></span>; //       //<span class="hljs-type"><span class="hljs-type">bit</span></span> key = <span class="hljs-number"><span class="hljs-number">0</span></span>; xdata <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> { unsigned long bytes; unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> byteArr[<span class="hljs-number"><span class="hljs-number">4</span></span>]; } byteUnion; <span class="hljs-comment"><span class="hljs-comment">/* __________VARIABLES BLOCK END__________ */</span></span></code> </pre><br><h6>  Interruptions </h6><br><pre> <code class="hljs pgsql"><span class="hljs-comment"><span class="hljs-comment">/* __________INTERUPTS BLOCK__________ */</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> keyboard_interrupt() interrupt <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> { IEN1 &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>); //   keyFlag = <span class="hljs-number"><span class="hljs-number">0</span></span>; keyPressed = KBF; <span class="hljs-comment"><span class="hljs-comment">/* save pressed key */</span></span> keyFlag = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* set the software flag */</span></span> KBF = <span class="hljs-number"><span class="hljs-number">0x00</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* clear keyboard flags */</span></span> delay(<span class="hljs-number"><span class="hljs-number">50000</span></span>); // <span class="hljs-number"><span class="hljs-number">50</span></span> mc IEN1 |= <span class="hljs-number"><span class="hljs-number">0x01</span></span>; //   } <span class="hljs-type"><span class="hljs-type">void</span></span> serial_IT(<span class="hljs-type"><span class="hljs-type">void</span></span>) interrupt <span class="hljs-number"><span class="hljs-number">4</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (RI == <span class="hljs-number"><span class="hljs-number">1</span></span>) { uartDataRecv = SBUF; uartData[uartRecvCount] = uartDataRecv; ++uartRecvCount; } RI = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/* __________INTERUPTS BLOCK END__________ */</span></span></code> </pre><br><br>  <i>TO BE CONTINUED...</i> </habracut></div><p>Source: <a href="https://habr.com/ru/post/214291/">https://habr.com/ru/post/214291/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../214279/index.html">Skolkovo Robotics visit via Webot robots</a></li>
<li><a href="../214281/index.html">Test task of my dream</a></li>
<li><a href="../214285/index.html">PHP design patterns. Part 1. Generating</a></li>
<li><a href="../214287/index.html">Colobot Gold - opensource version of the game Colobot</a></li>
<li><a href="../214289/index.html">About SAN (Storage Area Network) on the fingers</a></li>
<li><a href="../214293/index.html">AngularJS vs IML</a></li>
<li><a href="../214295/index.html">Overview of CAdES Formats</a></li>
<li><a href="../214297/index.html">Ministry of Education and Science: programming cannot be taught exclusively remotely</a></li>
<li><a href="../214299/index.html">Simple Science - Experience Digest # 29</a></li>
<li><a href="../214301/index.html">Bing in Russia out of beta?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>