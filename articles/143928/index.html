<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Grape multitouch</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Stumbled upon an interesting thing called MaKey MaKey. 

 http://makeymakey.com/ 

 That is what I respect Americans for - it‚Äôs for talent to beautifu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Grape multitouch</h1><div class="post__text post__text-html js-mediator-article">  Stumbled upon an interesting thing called MaKey MaKey. <br><br>  <a href="http://makeymakey.com/">http://makeymakey.com/</a> <br><br>  That is what I respect Americans for - it‚Äôs for talent to beautifully present and bring to production the simplest thing. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/rfQqh7iCcOU%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhjDYRo0W5Xupmb_dnssR-5I7Cechg" frameborder="0" allowfullscreen=""></iframe><br><br>  I watched the video, I was glad for the guys.  But somewhere immediately start to itch.  Climbed for rezukami.  After 15 minutes (of which five minutes went for a smoke break) this device turned out like this: <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/yadl4rdzT78%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhjLWu8yRP_28kXyV2EEFYo2k6ZVWw" frameborder="0" allowfullscreen=""></iframe><br><br>  UPD&gt; ... after a while.  A new video with the practical use of a grape multitouch :-) The source of the soft in C # and the new sketch for Arduin are laid out below. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/qHi-t4-rZ6Y%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhhQDahVIVuBvc-hxCG9w-Q5Zq0qkg" frameborder="0" allowfullscreen=""></iframe><br><br>  The implementation is simple to indecency.  Only resistors with nominal values ‚Äã‚Äãof 1-50 Mom are needed (one for each contact).  I used resumes for 1 Megohm, as a result of which only touches are trapped.  If you put 10Mom and more - it will work at a distance, without contact. <br><br>  In the sketch I used <a href="http://www.arduino.cc/playground/Main/CapSense">the CapSense library</a> , which, in fact, does all the work. <br><br>  Connection diagram: <br><br><img src="https://habrastorage.org/storage2/974/2c0/64a/9742c064aa23096f3fe5ee3adb614533.gif"><br><br>  On the basis of the sample sketched a simple sketch <br><br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#include &lt;CapSense.h&gt; <br> <br> <font color="#0000ff">#define</font> SND_PIN 12 <font color="#008000">// ,    </font> <br> <br> CapSense  key1 = CapSense(7, 5); <font color="#008000">//  1  7-  5- </font> <br> CapSense  key2 = CapSense(7, 4); <font color="#008000">//  2  7-  4- </font> <br> CapSense  key3 = CapSense(7, 3); <font color="#008000">//  3  7-  3- </font> <br> <br> <font color="#0000ff">int</font> range = 200; <font color="#008000">//  ,  ,  </font> <br> <font color="#0000ff">byte</font> button; <font color="#008000">//    </font> <br> <font color="#0000ff">int</font> freq; <font color="#008000">//      </font> <br> <br> <font color="#0000ff">void</font> setup() <br> { <br> <font color="#008000">//    1- .</font> <br> <font color="#008000">//    ,    </font> <br> key1.set_CS_AutocaL_Millis(0xFFFFFFFF); <br> } <br> <br> <font color="#0000ff">void</font> loop() <br> { <br> <font color="#0000ff">long</font> total1 = key1.capSense(30); <br> <font color="#0000ff">long</font> total2 = key2.capSense(30); <br> <font color="#0000ff">long</font> total3 = key3.capSense(30); <br> <br> button = 0; <br> <font color="#0000ff">if</font> (total1 &gt; range) button |= 1; <br> <font color="#0000ff">if</font> (total2 &gt; range) button |= 2; <br> <font color="#0000ff">if</font> (total3 &gt; range) button |= 4; <br> <br> <font color="#0000ff">switch</font> (button) { <br> <font color="#0000ff">case</font> 1: freq = 200; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 2: freq = 300; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 3: freq = 400; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 4: freq = 500; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 5: freq = 600; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 6: freq = 700; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 7: freq = 800; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">default</font> : freq = 0; <br> } <br> <br> freq? tone(SND_PIN, freq) : noTone(SND_PIN); <font color="#008000">//    </font> <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#include &lt;CapSense.h&gt; <br> <br> <font color="#0000ff">#define</font> SND_PIN 12 <font color="#008000">// ,    </font> <br> <br> CapSense  key1 = CapSense(7, 5); <font color="#008000">//  1  7-  5- </font> <br> CapSense  key2 = CapSense(7, 4); <font color="#008000">//  2  7-  4- </font> <br> CapSense  key3 = CapSense(7, 3); <font color="#008000">//  3  7-  3- </font> <br> <br> <font color="#0000ff">int</font> range = 200; <font color="#008000">//  ,  ,  </font> <br> <font color="#0000ff">byte</font> button; <font color="#008000">//    </font> <br> <font color="#0000ff">int</font> freq; <font color="#008000">//      </font> <br> <br> <font color="#0000ff">void</font> setup() <br> { <br> <font color="#008000">//    1- .</font> <br> <font color="#008000">//    ,    </font> <br> key1.set_CS_AutocaL_Millis(0xFFFFFFFF); <br> } <br> <br> <font color="#0000ff">void</font> loop() <br> { <br> <font color="#0000ff">long</font> total1 = key1.capSense(30); <br> <font color="#0000ff">long</font> total2 = key2.capSense(30); <br> <font color="#0000ff">long</font> total3 = key3.capSense(30); <br> <br> button = 0; <br> <font color="#0000ff">if</font> (total1 &gt; range) button |= 1; <br> <font color="#0000ff">if</font> (total2 &gt; range) button |= 2; <br> <font color="#0000ff">if</font> (total3 &gt; range) button |= 4; <br> <br> <font color="#0000ff">switch</font> (button) { <br> <font color="#0000ff">case</font> 1: freq = 200; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 2: freq = 300; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 3: freq = 400; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 4: freq = 500; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 5: freq = 600; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 6: freq = 700; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> 7: freq = 800; <font color="#0000ff">break</font> ; <br> <font color="#0000ff">default</font> : freq = 0; <br> } <br> <br> freq? tone(SND_PIN, freq) : noTone(SND_PIN); <font color="#008000">//    </font> <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> </blockquote> <br><br>  If you flash <a href="http://arduino.cc/forum/index.php%3Ftopic%3D99.0">something like this</a> , the arduin with the grape keys will be in the role of the HID-keyboard (I have not tried it yet).  But for this, not every Arduinka is suitable, you need it with an atmega8u2 chip as a USB controller (the new Arduino UNO is right with it).  It‚Äôs a pity there is nothing suitable at hand, but I wanted to play Bamberman online from the grape keyboard :-) You can, of course, jot down a soft that will read signals from the keypad through the COM port and translate them into keyboard events, but this is no longer then (through the HID is still more interesting). <br><br>  UPD&gt; Got a working device, stopped itching, relaxed.  I read about Maki Maki in more detail - it turns out that it was done just there on the Arduin :-) <br><br>  UPD&gt; Just squeaking the speaker is not interesting, it would be necessary for the daughter to have fun :-) Maybe the next topic will be about this, if something interesting happens. <br><br>  UPD&gt; Found an interesting project - <a href="http://www.practicalarduino.com/projects/virtual-usb-keyboard">Virtual USB keyboard</a> , without using atmega8u2.  I'll have to try to pick it up. <br><br>  UPD&gt; Question to habrovchan - can someone tell the softphone (preferably under Windows or cross-platform) that would read the COM port, receive messages in some format and generate keystroke events?  And then I myself do not quickly cry it. <br><br>  UPD&gt; Urgently ordered Arduin Uno so that the HID-device turned out "out of the box."  I hope the delivery will not fail and will be delivered today.  Until I play Bamberman, I will not calm down (and since yesterday I haven‚Äôt even gone to bed). <br><br>  UPD&gt; Now 8 grapes are connected, at the same time all eight are processed, but with dips.  5 simultaneous touches work stably.  HID is canceled today for delivery only tomorrow will be :-( <br><br>  UPD&gt; So ... With the help of the tips of the sidekick, I managed to jot down a simple C # softphone.  Reads the Arduin COM port, accepts clicks on grapes, emulates keyboard presses.  Right now I'll try to pick up all eight grapes and then take a new video.  First wrote something in C # :-) <br><br>  UPD&gt; Source Code (VS2010, C #).  I do not rummage in C #, so how it happened - it happened :-) Thank Leonardo so much for the hints, otherwise it wouldn't work.  And thanks to the GreenGo <a href="https://geektimes.ru/users/greengo/" class="user_link">Habrayuser</a> for the tip-off on the <a href="http://inputsimulator.codeplex.com/">InputSimulator</a> library. <br><br>  The software listens to the specified COM port (there are no settings, the name of the port is strictly written in the source code (COM11). This is the port on which Arduin is available. Only 6 keys are involved. <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">using</span></span> <span class="hljs-type"><span class="hljs-type">System</span></span>; using <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Collections</span></span>.<span class="hljs-type"><span class="hljs-type">Generic</span></span>; using <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">ComponentModel</span></span>; using <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Data</span></span>; using <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Drawing</span></span>; using <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Linq</span></span>; using <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Text</span></span>; using <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Windows</span></span>.<span class="hljs-type"><span class="hljs-type">Forms</span></span>; using <span class="hljs-type"><span class="hljs-type">WindowsInput</span></span>; using <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">IO</span></span>; using <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">IO</span></span>.<span class="hljs-type"><span class="hljs-type">Ports</span></span>; namespace <span class="hljs-type"><span class="hljs-type">WindowsFormsApplication1</span></span> { public partial <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-type"><span class="hljs-type">Form1</span></span> : <span class="hljs-type"><span class="hljs-type">Form</span></span> { <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">IO</span></span>.<span class="hljs-type"><span class="hljs-type">Ports</span></span>.<span class="hljs-type"><span class="hljs-type">SerialPort</span></span> newPort; public <span class="hljs-type"><span class="hljs-type">Form1</span></span>() { <span class="hljs-type"><span class="hljs-type">InitializeComponent</span></span>(); } private void <span class="hljs-type"><span class="hljs-type">Form1_Load</span></span>(object sender, <span class="hljs-type"><span class="hljs-type">EventArgs</span></span> e) { } private void button2_Click(object sender, <span class="hljs-type"><span class="hljs-type">EventArgs</span></span> e) { newPort = new <span class="hljs-type"><span class="hljs-type">SerialPort</span></span>(<span class="hljs-string"><span class="hljs-string">"COM11"</span></span>, <span class="hljs-number"><span class="hljs-number">57600</span></span>, <span class="hljs-type"><span class="hljs-type">Parity</span></span>.<span class="hljs-type"><span class="hljs-type">None</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-type"><span class="hljs-type">StopBits</span></span>.<span class="hljs-type"><span class="hljs-type">One</span></span>); newPort.<span class="hljs-type"><span class="hljs-type">Open</span></span>(); newPort.<span class="hljs-type"><span class="hljs-type">DataReceived</span></span> += new <span class="hljs-type"><span class="hljs-type">SerialDataReceivedEventHandler</span></span>(<span class="hljs-type"><span class="hljs-type">GetArduinoBytes</span></span>); } public void <span class="hljs-type"><span class="hljs-type">GetArduinoBytes</span></span>(object sender, <span class="hljs-type"><span class="hljs-type">SerialDataReceivedEventArgs</span></span> e) { string <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> = newPort.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ReadExisting</span></span></span><span class="hljs-class">(); string [] arr; int key = 0; arr = </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Split</span></span></span><span class="hljs-class">('\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">r'</span></span></span><span class="hljs-class">); try { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ToInt32</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arr</span></span></span><span class="hljs-class">[0]); } catch (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">System</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FormatException</span></span></span><span class="hljs-class">) { //    } int key1 = key &amp; 1; int key2 = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> &gt;&gt; 1) &amp; 1; int key3 = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> &gt;&gt; 2) &amp; 1; int key4 = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> &gt;&gt; 3) &amp; 1; int key5 = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> &gt;&gt; 4) &amp; 1; int key6 = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> &gt;&gt; 5) &amp; 1; int key7 = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> &gt;&gt; 6) &amp; 1; int key8 = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> &gt;&gt; 7) &amp; 1; if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key1</span></span></span><span class="hljs-class"> == 1) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyDown</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DOWN</span></span></span><span class="hljs-class">); else </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyUp</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DOWN</span></span></span><span class="hljs-class">); if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key2</span></span></span><span class="hljs-class"> == 1) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyDown</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UP</span></span></span><span class="hljs-class">); else </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyUp</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UP</span></span></span><span class="hljs-class">); if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key3</span></span></span><span class="hljs-class"> == 1) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyDown</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LEFT</span></span></span><span class="hljs-class">); else </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyUp</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LEFT</span></span></span><span class="hljs-class">); if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key4</span></span></span><span class="hljs-class"> == 1) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyDown</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RIGHT</span></span></span><span class="hljs-class">); else </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyUp</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RIGHT</span></span></span><span class="hljs-class">); if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key5</span></span></span><span class="hljs-class"> == 1) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyDown</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SPACE</span></span></span><span class="hljs-class">); else </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyUp</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SPACE</span></span></span><span class="hljs-class">); if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key6</span></span></span><span class="hljs-class"> == 1) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyDown</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VK_Z</span></span></span><span class="hljs-class">); else </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WindowsInput</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InputSimulator</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SimulateKeyUp</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VirtualKeyCode</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VK_Z</span></span></span><span class="hljs-class">); } } }</span></span></code> </pre><br><br>  UPD&gt; And here's a new sketch for Arduin.  Playback of the speaker squeak commented out, just pass the state of the keys to the console. <br><br><pre> <code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#include &lt;CapSense.h&gt; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SND_PIN 12 // ,     CapSense key1 = CapSense(5, 2); //  1  5-  5-  CapSense key2 = CapSense(5, 3); //  2  5-  4-  CapSense key3 = CapSense(5, 4); //  3  5-  3-  CapSense key4 = CapSense(5, 6); //  4  5-  3-  CapSense key5 = CapSense(5, 7); //  5  5-  3-  CapSense key6 = CapSense(5, 8); //  6  5-  3-  CapSense key7 = CapSense(5, 9); //  7  5-  3-  CapSense key8 = CapSense(5, 11); //  8  5-  3-  int range = 100; //  ,   unsigned int button = 0, oldButton = 0; //     int freq; //       byte sense = 30; long total1, total2, total3, total4, total5, total6, total7, total8; void setup() { //key1.set_CS_AutocaL_Millis(0xFFFFFFFF); Serial.begin(57600); //   } void loop() { total1 = key1.capSense(sense); total2 = key2.capSense(sense); total3 = key3.capSense(sense); total4 = key4.capSense(sense); total5 = key5.capSense(sense); total6 = key6.capSense(sense); total7 = key7.capSense(sense); total8 = key8.capSense(sense); button = 0; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (total1 &gt; range) button |= 1; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (total2 &gt; range) button |= 2; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (total3 &gt; range) button |= 4; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (total4 &gt; range) button |= 8; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (total5 &gt; range) button |= 16; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (total6 &gt; range) button |= 32; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (total7 &gt; range) button |= 64; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (total8 &gt; range) button |= 128; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (button != oldButton) { Serial.println(button); oldButton = button; } /* </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (button) freq = button * 10 + 200; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> freq = 0; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (freq) { Serial.println(freq); tone(SND_PIN, freq); } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> noTone(SND_PIN); //     */ }</span></span></code> </pre><br><br>  UPD&gt; About MakiMaki on TV showed.  I was called to participate in the program with this my ‚Äúgrape multitouch‚Äù, but had to be abandoned for political reasons :-) <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/KA0Oo4vhS1c%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhgCQmZA9sk4QK2-NyC5LNgZDSoEDw" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/143928/">https://habr.com/ru/post/143928/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143921/index.html">Yandex Mail. Preventing hakostrofy</a></li>
<li><a href="../143923/index.html">Landing page that works</a></li>
<li><a href="../143925/index.html">Why do we need delegates in C #?</a></li>
<li><a href="../143926/index.html">M13 synthetic virus converts kinetic energy into electricity</a></li>
<li><a href="../143927/index.html">How to open your online store Ecwid on Facebook and Google Sites</a></li>
<li><a href="../143931/index.html">A variety of Android devices</a></li>
<li><a href="../143932/index.html">The history of a single reengineering or RNAInSpace v.1.3. Demo</a></li>
<li><a href="../143934/index.html">Integrating TortoiseSVN into Total Commander</a></li>
<li><a href="../143935/index.html">How to backup data and MySQL in Amazon Web Services</a></li>
<li><a href="../143936/index.html">The problem of cyclic dependencies during type initialization</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>