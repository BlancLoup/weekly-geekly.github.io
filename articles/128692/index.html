<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dropbox + AutoIt + utorrent</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. I read about different bundles of Dropbox and utorrent, but not one did not suit me. Based on the experience of downloads earlier, there was...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dropbox + AutoIt + utorrent</h1><div class="post__text post__text-html js-mediator-article"><img src="http://hostingkartinok.com/image/01201109/78c1b46a6fe5e4b4bd8b90ed04ed9a0b.png" align="left">  Good day.  I read about different bundles of Dropbox and utorrent, but not one did not suit me.  Based on the experience of downloads earlier, there was only one thing to do if you did not immediately specify the place where to save the desired file name, then it will remain in the ‚ÄúNot parsed‚Äù folder with the name Avatar.2009.Extended.Collectors.Cut (1080p) .mkv ".  Even if you later analyze the downloaded files, it will be necessary to restart the torrent files and specify the new path to the file to distribute them.  And if you consider that at home, in addition to me, parents and niece are watching films, then this name could not be left. <br><br><h4>  So the necessary requirements for the program: </h4><br>  1. adding torrents remotely without connecting to a home computer (DC); <br>  2. the ability to specify the path to the file on the DC; <br>  3. the ability to specify the name of the file being downloaded; <br>  4. remotely track which files were set to download, which completed the download. <br><a name="habracut"></a><br><h4>  How to solve the problem </h4><br><h5>  First point </h5><br>  Appeal to the help utorrent.exe is obtained to add a torrent, you must run the following command: <br><br> <code>C:\Program Files\uTorrent&gt;uTorrent.exe /DIRECTORY "  " "   "</code> <br> <br>  From the same help and search in Google, as well as the utorrent forum, it turned out that the name of the file to be downloaded cannot be specified on the uTorrent command line.  At the beginning, he executed the command, but with the further implementation of the program I had to remove the <code>/DIRECTORY "  "</code> from the line, I will tell about it below. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Second point </h5><br>  It is necessary that the Dropbox folder has the same folder structure as on the home computer where the downloaded file is saved.  Next, saving the torrent file to the desired directory of the Dropbox folder, we can add the torrent to the DC in the directory that we need.  To do this, it was necessary to provide automatic synchronization of the folder structure with the DC and the folder in the DropBox.  How exactly the search for torrent files and synchronization of the folder structure is implemented will not be disassembled, since  there is nothing special there. <br><br>  After synchronization, the Dropbox folder looked like this: <br><br><img src="http://hostingkartinok.com/image/01201109/5ca6e55a7c7d48b17e04e7c15890c0c2.jpg" alt="image"><br><br><h5>  Third point </h5><br>  There is a problem with the file name.  The name of the torrent file and the names of the files that are downloaded through this torrent are two different things.  At the uTorrent command line when adding, it was also impossible to specify with what name to save the file.  Again began to look for information.  It turned out that you cannot change the torrent file, because  then he becomes an ‚Äúinvalid‚Äù and cannot be added to the download.  And here AutoIT comes to the rescue with its ability to access the form element of another program.  Before this, from the command line uTorrent remove / DIRECTORY "Directory where to save", so that a window appears on the addition of the torrent.  Then I had to find out the name of the form element, where the path to save the file is indicated.  Included with AutoIT is a program called AutoIT Window Info, through which you can find out how the form elements are called: <br><br><img src="http://hostingkartinok.com/image/01201109/5e278b84c56cdd46b04e675fb84e7e2d.jpg" alt="image"><br><br>  The field we need is called ‚ÄúComboBox1‚Äù, in order to access it, it was required to know the name of the window (Title) in which the element is located.  In our case, the name of the window is as follows: <br><br>  ¬´Avatar.2009.Extended.Collectors.Cut (1080p) .mkv - Add a new torrent¬ª <br><br>  Since the name of the torrent file and the name with which it is added by default in the torrent client are two different things.  And I just needed the name with which it is added by default.  It was necessary to pull it out of the torrent file.  From the information received, it followed that the torrent file was encoded in Bencode format, I did not find the library written for AutoIT, so I subsequently took it apart by simple reading.  I needed the value of the name field.  In our example, a piece of the file with the value I need looked like this: <br><br>  "Name46: Avatar.2009.Extended.Collectors.Cut (1080p) .mkv12: piece" <br><br>  What is 12: piece and why it was found in all the files that I viewed on my home computer, I did not understand.  But since it is equally calmly called ‚ÄúAvatar.2009.Extended.Collectors.Cut (1080p) .mkv‚Äù.  Now we can get the name of the window in which the ‚ÄúComboBox1‚Äù element is located.  The file name is taken from the name of the torrent, i.e.  when saving the torrent file indicated the name "Avatar.torrent".  Specifying a field value for a form in AutoIT is done as follows: <br><br> <code>ControlSetText($Title, "", "ComboBox1", $NameTorrent)</code> <br> <br>  We also send the command Left click of the mouse on the Ok button. <br><br> <code>ControlClick ($Title, "", "Button7")</code> <br> <br>  Voila torrent was added with the name I need in the directory I need on my home computer. <br>  It is also better in uTorrent Settings -&gt; Interface to uncheck the ‚ÄúActivate program window‚Äù box so that the addition of the torrent does not happen noticeably to the person who worked on the DC. <br><br><h5>  Fourth point </h5><br>  Everything is simple with him.  We write to the log which is in the Dropbox folder about adding a torrent.  In order to write about the completion of downloading a torrent, you must do the following.  Go to utorrent settings ‚Üí Advanced ‚Üí Run this program after the end of the torrent indicated its program with the parameters TorrentBot.exe% F -onlylog. <br><br><h5>  System in operation </h5><br>  A program is running on the home computer (TorrentBot.exe).  And let's say at work, I save the torrent to the Dropbox \ DWND \ 1_Films \ Cowboys vs. Aliens.torrent folder, the file is copied to the home computer with Dropbox, then the torrent is added to the download, and removed from the Dropbox. <br><br><h5>  Sources </h5><br>  The source code of the program is attached, I ask the code is not strictly judge. <br>  For those who want to run the program.  When you first run the exe file, config.ini is created in the same folder as the program.  It is necessary to indicate the following: <br> <code>[options] <br> PathDWND=G:\DWND\ <br> PathDropBox=G:\Dropbox\DWND\ <br> TimeUpdate=30</code> <br>  Where PathDWND is the path on your home computer where you need to save all downloads; <br>  PathDropBox - the path in the Dropbox folder in which the folder structure from the PathDWND path will be located; <br>  TimeUpdate - the time to check the appearance of new torrent files in the PathDropBox folder (in seconds) <br>  <u><b>Mandatory requirement</b></u> do not confuse PathDWND and PathDropBox in places; otherwise, the PathDWND folder will contain only the structure from the PathDropBox, and <b><u>all files that were previously in PathDWND will disappear</u></b> . <br>  Oh yeah, use at your own risk. <br><br>  Thanks for attention. <br><br>  Used literature: help utorrent, help AutoIt, Google search. <br><br>  <a href="http://narod.ru/disk/49136781001.d2fd5b0de4485a32eb7e6d44f1de7cb0/TorrentBot_140512.au3.html">TorrentBot.au3</a> . </div><p>Source: <a href="https://habr.com/ru/post/128692/">https://habr.com/ru/post/128692/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128686/index.html">Samsung has filed a lawsuit against Apple and in Australia</a></li>
<li><a href="../128687/index.html">Google estimates that the number of internet users in India will triple by 2014</a></li>
<li><a href="../128689/index.html">The Day of Knowledge! We have prepared for you a complete collection of video lessons on the school program of the first quarter of grades 5-11!</a></li>
<li><a href="../128690/index.html">Pre-release version of WebMatrix 2 released</a></li>
<li><a href="../128691/index.html">ScrollDay - do not miss interesting events</a></li>
<li><a href="../128693/index.html">Digest Wanted.VC # 15</a></li>
<li><a href="../128694/index.html">Automation of production. Getting ready to write ASUP</a></li>
<li><a href="../128695/index.html">instudies.com: first blood</a></li>
<li><a href="../128696/index.html">Problems of creating an educational social network</a></li>
<li><a href="../128697/index.html">Pirate party won 9% of the vote in the elections in Berlin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>