<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Check Point Security Check List</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Relatively recently, we published an open access mini-course " Check Point for Maximum ". There we tried briefly and with examples to consider the mos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Check Point Security Check List</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/3e/_q/ij/3e_qijgibwsn-pljvwl9t2xemfk.png"><br><br>  Relatively recently, we published an open access mini-course " <a href="https://www.youtube.com/playlist%3Flist%3DPLqio-3dnMW5-q1IHBK3RClRp3n2SE-L1x">Check Point for Maximum</a> ".  There we tried briefly and with examples to consider the most frequent errors in the Check Point configuration from the point of view of information security.  In fact, we told you what the default settings are bad for and how to tighten the screws.  The course (unexpectedly for us) received pretty good reviews.  After that, we received several requests for a brief ‚Äúsqueeze‚Äù of this material - a <b>checklist for security settings</b> .  We decided that this is a good idea, and therefore we publish this article. <br><br>  Before starting, I would like to focus on two things: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  This checklist is not a self-contained document or manual.  This is just the necessary minimum of checks that are desirable to do.  Additional (extended) recommendations can be obtained only after a detailed examination of the infrastructure. </li><li>  The checklist will be relevant not only for <b>Check Point</b> owners.  Other vendors have similar problems with default settings: <b>Fortigate</b> , <b>PaloAlto</b> , <b>Cisco FirePower</b> , <b>Kerio</b> , <b>Sophos</b> , etc. </li></ol><br>  And now the checklist itself with a few comments on each item: <a name="habracut"></a><br><br><h3>  1) HTTPS Inspection Enabled </h3><br>  I talked about the importance of HTTPS inspections in the <a href="https://www.youtube.com/watch%3Fv%3Dkuvjsirrkd0%26t%3D0s%26list%3DPLqio-3dnMW5-q1IHBK3RClRp3n2SE-L1x%26index%3D3">second lesson</a> ‚ÄúCheck Point for Maximum‚Äù.  Without this option, your expensive NGFW turns into a big hole in the perimeter of the network. <br><br><h3>  2) Unwanted resources and applications are blocked (App &amp; URL filtering) </h3><br>  In Check Point, two blades are responsible for this - Application Control and URL Filtering.  Practically the same is with other vendors with a few differences.  The main task of these functions is to reduce the attack area by blocking access to potentially dangerous resources or applications.  For some reason, despite the presence of pre-configured categories (Anonymizer, Botnets, Critical Risk, Hacking, High Risk, Phishing, Remote Administration, Sospicious Content, Spyware / Malicious Sites, Stealth Tactics, etc.), people do not use these limitations. .  It is better to block such things at the network level and not to bring to the traffic check more difficult means of protection (IPS, Antivirus, Anti-Bot, Threat Emulation).  This will avoid false positives and save your gateway performance.  Examine what categories of sites and applications allows you to block your gateway, then review your access policy again.  A good help here is SmartEvent, which can generate a report on user traffic. <br><br><h3>  3) Blocking downloading unwanted files (Content Awareness) </h3><br>  I talked about this in the <a href="https://www.youtube.com/watch%3Fv%3DRV59_o2CToU%26t%3D0s%26list%3DPLqio-3dnMW5-q1IHBK3RClRp3n2SE-L1x%26index%3D4">third lesson</a> .  In Check Point, Content Awareness is responsible for this feature.  Other vendors may be able to do this either with Anti-Virus or with the DLP module.  The meaning of this action is to deliberately block unwanted file types.  Do your users need to download .exe files?  And the scripts?  Why check these files and hope for the reliability of your gateway, if you can block them as unwanted content?  Lower load on NGFW and higher level of security.  Sometimes the user may not even know that he has started downloading something (background download).  Review your policy, block at least executable files. <br><br><h3>  4) Antivirus performs full file scan (Antivirus - Deep scan) </h3><br>  Absolutely all vendors sin with this.  In the default settings, the streaming antivirus checks either the file hash or the first few bytes.  For adequate protection this is not enough.  Modifying the virus is easy.  To catch them, you need a deep check.  In Check Point, the <b>deep inspection</b> option is responsible for this.  But be careful.  It is not necessary to include this feature absolutely for all files.  If you have a ‚Äúweak‚Äù gateway, then the load may increase too much.  Use deep inspection for the most dangerous (and frequently downloaded) files: pdf, docx, xlsx, rtf, zip, rar, exe (if allowed to download them), etc.  See the <a href="https://www.youtube.com/watch%3Fv%3D-i3uWfkh6WM%26t%3D0s%26list%3DPLqio-3dnMW5-q1IHBK3RClRp3n2SE-L1x%26index%3D5">fourth lesson for</a> more details. <br><br><h3>  5) Archives are scanned, password-protected are blocked (Antivirus - archive scan) </h3><br>  Surprisingly, many people forget about this option.  I think everyone obviously need to check the archives.  And it should be obvious to everyone that archives with a password should be blocked.  I see no reason to paint something more here.  Just check that you have it configured. <br><br><h3>  6) Additional scanning mechanisms are enabled (Antivirus - Protections) </h3><br>  In the default Threat Prevention (Optimized) profile, additional check mechanisms are disabled, such as: <b>Malicious Activity - Signatures</b> , <b>Unusual Activity - Behavioral Patterns</b> .  Do not neglect these settings.  How to include them, I showed in the <a href="https://www.youtube.com/watch%3Fv%3D-i3uWfkh6WM%26t%3D0s%26list%3DPLqio-3dnMW5-q1IHBK3RClRp3n2SE-L1x%26index%3D5">fourth lesson</a> . <br><br><h3>  7) IPS is updated at least once a week. </h3><br>  In the <a href="https://www.youtube.com/watch%3Fv%3DT05pm2J7Mbc%26t%3D2s%26list%3DPLqio-3dnMW5-q1IHBK3RClRp3n2SE-L1x%26index%3D6">fifth lesson,</a> I tried to show how important IPS is to protect the network.  And one of the key conditions for efficiency is the ‚Äúfresh‚Äù database of signatures.  Make sure your IPS is updated often enough.  My recommendation is at least once every three days.  As a rule, the default values ‚Äã‚Äãare much higher (from a week to a month) for almost all vendors. <br><br><h3>  8) IPS rendered in a separate Layer </h3><br>  Another important point.  Be sure to make the IPS in a separate Layer.  Only in this way can you get the most out of it.  I explained in some detail why and how to do this in the <a href="https://www.youtube.com/watch%3Fv%3Df505AFEFpy0%26t%3D0s%26list%3DPLqio-3dnMW5-q1IHBK3RClRp3n2SE-L1x%26index%3D7">sixth lesson of the</a> course. <br><br><h3>  9) Different Threat Prevention policies for different network segments. </h3><br>  Threat Prevention policies include blades such as: Antivirus, Anti-Bot, IPS, Threat Emulation, Threat Extraction.  As we already defined above, IPS should be rendered in a separate Layer.  There you should have at least two policies - one for the client device, the other for the server.  At the same time, ideally, politics should break up even more, because  in each segment there can be different types of devices and different types of services.  The key task is to include only the necessary protection mechanisms.  It makes no sense to check the windows-signatures traffic that is intended for Linux host.  The same applies to other blades.  Threat Prevention's segmented policy is the key to adequate protection. <br><br><h3>  10) Use Hold mode </h3><br>  The default for Threat Prevention is <b>background</b> mode.  This means that if the file is new and there is no required signature, then it can pass as long as there is an ‚Äúin-depth‚Äù check in the background.  This is not exactly what is usually required of remedies.  Therefore, make sure that the <b>Hold</b> mode is enabled in the Threat Prevention properties (in global and profile settings). <br><br><h3>  11) Geo Policy Formed </h3><br>  This function is also undeservedly forgotten.  This option will allow blocking any traffic (both incoming and outgoing) of any country for your network.  Do your users need to visit the resources of Bangladesh or the Congo?  But the attackers love to use the servers of countries where the legislation in terms of cybercrime is rather poorly developed.  A competent Geo-policy will not only increase the level of security, but also reduce the load on the gateway, because  the latter will not have to check everything. <br><br><h3>  12) Threat Emulation Enabled </h3><br>  It does not do one point.  For good, you need to make a separate checklist for Threat Emulation settings.  With your permission, I will not do this :) I will dwell on one main recommendation - the blade should be turned on.  For some reason, many more administrators consider this feature unnecessary exotic.  Turn on at least Detect mode and see the report after a week.  You will be surprised.  If the current subscription level does not allow using this blade, then you can <a href="">request a demo license</a> for 30 days. <br><br><h3>  13) False Positive Missing </h3><br>  Last but not least.  I have repeated many times (and I‚Äôm not tired of repeating) that security is a continuous process, not a result.  Therefore, even if you are well tuned, you should at least check the effectiveness and results.  Does the protection work and there are no errors?  The simplest example to do this is to periodically check security logs.  Check logs for Threat Prevention Blades.  Whether there are no detect on events with Severity level High or Critical and Confidence Level with value High.  Filter example by logs: <br><blockquote>  product_family: (Threat OR Endpoint OR Mobile) AND action: Detect AND severity: (Critical OR High) AND confidence_level: (Medium-High OR High) </blockquote>  If you saw logs that fall under this filter, it means that you missed what you should have blocked into the network.  Either you have configured something wrong, or your remedy does not work as it should.  Periodically check for such events, or set up notifications (SmartEvent functionality). <br><br><h3>  Best Practice </h3><br>  Most of the points can be found in the official Check Point documentation.  We have already published a whole collection in the article " <a href="https://habr.com/company/tssolution/blog/344370/">Check Point Instructions and Useful Documentation</a> ".  In our case, the main source of information will be a selection of articles - <a href="https://supportcenter.checkpoint.com/supportcenter/portal%3FeventSubmit_doGoviewsolutiondetails%3D%26solutionid%3Dsk111303%26partition%3DGeneral%26product%3DAll%2522">Best Practice</a> and <a href="https://supportcenter.checkpoint.com/supportcenter/portal%3FeventSubmit_doShowtechnicalreferenceguides">ATRG</a> .  If you are a happy owner of Check Point products, then these topics are required to read. <br><br><h3>  Conclusion </h3><br>  This concludes our ‚Äúdamn dozen‚Äù checks.  If you put in order the settings of your gateway in accordance with this list, then your level of security will be higher than that of 80% of companies (statistics from personal experience).  I repeat that these are only basic checks.  For advanced and more specific recommendations, a comprehensive analysis of the current settings and network architecture is needed.  <a href="https://www.tssolution.ru/reshenie/check-point-security-audit">Here</a> you can find a sample report ( <a href="https://www.tssolution.ru/reshenie/check-point-security-audit">Check Point Security Audit</a> ) on the results of such an audit of settings.  If you wish, you can get a report with specific recommendations and instructions for corrections. <br><br>  Additional training materials can be found in our <a href="https://vk.com/ts_solution">group</a> or <a href="https://t.me/tssolution">telegram channel</a> . </div><p>Source: <a href="https://habr.com/ru/post/432676/">https://habr.com/ru/post/432676/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../432666/index.html">Video of Product Management Meetup</a></li>
<li><a href="../432668/index.html">Simple network port management</a></li>
<li><a href="../432670/index.html">Roadmap of mathematical disciplines for machine learning, part 1</a></li>
<li><a href="../432672/index.html">What kind of developers are we looking for to develop the 1C: Enterprise platform?</a></li>
<li><a href="../432674/index.html">First experience with Yandex Dialogues. We are waiting for innovations</a></li>
<li><a href="../432678/index.html">Winter frontend meetup at OZON</a></li>
<li><a href="../432680/index.html">Any Internet company is obliged to secretly change the program code at the request of the authorities</a></li>
<li><a href="../432682/index.html">Secrets of building and sending SSH to Docker 18.09</a></li>
<li><a href="../432686/index.html">WireGuard - the perfect VPN of the future?</a></li>
<li><a href="../432688/index.html">Digital events in Moscow from December 10 to 16</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>