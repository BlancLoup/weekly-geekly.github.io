<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The task of the missionaries and cannibals in the language Haskell</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Studying the Haskell language, I once again faced the problem of finding some task for practicing new skills. After some hesitation, it was decided to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The task of the missionaries and cannibals in the language Haskell</h1><div class="post__text post__text-html js-mediator-article">  Studying the Haskell language, I once again faced the problem of finding some task for practicing new skills.  After some hesitation, it was decided to implement a wide search algorithm written long time ago in python for the problem of crossing missionaries and cannibals.  The decision seemed to me rather concise, therefore I decided to share it with people (and at the same time listen to criticism). <br><img src="https://habrastorage.org/getpro/habr/post_images/aa2/e81/858/aa2e818584f594152249db6478209631.jpg" alt="image"><br>  Interested please follow under cat. <br><a name="habracut"></a><br><h4>  Task statement </h4><br>  Three missionaries and three cannibals must be shipped from one bank of the river to the other.  In the boat on which they will move, only two people can simultaneously fit, and if during the movement the number of cannibals on the same bank exceeds the number of missionaries, the missionaries will be eaten (which, of course, must be avoided).  It is necessary to find a sequence of safe (not leading missionaries to the sad fate of James Cook) transportation. <br><br><h4>  Decision </h4><br>  The theater begins with a hanger, and the Haskell program begins with the import of modules necessary for the work.  Let's start with them. <br><br><pre><code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Data.List</code> </pre> <br>  To store information about the location of the missionaries, cannibals and the shore where the boat is located, we will define our data type. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">State</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">State</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">missioners</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Int</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cannibals</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Int</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bank</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Char</span></span></span><span class="hljs-class">} </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Eq</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class">)</span></span></code> </pre><br>  The attentive reader may ask: ‚ÄúBut why in the State there are only two integer fields?  Missionaries may be on the left bank or on the right;  The same applies to cannibals.  It turns out four numeric fields. ‚Äù <br>  True remark, but for certain reasons, information about the number of people on the coast without a boat is redundant (for what - it will be said a little lower). <br><br>  In order for our boat to sail from one bank to another, it is necessary to specify all possible movements.  There are only five of them: <br><br><pre> <code class="hljs lisp">move01 (<span class="hljs-name"><span class="hljs-name">State</span></span> msn cnb bk) = State (<span class="hljs-number"><span class="hljs-number">3</span></span> - msn + <span class="hljs-number"><span class="hljs-number">2</span></span>) (<span class="hljs-number"><span class="hljs-number">3</span></span> - cnb) (<span class="hljs-name"><span class="hljs-name">oppositeBank</span></span> bk) move02 (<span class="hljs-name"><span class="hljs-name">State</span></span> msn cnb bk) = State (<span class="hljs-number"><span class="hljs-number">3</span></span> - msn) (<span class="hljs-number"><span class="hljs-number">3</span></span> - cnb + <span class="hljs-number"><span class="hljs-number">2</span></span>) (<span class="hljs-name"><span class="hljs-name">oppositeBank</span></span> bk) move03 (<span class="hljs-name"><span class="hljs-name">State</span></span> msn cnb bk) = State (<span class="hljs-number"><span class="hljs-number">3</span></span> - msn + <span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-number"><span class="hljs-number">3</span></span> - cnb + <span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">oppositeBank</span></span> bk) move04 (<span class="hljs-name"><span class="hljs-name">State</span></span> msn cnb bk) = State (<span class="hljs-number"><span class="hljs-number">3</span></span> - msn + <span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-number"><span class="hljs-number">3</span></span> - cnb) (<span class="hljs-name"><span class="hljs-name">oppositeBank</span></span> bk) move05 (<span class="hljs-name"><span class="hljs-name">State</span></span> msn cnb bk) = State (<span class="hljs-number"><span class="hljs-number">3</span></span> - msn) (<span class="hljs-number"><span class="hljs-number">3</span></span> - cnb + <span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">oppositeBank</span></span> bk)</code> </pre><br>  Do you notice?  We do not need to keep information about how many missionaries we have on the opposite bank - we can always get their number by subtracting the number of missionaries on the current bank from three.  The same applies to cannibals. <br><br>  oppositeBank is the simplest function that changes the label of the coast to the opposite. <br><br><pre> <code class="hljs pgsql">oppositeBank :: <span class="hljs-type"><span class="hljs-type">Char</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Char</span></span> oppositeBank bank | bank == <span class="hljs-string"><span class="hljs-string">'L'</span></span> = <span class="hljs-string"><span class="hljs-string">'R'</span></span> | otherwise = <span class="hljs-string"><span class="hljs-string">'L'</span></span></code> </pre><br>  Having created a new state, we have to check whether it is possible (in other words, have we come up with a situation where four missionaries turned out to be on the bank with the boat, or, even more fun, <s>one and a half woodcutter</s> minus one cannibal). <br><br><pre> <code class="hljs pgsql">isStatePossible :: State -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> isStatePossible (State msn cnb bk) = msn &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; msn &lt;= <span class="hljs-number"><span class="hljs-number">3</span></span> &amp;&amp; cnb &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; cnb &lt;= <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre><br>  You must also check whether the state is safe.  There are three possible options.  The first is the number of cannibals equal to the number of missionaries.  The second is that there are three missionaries on the current bank (in this case there are no missionaries on the opposite bank and the situation is safe).  The third is the opposite of the second - all the missionaries gathered on the opposite bank. <br>  So we write. <br><br><pre> <code class="hljs ruby">isStateSafe <span class="hljs-symbol"><span class="hljs-symbol">:</span></span>: State -&gt; Bool isStateSafe (State msn cnb bk) = (cnb == msn) <span class="hljs-params"><span class="hljs-params">||</span></span> (msn == <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-params"><span class="hljs-params">||</span></span> (msn == <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre><br><br>  Now we go to the most important thing - the search in width.  About what it is, you can find out by clicking on the <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25B8%25D1%2581%25D0%25BA_%25D0%25B2_%25D1%2588%25D0%25B8%25D1%2580%25D0%25B8%25D0%25BD%25D1%2583">link</a> , but I will focus on the description of the implementation. <br><br><pre> <code class="hljs lua">bfsSolution :: <span class="hljs-string"><span class="hljs-string">[[State]]</span></span> -&gt; [State] bfsSolution (<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>:tail<span class="hljs-string"><span class="hljs-string">') | State 3 3 '</span></span>R<span class="hljs-string"><span class="hljs-string">' `elem` extensions = State 3 3 '</span></span>R<span class="hljs-string"><span class="hljs-string">' : path | otherwise = bfsSolution $ tail'</span></span> ++ [ext : <span class="hljs-built_in"><span class="hljs-built_in">path</span></span> | ext &lt;- extensions, (<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> . elem ext) <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>] where headState = head <span class="hljs-built_in"><span class="hljs-built_in">path</span></span> extensions = filter (\x -&gt; isStatePossible x &amp;&amp; isStateSafe x) [move01 headState, move02 headState, move03 headState, move04 headState, move05 headState]</code> </pre><br>  bfsSolution is a recursive procedure.  First of all, we take the path in the head from the list of paths already built.  We are trying to continue it by building all possible (and safe) continuations.  If one of the constructed continuations is the final state, the procedure ends its work and returns to the continued path.  Otherwise, we add all the generated paths to the tail of the list and call the procedure again. <br>  Very important is the condition <br><br><pre> <code class="hljs pgsql">(<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> . elem ext) <span class="hljs-type"><span class="hljs-type">path</span></span></code> </pre> <br>  It does not allow returning to one of the states passed by the algorithm in the process of building this path.  For example, if at step n we sent two missionaries from the left bank to the right bank, then at step (n + 1) there is no point in returning them back to the left bank - we will waste time and do not move the solution a single step (the above program finds on my netbook, the solution is 0.85 seconds; by removing the above condition, I get a hefty increase in computations ‚Äî it takes 45 seconds to find the answer). <br><br>  The final touch is the main function. <br><pre> <code class="hljs lua">main = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> mapM_ (putStrLn . show) $ (<span class="hljs-built_in"><span class="hljs-built_in">reverse</span></span> . bfsSolution) (<span class="hljs-string"><span class="hljs-string">[[State 3 3 'L']]</span></span>)</code> </pre> <br><br><h4>  Conclusion </h4><br>  This article in no way claims to complete the review and an exhaustive explanation of all possible solutions to this problem.  Interested readers can implement a depth-first search algorithm with returns;  There is also another (not yet implemented) idea on ‚Äúbringing to mind‚Äù the above solution - try to move away from storing all the generated solutions in the list of lists and implement the n-ary tree. <br><br><h5>  Thanks for attention. </h5></div><p>Source: <a href="https://habr.com/ru/post/140163/">https://habr.com/ru/post/140163/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140156/index.html">War is war and dinner is on schedule. Samsung iPad 3 display</a></li>
<li><a href="../140158/index.html">Part number 3. Biochemistry on folding. How to reduce the number of turns the chain?</a></li>
<li><a href="../140159/index.html">Likbez on IonCube</a></li>
<li><a href="../140161/index.html">VIM syntax highlighting: full immersion</a></li>
<li><a href="../140162/index.html">Uralic fonts with extended Cyrillic for Uralic languages</a></li>
<li><a href="../140164/index.html">VIM, Django ... Django, VIM</a></li>
<li><a href="../140165/index.html">Kinect for Windows helps pick clothes</a></li>
<li><a href="../140166/index.html">PayPal has released a mobile terminal PayPal Here</a></li>
<li><a href="../140167/index.html">Crossbrowser <progress> bar</a></li>
<li><a href="../140168/index.html">Digium Switchvox Recognized as the Best Unified Communications Solution for 2011</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>