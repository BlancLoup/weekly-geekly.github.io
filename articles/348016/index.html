<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>And so it will come down ... or the Hole as a means of protection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Based on " And so it will come down ... or as the data of 14 million Russians were in my hands " ... 


 The article you are reading now is not at all...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>And so it will come down ... or the Hole as a means of protection</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/dz/9b/lk/dz9blknt7spd6rcs5hzml4onnnm.jpeg"></p><br><p>  Based on " <a href="https://habr.com/post/347760/">And so it will come down ... or as the data of 14 million Russians were in my hands</a> " ... </p><br><p>  The article you are reading now is not at all the answer to the above-mentioned post.  It will rather be an attempt to show what is already being done now, and what can be done in the field of information security in general, if we slightly deviate from the generally accepted canons when protecting systems. </p><br><p>  And in order to put all the dots on E, I‚Äôm not at all trying to assess or somehow whitewash the "responsible" persons, on one side, on the other. </p><br><p>  I‚Äôll rather just try to explain another (perhaps new for some readers) conceptual approach with examples, including those related to that article. </p><br><p>  By the way, the fact that not everything is in it or most likely not everything is entirely true, the ‚Äúreal hacker‚Äù can be seen with the naked eye. </p><br><p>  For example, after reading ‚Äú <em>Drew a base weighing 5 GB ... how long did it swing. Do you think someone noticed?</em> " I just grinned and continued reading (for IMHO some exaggeration is allowed in such articles). </p><br><p>  Although the author himself acknowledged <del>  that he is a little liar </del>  update at the end of the article. </p><br><blockquote>  Of course, I have no base, for 3 days I emulated downloading ... </blockquote><p>  Now why is this obvious / likely (even without taking other typical constraints into account): </p><a name="habracut"></a><br><ol><li>  If you walk to the server, you will immediately see a bunch of nginx / 1.1.9 * PHP / 5.3.10 (most likely fpm, but not the essence, in practice, it will also behave when proxying to Apache). </li><li>  If we recall the fact that you can dump only from injections, then you can roughly assume how it will get to the presentation layer and / or the html page formation layer. </li><li> And if we recall how normally nginx and the same puff-fpm communicate (which sends the header with the first byte after the first flush from the buffer), then we can recall options like <code>fastcgi_read_timeout</code> (which by default is 60s and change it for special location / cases), <code>preread_timeout</code> and others like it, and also <code>max_execution_time</code> (default 30s), <code>request_terminate_timeout</code> , etc.  etc. </li></ol><br><p>  If you drag it incrementally (aka in chunks), then you can assume how much time you really need to drag off a five-gigabyte database from the server, which by the way is not intended for such operations, with chunks wrapped in html from the top page. <br>  Recall that our hacker is not a stupid person and must hide behind the proxy / vpn / favorite substitute, and the whole action becomes even more doubtful. </p><br><p>  That is not a fact, but still very doubtful.  Although ... let it be a "hint" as a <a href="https://habrahabr.ru/users/noraq/" class="user_link">pretense to NoraQ</a> <del>  when they come with a soldering iron </del>  in case of unforeseen issues. </p><br><p>  Well, yes, the article is not about that, so let's say ... <br>  So we come to the most important thing. <br>  To the answer to the question <strong>"Do you think someone noticed?"</strong>  . </p><br><p>  I'll try with another question: Why did you immediately decide that no one noticed? <br>  How did you decide that you were given ‚Äúdata‚Äù from a real data bank? <br>  And finally, can it be that someone, somewhere, left something "ajar" on purpose? </p><br><p>  Notice, I'm not saying that it is.  That is just thinking out loud. </p><br><p>  However, in the world of information security, there really exist techniques of deliberate traps set up for uninvited guests.  And they are often used in practice. </p><br><p>  There are a lot of names and they depend on the application in a particular case, but English-speaking colleagues often heard generalized abbreviations IPF (from intentional pseudo flaws) and ITD (from intentional trap doors), meaning the same thing, namely, deliberately left pseudo-flaws or special defense holes that play the role of a trap for the attacker. </p><br><p>  In addition to several obvious flaws, a security system that allows such ‚Äúpranks‚Äù has many advantages: </p><br><ul><li>  allows the security administrator to monitor the behavior of the attacker, collect and analyze the means and methods of attack; </li><li>  helps to identify potential risks, as well as existing security holes in the system; </li><li>  allows the defending side to direct the attacker's actions in the right direction, divert the attack to the required less "secret" level, give a less valuable "resource", etc.  (thereby moving the attack vector away from the real system); </li><li>  often distracts the invader from searching for real (existing) vulnerabilities; </li><li>  allows you to control the process of protection, for example, to carry out a controlled "dumping" of information ("feed" to the competitors deliberately false or uninteresting information); </li><li>  and last but not least, it allows the safety officer to keep himself in good shape (advanced training, skills, abilities, etc.) </li></ul><br><p>  You just need to remember that opening access to the attacker increases the risk level.  However, taking into account the above, the possible risks more than overlap with the benefits obtained. </p><br><p>  Once, an acquaintance of CIO told me, folding his fingers like on the picture (here is the picture): "You can‚Äôt <del>  just take and </del>  to become a good beaver, never having been in the shoes of an intruder. "The context of the conversation and the tone in which it was said clearly told me that he was still a‚Äú hacker ‚Äùin his youth ... </p><br><p>  Well, it may be good (if in moderation), only he was not quite right - there is such a method in fact - nothing enhances the skills like an interactive ITD with dozens of good pentesters and others (homegrown and not) attacking of all stripes.  Very informative, I tell you ... </p><br><p>  Again, this is just an indescribable feeling when you feed a hint of a terrible "vulnerability" to an intruder, with a theoretical possibility of elevating privileges to the root (and you see it "I am cool!"), Forcing him to abandon the search for XSS and similar boring vulnerabilities, forget all and plunge headlong into the trap prepared for him. </p><br><p>  Let's return to the article about the "holes" in the FRDO ... </p><br><p>  The ITD is not really limited to the ‚Äúgames‚Äù with the attacker.  For example here, if you read the objectives " <a href="http://obrnadzor.gov.ru/ru/activity/main_directions/reestr_of_education/">Formation and maintenance of the FEDD on education and (or) on qualifications, documents on training</a> ", then you can find the following there: </p><br><blockquote>  Elimination of the turnover of forged state documents on education </blockquote><p>  What other way can one deal so effectively with the circulation of forged documents, except, using IPF / ITD, to collect a database of possible candidates for sawing firewood in some cold and especially remote corner of Russia? </p><br><p>  Not pentesters, not at all ... And for example, people who are trying in vain to exploit the injection to insert new documents. </p><br><p>  I, in the place of the ‚Äúrealizer‚Äù (or organizer) of the offer, would probably use the appropriate opportunity and opportunity, and I would do just that. </p><br><p>  What is not a suitable tool for such purposes?  And with some experience, this can be quite easy and, most importantly, imperceptibly implemented. </p><br><p>  But enough here conspiracy studies, the rest habrazhiteli, with their inherent rich imagination, certainly "thought out" in the comments.  It may even be possible to see a ready PoC or something else, which your humble servant lacks intelligence-mind for. </p><br><p>  I, as examples of the ‚Äúimplementation‚Äù of ITD, wanted to tell here about my own experience both as a pentester who once fell for this bait (or maybe not once, is not a fact), and as a safeguard who already organized such systems (for the sake of interest and enterprise-level). <br><del>  With sea battle and madame </del>  With attack logs, monitoring protocols and all matters. <br>  But ... The article has already grown.  Yes, and I think as an introduction this will be enough for now. <br>  I'll try to drop it later, if <del>  article will gain the necessary number of advantages </del>  interesting. <br>  Time, always time ... be it amiss ... </p><br><p>  Well, once again, when you find a "security hole," think about the fact that maybe that joke still has its share of truth, and it (your hole) did suddenly and in fact be <strong>completely</strong> safe.  Just as a subtle thought in the back ... </p><br><p>  Well, again, returning to the topic of the FRDO ... </p><br><p>  <strong>[UPD]</strong> <em>For those who are in the tank ...</em> <br>  The article is not about what was there.  And about the fact that in theory it is possible (in an ideal world if you want) ... <br>  Those.  then all the lyrics, but with reference to a specific incident, for example, I can not exclude such a scenario. <br>  And you do not need about the fact that it is so difficult, expensive (and in general no one needs a fig), okay? ... </p><br><p>  Here is a specific cheap working version (the simplest for the knee): </p><br><ul><li>  set a filter that detects attempts to sql-injection; </li><li>  we forward requests from it (yes though by means of nginx) in "sandbox"; </li><li>  there we write the simplest trigger for changes in the table (with a sink to the log); </li><li>  We write a log handler (parsing, adder over IP, design in a beautiful plate); </li><li>  analysis of the log once a day on the soap to fellow Major. </li></ul><br><p>  The question was not whether it was true or not, but in theory it could be, but it didn‚Äôt even occur to our home-grown hacker.  And he just hung it on the wall. <br>  I myself am far from white and certainly not fluffy, but this <strong>is not how it is done</strong> , from the word at all! <br>  <strong>[/ UPD]</strong> </p><br><p>  And please, that's just not necessary here about the fact that "They are all stupid / lazy / clumsy."  True, do not ... It is, firstly, not at all about that. </p><br><p>  And secondly, there are also many wonderful, intelligent and committed people.  Fortunately, they are not only in fashionable start-ups, in highly paid positions in large concerns, enterprises, etc.  Communicated - we know. </p><br><p>  Well, there are a lot of similar professionals around who do not belong to those specific structures, but sometimes are willing to help (both for interest and for an idea, etc.). </p><br><p>  The answer to the question ‚ÄúWhy did they eventually be patched up‚Äù can be: well, the hype is the same.  And ... Are you sure that everything is closed?  And what is forever? ... </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/348016/">https://habr.com/ru/post/348016/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348006/index.html">Cryptocurrency Phishing</a></li>
<li><a href="../348008/index.html">We are friends of gRPC with a long-lived project, PHP and front-end</a></li>
<li><a href="../348010/index.html">False alarms. New technique of catching two birds with one stone. Part 2</a></li>
<li><a href="../348012/index.html">As I measured the quality of technical support work</a></li>
<li><a href="../348014/index.html">Blockchain: features, structure, EDS and task for a student, part 1</a></li>
<li><a href="../348018/index.html">Even in Java 9, ArrayList can still (and should) be improved.</a></li>
<li><a href="../348020/index.html">Blockchain: Networking, Signature Verification and Student Assignment, Part 2</a></li>
<li><a href="../348022/index.html">Game development under NES in C. Chapters 1-3. From introduction to Hello World</a></li>
<li><a href="../348024/index.html">SecurityWeek 2: army of clones, Google hunts for ghosts, Blizzard patches</a></li>
<li><a href="../348026/index.html">Installing Linux without .ISO and virtualization</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>