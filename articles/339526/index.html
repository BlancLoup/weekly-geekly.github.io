<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Money pumping machine: miner Monero</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="While the world is waiting, where the famous cybergroups like Lazarus or Telebots, armed with analogs of WannaCry or Petya, operators of less resonant...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Money pumping machine: miner Monero</h1><div class="post__text post__text-html js-mediator-article">  While the world is waiting, where the famous cybergroups like Lazarus or Telebots, armed with analogs of WannaCry or Petya, operators of less resonant campaigns, will strike <br>  earn no noise.  One of such operations has been going on at least since May 2017.  The attackers infect Windows web servers with the malicious miner of the cryptocurrency Monero (XMR). <br><br>  The attackers behind this campaign modified the legitimate miner based on open source code and used a vulnerability in Microsoft IIS 6.0 <a href="http://www.cvedetails.com/cve/CVE-2017-7269/">CVE-2017-7269</a> to hide Malvari on unpatched servers.  For three months, fraudsters created a botnet from several hundred infected servers and earned more than 63 thousand dollars on Monero. <br><br>  ESET users are protected from any attempts to exploit the CVE-2017-7269 vulnerability, even if their machines have not yet been patched, as <a href="https://www.welivesecurity.com/2017/05/18/protected-against-wannacryptor/">was the case</a> with the EternalBlue exploit used in distributing WannaCry. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/59/d7/90/59d790fde4c5b086063687.jpeg"><br><br><a name="habracut"></a><h3>  Monero or Bitcoin? </h3><br>  Despite the rise in Bitcoin, Monero has several advantages that make this cryptocurrency very attractive for mining with the help of malware.  This is the inability to track transactions and prove the use of the CryptoNight algorithm, which uses computer and server CPUs and GPUs (as opposed to Bitcoin, for the extraction of which specialized equipment is needed). <br><br>  During the last month, the Monero rate rose from $ 40 to $ 150, and then dropped to $ 100. <br><br><img src="https://habrastorage.org/webt/59/d7/90/59d790fddc591819071170.png"><br>  <i>Figure 1. Candlestick chart of the rate of XMR / USD in August 2017</i> <br><br><h3>  Crypto miner </h3><br>  First discovered in-the-wild on May 26, 2017, mining malware is a modification of the legitimate miner Monero based on <a href="">xmrig</a> open source code (version 0.8.2, released on May 26, 2017). <br><br>  The authors of the malicious miner did not change the original code base, only added hard-coded command line arguments with their wallet address and mining URL, as well as several arguments to destroy previously launched malware in order to avoid competition.  Such a revision takes no more than a couple of minutes - it is not surprising that we found the malware on the day of the release of the basic version of xmrig. <br><br>  You can see the modified miner attackers and its comparison with the available source code in the figure below. <br><br><img src="https://habrastorage.org/webt/59/d7/90/59d790fe4897d058212276.png"><br><img src="https://habrastorage.org/webt/59/d7/90/59d790fea4397075954549.png"><br>  <i>Figure 2. Comparison of source and modified miner code</i> <i><br></i> <br><br><h3>  Scanning and operation </h3><br>  Delivery of the miner to the victims' computers is the most difficult part of the operation, but even here the attackers used the simplest approach.  We identified two IP addresses from which brute-force scanning is performed for vulnerability CVE-2017-7269.  Both addresses point to servers in the Amazon Web Services cloud. <br><br>  The vulnerability exploited by the attackers was discovered in March 2017 by researchers Zhinyg Peng and Chen Wu.  This is a vulnerability in the WebDAV service that is part of Microsoft IIS version 6.0 in Windows Server 2003 R2.  The buffer overflow vulnerability in the <code>ScStoragePathFromUrl</code> function <code>ScStoragePathFromUrl</code> triggered when the vulnerable server processes a malicious HTTP request.  In particular, a specially crafted PROPFIND request causes a buffer overflow.  A detailed analysis of the mechanism is described by Javier M. Mellid and is available <a href="https://javiermunhoz.com/blog/2017/04/17/cve-2017-7269-iis-6.0-webdav-remote-code-execution.html">here</a> .  The vulnerability is susceptible to exploitation because it is located in the web server service, which in most cases should be accessible from the Internet and is easy to use. <br><br>  The <i>shellcode</i> is the expected load and execute action (download <i>dasHost.exe</i> from hxxt: // postgre [.] Tk / to the% TEMP% folder): <br><br><img src="https://habrastorage.org/webt/59/d7/90/59d790fed6856002636981.png"><br>  <i>Figure 3. Shell code delivered by the exploit</i> <br><br>  According to our data, the in-the-wild first exploitation of this vulnerability was made just two days after the publication of its description on March 26, 2017.  Since then, the vulnerability is actively used. <br><br>  A new malicious miner was first seen on May 26, 2017.  From this point on, it spreads in waves, which means that attackers continue to search for vulnerable machines. <br><br><img src="https://habrastorage.org/webt/59/d7/90/59d790fed779e050383820.png"><br>  <i>Figure 4. Wave graph of infection</i> <br><br>  Scanning is always performed from a single IP address, most likely, a machine that is hosted on an Amazon cloud server leased by hackers. <br><br><h3>  Statistics </h3><br>  The mining pool statistics was publicly available, so we can see the cumulative hashrate of all the victims who provided computing power for mining.  The constant value reached 100 kiloeshes per second (kH / s) with peaks up to 160 kH / s at the end of August 2017, which we associate with campaigns launched on August 23 and 30. <br><br>  In general, infected machines produced about 5.5 XMR per day by the end of August.  Earnings for three months amounted to 420 XMR.  With a rate of $ 150 for 1 XMR, the income of the miner operators was $ 825 per day and more than $ 63,000 in total. <br><br>  The attackers intensified in late August, but since the beginning of September we have not seen new infections.  Moreover, since the miner does not have a persistence mechanism, the attackers begin to lose compromised machines, and the total hashrate fell to 60 kH / s.  This is not the first break in the activity of the cyber group; most likely, a new campaign will start in the near future. <br><br>  We do not know the exact number of victims, but we can roughly estimate it by the total hashrate.  According to CPU figures, the hash rate of the high-performance Intel i7 processor reaches 0.3‚Äì0.4 kH / s.  This campaign uses systems running Windows Server 2003, which most likely run on old hardware with relatively weak processors.  Therefore, the average hash rate of the victim will be much lower, and the total number of infected machines will be higher;  You can talk about hundreds of victims. <br><br><img src="https://habrastorage.org/webt/59/d7/90/59d790ff35918864881133.png"><br>  <i>Figure 6. Attacking wallet statistics provided by the mining pool</i> <br><br><h3>  Conclusion </h3><br>  At the heart of this campaign is a legitimate open source miner and a number of machines with outdated non-updated operating systems.  For profit, the operators of the malicious miner had to only slightly modify the code, operating costs are minimal. <br><br>  ESET detects a malicious binary file miner as a <b>Win32 / CoinMiner.AMW Trojan</b> , attempting to exploit a network-level vulnerability like <b>webDAV / ExplodingCan</b> .  This is a real example of a package that will be blocked: <br><br><img src="https://habrastorage.org/webt/59/d7/90/59d790ffbc788812860452.png"><br>  <i>Figure 5. Special HTTP request with shellcode</i> <br><br>  Microsoft <a href="https://www.microsoft.com/en-us/cloud-platform/windows-server-2003">completed support for</a> Windows Server 2003 in July 2015 and did not release patches for the CVE-2017-7269 vulnerability until June 2017 ‚Äî while critical vulnerabilities for legacy operating systems did not attract the attention of virus writers.  In order to avoid large-scale destructive attacks like an epidemic, WannaCry Corporation decided to close these vulnerabilities.  However, maintaining Windows Server 2003 is quite difficult, since automatic updates do not always work well (this is confirmed, for example, by Clint Bossen‚Äôs <a href="http://clintboessen.blogspot.cz/2016/12/how-to-patch-windows-server-2003-with.html">post</a> ).  Consequently, most systems are still vulnerable.  We strongly recommend that users of Windows Server 2003 install <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D55422">KB3197835</a> and other security updates as soon as possible (if the automatic update does not work, download the patch manually!). <br><br><h3>  Indicators of compromise </h3><br>  <b>Download Sites:</b> <br> <code>hxxp://postgre.tk <br> hxxp://ntpserver.tk</code> <br> <br>  <b>IP address of the source of attack:</b> <br> <code>54.197.4.10 <br> 52.207.232.106 <br> 18.220.190.151</code> <br> <br>  <b>Hashes:</b> <br> <code>31721AE37835F792EE792D8324E307BA423277AE <br> A0BC6EA2BFA1D3D895FE8E706737D490D5FE3987 <br> 37D4CC67351B2BD8067AB99973C4AFD7090DB1E9 <br> 0902181D1B9433B5616763646A089B1BDF428262 <br> 0AB00045D0D403F2D8F8865120C1089C09BA4FEE <br> 11D7694987A32A91FB766BA221F9A2DE3C06D173 <br> 9FCB3943660203E99C348F17A8801BA077F7CB40 <br> 52413AE19BBCDB9339D38A6F305E040FE83DEE1B</code> </div><p>Source: <a href="https://habr.com/ru/post/339526/">https://habr.com/ru/post/339526/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339516/index.html">Zabbix conference 2017: how was the first day</a></li>
<li><a href="../339518/index.html">The Unified State Automated Information System is not as terrible as they are frightened: what will the unique DataMobile module of the Unified State Automated Information System help retail stores with?</a></li>
<li><a href="../339520/index.html">We meet PostgreSQL 10. Translation Release Notes</a></li>
<li><a href="../339522/index.html">Factory widgets for MPA</a></li>
<li><a href="../339524/index.html">‚ÄúIf we started now from the beginning, we would choose Scala again‚Äù: Tinkoff.ru about Scala development</a></li>
<li><a href="../339528/index.html">How to become a programmer</a></li>
<li><a href="../339532/index.html">Multimodal Emotion Recognition Challenge by Neurodata Lab</a></li>
<li><a href="../339534/index.html">Classic 2D quest or how our two years of development went. Part of the final</a></li>
<li><a href="../339536/index.html">Security Week 40: Yahoo, do not leak, Google is caulking holes, as Netgear bugs catches</a></li>
<li><a href="../339538/index.html">Part 2: MVVM: Complete Understanding (+ WPF)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>