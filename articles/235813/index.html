<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A remake of Caesar III: a mathematical model of the city</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I remember playing for the first time in Caesar 3, this is an amazingly smart and balanced game, it creates the feeling that the city lives its own li...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A remake of Caesar III: a mathematical model of the city</h1><div class="post__text post__text-html js-mediator-article">  I remember playing for the first time in Caesar 3, this is an amazingly smart and balanced game, it creates the feeling that the city lives its own life even after the completion of the mission.  You can spend hours watching the city and not interfere in his life: plebeians will run around the city in search of work, and patricians complain about poor living conditions, traders, schoolchildren, boats, priests - this world freezes only in moments of pauses, giving the player the opportunity consider the next step.  Investigating the internal algorithms of the game, I do not cease to be surprised with what accuracy the authors put together the pieces of the puzzle, called ‚Äúbalance‚Äù.  During the time spent on restoring the original game code, there has been accumulated enough material on the game's macromechanics, which I want to share with the media community. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/ahN2R-zEsvs%3Ffeature%3Doembed&amp;xid=17259,15700002,15700021,15700186,15700190,15700253&amp;usg=ALkJrhjTZnYFahX26sn6QPUJX9QKYz3Jdw" frameborder="0" allowfullscreen=""></iframe><br><a name="habracut"></a><br><h4>  Different trips to the modeling of city bustle </h4><br>  It all starts with the prestige of the land, it is one of the layers of the city, which the game operates on to calculate the parameters of migration and the level of houses.  In addition to the base layers, the relationship of which is shown below, each layer can be further divided into parts. <br><img width="500" src="https://habrastorage.org/files/630/8e1/195/6308e1195146434fbf10d2413640c98e.jpg"><br><br>  In the city, people live in houses, the number of people and the quality of housing varies with each level, each level has a number of parameters, upon which it passes to the next.  As I said, the basic parameter is the prestige of the land, the other basic parameter is food supply: in a small town this may not be noticeable, but in large cities the distance of barns and warehouses greatly affects the location of residential quarters on the map.  Given that the market adversely affects the surrounding territory and the priority of traders is shifted towards supplying the population with food, a situation often arises when, due to lack of food, there is a shortage of other goods, especially the most valuable (for the development of houses) - pottery and furniture. Each next level of the house requires more expensive services and resources.  We get the classic (human) needs pyramid. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img width="500" src="https://habrastorage.org/files/c4b/027/4e7/c4b0274e77784e2b96f90419218691cb.jpg"><br><br>  At a certain stage of development, houses turn into villas and significantly improve the rating of the city, but it reduces the number of workers in the city: the patricians do not work, which in turn leads to a sharp decrease in the level of production in the city and mass exodus of residents, and if at some point in the game If you skip these ‚Äúswing populations‚Äù, they often lead to losing the mission.  You can invite new settlers to the city, but with the advent of huts, already prosperous residents begin to flee from the city and the prosperity rating drops. <br><br><img width="100" height="75" src="https://habrastorage.org/files/206/8f6/768/2068f676845442d3a55b55729bdafe44.jpg"><img width="100" height="75" src="https://habrastorage.org/files/c65/a19/6b5/c65a196b5a4343ae8af241da3b79a589.jpg"><img width="100" height="75" src="https://habrastorage.org/files/7de/5a8/210/7de5a821065f48c1a2306487bb3a7a77.jpg"><img width="100" height="75" src="https://habrastorage.org/files/f04/eb4/3be/f04eb43be267474396b173b8c6b74582.jpg"><img width="100" height="75" src="https://habrastorage.org/files/f63/518/018/f635180188174d86a954930d423334d3.jpg"><img width="100" height="75" src="https://habrastorage.org/files/5dc/1e5/5ce/5dc1e55ce0ad4b6c9ed4d921be3003fe.jpg"><img width="100" height="75" src="https://habrastorage.org/files/01b/029/33e/01b02933e2f946a8a254e5adccbfc55c.jpg"><img width="100" height="75" src="https://habrastorage.org/files/da7/971/c09/da7971c09e474024b894aace1ce5a4d3.jpg"><img width="100" height="75" src="https://habrastorage.org/files/e1e/09d/367/e1e09d36774b4d3e8496fb387fdbd721.jpg"><br><br>  The basic layers of the city may contain additional sublayers that are responsible for a specific parameter or service provided.  For example, health care can be divided into general (doctors and baths) and specialized, which is required by patricians (clinic), but also replaces general functions: for example, the clinic provides the services of surgeons and doctors, but the cost of maintenance is much higher than that of a doctor's house.  It is the same with entertainment, except that entertainment buildings require ‚Äústudents‚Äù: actors need actors for the theater, gladiators and lions for the Coliseum.  It seems to be a small detail, but such unobtrusive micromanagement greatly influences the layout of the city in conditions of limited coverage of buildings. <br><br><img width="500" src="https://habrastorage.org/files/8ab/84c/136/8ab84c13649745d28abe8bd65c19ee5f.jpg"><br><br>  Having defined the components of "urban life", you can make a mathematical model of the city.  I note that the original game uses a probabilistic-statistical model of the city, which means that at certain points in time (game day, week, month and year) a snapshot of the city parameters is taken and based on this data and taking into account previous states, the probability of an event is calculated.  A simplified description of the model is shown below.  Red is the negative effect of one object on another, green is positive.  The positive aspects of the statistical model are that when calculating the probability of an event not taking into account the parameters of an individual object, we consider the ‚Äúaverage temperature in the hospital‚Äù, which significantly reduces the workload during the calculations (let me remind you that the game was launched on computers with a RAM size &lt;32Mb).  Buildings, although they have their own characteristics, in most cases they are involved in calculating the averaged parameters, and not to calculate the situation for a particular building. <br><br><img width="900" src="//habrastorage.org/files/669/642/583/66964258392f4c35a1b1b3042dfc0fd1.png"><br><br>  In the remake of the game, from the very beginning a dynamic model of the city was laid, similar can be seen in the game ‚ÄúTropico‚Äù, where each game object has a set of its own characteristics, which it uses to select the object's behavior at a specific point in time.  The set of links in this case is more complicated and depends on the specific object, for example, the parameters of the house depend on the number of people living, on the number of working people in this house, the availability of products and goods, and the funds for their purchase on the market.  In the picture you can see a simplified model for calculating the parameters of the house. <br><br><img width="500" src="https://habrastorage.org/files/ed3/960/64a/ed396064a40d4bce846e2ab857aced05.jpg"><br><br>  Since the calculation of the probability of occurrence of an event is transferred from the city level to the object level, additional connections need to be entered for interaction between the objects, in the remake they are performed by ‚Äúservice providers‚Äù (porters, bathhouse attendants, market vendors, priest, schoolchildren, etc. .).  The model of behavior of objects in the game also changes accordingly, most of the interaction between them occurs through an intermediary. <br><br><img width="900" src="https://habrastorage.org/files/9ea/4b3/307/9ea4b330781a46fba0d6876ac9fdeeb7.png"><br><br>  The use of a dynamic model makes programming the logic of individual objects much more difficult, since  it is necessary to take into account the impact and type of source, the positive side of such an organization is the flexibility to customize the behavior of both the event source and its handler.  Any dynamic modeling, designed to evaluate non-stationary processes to answer the question: "What if?".  And what if: in the city there will be a famine with a large flow of settlers, how will the epidemic, fire or earthquake spread. <br><br><h4>  Differences from the original game </h4><br>  I have been asked in person many times if I‚Äôm doing a Caesar clone and where did the decompiled source go.  It was the clone (the code that turned out after the reverse engineering) that I completed 90 percent, the project is going to work and the first mission is going to work.  The source code was removed from the github at the request of the copyright holder.  This is directly about Caesar's clone, it is located in an even more ‚Äúgray legal area‚Äù.  As for the remake, CaesarIA is an independent open source game, an attempt to revive the game with more than 15 years of history from Impressions Games. <br><br>  <b>No,</b> this is not Caesar, I use the ideas from this game, but all the code is written from scratch: logic, maps, search for the path and other things that you used to see in the old Caesar, they are made with an eye to it, but they are different. <br>  <b>Yes,</b> I use ripped resources for test builds, if you are tormented by the question of legality - you are free to choose the mode of working with original archives from an honestly purchased copy. <br><br>  <a href="http://habrahabr.ru/post/235259/">Having asked the opinions of habrazhiteli,</a> I decided to try to <a href="http://igg.me/at/caesaria-game">legalize the remake</a> in the way that I thought was available at the moment - to raise funds through crowdfunding, and in Russian ‚Äúto the world by thread‚Äù.  The choice fell on the site <a href="http://igg.me/at/caesaria-game">Indiegogo.com</a> ( <i>and yes, I know that many consider this site garbage for suspicious projects</i> ).  After talking with artists on gamedev.ru and their familiar designers, the average price for creating 3D models (and, accordingly, textures) of buildings and people was determined: $ 6k (102 building models + animation) for buildings, $ 4k for people and surroundings.  this will avoid the claims of copyright holders and make it possible to distribute the game for both desktop computers and tablets running Android and iOS.  At the moment I have done everything I planned with the game world by the fall of this year, but I am just one person and I hope that the help of other people will allow the game to find its own style.  Now the project has reached the point where its further development is difficult without new textures, buildings, sounds and other materials. <br><br> <a href="http://www.igg.me/at/caesaria-game"><img src="https://habrastorage.org/files/5fd/dbc/d20/5fddbcd20dfd43f3a233d13f2ea499c3.jpg"></a> <br><br><div class="spoiler">  <b class="spoiler_title">What problems are solved at the moment</b> <div class="spoiler_text">  This is the video of the second training mission, then the playing of video clips was not done yet (this is a live gameplay as it is) the video is long, I just played the second mission: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/FAWDq2_DNkI%3Ffeature%3Doembed&amp;xid=17259,15700002,15700021,15700186,15700190,15700253&amp;usg=ALkJrhiYFa-7LhJxKAE27lHvGqaeNu0V0g" frameborder="0" allowfullscreen=""></iframe><br><br>  1. City simulation <br>  1.1 fires and building aging <br>  1.2 in the game all the buildings of the original are realized, the functionality of some of them needs to be improved <br>  1.3 all city layers that were used in the original are implemented (training, health, <br>  health care, taxes, etc.) <br>  1.4 made tax collection system based on forums <br>  2. Gods and religion, gods can be angry or rejoice <br>  2.1 Calculation of the temples coverage area <br>  3. The calculation of the distribution of water, goods, products and services <br>  4. Made the appearance of disgruntled citizens and rebels <br>  5. Made a simple AI to control the soldiers, their own and enemy <br>  6. Planning and holding festivals <br>  7. Emperor's requests and trade between cities <br>  8. Animals and fishing <br>  9. Birth, aging and death of citizens.  Age groups <br>  10. Dynamic update of objects paths, obstacle avoidance <br>  11. Subject missions from the original (until the mission in Tingis) <br>  12. Mining and production chains <br><br>  <b>Many other little things that had to be solved in the course of creating the game</b> <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/235813/">https://habr.com/ru/post/235813/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235799/index.html">Those who want to teach children to program and make games</a></li>
<li><a href="../235801/index.html">09.09.2014 | Autumn presentation of Apple's new products</a></li>
<li><a href="../235803/index.html">Containerization - new shared-hosting</a></li>
<li><a href="../235805/index.html">A small Japanese trick on organizing your notebook</a></li>
<li><a href="../235809/index.html">OnePlus One - Chinese Beast</a></li>
<li><a href="../235817/index.html">Warner Bros. sued a small bar for playing an 80 year old song</a></li>
<li><a href="../235819/index.html">Increasing website sales: how long should a free trial period be for a customer to pay?</a></li>
<li><a href="../235823/index.html">What to read at your leisure. Gaming Industry News Digest for August</a></li>
<li><a href="../235825/index.html">Circle on programming. Results of the first year</a></li>
<li><a href="../235827/index.html">ThL 5000 - a resilient Chinese</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>