<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>When is it harmful to test your components?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Automated tests are good. The project, which is 100% covered with tests, presents coverage as an advantage. But‚Ä¶ 

 I think that in this process there...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>When is it harmful to test your components?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/ca7/8ba/b4f/ca78bab4fbf7488f8742ff49c2a700da.jpg" alt="image"><br><br>  Automated tests are good.  The project, which is 100% covered with tests, presents coverage as an advantage.  But‚Ä¶ <br><br>  I think that in this process there is no awareness.  And it makes life much easier.  It is possible that half of the tests in your project are not only useless, moreover, it is harmful.  Below I will talk about what tests do not need to write. <br><a name="habracut"></a><br>  Consider a component on ReactJS: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FilterForm</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">frameworks</span></span>: [<span class="hljs-string"><span class="hljs-string">'react'</span></span>, <span class="hljs-string"><span class="hljs-string">'angular'</span></span>, <span class="hljs-string"><span class="hljs-string">'ember'</span></span>, <span class="hljs-string"><span class="hljs-string">'backbone'</span></span>] }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleChange = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleChange.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } handleChange(event) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({<span class="hljs-attr"><span class="hljs-attr">value</span></span>: event.target.value}); } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> filteredElements = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.frameworks .filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> e.includes(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.value)) .map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> &lt;li&gt;{ e }&lt;<span class="hljs-regexp"><span class="hljs-regexp">/li&gt;) return ( &lt;div&gt; &lt;input type="text" value={this.state.value} onChange={this.handleChange} /</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{ filteredElements }</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/div&gt; ); } }</span></span></code> </pre> <br>  <a href="http://codepen.io/zolotyh/full/ZBKyxv/">Working example</a> <br><br>  Tests for this may look something like this: <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'should work'</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> wrapper = shallow(<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FilterForm</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">); expect(wrapper.find('li').length).to.equal(4); wrapper.find('input').simulate('change', {target: {value: 'react'}}); expect(wrapper.find('li').length).to.equal(1); });</span></span></code> </pre><br>  Let's think what this code is testing.  It is important.  And he tests by and large this line: <br><br><pre> <code class="javascript hljs">.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> e.includes(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.value))</code> </pre><br>  Of course, we also test how ReactJS renders changes and how events are hung on the DOM, how they are processed and so on.  But this line is clearly the main one. <br><br>  Do we really need to test the entire component?  With this approach to writing code, we can not otherwise.  We have no choice. <br><br>  In a specific example, this causes no problems, but almost always the components become much more complex over time.  Logic and DOM components are moved from one component to another. <br><br>  For example, the next step makes sense to break one component into two: an input form and a sheet.  Each element of the sheet also makes sense to make a separate component.  After such changes will have to change the tests.  Rather, do not change, and throw out and write again.  They will become useless because they are tied to the DOM.  The question arises: ‚ÄúWhy are such tests needed !?‚Äù <br><br>  Tests that need to be changed after each change in the code are useless and even harmful because they require maintenance costs and do not bring any benefit. <br><br>  Of course, you can use some kind of abstraction, such as <a href="http://martinfowler.com/bliki/PageObject.html">PageObject</a> (eng), but the problem will not be completely solved. <br><br>  The fact is that the component itself is written poorly.  Filtering code cannot be reused.  If we need filtering in another component, then with this approach we will have to write and test everything anew. The principle of <a href="http://blog.byndyu.ru/2009/10/blog-post.html">uniqueness of responsibility has been</a> violated. <br><br>  In addition to the logic for output in the component, there is also logic for filtering.  The solution is, and it is <b>very simple</b> .  You can transfer the code that is responsible for filtering to another place and test there. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">filter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">list, value</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> list.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> e.includes(value)) } expect(filter(list, <span class="hljs-string"><span class="hljs-string">'react'</span></span>).length).to.equal(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><br>  Now we do not need special tools and component rendering.  Change components as you like, tests will remain relevant and will help you with each commit. <br><br>  If you really want, you can test the component itself.  But what does it give?  The question is open. <br><br>  The conclusion suggests itself: The difficulty of writing tests is a sign of poor design, a reason to think again about the architecture of the code.  Instead of dodging and writing unsupported tests with rendering in a pseudo-browser, it is easier to put things in order and write simple clear unit tests that further document your application. </div><p>Source: <a href="https://habr.com/ru/post/315908/">https://habr.com/ru/post/315908/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315898/index.html">[ZeroNights2016] [CTFzone] Without 100 grams you will not understand</a></li>
<li><a href="../315900/index.html">The difference of the frame from the library</a></li>
<li><a href="../315902/index.html">New season webinars Hewlett Packard Enterprise</a></li>
<li><a href="../315904/index.html">Meeting lovers of big data and art</a></li>
<li><a href="../315906/index.html">SPDK: Acceleration with NVMe Disks</a></li>
<li><a href="../315910/index.html">Asterisk statistics interface. New version, new functionality</a></li>
<li><a href="../315912/index.html">Connecting a character LCD to the board from WD MyBook Live on AppliedMicro APM82181</a></li>
<li><a href="../315914/index.html">Using Intel technology to transfer network traffic from a physical adapter to a virtual one</a></li>
<li><a href="../315916/index.html">You, Inc. How to develop personal and professional skills, sell them and stand out from the crowd</a></li>
<li><a href="../315918/index.html">How an entrepreneur destroyed a mediocre business to create a great company</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>