<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>An example of the principle of DRY in Windows Phone 7</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I am an idealist. 
 Software developers are hard to be an idealist - code optimization never stops. There are always, a little later, more elegant sol...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>An example of the principle of DRY in Windows Phone 7</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/841/bf7/d9a/841bf7d9aa63b707f9f7e1569fcb5a13.png" align="left"><h4>  I am an idealist. </h4><br>  Software developers are hard to be an idealist - code optimization never stops.  There are always, a little later, more elegant solutions, which leads to constant code refactoring.  If the project has a limited time, it somehow stops the process of continuous improvement, but in the case of personal development, the programmer is limited only by his knowledge, which, in turn, is also constantly growing, which turns into a vicious circle. <br><br>  But, let's move a little from philosophy to practice.  Developing applications, I always strived for the ideal, sought to follow the current concepts.  In the course of development, I always tried to follow the principle of DRY.  Some time ago I started developing under Windows Phone.  As a result, ‚Äúwrappers‚Äù appeared for the operations that are used most often.  Some of them want to share. <br><a name="habracut"></a><br><h4>  DRY and why it is needed </h4><br>  <a href="http://ru.wikipedia.org/wiki/Don%25E2%2580%2599t_repeat_yourself">DRY - Don`t Repeat Yourself.</a> <br>  <i>This is the principle of software development, aimed at reducing the repetition of information of various kinds, especially in systems with multiple layers of abstraction.</i>  <i>The principle of DRY is formulated as: ‚ÄúEach piece of knowledge must have a single, consistent and authoritative representation within the system.‚Äù</i> <i><br></i>  <i>Wikipedia</i> <i><br></i> <br>  In each project there are standard operations that are repeated from one project to another.  It would seem not so difficult to write a few lines of code, but this is not correct.  This approach increases development time and the likelihood of repeating errors.  It is not necessary each time to describe the same thing, the same error interceptions, the same messages, the same code from the project to the project, it would be more correct to take standard operations to a certain library and simply use it. <br>  Thus, we: <br><ul><li>  Avoid re-writing routine code that takes up a huge amount of development time. </li><li>  avoid errors that have already been noticed and corrected in previous projects </li><li>  we split the code into more generalized abstractions, which simplifies its support and understanding in general </li></ul><br><h4>  Library </h4><br>  I am sure that many people have such practices.  This library is written based on my personal needs.  I want to note that with the release of Windows Phone 8 and Visual Studio 2012, as well as <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D9983">updates</a> for Visual Studio 2010 and Windows Phone 7.5, these examples no longer have much practical benefit, since such operations have been replaced by <a href="http://msdn.microsoft.com/en-us/library/vstudio/hh156513.aspx">async / await</a> .  But to demonstrate the principle of DRY is quite suitable. <br>  Library source code is available at <a href="http://vb.codeplex.com/">http://vb.codeplex.com</a> <br><br>  So, in the library there are two classes, one for working with asynchronous reading of resources, the second for working with local file storage.  Each class contains its own methods, properties, events, and error trapping. <br>  Consider in more detail. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Class LoadManager</b> <table><tbody><tr><td colspan="2">  Constructor </td></tr><tr><td>  Loadmanager </td><td>  public class LoadManager <br><br>  Initializes a new instance of the object. <br></td></tr><tr><td colspan="2">  Methods </td></tr><tr><td>  Load </td><td>  public void Load (string url) <br><br>  Creates a new WebClient object and calls its DownloadStringAsync method. <br></td></tr><tr><td colspan="2">  Properties </td></tr><tr><td>  Encoding </td><td>  public int Encoding <br><br>  Indicates which encoding to use when reading data. <br>  <i>Important!</i>  <i>To work with different encodings, the library MSPToolkit.dll is used.</i>  <i>She has already been added to the project.</i> <i><br></i>  <i>This parameter is optional, but sometimes, for example, to work with the 1251 encoding, it must be used.</i> <br></td></tr><tr><td>  Saveto </td><td>  public string SaveTo <br><br>  The name of the local file to which the data will be saved. <br>  <i>The file is stored in the application‚Äôs isolated storage.</i> <br></td></tr><tr><td colspan="2">  Developments </td></tr><tr><td>  Oncancel </td><td>  public event System.Action OnCancel <br><br>  Triggered when canceling data download. <br></td></tr><tr><td>  OnError </td><td>  public event System.Action &lt;Exception&gt; OnError <br><br>  Fails when data loading error. <br></td></tr><tr><td>  Onfinish </td><td>  public event System.Action OnFinish <br><br>  It works at the end of the download, regardless of whether there were errors or not. <br>  <i>Convenient to use to hide the download progress bar.</i> <br></td></tr><tr><td>  Onload </td><td>  public event System.Action &lt;string&gt; OnLoad <br><br>  It works when the data is successfully loaded. <br>  <i>Data comes in the form of a string.</i> <br></td></tr><tr><td>  OnNoNetwork </td><td>  public event System.Action OnNoNetwork <br><br>  It works in the absence of a network. <br>  <i>Of course, if the network is found, but there is no Internet access, then the OnError event will work, with a message that the resource is unavailable.</i> <br></td></tr><tr><td>  OnProgress </td><td>  public event System.Action &lt;DownloadProgressChangedEventArgs&gt; OnProgress <br><br>  It works when the download progress changes. <br></td></tr><tr><td>  Onstart </td><td>  public event System.Action OnStart <br><br>  It works at the start of data download. <br>  <i>Convenient to use to show the download progress bar.</i> <br></td></tr></tbody></table>  <b>Class FileManager</b> <table><tbody><tr><td colspan="2">  Constructor </td></tr><tr><td>  Filemanager </td><td>  public class FileManager <br><br>  Initializes a new instance of the object. <br></td></tr><tr><td colspan="2">  Methods </td></tr><tr><td>  Read </td><td>  public void Read (string FileName) <br><br>  Opens a file for reading. <br>  <i>Accepts the file name as a string.</i> <br></td></tr><tr><td>  Save </td><td>  public void Save (string FileName, string Data) <br><br>  Opens an existing file for writing or creates a new one if it is missing. <br></td></tr><tr><td colspan="2">  Properties </td></tr><tr><td>  WriteAfter </td><td>  public string WriteAfter <br><br>  The string that will be added at the end of the data. <br>  <i>Not always XML has a format that serializes normally.</i>  <i>For example, sometimes there is not enough root node.</i>  <i>This problem can be solved more elegantly, but the simplest method is to wrap the data in an additional root node.</i> <br></td></tr><tr><td>  WriteBefore </td><td>  public string WriteBefore <br><br>  The string that will be added at the beginning of the data (similar to WriteAfter). <br></td></tr><tr><td colspan="2">  Developments </td></tr><tr><td>  OnReadError </td><td>  public event System.Action &lt;Exception&gt; OnReadError <br><br>  It works when a file read error occurs. <br></td></tr><tr><td>  OnReadFileMissing </td><td>  public event System.Action OnReadFileMissing <br><br>  It works in the absence of a file that is trying to open for reading. <br>  <i>If this event was intercepted, the OnReadError event will no longer be raised.</i> <br></td></tr><tr><td>  OnReadReady </td><td>  public event System.Action &lt;StreamReader&gt; OnReadReady <br><br>  It works when the file is open for reading.  Sends an open file descriptor. <br></td></tr><tr><td>  OnSaveError </td><td>  public event System.Action &lt;Exception&gt; OnSaveError <br><br>  Fails when writing a file. <br></td></tr></tbody></table><br><h5>  Simple examples </h5><br>  Example of using LoadManager: <br><pre><code class="hljs haskell"><span class="hljs-type"><span class="hljs-type">LoadManager</span></span> <span class="hljs-type"><span class="hljs-type">DataLoader</span></span> = new <span class="hljs-type"><span class="hljs-type">LoadManager</span></span>(); <span class="hljs-type"><span class="hljs-type">DataLoader</span></span>.<span class="hljs-type"><span class="hljs-type">OnLoad</span></span> += new <span class="hljs-type"><span class="hljs-type">Action</span></span>&lt;string&gt;(<span class="hljs-type"><span class="hljs-type">DataLoader_OnLoad</span></span>); <span class="hljs-type"><span class="hljs-type">DataLoader</span></span>.<span class="hljs-type"><span class="hljs-type">Load</span></span>(resorce_url); void <span class="hljs-type"><span class="hljs-type">DataLoader_OnLoad</span></span>(string <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Deployment</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Current</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dispatcher</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BeginInvoke</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">delegate</span></span></span><span class="hljs-class"> { // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">something</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class"> }); } catch (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Exception</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ex</span></span></span><span class="hljs-class">) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Deployment</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Current</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dispatcher</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BeginInvoke</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">delegate</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MessageBox</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ex</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Message</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Exception</span></span></span><span class="hljs-class">", </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MessageBoxButton</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OK</span></span></span><span class="hljs-class">); }); } }</span></span></code> </pre> <br>  An example of using FileManager: <br><pre> <code class="hljs pgsql">FileManager CacheFile = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> FileManager(); CacheFile.OnReadReady += <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Action&lt;StreamReader&gt;(File_OnReadOpen); CacheFile.<span class="hljs-keyword"><span class="hljs-keyword">Read</span></span>(file_name); <span class="hljs-type"><span class="hljs-type">void</span></span> File_OnReadOpen(StreamReader Stream) { // <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> something <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> file stream }</code> </pre><br>  It would seem nothing complicated and special.  An additional level of abstraction has been added and the code has been moved to a separate library.  But now this code, which is already written and ready for use, can be easily applied to other projects! <br><br><h4>  Real example </h4><br>  For example, we will develop a currency rate informer that will update the data in XML format from a third-party server.  It is not interesting to just read XML and output data, so in addition the result will be cached locally, so that the exchange rate can be viewed without the Internet.  Of course, it will not be relevant, but it is better to show the last updated result, rather than just an empty line. <br><br>  I will not list all the files, as the project source code is available at <a href="http://exchangeexample.codeplex.com/">http://exchangeexample.codeplex.com</a> .  I will focus only on the key points where the library was used. <br><br>  So, the scheme is as follows: <br><ul><li>  read local file if it exists </li><li>  if there is a network, try to get updated data </li><li>  save the cache in a local file </li><li>  re-read the local file again to update the data on the screen </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Read local file</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">//    <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> LoadData() { //    FileManager CacheFile = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> FileManager(); //        CacheFile.OnReadReady += <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Action&lt;StreamReader&gt;(File_OnReadOpen); //     ,    CacheFile.OnReadFileMissing += <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Action(File_OnReadFileMissing); //     CacheFile.<span class="hljs-keyword"><span class="hljs-keyword">Read</span></span>(Common.Constants.ExchangeTmpFile); } //      <span class="hljs-type"><span class="hljs-type">void</span></span> File_OnReadFileMissing() { //       Deployment.<span class="hljs-keyword"><span class="hljs-keyword">Current</span></span>.Dispatcher.BeginInvoke( delegate { MessageBox.<span class="hljs-keyword"><span class="hljs-keyword">Show</span></span>("Local file missing, first time application start?", "FileManager OnReadFileMissing exception", MessageBoxButton.OK); }); } //        <span class="hljs-type"><span class="hljs-type">void</span></span> File_OnReadOpen(StreamReader Stream) { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (XmlReader XmlReader = XmlReader.<span class="hljs-keyword"><span class="hljs-keyword">Create</span></span>(Stream)) { //  <span class="hljs-type"><span class="hljs-type">XML</span></span>      XmlSerializer DataSerializer = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> XmlSerializer(typeof(RatesList)); _RatesList = (RatesList)DataSerializer.Deserialize(XmlReader); Rates = _RatesList.Collection; } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Update local file</b> <div class="spoiler_text"><pre> <code class="hljs haskell">//    public void <span class="hljs-type"><span class="hljs-type">UpdateData</span></span>() { //    <span class="hljs-type"><span class="hljs-type">LoadManager</span></span> <span class="hljs-type"><span class="hljs-type">DataLoader</span></span> = new <span class="hljs-type"><span class="hljs-type">LoadManager</span></span>(); //       <span class="hljs-type"><span class="hljs-type">DataLoader</span></span>.<span class="hljs-type"><span class="hljs-type">OnNoNetwork</span></span> += new <span class="hljs-type"><span class="hljs-type">Action</span></span>(<span class="hljs-type"><span class="hljs-type">DataLoader_OnNoNetwork</span></span>); //       <span class="hljs-type"><span class="hljs-type">DataLoader</span></span>.<span class="hljs-type"><span class="hljs-type">OnError</span></span> += new <span class="hljs-type"><span class="hljs-type">Action</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Exception</span></span>&gt;(<span class="hljs-type"><span class="hljs-type">DataLoader_OnError</span></span>); //        <span class="hljs-type"><span class="hljs-type">DataLoader</span></span>.<span class="hljs-type"><span class="hljs-type">OnStart</span></span> += new <span class="hljs-type"><span class="hljs-type">Action</span></span>(<span class="hljs-type"><span class="hljs-type">DataLoader_OnStart</span></span>); //         <span class="hljs-type"><span class="hljs-type">DataLoader</span></span>.<span class="hljs-type"><span class="hljs-type">OnLoad</span></span> += new <span class="hljs-type"><span class="hljs-type">Action</span></span>&lt;string&gt;(<span class="hljs-type"><span class="hljs-type">DataLoader_OnLoad</span></span>); //        <span class="hljs-type"><span class="hljs-type">DataLoader</span></span>.<span class="hljs-type"><span class="hljs-type">OnFinish</span></span> += new <span class="hljs-type"><span class="hljs-type">Action</span></span>(<span class="hljs-type"><span class="hljs-type">DataLoader_OnFinish</span></span>); //    ,       <span class="hljs-type"><span class="hljs-type">XML</span></span>  //  <span class="hljs-type"><span class="hljs-type">DataLoader</span></span>.<span class="hljs-type"><span class="hljs-type">OnSaveTo</span></span> += new <span class="hljs-type"><span class="hljs-type">Action</span></span>&lt;string&gt;(<span class="hljs-type"><span class="hljs-type">DataLoader_OnSaveTo</span></span>); //      <span class="hljs-type"><span class="hljs-type">DataLoader</span></span>.<span class="hljs-type"><span class="hljs-type">SaveTo</span></span> = <span class="hljs-type"><span class="hljs-type">Common</span></span>.<span class="hljs-type"><span class="hljs-type">Constants</span></span>.<span class="hljs-type"><span class="hljs-type">ExchangeTmpFile</span></span>; //    <span class="hljs-type"><span class="hljs-type">DataLoader</span></span>.<span class="hljs-type"><span class="hljs-type">Load</span></span>(<span class="hljs-type"><span class="hljs-type">Common</span></span>.<span class="hljs-type"><span class="hljs-type">Constants</span></span>.<span class="hljs-type"><span class="hljs-type">ExchangeApiUrl</span></span>); } //           //     //   ,     <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> is void <span class="hljs-type"><span class="hljs-type">DataLoader_OnSaveTo</span></span>(string <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">) { //     </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FileManager</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CacheFile</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FileManager</span></span></span><span class="hljs-class">(); //   (  )    </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CacheFile</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WriteBefore</span></span></span><span class="hljs-class"> = "&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Root</span></span></span><span class="hljs-class">&gt;"; //   (  )    </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CacheFile</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WriteAfter</span></span></span><span class="hljs-class"> = "&lt;/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Root</span></span></span><span class="hljs-class">&gt;"; //    ,    </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CacheFile</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Save</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Common</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Constants</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExchangeTmpFile</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">); } //      void </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataLoader_OnNoNetwork</span></span></span><span class="hljs-class">() { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Deployment</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Current</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dispatcher</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BeginInvoke</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">delegate</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MessageBox</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class">("</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">No</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">network</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">available</span></span></span><span class="hljs-class">.", "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LoadManager</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OnNoNetwork</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">exception</span></span></span><span class="hljs-class">", </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MessageBoxButton</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OK</span></span></span><span class="hljs-class">); }); } //     void </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataLoader_OnError</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Exception</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">e</span></span></span><span class="hljs-class">) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Deployment</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Current</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dispatcher</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BeginInvoke</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">delegate</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MessageBox</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">e</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Message</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LoadManager</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OnError</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">exception</span></span></span><span class="hljs-class">", </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MessageBoxButton</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OK</span></span></span><span class="hljs-class">); }); } //      void </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataLoader_OnStart</span></span></span><span class="hljs-class">() { //     </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IsProgressVisible</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">; //       </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IsDataLoaded</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; } //    ,      void </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataLoader_OnFinish</span></span></span><span class="hljs-class">() { //     </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IsProgressVisible</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; } //    ,        void </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataLoader_OnLoad</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Deployment</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Current</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dispatcher</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BeginInvoke</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">delegate</span></span></span><span class="hljs-class"> { //     </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LoadData</span></span></span><span class="hljs-class">(); //      </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LastUpdate</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DateTime</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Now</span></span></span><span class="hljs-class">; }); } catch (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Exception</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ex</span></span></span><span class="hljs-class">) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Deployment</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Current</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dispatcher</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BeginInvoke</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">delegate</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MessageBox</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ex</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Message</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LoadManager</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OnLoad</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">outer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">exception</span></span></span><span class="hljs-class">", </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MessageBoxButton</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OK</span></span></span><span class="hljs-class">); }); } }</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">We specify a context</b> <div class="spoiler_text"><pre> <code class="hljs cs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainPage</span></span> : <span class="hljs-title"><span class="hljs-title">PhoneApplicationPage</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MainPage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { InitializeComponent(); <span class="hljs-comment"><span class="hljs-comment">//     DataContext = App.MainViewModel; //     Loaded += new RoutedEventHandler(MainPage_Loaded); } //     void MainPage_Loaded(object sender, RoutedEventArgs e) { //    ,    UI Deployment.Current.Dispatcher.BeginInvoke( delegate { //    App.MainViewModel.UpdateData(); }); } }</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">XAML for binding and data output</b> <div class="spoiler_text"><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ContentPanel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"12,0,12,0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.RowDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"auto"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.RowDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemsSource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Rates}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox.ItemContainerStyle</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">TargetType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ListBoxItem"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Setter</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Property</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"HorizontalContentAlignment"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Value</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Stretch"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox.ItemContainerStyle</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox.ItemTemplate</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DataTemplate</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0,0,0,17"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextLargeStyle}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneAccentBrush}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Currency}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextLargeStyle}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneAccentBrush}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">HorizontalAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Stretch"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.ColumnDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ColumnDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ColumnDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.ColumnDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Column</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Buy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextNormalStyle}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Buy}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextLargeStyle}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UAH"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextLargeStyle}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Opacity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.5"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Column</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Sale"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextNormalStyle}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Sale}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextLargeStyle}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UAH"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextLargeStyle}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Opacity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.5"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DataTemplate</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox.ItemTemplate</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Horizontal"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0,12,0,0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Last update:"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextNormalStyle}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding LastUpdate}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextAccentStyle}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><br>  The result will look something like this: <br><img src="https://habrastorage.org/storage2/cd5/640/af8/cd5640af87af47e8c134b9e15668aaec.png" align="left">  It took much more time to write an article than on the test application itself :) <br><br>  Related Links: <br><ul><li>  <a href="http://ru.wikipedia.org/wiki/Don%25E2%2580%2599t_repeat_yourself">DRY</a> </li><li>  <a href="http://msdn.microsoft.com/en-us/library/vstudio/hh156513.aspx">Async / await</a> </li><li>  <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D9983">Visual Studio Async CTP for VS2010, including support for Async / Await</a> </li><li>  <a href="http://vb.codeplex.com/">Library source code</a> </li><li>  <a href="http://exchangeexample.codeplex.com/">Test Project Source Code</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/165521/">https://habr.com/ru/post/165521/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165511/index.html">The experience of obtaining a universal electronic card. Pink theory versus harsh reality. Part 1</a></li>
<li><a href="../165513/index.html">The digest of interesting news and materials from the world of PHP over the past two weeks, ‚Ññ8 (12.29.2012 - 01.01.2013)</a></li>
<li><a href="../165515/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ39 (January 5 - 11, 2013)</a></li>
<li><a href="../165517/index.html">Photoshop Scripting to automate the printing of large-circulation printing products</a></li>
<li><a href="../165519/index.html">Homemade X-ray CT scanner</a></li>
<li><a href="../165523/index.html">C ++ Development for BlackBerry 10 without using IDE (using OpenGL ES 2)</a></li>
<li><a href="../165525/index.html">We update iPhone through Linux, saving data and nerves</a></li>
<li><a href="../165527/index.html">How to listen to music from iTunes on Android devices. Step-by-step instruction</a></li>
<li><a href="../165531/index.html">Death Star is not needed when there is Curiosity</a></li>
<li><a href="../165533/index.html">Vulnerability in ICQ allows access to the archive of files transferred via the service.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>