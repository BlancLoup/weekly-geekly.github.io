<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SDK for Asterisk and 1C: Enterprise 8 communication</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For more than 3 years, we have tried to set up a competent integration of 1C: Enterprise 8 and a telephone PBX based on Asterisk for our office. For w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SDK for Asterisk and 1C: Enterprise 8 communication</h1><div class="post__text post__text-html js-mediator-article">  For more than 3 years, we have tried to set up a competent integration of 1C: Enterprise 8 and a telephone PBX based on Asterisk for our office.  For whatever decision we took, there were always some crutches.  This is very sad.  But there really wasn‚Äôt a normal integration solution on the market.  We tried different products, free and paid, having spent more than one ten thousand rubles, but there was no happiness. <br><a name="habracut"></a><br><h4>  Do you want to be done well - do it yourself </h4><br>  Actually, after another unsuccessful attempt, the idea to do everything from scratch on our own, captured our mind, all the more, the realization lay on the surface itself, it was necessary only to undertake and do it. <br>  We decided that it is best to create a universal solution that is not tied to a specific task on 1C.  We need a ‚Äútransparent proxy‚Äù from 1C to Asterisk and back, with the help of which, in the future, we will assemble our panel of telephony of dreams, about which we have been dreaming for 3 years. <br><br><h4>  NativeAPI technology </h4><br>  The 1C: Enterprise 8 platform allows the connection of external modules in the form of dynamic libraries, but there are special requirements for the libraries themselves.  According to the requirements of 1C, the library should be developed using NativeAPI technology. <br><br>  <i><b>The Native API technology</b> is a proprietary system programming interface 1C: Enterprise 8. It supports Windows and Linux operating systems, and allows you to create external components that work under one or under another operating system.</i>  <i>Components created by the Native API technology can be connected in a thick client, in a thin client, in a web client, in an external connection, and in an application server.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Because we, armed with the freshly bought Visual Studo 2010, began to dive into the creative programming process. <br><br><h4>  Asterisk AJAM Interface </h4><br>  For about a month, we studied various Asterisk interfacing technologies with external systems, experimented, measured performance, and eventually decided that ‚ÄúAsynchronous Javascript Asterisk Manger‚Äù was best for us.  AJAM as a transport uses the HTTP protocol, supports Digiest authentication and SSL encryption, which increases the security of the connection, and also allows the use of Asterisk, located in the cloud.  The answers transmitted by the Asterisk server can be represented as XML structures, which are very convenient to work with in 1C: Enterprise 8. <br><br><h4>  Asterisk and component documentation </h4><br>  On the Internet, you can find a lot of scattered knowledge about Asterisk, but in one place they are not, and we had to collect in parts a list of commands with a description of parameters, a list of answers.  Sometimes you had to read the Asterisk source code listings in order to understand how this or that command should look and what to pass in the parameters.  We decided that the development should be well documented so that all methods and functions were described in one place.  As a result, we got WIKI, into which we collected all the documentation for the Asterisk AMI protocol, and then, on the basis of this data, systematized the description of the internal functions of the developed component. <br><br><h4>  What happened </h4><br>  As it turned out, although the decision lay on the surface, the entire development and writing of documentation took more than 3 months of work of several highly qualified specialists. <br><br><img src="https://habrastorage.org/storage2/1fc/ae6/9cf/1fcae69cf655f76a4042dd73747e2450.png"><br><br>  As a result, after initializing the components in 1C, the whole range of AMI commands of Asterisk becomes available, if my memory serves me, then a total of 103 functions. <br>  For example, the origin of a call from 1C from SIP / 26 to city number 74952293042 looks like this: <br><br>  <i>Channel = "SIP / 26"</i> <i><br></i>  <i>Context = "from-internal";</i> <i><br></i>  <i>Exten = "74952293042";</i> <i><br></i>  <i>Priority = "1";</i> <i><br></i>  <i>Timeout = "";</i> <i><br></i>  <i>CallerID = "MIKO_Abonent";</i> <i><br></i>  <i>Variable = "";</i> <i><br></i>  <i>Account = "miko";</i> <i><br></i>  <i>Application = "";</i> <i><br></i>  <i>Data = "";</i> <i><br></i>  <i>Async = "1";</i> <i><br></i>  <i>ActionID = "114";</i> <i><br></i>  <i>Result = "";</i> <i><br><br></i>  <i>Component .Originate (Channel, Context, Exten, Priority, Timeout, CallerID, Variable, Account, Application, Data, Async, ActionID, Result)</i> <br><br>  During an active connection, the component calls external event handlers in 1C, so that we can catch the state of the channels, information about the calling number, the status of queues, and even manage the call routing in real time. <br><br><h4>  New level of interaction 1C and Asterisk </h4><br>  As a result, we moved to a new level of development of 1C business solutions integrated with Asterisk-based telephony.  Now the 1C developer can use all the available PBX functionality in the 1C: Enterprise 8 environment that is clear to him, and the solution functionality is limited only by his imagination. <br>  As a sample, based on the components, we developed the Asterisk Telephony Panel for 1C: CRM, which we use in our company, added client smart routing to the responsible manager using only 1C logic, taught the panel to save the conversation record in the Event document , worked out the mechanisms for transferring call history from Asterisk to 1C, as well as managing various call forwardings and calls directly from 1C: Enterprise 8. We got a rather convenient telephony panel, and after 3 years of throwing we created what we wanted from  Initially from third-party developers. <br><br><h4>  Commercial product and partner network </h4><br>  We liked to develop, describe, test the solution for the integration of 1C and Asterisk.  We decided not to stop and release our component as an SDK for 1C developers.  Engaged in product certification in the company 1C on the status of 1C: Compatible.  Developed agency and partner programs. <br><br><h4>  Demonstration of the component </h4><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/rAWlCoFJ1ic%3Ffeature%3Doembed&amp;xid=17259,1500001,15700023,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhijpE8zHHcJqogZL7NL227y1dUZJA" frameborder="0" allowfullscreen=""></iframe><br><br><h4>  Links to more detailed information </h4><br><ul><li>  <a href="http://wiki.miko.ru/doc:1cajam">General Description of the SDK</a> </li><li>  <a href="http://wiki.miko.ru/doc:1cajam:api">List of functions implemented in the SDK</a> </li><li>  <a href="http://v8.1c.ru/overview/Term_000000545.htm">Technology external components on 1C</a> </li><li>  <a href="http://ofps.oreilly.com/titles/9780596517342/asterisk-AMI.html">AMI protocol description (eng.)</a> </li></ul><br><br>  upd.  February 24, the SDK <a href="http://1c.ru/news/info.jsp%3Fid%3D14761">was certified for 1C: Compatible</a> .  As a result, we made the first 1C certified solution for integrating 1C and Asterisk. </div><p>Source: <a href="https://habr.com/ru/post/137999/">https://habr.com/ru/post/137999/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137988/index.html">Some news about Stanford University courses for 2012</a></li>
<li><a href="../137991/index.html">gem the_sortable_tree</a></li>
<li><a href="../137994/index.html">Tor has released an obfuscated proxy to disguise traffic in Iran</a></li>
<li><a href="../137995/index.html">New mono-brand HTC salons in Moscow and St. Petersburg</a></li>
<li><a href="../137998/index.html">US court decides whether it is possible to sell used MP3 files</a></li>
<li><a href="../138000/index.html">Trustwave recognizes issuing a third-party root certificate.</a></li>
<li><a href="../138003/index.html">25 services for productive work with Gmail</a></li>
<li><a href="../138004/index.html">WebKit and web standards</a></li>
<li><a href="../138005/index.html">VMware vSphere: Convert Virtual IDE Disk to SCSI</a></li>
<li><a href="../138006/index.html">Learn jQuery for 30 days</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>