<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Making the ProgressBar spin while the http request is coming</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started with the fact that I suddenly really wanted to do something under the android. And all this despite the fact that java is not my native...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Making the ProgressBar spin while the http request is coming</h1><div class="post__text post__text-html js-mediator-article">  It all started with the fact that I suddenly really wanted to do something under the android.  And all this despite the fact that java is not my native language. <br>  In the process of creating my application, I encountered several difficulties, the solution of which I want to tell.  I think they will be useful, just like me, to beginners, and I will be grateful for advice and more beautiful examples from the guru. <br>  But the main proof of the examples is that the application is working, you can <a href="http://ru.androlib.com/android.application.com-bullin-qjiAj.aspx">check</a> . <br><a name="habracut"></a><br>  Here are a few problems I encountered: <br><ul><li>  The UI waits for the server to respond, how to win?  (in this article) </li><li>  Sending and receiving data - in what format?  (in the next, if anyone is interested) </li><li>  How to work with the camera?  (also in the next, if anyone is interested) </li></ul><br>  Consider the first problem so far. <br><h4>  The UI waits for the server to respond, how to win? </h4><br>  Interaction with the server is the key moment of this application.  When an application sends a request to the server, it has to wait for a response.  During this wait, the user interface stops and it seems that the program is hanging.  Nestrachno, if the answer is received within a second, but in reality, waiting for a response from the server sometimes has about 10 seconds.  To inform the user that the application is not stuck, you need to show him the ProgressBar.  I stopped on a spinning wheel, as in AJAX.  Here's what it looks like: <br><img src="https://habrastorage.org/storage/808cae8f/81631b72/ded586e9/c91e0f33.png"><br><br>  I will describe approximately how it works.  I have a certain class HttpClient, he is responsible for interacting with the server.  He starts and stops the ProgressBar.  This class works asynchronously.  That is, the application, running it does not wait until it runs, and may continue its work.  This is achieved by the following construction: <br><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//   public class HttpClient extends AsyncTask&lt;Void, Integer, Long&gt;{ ... //   public ProgressDialog dialog; //    Context ctx; ... //  ProgressBar     protected void onPreExecute() { dialog = new ProgressDialog(ctx); dialog.setMessage("..."); dialog.setIndeterminate(true); dialog.setCancelable(true); dialog.show(); } //   , SendHttpPost() -    protected Long doInBackground(Void... params) { try { response = SendHttpPost(); } catch (Exception e) { e.printStackTrace(); response = null; } return null; } //      ,  ProgressBar protected void onPostExecute(Long unused) { dialog.dismiss(); ... //     ,    //     : ((Runnable)ctx).run(); .... super.onPostExecute(unused); } .... }</span></span></code> </pre> <br><br>  The parent class that calls the HttpClient looks like this: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchableActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Runnable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HttpClient req; ... <span class="hljs-comment"><span class="hljs-comment">//   ,       private void showResults(String query) { ... req = new HttpClient(); req.execute((Void)null); } //     HttpClient,        -    public void run() { ... //   req    ,    Activity ... } }</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The fact that I followed the Runnable path seems to me very controversial, but at that time there were no other thoughts. <br><br>  But I learned to download and show asynchronously pictures for this article: <a href="http://habrahabr.ru/blogs/android/78747/">habrahabr.ru/blogs/android/78747 I</a> use the moment to say thanks <a href="http://geektimes.ru/users/rude/" class="user_link">rude</a> ! </div><p>Source: <a href="https://habr.com/ru/post/107188/">https://habr.com/ru/post/107188/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../107181/index.html">MeeGo 1.1</a></li>
<li><a href="../107183/index.html">css Rotate. Possible in IE</a></li>
<li><a href="../107184/index.html">How payment systems are created: part one</a></li>
<li><a href="../107186/index.html">Queries to the Twitter API on SQL syntax</a></li>
<li><a href="../107187/index.html">Numbers from QIWI Wallet: 2010 vs 2009</a></li>
<li><a href="../107189/index.html">Canobuvosti, 63 edition</a></li>
<li><a href="../107190/index.html">Laptop transformer Acer Aspire 1425P</a></li>
<li><a href="../107191/index.html">Conference "Usability Ukraine '10"</a></li>
<li><a href="../107193/index.html">ASUS Online Services</a></li>
<li><a href="../107196/index.html">Honda P1 - great-grandfather Honda Asimo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>