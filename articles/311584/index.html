<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About hacking servers FirstVDS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not long ago, a note appeared with a story about a large number of compromised FirstVDS servers. We startled, conducted our own investigation without ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About hacking servers FirstVDS</h1><div class="post__text post__text-html js-mediator-article">  Not long ago, a <a href="https://geektimes.ru/post/280688/">note</a> appeared with a story about a large number of compromised FirstVDS servers.  We startled, conducted our own investigation without delay, and want to talk about its results. <br><a name="habracut"></a><br>  People are gambling, and some even too much.  They are joining the ranks of online casino customers.  In particular, the casino "Volcano".  As in all such institutions, there are very fond of new customers.  Therefore, Vulkan invites everyone to participate in their referral program: you are our clients, and we give you 5% of the earnings from them.  It attracts some people who are not too clean. <br><br>  True, they don‚Äôt turn around too widely, because since 2014, online casinos in Russia have been banned.  From the word at all.  And since 2015, their sites are being <s>shot</s> blocked without trial.  Therefore, methods of attracting customers are used far from clean.  For example, you can add specially trained viruses to virtual servers of online stores and quietly redirect their traffic to online casino sites. <br><br>  In the summer of this year, one of the clients sent us a letter in which he complained about hacking his server.  We <a href="https://nulled.in/threads/275824/page-3">found the victims</a> and sent them a message stating the fact of infection, explained how it happened and what to do about it.  Asked to upgrade.  ‚ÄúThe old horse will not spoil the furrow‚Äù - this is not about the software industry, here the old stuff can plow the whole field. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At this calmed down.  The fact is that we offer servers as is - with available software and without administration.  For example, once bought up machines with <a href="https://ru.wikipedia.org/wiki/FreeBSD">FreeBSD</a> 6 OS, <a href="https://ru.wikipedia.org/wiki/FreeBSD_Jail">FreeBSD Jail</a> virtualization <a href="https://ru.wikipedia.org/wiki/FreeBSD_Jail">system</a> and <a href="https://ru.wikipedia.org/wiki/ISPmanager">ISPmanager</a> 4.x web hosting control panel.  We believe that customers know better than us what they really need.  This includes whether they want to update the OS and other software that is installed on the server.  Quite a few of our customers do not rush to update.  What hackers took advantage of - through the holes of the old software, they hooked the virus, which directs the traffic not to the right place. <br><br>  The same thing happened with the author of the article, which became the reason for this story.  Having discovered the virus cli.php, which supplies the traffic to the online casino "Vulkan", he wondered if he was not alone in his misfortune.  It turned out not.  So there was news about 3000 hacked sites on 1000 servers.  The 0x31.ru domain acted as the virus coordinator, the owner of which received unearned income from the casino's referral program. <br><br>  Naturally, we could not pass by such news, and conducted their investigation. <br><br><ul><li>  Analyzed servers with old OS: FreeBSD 6, FreeBSD 8, CentOS 5 and so on. </li><li>  Connect to the servers to which you can connect (some clients close access to their servers by IP). </li><li>  Found on these servers, the file of the malware cli.php. </li><li>  We compared the date of creation and the date of modification of this file (in 99% of cases they coincided).  Took this value for the date of hacking. </li><li>  For each file, MD5 checksum was calculated.  Grouped by checksums. </li></ul><br>  Any owner of VDS can independently check its server: <br><br>  Freebsd: <code>find /home -name .cli.php</code> <br>  Linux: <code>find /var/www -name .cli.php</code> <br><br>  Everything turned out to be like that joke: "horror, of course, but not horror-horror."  We managed to identify the domains that control malware (this includes the above 0x31.ru).  We also found 7 checksums of the file cli.php, which are distributed as follows: <br><br><table><tbody><tr><th>  Check sum </th><th>  Number of infected sites </th><th>  Share of total </th></tr><tr><td>  MD5 1 </td><td>  644 </td><td>  33.82% </td></tr><tr><td>  MD5 2 </td><td>  732 </td><td>  38.45% </td></tr><tr><td>  MD5 3 </td><td>  2 </td><td>  0.1% </td></tr><tr><td>  MD5 4 </td><td>  one </td><td>  0.05% </td></tr><tr><td>  MD5 5 </td><td>  69 </td><td>  3.62% </td></tr><tr><td>  MD5 6 </td><td>  2 </td><td>  0.1% </td></tr><tr><td>  MD5 7 </td><td>  454 </td><td>  23.85% </td></tr></tbody></table><br>  The total number of infected sites is 1904. <br><br>  Next, we sorted all found versions of cli.php by the date of infection: <br><br><table><tbody><tr><th>  Year </th><th>  Share of total </th></tr><tr><td>  2009 </td><td>  0.45% </td></tr><tr><td>  2010 </td><td>  2.59% </td></tr><tr><td>  2011 </td><td>  4.22% </td></tr><tr><td>  2012 </td><td>  14.89% </td></tr><tr><td>  2013 </td><td>  13.39% </td></tr><tr><td>  2014 </td><td>  5.94% </td></tr><tr><td>  2015 </td><td>  6.8% </td></tr><tr><td>  2016 </td><td>  51.7% </td></tr></tbody></table><br>  The fact that this year accounts for half of all infections is easy to explain: these are statistics as of "today", and since 2009, the owners of the servers have managed to update the software and remove the malware.  In addition, new customers are constantly needed by everyone, including the casino, so the virus does not have time to become covered with dust - the tool is in demand, it does not lodge.  Although even if cli.php is located on the server, it‚Äôs still not a fact that it is still infected.  <b>Was</b> infected - yes.  And if the owner of VDS has updated the software and closed the vulnerabilities, then the malware has stopped working. <br><br>  After this story, we took the initiative and updated all users of ISPmanager 4.x to the latest version in this thread.  It no longer has the aforementioned vulnerability. <br><br>  But we‚Äôll remind everyone again: update the software on the servers more often.  They deserve it. <br><br><img src="https://habrastorage.org/files/046/fe1/9f5/046fe19f542f490ebaa7e1a7f4ed1193.png"></div><p>Source: <a href="https://habr.com/ru/post/311584/">https://habr.com/ru/post/311584/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311574/index.html">Techleads Meetup in Badoo</a></li>
<li><a href="../311576/index.html">The history of creating an application for finding nannies in Ireland and an electronic waiter</a></li>
<li><a href="../311578/index.html">Processing voice requests in Telegram using Yandex SpeechKit Cloud</a></li>
<li><a href="../311580/index.html">New management features: Intel RealSense and GestureWorks Fusion</a></li>
<li><a href="../311582/index.html">Twelve Useful Chrome DevTools Tips</a></li>
<li><a href="../311586/index.html">Restrictions (—Åonstraints) PostgreSQL: exclude, partial unique, pending restrictions, etc.</a></li>
<li><a href="../311588/index.html">What to do so that the organizer of the conference wants you</a></li>
<li><a href="../311590/index.html">Dependency Injection with Scala validation using language tools</a></li>
<li><a href="../311592/index.html">Chat bots, and how will Microsoft help us with this?</a></li>
<li><a href="../311594/index.html">Keeping up with the times: Using JWT in ASP.NET Core</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>