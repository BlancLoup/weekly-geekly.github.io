<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Forensic examination of computers infected with TDL4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started with the fact that at the beginning of last summer we had a number of tasks related to the quick extraction of the hidden container of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Forensic examination of computers infected with TDL4</h1><div class="post__text post__text-html js-mediator-article">  It all started with the fact that at the beginning of last summer we had a number of tasks related to the quick extraction of the hidden container of the Win32 / Olmarik rootkit file system, then still in the TDL3 version.  After a bit of thought, we developed the first version of the TdlFsReader utility, which handles TDL3 and TDL3 +.  After some time, it was published in the public domain and helped a lot in the tasks of forensic examinations.  However, at the end of the summer, the fourth version of this rootkit appeared, which already had fundamental differences in the file system: now it looked more like a full-fledged file system. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/481/9db/128/4819db128b23322ccb3b45c338119cba.jpg" alt="image"><a name="habracut"></a><br><br>  And we delved into the study of the new version of the rootkit, because it was fundamentally different from the previous one.  After some time, the internal version of TdlFsReader was updated.  And last month we had the opportunity to speak at the wonderful <a href="http://2011.confidence.org.pl/agenda">CONFidence'2011</a> conference in Krakow, where the report ‚Äú <a href="http://www.slideshare.net/matrosov/defeating-x64-the-evolution-of-the-tdl-rootkit">Defeating x64: The Evolution of the TDL Rootkit</a> ‚Äù was presented and within which a new version of TdlFsReader was presented (hxxp: //eset.ru/tools /TdlFsReader.exe). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, now we will tell you more about the tool itself.  Actually, the new version is able to cope with all known modifications at the time of publication.  And this is TDL3 / 3 + / 4, and it copes not only with x86 versions, but also x64. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/701/b26/aa3/701b26aa32aaf3df7c4424549d8511f2.png" alt="image"><br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/iRpp6vn2DAE%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhjmdVUJyUEmN1utMGRmS3tvUOoEBw" frameborder="0" allowfullscreen=""></iframe><br><br>  Now, a little about the TdlFsReader architecture, in fact, it is divided into two parts, the one in the kernel and the one that is not :) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/086/86d/e97/08686de97de3c84d3fb603b7b102d01c.png" alt="image"><br><br>  The main point is to determine the version of the rootkit, remove the mechanisms that counteract the analysis, and only then gain access to the file system and parse it. <br><br>  Well, as a bonus, another video with debugging the bootkit code in TDL4, which, in fact, bypasses the digital signature verification in the drivers for x64 systems. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/sT6N7Dr-G6s%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhhmvmcfNv1TvRx1PgbmDEGF6hHpHA" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/120569/">https://habr.com/ru/post/120569/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../120562/index.html">"It looks like." How perceptual hash works</a></li>
<li><a href="../120564/index.html">PaymentGate is a payment solution from Paysto that allows you to fully automate payments to any number of recipients</a></li>
<li><a href="../120566/index.html">Restrict editing interface using proxy models</a></li>
<li><a href="../120567/index.html">Appeal to the Minister of Communications on the division of responsibility of the owners of Internet resources and their visitors</a></li>
<li><a href="../120568/index.html">Writing programs for AVR microcontrollers in Code :: Blocks 10.5 environment</a></li>
<li><a href="../120570/index.html">Visual demonstration of machine learning algorithms</a></li>
<li><a href="../120572/index.html">Skype 2.2.0.35 released</a></li>
<li><a href="../120575/index.html">PowerShell + Hyper-V</a></li>
<li><a href="../120576/index.html">Three models of Asus netbooks with Ubuntu preinstalled</a></li>
<li><a href="../120577/index.html">Another version of the image comparison algorithm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>