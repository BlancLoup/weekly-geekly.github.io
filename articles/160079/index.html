<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis of the agglomeration of associated systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Suppose you do molecular modeling. You have bulky path files in your hands, which would be nice to analyze how. Consider (and below will be discussed,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analysis of the agglomeration of associated systems</h1><div class="post__text post__text-html js-mediator-article">  Suppose you do molecular modeling.  You have bulky path files in your hands, which would be nice to analyze how.  Consider (and below will be discussed, mainly about this system), for example, methanol.  We can, for example, build a radial distribution function (RDF), as is done in almost every such article.  But, recalling that in methanol there is a specific agglomeration - hydrogen bonds - we may <i>suddenly</i> want to see, but how does it look there in reality.  See how the agglomerates look (maybe even compare their topology), how they are distributed according to size or whatever you want.  Actually, below I propose one of the options for implementing such a program. <br><a name="habracut"></a><br><h4>  A bit of theory </h4><br>  The first is that it doesn‚Äôt matter what method you got the file paths - even QM, even MM, even if it‚Äôs a hybrid.  The important thing is that you need to know the exact coordinates of the atoms.  It does not even matter that it was a trajectory - you can use one snapshot of the trajectory, but statistics will suffer from this and, as a result, the results may be incorrect. <br><br>  We now turn to the question of the definition of a hydrogen bond.  It is proposed to determine the presence (or absence) of the hydrogen bond in several possible ways (as well as their combinations), for example: <br><ul><li>  The distances between the oxygen atoms of different molecules and the hydrogen atom and the oxygen atom of another molecule must be less than the reference values. </li><li>  The distances between the oxygen atoms of different molecules and the HOO angle should be less than the reference values. </li><li>  Energy criterion </li></ul>  The latter criterion is not very convenient, due to the fact that, firstly, it is much more resource-intensive, secondly, it is difficult to determine the reference value of energy, and thirdly, additional data are required (if, for example, their interaction is considered as van two-parameters for each atom (the position of the minimum on the potential energy surface and its depth). The first and second criteria are equivalent - the OHO triangle can be defined as three sides (first criterion), so on  mind sides and the angle between them (second) - it should be noted that the intramolecular OH bond is given according to the condition of the problem.Further, I will use only the first criterion because of its convenience and clarity. <br><br><h4>  And what do we need to take into account? </h4><br>  As it is known, modern resources do not allow modeling of bulky systems (a la unit cell containing 1 mole of molecules), therefore it is necessary to use <i>periodic boundary conditions</i> .  A real infinite system is replaced by a set of identical finite systems, each of which is located in a spatial cell surrounded on all sides by identical cells, and the molecules in one cell interact with the molecules in the neighboring ones.  In reality, for such an analysis, it is not at all necessary for us to translate a cell in all directions, increasing the calculated space by 27 times (instead of one cell, we get 3 ^ 3 = 27).  You can limit the broadcast to half the ribs in each direction.  It is easy to show that in this case we will increase the calculated space just 8 times.  At the same time, we can explicitly translate, scoring new coordinates into variables, or simply ‚Äúbear in mind‚Äù the possibility of translation when analyzing.  The first version is implemented in my program.  In this case, by the way, it should <i>be borne in</i> mind that the <i>bond with the molecule in the translated cell must be transferred to the molecule in the original cell</i> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The second question we can face is - what if we have a molecule with two functional groups?  For example, for hydrogen bonds - ethanediol.  Or even more fun - water.  I propose to consider this possibility by introducing an additional label - the number of the molecule.  That is, to operate not with separate groups, but with molecules at once. <br><br>  The third problem is that such agglomeration can be observed not only in a system with OH groups, but also, for example, in chlorobenzene.  I will not go into details of what, how and why, I will only note that a similar association is analogous to micelle formation in colloidal systems.  In this case, we can analyze the chlorine-chlorine distances to determine whether the molecules are bound to associate. <br><br><h4>  Implementation </h4><br>  I will make a couple of comments right away.  The programmer out of my curve is a little more than full, because something can certainly be done better.  At first I thought to bring a block diagram, but it turned out to be some kind of too cumbersome. <br><br>  Initial data: <br><ul><li>  The coordinates of the atoms of interest to us (including those that have been translated), in the example with methanol, the oxygen atom and the associated hydrogen </li><li>  An array of tags indicating which molecule some functional group belongs to. </li><li>  2 parameters - reference intermolecular distances OH and OO </li></ul><br>  Algorithm to search for related molecules: <br><ol><li>  Two nested loops with iteration over all molecules (including those translated), the second loop, naturally, begins with the next molecule (why should we take the same thing two times into account?). </li><li>  We consider the distance between the oxygen atoms. For all groups in the molecules, we find the minimum among them.  Check with the reference.  If less, then go ahead. </li><li>  Implementation of the previous step, but for oxygen and hydrogen atoms.  That is, we consider all possible (if on one oxygen, for example, two hydrogen - as in water) the distance between the oxygen atoms of the first molecule (determined at the previous step) and the hydrogen of the second molecule (associated with oxygen, determined at the previous step), we find the minimum.  Check with the reference.  If less, then go ahead.  If more, then first check the reverse option - the distance between the hydrogen atoms of the first molecule and the oxygen of the second molecule.  If less, then go ahead, more - go to the next molecules. </li><li>  We write down that these molecules are connected (if necessary, and the length of the bonds, too), proceed to the following.  In this case, all connections with the translated molecules are written on the molecules that are in the original cell. </li></ol>  For the case of monatomic interaction, for example, in chlorobenzene, paragraph 3 is simply discarded. <br><br>  Algorithm output: <br><ol><li>  We put a binary label for each molecule in the original cell (that is, without being translated) in True.  A loop iterated over molecules in the original cell. </li><li>  We take the first molecule with the label True, put it the label False.  We write it into an array of agglomerates, then we write down there all the molecules that have the label True and are associated with it, assigning False to them.  Continue until <s>blue</s> until new connections. </li><li>  Repeat the previous paragraph, until all molecules will not stand False mark. </li></ol><br>  Then write out the arrays of agglomerates in any convenient form.  At the end we add a block with general statistics (averaged over all points of the trajectory).  You can additionally add statistics of bonds between, say, oxygen atoms. <br><br><h4>  And what else to add? </h4><br>  The first is cross-analysis for the presence or absence of cycles in the associate.  Without going into the evidence, I note that.  if a molecule associated with one molecule is assigned a weight of 0, with two -1, etc., and then calculate the total weight of the graph (associate), then you can determine the number of cycles in the graph: <br><ul><li>  If the weight P of the graph is N-2, where N is the number of vertices of the graph (molecules in the agglomerate), then the graph has no cycles and has either a branched or linear structure </li><li>  If the weight of the P graph is greater than N-2, then the graph has cycles in the amount of (PN) / 2 + 1 </li></ul><br><br>  The second is much more fun.  There are original articles - <a href="http://arxiv.org/abs/math/0205220">here</a> and <a href="http://www.csid.omsu.omskreg.ru/docs/publications/prolubnikov%2520shirokov%2520graph%2520isomorphism.doc">here</a> .  The point is that if we have two graphs, then we can compare whether they are isomorphic (in the sense of the same ¬± permutations) and determine the permutation from which one graph is obtained from the other.  True, if my memory serves me, in these articles there were typos in the algorithms themselves, be careful. <br>  With reference to our system, we can create a database of main graphs and check the resulting associates for compliance with a specific graph.  Also, you can hold and statistics. <br>  Unfortunately, I did not implement this block.  There is only a program that checks two isomorphism graphs. <br><br>  Well, the third.  Analysis of a single molecule is the dynamics of its location in various agglomerates throughout the entire trajectory. <br><br><h4>  In addition </h4><br>  Source codes of programs can be taken <a href="https://github.com/arcan1s/moldyn">by reference</a> .  Everything is implemented on C. Unfortunately, there are no comments in the code. <br>  The STAT_GEN program works with the format of files similar to TINKER's trajectory files with one exception - there is no block corresponding to the connection of different atoms with each other, and a column indicating the number of the molecule is added. <br>  The AGL program pulls out separate agglomerates from trajectory files and writes them into the PDB format. <br>  The graph program analyzes the isomorphism of graphs. <br>  Unfortunately, the performance of these programs on Windows after the transfer to LInux (originally written under Windows, because there is, for example, the library conio.h) was not checked, so I don‚Äôt know what it is and how. <br><br>  At the exit, you can get something like this image (from one of my presentations): <br><img src="https://habrastorage.org/storage2/2cc/d4b/b33/2ccd4bb33219a50199fd74debce6e69b.png"><br>  Or another structure, in the form of a graph: <br><img src="https://habrastorage.org/storage2/c2d/ff4/f1b/c2dff4f1b26c75b0930edab47d9e9bc9.png"><br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/160079/">https://habr.com/ru/post/160079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../160069/index.html">WSUS update approvals: import, export, copy</a></li>
<li><a href="../16007/index.html">Simus.habrahabr.ya.ru</a></li>
<li><a href="../160071/index.html">Marketing roles in IT companies</a></li>
<li><a href="../160075/index.html">Amateur video camera</a></li>
<li><a href="../160077/index.html">Search for a Hamiltonian cycle in a large graph (traveling salesman problem). Part 1</a></li>
<li><a href="../16008/index.html">Bad habit</a></li>
<li><a href="../160081/index.html">OpenStreetMap switches to Leaflet instead of OpenLayers</a></li>
<li><a href="../160083/index.html">The correct translation or how was the localization of the series "Stage"</a></li>
<li><a href="../160085/index.html">Groovy Validation DSL</a></li>
<li><a href="../160087/index.html">How to distribute iOS applications bypassing the AppStore</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>