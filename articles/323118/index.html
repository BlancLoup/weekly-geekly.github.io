<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We put networks - we catch robots</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started as usual - with suspicion. It hurts a lot of people come to my sites that download application distributions for direct links without r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We put networks - we catch robots</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/562/963/7ef/5629637efcc046d88928a6cd78401e7d.gif"><br><br>  It all started as usual - with suspicion.  It hurts a lot of people come to my sites that download application distributions for direct links without referrers.  It is somehow strange, right?  Link blockers cannot be so popular.  I noticed some addresses and users usually came again to download without a link.  Often, another program - not related to the first.  Then we went to the course of checking that yes as in the logs.  It turned out that the absolute majority of such visits are strange users who have empty HTTP_ACCEPT_ENCODING and HTTP_ACCEPT_LANGUAGE.  HTTP_USER_AGENT sometimes points to java, javascript, wget, perl, php and so on, but most are normal browser strings.  All more or less decent search engines for me have long been taken into account and this, of course, is not them. <br><a name="habracut"></a><br>  Then it became even more interesting - what is it.  That is, it is clear that these are robots, but why?  Why come once a day - two - a week and pump all distributions of completely different directions?  Even the minimum answer has not yet been.  But after watching logs for a long time, I began to notice that there are often almost identical IPs - that is, from the same subnet, and therefore sorting by the number of hits from one IP shows nothing interesting except in clinical cases.  I had to look for a log analyzer with the ability to group by subnets.  And not finding anything at once, I wrote my bicycle, as usual. <br><br>  And what did I find interesting?  Well, not a lot of interesting things and unfortunately 90% of robots are not identified at all.  There are a lot of security companies that check web pages (and files themselves) for the security of their anti-virus products (Kaspersky, simantek, infosek, infatch, bitdefender ...) - but these are not the main ones, they are noticeable only by periodicity.  The largest number of robots in the networks of the French cloud provider OVH, in the Asian subnets of Amazon, by itself in HETZNER, just somewhere in China, in the Digital ocean cloud and more and more in the Alibaba cloud.  Why - I did not understand.  But it is clear why many in the clouds - because the incoming traffic there is free.  And Amazon, for example, says so - come to <a href="https://aws.amazon.com/ru/blogs/aws/aws-price-reductions/">us and launch the web of robots</a> .  There are also many hole seekers in popular CMS.  Requests to wp-login.php I already have for a thousand per day.  By the way, requesting it can be immediately recorded in robots. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The question arises, what to do with them?  Well, you can do nothing.  Traffic is cheap now, servers too.  And it is possible to block directly with subnets - it‚Äôs still practically impossible to see living visitors from there.  Yes, and outgoing traffic in the clouds paid, albeit a penny.  And most importantly for me - they spoil the statistics, which is harder to analyze because of them. <br><br>  In general, I post <a href="https://github.com/crea7or/NeuroLog">a log analyzer that</a> collects statistics on subnetworks - suddenly someone will be able to find something more interesting.  I did not find the answers. <br><br>  Here are the <a href="https://github.com/crea7or/NeuroLog">source code of the analyzer</a> (C ++, STL).  Do not be afraid that it is under Windows - the analyzer's core is decoupled from the interface and there are even two types of project - the console version and the GUI.  For porting to other platforms while STL from C ++ 11 is not enough, for good, filesystems from C ++ 17 are needed to make it 100% portable.  On the other hand, only one function needs to be replaced - traverse the directory. <br><br>  The analyzer understands files with subnet data from the official NIC (Network Information Center) regions (there <a href="https://github.com/crea7or/NeuroLog">are</a> links on the <a href="https://github.com/crea7or/NeuroLog">githaba</a> ) or more accurate (but crooked) <a href="https://db-ip.com/db/">db-ip.com</a> (there often CIDR is not parsed normally).  To work, you need three folders where the logs are located, where the subnet files are located (to build the base of subnets) and where to put the compiled base with subnets (well, not to parse each time) and report.  For after analysis, an html report is generated with subnets sorted by the number of hits and the volume downloaded.  By clicking on the address in the report, a third-party service opens, showing the owner of the subnet.  There actually all information is scooped.  On the grid, a list of specific addresses from the subnet (and also sorted) is opened. <br><br>  The report looks like this: <br><br><img src="https://habrastorage.org/files/fe8/894/7dd/fe88947dded14d60a4c6d95ec19162cf.png"><br><br>  If you have a lot of visitors, put at once large limits on inclusion in the report.  There is a minimum number of hits from the subnet and the minimum amount of traffic. <br><br>  ps.  If you don‚Äôt want to build it yourself, it‚Äôs compiled <a href="">under Windows</a> . </div><p>Source: <a href="https://habr.com/ru/post/323118/">https://habr.com/ru/post/323118/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323108/index.html">Two providers simultaneously or Dual ISP with VRF on Cisco | Part 2</a></li>
<li><a href="../323110/index.html">Protect a remote terminal server or two-factor authentication of RDG clients using Azure MFA</a></li>
<li><a href="../323112/index.html">OSSEC note on configuring parsers (decoders)</a></li>
<li><a href="../323114/index.html">Quadstor - a virtual SAN for state employees</a></li>
<li><a href="../323116/index.html">Solving Winter CrackMe Problems</a></li>
<li><a href="../323120/index.html">Rust game development. My history</a></li>
<li><a href="../323122/index.html">"The Cure for the Disease": automatic programming</a></li>
<li><a href="../323124/index.html">We make internal development as a software asset in five steps</a></li>
<li><a href="../323128/index.html">Explanation of the blockchain for web developers</a></li>
<li><a href="../323130/index.html">How IT professionals work. Ilya Vislotsky, Director of Client Solutions Architecture Center, Stack Group</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>