<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Meet Windows Machine Learning - WinML</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artificial intelligence and machine learning are two high-end trends of recent years. The required for AI & ML computational volumes are usually perfo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Meet Windows Machine Learning - WinML</h1><div class="post__text post__text-html js-mediator-article">  Artificial intelligence and machine learning are two high-end trends of recent years.  The required for AI &amp; ML computational volumes are usually performed in data centers on special high-performance and energy-efficient equipment (for example, servers with TPU).  Evolution is cyclical, and the pendulum swings back, toward computing on peripheral devices such as PCs, tablets, and IoT.  In particular, this will lead to an increase in the speed of response of devices to voice commands and increase the comfort of communication with personal assistants. <br><br><img src="https://habrastorage.org/webt/ut/92/vo/ut92vowxkimebpag40mxac44cde.jpeg"><br><br>  WinML is a new set of APIs that will allow developers to use all the capabilities of any Windows 10 device to calculate pre-trained machine learning models loaded into the application in the Open Neural Network Exchange (ONNX) format. <br><a name="habracut"></a><br>  Following its long-standing and win-win tradition (but we remember WinPhone), Microsoft followed Apple's <a href="https://habrahabr.ru/company/mobileup/blog/332500/">CoreML</a> for iOS and TensorFlow Lite / Neural Networks API for Android 8.1 for developers to publish a high-level WinML API that runs on top of DirectML.  This layer can use DirectX 12 or directly access computing devices (CPU / VPU / GPU). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The essence of the development is to transfer the prepared machine learning models from the cloud or specialized packages (for example, Anaconda, Microsoft Cognitive Toolkit, TensorFlow) to UWP applications and classic Windows applications (WPF / WinForms / ConsoleApp) to Windows 10. In addition, the model can be obtained using the Azure Machine Learning Workbench, and in the near future, the Azure Custom Vision Service will also support the creation of ONNX models for Windows.  The WinML API will be available for all editions of Windows 10. <br><br>  This is a solution that Windows developers have been waiting for.  Microsoft has created a comfortable ecosystem.  The challenge for competing ecosystems is to drag users and developers into their ecosystems.  There is even a radical opinion that you need to forget about Windows when it comes to machine learning.  Microsoft is aware of this and taking the next step, hopes to break through to a new market and defeat the skeptics. <br><br>  At the heart of the model exchange technology between model-teaching tools and applications that use them is the ONNX project, supported by major technology giants - Microsoft, Facebook and Amazon.  Developers can convert PyTorch, Caffe2 and other models to ONNX format and then integrate them into their applications.  In this case, the developer of the final application, it is not necessary to be an experienced machine learning specialist.  Only you need to understand that the model is a function, to the input of which you need to submit a prepared data set and interpret the response received. <br><br>  And, at first, the ONNX format was seen by me for storing only neural network models.  On <a href="http://onnx.ai/">the</a> project <a href="http://onnx.ai/">site</a> it is written: ONNX is a open format to represent <b>deep learning models</b> .  Yes, and in the name of the Open <b>Neural Network</b> Exchange.  But the published WinML documentation describes an example of transferring the Support Vector Machine model ( <a href="https://habrahabr.ru/post/105220/">support vector</a> machine) to ONNX using the WinMLTools package.  SVM belongs to the family of linear classifiers and, in principle, can be mapped into a neural network model.  What other models can be unloaded in ONNX has not yet looked.  It can be assumed that it is still possible to unload logistic regression models (in fact one neuron) or even linear regression (a neuron without an activation function).  My first experience of creating the simplest MLP model in CNTK (Microsoft Cognitve Toolkit) with unloading into ONNX failed.  The selected hyper parameters could not be converted to the current format implementation.  Compatibility issue.  But it was version CNTK 2.3.1.  A week ago, CNTK 2.5 was released.  In the new versions they write about improving support for ONNX. <br><br>  ML was available on .Net and earlier, through alternative libraries.  For example, the Open Source project Accord.Net.  The usefulness of WinML is that it offers a certain standard, which, on the one hand, allows you to get models from popular packages, and on the other, run models on various hardware. <br><br>  In his presentation, Microsoft said about the rapid calculation of loaded models on various platforms due to the layer DirectML.  For developers, optimizing computing for a zoo of hardware and software platforms is a titanic, sometimes overwhelming work.  As conceived by Microsoft, applications can work not only on the desktop, but also on the Xbox, Hololens, and even IoT. <br><br>  Hardware can be involved specialized cores / modules on CPU / GPU Intel, AMD, Qualcomm, NVidia.  Have a video card?  The model will work on it.  There is no video card, but there is Intel - the model will work on AVX256 or even AVX512 vector instructions.  Integrated graphics may be involved.  There is not enough computing power on the IoT device - connect the <a href="https://geektimes.ru/company/intel/blog/291301/">Intel Movidius VPU</a> .  All this is possible thanks to the technology of automatic dynamic compilation of the computational model for the existing equipment. <br><br>  The developer does not need to worry about what equipment is available to the application.  The WinML engine will dynamically use the hardware and create the necessary native code to get the maximum performance from any hardware available on the device.  Even more impressive is the ability to work WinML even on new laptops and tablets running the SnapDragon 835 or even on IoT devices.  Thus, all the available additional computing power can be used, and if they are not available, only a CPU will be sufficient for the calculations. <br><br>  With the spring upgrade, developers can use the WinML platform across the entire Windows device family, from IoT devices, to workstations, servers, and data centers.  WinML preview supports FP32 calculations.  They promise that the final version will support FP16.  Today, this is irrelevant, but with the advent of the Volta GPU, this will make it possible to achieve significantly higher performance on FP16 tensor cores (for some specially trained models).  Microsoft has already demonstrated an acceleration of 8 times. <br><br>  As a result, developers get a number of advantages: <br><br>  <b>Low latency</b> , real-time results.  Windows can compute a model using PC resources, allowing large local data, such as images and video, to be analyzed on the fly.  Calculation results can be obtained quickly and without delay. <br><br>  <b>Reduced operating costs,</b> due to the unloading of models from the cloud to users' devices.  Substantial savings can be achieved by reducing or eliminating the cost of transferring data between the network analytics service and the client.  Running the ML-model on the client side allows you to process requests locally, and small new data for additional training of the model can be sent to the service. <br><br>  <b>Flexibility.</b>  Developers can choose where to run the calculations, locally or in the cloud.  Client policy may prohibit the sending of sensitive data to the network, or, on the contrary, may require network computing to reduce the time for obtaining the result, which is important for large models and low-power devices. <br><br><h2>  Getting Started with Windows Machine Learning </h2><br>  To use the technology will need to update the software.  Starting with Visual Studio Preview 15.7, adding an ONNX file to a project. UWP will automatically add the necessary interfaces to the developer project.  Note that this is a preview.  In addition, the required version of Windows 10 today is only available on the program Insider Preview.  For previous versions of Visual Studio, developers can use the MLGen tool to create the desired interface, and then manually add it to their projects.  This feature will soon be available for the Visual Studio tools for AI tool. <br><br>  The Windows ML API documentation was published on March 7th.  At the same time, Windows Developer Day March 2018 was held. The video was posted on YouTube on the Windows Developer channel. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/D6YAJxFsmuM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  For those who are already working with machine learning, the benefits of the standard library are clear.  And for those who are not yet in the subject I will briefly describe what can be obtained with ready-made ML-models in their applications. <br><br>  As mentioned above, the ML model is a function whose input is a vector of a fixed (parameterized entity description) or variable length (sound / spectrogram, video sequence) and the output is a response vector, which can be interpreted as assigning the input vector to a certain class or classes (problems of classification, clustering) with some degree of likelihood (probability), as well as some calculated parameters of the input vector (regression problem).  This is in the simplest case.  More complex applications in this article will not be considered. <br><br>  As an example, Microsoft has posted on GitHub a well-known example of <a href="https://habrahabr.ru/company/wunderfund/blog/314242/">MNIST</a> .  The model can be connected to your program and further recognize the numbers drawn with a finger on the touchscreen.  However, a similar and even richer functionality has long been implemented in the API Handwriting Recognition. <br><br><h2>  Consider these tasks on the example of GameDev. </h2><br>  As an input vector there can be a certain image or a representation of a certain situation (game).  An image can describe a series of user actions or what he sees, on the basis of which he acts.  The model can predict user actions and design a new environment based on them. <br><br>  You can customize the game world for the player, offering him more tasks and more gifts, quickly adjusting to his preferences.  If the player likes to find treasures in the game and does not like to participate in battles, the model can add more treasures and reduce the complexity of the battles. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/LW20UbquVBU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i>reinforcement and imitation training models can contribute to gaming experience</i> <br><br>  The image can be a description of the environment for the bot, and its actions will be the result of calculating the model.  It can be complicated graphics, for example, drawing emotions or plausible articulation on an audio file. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZtP3gl_2kBM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  A rather difficult task is the calculation of the plausible dynamics of the movement of the character's limbs. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Ul0Gilv5wvY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Last year, SIGGRAPH 2017 introduced the ML model for calculating fluid dynamics without direct modeling of hydrodynamics, which significantly reduces the amount of computation. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/55rsJI11FOA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  If you turn on the imagination, you can use models for procedural generation of textures, by transferring the style (similar to <a href="https://habrahabr.ru/post/123238/">Prisma</a> ).  Similarly, you can create landscapes, architecture and other entities. <br><br>  As I see it, it is quite possible to form a market for trained models (bots) of game characters, similar to the main character of the game Moss.  First of all, with the developed dynamics of the skeleton / shell.  Suppose we enter the input conditions (speed / state, gender / steps coordinates, vector of emotions, actions / goals) to the input of the ML-model, and at the output we get the following state.  From these frames, you can collect related 3D-animation. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8FguiwVNCs0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  You can build a model that will classify the user's actions by the dynamics of the mouse movement or the profile of using the keyboard, etc. <br><br>  An unexpected approach for me is the use of ML models to improve the quality of the picture.  A number of articles provide an example of NVIDIA's ‚Äúsmart‚Äù filtering, which is called ‚Äúsuper-resolution technology‚Äù. <br><br><img src="https://habrastorage.org/webt/bo/k5/oh/bok5oh4ynriyie1qiortsd8xv-i.jpeg"><br>  <i>ML Super Sampling (left) and bilinear upsampling (right)</i> <br><br>  The scope of ML models is extensive and limited only by the imagination of developers.  If you like the article, in the following articles we will discuss the issues of constructing and using ML-models using simple examples. </div><p>Source: <a href="https://habr.com/ru/post/351724/">https://habr.com/ru/post/351724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351712/index.html">Security Week 9: Miner eliminates competitors, snapshots for traffic lights and extremely intrusive cameras</a></li>
<li><a href="../351714/index.html">Evil by Design: interfaces from Mephistopheles (part two)</a></li>
<li><a href="../351716/index.html">The conference program of the Neurodata Lab and ITMO for Emotion AI, St. Petersburg, March 30</a></li>
<li><a href="../351718/index.html">March 24, Moscow - CocoaHeads Special Event</a></li>
<li><a href="../351720/index.html">Change management</a></li>
<li><a href="../351726/index.html">Design system. Concept definition</a></li>
<li><a href="../351730/index.html">Why inheritance has always been meaningless</a></li>
<li><a href="../351732/index.html">Intelligent Word Processing</a></li>
<li><a href="../351734/index.html">Erlang, rebar3 and installation of service under Windows</a></li>
<li><a href="../351736/index.html">Bagodilnya - marathon for killing the elderly bugs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>