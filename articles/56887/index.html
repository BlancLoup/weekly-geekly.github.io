<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How Opera ‚Äúrepairs‚Äù websites</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Perhaps most often, Opera browser developers are blamed for their integrity when it comes to adhering to web standards. Oddly enough. The main argumen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How Opera ‚Äúrepairs‚Äù websites</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="http://files.myopera.com/IlyaShpankov/files/web-standards.jpg" alt="image"></div><br><br>  Perhaps most often, Opera browser developers are blamed for their integrity when it comes to adhering to web standards.  Oddly enough.  The main argument at the same time sounds like this: ‚ÄúWell, here others can adapt to the imperfection of the Internet, how are you better?‚Äù.  In fact - almost nothing.  True, behind this ‚Äúalmost‚Äù lies such a simple thing as the desire to make the Internet world a better place.  The usual everyday logic suggests that going on about the unfair web developers to change the situation is unlikely to succeed, but too principled approach does not help the matter.  Only one way out - look for a middle ground.  And I must say that the Norwegian programmers were probably the closest to this compromise solution.  Moreover, their method in many articles goes head and shoulders ahead of all other market participants.  How can this be?  We read the translation of the article by Hollvord Steen. <br><a name="habracut"></a><br><br>  <b>How Opera ‚Äúrepairs‚Äù websites</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>It is not difficult to guess that the Internet can simply get out of control if each web site requires an individual display mode.</i>  Imagine that you are driving a car, while you need to tune something in the engine or change the wheels every time you turn a corner or drive onto a new street.  The current state of browser development is somewhat similar to this situation. <br><br>  Virtually every modern browser today has built-in features that allow it to bypass all the bumps and potholes in the web standards left by website developers: <br><br>  - IE8 displays websites from the <a href="http://blogs.zdnet.com/microsoft/%3Fp%3D2072">list of incompatible</a> in IE7 mode <br>  - Google Chrome <a href="http://blogoscoped.com/archive/2009-01-29-n48.html">seems to be another browser for Hotmail.</a> <br>  - Safari contains some secret undocumented hacks, <a href="http://mac.elated.com/2008/05/22/web-developer-features-in-safari/">specific to some sites</a> <br>  - Firefox probably has only an extension to <a href="https://addons.mozilla.org/en-US/firefox/addon/59%3Fapplication%3Dfirefox%26id%3D59">switch the User Agent</a> , which is very popular with a certain audience. <br>  - Opera has a built-in browser identification switch and corrective <a href="http://www.opera.com/docs/browserjs/">browser.js</a> <br><br>  Process each site separately?  It sounds crazy.  In fact, this is simply impossible.  For reference: there are billions of sites, and they all differ from each other.  Moreover, they are constantly <i>changing</i> , because every day millions of lines of code are added to them or edited.  Who can handle it?  In fact, this problem should be solved by standards, isn't it? <br><br>  <b>Standards</b> <br><br>  I commend the <a href="http://www.w3.org/">standardization</a> efforts, the active work of the evangelists of <a href="http://www.webstandards.org/">The Web Standards Project</a> and everyone else who promotes web standards.  It is possible that you will be able to change the future - more and more sites are being validated and get rid of the "non-standard" legacy of the past.  The power is with you! <br><br>  It should be noted that Opera also has several teams that are trying to change the world for the better, engaging in <a href="http://www.opera.com/company/education/curriculum/">learning</a> or <a href="http://dev.opera.com/">sharing their experiences</a> .  Our <a href="http://my.opera.com/community/openweb/">Open the Web</a> department constantly contacts website owners with tips on cross-browser compatibility and standards compliance. <br><br>  But the browser represents the interests of the user.  Therefore, we must do everything possible to go through all the intricacies of non-standard code of web sites, our browser could provide the user with the <i>most correct result</i> .  No matter how sad it is to realize, but in spite of the fact that we are not guilty of incorrect websites, this is often our headache.  And we have to solve it now, and not in <a href="http://ishtml5readyyet.com/">2022</a> . <br><br>  What we actually do. <br><br>  Observing how other browser vendors with varying success perform the same task, I think the time has come for us to share our experience in the difficult task of fixing websites ‚Äî at least to show all the strengths and weaknesses of our approach to the problem. <br><br>  <b>Strengths</b> <br><br>  <b>Experience</b> <br><br>  Compared to other browsers, Opera has the most experience in adding patches that are specific to each website, because we started doing this <a href="http://my.opera.com/hallvors/blog/show.dml/13893">in the days of Opera 8.01</a> .  I also take the liberty to say that our solution is the most advanced.  A set of <a href="http://www.opera.com/browser/tutorials/userjs/">custom JavaScript</a> custom commands create a simple but powerful API for modifying and correcting websites.  With the methods of obtaining and assigning variables, as well as using the DOM interface, we can change the behavior of Opera in accordance with most of the standard operations performed by the script.  Sometimes we add the missing style or even delete some objects and rules, which lead to incorrect display of pages.  As a result, if a website checks the browser version, we can often simply find and fix the line of code that does it!  Some illustrative examples: <br><br>  ‚ÄúWe can add one missing class name when <a href="http://www.aol.jp/">AOL Japan</a> incorrectly detects the browser and sends the wrong styles, and also fix the error in <a href="http://webmail.aol.com/">AOL webmail</a> when they use the erroneous spelling of dojoType instead of dojotype. <br>  - We can take advantage of the elegant call postMessage () when <a href="https://us.etrade.com/e/t/home">E * Trade is</a> trying to violate the security policy in terms of navigating the frame of another web site while it is loading encoded content. <br>  - We can also redefine what browser we are introducing to the website and which page display mode (adapted to the website or conforming to standards) should be used for this website through loadable settings. <br><br>  <b>Bug fixes</b> <br><br>  With the ability to change websites and Opera, we can sometimes even fix our own bugs. <br><br>  - When the menu on <a href="http://www.weather.com/">weather.com</a> ceases to be displayed due to improper handling of mouse events, we can fix it. <br>  - When search results on <a href="http://www.google.com/codesearch">Google Codesearch are</a> displayed in white font on a white background, we can apply a different style. <br><br>  Just think: Opera is a browser that can, without interfering with the user, correct their mistakes.  It looks like a time machine: we can fix our old flaws even in those versions that were already loaded by the user before these errors were detected. <br><br>  In the long run, this is a very important and subtle property of browser.js: it allows web developers to reduce the number of Opera-specific code corrections.  The truth is, it should be noted that both the IE8 update problem and our own experience suggest that <i>working on our old bugs is one of our biggest problems.</i>  We did the wrong things, and the websites also became wrong in response.  We fixed our browser, but the <i>world wide web never forgets our old mistakes</i> . <br><br>  What is the difference between the mechanism using browser.js?  When we release a new version of the browser with bug fixes, the corresponding pieces of browser.js code are imperceptibly marked as obsolete.  What worked with browser.js now starts to work by itself due to browser fixes, making the Opera upgrade process smoother for users and web developers, and also much simpler for us.  Sometimes I even seem to feel the huge envy of the IE8 development team across the Atlantic. <br><br>  Another interesting point is that we can thus add new standards to the browser with minimal problems.  For example, if the <code>&lt;input required&gt;</code> tag in the HTML5 specification breaks the <a href="http://www.barnesandnoble.com/">Barnes &amp; Noble</a> entry process because the username field doesn‚Äôt really need to be filled in, <i>when you click the ‚Äúcreate account‚Äù button,</i> we can first apply our corrections for registration to be successful, and only then meet with the specification editor and discuss with him over a cup of coffee how we can make the new technology more compatible with the existing Internet. <br><br>  <b>Transparency</b> <br><br>  From the very beginning, one of the main problems was that our corrections will allow web developers not to search and correct errors in their code.  Moreover, in this way we would even contribute to the <i>appearance of</i> errors, continuing to keep adjustments while the website is already fixed. <br><br>  To ensure maximum transparency, all corrections are <a href="http://www.opera.com/docs/browserjs/">documented</a> , and we also try to keep the file as readable and well commented as possible (of course, not to the detriment of the total size of the downloaded data).  In addition, each adjustment made is displayed in the Opera Error Console, telling the user what is happening. <br><br>  <b>Coverage</b> <br><br>  Adjusting websites is a cross platform task.  But this term too poorly describes the actual state of affairs.  Do you know that we are adjusting websites for the <a href="http://www.nintendo.com/wii">Nintendo Wii</a> ?  And for <a href="http://www.nintendodsi.com/">DSi</a> ?  For Opera on Windows Mobile, Symbian, BREW and <a href="http://www.archos.com/">Archos</a> portable media players?  Besides the jokes, we even apply the adjustment for <a href="http://www.operamini.com/">Opera Mini</a> ! <br><br>  - When editing emails with complicated formatting is required to create email messages on <a href="http://www.hotmail.com/">Hotmail</a> and <a href="http://mail.yahoo.com/">Yahoo mail</a> , we can simulate its support even on devices with very limited hardware capabilities for which this function is impossible in principle <br>  - If the processing of fancy animations on <a href="http://www.facebook.com/">Facebook</a> takes too much time on the Opera Mini server - and sending content to the client is possible only when everything is done - we can simply cut it down and at least complete the most important Facebook functions requested by the end user <br><br>  It looks like an ambitious task, perhaps even more ambitious than it seems from the outside.  Devices and platforms have very different requirements and are replete with specific problems.  For example: <br><br>  ‚ÄúOn the Wii game console, we have to limit the minimum font size in order to maintain readability ‚Äî but this often leads to unpredictable changes in the width, layout, and positioning of web page elements, resulting in a result that is simply not possible on a desktop browser.  Therefore, we are adjusting several websites with elements that are too hard to maintain the ability to use slightly larger fonts. <br>  - Using the on-screen keyboard on the Wii and a variety of mobile phones means changing the size of the browser window every time you need to enter text in the form field - the keyboard also requires some space on the display.  But, for example, the <a href="http://www.ba.com/">British Airways</a> website updates the checkout page <i>with each window size change</i> , which makes buying tickets using a virtual keyboard a nontrivial task ... <br>  - ... or when <a href="http://www.ebay.fr/">eBay in France</a> tries to count keystrokes to make sure that you are not a rogue and insert your email address in the "Re-enter E-mail" registration form - this also will not work with on-screen keyboards.  Most of them simply do not support keyboard events.  Come on eBay - I really <i>did</i> it.  I'm not kidding - REAL!  On a device for which the cut-paste operation is in principle IMPOSSIBLE! .. <br><br>  When dealing with such a range of problems, the true and magical potential of browser.js becomes even more obvious. <br><br>  <b>Infrastructure</b> <br><br>  In order to support all this farming, we have several small servers that send exactly the file that is intended for it at the request of the client.  We have a database of adjustments and a set of metadata containing records about which platforms and devices these adjustments can apply.  But did you know that we also have a special ‚Äúspyware‚Äù script that constantly checks websites ‚Äî have the errors we corrected there been corrected?  If such a miracle still happens, it would be nice to know about it.  I love the system sound that accompanies each deletion of the next ‚Äúoutdated‚Äù adjustment to the Trash. <br><br>  <b>Weak sides</b> <br><br>  <b>Time</b> <br><br>  So many opportunities, so little time ... Analyzing websites and making adjustments takes a lot of time.  We don‚Äôt even come close to the impressive list of IE8-incompatible websites, which contains more than 2,400 entries (in fact, this list‚Äôs research reminds Deja Vu: there are so many familiar names, so many websites that need to be corrected or contact for one reason or another). <br><br>  However, our list is noticeably shorter - fortunately!  Technical analysis with the level of detail that is required for our website adjustment system can be very time consuming, so I hope that we can keep our list still much smaller than IE, and as a result, we can better focus focus on the quality of the adjustments.  However, we are ready for a wider coverage: in our database there are more than 600 entries and there is still plenty of space - we are waiting for your <a href="http://my.opera.com/operaqa/blog/2008/09/17/you-can-be-a-site-compatibility-wizard">messages</a> about incorrectly displayed web sites. <br><br>  <b>Performance</b> <br><br>  I just said that there is a place for new adjustments.  But what scale can be achieved before it significantly affects the performance of the browser? <br><br>  Obviously, we can maintain the growth of the database for quite a long time.  Some of our recent experiments have shown that we can handle up to 10,000 different websites, slowing Opera down by only a fraction of a percent.  I also sincerely believe that by the time our database of records has grown to 10,000, you will already buy a more productive computer ... <br><br>  <b>Security</b> <br><br>  Is it safe?  Can a virus or a ‚Äúhostile‚Äù server fake your browser.js and thereby instantly gain control of your use of Opera? <br><br>  The short answer is no. <br><br>  A more detailed answer is that it would be possible if we had not taken appropriate protective measures, but in fact we are engaged in them very actively.  Each file contains a digital signature and Opera checks whether the file is authentic and has not been modified.  Such a signature is very, very difficult to falsify.  Therefore, as soon as a virus or a ‚Äúhostile‚Äù server changes the file, Opera will immediately stop using it and download a more recent version from our server. <br><br>  <b>findings</b> <br><br>  One of the things that struck me most about browser.js is how quickly the global network is changing.  <i>Paying such close attention to certain websites, we see that in general the Internet is improving</i> , and it happens much faster than I could have expected.  And in spite of, perhaps, your fears, we often see that websites improve and become more loyal to Opera browsers <i>after</i> we release corrections to them! <br><br>  This means that <a href="http://my.opera.com/hallvors/blog/show.dml/103863">site adjustment works</a> .  This works because it improves compatibility, thus giving users a real choice of browser and ‚Äî however fantastic that may sound ‚Äî as a direct impact, it gives web developers confidence that their websites are compatible with Opera and with many other browsers. <br><br>  Welcome to the future - <i>created from and with the help of standards, open technologies and website adjustments</i> . <br><br>  <b>about the author</b> <br>  <i><a href="http://my.opera.com/hallvors/blog/">Hallvord RM Steen</a> works with Opera‚Äôs ‚Äúnuclear‚Äù team to test quality, test and web compatibility.</i>  <i>He is the developer of the browser.js file and can break all sites around the world with a little typo.</i> <br><br>  <i>Thanks:</i> <i><br></i>  <i>This translation was made possible thanks to <a href="https://habrahabr.ru/users/melnichuck/" class="user_link">melnichuck</a> and <a href="https://habrahabr.ru/users/arestov/" class="user_link">arestov</a></i> </div><p>Source: <a href="https://habr.com/ru/post/56887/">https://habr.com/ru/post/56887/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../56881/index.html">Google Chrome and Linux</a></li>
<li><a href="../56882/index.html">Railways: Unpleasant surprises</a></li>
<li><a href="../56883/index.html">Mysql Documentor - A simple utility for documenting Mysql 5+ databases.</a></li>
<li><a href="../56885/index.html">And again about Juick: Q & A</a></li>
<li><a href="../56886/index.html">Squid for the smallest. Part 3 Statistics</a></li>
<li><a href="../56888/index.html">aTunes cross-platform player</a></li>
<li><a href="../56889/index.html">Google added fullscreen view street view</a></li>
<li><a href="../56891/index.html">Visual deflation guide</a></li>
<li><a href="../56895/index.html">Apple Push Notification Service is available for testing ... today!</a></li>
<li><a href="../56896/index.html">New video "PC for $ 1500"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>