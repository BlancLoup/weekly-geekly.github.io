<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Working with ranges and borders in .NET</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the translator. The topic of ranges (intervals) in .NET rightly refers to the ever-green and young. Hundreds of questions asked in the forums, do...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Working with ranges and borders in .NET</h1><div class="post__text post__text-html js-mediator-article"> <i>From the translator.</i>  <i>The topic of ranges (intervals) in .NET rightly refers to the ever-green and young.</i>  <i>Hundreds of questions asked in the forums, dozens of written articles ... it seems that this will end only when Microsoft finally introduces its range management mechanism into the Framework Class Library.</i>  <i>And there is a logical explanation for this - probably, every programmer sooner or later faces the need to use a certain range of values, be it numbers, dates, or any other values.</i>  <i>I had such a need, however, remembering that my bikes are not the best solution, I went through the Internet and got into an excellent article by John Skit, a translation of which, in fact, I present to your attention.</i> <br><br>  The first edition of my book “ <a href="http://csharpindepth.com/">C # in Depth</a> ” presented an abstract generalized class <code>Range</code> , in which virtual methods were used to walk through the elements in a range.  Unfortunately, this class was not ideal, since it did not take into account certain borderline cases.  However, this article is not so much about designing an ideal class for working with bands, but about what nuances and considerations should be taken into account.  My <a href="http://www.yoda.arachsys.com/csharp/miscutil/">MiscUtil</a> class library contains a class that <a href="http://www.yoda.arachsys.com/csharp/miscutil/">takes</a> into account most of the things discussed in this article, but, of course, this class is far from ideal.  In general, in January 2008, I wrote a <a href="http://msmvps.com/blogs/jon_skeet/archive/2008/01/26/immutability-and-inheritance.aspx">short article</a> about ranges in my blog, but since then a lot of water has flowed, I rethought a lot of things and decided to expand the topic in more detail in the form of this article. <br><a name="habracut"></a><br><br><h3>  Formulation of the problem </h3><br>  Let us first define what we want and what we can do, and formulate the problem as clearly as possible. <br><ul><li>  Create a value range storage engine for any suitable type. </li><li>  Iterate over a set of these values ​​using a custom search function </li></ul><br>  It seems that we seem to have described everything, but remember that the devil is in the details.  We should also consider the following things, namely: <br><ul><li>  Consider the equality of the two ranges. </li><li>  Consider the intersection, union, difference, etc.  two ranges </li><li>  Take into account ranges whose values ​​are discrete values ​​(such as "all even integers in the range from 0 to 100") </li><li>  Understand brute force functions that should “move” along a range (i.e., decide in which direction they should move, etc.) </li></ul><br>  Now that we have formulated the problem in general terms, we can proceed to the fine details. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Details </h3><br>  First of all, let's think about the types that are generally acceptable for use in bands.  We want the range class to be generic (generic), and we want to be able to compare (compare) two values ​​to each other, to know which one is larger and which one is smaller.  We can achieve this by applying a delimiter to type <code>T</code> , which would require that type <code>T</code> implement the <code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code><code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code></code> interface <code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code><code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code></code> <code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code><code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <ol><li> <code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code><code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code></code> </li> <li> <code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code><code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code></code> </li> <li> <code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code><code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code></code> </li> <li> <code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code><code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code></code> </li> </ol> <code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code><code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <h3> <code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </h3> <code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <pre> <code class="hljs pgsql"><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (<span class="hljs-keyword"><span class="hljs-keyword">exclusive</span></span>),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>      «»  ,  -     <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> ;     « »,    <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> —     ,       .  ,  ,         ,        <code><code><span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(IComparer), , ,     <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> .             . <br> <br>       ,    :     (<span class="hljs-keyword"><span class="hljs-keyword">immutable</span></span>). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Range&lt;T&gt; { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T LowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T UpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveLowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveUpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IComparer&lt;T&gt; Comparer { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range(T lowerBound, T upperBound, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveLowerBound = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveUpperBound = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, IComparer&lt;T&gt; comparer = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(LowerBound, UpperBound) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ArgumentException("Invalid bounds"); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> Contains(T item) { <span class="hljs-type"><span class="hljs-type">int</span></span> lowerCompare = Comparer.Compare(LowerBound, item); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lowerCompare &gt; (InclusiveLowerBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-type"><span class="hljs-type">int</span></span> upperCompare = Comparer.Compare(item, UpperBound); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (upperCompare &gt; (InclusiveUpperBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>),      ,      — <span class="hljs-number"><span class="hljs-number">5.</span></span>       <span class="hljs-number"><span class="hljs-number">1</span></span> (   )    <span class="hljs-number"><span class="hljs-number">5</span></span> (   <span class="hljs-number"><span class="hljs-number">0</span></span>    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (<span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-number"><span class="hljs-number">37</span></span>),    <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>  <span class="hljs-number"><span class="hljs-number">44</span></span>,   <span class="hljs-number"><span class="hljs-number">38.</span></span>          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var simpleIterable = range.StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>) .Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span></code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;<span class="hljs-type"><span class="hljs-type">bool</span></span>, T&gt;&gt;</code> ,      . <br> *     ( <code><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></code> )  (   ) <br> *   <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = LowerBound; //    ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!InclusiveLowerBound) { <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Contains(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>)) { yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>; T next = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); // Handle a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> which wraps // round <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> near the <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> one // near the <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> // which does <span class="hljs-keyword"><span class="hljs-keyword">nothing</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(next, <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { yield break; } <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>) —    : <br> <code class="cs">T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .    ,   ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y)  ,   :   x</code>  <code>y</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code>  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code> ,  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0.</span></span>   .NET Framework,   ,     <code>x</code>  <code>y</code>  <span class="hljs-number"><span class="hljs-number">-1</span></span>  +<span class="hljs-number"><span class="hljs-number">1</span></span>,      ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ( <code>x</code>  <code>y</code> )  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    <span class="hljs-number"><span class="hljs-number">0</span></span>   ,  <br> |<span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue| == <span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue + <span class="hljs-number"><span class="hljs-number">1.</span></span>   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ,   <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code><span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code><span class="hljs-keyword"><span class="hljs-keyword">Reverse</span></span></code> : <br></code> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range&lt;T&gt; Reverse() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# <span class="hljs-number"><span class="hljs-number">4</span></span>, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code> (..  <span class="hljs-number"><span class="hljs-number">0</span></span>   <span class="hljs-number"><span class="hljs-number">5</span></span> ),      , <i></i>  <span class="hljs-number"><span class="hljs-number">2</span></span>   .        <code>{ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span> }</code> .       <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code>  <code>[<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]</code> ,      (    , <i></i>    <span class="hljs-number"><span class="hljs-number">2</span></span>),      <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> .        , , LINQ,   <code>{ <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> }</code> —    <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range <span class="hljs-keyword"><span class="hljs-keyword">class</span></span></a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">Range<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>: A Low-Memory <span class="hljs-keyword"><span class="hljs-keyword">Set Data</span></span> Structure <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx"><span class="hljs-keyword"><span class="hljs-keyword">Language</span></span> Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       <span class="hljs-type"><span class="hljs-type">Time</span></span> Period Library  Jani Giannoudis.      <span class="hljs-number"><span class="hljs-number">2011</span></span>  CodeProject,     (  — <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">2013</span></span>),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </pre> <code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <pre> <code class="hljs pgsql"><code><code><code><code><code><code><code><code class="cs"><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (<span class="hljs-keyword"><span class="hljs-keyword">exclusive</span></span>),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>      «»  ,  -     <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> ;     « »,    <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> —     ,       .  ,  ,         ,        <code><span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(IComparer), , ,     <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> .             . <br> <br>       ,    :     (<span class="hljs-keyword"><span class="hljs-keyword">immutable</span></span>). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Range&lt;T&gt; { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T LowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T UpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveLowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveUpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IComparer&lt;T&gt; Comparer { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range(T lowerBound, T upperBound, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveLowerBound = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveUpperBound = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, IComparer&lt;T&gt; comparer = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(LowerBound, UpperBound) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ArgumentException("Invalid bounds"); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> Contains(T item) { <span class="hljs-type"><span class="hljs-type">int</span></span> lowerCompare = Comparer.Compare(LowerBound, item); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lowerCompare &gt; (InclusiveLowerBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-type"><span class="hljs-type">int</span></span> upperCompare = Comparer.Compare(item, UpperBound); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (upperCompare &gt; (InclusiveUpperBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> var range = Range.<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>),      ,      — <span class="hljs-number"><span class="hljs-number">5.</span></span>       <span class="hljs-number"><span class="hljs-number">1</span></span> (   )    <span class="hljs-number"><span class="hljs-number">5</span></span> (   <span class="hljs-number"><span class="hljs-number">0</span></span>    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (<span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-number"><span class="hljs-number">37</span></span>),    <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>  <span class="hljs-number"><span class="hljs-number">44</span></span>,   <span class="hljs-number"><span class="hljs-number">38.</span></span>          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var simpleIterable = range.StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>) .Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span></code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;<span class="hljs-type"><span class="hljs-type">bool</span></span>, T&gt;&gt;</code> ,      . <br> *     ( <code><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></code> )  (   ) <br> *   <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = LowerBound; //    ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!InclusiveLowerBound) { <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Contains(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>)) { yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>; T next = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); // Handle a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> which wraps // round <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> near the <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> one // near the <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> // which does <span class="hljs-keyword"><span class="hljs-keyword">nothing</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(next, <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { yield break; } <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>) —    : <br> <code class="cs">T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .    ,   ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y)  ,   :   x</code>  <code>y</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code>  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code> ,  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0.</span></span>   .NET Framework,   ,     <code>x</code>  <code>y</code>  <span class="hljs-number"><span class="hljs-number">-1</span></span>  +<span class="hljs-number"><span class="hljs-number">1</span></span>,      ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ( <code>x</code>  <code>y</code> )  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    <span class="hljs-number"><span class="hljs-number">0</span></span>   ,  <br> |<span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue| == <span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue + <span class="hljs-number"><span class="hljs-number">1.</span></span>   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ,   <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code><span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code><span class="hljs-keyword"><span class="hljs-keyword">Reverse</span></span></code> : <br></code> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range&lt;T&gt; Reverse() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# <span class="hljs-number"><span class="hljs-number">4</span></span>, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code> (..  <span class="hljs-number"><span class="hljs-number">0</span></span>   <span class="hljs-number"><span class="hljs-number">5</span></span> ),      , <i></i>  <span class="hljs-number"><span class="hljs-number">2</span></span>   .        <code>{ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span> }</code> .       <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code>  <code>[<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]</code> ,      (    , <i></i>    <span class="hljs-number"><span class="hljs-number">2</span></span>),      <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> .        , , LINQ,   <code>{ <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> }</code> —    <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range <span class="hljs-keyword"><span class="hljs-keyword">class</span></span></a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">Range<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>: A Low-Memory <span class="hljs-keyword"><span class="hljs-keyword">Set Data</span></span> Structure <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx"><span class="hljs-keyword"><span class="hljs-keyword">Language</span></span> Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       <span class="hljs-type"><span class="hljs-type">Time</span></span> Period Library  Jani Giannoudis.      <span class="hljs-number"><span class="hljs-number">2011</span></span>  CodeProject,     (  — <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">2013</span></span>),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code></code> </pre> <code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <h3> <code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </h3> <code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <h5> <code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </h5> <code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <pre> <code class="hljs pgsql"><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (<span class="hljs-keyword"><span class="hljs-keyword">exclusive</span></span>),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>      «»  ,  -     <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> ;     « »,    <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> —     ,       .  ,  ,         ,        <code><code><span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(IComparer), , ,     <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> .             . <br> <br>       ,    :     (<span class="hljs-keyword"><span class="hljs-keyword">immutable</span></span>). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Range&lt;T&gt; { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T LowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T UpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveLowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveUpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IComparer&lt;T&gt; Comparer { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range(T lowerBound, T upperBound, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveLowerBound = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveUpperBound = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, IComparer&lt;T&gt; comparer = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(LowerBound, UpperBound) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ArgumentException("Invalid bounds"); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> Contains(T item) { <span class="hljs-type"><span class="hljs-type">int</span></span> lowerCompare = Comparer.Compare(LowerBound, item); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lowerCompare &gt; (InclusiveLowerBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-type"><span class="hljs-type">int</span></span> upperCompare = Comparer.Compare(item, UpperBound); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (upperCompare &gt; (InclusiveUpperBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>),      ,      — <span class="hljs-number"><span class="hljs-number">5.</span></span>       <span class="hljs-number"><span class="hljs-number">1</span></span> (   )    <span class="hljs-number"><span class="hljs-number">5</span></span> (   <span class="hljs-number"><span class="hljs-number">0</span></span>    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (<span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-number"><span class="hljs-number">37</span></span>),    <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>  <span class="hljs-number"><span class="hljs-number">44</span></span>,   <span class="hljs-number"><span class="hljs-number">38.</span></span>          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var simpleIterable = range.StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>) .Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span></code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;<span class="hljs-type"><span class="hljs-type">bool</span></span>, T&gt;&gt;</code> ,      . <br> *     ( <code><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></code> )  (   ) <br> *   <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = LowerBound; //    ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!InclusiveLowerBound) { <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Contains(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>)) { yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>; T next = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); // Handle a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> which wraps // round <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> near the <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> one // near the <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> // which does <span class="hljs-keyword"><span class="hljs-keyword">nothing</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(next, <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { yield break; } <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>) —    : <br> <code class="cs">T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .    ,   ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y)  ,   :   x</code>  <code>y</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code>  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code> ,  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0.</span></span>   .NET Framework,   ,     <code>x</code>  <code>y</code>  <span class="hljs-number"><span class="hljs-number">-1</span></span>  +<span class="hljs-number"><span class="hljs-number">1</span></span>,      ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ( <code>x</code>  <code>y</code> )  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    <span class="hljs-number"><span class="hljs-number">0</span></span>   ,  <br> |<span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue| == <span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue + <span class="hljs-number"><span class="hljs-number">1.</span></span>   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ,   <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code><span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code><span class="hljs-keyword"><span class="hljs-keyword">Reverse</span></span></code> : <br></code> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range&lt;T&gt; Reverse() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# <span class="hljs-number"><span class="hljs-number">4</span></span>, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code> (..  <span class="hljs-number"><span class="hljs-number">0</span></span>   <span class="hljs-number"><span class="hljs-number">5</span></span> ),      , <i></i>  <span class="hljs-number"><span class="hljs-number">2</span></span>   .        <code>{ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span> }</code> .       <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code>  <code>[<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]</code> ,      (    , <i></i>    <span class="hljs-number"><span class="hljs-number">2</span></span>),      <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> .        , , LINQ,   <code>{ <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> }</code> —    <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range <span class="hljs-keyword"><span class="hljs-keyword">class</span></span></a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">Range<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>: A Low-Memory <span class="hljs-keyword"><span class="hljs-keyword">Set Data</span></span> Structure <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx"><span class="hljs-keyword"><span class="hljs-keyword">Language</span></span> Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       <span class="hljs-type"><span class="hljs-type">Time</span></span> Period Library  Jani Giannoudis.      <span class="hljs-number"><span class="hljs-number">2011</span></span>  CodeProject,     (  — <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">2013</span></span>),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </pre> <code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <h5> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </h5> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <ul><li> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </li> <li> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </li><li> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </li> </ul> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <h5> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </h5> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <pre> <code class="hljs pgsql"><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (<span class="hljs-keyword"><span class="hljs-keyword">exclusive</span></span>),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>      «»  ,  -     <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> ;     « »,    <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> —     ,       .  ,  ,         ,        <code><code><span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(IComparer), , ,     <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> .             . <br> <br>       ,    :     (<span class="hljs-keyword"><span class="hljs-keyword">immutable</span></span>). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Range&lt;T&gt; { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T LowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T UpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveLowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveUpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IComparer&lt;T&gt; Comparer { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range(T lowerBound, T upperBound, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveLowerBound = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveUpperBound = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, IComparer&lt;T&gt; comparer = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(LowerBound, UpperBound) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ArgumentException("Invalid bounds"); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> Contains(T item) { <span class="hljs-type"><span class="hljs-type">int</span></span> lowerCompare = Comparer.Compare(LowerBound, item); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lowerCompare &gt; (InclusiveLowerBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-type"><span class="hljs-type">int</span></span> upperCompare = Comparer.Compare(item, UpperBound); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (upperCompare &gt; (InclusiveUpperBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>),      ,      — <span class="hljs-number"><span class="hljs-number">5.</span></span>       <span class="hljs-number"><span class="hljs-number">1</span></span> (   )    <span class="hljs-number"><span class="hljs-number">5</span></span> (   <span class="hljs-number"><span class="hljs-number">0</span></span>    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (<span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-number"><span class="hljs-number">37</span></span>),    <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>  <span class="hljs-number"><span class="hljs-number">44</span></span>,   <span class="hljs-number"><span class="hljs-number">38.</span></span>          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var simpleIterable = range.StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>) .Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span></code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;<span class="hljs-type"><span class="hljs-type">bool</span></span>, T&gt;&gt;</code> ,      . <br> *     ( <code><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></code> )  (   ) <br> *   <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = LowerBound; //    ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!InclusiveLowerBound) { <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Contains(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>)) { yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>; T next = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); // Handle a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> which wraps // round <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> near the <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> one // near the <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> // which does <span class="hljs-keyword"><span class="hljs-keyword">nothing</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(next, <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { yield break; } <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>) —    : <br> <code class="cs">T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .    ,   ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y)  ,   :   x</code>  <code>y</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code>  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code> ,  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0.</span></span>   .NET Framework,   ,     <code>x</code>  <code>y</code>  <span class="hljs-number"><span class="hljs-number">-1</span></span>  +<span class="hljs-number"><span class="hljs-number">1</span></span>,      ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ( <code>x</code>  <code>y</code> )  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    <span class="hljs-number"><span class="hljs-number">0</span></span>   ,  <br> |<span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue| == <span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue + <span class="hljs-number"><span class="hljs-number">1.</span></span>   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ,   <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code><span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code><span class="hljs-keyword"><span class="hljs-keyword">Reverse</span></span></code> : <br></code> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range&lt;T&gt; Reverse() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# <span class="hljs-number"><span class="hljs-number">4</span></span>, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code> (..  <span class="hljs-number"><span class="hljs-number">0</span></span>   <span class="hljs-number"><span class="hljs-number">5</span></span> ),      , <i></i>  <span class="hljs-number"><span class="hljs-number">2</span></span>   .        <code>{ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span> }</code> .       <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code>  <code>[<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]</code> ,      (    , <i></i>    <span class="hljs-number"><span class="hljs-number">2</span></span>),      <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> .        , , LINQ,   <code>{ <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> }</code> —    <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range <span class="hljs-keyword"><span class="hljs-keyword">class</span></span></a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">Range<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>: A Low-Memory <span class="hljs-keyword"><span class="hljs-keyword">Set Data</span></span> Structure <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx"><span class="hljs-keyword"><span class="hljs-keyword">Language</span></span> Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       <span class="hljs-type"><span class="hljs-type">Time</span></span> Period Library  Jani Giannoudis.      <span class="hljs-number"><span class="hljs-number">2011</span></span>  CodeProject,     (  — <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">2013</span></span>),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </pre> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <pre> <code class="hljs pgsql"><code><code><code><code><code><code><code><code><code><code><code><code class="cs"><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (<span class="hljs-keyword"><span class="hljs-keyword">exclusive</span></span>),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>      «»  ,  -     <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> ;     « »,    <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> —     ,       .  ,  ,         ,        <code><span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(IComparer), , ,     <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> .             . <br> <br>       ,    :     (<span class="hljs-keyword"><span class="hljs-keyword">immutable</span></span>). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Range&lt;T&gt; { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T LowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T UpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveLowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveUpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IComparer&lt;T&gt; Comparer { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range(T lowerBound, T upperBound, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveLowerBound = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveUpperBound = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, IComparer&lt;T&gt; comparer = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(LowerBound, UpperBound) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ArgumentException("Invalid bounds"); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> Contains(T item) { <span class="hljs-type"><span class="hljs-type">int</span></span> lowerCompare = Comparer.Compare(LowerBound, item); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lowerCompare &gt; (InclusiveLowerBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-type"><span class="hljs-type">int</span></span> upperCompare = Comparer.Compare(item, UpperBound); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (upperCompare &gt; (InclusiveUpperBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>),      ,      — <span class="hljs-number"><span class="hljs-number">5.</span></span>       <span class="hljs-number"><span class="hljs-number">1</span></span> (   )    <span class="hljs-number"><span class="hljs-number">5</span></span> (   <span class="hljs-number"><span class="hljs-number">0</span></span>    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (<span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-number"><span class="hljs-number">37</span></span>),    <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>  <span class="hljs-number"><span class="hljs-number">44</span></span>,   <span class="hljs-number"><span class="hljs-number">38.</span></span>          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var simpleIterable = range.StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>) .Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span></code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;<span class="hljs-type"><span class="hljs-type">bool</span></span>, T&gt;&gt;</code> ,      . <br> *     ( <code><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></code> )  (   ) <br> *   <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = LowerBound; //    ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!InclusiveLowerBound) { <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Contains(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>)) { yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>; T next = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); // Handle a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> which wraps // round <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> near the <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> one // near the <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> // which does <span class="hljs-keyword"><span class="hljs-keyword">nothing</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(next, <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { yield break; } <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>) —    : <br> T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = InclusiveLowerBound ? LowerBound : step(LowerBound); <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .    ,   ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y)  ,   :   x</code>  <code>y</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code>  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code> ,  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0.</span></span>   .NET Framework,   ,     <code>x</code>  <code>y</code>  <span class="hljs-number"><span class="hljs-number">-1</span></span>  +<span class="hljs-number"><span class="hljs-number">1</span></span>,      ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ( <code>x</code>  <code>y</code> )  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    <span class="hljs-number"><span class="hljs-number">0</span></span>   ,  <br> |<span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue| == <span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue + <span class="hljs-number"><span class="hljs-number">1.</span></span>   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ,   <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code><span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code><span class="hljs-keyword"><span class="hljs-keyword">Reverse</span></span></code> : <br></code> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range&lt;T&gt; Reverse() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# <span class="hljs-number"><span class="hljs-number">4</span></span>, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code> (..  <span class="hljs-number"><span class="hljs-number">0</span></span>   <span class="hljs-number"><span class="hljs-number">5</span></span> ),      , <i></i>  <span class="hljs-number"><span class="hljs-number">2</span></span>   .        <code>{ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span> }</code> .       <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code>  <code>[<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]</code> ,      (    , <i></i>    <span class="hljs-number"><span class="hljs-number">2</span></span>),      <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> .        , , LINQ,   <code>{ <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> }</code> —    <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range <span class="hljs-keyword"><span class="hljs-keyword">class</span></span></a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">Range<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>: A Low-Memory <span class="hljs-keyword"><span class="hljs-keyword">Set Data</span></span> Structure <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx"><span class="hljs-keyword"><span class="hljs-keyword">Language</span></span> Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       <span class="hljs-type"><span class="hljs-type">Time</span></span> Period Library  Jani Giannoudis.      <span class="hljs-number"><span class="hljs-number">2011</span></span>  CodeProject,     (  — <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">2013</span></span>),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code></code> </pre> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <h5> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </h5> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <pre> <code class="hljs pgsql"><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (<span class="hljs-keyword"><span class="hljs-keyword">exclusive</span></span>),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>      «»  ,  -     <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> ;     « »,    <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> —     ,       .  ,  ,         ,        <code><code><span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(IComparer), , ,     <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> .             . <br> <br>       ,    :     (<span class="hljs-keyword"><span class="hljs-keyword">immutable</span></span>). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Range&lt;T&gt; { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T LowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T UpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveLowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveUpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IComparer&lt;T&gt; Comparer { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range(T lowerBound, T upperBound, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveLowerBound = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveUpperBound = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, IComparer&lt;T&gt; comparer = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(LowerBound, UpperBound) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ArgumentException("Invalid bounds"); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> Contains(T item) { <span class="hljs-type"><span class="hljs-type">int</span></span> lowerCompare = Comparer.Compare(LowerBound, item); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lowerCompare &gt; (InclusiveLowerBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-type"><span class="hljs-type">int</span></span> upperCompare = Comparer.Compare(item, UpperBound); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (upperCompare &gt; (InclusiveUpperBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>),      ,      — <span class="hljs-number"><span class="hljs-number">5.</span></span>       <span class="hljs-number"><span class="hljs-number">1</span></span> (   )    <span class="hljs-number"><span class="hljs-number">5</span></span> (   <span class="hljs-number"><span class="hljs-number">0</span></span>    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (<span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-number"><span class="hljs-number">37</span></span>),    <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>  <span class="hljs-number"><span class="hljs-number">44</span></span>,   <span class="hljs-number"><span class="hljs-number">38.</span></span>          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var simpleIterable = range.StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>) .Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span></code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;<span class="hljs-type"><span class="hljs-type">bool</span></span>, T&gt;&gt;</code> ,      . <br> *     ( <code><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></code> )  (   ) <br> *   <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = LowerBound; //    ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!InclusiveLowerBound) { <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Contains(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>)) { yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>; T next = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); // Handle a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> which wraps // round <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> near the <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> one // near the <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> // which does <span class="hljs-keyword"><span class="hljs-keyword">nothing</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(next, <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { yield break; } <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>) —    : <br> <code class="cs">T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .    ,   ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y)  ,   :   x</code>  <code>y</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code>  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code> ,  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0.</span></span>   .NET Framework,   ,     <code>x</code>  <code>y</code>  <span class="hljs-number"><span class="hljs-number">-1</span></span>  +<span class="hljs-number"><span class="hljs-number">1</span></span>,      ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ( <code>x</code>  <code>y</code> )  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    <span class="hljs-number"><span class="hljs-number">0</span></span>   ,  <br> |<span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue| == <span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue + <span class="hljs-number"><span class="hljs-number">1.</span></span>   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ,   <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code><span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code><span class="hljs-keyword"><span class="hljs-keyword">Reverse</span></span></code> : <br></code> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range&lt;T&gt; Reverse() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# <span class="hljs-number"><span class="hljs-number">4</span></span>, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code> (..  <span class="hljs-number"><span class="hljs-number">0</span></span>   <span class="hljs-number"><span class="hljs-number">5</span></span> ),      , <i></i>  <span class="hljs-number"><span class="hljs-number">2</span></span>   .        <code>{ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span> }</code> .       <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code>  <code>[<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]</code> ,      (    , <i></i>    <span class="hljs-number"><span class="hljs-number">2</span></span>),      <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> .        , , LINQ,   <code>{ <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> }</code> —    <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range <span class="hljs-keyword"><span class="hljs-keyword">class</span></span></a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">Range<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>: A Low-Memory <span class="hljs-keyword"><span class="hljs-keyword">Set Data</span></span> Structure <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx"><span class="hljs-keyword"><span class="hljs-keyword">Language</span></span> Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       <span class="hljs-type"><span class="hljs-type">Time</span></span> Period Library  Jani Giannoudis.      <span class="hljs-number"><span class="hljs-number">2011</span></span>  CodeProject,     (  — <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">2013</span></span>),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </pre> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <blockquote> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <pre> <code class="hljs pgsql"><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (<span class="hljs-keyword"><span class="hljs-keyword">exclusive</span></span>),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>      «»  ,  -     <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> ;     « »,    <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> —     ,       .  ,  ,         ,        <code><code><span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(IComparer), , ,     <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> .             . <br> <br>       ,    :     (<span class="hljs-keyword"><span class="hljs-keyword">immutable</span></span>). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Range&lt;T&gt; { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T LowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> T UpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveLowerBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> InclusiveUpperBound { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IComparer&lt;T&gt; Comparer { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range(T lowerBound, T upperBound, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveLowerBound = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-type"><span class="hljs-type">bool</span></span> inclusiveUpperBound = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, IComparer&lt;T&gt; comparer = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(LowerBound, UpperBound) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ArgumentException("Invalid bounds"); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> Contains(T item) { <span class="hljs-type"><span class="hljs-type">int</span></span> lowerCompare = Comparer.Compare(LowerBound, item); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lowerCompare &gt; (InclusiveLowerBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-type"><span class="hljs-type">int</span></span> upperCompare = Comparer.Compare(item, UpperBound); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (upperCompare &gt; (InclusiveUpperBound ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>),      ,      — <span class="hljs-number"><span class="hljs-number">5.</span></span>       <span class="hljs-number"><span class="hljs-number">1</span></span> (   )    <span class="hljs-number"><span class="hljs-number">5</span></span> (   <span class="hljs-number"><span class="hljs-number">0</span></span>    )?          ,      ,  ,    () .  ,   -      <code><code class="cs">IComparer,        .   «»      (<span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-number"><span class="hljs-number">37</span></span>),    <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>  <span class="hljs-number"><span class="hljs-number">44</span></span>,   <span class="hljs-number"><span class="hljs-number">38.</span></span>          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var simpleIterable = range.StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + <span class="hljs-number"><span class="hljs-number">5</span></span>) .Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> <br>        :    ,    <code><code><code><code>IEnumerable.      IEnumerator,        IEnumerable:      <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span></code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;<span class="hljs-type"><span class="hljs-type">bool</span></span>, T&gt;&gt;</code> ,      . <br> *     ( <code><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></code> )  (   ) <br> *   <code><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = LowerBound; //    ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!InclusiveLowerBound) { <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Contains(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>)) { yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>; T next = step(<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>); // Handle a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> which wraps // round <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> near the <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> one // near the <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> a stepping <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> // which does <span class="hljs-keyword"><span class="hljs-keyword">nothing</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Comparer.Compare(next, <span class="hljs-keyword"><span class="hljs-keyword">current</span></span>) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { yield break; } <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>) —    : <br> <code class="cs">T <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> sealed <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .    ,   ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   <span class="hljs-type"><span class="hljs-type">int</span></span> Compare(T x, T y)  ,   :   x</code>  <code>y</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code>  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0</span></span>;  <code>x</code> ,  <code>y</code> ,    <span class="hljs-number"><span class="hljs-number">0.</span></span>   .NET Framework,   ,     <code>x</code>  <code>y</code>  <span class="hljs-number"><span class="hljs-number">-1</span></span>  +<span class="hljs-number"><span class="hljs-number">1</span></span>,      ,    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ( <code>x</code>  <code>y</code> )  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    <span class="hljs-number"><span class="hljs-number">0</span></span>   ,  <br> |<span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue| == <span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue + <span class="hljs-number"><span class="hljs-number">1.</span></span>   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> ,   <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code><span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code><span class="hljs-keyword"><span class="hljs-keyword">Reverse</span></span></code> : <br></code> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Range&lt;T&gt; Reverse() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# <span class="hljs-number"><span class="hljs-number">4</span></span>, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code> (..  <span class="hljs-number"><span class="hljs-number">0</span></span>   <span class="hljs-number"><span class="hljs-number">5</span></span> ),      , <i></i>  <span class="hljs-number"><span class="hljs-number">2</span></span>   .        <code>{ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span> }</code> .       <code>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]</code>  <code>[<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]</code> ,      (    , <i></i>    <span class="hljs-number"><span class="hljs-number">2</span></span>),      <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> .        , , LINQ,   <code>{ <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> }</code> —    <code>{ <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code><span class="hljs-type"><span class="hljs-type">int</span></span>.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range <span class="hljs-keyword"><span class="hljs-keyword">class</span></span></a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">Range<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>: A Low-Memory <span class="hljs-keyword"><span class="hljs-keyword">Set Data</span></span> Structure <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx"><span class="hljs-keyword"><span class="hljs-keyword">Language</span></span> Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       <span class="hljs-type"><span class="hljs-type">Time</span></span> Period Library  Jani Giannoudis.      <span class="hljs-number"><span class="hljs-number">2011</span></span>  CodeProject,     (  — <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">2013</span></span>),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </pre> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <h3> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </h3> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <hr> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <h3> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </h3> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> <ul><li> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </li> <li> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </li> <li> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </li> <li> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </li> <li> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </li> <li> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </li> <li> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </li> </ul> <code><code><code><code><code><code><code><code><code><code><code><code><code>IComparable.     ,       ,         C# —         IComparable.  ,       ,       .  ,   ,        (reversing)            ,        . ,    . <br> <br>   —      ,            «-»,    ,             ().      :       IComparer,    Comparison?    ,  IComparer, ,     ,     .   ,      Comparer.Default       .   ,    ,     Comparison,    ,  - (    MiscUtil). <br> <br>        ,  ,        :        «»   ,      ,        ,    ,     «»      ? ,  ,    ,   «»,   API    . <br> <br> ,  ,     ,   ,        .      : <br>    ()   (inclusive)   (exclusive),  ,       .       ,    ,      ?   ,     , ..      ?      ,      ()?      ,     ? <br> <br>           ,      , .. ,      ,   . ,            (),   —  ().   ,      ,    «»  «»  .  ,          ,           .          null</code>      «»  ,  -     <code>null</code> ;     « »,    <code>null</code> —     ,       .  ,  ,         ,        <code>default(IComparer), , ,     null</code> .             . <br> <br>       ,    :     (immutable). , ,    ,           ,   ,   «»      (,  )   . <br> <br>      <br>   .    —        . <br> <br> <code class="cs">public sealed class Range&lt;T&gt; { public T LowerBound { get; private set; } public T UpperBound { get; private set; } public bool InclusiveLowerBound { get; private set; } public bool InclusiveUpperBound { get; private set; } public IComparer&lt;T&gt; Comparer { get; private set; } public Range(T lowerBound, T upperBound, bool inclusiveLowerBound = true, bool inclusiveUpperBound = false, IComparer&lt;T&gt; comparer = null) { LowerBound = lowerBound; UpperBound = upperBound; InclusiveLowerBound = inclusiveLowerBound; InclusiveUpperBound = inclusiveUpperBound; Comparer = comparer ?? Comparer&lt;T&gt;.Default; if (Comparer.Compare(LowerBound, UpperBound) &gt; 0) { throw new ArgumentException("Invalid bounds"); } } public bool Contains(T item) { int lowerCompare = Comparer.Compare(LowerBound, item); if (lowerCompare &gt; (InclusiveLowerBound ? 0 : -1)) { return false; } int upperCompare = Comparer.Compare(item, UpperBound); if (upperCompare &gt; (InclusiveUpperBound ? 0 : -1)) { return false; } return true; } }</code> <br> <br>  ,          ,    ,            …       . ,          «» (..  )  /  ,            .   <code>Contains</code>   ,    -  ,    . <br> <br>          ()    ().      ,      ,    .          ( <code>readonly</code> )  -  ,                . <br> <br>        <code>WithExclusiveLowerBound</code> , <code>WithInclusiveLowerBound</code> , <code>WithLowerBound</code>  ..,          .           -,       ,            .    -  : <br> <code class="cs">var range = Range.Of(5, 10);</code> <br> ,    — ́  ,          ,       .     ,   ,      . <br> <br>  <br>        .  ,         ( , stepping function),          .        :    ,   ,   . <br> <br>   ? <br>       ,       —      .   ,    — . ,     (0, 50),      ,      — 5.       1 (   )    5 (   0    )?          ,      ,  ,    () .  ,   -      <code class="cs">IComparer,        .   «»      (41, 37),    23, 12  44,   38.          . <br> <br>       ,      ,     .  ,     —     , ,       : <br> var range = new Range&lt;int&gt;(0, 50, false, false); var simpleIterable = range.StepBy(x =&gt; x + 5); var equivalentIterable = range.WithInclusiveLowerBound() .StepBy(x =&gt; x + 5) .Skip(1);</code> <br>        :    ,    <code>IEnumerable.      IEnumerator,        IEnumerable:      foreach</code> , LINQ  .. <br>      , … <br> <br>  ? <br> -,    .       ,       «» ,        ,       .    ,    ,   (0, 255)       <code>Byte</code> .        : <br>      :   ,    ,   —    .    ,         «».        : <br> *  <code>Func&lt;Tuple&lt;bool, T&gt;&gt;</code> ,      . <br> *     ( <code>out</code> )  (   ) <br> *   <code>null</code>   «  »,       ,    <code>T</code>   . <br>  ,       «» - ,    ()       (    «»). <br>   ,     , ,  ,      ,        «  n   ». ,               ,        ,      . <br> <br>  <br> ,   ,    ,     .      MiscUtil,    ,       —         .        ,           .  MiscUtil    <a href="http://pobox.com/~skeet/csharp/genericoperators.html">  </a>    ( <i>Marc Gravell</i> ),        ,     (+),       ,      . <br> <br> ,  : <br> <code class="cs">public IEnumerable&lt;T&gt; StepBy(Func&lt;T, T&gt; step) { T current = LowerBound; //    ,      if (!InclusiveLowerBound) { current = step(current); } while (Contains(current)) { yield return current; T next = step(current); // Handle a stepping function which wraps // round from a value near the end to one // near the start; or a stepping function // which does nothing. if (Comparer.Compare(next, current) &lt;= 0) { yield break; } current = next; } }</code> <br>     :   «»      ,     ,   ,       .  ,     :      ,  ,   ,   ,  ,     ,  ,     . <br> <br>      ( if) —    : <br> <code class="cs">T current = InclusiveLowerBound ? LowerBound : step(LowerBound);</code> <br>     —   , —   . <br> <br>   :         .  ,      —    ? <br> <br>     <br>      (reversing)  ,      .        ,    «» / «»  ,    .  ,    (reversing comparer)   —   ,   ,       .    ,    «» : <br> <code class="cs">public sealed class ReverseComparer&lt;T&gt; : IComparer&lt;T&gt; { private readonly IComparer&lt;T&gt; originalComparer; public ReverseComparer(IComparer&lt;T&gt; originalComparer) { this.originalComparer = originalComparer; } public int Compare(T x, T y) { return originalComparer.Compare(y, x); } }</code> <br>      « »,    ?  ,   <code>Compare</code>       (negate)      …    ,    <code>originalComparer.Compare</code>  <code>int.MinValue</code> .    ,   ,    <code>int.MinValue</code> .       —        <i></i>  ,    ,     ,    . <br> <br> <i> .</i>         ,     <code>int.MinValue</code>  . <a href="http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx">  </a> <code><a href="http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx"></a> <code><code>IComparer ,  ,   ,   int Compare(T x, T y)  ,   :   x</code>  <code>y</code>   0;  <code>x</code>  <code>y</code> ,    0;  <code>x</code> ,  <code>y</code> ,    0.   .NET Framework,   ,     <code>x</code>  <code>y</code>  -1  +1,      ,    <code>int.MinValue</code> ( <code>x</code>  <code>y</code> )  <code>int.MaxValue</code> ( <code>x</code>  <code>y</code> ).        ,    .    0   ,  <br> |int.MinValue| == int.MaxValue + 1.   ,      <br> <code>Int32 i = Int32.MinValue; Int32 j = -i;</code>  <code>j</code>    <code>int.MinValue</code> ,   <code>int.MaxValue</code> ,    . ,        ( <code>checked</code> ),     <a href="http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx"><code>System.OverflowException</code></a> ,     production-   .</code> <br> <br> ,     ,       <code>Range</code>  <code>Reverse</code> : <br></code> <code class="cs">public Range&lt;T&gt; Reverse() { return new Range&lt;T&gt;( lowerBound: UpperBound, upperBound: LowerBound, inclusiveLowerBound: InclusiveUpperBound, inclusiveUpperBound: InclusiveLowerBound, comparer:new ReverseComparer&lt;T&gt;(Comparer)); }</code> <br> ,     ,     ,   «»     (    ,     ),         .         ,   C# 4, ,  ,  ,            . <br> <br>    ,   :      ,   ,    ,           . ,   <code>[0, 5]</code> (..  0   5 ),      , <i></i>  2   .        <code>{ 0, 2, 4 }</code> .       <code>[0, 5]</code>  <code>[5, 0]</code> ,      (    , <i></i>    2),      <code>{ 5, 3, 1 }</code> .        , , LINQ,   <code>{ 4, 2, 0 }</code> —    <code>{ 5, 3, 1 }</code> . <br> <br>  <br>  ,     « »,        ,   .       ,    ; ,      ,        .         ,  ,     ,  ,  <code>int.MinValue</code> .  ,  , <a href="">   </a>    -,      . <br> <br> <br>   <br>             , ,   ,    .NET. <br> Dmitri Nstruk. <a href="http://www.codeproject.com/Articles/538561/Ranges-in-Csharp">Ranges in C#</a> Qwertie. <a href="http://www.codeproject.com/Articles/604345/D-styleplusrangesplusinplusC-23plus-NET">D-style ranges in C# (.NET)</a> Sean Hederman. <a href="http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class">Building a Generic Range class</a> Scott McMaster. <a href="http://www.codeproject.com/Articles/10308/RangeSet-A-Low-Memory-Set-Data-Structure-for-Integ">RangeSet: A Low-Memory Set Data Structure for Integers</a> Jay Bazuzi. <a href="http://blogs.msdn.com/b/jaybaz_ms/archive/2004/08/19/217226.aspx">Comparing ranges</a> Sergio Pereira. <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/01/02/language-envy-c-needs-ranges.aspx">Language Envy - C# needs Ranges</a> Andy Clymer. <a href="http://andyclymer.blogspot.com/2009/03/ruby-ranges-in-net.html">Ruby Ranges in .NET</a> <br>     ,        ,       MiscUtil.      ,    ,      . -,    ,             ,   .   Range  MiscUtil     ,      ,    <code><a href="http://www.codeproject.com/Articles/168662/Time-Period-Library-for-NET"></a> <a href="http://feelnet.blogspot.com/2012/04/net.html"></a> RangeIterator.   <i> </i> ,            MiscUtil,      ,       " ". <br> <br>          ,       Time Period Library  Jani Giannoudis.      2011  CodeProject,     (  — 1  2013),   - (  -      ),     Silverlight  Windows Phone.    overkill             <a href="https://habrahabr.ru/users/hdrummer/" class="user_link">hDrummer</a> .</code></code></code></code></code></code></code></code></code></code></code></code></code> </blockquote> </div><p>Source: <a href="https://habr.com/ru/post/197024/">https://habr.com/ru/post/197024/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../196998/index.html">Facebook, Steve Ballmer and Al Gore - everyone tried to buy Twitter</a></li>
<li><a href="../197008/index.html">Storage of service bases Team Foundation Server 2013 RC on SQL Server 2014 PAGE1</a></li>
<li><a href="../197010/index.html">Electronic services in Russia will be reduced</a></li>
<li><a href="../197014/index.html">Simple image and content slider on AngularJS</a></li>
<li><a href="../197018/index.html">OSA Rescuer - a system for building GPS routes for evacuation from disaster zones [First Experience]</a></li>
<li><a href="../197026/index.html">How GitHub is released</a></li>
<li><a href="../197028/index.html">The story of two bridges</a></li>
<li><a href="../197030/index.html">FreeNAS 9.1.1 - we create network storage. Part 2. Installation transmission</a></li>
<li><a href="../197034/index.html">I know that you know, that I know that you know ...</a></li>
<li><a href="../197036/index.html">Linux for professionals: how to prepare a layout for printing in a print shop</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>