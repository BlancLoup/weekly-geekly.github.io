<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Difficult about simple: ESLint in a team</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A little introduction. Most likely this post will be interesting only to those who know what ESLint is, but still I will do a little introductory - an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Difficult about simple: ESLint in a team</h1><div class="post__text post__text-html js-mediator-article">  A little introduction.  Most likely this post will be interesting only to those who know what ESLint is, but still I will do a little introductory - and then I myself get very upset when I open a publication, and it begins with the words ‚Äúfor 10 years we have been using xxx, which of course you you know, and we decided to write about xxx.yyy that no one ever did, but surely this is very cool. ‚Äù <br><br>  So, <a href="http://eslint.org/">ESLint</a> is a cool tool that allows you to analyze the quality of your code written in any selected JavaScript standard.  He leads the code to a more or less uniform style, helps to avoid silly mistakes, knows how to automatically fix many of the problems found and perfectly integrates with many development tools (hello, Jetbrains, we love you!).  By the way, he, like other linters, does not oblige you to one particular style.  On the contrary - you can choose something from the best practices and refine it on your own! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/4b8/28f/bca/4b828fbca6014be3b83a75421016e8d4.jpg"></div><a name="habracut"></a><br>  Among the applications you can find rather unexpected cases - for example, a legacy code may be easier to get rid of by automatically correcting the linter, leading to modern standards in which errors are better visible than trying to edit it as it is.  As a result, invalid constructs may well turn out - but, according to our observations, this means that before the conversion, there was just a disgusting code. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In general, living without a linter in Node.JS in 2017 is the same as writing code in a notepad while sitting on one hand. <br><br>  And today I will tell you how we decided to implement it in order to work effectively with it in a team, and not one by one. <br><br>  The big guys do a linter check as part of their CI process, and we'll get to that soon.  But for now, we need to realize the primary need - launching the linter from the developer, with the guarantee that everything will take off and work more or less the same way. <br><br>  It would seem - what is this, add. Eslintrc.json to the project, and let's go!  However, the question arises - how, where and by whom should ESLint be installed and a pack of plug-ins necessary for our code style?  Three approaches are usually used for this: <br><br><ol><li>  Let's put them in devDependency; </li><li>  Let's not put them anywhere.  Let everyone be globally standing mocha \ eslint \ other. </li><li>  Let them put everything and drive checks will task managers like gulp or grunt. </li></ol><br>  The second option is swept away immediately - I think it is clear that in this way the versioning of the tool itself from project to project disappears, and simply putting a lot of tools and plug-ins globally is not at all cool. <br><br>  The third option is not bad, but until now we somehow did without task managers.  To add them to projects for the sake of such a task is an obvious overkill. <br><br>  The first option is generally optimal for github projects, but is not well suited for commercial development.  Our CI provides for automated testing on test servers, and test dependencies can be set apart from devDependencies.  But this is not the problem, but, in contrast to autotests, the tools for the linter should not fall on test servers.  At least for the reason that then, when rolling out, the project suddenly begins to weigh more than 200 megabytes instead of 30. To some, this may seem insignificant, but to comply with the PCI DSS standards, we all use pretty serious encryption of any information, so rolling the update on 200 megabytes takes precious minutes.  So the first version does not suit us either.  Summing up: <br><br><ul><li>  Linter and its plugins do not have to stand globally; </li><li>  A specific project must be tied to specific versions of the tools; </li><li>  These tools should not be in dependencies or devDependencies. </li></ul><br>  At first glance, a simple solution suggests itself: make an npm script, for example, npm run lint-install, which will pull a bash script that installs all packages of the specified versions via the command line.  But, in addition to the clumsiness of such a solution, it also turns out that some of the dependencies (albeit the developer ones) leave package.json for some separate bash script ... And this is not cool at all.  We think further, we recall the specifications package.json.  In general, no one will hurt us to add any sections there as well - but I would like to follow certain standards. <br><br>  From <a href="">the package.json specification</a> , we recall that there is such a rather strange and rarely used section, like <b>peerDependencies</b> : <br><br><blockquote>  It is not always necessary to make it necessary for your computer.  This is usually referred to as a plugin.  Notably, your module documentation should be notable. </blockquote><br>  They are not automatically placed, with the exception of a small pitfall: <br><blockquote>  NOTE: If you are not explicitly dependent on the dependency tree.  In the next major version of npm (npm @ 3), this will no longer be the case.  You will receive a warning message that the peerDependency is not installed instead.  The behavior in npms 1 &amp; 2 was a matter of course. <br></blockquote><br>  Fortunately, we no longer had npm, so we could safely use this section without fear of sudden consequences.  But the problem came from no waiting ... It turned out that when uninstalling the automatic installation of peerDependencies, the authors of npm ... They didn‚Äôt make any way to install them manually.  So all that is now for the peerDependencies section is a warning that they are not installed.  In part, these are understandable, since these dependencies are optional, but still.  I have a suspicion that after such a change, all the developers simply transferred everything to devDependencies ... And dependency hell did not go anywhere. <br>  By the way, not only the absence of such an option seemed strange to me.  There is even an <a href="https://github.com/npm/npm/issues/11213">issue about this</a> - it is closed, but marked as patch-welcome.  That is, the authors of npm generally agree that this is a cant - they simply do not have enough time to fix it ... <br><br>  So, we now have a section, but it is not clear how to use it.  There are 18 likes of the same issue here: <br><br><pre><code class="bash hljs">npm info . peerDependencies | sed -n <span class="hljs-string"><span class="hljs-string">'s/^{\{0,1\}[[:space:]]*'</span></span>\<span class="hljs-string"><span class="hljs-string">''</span></span>\{0,1\}\([^:<span class="hljs-string"><span class="hljs-string">'\'</span></span><span class="hljs-string"><span class="hljs-string">']*\)'</span></span>\<span class="hljs-string"><span class="hljs-string">''</span></span>\{0,1\}:[[:space:]]<span class="hljs-string"><span class="hljs-string">'\'</span></span><span class="hljs-string"><span class="hljs-string">'\([^'</span></span>\<span class="hljs-string"><span class="hljs-string">''</span></span>]*\).*$/\1@\2/p<span class="hljs-string"><span class="hljs-string">' | xargs npm i</span></span></code> </pre> <br>  In my opinion, hell.  As a team leader, I just cannot allow this to come into our projects ... <br><br>  In general, the idea went further in the direction of writing or finding a tool that can parse package.json itself and call npm install - but not as tough as the script described above.  More or less I was satisfied with npm-install-peers.  He has two minuses: <br><br><ol><li>  If, for some reason, it does not find the npm installed in the system (through which it is now actually put), then it ... It installs it again locally, which causes the expenditure of time, traffic, and sometimes all sorts of hellish errors. </li><li>  He does not support any arguments.  If the symlinks on windows can already be turned on, and --no-bin-links is no longer relevant, then --production is still desirable.  For the same linter dependencies, this would greatly save installation time. </li></ol><br>  Probably in the near future I‚Äôll just do a similar installer that does the same thing, but draws npm not as a module, but through bash.  It‚Äôs not so beautiful, but everything is clear with the arguments, and you don‚Äôt need to install npm a second time.  And it would be desirable to transfer arguments - at least not to put devDependencies from eslint and its plug-ins. <br><br>  Then the question arises - how to install npm-install-peers globally?  Assume that it is the default?  Set silently when executing the script?  Set locally in devDependencies?  I did not like any of the options.  As a result, I was satisfied with this simple solution: <br><br><pre> <code class="hljs sql">"lint-<span class="hljs-keyword"><span class="hljs-keyword">install</span></span><span class="hljs-string"><span class="hljs-string">": "</span></span>npm-<span class="hljs-keyword"><span class="hljs-keyword">install</span></span>-peers || echo <span class="hljs-string"><span class="hljs-string">'Please run npm install -g npm-install-peers first'</span></span><span class="hljs-string"><span class="hljs-string">",</span></span></code> </pre> <br>  This option seemed to me the most transparent for the developer. <br><br>  And all that remains is to add a script to start the linter and the peerDependencies we actually need.  Script: <br><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"lint"</span></span>: <span class="hljs-string"><span class="hljs-string">"./node_modules/eslint/bin/eslint.js app.js routes modules test App.js"</span></span></code> </pre><br>  Dependencies: <br><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"peerDependencies"</span></span>: { <span class="hljs-string"><span class="hljs-string">"babel-cli"</span></span>: <span class="hljs-string"><span class="hljs-string">"^6.23.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"babel-preset-es2015"</span></span>: <span class="hljs-string"><span class="hljs-string">"^6.22.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"eslint"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.16.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"eslint-config-airbnb"</span></span>: <span class="hljs-string"><span class="hljs-string">"^14.1.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"eslint-plugin-import"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.2.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"eslint-plugin-jsx-a11y"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.0.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"eslint-plugin-promise"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.4.2"</span></span>, <span class="hljs-string"><span class="hljs-string">"eslint-plugin-react"</span></span>: <span class="hljs-string"><span class="hljs-string">"^6.10.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"eslint-plugin-standard"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.0.1"</span></span> }</code> </pre><br>  By the way, as a side feature, we can now put into the peerDependencies any other dependencies that do not belong to the tests - for example, the divine <a href="https://www.npmjs.com/package/jsdoc-to-markdown">jsdoc-to-markdown</a> . <br><br>  It would seem - a simple task ... But there were quite a lot of interesting nuances.  And I fully admit that it was possible to make it easier and better.  And how do you use linters for corporate projects? </div><p>Source: <a href="https://habr.com/ru/post/322550/">https://habr.com/ru/post/322550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322540/index.html">The first experience of developing games for Apple Watch</a></li>
<li><a href="../322542/index.html">Backups as a way to avoid extra costs during infection with cryptographer</a></li>
<li><a href="../322544/index.html">2fa implementation experience on linux with duosecurity</a></li>
<li><a href="../322546/index.html">Teaching without a teacher. How to become a professional without a mentor</a></li>
<li><a href="../322548/index.html">How to add AppIcon and LaunchScreen to React Native App</a></li>
<li><a href="../322552/index.html">How much will your mobile game earn?</a></li>
<li><a href="../322554/index.html">JPEG technology: decision space analysis</a></li>
<li><a href="../322558/index.html">Making a living by creating games</a></li>
<li><a href="../322560/index.html">Bridge-domains and virtual-switch in JunOS</a></li>
<li><a href="../322562/index.html">Architecture of the growing project on the example of VKontakte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>