<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The complexity of the development of a medical bracelet in Russia</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Capacitive sensors for removing one ECG lead - two for each medical bracelet 

 We decided to make a medical bracelet. In our team, everyone closely d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The complexity of the development of a medical bracelet in Russia</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/944/ce7/1df/944ce71df0d6a5c34646139a3bc6bc59.jpg"><br>  <i>Capacitive sensors for removing one ECG lead - two for each medical bracelet</i> <br><br>  We decided to make a medical bracelet.  In our team, everyone closely deals with medical equipment and IT.  For example, my last major project is the design and launch into production of a portable compact ECG instrument (a remote analogue of the Holter monitor). <br><br>  <b>Our task is to make a wearable device of exactly medical orientation.</b>  Not a fitness bracelet, which in the market a dime a dozen, but a means of collecting detailed information about health.  The information obtained will be further processed both automatically and by doctors.  The user will receive alerts, and in the event of an alarming or critical situation an emergency emergency call is possible.  Another advantage is the recommendations for improving the quality of life, for example, an indication of stress or control of physical activity. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/f26/d72/24f/f26d7224f5f2dd87e575cb3133d64fc1.png"><br><br>  We know for sure that such elderly devices are necessary for your elderly relatives, pregnant women, the disabled, athletes, the military, rescuers, people of other dangerous professions.  In general, to all those who care about their health.  Therefore, now we will tell you how we are going to make such a device in Russia and from what, plus I outline a circle of technical problems. <a name="habracut"></a><br><br>  So let's start with the simplest.  Here is one of the early prototypes of the bracelet device: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb2/325/0f1/cb23250f1c3d94471fcce24853069817.jpg"><br><br>  As you can see, we planned a wearable device consisting of modules.  The base platform - the green part - will be worn constantly and fix the most important indicators.  Additional modules will dress side by side, connect with the basic part on the basis of the designer and expand the functionality of the bracelet. <br><br>  Accordingly, here is the layout of the device, which can already be seen live (there is no electronics, everything is outside on the debug board): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5c/a07/236/a5ca0723608dca5c6dd66d89bdfdd79d.jpg"><br>  <i>Bracelet Assembly</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a05/d22/21f/a05d2221f152324e6834e03bc7d2fc1d.jpg"><br>  <i>Sensors adjacent to the skin (contact pads are visible inside the bracelet)</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a80/927/c00/a80927c006f681771341149212940fa4.jpg"><br>  <i>Additional modules</i> <br><br>  This layout is printed on a 3D printer, then the surfaces are hand-finished and painted.  For some reason, the green ring later exfoliated.  But since the model has already fulfilled its role, we decided to postpone its restoration ‚Äúfor later‚Äù. <br><br>  Now let's look at the board.  we are now testing and refining the functionality on the debug board (before that, there was a fairly large booth where we checked the sensors). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/23f/742/eb2/23f742eb2ca58974b890b9f690ce8a5e.jpg"><br>  <i>Board with screen</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a80/3ba/944/a803ba9440fca9573087e14ca222a1ad.jpg"><br>  <i>ARM on board</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b9/a07/96d/0b9a0796d53aee88642bb40c54ccabee.jpg"><br>  <i>More markings closer</i> <br><br>  This board and sensors are ready.  The next step is to ‚Äúrepack‚Äù this into a more compact format that fits into a wearable bracelet.  The task is rather nontrivial, and may require quite a long optimization both in the trace of the board and in its configuration.  Technical design, design, circuit design, circuit board installation and optimization are done by us, our specialists.  World-class electronics, we are traditionally strong. <br><br>  But let's go back to the bracelet itself.  So, here is another layout: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7da/867/e92/7da867e92b07bb8c55022b4388bab787.jpg"><br><br>  As you can see, the size of the bracelet is not very large.  This is one of the main difficulties of development - the bracelet should be compact.  One of the most voluminous elements is the battery, so to solve the problem we need to fight to reduce energy consumption.  We want the bracelet to work for at least a day (and preferably two or three) without the need for recharging.  In our previous projects, such a question did not stand - on special medical equipment, for example, an ECG monitor, you can simply put any desired battery and attach it to the patient on a belt, here size is a critical factor. <br><br><h4>  Architecture </h4><br><br>  <b>Base module:</b> <br>  - Processor board with controller <br>  - Removable flash-drive <br>  - Power control <br>  - Display <br>  - Basic communication interfaces <br>  - Base battery <br>  - Accelerometer <br>  - Vibrating motor (for notifications) <br>  - Piezodinamik (for notifications) <br>  - Temperature sensor <br>  - Pulse Oximeter <br><br>  <b>Power module (green)</b> - about it below. <br><br>  <b>ECG module (yellow).</b>  On it is an ECG pickup device and two sensors.  There are also contacts for measuring the electrodermal reaction (galvanic skin reaction). <br><br><h4>  What sensors do we use and what are we for? </h4><br><br>  - <b>Accelerometer</b> .  The easiest sensor in terms of integration, but at the same time - one of the most difficult to handle.  The fact is that his testimony can be used to determine motor activity, and as a pedometer, and to determine falls and other abnormal situations.  Data comes from it is very noisy, and very much depends on the logic of their processing.  The complexity of data processing for obtaining some indicators is much higher than we expected - and we have a strict requirement not to miss alarming cases (that is, inaccuracies, we will output to rare false alarms so as not to miss the case that really needs attention, but they will disturb the owner ). <br>  - <b>The temperature</b> .  One of the main problems for the temperature sensor is the need for tight skin contact.  At first we wanted to use sensors based on infrared measurement, but we quickly found out that their power supply did not fit into any gate.  Then we took this sensor: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/73d/383/d35/73d383d356b0ac5bcf52f0535f1fdcd2.jpg"><br><br>  And they tried to put it on a bracelet with a flexible strap with a clasp.  He almost did not lose contact (only with sudden movements), which, in general, is easily filtered.  In general, when measuring temperature, two considerations need to be taken into account.  Firstly, temperature is a rather slow indicator, so frequent measurements are not needed.  In our case, the temperature is removed from the skin of the wrist, so taking into account the absolute values ‚Äã‚Äãdoes not make much sense, useful information can only be a change in temperature.  Secondly, we measure the temperature of a person on the arm not for clinical diagnostics (for these purposes it is measured in other places) - therefore its specific value is not very important to us, the dynamics of change is important.  And, accordingly, the treatment is built around this. <br>  - <b>Electrodermal</b> reaction (EDR, galvanic skin reaction, skin resistance).  Simplified, allows you to evaluate the instantaneous (current) level of stress.  Sensors of this kind are used in polygraphs (lie detectors).  We intend to track the occurrence of strong emotional, pain reactions, stress levels, and so on.  There are three basic applications: an alarming message to the operator when the user suddenly experiences pain, determining the stress state of the body (for example, a bracelet can tell you that it is time to stop listening to a screaming boss and go for a walk), determining dangerous conditions (for example, during information overload with frequent switching of attention risk of losing attention, falling asleep in dangerous situations).  Monitoring EDR is one of the most important for representatives of hazardous occupations and for professions associated with increased responsibility.  We can fix the state of reduced reaction after stress and deterioration of cognitive abilities - this is important for pilots who spent the night in an airplane, guards, and so on. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c75/981/d30/c75981d30110825d2b306eb8ea0d6b66.jpg"><br><br>  - <b>Electrocardiogram</b> .  We receive one ECG lead, for which we use capacitive sensors.  The usual medical cardiograph allows you to shoot 12 leads.  This is necessary to obtain an accurate clinical picture.  It is enough one assignment for monitoring of the general activity of heart and identification of atypical conditions.  That is, the task of this group of sensors is to monitor the ECG in natural conditions and send warnings (from additional measurements to the need to visit the doctor), but not an independent diagnosis.  Signal registration requires two sensors: one on the inside of the bracelet and the other on the outside.  We need to install a finger on the external sensor and hold the contact for about 3-5 minutes.  At the same time, the bracelet analyzes the data obtained, and if it is noisy, it either extends the procedure or suggests to do it again.  There are alerts on the basis of the previous group of sensors and pulse oximetry that tell a person: "Let's get an electrocardiogram right now, this is really necessary."  Monitoring is done in a similar way - a bracelet every half an hour can remind you about the procedure.  But to run with a finger on the bracelet for treadmill test will not work. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6cf/31a/13b/6cf31a13b6ac11f7f66b5930ab53d868.jpg"><br>  <i>Finger need to put here.</i>  <i>The metal at the edges of the sensor is earth.</i>  <i>The devices themselves are made in South Korea by a little-known manufacturer.</i> <br><br>  - <b>Pulse oximetry</b> .  The pulse oximeter sensor removes the pulse wave, pulse rate and saturation indicator (saturation level of hemoglobin of arterial capillary blood with oxygen).  Such a dangerous condition as hypoxia (chronic oxygen deficiency) can be determined in this way.  The method has certain restrictions on the conditions of use, for example, a pulse oximeter will give erroneous readings in bright light, poor contact with the skin surface, as well as in cases of carbon monoxide poisoning.  China produces a huge variety of devices that use roughly the following sensors: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a39/398/4e5/a393984e54787190221ee17aa2499a48.jpg"><br><br>  In these devices, the LEDs on the one hand, and the photodetector on the other.  We found sensors that work in the reflected mode, without the need for a lumen and put a pair on the bottom of the bracelet. <br><br>  In combination with other bracelet sensors, this one will be very useful for people with chronic diseases of the cardiovascular system and the respiratory system. <br><br>  The blood pressure level can also be estimated from the totality of the measured ECG and pulse wave.  Of course, this is not an accurate measurement of blood pressure with a good blood pressure monitor, but you can get an idea.  The main advantage of this method is the absence of pneumo-cuffs. <br><br>  By the way, when measuring blood pressure, we follow the same approach as when measuring temperature - we measure the parameter not for clinical diagnostics (other devices are used for this purpose), but to monitor changes - therefore specific values ‚Äã‚Äãare not very important to us, the dynamics of change are important .  Approximately similar questions arise with each sensor and their complexes. <br><br><h4>  Screen </h4><br>  Color OLED or TFT displays consume huge amounts of energy.  Therefore, our choice was unequivocal - e-ink display, and the least power-consuming.  It is enough to update its status and forget for a few minutes until the user requests a new status or an event that requires redrawing occurs.  Working with the screen was relatively simple, although the downside was the complexity (for the designer) of preparing graphics for this screen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbe/5c4/943/fbe5c49433fdbfe138acbadb46922155.jpg"><br><br>  Also near the screen, it was necessary to put an ECG sensor.  During the development of the hull form, we exchanged dozens of such opinions here every day: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bcd/bea/18a/bcdbea18a8518cdcee76b68456272ede.jpg"><br><br>  Additional notification channels - vibration and sound. <br><br><h4>  Nutrition </h4><br>  We made the first expansion module (green bracelet ring) for additional power and charging.  It will contain a large-capacity battery, and it can also be used to recharge the main battery on the base module if you do not want to remove the bracelet. <br><br>  Charging itself is done via micro-USB.  The base module will have a smart controller that will protect itself from a deep discharge, it will control the charge level itself and will provide the basic charging logic in the absence of power on the control circuit, its activation and loading (after 2-3 months of the bracelet lying on the shelf). <br><br>  In case of emergency power off (for example, as a result of a bracelet dropping from a great height and flying apart), only the last half-second of data is not saved. <br><br><h4>  Connection </h4><br>  The bracelet constantly writes data to its memory (on the microSD card) and transfers them to the smartphone.  The main logic of working with a bracelet is implemented in an external application - there is a big screen of a phone, tablet or personal computer, and sufficient computing power, and an Internet connection.  Bracelet, application and server - this is where the main information processing takes place. <br><br>  Communication with the phone takes place via Bluetooth LE 4.0.  Data transfer to analytical servers occurs over mobile networks.  The 4th version specification allows you to disable the module between short communication sessions ‚Äî that is, enable it only for sending a packet ‚Äî and turn it off again;  90% of the time the module will be turned off.  We put the corresponding chip and checked the work in this mode under high load - indeed, the power consumption has decreased significantly.  But there was another problem - this mode does not allow data to be transmitted at high speed. <br><br>  There are two Bleutoth modes: for transfer in real time and for transfer of the accumulated amount of information - switching occurs through the application.  Now we are looking for a suitable chip that can switch to different bluetooth modes - and check different options on the stand. <br><br>  Another way to transfer data to the same doctor is to simply transfer via USB. <br>  Of course, you can simply remove the microSD card, but it is not yet decided whether we are ready to support the file system on it. <br><br>  Re-flashing and service sharing is done via a USB port from a desktop computer. <br><br><h4>  Data processing logic </h4><br>  By itself, a bracelet is just a set of sensors that stores data in the internal flash-memory and simultaneously sends it to an external device.  Plus simple basic data processing.  The second processing layer is the app on the smartphone.  Considering that our main difficulty in working with sensors is signal processing (filtering, signal recognition, calculating contact points, determining the normal state of a person), the application is quite resource-intensive.  All complex intellectual data processing is carried out on the third layer - servers of our data center.  This is very important, because we give practically raw data through a smartphone application in the data center.  The accuracy of the data interpretation of the bracelet depends on the correctness of the code and the amount of accumulated data.  Accordingly, the new version of the application or the update of machining mechanics immediately, from the point of view of users, increases the accuracy of the sensors. <br><br>  But!  At the same time, the bracelet itself handles alarm conditions ‚Äúon board‚Äù. <br><br>  <b>Now there are the following alarms:</b> <br>  - The fall of the bracelet - we can already accurately determine the fall to the floor just like that and the fall along with the body (at least with your hand).  The second case immediately gives an alarm. <br>  - Sharp pain - the bracelet instantly reacts to this fact, and at a certain level of pain generates anxiety. <br>  - Anxious change in heart rate (too rare, uneven, absent or significantly speeded up). <br>  - Anxious change in saturation (risk of hypoxia). <br>  - The loss of a signal or the output of a group of signals in the aggregate beyond the norm is also an alarm. <br><br><h4>  Software features </h4><br>  It is worth noting that the flow of alerts is sent immediately to the service of the doctors on duty (there will be an alarming service, which is notified in real time when alarm situations are identified), you can share them with relatives, the treatment results can also be unloaded to your doctor, who, if necessary, will invite you to the reception. <br><br>  We intend to open the API of both our entire device and communication protocols.  This will make it easy to release any additional data analysis applications, external modules for the bracelet, as well as to take data even from your laptop, even from another device without our software. <br><br><h4>  Important notes </h4><br>  Despite the fact that we are planning to certify as a medical device, it should be very accurately understood that the bracelet can generate alarm messages, can remind you about medications, can take different indications and monitor them, can inform you about health changes and help maintain it - but in no case can not serve as a device for clinical diagnosis.  That is, in case of any problems, you will not have to wait ‚Äúuntil tomorrow, maybe the ECG will become better‚Äù, and immediately consult a doctor.  And conduct a comprehensive stationary inspection. <br><br><h4>  Total </h4><br>  Now we have a device in the form of a debugging board and an exact understanding of how it should look and work.  There are surprises ahead of the assembly: for example, we cannot yet figure out how the CPU heat will affect the accuracy of the temperature sensor, whether there will be pickups with tight assemblies, and so on.  Most likely, on the way to the final version, 3-4 iterations will be required. <br><br>  We are not the only ones who make a bracelet for medical purposes.  While other developers, in particular, the grandees of the global mobile high-tech are more often focused on devices and fitness applications, there are projects that are competitive to us.  However, I hope that you will like our open API project, and you will want to join its development.  If suddenly among you there are developers of complex signal processing algorithms (not necessarily biomedical) and medical data interpretation, I would love to talk or invite us to visit. <br><br>  Our goal is to release the Russian product to ours and to the western market.  There are no solutions of this level on the market yet, and we are proud to be doing something, let it be small, but at the forefront. <br><br>  If you are interested in the fate of the project, please write.  I can keep you up to date on development and testing. </div><p>Source: <a href="https://habr.com/ru/post/225785/">https://habr.com/ru/post/225785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225771/index.html">IBM Watson: where and how are the capabilities of the supercomputer now used?</a></li>
<li><a href="../225773/index.html">Victorian office</a></li>
<li><a href="../225777/index.html">In the US, washing with home delivery is gaining momentum</a></li>
<li><a href="../225779/index.html">Elon Musk is ready to reveal Tesla charging technology for the sake of expanding the electric vehicle market</a></li>
<li><a href="../225781/index.html">In Washington, counted the damage from cybercrime at 0.5% of world GDP</a></li>
<li><a href="../225787/index.html">How to build VDI for complex graphics</a></li>
<li><a href="../225797/index.html">TeamRadio Issue 2 - The Theory of Constraints with Anton Katkov</a></li>
<li><a href="../225799/index.html">How IT in St. Petersburg bridges the gap between city administration and residents</a></li>
<li><a href="../225801/index.html">0xDBE. New IDE for developers and admins of DBMS from JetBrains</a></li>
<li><a href="../225803/index.html">DevConf 2014: Master Class - how to back up MySQL in extreme conditions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>