<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Petya cryptographer will not receive money: we generate the hard drive unlock key ourselves</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On April 3, information on the detection of a new cryptographer appeared on Habrahabr, which encrypts not the individual files, but the entire disk pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Petya cryptographer will not receive money: we generate the hard drive unlock key ourselves</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/5f7/891/fd8/5f7891fd82744221a6ffb28b67fdeb69.png"><br><br>  On April 3, information on the detection of a new cryptographer appeared on Habrahabr, which encrypts not the individual files, but the entire disk partition (volume).  The program is called Petya, and its purpose is the NTFS file allocation table.  Ransomware runs low on the disk, with total loss of access to the volume files for the user. <br><br>  Petya also found a special masking scheme to hide the activity.  Initially, the cryptographer requests the user to activate UAC, masquerading as legitimate applications.  As soon as extended privileges are obtained, malicious software begins to operate.  As soon as the volume is encrypted, the cryptographer begins to demand money from the user, and a certain period is given for the payment of "redemption".  If the user does not pay the funds during this time, the amount is doubled.  "Field of Miracles", and only. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/yfCt35RTR-U%3Ffeature%3Doembed&amp;xid=25657,15700019,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhifqZo-ZGnAyhlIWxlnnRrMWBg_Uw" frameborder="0" allowfullscreen=""></iframe>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But the cryptographer turned out to be not very well protected by himself.  Twitter user nickname <a href="https://twitter.com/intent/user%3Fscreen_name%3Dleo_and_stone" rel="nofollow">leostone has</a> developed a key generator for Petya, which allows you to unlock disk encryption.  The key is individual, and the selection takes about 7 seconds. <br><br>  The same user has <a href="https://petya-pay-no-ransom.herokuapp.com/">created a website</a> that generates keys for users whose PCs have suffered because of Petya.  To obtain the key, you must provide information from the infected disk. <br><br>  <b>What do we have to do?</b> <br><br>  Infected media needs to be inserted into another PC and to extract certain data from certain sectors of the infected hard disk.  This data must then be run through the Base64 decoder and <a href="https://petya-pay-no-ransom.herokuapp.com/">sent to the site</a> for processing. <br><br>  Of course, this is not the easiest way, and for many users it may not be feasible at all.  But there is a way out.  Another user, <a href="https://twitter.com/intent/user%3Fscreen_name%3Dfwosar" rel="nofollow">Fabian Wosar</a> , created a special tool that does everything on its own.  For it to work, you need to rearrange the infected disk to another PC with Windows OS.  Once this is done, download <a href="">Petya Sector Extractor</a> and save it to your desktop.  Then we execute PetyaExtractor.exe.  This software scans all drives for Petya search.  As soon as an infected disk is detected, the program starts the second stage of work. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/785/acd/2d7/785acd2d7ab8735952949eb905f15f71.png"><br><br>  The extracted information must be uploaded to the site indicated above.  There will be two text fields, titled as Base64 encoded 512 bytes verification data and Base64 encoded 8 bytes nonce.  In order to get the key, you need to enter the data extracted by the program in these two fields. <br><br>  To do this, press the Copy Sector button in the program, and paste the copied data into the field of the Base64 encoded 512 site bytes verification data. <br><br>  Then in the program, select the Copy Nonce button, and paste the copied data into the Base64 encoded 8 bytes nonce on the site. <br><br>  If everything is done correctly, this window should appear: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/ac8/d0d/70e/ac8d0d70e7e2030a2a319c7283c4bc4c.png"><br><br>  To get the decryption password, click the Submit button.  A password will be generated for about a minute. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/4ac/13e/59a/4ac13e59a071bd09c88f9c40698dbc85.png"><br><br>  Write the password, and connect the infected disk back.  As soon as the virus window appears, enter your password. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/d24/fd6/766/d24fd676652f957034947b03883d59a9.png"><br><br>  Petya begins decrypting the volume, and everything starts working when the process is complete. </div><p>Source: <a href="https://habr.com/ru/post/392727/">https://habr.com/ru/post/392727/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../392717/index.html">Inflatable module MKS</a></li>
<li><a href="../392719/index.html">Choosing the current action camera with a resolution of 2-4k for $ 100</a></li>
<li><a href="../392721/index.html">How to embrace the immensity: the assembly system. NET Micro Framework Part 1</a></li>
<li><a href="../392723/index.html">Modern designers LEGO Education: from simple to complex</a></li>
<li><a href="../392725/index.html">Cello - living cell programming language</a></li>
<li><a href="../392729/index.html">Creating a cheap, versatile, gaming controller for mobile devices</a></li>
<li><a href="../392733/index.html">Project "Eye" Part 17</a></li>
<li><a href="../392735/index.html">Lenovo Pocket Projector: a small giant of a large screen</a></li>
<li><a href="../392737/index.html">Samsung has applied for patent smart contact lenses</a></li>
<li><a href="../392739/index.html">Fitness tracker for the first time helped save a person‚Äôs life</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>