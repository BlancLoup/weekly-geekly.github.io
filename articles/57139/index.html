<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mac Maniac. DropCopy for Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Do you remember the post about the extraction of devices and carriers in Mac ? So, that cute Eject has a friend - DropCopy: 
  
 Introduction 
 When I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mac Maniac. DropCopy for Windows</h1><div class="post__text post__text-html js-mediator-article">  Do you remember the <a href="http://habrahabr.ru/blogs/AutoHotKey/50707">post about the extraction of devices and carriers in Mac</a> ?  So, that cute Eject has a friend - DropCopy: <br> <a href="http://radikal.ru/F/s47.radikal.ru/i115/0904/39/9bb63058a57a.jpg.html"><img src="http://s47.radikal.ru/i115/0904/39/9bb63058a57at.jpg"></a> <br><h2>  Introduction </h2><br>  When I worked on Macs, I simply enjoyed the ease of transferring files between computers on a network using DropCopy.  You throw files into a black hole, choose from the drop-down list where to send, and these same files appear on the recipient's desktop.  Great!  But it has been 2 years since my dismissal, and there has been a bit of a break-down on poppies (especially in Final Cut Pro * I shed a tear *).  In the room next door the brother is sitting at his computer, I am at my own, there is still a laptop that everyone uses in turn and there is always a problem when you need to transfer a file from one computer to another.  What we did not get up: <br><ul><li>  Mailing </li><li>  By ICQ </li><li>  Via USB flash drive </li><li>  Through FTP (this is the most logical way) </li></ul><br>  It is worth noting an important point - General Microsoft Network Documents might have helped in this situation, but they have been turned off for a long time and so thoroughly that I don‚Äôt know how to turn them back on, I don‚Äôt want to remember, so I started to dig the other way and the result was (in my opinion) much better.  So for those who have this thing functioning, I think it makes no sense to read further. <br><a name="habracut"></a><br><h2>  Products for cooking </h2><br>  To perform we need: <br><ul><li>  ftp.exe utility (standard Windows component) </li><li>  IIS (need to install via Windows components) </li><li>  Instead of IIS, you can (and even better) use a third-party FTP server to your liking </li><li>  Icon DropCopy (blatantly steal from the very same Mac Drops) </li><li>  AutoHotKey for inventors or just an exe file for users </li></ul><br><h2>  Machine preparation </h2><br><br><h4>  Iis </h4><br>  Further work is dull and monotonous: On all machines it is necessary to put an FTP server.  Considering that I don‚Äôt like to install many additional programs, I decided to rummage through Windows and found IIS.  It has holes (I don‚Äôt know how new versions are, but the old ones did), but since my mini network is protected by a router, I sleep well, and I don‚Äôt have any paranoia ‚Äúsomeone wants to hack me‚Äù, who do you need me?  Therefore, first go through this path: <br>  <b>Control Panel \ Add or Remove Programs \ Windows Components</b> <br><img src="https://habrastorage.org/getpro/geektimes/post_images/06f/9b6/c55/06f9b6c5508cc9c4ba36478e5c34ff9f.png"><br>  Put a tick in front of IIS and click Details <br><img src="http://s51.radikal.ru/i134/0904/ea/73e024e9bfb9.png"><br>  It is logical that we need FTP from this list.  Next will be the installation and the first problem - perhaps it will require that you insert the disk from where you installed your Windows.  Since I put my Windows 2 years ago - I already forgot where it lies, but I still found the disk, But I think if I search the Internet, I can find a link to download this component without these adventures.  Mentally transfer to the future, where you still managed to put it.  We go further <br>  <b>Start \ Administration \ Internet Information Services</b> (what? You don‚Äôt have the Administration item? Uzhos! Forgive me the IT gurus that I do the work of Captain Obvious: Right-click on the <b>Start \ Properties \ Start Menu \ Configure \ Advanced \ Administration - Display in the menu "All programs" and "start"</b> ) <br>  I got distracted.  Next, select: <br><img src="http://s55.radikal.ru/i149/0904/50/a575cd4bb6ca.png"><br>  and right-click on our default FTP site \ Properties. <br><img src="http://s61.radikal.ru/i172/0904/27/866881bbd54e.jpg"><br>  This is the most insecure part, because it is not recommended to use <br>  anonymous connections, but I have nothing to fear, as I said.  Of course, you can create a user with a password instead of an anonymus, but I haven‚Äôt mastered it and I don‚Äôt need it, because I have only one user on my computer - an admin without a password, and IIS swears without a password. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/10b/f1a/680/10bf1a68021dfc46a7b8116815231a0b.jpg"><br>  Here the main point is the path of the home directory.  You must specify the desktop.  I do not know whether it will work with the ticked ticked Reading, so I left it just in case. <br><img src="http://s51.radikal.ru/i131/0904/ec/cd2e48be1445.jpg"><br>  The main problem is that the Desktop is protected by root, and the user IUSR_USRERNAME does not have privileges on this folder, so you need to rotate the thing for which the severe bearded admins will crucify me - you need to move the user IUSR_USRERNAME to the Administrators group.  Therefore: <b>Start \ Administration \ Computer Management \</b> <br><img src="http://i068.radikal.ru/0904/ec/a8d300af205f.jpg"><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a52/2e5/4ca/a522e54ca9b5dc363dc20ac228050b10.jpg"><br>  This should work, at your own peril and risk) But this is the path of an extremal, then an easy and safe path <br><br><h4>  Quick`n`Easy FTP Server </h4><br>  I have this program on my main computer.  Of course, it may not be very functional, but I have enough of what it offers.  I have it for a long time and I do not even remember where I found it.  <a href="http://narod.ru/disk/7787897000/Quick%27n%2520Easy%2520FTP%2520Server%2520v2.7.1%2520setup.exe.html">Link</a>  Here I just created a new user Tr with a plain password and indicated his Home Directory as the Desktop.  Ticks put to taste, but so that everything works) <br> <a href="http://radikal.ru/F/s48.radikal.ru/i122/0904/4d/9ce063f22292.jpg.html"><img src="https://habrastorage.org/getpro/geektimes/post_images/d5e/9ac/93c/d5e9ac93c480610d6e8e9994606a2631.jpg"></a> <br>  And this principle is all that needs to be done in this program.  It makes sense to throw its shortcut into autoload (it loads quickly and silently).  Now the main part is: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Implementation </h2><br>  First, check your firewalls and let this stream flow without obstructions.  Well now we are writing the code in the AutoHotKey language (I hope that with my explanations you can write it in any other language better, and if without my explanations, it's even better :-) At first the program was very simple, small and could only send a few pieces of files with names that do not contain spaces (one input path that contains two spaces, turned it into 3 input parameters that have no meaning).  But then the program began to overgrow with functionality, learned how to flip folders, nothing at all, and now it even has a progress bar. <br><img src="http://s51.radikal.ru/i134/0904/fc/74693b388395.jpg"><br>  Like the previous post, on the desktop is a shortcut to this program, and when we transfer files to it, it wakes up, reads the list of computers from config.ini and shows the menu: <br><img src="http://s47.radikal.ru/i116/0904/ea/8940d1ba8716.jpg"><br>  Our program will not delve into the subtleties of sockets and other problems.  she will still trust FTP.exe.  The logic with FTP.exe in our case is simple.  we write a script file based on the transferred files and at the end simply call ftp.exe with the following parameters: <br>  <b>ftp.exe -s: "C: \ Script File.txt"&gt; "C: \ Log File"</b> <br>  The script file looks like this: <br> <code>open 172.31.0.3 <br> anonymous <br> slau.andre@gmail.com <br> binary <br> mkdir "ftp" <br> cd "ftp" <br> put "C:\DOCUME~1\Kefir\0016~1\ftp\1.png" <br> put "C:\DOCUME~1\Kefir\0016~1\ftp\2.png" <br> put "C:\DOCUME~1\Kefir\0016~1\ftp\9.jpg" <br> put "C:\DOCUME~1\Kefir\0016~1\ftp\PrScr.jpg" <br> mkdir "" <br> cd "" <br> put "C:\DOCUME~1\Kefir\0016~1\ftp\\config.ini" <br> put "C:\DOCUME~1\Kefir\0016~1\ftp\\DropFile.ahk" <br> put "C:\DOCUME~1\Kefir\0016~1\ftp\\DropFile.exe" <br> put "C:\DOCUME~1\Kefir\0016~1\ftp\\Quick'n Easy FTP Server v2.7.1 setup.exe" <br> cd .. <br> cd .. <br> quit</code> <br> <br>  <b>Config.ini is as follows:</b> <br>  (.ini is just that the order was in the program folder, although the file itself has nothing to do with .ini) <br> <code>Borw|172.31.0.3|Username|MyPassword <br> Nout|172.31.0.4|anonymous|slau.andre@gmail.com</code> <br>  It is worth noting that passwords with |  doomed to failure ;-) <br><br>  <b>Well, let's get started:</b> <br><br><pre> <code class="hljs dos">;       - .   \   #NoTrayIcon #NoEnv SendMode Input SetWorkingDir <span class="hljs-variable"><span class="hljs-variable">%A_ScriptDir%</span></span> curr=<span class="hljs-variable"><span class="hljs-variable">%1%</span></span> ; ,    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> curr= ExitApp FTPCommandFile = <span class="hljs-variable"><span class="hljs-variable">%A_ScriptDir%</span></span>\FTPCommands.txt ;   FTPLogFile = <span class="hljs-variable"><span class="hljs-variable">%A_ScriptDir%</span></span>\FTPLog.txt ;  countf:=<span class="hljs-number"><span class="hljs-number">0</span></span> TSize:=<span class="hljs-number"><span class="hljs-number">0</span></span> FileDelete <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> ;   FileDelete <span class="hljs-variable"><span class="hljs-variable">%FTPLogFile%</span></span> ;   FileRead, conf, <span class="hljs-variable"><span class="hljs-variable">%A_ScriptDir%</span></span>\config.ini ;    conf n:=<span class="hljs-number"><span class="hljs-number">0</span></span> Loop, parse, conf,`n ;     conf { i:=<span class="hljs-number"><span class="hljs-number">0</span></span> Loop, Parse, A_LoopField, | ;   | { ;      <span class="hljs-built_in"><span class="hljs-built_in">con</span></span><span class="hljs-variable"><span class="hljs-variable">%n%</span></span><span class="hljs-variable"><span class="hljs-variable">%i%</span></span> = <span class="hljs-variable"><span class="hljs-variable">%A_LoopField%</span></span> ;   i++ } name:=<span class="hljs-built_in"><span class="hljs-built_in">con</span></span><span class="hljs-variable"><span class="hljs-variable">%n%</span></span><span class="hljs-number"><span class="hljs-number">0</span></span> ;    . Menu, PopUp, Add, <span class="hljs-variable"><span class="hljs-variable">%name%</span></span>, Who ;Who -    n++ ; } i:=<span class="hljs-number"><span class="hljs-number">0</span></span> n:=<span class="hljs-number"><span class="hljs-number">0</span></span> Menu, PopUp, Show ;    . ;      ;  ,    ;      return Who: { item:=A_THISMENUITEMPOS-<span class="hljs-number"><span class="hljs-number">1</span></span> addr:=<span class="hljs-built_in"><span class="hljs-built_in">con</span></span><span class="hljs-variable"><span class="hljs-variable">%item%</span></span><span class="hljs-number"><span class="hljs-number">1</span></span> login:=<span class="hljs-built_in"><span class="hljs-built_in">con</span></span><span class="hljs-variable"><span class="hljs-variable">%item%</span></span><span class="hljs-number"><span class="hljs-number">2</span></span> pass:=<span class="hljs-built_in"><span class="hljs-built_in">con</span></span><span class="hljs-variable"><span class="hljs-variable">%item%</span></span><span class="hljs-number"><span class="hljs-number">3</span></span> FileAppend, open <span class="hljs-variable"><span class="hljs-variable">%addr%</span></span>`n, <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> ;     ;    FileAppend, <span class="hljs-variable"><span class="hljs-variable">%login%</span></span>`n, <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> ; FileAppend, <span class="hljs-variable"><span class="hljs-variable">%pass%</span></span>`n, <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> GoSub, Go ;    return } go: ;    { ;     FileAppend, binary`n, <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> ;   prev= ToolTip  ... Loop ;    { ;   ;   ;    ;  ,  ;   curr:=<span class="hljs-variable"><span class="hljs-variable">%A_Index%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> prev { prev=<span class="hljs-variable"><span class="hljs-variable">%curr%</span></span> continue } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!InStr(curr, ":\") and (curr!="")) { ;    ":\"? prev=<span class="hljs-variable"><span class="hljs-variable">%prev%</span></span><span class="hljs-variable"><span class="hljs-variable">%A_Space%</span></span><span class="hljs-variable"><span class="hljs-variable">%curr%</span></span> ; continue } FileGetAttrib, Attributes, <span class="hljs-variable"><span class="hljs-variable">%prev%</span></span> IfInString, Attributes, D ;  ,    ;  GenFold(prev,FTPCommandFile,countf,TSize) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ; ,    ;  FileAppend, put "<span class="hljs-variable"><span class="hljs-variable">%prev%</span></span>"`n, <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> FileGetSize, dsize, <span class="hljs-variable"><span class="hljs-variable">%prev%</span></span> TSize += <span class="hljs-variable"><span class="hljs-variable">%dsize%</span></span> ;     ;   countf++ ;   } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> curr = <span class="hljs-built_in"><span class="hljs-built_in">break</span></span> prev=<span class="hljs-variable"><span class="hljs-variable">%curr%</span></span> } FileAppend, quit, <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> ;     SetFormat, float, <span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> TSize:=TSize/(<span class="hljs-number"><span class="hljs-number">1024</span></span>*<span class="hljs-number"><span class="hljs-number">1024</span></span>) ToolTIp  ftp.exe... ; ftp.exe Run <span class="hljs-variable"><span class="hljs-variable">%comspec%</span></span> /c ftp.exe -s:"<span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span>" &gt;"<span class="hljs-variable"><span class="hljs-variable">%FTPLogFile%</span></span>", ,Hide ToolTip ;   ftp     ,      ;========================================================;  CustomColor = <span class="hljs-number"><span class="hljs-number">666666</span></span> Gui, -Resize +LastFound +ToolWindow -Caption +AlwaysOnTop Gui, <span class="hljs-built_in"><span class="hljs-built_in">Color</span></span>, <span class="hljs-variable"><span class="hljs-variable">%CustomColor%</span></span> ;cFF9966 -      Gui, Add, Progress, x0 y0 w132 h15 cFF9966 Background666666 vMyProgLoadi GuiControl, , MyProgLoadi, <span class="hljs-number"><span class="hljs-number">0</span></span> Gui, Font, S7 c111111, Tahoma Gui, Add, Text, vMyMemLoadi BackGroundTrans x2 y2 w100 h15, <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-variable"><span class="hljs-variable">%Tsize%</span></span> Gui, Show, h15 w132, MyProgLoadi ;=========================================================================== countf2:=<span class="hljs-number"><span class="hljs-number">0</span></span> TSize2:=<span class="hljs-number"><span class="hljs-number">0</span></span> maybeexit:=<span class="hljs-number"><span class="hljs-number">0</span></span> Loop ;   ftp.exe,       { Process, <span class="hljs-keyword"><span class="hljs-keyword">Exist</span></span>, ftp.exe <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ErrorLevel</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>) { maybeexit++ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(maybeexit&gt;<span class="hljs-number"><span class="hljs-number">10</span></span>) ;   <span class="hljs-number"><span class="hljs-number">5</span></span>  { MsgBox - ftp.exe   `n  . ExitApp } Sleep <span class="hljs-number"><span class="hljs-number">500</span></span> continue } <span class="hljs-built_in"><span class="hljs-built_in">break</span></span> } Loop ;      <span class="hljs-number"><span class="hljs-number">250</span></span>    { ;    Process, <span class="hljs-keyword"><span class="hljs-keyword">Exist</span></span>, ftp.exe <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">ErrorLevel</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>) or (countf2 &gt;= countf)) ;    { ;   ftp.exe  Gui, Destroy FileRead, mfile, <span class="hljs-variable"><span class="hljs-variable">%FTPLogFile%</span></span> IfNotInString,mfile,logged <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ;ftp.exe   - { ;,     MsgBox, <span class="hljs-number"><span class="hljs-number">36</span></span>, ,   .`n ? IfMsgBox, Yes Run, "<span class="hljs-variable"><span class="hljs-variable">%FTPLogFile%</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">break</span></span> } SetFormat, float, <span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> ToolTIp : <span class="hljs-variable"><span class="hljs-variable">%countf%</span></span>`n: <span class="hljs-variable"><span class="hljs-variable">%TSize%</span></span>  ;ToolTip   ;  ,  Tooltip ; MsgBox Sleep <span class="hljs-number"><span class="hljs-number">2000</span></span> ToolTip <span class="hljs-built_in"><span class="hljs-built_in">break</span></span> } countf2:=<span class="hljs-number"><span class="hljs-number">0</span></span> TSize2:=<span class="hljs-number"><span class="hljs-number">0</span></span> FileRead, mfile, <span class="hljs-variable"><span class="hljs-variable">%FTPLogFile%</span></span> Loop, Parse, mfile,`n ;     { ;   <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(InStr(A_LoopField, "ftp: ")) { countf2++ dsize2:=SubStr(A_LoopField, <span class="hljs-number"><span class="hljs-number">6</span></span>, InStr(A_LoopField," ", <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>)-<span class="hljs-number"><span class="hljs-number">1</span></span>) TSize2 += <span class="hljs-variable"><span class="hljs-variable">%dsize2%</span></span> } } GuiControl, <span class="hljs-number"><span class="hljs-number">1</span></span>: , MyProgLoadi, % (countf2*<span class="hljs-number"><span class="hljs-number">100</span></span>)/countf ;  SetFormat, float, <span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> TSize2:=TSize2/(<span class="hljs-number"><span class="hljs-number">1024</span></span>*<span class="hljs-number"><span class="hljs-number">1024</span></span>) GuiControl,Text , MyMemLoadi, <span class="hljs-variable"><span class="hljs-variable">%TSize2%</span></span>/<span class="hljs-variable"><span class="hljs-variable">%TSize%</span></span>  Sleep <span class="hljs-number"><span class="hljs-number">250</span></span> } ExitApp return } GenFold(<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>,FTPCommandFile,ByRef countf,ByRef TSize) { ;     fold:=SubStr(<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>,InStr(<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>,"\",<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>)+<span class="hljs-number"><span class="hljs-number">1</span></span>) ;      ;       ;       ; -   ( ) FileAppend, <span class="hljs-built_in"><span class="hljs-built_in">mkdir</span></span> "<span class="hljs-variable"><span class="hljs-variable">%fold%</span></span>"`n, <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> FileAppend, <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> "<span class="hljs-variable"><span class="hljs-variable">%fold%</span></span>"`n, <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> Loop, <span class="hljs-variable"><span class="hljs-variable">%path%</span></span>\*, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> { FileGetAttrib, Attributes, <span class="hljs-variable"><span class="hljs-variable">%A_LOOPFILEFULLPATH%</span></span> IfInString, Attributes, D ;,   GenFold(A_LOOPFILEFULLPATH,FTPCommandFile,countf,TSize) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { FileAppend, put "<span class="hljs-variable"><span class="hljs-variable">%A_LOOPFILEFULLPATH%</span></span>"`n, <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> TSize += <span class="hljs-variable"><span class="hljs-variable">%A_LoopFileSize%</span></span> countf++ } } FileAppend, <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ..`n, <span class="hljs-variable"><span class="hljs-variable">%FTPCommandFile%</span></span> return } <br></code> </pre> <code>;       - .   \   #NoTrayIcon #NoEnv SendMode Input SetWorkingDir %A_ScriptDir% curr=%1% ; ,    if curr= ExitApp FTPCommandFile = %A_ScriptDir%\FTPCommands.txt ;   FTPLogFile = %A_ScriptDir%\FTPLog.txt ;  countf:=0 TSize:=0 FileDelete %FTPCommandFile% ;   FileDelete %FTPLogFile% ;   FileRead, conf, %A_ScriptDir%\config.ini ;    conf n:=0 Loop, parse, conf,`n ;     conf { i:=0 Loop, Parse, A_LoopField, | ;   | { ;      con%n%%i% = %A_LoopField% ;   i++ } name:=con%n%0 ;    . Menu, PopUp, Add, %name%, Who ;Who -    n++ ; } i:=0 n:=0 Menu, PopUp, Show ;    . ;      ;  ,    ;      return Who: { item:=A_THISMENUITEMPOS-1 addr:=con%item%1 login:=con%item%2 pass:=con%item%3 FileAppend, open %addr%`n, %FTPCommandFile% ;     ;    FileAppend, %login%`n, %FTPCommandFile% ; FileAppend, %pass%`n, %FTPCommandFile% GoSub, Go ;    return } go: ;    { ;     FileAppend, binary`n, %FTPCommandFile% ;   prev= ToolTip  ... Loop ;    { ;   ;   ;    ;  ,  ;   curr:=%A_Index% if not prev { prev=%curr% continue } if(!InStr(curr, ":\") and (curr!="")) { ;    ":\"? prev=%prev%%A_Space%%curr% ; continue } FileGetAttrib, Attributes, %prev% IfInString, Attributes, D ;  ,    ;  GenFold(prev,FTPCommandFile,countf,TSize) else { ; ,    ;  FileAppend, put "%prev%"`n, %FTPCommandFile% FileGetSize, dsize, %prev% TSize += %dsize% ;     ;   countf++ ;   } if curr = break prev=%curr% } FileAppend, quit, %FTPCommandFile% ;     SetFormat, float, 6.1 TSize:=TSize/(1024*1024) ToolTIp  ftp.exe... ; ftp.exe Run %comspec% /c ftp.exe -s:"%FTPCommandFile%" &gt;"%FTPLogFile%", ,Hide ToolTip ;   ftp     ,      ;========================================================;  CustomColor = 666666 Gui, -Resize +LastFound +ToolWindow -Caption +AlwaysOnTop Gui, Color, %CustomColor% ;cFF9966 -      Gui, Add, Progress, x0 y0 w132 h15 cFF9966 Background666666 vMyProgLoadi GuiControl, , MyProgLoadi, 0 Gui, Font, S7 c111111, Tahoma Gui, Add, Text, vMyMemLoadi BackGroundTrans x2 y2 w100 h15, 0/%Tsize% Gui, Show, h15 w132, MyProgLoadi ;=========================================================================== countf2:=0 TSize2:=0 maybeexit:=0 Loop ;   ftp.exe,       { Process, Exist, ftp.exe if(ErrorLevel = 0) { maybeexit++ if(maybeexit&gt;10) ;   5  { MsgBox - ftp.exe   `n  . ExitApp } Sleep 500 continue } break } Loop ;      250    { ;    Process, Exist, ftp.exe if((ErrorLevel = 0) or (countf2 &gt;= countf)) ;    { ;   ftp.exe  Gui, Destroy FileRead, mfile, %FTPLogFile% IfNotInString,mfile,logged in ;ftp.exe   - { ;,     MsgBox, 36, ,   .`n ? IfMsgBox, Yes Run, "%FTPLogFile%" break } SetFormat, float, 6.1 ToolTIp : %countf%`n: %TSize%  ;ToolTip   ;  ,  Tooltip ; MsgBox Sleep 2000 ToolTip break } countf2:=0 TSize2:=0 FileRead, mfile, %FTPLogFile% Loop, Parse, mfile,`n ;     { ;   If(InStr(A_LoopField, "ftp: ")) { countf2++ dsize2:=SubStr(A_LoopField, 6, InStr(A_LoopField," ", 0, 6)-1) TSize2 += %dsize2% } } GuiControl, 1: , MyProgLoadi, % (countf2*100)/countf ;  SetFormat, float, 6.1 TSize2:=TSize2/(1024*1024) GuiControl,Text , MyMemLoadi, %TSize2%/%TSize%  Sleep 250 } ExitApp return } GenFold(path,FTPCommandFile,ByRef countf,ByRef TSize) { ;     fold:=SubStr(path,InStr(path,"\",0,0)+1) ;      ;       ;       ; -   ( ) FileAppend, mkdir "%fold%"`n, %FTPCommandFile% FileAppend, cd "%fold%"`n, %FTPCommandFile% Loop, %path%\*, 1, 0 { FileGetAttrib, Attributes, %A_LOOPFILEFULLPATH% IfInString, Attributes, D ;,   GenFold(A_LOOPFILEFULLPATH,FTPCommandFile,countf,TSize) else { FileAppend, put "%A_LOOPFILEFULLPATH%"`n, %FTPCommandFile% TSize += %A_LoopFileSize% countf++ } } FileAppend, cd ..`n, %FTPCommandFile% return } <br></code> <br>  It should be noted that if there are two spaces in the file path one by one, then the program is powerless. <br><br>  Code, exe, icon here <br><br><h2>  Conclusion </h2><br>  Well, it turned out even more than necessary, because, you can transfer files between computers not only in one local network but also between remote computers with a direct IP address. <br>  ps: if someone liked the wallpaper, then <a href="http://habrahabr.ru/blogs/AutoHotKey/50707/">here</a> I laid them out ;-) <br>  pps: for dictations in the Russian language I have always had a stable 2, so do not scold too much for errors </div><p>Source: <a href="https://habr.com/ru/post/57139/">https://habr.com/ru/post/57139/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../57130/index.html">When you (or your company) send business greeting cards by email. mail?</a></li>
<li><a href="../57131/index.html">XSS on Twitter</a></li>
<li><a href="../57134/index.html">Right now - live broadcast c admin conference</a></li>
<li><a href="../57137/index.html">Do you type texts before publishing on your site?</a></li>
<li><a href="../57138/index.html">Where to look for examples for WPF and WCF?</a></li>
<li><a href="../57140/index.html">User with underscore in name</a></li>
<li><a href="../57141/index.html">Skype founders want the company back</a></li>
<li><a href="../57142/index.html">Dklab_Cache: tags in memcached, namespaces, statistics</a></li>
<li><a href="../57143/index.html">Or maybe Spring is for women?</a></li>
<li><a href="../57144/index.html">Creation of sites in Nizhny Novgorod</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>