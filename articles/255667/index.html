<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We do the IR remote control for the camera</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sometime recently, I needed to remotely control the SLR shutter. The wired version was discarded, uncomfortable. Searching for shopping, found the ML-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We do the IR remote control for the camera</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/19a/59b/11b/19a59b11b90f4e8196f1f40044a788ce.jpg"><br><br>  Sometime recently, I needed to remotely control the SLR shutter.  The wired version was discarded, uncomfortable.  Searching for shopping, found the ML-L3 remote.  But I did not want to give him a thousand rubles, especially since the function performed at first glance is elementary.  I decided to do it myself.  And then, by the way, the weekend arrived, and the work began to boil ... <br><a name="habracut"></a><br><br><h1>  Theory or how it works </h1><br>  At first there was hope that you can find all the codes and a description of how the IR remote control works on the network.  But in the end, managed to find only a description of the sequence that needs to be generated to trigger the shutter.  Here is a drawing of such a parcel for Nikon cameras: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/bd6/b6d/98e/bd6b6d98e7da4b49af0fc7f0ef368c48.jpg"><br><br>  As you can see, nothing complicated.  The fill rate is 38.4 kHz. <br><br>  For Canon cameras, the sequence is even simpler: <br><br><img src="https://habrastorage.org/files/aad/4a8/8d7/aad4a88d78f14c89b7b3b86cf7e16ed8.jpg"><br><br>  They have a frequency of filling - 33 kHz. <br><br><h1>  Circuit, PCB and Parts </h1><br>  I wanted to not only repeat the console, but also provide it with additional functionality.  As a result, I decided to add a timer for shooting Timelapse video and the ability to control Nikon and Canon cameras.  Based on the spare parts in stock, the following scheme was created: <br><br><img src="https://habrastorage.org/files/792/222/edd/792222edd2684d2ebc37db075bf5825c.jpg"><br><br>  DD1 - PIC12F629 <br>  HL1 - ARL2-5013IRAB-940NM <br>  R1 - 150 Ohm <br>  SB1 - Clock button FSM4JH <br>  A0 - DIP Switch DS1040-03RN <br>  C1 - Tantalum Capacitor, 47 ŒºF x 10 V, Type B <br>  + Battery compartment BH-624 (1xAAA) <br><br>  The total cost of all the details is 240 rubles (at prices for April 2015, not in the cheapest store in the city). <br><br><img src="https://habrastorage.org/files/41d/178/f89/41d178f8941e48fa887f45a8655101f9.jpg"><br><br>  The selected microcontroller has high power I / O ports, which allows switching an infrared LED without an additional key.  Button SB1 generates the selected sequence.  There is no power switch;  the microcontroller is constantly in sleep mode and consumes 70 nanoamperes, ‚Äúwaking up‚Äù only for the time of signal generation.  Jumper X1 switches camera type: installed - Canon, unchecked - Nikon.  Switches A0 ... A2 set the period of the timer for shooting Timelapse video: <br><br><table><tbody><tr><th>  A2 </th><th>  A1 </th><th>  A0 </th><th>  Period </th></tr><tr><th>  0 </th><th>  0 </th><th>  0 </th><th>  not </th></tr><tr><th>  0 </th><th>  0 </th><th>  one </th><th>  2 seconds </th></tr><tr><th>  0 </th><th>  one </th><th>  0 </th><th>  4 seconds </th></tr><tr><th>  0 </th><th>  one </th><th>  one </th><th>  8 seconds </th></tr><tr><th>  one </th><th>  0 </th><th>  0 </th><th>  15 seconds </th></tr><tr><th>  one </th><th>  0 </th><th>  one </th><th>  30 seconds </th></tr><tr><th>  one </th><th>  one </th><th>  0 </th><th>  1 minute </th></tr><tr><th>  one </th><th>  one </th><th>  one </th><th>  2 minutes </th></tr></tbody></table><br><br>  The designed circuit board, as well as the circuit, is very simple: <br><br><img src="https://habrastorage.org/files/ae6/b35/0ad/ae6b350ad1bb44859c2d4cf32f9df836.jpg"><br><br>  Manufactured PCB standard LUT method and assembled: <br><br><img src="https://habrastorage.org/files/eff/e7a/425/effe7a4257144da8aabfc597e30d58c1.JPG"><br><br><div class="spoiler">  <b class="spoiler_title">Microcontroller source code</b> <div class="spoiler_text">  errorlevel 0, -207, -205, -302, -203 <br><br>  #include &lt;P12F629.INC&gt; <br><br>  __CONFIG _CPD_OFF &amp; _CP_OFF ‚Äã‚Äã&amp; _BODEN_OFF &amp; _MCLRE_ON &amp; _PWRTE_ON &amp; _WDT_OFF &amp; _INTRC_OSC_NOCLKOUT <br><br>  LED equ 5;  IR LED <br>  CFG equ 4;  Nikon (1) / Canon (0) <br><br>  ; ================================================ ============================== <br>  ;  Variables <br>  ; ================================================ ============================== <br><br>  CBLOCK 0x020 <br>  DEL <br>  DEL_MS <br>  IMP <br>  COUNT <br>  ENDC <br><br>  ; ================================================ ============================== <br>  ;  Reset <br>  ; ================================================ ============================== <br><br>  ORG 0 <br>  GOTO START <br><br>  ; ================================================ ============================== <br>  ;  Interruptions <br>  ; ================================================ ============================== <br><br>  ORG 4 <br>  RETFIE <br><br>  ; ================================================ ============================== <br>  ;  Subprograms <br>  ; ================================================ ============================== <br><br>  ;  The delay routine (in microseconds, 770 Œºs max) <br>  ; (Before calling, put the delay value in W) <br>  DEL_MK MOVWF DEL <br>  M1 DECFSZ DEL, F <br>  GOTO M1 <br>  RETLW 0 <br><br>  ;  The delay routine (in milliseconds, 256 ms max) <br>  ; (Before calling, put the delay value in W) <br>  DEL_M MOVWF DEL_MS <br>  MOVLW 0xA5 <br>  M2 CALL DEL_MK <br>  CALL DEL_MK <br>  DECFSZ DEL_MS, F <br>  GOTO M2 <br>  RETLW 0 <br><br>  ;  Nikon pulse output routine (38.4 kHz padding) <br>  ; (Before calling, put the pulse duration in W) <br>  NIK MOVWF IMP <br>  M3 BCF GPIO, LED <br>  MOVLW 0x02 <br>  CALL DEL_MK <br>  NOP <br>  BSF GPIO, LED <br>  MOVLW 0x01 <br>  CALL DEL_MK <br>  NOP <br>  DECFSZ IMP, F <br>  GOTO M3 <br>  RETLW 0 <br><br>  ;  Signal output routine for Nikon <br>  NIKON MOVLW 0x4D <br>  CALL NIK;  pulse 2 ms <br>  MOVLW 0x12 <br>  CALL DEL_M;  pause 27.8 ms <br>  MOVLW 0x47 <br>  CALL DEL_MK <br>  MOVLW 0x0F <br>  CALL NIK;  pulse 0.4 ms <br>  MOVLW 0x01 <br>  CALL DEL_M;  1.6 ms pause <br>  MOVLW 0x69 <br>  CALL DEL_MK <br>  MOVLW 0x0F <br>  CALL NIK;  pulse 0.4 ms <br>  MOVLW 0x02 <br>  CALL DEL_M;  3.6 ms pause <br>  MOVLW 0xFF <br>  CALL DEL_MK <br>  MOVLW 0x0F <br>  CALL NIK;  pulse 0.4 ms <br>  RETLW 0 <br><br>  ;  Canon pulse subroutine (33 kHz padding) <br>  ; (Before calling, put the pulse duration in W) <br>  CAN MOVWF IMP <br>  M4 BCF GPIO, LED <br>  MOVLW 0x02 <br>  CALL DEL_MK <br>  NOP <br>  NOP <br>  NOP <br>  BSF GPIO, LED <br>  MOVLW 0x01 <br>  CALL DEL_MK <br>  NOP <br>  NOP <br>  NOP <br>  DECFSZ IMP, F <br>  GOTO M3 <br>  RETLW 0 <br><br>  ;  Canon signal output routine <br>  CANON MOVLW 0x13 <br>  CALL CAN;  pulse 0.5 ms <br>  MOVLW 0x05 <br>  CALL DEL_M;  7.3 ms pause <br>  MOVLW 0x13 <br>  CALL CAN;  pulse 0.5 ms <br>  RETLW 0 <br><br>  ;  Delay subroutine for 1 second 0xA1 <br>  DEL_1S MOVLW 0xFF <br>  CALL DEL_M <br>  MOVLW 0xFF <br>  CALL DEL_M <br>  MOVLW 0x88 <br>  CALL DEL_M <br>  RETLW 0 <br><br>  ; ================================================ ============================== <br>  ;  Main program <br>  ; ================================================ ============================== <br><br>  START BCF STATUS, RP0;  Bank 0 selected <br>  MOVLW B'00000000 ' <br>  MOVWF INTCON <br>  MOVLW B'00000111 ' <br>  MOVWF CMCON;  Turning off the built-in comparators <br><br>  BSF STATUS, RP0;  Bank 1 selected <br>  MOVLW B'00000111 ' <br>  MOVWF OPTION_REG <br>  CALL 3FFh;  Download generator calibration constant <br>  MOVWF OSCCAL <br>  MOVLW B'00011111 ';  Ports (direction) <br>  MOVWF TRISIO <br>  MOVLW B'00010111 ';  Pull-up resistors <br>  MOVWF WPU <br><br>  BCF STATUS, RP0;  Bank 0 selected <br><br>  MOVLW B'00100000 ';  Ports <br>  MOVWF GPIO <br><br>  ; -------------------------- <br><br>  MOVLW 0x12 <br>  CALL DEL_M <br><br>  LP1 BTFSS GPIO, CFG <br>  CALL CANON <br>  BTFSS GPIO, CFG <br>  GOTO LP2 <br>  CALL NIKON <br><br>  LP2 MOVF GPIO, W;  Count jumpers <br>  ANDLW B'00000111 ' <br>  ADDLW B'11111000 ' <br>  MOVWF COUNT <br>  COMF COUNT, F <br><br>  BTFSC STATUS, Z;  Shutdown if not <br>  SLEEP <br><br>  MOVF COUNT, W <br>  XORLW 0x01;  1 timing enabled <br>  BTFSC STATUS, Z <br>  GOTO SET2 <br><br>  MOVF COUNT, W <br>  XORLW 0x02;  2 timing enabled <br>  BTFSC STATUS, Z <br>  GOTO SET4 <br><br>  MOVF COUNT, W <br>  XORLW 0x03;  3 timing enabled <br>  BTFSC STATUS, Z <br>  GOTO SET8 <br><br>  MOVF COUNT, W <br>  XORLW 0x04;  4 timing enabled <br>  BTFSC STATUS, Z <br>  GOTO SET15 <br><br>  MOVF COUNT, W <br>  XORLW 0x05;  5 timing enabled <br>  BTFSC STATUS, Z <br>  GOTO SET30 <br><br>  MOVF COUNT, W <br>  XORLW 0x06;  6 timing enabled <br>  BTFSC STATUS, Z <br>  GOTO SET1M <br><br>  GOTO SET2M;  7 timing enabled <br><br>  SET2 MOVLW 0x02 <br>  GOTO TIME <br><br>  SET4 MOVLW 0x04 <br>  GOTO TIME <br><br>  SET8 MOVLW 0x08 <br>  GOTO TIME <br><br>  SET15 MOVLW 0x0F <br>  GOTO TIME <br><br>  SET30 MOVLW 0x1E <br>  GOTO TIME <br><br>  SET1M MOVLW 0x3C <br>  GOTO TIME <br><br>  SET2M MOVLW 0x78 <br>  GOTO TIME <br><br>  TIME MOVWF COUNT <br>  LP3 CALL DEL_1S <br><br>  DECFSZ COUNT, F <br>  GOTO LP3 <br><br>  GOTO LP1 <br><br>  END <br><br></div></div><br><br><h1>  Hull design </h1><br>  Modern 3D printing technologies have solved the long-standing problem of home-made products - replaced by clumsy and impartial cases came quality-looking design, not inferior to industrial designs. <br><br>  The body of this console is designed in SolidWorks, with the calculation of the subsequent printing on a 3D printer.  It is made in the best traditions of Chinese design - not a single screw, all snap. <br><br>  The resulting dimensions are largely due to the choice of power source.  After brief deliberation, it was decided not to use the lithium cell, which is traditional in such cases.  For the Timelapse mode with the constant generation of the parcel is able to discharge a weak element rather quickly.  Therefore, 2 AAA batteries are used. <br><br><img src="https://habrastorage.org/files/7fb/f77/203/7fbf77203092407082fde14c7ef050fe.jpg"><br><br>  Printed on 3D printer case: <br><br><img src="https://habrastorage.org/files/a95/522/38f/a9552238f5e543efb695f84baa1b7982.JPG"><br><br>  Schema, PCB, source code and files for printing the case can be downloaded <a href="https://yadi.sk/d/dNjKSkROfxdXa">from here</a> . <br><br><h1>  Assembly </h1><br>  Before assembly, you must carefully cut the flat parts with contacts with a knife from the battery holders: <br><br><img src="https://habrastorage.org/files/6eb/cbf/6d7/6ebcbf6d71ae4e469d8464c0851081da.JPG"><br><br>  The resulting contacts should be glued to the body, observing the polarity: <br><br><img src="https://habrastorage.org/files/f0a/b10/aa5/f0ab10aa582e4de788eb28def998cb66.JPG"><br><br>  Then put the button and insert the board all the way, making sure that it snaps into place.  It remains to solder the wires from the batteries to the board and the device is ready: <br><br><img src="https://habrastorage.org/files/df4/8de/982/df48de9825e44762a95defa489545ea2.JPG"><br><br>  Here is the assembled IR remote control: <br><br><img src="https://habrastorage.org/files/459/41b/d78/45941bd781954030a5f95fb443dc52ee.JPG"><br><br><h1>  Camera setting </h1><br>  Before using the remote control, you need to perform a simple setup of the camera to control it through the IR remote control.  It is different for each model. I‚Äôm giving an algorithm for my Nikon D7000: 1) turn the left ring to the remote icon, as in the photo on the left 2) set the required response in the ‚ÄúRemote Control Mode‚Äù menu. <br><br><img src="https://habrastorage.org/files/2a0/410/307/2a04103076884988adfb5e909ee557d1.jpg"></div><p>Source: <a href="https://habr.com/ru/post/255667/">https://habr.com/ru/post/255667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255657/index.html">Our devices to control the lighting in the smart home</a></li>
<li><a href="../255659/index.html">We pump over Stream API, or we need more sugar.</a></li>
<li><a href="../255661/index.html">Magvik filter</a></li>
<li><a href="../255663/index.html">Interview with Stanislav Shalunov - developer of technology used in BitTorrent and Apple</a></li>
<li><a href="../255665/index.html">PHP Digest number 60 - interesting news, materials and tools (March 30 - April 13, 2015)</a></li>
<li><a href="../255669/index.html">Bubot: Scout - a machine with control through a web interface without a line of code</a></li>
<li><a href="../255675/index.html">Fuel cells as a reliable source of energy for the data center?</a></li>
<li><a href="../255679/index.html">Webinar recording: ‚ÄúVirtualization based on Hyper-V 3.0 and Windows Server 2012R2 Virtual Desktop Infrastructure‚Äù</a></li>
<li><a href="../255681/index.html">The main vulnerabilities of corporate information systems in 2014: web applications, passwords and employees</a></li>
<li><a href="../255683/index.html">Deep immersion in the WPF rendering system</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>