<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Qucs project news: release candidate available with circuit simulation support in SPICE</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Qucs is an open source electronic circuit simulator. About him tell my previous articles on Habr√©. 

 Now our project is preparing for the next releas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Qucs project news: release candidate available with circuit simulation support in SPICE</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://qucs.sourceforge.net/">Qucs</a> is an open source electronic circuit simulator.  About him tell my previous articles on Habr√©. <br><br>  Now our project is preparing for the next release of 0.0.19, which will be released in the coming weeks.  This note provides an overview of the most expected innovations in recent years: support for modeling Qucs schemes in SPICE-compatible simulators. <br><br>  Qucs uses the Qucsator simulation engine, developed from scratch.  This core has many advantages (modeling of S-parameters, advanced postprocessor), but also has numerous bugs related to modeling in the time domain (Transient analysis).  These bugs in particular do not allow power electronics to be modeled in Qucs.  Now in Qucs you can simulate, for example, the following scheme: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/c99/694/422/c996944223694a80ade5e6c590e5a9e3.png"><br><br>  Download packages for Linux and Windows with Ngspice support here: <br>  <a href="https://github.com/ra3xdh/qucs/releases/tag/0.0.19S-rc1">github.com/ra3xdh/qucs/releases/tag/0.0.19S-rc1</a> <br><br>  UPD from 10/21/15: RC3 is now available: <a href="https://github.com/ra3xdh/qucs/releases/tag/0.0.19S-rc3">github.com/ra3xdh/qucs/releases/tag/0.0.19S-rc3</a> <br><br>  The letter "S" in the release number means SPICE.  Apparently, along with the release of 0.0.19, two sets of packages will be released: with the ‚ÄúS‚Äù index and with the usual numbering, since the further fate of spice4qucs is unclear. <br><br>  The documentation for spice4qucs is here: <a href="https://qucs-help.readthedocs.org/en/spice4qucs/">qucs-help.readthedocs.org/en/spice4qucs</a> <br><br>  Under the cat will be briefly discussed the use of spice4qucs. <br><br><a name="habracut"></a><br><br><h3>  Prehistory </h3><br><br>  For about 10 months, I and Mike Brinson (London Metropolitan University) have been developing the spice4qucs subsystem, which allows you to simulate Qucs schemes using external Ngspice <a href="https://qucs-help.readthedocs.org/en/spice4qucs/">qucs-help.readthedocs.org/en/spice4qucs</a> and Xyce <a href="https://xyce.sandia.gov/">xyce.sandia.gov</a> console simulators.  Of greatest interest is Ngspice, which is the best open-source circuit simulator, but does not have a graphical interface.  With our patch kit, Qucs can serve as an interface for Ngspice. <br><br>  The development progress can be tracked here: <br><br>  <a href="https://github.com/Qucs/qucs/issues/226">github.com/Qucs/qucs/issues/226</a> <br><br>  <a href="https://github.com/Qucs/qucs/issues/77">github.com/Qucs/qucs/issues/77</a> <br><br>  <a href="https://github.com/Qucs/qucs/issues/181">github.com/Qucs/qucs/issues/181</a> <br><br><h3>  Destination spice4qucs </h3><br><br>  Spice4qucs is a <s>slender system of crutches and props</s> patch set, which allows you to connect external SPICE-compatible simulators to Qucs.  The source code is located in the main Qucs repository in the rebase_spice4qucs branch: <a href="https://github.com/Qucs/qucs/tree/rebase_spice4qucs">github.com/Qucs/qucs/tree/rebase_spice4qucs</a> The code turned out to be quite saturated with crutches, since using a netlist other than SPICE in the default Qucs simulator was an inappropriate idea.  It could only spawn crutches. <br><br>  So, spice4qucs performs the following functions: <br><br><ul><li>  Converts Qucs schema to SPICE netlist </li><li>  Runs third-party simulator </li><li>  Converts output from simulator to Qucs XML data format. </li></ul><br><br>  Examples of schemes that can be modeled in SPICE are in the $ QUCSDIR / share / qucs / doc / examples / ngspice directory where $ QUCSDIR is the root of the Qucs installation, for example / usr or C: / Program Files / Qucs. <br><br><h3>  Installation </h3><br><br>  This package is not included in Linux distributions yet, so you need to compile everything manually: <br><pre><code class="hljs go">tar xvfz qucs<span class="hljs-number"><span class="hljs-number">-0.0</span></span><span class="hljs-number"><span class="hljs-number">.19</span></span>-S1.tar.gz cd qucs<span class="hljs-number"><span class="hljs-number">-0.0</span></span><span class="hljs-number"><span class="hljs-number">.19</span></span>-S1 ./configure --prefix=/path_to_install/ <span class="hljs-built_in"><span class="hljs-built_in">make</span></span> -j_ <span class="hljs-built_in"><span class="hljs-built_in">make</span></span> install</code> </pre> <br><br>  Qt4 for developers and GCC must be installed. <br><br>  It is recommended to use configure with the --prefix key in order not to damage the Qucs system installation, but to put it somewhere in a separate directory, like in / opt.  Instead of make install it is better to use checkinstall, which will build the package for your distribution. <br><br>  Installation for Windows is simple.  You need to run the installer, choose the path to install and click Next-&gt; Next-&gt; Finish. <br><br>  You also need to install Ngspice.  It is not included in the assembly and it must be installed separately.  In Linux, this package is already there and can be installed using the package manager, for example: <br><pre> <code class="hljs swift">apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> install ngspice</code> </pre><br><br><h3>  Using </h3><br><br>  Consider usage.  It is assumed that the reader has worked with Qucs before and knows how to model circuits in it.  The greatest interest to practice is Ngspice.  On using Xyce - read our documentation (link to kata). <br><br>  As an example, simulate an oscillating circuit.  Let's look at the frequency response in the frequency range from 1 to 10 MHz (AC analysis) and the response of the oscillating circuit to the sinusoidal effect with a frequency of 7.5 MHz and an amplitude of 0.6 V. (Transient analysis). <br><br>  First, we collect the following scheme.  Save the circuit as RCL.sch. This circuit can be simulated in Qucs by clicking Simulation-&gt; Simulate (F2) and make sure that everything works. <br><br><img src="https://habrastorage.org/files/e28/65d/d40/e2865dd4097248eaba051eadab7401bd.png"><br><br>  Now we will model the circuit in Ngspice.  Click Simulation-&gt; Simulate with Spice.  A dialog box appears. <br><br><img src="https://habrastorage.org/files/aa2/94f/70c/aa294f70c61641bba53d4cc34ac98a8c.png"><br><br>  In the drop-down list (1), you can select a simulator.  Choose Ngspice.  If the simulator is installed in a non-standard place, then you need to specify the path to the executable file of the simulator.  To do this, click Settings and go to the next dialog box: <br><br><img src="https://habrastorage.org/files/07f/2db/aa4/07f2dbaa49834f44a30cdfca663d35ee.png"><br><br>  This step is required for Windows.  You need to specify in the top field (Ngspice executable location) the path to the file ngspice.exe.  For Linux, the default path is usually appropriate.  Now we return to the previous dialog and click Simulate.  In the dialog box, we see that the simulation was successful: <br><br><img src="https://habrastorage.org/files/684/e92/234/684e922341ba4c6bb1f26821e10457cb.png"><br><br>  You can also export the scheme to the Spice-netlist by clicking the Save Netlist button.  Here is the netlist for our scheme: <br><pre> <code class="hljs pgsql">* Qucs <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.19</span></span> /home/vvk/qucs/examples/ngspice/RCL.sch V1 _net0 <span class="hljs-number"><span class="hljs-number">0</span></span> DC <span class="hljs-number"><span class="hljs-number">0</span></span> SIN(<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0.6</span></span> <span class="hljs-number"><span class="hljs-number">7.5</span></span>MEG <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>) AC <span class="hljs-number"><span class="hljs-number">0.6</span></span> VPr1 _net0 vIn DC <span class="hljs-number"><span class="hljs-number">0</span></span> AC <span class="hljs-number"><span class="hljs-number">0</span></span> L1 vIn _net1 <span class="hljs-number"><span class="hljs-number">10</span></span>U R1 <span class="hljs-number"><span class="hljs-number">0</span></span> vR <span class="hljs-number"><span class="hljs-number">30</span></span> C1 _net1 vR <span class="hljs-number"><span class="hljs-number">40</span></span>P .control <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> filetype=ascii AC LIN <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>MEG <span class="hljs-number"><span class="hljs-number">10</span></span>MEG <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> RCL_ac.txt VPr1#branch v(vIn) v(vR) destroy <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> TRAN <span class="hljs-number"><span class="hljs-number">4.97512e-09</span></span> <span class="hljs-number"><span class="hljs-number">1e-06</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> RCL_tran.txt VPr1#branch v(vIn) v(vR) destroy <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> .endc .<span class="hljs-keyword"><span class="hljs-keyword">END</span></span></code> </pre><br><br>  Click Exit, go to the page view and build a chart.  Place the Cartesian diagram.  The chart properties dialog opens. <br><br><img src="https://habrastorage.org/files/ee2/993/8d1/ee29938d15a746e8a7e29d0abc03133a.png"><br><br>  In the drop-down list (1), select RCL, in the drop-down list (2), select Ngspice.  Then we select the variables whose graphs need to be built (by double-clicking).  They go to the list on the right side of the window (indicated by an arrow).  Everything, the modeling is completed, we get the frequency response (current of the virtual current sensor - ac.i (pr1)) and voltage oscillograms (tran.v (vIn), tran.v (vR)).  They need to be built on different charts. <br><br><img src="https://habrastorage.org/files/c5d/e5b/b1b/c5de5bb1b8584393a4164534d4848044.png"><br><br>  Notice that the names of the schematic nodes are in the form of a SPICE record.  The prefix indicates the type of simulation (tran. Or ac.) And the simulator (ngspice /). <br><br><h3>  Opportunities </h3><br><br><ul><li>  Most Qucs components are compatible with SPICE.  Subcircuits, library components are supported.  An error message is displayed on incompatible components during the simulation: These components are SPICE-incompatible ... Qucs Equations System is partially compatible with SPICE.  About restrictions to read the documentation. </li><li>  SPICE compatible simulation types have been added: .FOURIER, .NOISE and .DISTORTION S-parameter modeling does not work with spice4qucs. </li><li>  Spice4qucs allows you to simulate the schemes inaccessible to the default simulator <br>  Qucsator.  First of all, these are power electronics, key circuits, circuits on semiconductor devices that operate with entry into cut-off mode, and circuits with a large number of components.  For example, this is how you can simulate a high-quality transistor audio amplifier: <br><br><img src="https://habrastorage.org/files/dfd/5cd/998/dfd5cd99844d493abe439cb949cec79d.png"><br><br><img src="https://habrastorage.org/files/3ec/daa/b21/3ecdaab210994588beb1d081e4ff92bc.png"><br><br></li><li>  Added many SPICE-compatible components and types of modeling.  They are located in groups: Spice components, Spice sections, and Spice simulations.  Read more about them in the documentation.  All these components will not work with the default Qucsator simulator.  They implement the setting of parameters, initial conditions and Ngspice-style construction commands.  Also added a model of semiconductor components with a complete description of the model in the format of SPICE.  This allows you to simply copy the model from existing libraries, bypassing the converters.  Here is an example of a circuit with this model: <br><br><img src="https://habrastorage.org/files/be7/82f/5ad/be782f5ad7914e1d8094eb627198abfc.png"><br><br></li><li>  Libraries are now allowed to enable the spice netlist.  It is directly transmitted to the SPICE-compatible simulator, bypassing the conversion.  An example of such a library is here: <a href="">github.com/ra3xdh/qucs-rus-complib/blob/master/Opamp.lib</a> <br></li></ul><br><br><h3>  Further prospects </h3><br><br>  The further fate of the project spice4qucs is unclear.  Together with the release of 0.0.19 two sets of packages will be released - with and without spice4qucs support.  The question of including this patch set in upstream remains open. <br><br>  In the future, new components and types of modeling will be added, in particular digital-analog models.  It will be possible to assign a default simulator to each scheme: Ngpsice, Qucsator or Xyce and perform modeling using the system dialog (F2). <br><br>  Maybe in the fall, I will start parallel development of my own open source project based on the Qucs and spice4qucs source codes and aimed at deep integration with SPICE and analog electronics modeling.  The default Qucsator simulator will be cut and replaced by Ngspice and ensured compatibility with SPICE libraries, components fully compatible with SPICE, etc. will be implemented. <br><br><h3>  My previous publications on Qucs: </h3><br><br><ul><li>  Qucs - open-source CAD for modeling electronic circuits <a href="http://habrahabr.ru/post/248005/">habrahabr.ru/post/248005</a> </li><li>  Qucs project news: preparation for release 0.0.19 <a href="http://habrahabr.ru/post/259193/">habrahabr.ru/post/259193</a> </li><li>  My Qucs manuals: <a href="https://github.com/ra3xdh/RTUiS-labs">github.com/ra3xdh/RTUiS-labs</a> (Starting from LR No. 4 PDF + LaTeX, distribution is prohibited!) </li></ul></div><p>Source: <a href="https://habr.com/ru/post/263555/">https://habr.com/ru/post/263555/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263541/index.html">PostgreSQL: Production Techniques</a></li>
<li><a href="../263545/index.html">nxweb - HTTP server for C applications</a></li>
<li><a href="../263547/index.html">Pseudo OOP in C</a></li>
<li><a href="../263549/index.html">Multithreaded SOCKS 4 server on Qt</a></li>
<li><a href="../263551/index.html">Quick start with PHPixie 3</a></li>
<li><a href="../263565/index.html">Magic of tensor algebra: Part 13 - SKA Maxima in problems of transforming tensor expressions. Angular velocity and acceleration in the parameters of Rodrigues-Hamilton</a></li>
<li><a href="../263569/index.html">With LINQ on "Life"</a></li>
<li><a href="../263571/index.html">SoC: we write framebuffer implementation for controller in FPGA</a></li>
<li><a href="../263575/index.html">An example of solving a typical OOP problem in the Haskell language</a></li>
<li><a href="../263577/index.html">Competition of the user design from the Roketbank or how to order a bank card with the Habr logo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>