<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating interface elements programmatically using PureLayout (Part 2)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! I present to your attention the translation of the article Creating UI Elements Programmatically Using PureLayout by Aly Yaka. 



 Welcome ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating interface elements programmatically using PureLayout (Part 2)</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  I present to your attention the translation of the article <a href="https://instabug.com/blog/creating-ui-elements-programmatically-using-purelayout/">Creating UI Elements Programmatically Using PureLayout</a> by Aly Yaka. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/631/88d/e30/63188de305b02c7f0e14a4bd2a6350f6.jpg" alt="image"><br><br>  Welcome to the second part of the article on creating interface software using PureLayout.  <a href="https://habr.com/ru/post/444854/">In the first part,</a> we created the user interface of a simple mobile application completely with code, without using Storyboards or NIBs.  In this guide, we will look at some of the most commonly used user interface elements in all applications: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  UINavigationController / Bar </li><li>  UITableView </li><li>  Self-sizing UITableViewCell </li></ul><br><a name="habracut"></a><br><h2>  UINavigationController </h2><br>  In our application, you probably need a navigation bar so that the user can navigate from the contact list to detailed information about a particular contact, and then go back to the list.  <code>UINavigationController</code> will easily solve this problem using the navigation bar. <br><br>  <code>UINavigationController</code> is just a stack to which you move a multitude of views.  The most top view (the one that was moved last) is visible to the user right now (except when you have another view, presented on top of this, let's say favorites).  And when you press the top view controllers of the navigation controller, the navigation controller automatically creates a ‚Äúback‚Äù button (upper left or right side depending on the current language preferences of the device), and pressing this button returns you to the previous view. <br><br>  All this is handled out of the box by the navigation controller.  And adding one more will take just one extra line of code (unless you want to customize the navigation bar). <br>  Go to AppDelegate.swift and add the following line of code below, let <code>viewController = ViewController ():</code> <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> navigationController = <span class="hljs-type"><span class="hljs-type">UINavigationController</span></span>(rootViewController: viewController)</code> </pre> <br>  Now change the <code>self.window? .RootViewController = viewController  self.window? .RootViewController = navigationController</code> <code>self.window? .RootViewController = viewController  self.window? .RootViewController = navigationController</code>  <code>self.window? .RootViewController = viewController  self.window? .RootViewController = navigationController</code> .  In the first line, we created an instance of <code>UINavigationController</code> and passed it our <code>viewController</code> as <code>rootViewController</code> , which is the view controller at the very bottom of the stack, which means that there will never be a back button on the navigation bar of this view.  Then we give our window a navigation controller as <code>rootViewController</code> , since now it will contain all the views in the application. <br><br>  Now run your application.  The result should look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2fb/1e6/e3a/2fb1e6e3a449bd990d30785ef9557646.jpg" alt="image" width="500"></div><br>  Unfortunately, something went wrong.  It looks like the navigation bar overlaps our upperView, and we have several ways to fix this: <br><br><ul><li>  Increase the size of our <code>upperView</code> to match the height of the navigation bar. </li><li>  Set the navigation bar's <code>isTranslucent</code> property to <code>false</code> .  This will make the navigation bar opaque (if you didn‚Äôt notice, it is slightly transparent), and now the top edge of the superview will become the bottom of the navigation bar. </li></ul><br>  I personally choose the second option, but you will study the first one.  I also recommend checking and carefully reading the Apple documents on <code>UINavigationController</code> and <code>UINavigationBar</code> : <br><br><ul><li>  <a href="https://developer.apple.com/documentation/uikit/uinavigationcontroller">UINavigationController - UIKit |</a>  <a href="https://developer.apple.com/documentation/uikit/uinavigationcontroller">Apple Developer Documentation</a> </li><li>  <a href="https://developer.apple.com/documentation/uikit/uinavigationbar">UINavigationBar - UIKit |</a>  <a href="https://developer.apple.com/documentation/uikit/uinavigationbar">Apple Developer Documentation</a> </li></ul><br>  Now go to the viewDidLoad method and add this <code>self.navigationController? .NavigationBar.isTranslucent = false  super.viewDidLoad ()</code>  <code>self.navigationController? .NavigationBar.isTranslucent = false  super.viewDidLoad ()</code> , so that it would look like this: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.navigationController?.navigationBar.isTranslucent = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.backgroundColor = .white <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.addSubviews() <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.setupConstraints() <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.bringSubview(toFront: avatar) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.setNeedsUpdateConstraints() }</code> </pre> <br>  You can also add this <code>self.title = "John Doe"  viewDidLoad</code> , which will add a "Profile" to the navigation bar so that the user knows where he is at the moment.  Start the application and the result should look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/880/327/147/88032714733a4e3b6030ce51e93a63d3.jpg" alt="image" width="500"></div><br><h2>  Refactoring our View Controller </h2><br>  Before proceeding, we need to reduce our <code>ViewController.swift</code> file in order to be able to use only real logic, and not just code for user interface elements.  We can do this by creating a subclass of <code>UIView</code> and moving all our user interface elements there.  The reason we do this is to follow the Model-View-Controller or MVC architectural pattern for short.  Learn more about MVC <a href="https://www.raywenderlich.com/1073-model-view-controller-mvc-in-ios-a-modern-approach">Model-View-Controller (MVC) in iOS: a modern approach</a> . <br><br>  Now right-click on the <code>ContactCard</code> folder in the Project Navigator and select "New File": <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd3/bc3/51d/bd3bc351d325b664cb1eec2424404216.jpg" alt="image"><br><br>  Click on Cocoa Touch Class and then Next.  Now write ‚ÄúProfileView‚Äù as the class name, and next to ‚ÄúSubclass of:‚Äù, be sure to enter ‚ÄúUIView‚Äù.  This simply tells XCode to automatically make our class inheritable from <code>UIView</code> , and it will add some template code.  Now click Next, then Create and remove the commented code: <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">/* // Only override draw() if you perform custom drawing. // An empty implementation adversely affects performance during animation. override func draw(_ rect: CGRect) { // Drawing code } */</span></span></code> </pre> <br>  And now we are ready to refactor. <br><br>  Cut and paste all the lazy variables from the view controller into our new look. <br>  Below the last deferred variable, override <code>init(frame :)</code> by typing <code>init</code> , and then selecting the first autocomplete result from Xcode. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d30/f88/a04/d30f88a040c0b48c67eadc91e33dd7a9.jpg" alt="image"><br><br>  An error will appear stating that the ‚Äúrequired‚Äù initializer ‚Äúinit (coder :)‚Äù must be provided by the subclass ‚ÄúUIView‚Äù: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a6b/056/2e4/a6b0562e48fa340a63f41e370ebb8cd6.jpg" alt="image"><br><br>  You can fix this by clicking on the red circle and then Fix. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/de8/c0f/faf/de8c0ffafd81bd2703d1f1a9400fa45a.jpg" alt="image"><br><br>  In any overridden initializer, you almost always have to call the initializer of the superclass, so add this line of code at the top of the method: <code>super.init (frame: frame)</code> . <br>  Cut and paste the <code>addSubviews()</code> method under the initializers and remove <code>self.view</code> before each <code>addSubview</code> call. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addSubviews</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { addSubview(avatar) addSubview(upperView) addSubview(segmentedControl) addSubview(editButton) }</code> </pre> <br>  Then call this method from the initializer: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(frame: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(frame: frame) addSubviews() bringSubview(toFront: avatar) }</code> </pre> <br>  For restrictions, override <code>updateConstraints()</code> and add a call at the end of this function (where it will always remain): <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateConstraints</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// Insert code here super.updateConstraints() // Always at the bottom of the function }</span></span></code> </pre> <br>  When overriding any method, it is always useful to check its documentation by visiting Apple documents or, more simply, hold down the Option (or Alt) key and click on the function name: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a2c/30c/5e7/a2c30c5e775e0e806ee2c1a00e14c128.jpg" alt="image"><br><br>  Cut and paste the constraint code from the view controller into our new method: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateConstraints</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { avatar.autoAlignAxis(toSuperviewAxis: .vertical) avatar.autoPinEdge(toSuperviewEdge: .top, withInset: <span class="hljs-number"><span class="hljs-number">64.0</span></span>) upperView.autoPinEdgesToSuperviewEdges(with: .zero, excludingEdge: .bottom) segmentedControl.autoPinEdge(toSuperviewEdge: .<span class="hljs-keyword"><span class="hljs-keyword">left</span></span>, withInset: <span class="hljs-number"><span class="hljs-number">8.0</span></span>) segmentedControl.autoPinEdge(toSuperviewEdge: .<span class="hljs-keyword"><span class="hljs-keyword">right</span></span>, withInset: <span class="hljs-number"><span class="hljs-number">8.0</span></span>) segmentedControl.autoPinEdge(.top, to: .bottom, of: avatar, withOffset: <span class="hljs-number"><span class="hljs-number">16.0</span></span>) editButton.autoPinEdge(.top, to: .bottom, of: upperView, withOffset: <span class="hljs-number"><span class="hljs-number">16.0</span></span>) editButton.autoPinEdge(toSuperviewEdge: .<span class="hljs-keyword"><span class="hljs-keyword">right</span></span>, withInset: <span class="hljs-number"><span class="hljs-number">8.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.updateConstraints() }</code> </pre> <br>  Now go back to the view controller and initialize the <code>ProfileView</code> instance above the <code>viewDidLoad</code> method <code>let profileView = ProfileView(frame: .zero)</code> , add it as a subview to the <code>ViewController</code> . <br><br>  Now our view controller is reduced to a few lines of code! <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PureLayout class ViewController: UIViewController { let profileView = ProfileView(frame: .zero) override func viewDidLoad() { super.viewDidLoad() self.navigationController?.navigationBar.isTranslucent = false self.title = "Profile" self.view.backgroundColor = .white self.view.addSubview(self.profileView) self.profileView.autoPinEdgesToSuperviewEdges() self.view.layoutIfNeeded() } }</code> </pre> <br>  To make sure everything works as intended, run your application and see what it looks like. <br><br>  Having a thin, tidy review controller should always be your goal.  It may take a long time, but it will save you from unnecessary trouble during maintenance. <br><br><h2>  UITableView </h2><br>  Next we will add a UITableView to present the contact information, such as phone number, address, etc. <br><br>  If you have not done so already, go to the Apple documentation to familiarize yourself with the UITableView, UITableViewDataSource and UITableViewDelegate. <br><br><ul><li>  <a href="https://developer.apple.com/documentation/uikit/uitableview">UITableView - UIKit |</a>  <a href="https://developer.apple.com/documentation/uikit/uitableview">Apple Developer Documentation</a> </li><li>  <a href="https://developer.apple.com/documentation/uikit/uitableviewdatasource">UITableViewDataSource - UIKit |</a>  <a href="https://developer.apple.com/documentation/uikit/uitableviewdatasource">Apple Developer Documentation</a> </li><li>  <a href="https://developer.apple.com/documentation/uikit/uitableviewdelegate">UITableViewDelegate - UIKit |</a>  <a href="https://developer.apple.com/documentation/uikit/uitableviewdelegate">Apple Developer Documentation</a> </li></ul><br>  Go to <code>ViewController.swift</code> and add <code>lazy var</code> for <code>tableView</code> above <code>viewDidLoad()</code> : <br><br><pre> <code class="swift hljs"><span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tableView: <span class="hljs-type"><span class="hljs-type">UITableView</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> tableView = <span class="hljs-type"><span class="hljs-type">UITableView</span></span>() tableView.translatesAutoresizingMaskIntoConstraints = <span class="hljs-literal"><span class="hljs-literal">false</span></span> tableView.delegate = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> tableView.dataSource = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tableView }()</code> </pre> <br>  If you try to start the application, Xcode complains that this class is neither a delegate nor a data source for the <code>UITableViewController</code> , and therefore we will add these two protocols to the class: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITableViewDataSource</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITableViewDelegate</span></span></span><span class="hljs-class"> </span></span>{ . . .</code> </pre> <br>  Once again, Xcode will complain about a class that does not comply with the <code>UITableViewDataSource</code> protocol, which means that there are mandatory methods in this protocol that are not defined in the class.  To find out which of these methods you must implement, while holding Cmd + Control, click the <code>UITableViewDataSource</code> protocol in the class definition and you will proceed to the protocol definition.  For any method that is not preceded by the word <code>optional</code> , a class corresponding to this protocol must be implemented. <br><br>  Here we have two methods that we need to implement: <br><br><ol><li>  <code>public func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int</code> - this method tells the table view how many rows we want to show. </li><li>  <code>public func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell</code> - this method requests a cell in each row.  Here we initialize (or reuse) the cell and insert the information we want to show to the user.  For example, the first cell will display the phone number, the second cell will display the address, and so on. </li></ol><br>  Now go back to <code>ViewController.swift</code> , start typing <code>numberOfRowsInSection</code> , and when auto-complete appears, select the first option. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, numberOfRowsInSection section: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> { &lt;#code#&gt; }</code> </pre> <br>  Delete the word code and return it now 1. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, numberOfRowsInSection section: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> </pre> <br>  Under this feature, start typing <code>cellForRowAt</code> and select the first method from autocomplete again. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span> { &lt;#code#&gt; }</code> </pre> <br>  And, again, for now, return <code>UITableViewCell</code> . <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span>() }</code> </pre> <br>  Now, to connect our table view inside <code>ProfileView</code> , we define a new initializer that takes a table view as a parameter so that it can add it as a subview and set the appropriate restrictions for it. <br><br>  Go to <code>ProfileView.swift</code> and add an attribute for the table view directly above the initializer: <br><br> <code>var tableView: UITableView!</code>  determined, so we are not sure that he will be constantly. <br><br>  Now replace the old <code>init (frame :)</code> implementation with: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(tableView: <span class="hljs-type"><span class="hljs-type">UITableView</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(frame: .zero) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.tableView = tableView addSubviews() bringSubview(toFront: avatar) }</code> </pre> <br>  Xcode will now complain about the missing <code>init (frame :)</code> for <code>ProfileView</code> , so go back to <code>ViewController.swift</code> and replace <code>let profileView = ProfileView (frame: .zero)</code> with <br><br><pre> <code class="swift hljs"><span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profileView: <span class="hljs-type"><span class="hljs-type">UIView</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">ProfileView</span></span>(tableView: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.tableView) }()</code> </pre> <br>  Now our <code>ProfileView</code> has a link to the table view, and we can add it as a subview, and set the correct limits for it. <br>  Returning to <code>ProfileView.swift</code> , add <code>addSubview(tableView)</code> to the end of <code>addSubviews()</code> and set these restrictions to <code>updateConstraints()</code> above <code>super.updateConstraints</code> : <br><br><pre> <code class="swift hljs">tableView.autoPinEdgesToSuperviewEdges(with: .zero, excludingEdge: .top) tableView.autoPinEdge(.top, to: .bottom, of: segmentedControl, withOffset: <span class="hljs-number"><span class="hljs-number">8</span></span>)</code> </pre> <br>  The first line adds three constraints between the table view and its superview: the right, left, and bottom sides of the table view are attached to the right, left, and bottom sides of the profile view. <br><br>  The second row attaches the top of the table view to the bottom of the segmented control with an interval of eight points between them.  Run the application, and the result should look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a5/f31/c6f/8a5f31c6f6925e6466e4bfbb94df1c03.jpg" alt="image" width="500"></div><br>  Great, now everything is in place, and we can begin to deploy our cells. <br><br><h2>  UITableViewCell </h2><br>  To implement <code>UITableViewCell</code> , we almost always need to create subclasses of this class, so right-click the <code>ContactCard</code> folder in the Project Navigator, then ‚ÄúNew file ...‚Äù, then ‚ÄúCocoa Touch Class‚Äù and ‚ÄúNext‚Äù. <br><br>  Enter ‚ÄúUITableViewCell‚Äù in the ‚ÄúSubclass of:‚Äù field, and Xcode will automatically fill in the class name ‚ÄúTableViewCell‚Äù.  Enter ‚ÄúProfileView‚Äù before autocomplete so that the final name is ‚ÄúProfileInfoTableViewCell‚Äù, then click ‚ÄúNext‚Äù and ‚ÄúCreate‚Äù.  Go ahead and delete the created methods, since we will not need them.  If you want, you can first read their descriptions to see why we don‚Äôt need them right now. <br><br>  As we said earlier, our cell will contain basic information, which is the name of the field and its description, and therefore we will need labels for them. <br><br><pre> <code class="swift hljs"><span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> titleLabel: <span class="hljs-type"><span class="hljs-type">UILabel</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> label = <span class="hljs-type"><span class="hljs-type">UILabel</span></span>() label.translatesAutoresizingMaskIntoConstraints = <span class="hljs-literal"><span class="hljs-literal">false</span></span> label.text = <span class="hljs-string"><span class="hljs-string">"Title"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> label }() <span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> descriptionLabel: <span class="hljs-type"><span class="hljs-type">UILabel</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> label = <span class="hljs-type"><span class="hljs-type">UILabel</span></span>() label.translatesAutoresizingMaskIntoConstraints = <span class="hljs-literal"><span class="hljs-literal">false</span></span> label.text = <span class="hljs-string"><span class="hljs-string">"Description"</span></span> label.textColor = .gray <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> label }()</code> </pre> <br>  And now we will override the initializer so that the cell can be configured: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(style: <span class="hljs-type"><span class="hljs-type">UITableViewCellStyle</span></span>, reuseIdentifier: <span class="hljs-type"><span class="hljs-type">String?</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(style: style, reuseIdentifier: reuseIdentifier) contentView.addSubview(titleLabel) contentView.addSubview(descriptionLabel) } <span class="hljs-keyword"><span class="hljs-keyword">required</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>?(coder aDecoder: <span class="hljs-type"><span class="hljs-type">NSCoder</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">fatalError</span></span>(<span class="hljs-string"><span class="hljs-string">"init(coder:) has not been implemented"</span></span>) }</code> </pre> <br>  As for the restrictions, we are going to do a little bit different, but, nevertheless, very useful: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateConstraints</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> titleInsets = <span class="hljs-type"><span class="hljs-type">UIEdgeInsetsMake</span></span>(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>) titleLabel.autoPinEdgesToSuperviewEdges(with: titleInsets, excludingEdge: .bottom) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> descInsets = <span class="hljs-type"><span class="hljs-type">UIEdgeInsetsMake</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>) descriptionLabel.autoPinEdgesToSuperviewEdges(with: descInsets, excludingEdge: .top) descriptionLabel.autoPinEdge(.top, to: .bottom, of: titleLabel, withOffset: <span class="hljs-number"><span class="hljs-number">16</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.updateConstraints() }</code> </pre> <br>  Here we start using <code>UIEdgeInsets</code> to set intervals around each label.  A <code>UIEdgeInsets</code> object can be created using the <code>UIEdgeInsetsMake(top:, left:, bottom:, right:)</code> method <code>UIEdgeInsetsMake(top:, left:, bottom:, right:)</code> .  For example, for <code>titleLabel</code> we say that we want the upper limit to be four points, and the right and left eight.  We do not care about the bottom because we exclude it, as we will attach it to the top of the description label.  Take a minute to read and visualize all the constraints in your head. <br><br>  Great, now we can start drawing the cells in our table view.  Let's go to <code>ViewController.swift</code> and change the lazy initialization of our table view to register this class of cells in the table view and set the height for each cell. <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> profileInfoCellReuseIdentifier = <span class="hljs-string"><span class="hljs-string">"profileInfoCellReuseIdentifier"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tableView: <span class="hljs-type"><span class="hljs-type">UITableView</span></span> = { ... tableView.register(<span class="hljs-type"><span class="hljs-type">ProfileInfoTableViewCell</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, forCellReuseIdentifier: profileInfoCellReuseIdentifier) tableView.rowHeight = <span class="hljs-number"><span class="hljs-number">68</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tableView }()</code> </pre> <br>  We also add a constant for the cell's reuse identifier.  This identifier is used to remove cells from the table view when they are displayed.  This is an optimization that you can (and should) use to help <code>UITableView</code> reuse cells that were previously presented to display new content instead of redrawing a new cell from scratch. <br>  Now let me show you how to reuse cells in one line of code in the <code>cellForRowAt</code> method: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell = tableView.dequeueReusableCell(withIdentifier: profileInfoCellReuseIdentifier, <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: indexPath) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">ProfileInfoTableViewCell</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell }</code> </pre> <br>  Here we inform the tabular view of the withdrawal of a reusable cell from the queue using the identifier under which we registered the path to the cell that is about to appear to the user.  Then we force the cell to be brought to <code>ProfileInfoTableViewCell</code> so that we can access its properties so that we can, for example, set the title and description.  This can be done using the following: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span> { ... <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> indexPath.row { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: cell.titleLabel.text = <span class="hljs-string"><span class="hljs-string">"Phone Number"</span></span> cell.descriptionLabel.text = <span class="hljs-string"><span class="hljs-string">"+234567890"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: cell.titleLabel.text = <span class="hljs-string"><span class="hljs-string">"Email"</span></span> cell.descriptionLabel.text = <span class="hljs-string"><span class="hljs-string">"john@doe.co"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: cell.titleLabel.text = <span class="hljs-string"><span class="hljs-string">"LinkedIn"</span></span> cell.descriptionLabel.text = <span class="hljs-string"><span class="hljs-string">"www.linkedin.com/john-doe"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell }</code> </pre> <br>  Now set the <code>numberOfRowsInSection</code> to return "3" and start your application. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/505/b15/586/505b15586c806763ec3c52d41a2236d5.jpg" alt="image" width="500"></div><br>  Amazing right <br><br><h2>  Self-Sizing Cells </h2><br>  It is possible, and most likely there will be a case when you want different cells to have a height in accordance with the information inside them, which is not known in advance.  To do this, you will need a table view with automatically calculated dimensions, and in fact there is a very simple way to do this. <br><br>  First of all, in <code>ProfileInfoTableViewCell</code> add this line to the <code>descriptionLabel</code> lazy initializer: <br><br><pre> <code class="swift hljs">label.numberOfLines = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  Go back to <code>ViewController</code> and add these two lines to the initializer of the table view: <br><br><pre> <code class="swift hljs"><span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tableView: <span class="hljs-type"><span class="hljs-type">UITableView</span></span> = { ... tableView.estimatedRowHeight = <span class="hljs-number"><span class="hljs-number">64</span></span> tableView.rowHeight = <span class="hljs-type"><span class="hljs-type">UITableViewAutomaticDimension</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tableView }()</code> </pre> <br>  Here we inform the table view that the row height should have an automatically calculated value based on its content. <br><br>  Regarding the estimated row height: <br><blockquote>  ‚ÄúThe table view can be improved.‚Äù - Apple Docs </blockquote><br>  In <code>ViewDidLoad</code> we need to reload the table view for these changes to take effect: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() ... <span class="hljs-type"><span class="hljs-type">DispatchQueue</span></span>.main.async { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.tableView.reloadData() } }</code> </pre> <br>  Now go and add another cell, increasing the number of rows to four and adding another <code>switch</code> to the <code>cellForRow</code> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: cell.titleLabel.text = <span class="hljs-string"><span class="hljs-string">"Address"</span></span> cell.descriptionLabel.text = <span class="hljs-string"><span class="hljs-string">"45, Walt Disney St.\n37485, Mickey Mouse State"</span></span></code> </pre> <br>  Now run the application, and it should look something like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9a8/f04/90c/9a8f0490c9411ff4507941dfab818d1f.jpg" alt="image" width="500"></div><br><h2>  Conclusion </h2><br>  Amazing isn't it?  And as a reminder of why we actually write our user interface with code, here‚Äôs the whole blog post written by our mobile team, why we <a href="https://instabug.com/blog/why-we-dont-use-interface-builder-and-storyboards-at-instabug/">don‚Äôt use Instabug storyboards</a> . <br><br>  What you have done in two parts of this lesson: <br><br><ul><li>  Removed <code>main.storyboard</code> file from your project. </li><li>  We created a <code>UIWindow</code> programmatically and assigned it a <code>rootViewController</code> . </li><li>  We created various user interface elements in the code, such as tags, image views, segmented controls, and table views with their cells. </li><li>  Embedded <code>UINavigationBar</code> into your application. </li><li>  Created a dynamic size <code>UITableViewCell</code> . </li></ul></div><p>Source: <a href="https://habr.com/ru/post/447374/">https://habr.com/ru/post/447374/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447364/index.html">Microsoft Edge on Chromium officially available for open testing.</a></li>
<li><a href="../447366/index.html">What is the best way to start a project or how to make it so that it would not be then painfully painful</a></li>
<li><a href="../447368/index.html">Not just catching fleas. Why speed is so important for any store</a></li>
<li><a href="../447370/index.html">Why, because of a broken patent system, the shadow of Theranos still hangs over us</a></li>
<li><a href="../447372/index.html">IT transformation is inevitable: where to start</a></li>
<li><a href="../447376/index.html">SNA Hackathon 2019</a></li>
<li><a href="../447380/index.html">Exceptions in Kotlin and their features</a></li>
<li><a href="../447382/index.html">The book "Unity and C #. Gamedev from idea to implementation. 2nd ed ¬ª</a></li>
<li><a href="../447384/index.html">Power semiconductors on guard environmental</a></li>
<li><a href="../447388/index.html">TL; ITMO University DR-digest: non-classical admission to university, upcoming events and the most interesting materials</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>