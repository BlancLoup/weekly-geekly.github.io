<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to really use Veeam% ProductName% Free to the fullest</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inspired by the publication ‚ÄúSqueezing all the juices from the free version of Veeam Backup & Replication‚Äù , I decided to write my HowTo how to fully ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to really use Veeam% ProductName% Free to the fullest</h1><div class="post__text post__text-html js-mediator-article">  Inspired by the publication <a href="http://habrahabr.ru/post/252995/">‚ÄúSqueezing all the juices from the free version of Veeam Backup &amp; Replication‚Äù</a> , I decided to write my HowTo how to fully use Veeam. <br><br><img src="https://habrastorage.org/files/4b2/bcd/afb/4b2bcdafba83432585209285262c3e83.png"><br><br>  This is not an advertising article, there are no thousands and one colorful screen.  It is also not a review of products, of which enough is enough.  Just useful information how to fully use the free solutions from Veeam in a corporate environment.  Dry commands and tips.  Everything described below is my personal experience and, in some places, links to representatives of Veeam, the official forum and habrauser. <br><a name="habracut"></a><br><h3>  Automatic installation of Veeam Endpdoint Backup </h3><br>  I'll start with Veeam Endpdoint Backup, because  This is a relatively new product designed to simplify the life of the IT sector and users.  Installation is never easier: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>EndpointBackup.exe / silent</i> <br><br>  Naturally, it is better to use the automatic installation tools.  Choose your favorite, for example, you can <a href="http://habrahabr.ru/post/150518/">put from the "exe" through WSUS</a> .  I do not recommend disassembling the installation file on MSI, since  there are a lot of manifestos, it all works as an assembly.  Unfortunately, after studying the VEEAM forum, I found out that there is no sane solution for automatic configuration, and I did not find it myself, but I got the impression that the settings of the backup rules are stored in the MSSQL database (UPD: the <a href="http://habrahabr.ru/company/veeam/blog/263231/">guess was confirmed</a> ). <br><br><h3>  Veeam Endpoint Backup e-mail notifications </h3><br>  In the current version there is no possibility to create Veeam Endpoint Backup alerts (hereinafter referred to as VEB) out of the box.  But the email solution is, especially, lying on the surface.  This is the eventlog monitoring, in this case with PowerShell tools: <a href="http://forums.veeam.com/veeam-endpoint-backup-f33/here-it-is-powershell-script-to-add-veb-emails-t27569.html">Topic on the Veeam forum</a> . <br><br>  I deliberately do not provide a ready-made PS-script, because  It is better to study the above link and create the necessary solution on its base.  I, for example, have this sharpened zabbiks.  Let the alert be sent by the one who is trained, and no matter where, what on the soap, what on the SMS, that in other contact. <br><br>  UPD: in version 1.5 of 03/17/2016 they wrote down alerts, albeit in a limited way, admins are indignant, but <a href="https://forums.veeam.com/veeam-endpoint-backup-f33/deploying-endpoint-backup-with-config-t30896-15.html">we are looking for options</a> <br><br><h3>  Veeam Endpdoint Backup works fine with some server solutions. </h3><br>  Here I asked a question about backup and restore domain controllers.  Having a rather pitiable experience in restoring the CD system from the backup image of <i>another vendor</i> , I caught the USN Rollback.  After that, I swore to restore only from "state systems".  I must say that the negative experience was 10 years ago, on Win2k3.  I am sure that now everything would be fine, but as they say, the sediment remained and I did not trust Veeam either.  So, it is known that CD is an fastidious enough entity for restoration options, but VEB did the job perfectly well.  VSS is used correctly, the USN RollBack did not catch it, but I think my small tupnet about booting in safe mode is forgivable. <br><br>  I will add that there is no <b>official support for backup and recovery using VEB</b> AD, SQL, Exchange, etc.  So use rather as an additional option. <br><br>  For those who did not follow the link above, I would say that in my case the CD was a backup, on Win2k12R2, with the role of GC, DNS, DHCP, File Services.  Spinning inside ESXi 5.5.  For recovery, it was loaded from a VEB ISO image created in the same environment.  Although it was possible ... <br><br><h3>  VEB loading with PXE </h3><br>  We have Acronis purchased for several workstays, through it there is a regular backup of super-critical workstations.  It is clear that VEB does not know how to centrally admin or even alert for soap without crutches, but with the advent of the Veeam solution, the idea to backup absolutely all stations in case the system partition fails to ‚Äúdisk D‚Äù has matured.  Yes, in case of failure of the entire hard disk, this will not help, but if the ‚ÄúTse disk‚Äù fails, it will still be faster to restore the backup than to lift the system through WDS and roll up some specific things, such as client banks.  By the way, WDS is a great tool ... And then it dawned on why to create ISO Recovery Media ISO images for each workshop, then store and burn somewhere on a CD / USB flash drive, go on foot !!!  to another floor ... In general, the VEB recovery boot image is WinRE of the version of Windows (EXTERNAL) in which it was created.  Forgot to mention, <a href="http://www.veeam.com/blog/veeam-endpoint-backup-architecture-requirements.html">VEB supports</a> only modern versions of Windows, starting with Win7 SP1.  So, having created an ISO image with default settings on one of the machines in a virtual environment, I unpacked it and pulled out the boot.wim file.  I put it in the WDS and ... downloaded over the network.  From the first time, without tambourines.  The network worked, was able to log in to the linux ball, where the backup files were located and roll back the backup.  We go further.  After several successful and not very successful experiences, I came to the conclusion that it is necessary to add to the WDS boot image typical network card drivers used by us.  What I did immediately, directly in the WDS snap-in, the benefit of adding drivers to the boot image (boot.wim) does not require disassembly / assembly using DISM, unlike the installation image (install.wim).  In general, everything is as usual, if you deploy Windows through WDS, you have already added drivers to the server.  And also, let me remind you that the guys from Veeam added several useful pieces to the recovery boot image, such as resetting the local admin password or memory testing. <br><br>  Spoon of <s>tar</s> objectivity.  As with the normal boot image, you should have multiple recovery images.  For Win7 x32, Win 7 x64, Win2k8, Win2k12, etc.  By the way, the option of restoring from a backup copy of Windows Backup is also there.  And loading through WDS you <a href="http://habrahabr.ru/company/veeam/blog/255729/">break</a> nothing. <br><br><h3>  Launch Veeam Backup &amp; Recovery Free from console </h3><br>  According to the link at the beginning of the article, the author made a little reservation, saying that VB &amp; R Free can backup virtual machines via <b>Start-VBRZip</b> .  At that time, this was not the case, but here the Veeam employee promised that such functionality would be implemented.  And at the end of April it happened. <br>  Indeed, as many know, now <b>Start-VBRZip</b> can be run under the FREE license, but with a number of restrictions.  The main ones are only full backup, and only one virtual machine in one task.  By the way, through the GUI you can run several backups at the same time, but in <i>different</i> tasks.  Not scary, I thought, and after reading the <a href="http://helpcenter.veeam.com/backup/80/powershell/index.html%3Fgetting_started.html">instructions</a> , in the simplest version implemented the script like this: <br><br>  Script on PoSH.  In this example for VMware. <br><br><pre><code class="hljs mel"># Initialize Veeam Toolkit &amp; <span class="hljs-string"><span class="hljs-string">"C:\Program Files\Veeam\Backup and Replication\Backup\Initialize-VeeamToolkit.ps1"</span></span> # Set Virtual Machines list $vmNames = <span class="hljs-string"><span class="hljs-string">'vm1.domain.lcl'</span></span>, <span class="hljs-string"><span class="hljs-string">'vm2.domain.lcl'</span></span>, <span class="hljs-string"><span class="hljs-string">'vm3.domain.lcl'</span></span>, <span class="hljs-string"><span class="hljs-string">'vmX.domain.lcl'</span></span> # Start backup job <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> each VM from list foreach ($i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $vmNames) { $viObject = Find-VBRViEntity -Server vc1.domain.lcl -Name $i Start-VBRZip -BackupRepository <span class="hljs-string"><span class="hljs-string">"VeeamBackupRepo02"</span></span> -Entity $viObject -Compression <span class="hljs-number"><span class="hljs-number">5</span></span> }</code> </pre> <br>  I will explain: <br>  <b>$ vmNames</b> - list of virtual machines for sequential backup.  <i>Be sure to</i> use a space, as it is written, otherwise Veeam will consider that this is a list of machines within one task, work it out correctly and send it ... indicating that there can be only one machine in one task. <br>  <b>vc1.domain.lcl</b> is the address of the vCenter.  You can cling directly to the host, but you remember that VB &amp; R cannot work on the free version of vSphere.  Minimum - vSphere Essentials.  (I know that you can sort of like using Veeam on completely free ESXi 5.0, but nobody promises anything here). <br>  <b>VeeamBackupRepo02</b> - repository, where to backup machines.  Where did the custom repository come from in the FREE version?  About this below. <br><br><h3>  Email alerts. </h3><br>  In my case, the traffic regulations from Yandex are used, so I‚Äôll just leave it here: <br>  <b>Menu -&gt; Options -&gt; E-mail Setting</b> <br><img src="https://habrastorage.org/files/290/f54/a97/290f54a97bdf40d6a71029b35a6ec11f.png"><br><br><img src="https://habrastorage.org/files/334/512/4aa/3345124aa12349ce86cb1c55461247ae.png"><br><br>  In the case of another mail server it may be different.  Google in Yandex and vice versa. <br><br><h3>  Manage additional chips. </h3><br>  Turn on the full VB &amp; R FREE interface and do not turn it off.  When loading a snap in the full interface will ask to buy a license or leave as is.  I understand that this is a marketing lure.  Let <a href="https://habrahabr.ru/users/sysmetic/" class="user_link">sysmetic</a> answer <a href="https://habrahabr.ru/users/sysmetic/" class="user_link">better</a> .  Work does not interfere, and you can manage repositories, which is not available in the "poor" interface. <br><br><h3>  Run VB &amp; R tasks through the scheduler. </h3><br>  I try for each task or service to create my own AD or local user with the minimum necessary rights.  In the case of launching VB &amp; R tasks from a specially trained account, I didn‚Äôt work: <br>  <b>Requested registry access is not allowed</b> <br>  <a href="http://forums.veeam.com/powershell-f26/requested-registry-access-is-not-allowed-t26511.html">One of the topics on the VEEAM forum</a> <br>  Raising rights to the maximum in the domain did not lead to anything.  As a result, through the Windows scheduler, I had to run the task from that user (to the word of the admin domain), under which VB &amp; R was set.  I know that when I change my password according to plan, the task will fly off, but for now it‚Äôs like that.  All Veeam services run under the "system account", I could not find a solution. <br>  In general, the task of running the PowerShell script from the Windows Task Scheduler should be created as follows: <br>  <b>Program or script:</b> <br>  <i>C: \ Windows \ System32 \ WindowsPowerShell \ v1.0 \ powershell.exe</i> <br><br>  <b>Add arguments:</b> <br>  <i>-File "G: \ Backup \ Scripts \ VbrZip2.ps1"</i> <br><br>  On this, really really fly in the ointment, I‚Äôm finishing my set of recommendations for a pair of FREE versions from Veeam.  Once again I express my gratitude to Veeam for unique products and I wish everyone that the backups were complete, but they never had to be used in battle. </div><p>Source: <a href="https://habr.com/ru/post/261573/">https://habr.com/ru/post/261573/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../261561/index.html">Parsing Formats: Packed Hashed Resources</a></li>
<li><a href="../261563/index.html">Brief introduction to tensors</a></li>
<li><a href="../261567/index.html">Veeam Availability Suite v9: EMC Storage Integration</a></li>
<li><a href="../261569/index.html">Services for testing penetration testing skills</a></li>
<li><a href="../261571/index.html">Creating the Droste effect in Wolfram Language (Mathematica)</a></li>
<li><a href="../261575/index.html">Python 2.7 performance improvements</a></li>
<li><a href="../261577/index.html">Meet Backup Exec 15</a></li>
<li><a href="../261579/index.html">Yandex.Money does not require the cardholder‚Äôs full name when paying</a></li>
<li><a href="../261581/index.html">IBM Science and Technology Center announces additional recruitment for the internship program for 2015/2016</a></li>
<li><a href="../261583/index.html">Question to the community: a shared private message box for HB, GT and MM, how are you?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>