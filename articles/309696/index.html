<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to secure a Linux system: 10 tips</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="GNU / Linux kernel creator Linus Torvalds shared his opinion on system security at the 2015 LinuxCon annual conference in 2015. He stressed the need t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to secure a Linux system: 10 tips</h1><div class="post__text post__text-html js-mediator-article">  GNU / Linux kernel creator Linus Torvalds shared his opinion on system security at the 2015 LinuxCon annual conference in 2015.  He stressed the need to mitigate the effect of the presence of certain bugs competent protection, so that if one component fails, the next layer covers the problem. <br><br>  In this article we will try to open this topic from a practical point of view: <br><br> <a href="https://habrahabr.ru/company/1cloud/blog/309696/"><img src="https://habrastorage.org/files/b2a/161/aed/b2a161aed52047f6b02f559514e67f3a.jpg"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>/ photo by <a href="https://www.flickr.com/photos/28687188%40N05/9182179611/">Dave Allen</a> <a href="https://creativecommons.org/licenses/by/2.0/">CC</a></i> <br><a name="habracut"></a><br><ul><li>  Let's start with pre-settings and recommendations for choosing and installing Linux distributions; </li><li>  then we will tell about a simple and effective point of protection - updating the security system; </li><li>  further we consider how to configure restrictions for programs and users; </li><li>  how to secure a connection to the server via SSH; </li><li>  We give examples of setting up a firewall and restricting unwanted traffic; </li><li>  in the final part we will explain how to disable unnecessary programs and services, how to additionally protect servers from intruders. </li></ul><br><h3>  1. Set up a preboot environment before installing Linux </h3><br>  You need to take care of system security before installing Linux.  Here are a set of recommendations for setting up a computer that should be taken into account and executed before installing the operating system: <br><br><ul><li>  Booting in UEFI mode (not legacy BIOS - about it subsection below) </li><li>  Set a password for setting UEFI </li><li>  Enable SecureBoot mode </li><li>  Set a password at UEFI level to boot the system </li></ul><br><h3>  2. Choose a suitable Linux distribution </h3><br>  Most likely, you will choose popular distributions - Fedora, Ubuntu, Arch, Debian, or other close branches.  In any case, you need to take into account the mandatory presence of these functions: <br><br><ul><li>  Forced (MAC) and Role-Based Access Control (RBAC) support: SELinux / AppArmor / GrSecurity </li><li>  Security Bulletin Publishing </li><li>  Regular security updates </li><li>  Cryptographic packet verification </li><li>  UEFI and SecureBoot support </li><li>  Full native disk encryption support </li></ul><br>  <b>Recommendations for installing distributions</b> <br><br>  All distributions are different, but there are moments that you should definitely pay attention to and execute: <br><br><ul><li>  Use full disk encryption (LUKS) with a reliable key phrase. </li><li>  The paging process must be encrypted </li><li>  Set a password to edit the bootloader </li><li>  Strong root access password </li><li>  Use an account without privileges, belonging to the group of administrators </li><li>  Set a strong password for the user, different from the root password </li></ul><br><h3>  3. Configure Automatic Security Updates </h3><br>  One of the main ways to keep your operating system safe is to update the software.  Updates often fix found bugs and critical vulnerabilities. <br><br>  In the case of server systems, there is a risk of failures during the upgrade, but, in our opinion, problems can be minimized by automatically installing only <a href="https://1cloud.ru/help/linux/linux_security_basics">a</a> security <a href="https://1cloud.ru/help/linux/linux_security_basics">update</a> . <br><br>  Auto-update only works for installed from repositories, not for self-compiled packages: <br><br><ul><li>  In Debian / Ubuntu, the unattended upgrades package is used for updates. </li><li>  At CentOS, auto-update uses yum-cron </li><li>  Fedora has dnf-automatic for this purpose. </li></ul><br>  To upgrade, use any of the available RPM package managers with the commands: <br><br><pre><code class="bash hljs">yum update</code> </pre> <br>  or <br><br><pre> <code class="bash hljs">apt-get update &amp;&amp; apt-get upgrade</code> </pre> <br>  Linux can be configured to send email alerts for new updates. <br><br>  Also, to maintain security in the Linux kernel, there are <a href="http://www.cyberciti.biz/tips/linux-security.html">security extensions</a> , for example, SELinux.  Such an extension will help to save the system from incorrectly configured or dangerous programs. <br><br>  SELinux is a flexible access control system that can work simultaneously with an access control system.  Running programs get access to files, sockets, and other processes, and SELinux sets restrictions so that harmful applications cannot break the system. <br><br><h3>  4. Restrict access to external systems </h3><br>  The next method of protection after the upgrade is <a href="http://www.tldp.org/LDP/lame/LAME/linux-admin-made-easy/security.html">to restrict access</a> to external services.  To do this, you need to edit the files /etc/hosts.allow and /etc/hosts.deny. <br><br>  Here is an example of how to restrict access to telnet and ftp: <br><br>  In the /etc/hosts.allow file: <br><br><pre> <code class="bash hljs">hosts.allow in.telnetd: 123.12.41., 126.27.18., .mydomain.name, .another.name in.ftpd: 123.12.41., 126.27.18., .mydomain.name, .another.name</code> </pre> <br>  The example above allows telnet and ftp connections to any host in IP classes 123.12.41. * And 126.27.18. *, As well as to a host with the domains mydomain.name and another.name. <br><br>  Next in the /etc/hosts.deny file: <br><br><pre> <code class="bash hljs">hosts.deny in.telnetd: ALL in.ftpd: ALL</code> </pre> <br>  <b>Add user with limited rights</b> <br><br>  We <a href="https://1cloud.ru/help/linux/linux_security_basics">do not recommend</a> connecting to the server as the root user - he has the right to execute any commands, even critical for the system.  Therefore, it is better to create a user with limited rights and work through it.  Administration can be performed through sudo (substitute user and do) - this is a temporary elevation of rights to the administrator level. <br><br>  How to create a new user: <br><br>  <i>In Debian and Ubuntu:</i> <br><br>  Create a user by replacing administrator with the desired name and enter the password in response to the corresponding request.  The entered password characters are not displayed on the command line: <br><br><pre> <code class="bash hljs">adduser administrator</code> </pre> <br>  Add a user to the sudo group: <br><br><pre> <code class="bash hljs">adduser administrator sudo</code> </pre> <br>  Now you can use the sudo prefix when executing commands that require administrative rights, for example: <br><br><pre> <code class="bash hljs">sudo apt-get install htop</code> </pre> <br>  <i>On CentOS and Fedora:</i> <br><br>  Create a user by replacing administrator with the desired name, and create a password for his account: <br><br><pre> <code class="bash hljs">useradd adminstrator &amp;&amp; passwd administrator</code> </pre> <br>  Add the user to the wheel group to transfer him sudo rights: <br><br><pre> <code class="bash hljs">usermod ‚ÄìaG wheel administrator</code> </pre> <br>  Use only strong passwords - at least 8 letters of different case, numbers and other special characters.  To search for weak passwords among users of your server, use utilities like ‚ÄúJohn the ripper‚Äù, change the settings in the pam_cracklib.so file to force passwords to be set. <br><br>  Set the password aging period with the chage command: <br><br><pre> <code class="bash hljs">chage -M 60 -m 7 -W 7 </code> </pre> <br>  You can disable password aging by using the following command: <br><br><pre> <code class="bash hljs">chage -M 99999 </code> </pre> <br>  Find out when a user's password expires: <br><br><pre> <code class="bash hljs">chage -l </code> </pre> <br>  You can also edit the fields in the / etc / shadow file: <br><br><pre> <code class="bash hljs">{}:{password}:{lastpasswdchanged}:{Minimum_days}:{Maximum_days}:{Warn}:{Inactive}:{Expire}:</code> </pre> <br>  Where, <br><br><ul><li>  Minimum_days: The minimum number of days until the password expires. </li><li>  Maximum_days: The maximum number of days until the password expires. </li><li>  Warn: Number of days before expiration, when the user will be warned about the approaching bottom of the shift. </li><li>  Expire: The exact date of expiration of the login. </li></ul><br>  It is also worth limiting the reuse of old passwords in the pam_unix.so module and setting the limit on the number of failed user login attempts. <br><br>  To find out the number of failed login attempts: <br><br><pre> <code class="bash hljs">faillog</code> </pre> <br>  Unlock account after login failed: <br><br><pre> <code class="bash hljs">faillog -r -u </code> </pre> <br>  To block and unblock accounts, you can use the passwd command: <br><br><pre> <code class="bash hljs">lock account passwd -l </code> </pre> <br><pre> <code class="bash hljs">unlocak account passwd -u </code> </pre> <br>  To make sure that all users have passwords, use the command: <br><br><pre> <code class="bash hljs">awk -F: <span class="hljs-string"><span class="hljs-string">'($2 == "") {print}'</span></span> /etc/shadow</code> </pre> <br>  Block users without passwords: <br><br><pre> <code class="bash hljs">passwd -l </code> </pre> <br>  Make sure that the UID parameter is set to 0 only for the root account.  Enter this command to view all users with a 0 UID. <br><br><pre> <code class="bash hljs">awk -F: <span class="hljs-string"><span class="hljs-string">'($3 == "0") {print}'</span></span> /etc/passwd</code> </pre> <br>  You should only see: <br><br><pre> <code class="bash hljs">root:x:0:0:root:/root:/bin/bash</code> </pre> <br>  If other lines appear, then check if you set the UID for them to 0, delete unnecessary lines. <br><br><h3>  5. Set permissions for users </h3><br>  After setting the passwords, it‚Äôs worth making sure that all users have access appropriate to their rank and responsibility.  In Linux, you can set permissions on files and directories.  So it is possible to create and control different levels of access for different users. <br><br>  <b>Access categories</b> <br><br>  Linux is based on working with multiple users, so each file belongs to one specific user.  Even if the server is administered by one person, several accounts are created for different programs. <br><br>  You can view users in the system with the command: <br><br><pre> <code class="bash hljs">cat /etc/passwd</code> </pre> <br>  The / etc / passwd file contains a line for each user of the operating system.  For services and applications, individual users can be created who will also be present in this file. <br><br>  In addition to individual accounts, there is a category of access for groups.  Each file belongs to one group.  One user can belong to several groups. <br><br>  You can view the groups your account belongs to with the command: <br><br><pre> <code class="bash hljs">groups</code> </pre> <br>  List all groups in the system, where the first field indicates the name of the group: <br><br><pre> <code class="bash hljs">cat /etc/group</code> </pre> <br>  There is a category of access "other" if the user does not have access to the file and does not belong to the group. <br><br>  <b>Types of access</b> <br><br>  For categories of users it is possible to set access types.  This is usually the rights to run, read and modify the file.  In Linux, access types are marked with two kinds of notation: alphabetic and octal. <br><br>  In alphabetical notation, the resolutions are marked with the letters: <br><br><blockquote>  r = read <br>  w = change <br>  x = launch </blockquote><br>  In the octal notation, the level of access to files is defined by numbers from 0 to 7, where 0 means no access, and 7 means full access to change, read, and execute: <br><br><blockquote>  4 = read <br>  2 = change <br>  1 = start </blockquote><br><h3>  6. Use keys to connect over SSH </h3><br>  To connect to the host via SSH, password authentication is usually used.  We <a href="https://1cloud.ru/help/linux/linux_security_basics">recommend a</a> more secure way - entering a pair of cryptographic keys.  In this case, the private key is used instead of the password, which will seriously complicate the selection by brute-force. <br><br>  For example, create a pair of keys.  Actions must be performed on the local computer and not on the remote server.  In the process of creating keys, you can specify a password to access them.  If you leave this field empty, you will not be able to use the generated keys until they are saved in the computer's keychain manager. <br><br>  If you have already created RSA keys before, then skip the generation command.  To verify existing keys, run: <br><br><pre> <code class="bash hljs">ls ~/.ssh/id_rsa*</code> </pre> <br>  To generate new keys: <br><br><pre> <code class="bash hljs">ssh-keygen ‚Äìb 4096</code> </pre> <br>  <b>Upload public key to server</b> <br><br>  Replace administrator with the name of the key owner, and 1.1.1.1 with the ip-address of your server.  From the local computer, type: <br><br><pre> <code class="bash hljs">ssh-copy-id administrator@1.1.1.1</code> </pre> <br>  To check the connection, disconnect and reconnect to the server - the input should be based on the generated keys. <br><br>  <b>SSH setup</b> <br><br>  You can prohibit connecting via SSH as a root user, and use sudo at the beginning of the command to obtain administrator rights.  On the server, in the / etc / ssh / sshd_config file, you need to find the PermitRootLogin parameter and set its value to no. <br><br>  You can also disable the SSH connection by entering a password so that all users use the keys.  In the / etc / ssh / sshd_config file, set the PasswordAuthentification parameter to no.  If this line is not present or commented out, then add or uncomment it accordingly. <br><br>  In Debian or Ubuntu, you can enter: <br><br><pre> <code class="bash hljs">nano /etc/ssh/sshd_config ... PasswordAuthentication no</code> </pre> <br>  Connection can also be additionally secured using <a href="http://changelog.complete.org/archives/9707-easily-improving-linux-security-with-two-factor-authentication">two-factor authentication</a> . <br><br><h3>  7. Install firewalls </h3><br>  Recently, <a href="http://www.theregister.co.uk/2016/08/10/linux_tor_users_open_corrupted_communications/">a</a> new vulnerability has been <a href="http://www.theregister.co.uk/2016/08/10/linux_tor_users_open_corrupted_communications/">discovered</a> that allows DDoS attacks against servers running Linux.  A bug in the core of the system appeared with version 3.6 at the end of 2012.  Vulnerability allows hackers to inject viruses into download files, web pages, and uncover Tor connections, and no need to make a lot of effort for hacking - the IP spoofing method will work. <br><br>  The maximum harm for encrypted HTTPS or SSH connections is the interruption of the connection, but an attacker can put new content, including malicious programs, into unprotected traffic.  To protect against such attacks, a firewall is suitable. <br><br>  <b>Block access using Firewall</b> <br><br>  Firewall is one of the most important tools to block unwanted incoming traffic.  We <a href="https://1cloud.ru/help/linux/linux_security_basics">recommend</a> skipping only really needed traffic and completely banning the rest. <br><br>  For packet filtering, most Linux distributions have an iptables controller.  Usually it is used by experienced users, and for simplified configuration, you can use the UFW utilities in Debian / Ubuntu or FirewallD in Fedora. <br><br><h3>  8. Disable unnecessary services. </h3><br>  Specialists from the University of Virginia <a href="http://its.virginia.edu/unixsys/sec/">recommend</a> disabling all services that you do not use.  Some background processes are set to autoload and work until the system is turned off.  To configure these programs you need to check the initialization scripts.  Start of services can be carried out through inetd or xinetd. <br><br>  If your system is configured via inetd, then in /etc/inetd.conf you can edit the list of background programs ‚Äúdemons‚Äù, to turn off the service load, just put the ‚Äú#‚Äù sign at the beginning of the line, turning it from executable into a comment. <br><br>  If the system uses xinetd, its configuration will be in the /etc/xinetd.d directory.  Each directory file defines a service that can be disabled by specifying disable = yes, as in this example: <br><br><pre> <code class="bash hljs">service finger { socket_type = stream <span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> = no user = nobody server = /usr/sbin/in.fingerd <span class="hljs-built_in"><span class="hljs-built_in">disable</span></span> = yes }</code> </pre><br>  Also worth checking out are the persistent processes that are not managed by inetd or xinetd.  You can configure startup scripts in the /etc/init.d or / etc / inittab directories.  After the changes are made, run the command as root. <br><br><pre> <code class="bash hljs">/etc/rc.d/init.d/inet restart</code> </pre> <br><h3>  9. Protect the server physically </h3><br>  It is impossible to completely defend against attacks from an attacker with physical access to the server.  Therefore it is necessary to secure the room where your system is located.  Data centers seriously monitor security, restrict access to servers, install security cameras and assign permanent security. <br><br>  To enter the data center all visitors must pass certain stages of authentication.  It is also strongly recommended to use motion sensors in all rooms of the center. <br><br><h3>  10. Protect the server from unauthorized access </h3><br>  The unauthorized access system or IDS collects system configuration data and files, and further compares these data with new changes to determine if they are harmful to the system. <br><br>  For example, Tripwire and Aide tools collect a database of system files and protect them with a set of keys.  Psad is used to monitor suspicious activity using firewall reports. <br><br>  Bro is designed to monitor the network, track suspicious action patterns, collect statistics, execute system commands, and generate alerts.  RKHunter can be used to protect against viruses, most often rootkits.  This utility scans your system against known vulnerabilities and may define unsafe settings in applications. <br><br><h3>  Conclusion </h3><br>  The tools and settings listed above will help you partially protect the system, but security depends on your behavior and understanding of the situation.  Without care, caution and constant self-study, all protective measures may not work. <br><br>  <i>What else do we write about:</i> <i><br><br></i> <ul><li>  <i><a href="https://1cloud.ru/news/myths-about-cloud-providers-part1">Cloud Technology Myths.</a></i>  <i><a href="https://1cloud.ru/news/myths-about-cloud-providers-part1">Part 1</a></i> </li><li>  <i><a href="https://1cloud.ru/news/myths-about-cloud-providers-part2">Cloud Technology Myths.</a></i>  <i><a href="https://1cloud.ru/news/myths-about-cloud-providers-part2">Part 2</a></i> </li><li>  <i><a href="https://1cloud.ru/news/how-to-create-iaas-provider">How to create a virtual infrastructure provider</a></i> </li><li>  <i><a href="https://1cloud.ru/news/it-project-area-choice">How to choose a direction for the development of an IT project</a></i> </li><li>  <i><a href="https://1cloud.ru/news/21-question-to-iaas-provider">What you need to know about IaaS-provider before starting work</a></i> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/309696/">https://habr.com/ru/post/309696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309678/index.html">Scaling text in a block using jQuery</a></li>
<li><a href="../309684/index.html">Internet marketing for a network of fitness centers: the realities of today</a></li>
<li><a href="../309686/index.html">Blockchain as a ‚Äúmagic tablet‚Äù?</a></li>
<li><a href="../309688/index.html">Secrets of the effective management of data centers around the world: from Tokyo to St. Louis, from Sydney to London</a></li>
<li><a href="../309694/index.html">Intel and Hewlett Packard have released a security alert for a ThinkPwn vulnerability</a></li>
<li><a href="../309698/index.html">Adobe Captivate feature overview</a></li>
<li><a href="../309700/index.html">The digest of interesting materials for Mobile Developer # 170 (September 5-11)</a></li>
<li><a href="../309702/index.html">We write quine-polyglot-palindromes in honor of the day 2 ^ 2 ^ 3</a></li>
<li><a href="../309704/index.html">Several ways to optimize working with Git</a></li>
<li><a href="../309706/index.html">Create a localized system voice menu in 3CX</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>