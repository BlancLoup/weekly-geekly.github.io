<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating your own model for extracting information from the text using the web-API from Meanotek</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Now there are many services that allow you to extract some information from texts, such as named entities, such as the names of people, organizations,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating your own model for extracting information from the text using the web-API from Meanotek</h1><div class="post__text post__text-html js-mediator-article">  Now there are many services that allow you to extract some information from texts, such as named entities, such as the names of people, organizations, places, dates, which allows you to solve some interesting problems.  But much more interesting tasks are left out of the box. <br><br>  What if you need the names of goods, and not all, but some specific?  Or do we want to interpret commands for a mobile application?  Split the address on the name of the street, home, city?  How about highlighting the important facts from the client's appeal to the support service: ‚ÄúI am outraged by the quality of <i>service</i> in your company.  Not so long ago, I ordered a <i>laptop</i> , but the <i>manager spoke incorrectly</i> and said that the <i>goods had ended</i> . ‚Äù  Today I will talk about the new service that allows you to solve a wide range of tasks of extracting information from the text.  This service we have just opened for public access. <br><a name="habracut"></a><br>  <b>What you need to work with the examples from this article</b> : The article mainly considers the solution for the .NET Framework in C #.  Any language for the .NET Framework or mono is also suitable.  From other languages, you can also access the web-API, but there are no ready-made libraries yet, so you have to write the request code manually.  It is not difficult, but here I will not explain in detail how to do it in order not to lose the main idea.  You will also need internet access and an open port 8080. You will also need to register to receive a free key.  It seems, basically everything. <br><br>  <b>How this article is organized:</b> First, the task is explained, by the example of which the work of the API will be shown.  The following is the code.  Then a bit of theory is told about how the system works from the inside, and at the end it‚Äôs about the limitations of the current version, and when this system will be useful and when it will not. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Parse the problem</b> : As an example, take the task of extracting the names of goods from the text.  Those.  ‚ÄúBuy a <i>Canon I-SENSIS i6500</i> Laser Printer at the office supplies store.‚Äù  It is necessary to find references to products to analyze information about products and prices on the Internet, or a system that displays product ads based on page content.  Well, for various other purposes. <br><br>  It may seem that the task is simple and it does not cost anything.  For example, for some groups of goods, especially with English names, you can try to write regular expressions that distinguish the names of goods from the text.  But this method does not allow to distinguish, for example, ‚ÄúBuy HTC One‚Äù (phone model) from ‚ÄûSamsung Apple Nokia phones‚Äù (just a list of manufacturers), which is often the case.  Regular expressions will not help at all if you need products that are called in Russian, for example, ‚ÄúAtlant Atlas 500 is sold‚Äù - it‚Äôs not at all clear where the name begins. <br><br>  Therefore, we will try to teach a computer to distinguish the name of a product from other text based on a number of examples.  The main advantage of this approach is that you don‚Äôt have to invent an algorithm yourself, and the minus is the need to manually create examples for learning. <br><br>  What should the examples look like?  Suppose we have the following sentence: ‚ÄúBuy Samsung Galaxy S4 in the‚Äú Our phones ‚Äùstore.  We divide it into separate words and present it as a column.  Then, in front of the names of the goods write the word ‚ÄúProduct‚Äù: <br><br><table><tbody><tr><td>  Buy </td><td></td></tr><tr><td>  Samsung </td><td>  PRODUCT </td></tr><tr><td>  Galaxy </td><td>  PRODUCT </td></tr><tr><td>  S4 </td><td>  PRODUCT </td></tr><tr><td>  at </td><td></td></tr><tr><td>  our </td><td></td></tr><tr><td>  the store </td><td></td></tr><tr><td>  &lt;STOP&gt; </td><td></td></tr><tr><td>  Also </td><td></td></tr><tr><td>  ... </td><td></td></tr></tbody></table><br>  Thus, we formulated the task - to determine whether the word is part of the name of the product, or not.  After learning by examples, we can simply send the text as a left column to the model input and get the right column at the output.  It seems that everything is quite simple. <br><br>  In practice, the main difficulty is to manually mark a sufficient number of examples for learning.  The more examples, the better the model will work.  The logical question is - how many examples are ‚Äúquite a lot‚Äù?  It all depends on the task - the more complex the task, the more data is needed.  In general, between 400 and 4000 examples of the occurrence of the desired element are usually required.  As for the time spent, in our experience, three days of annotation of examples in some cases is enough for the purposes of creating a working prototype, although in more complex situations this time may increase significantly. <br><br>  For this article, we have prepared a <a href="">marked up training kit here</a> .  In this case, the training set is created from web page headers, so the resulting model will work well with headers.  Later I will explain how to improve the quality of recognition in other texts, but for now let's focus on the main idea. <br><br>  The entire data set needs to be divided into two parts - train - the model will be trained on this part, and test - the result of the algorithm will be checked on this part (we already have two files in our training set).  Both files are included, and you can open them with Notepad or another text editor to view the structure. <br><br>  Next you need to <a href="http://www.meanotek.ru/register.php">register</a> , which will allow you to get a free API key, and <a href="">load the library of functions</a> (some browsers may request confirmation, as the archive contains the dll library).  For C #, you will need to create a console application and connect it to the Meanotek.NeuText.Cloud.dll project <br><br>  Now we write the program.  First, create a new model, giving it a name.  The name must be unique among all your models, because by it the model will subsequently be identified and contain only Latin letters and numbers: <br><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Meanotek.NeuText.Cloud; Model MyModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Model(<span class="hljs-string"><span class="hljs-string">" api "</span></span>,<span class="hljs-string"><span class="hljs-string">"ProductTitles"</span></span>); MyModel.CreateModel();</code> </pre> <br>  Next, load the data and put the model in the task queue: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">System</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Console</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.WriteLine</span></span>("  "); <span class="hljs-selector-tag"><span class="hljs-selector-tag">MyModel</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.UploadTrainData</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">products_train</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.txt</span></span>"); <span class="hljs-selector-tag"><span class="hljs-selector-tag">System</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Console</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.WriteLine</span></span>("  "); <span class="hljs-selector-tag"><span class="hljs-selector-tag">MyModel</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.UploadTestData</span></span> ("<span class="hljs-selector-tag"><span class="hljs-selector-tag">products_dev</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.txt</span></span>"); <span class="hljs-selector-tag"><span class="hljs-selector-tag">System</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Console</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.WriteLine</span></span>(" "); <span class="hljs-selector-tag"><span class="hljs-selector-tag">MyModel</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.TrainModel</span></span>();</code> </pre><br>  <i>TrainModel ()</i> suspends the program until the end of the training.  In general, this is not necessary (since it can take 10-20 minutes) and the program can do other things at this time and simply check the status of the learning process.  In order not to stop the program, you can use the <i>TrainModelAsync ()</i> method.  If during the work of <i>TrainModel () the</i> program is closed, or a network connection error occurs, the model will still be created on the server, since the program itself puts the model in a queue and does not do anything except wait at that time.  The next time you start the program, you can check the status of the model with the <i>Model.GetStatus ()</i> function. <br><br>  After the training is completed, we can display the test results for the test sample: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">Console</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.WriteLine</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">MyModel</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.GetValidationResults</span></span>());</code> </pre><br><img src="https://habrastorage.org/files/9a7/c7e/976/9a7c7e9764d2449ba5a15e0b877b5586.png"><br><br>  For each type of extracted expressions (category, product) a number of values ‚Äã‚Äãcharacterizing the quality of the system is calculated.  Recall is the ratio of the number of expressions (for example, names of goods) found by the algorithm to the total number of expressions found by man.  Precession - the proportion of correctly found expressions among all detected.  F1 is a collective criterion for the quality of the algorithm, which combines precession and recall together.  The closer this value is to 1.0, the better.  I will not explain in more detail here the meaning of all these metrics, and I suggest <a href="http://habrahabr.ru/post/228963/">that the</a> interested reader read <a href="http://habrahabr.ru/post/228963/">this article</a> , where, in my opinion, everything is considered well and in detail. <br><br>  I will only note, for comparison, that the widely used method of conditionally random fields (Conditional random fields) with signs in the form of words and digrams in a 5-word window gives F1 with product names 86.2 and 79.5 categories by category. <br><br>  Now let's try to submit a new example to the input: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> result_raw = MyModel.GetPredictionsRaw (<span class="hljs-string"><span class="hljs-string">"  CANON I-SENSIS i5600   "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> result = MyModel.GetPredictionsJson (<span class="hljs-string"><span class="hljs-string">"  CANON I-SENSIS i5600   "</span></span>); Console.WriteLine(result_raw); Console.WriteLine(result);</code> </pre><br><img src="https://habrastorage.org/files/fab/0ad/6be/fab0ad6be6d941f6a708a1d023cded10.png"><br><br>  <b>Theory (and philosophy):</b> The problem of extracting various expressions from a text has a long history, and there are many special tools to solve it.  But we wanted to make a very simple to use solution that would not require serious special skills, did without manual tuning, worked on relatively small samples and would be suitable for a wide range of tasks.  Then the creation of new models for extracting data from the text, and, consequently, new applications, would be available to individual developers and small companies who would be able to determine for themselves what analytical tools are required for their business. <br><br>  This required, first of all, to get rid of manual selection of signs, grammatical analyzers and all sorts of glossaries of terms, selected for specific tasks, without losing much in quality.  One of the models that allows this is deep recurrent neural networks (see figure).  The recurrent network consistently receives new words from the sentence as input, while preserving the memory of previous states.  At the output, the neural network produces the class to which the word belongs.  Several consecutive layers form more and more abstract understanding of the sentence, working on different time ranges (although this happens if everything is set up correctly, otherwise you can simply get a highly retrained neural network). <br><br><img src="https://habrastorage.org/files/255/f48/78e/255f4878e6de45d8a98586461b9a4a7b.png"><br><br>  It is known from research that such a model can extract complex expressions from English texts, including doing semantic role marking and tonality analysis.  The results are not inferior, and often even surpass the performance of all other known methods.  True, each work used its slightly different architecture, and the optimal parameters were different for different tasks. <br><br>  Therefore, we did a lot of work, checking several dozens of different models on 18 test collections of English and Russian texts, as a result we managed to find the most optimal neural network model and the way the input words were represented, so that the results were high on various tasks. <br><br>  In the end, the model chosen for the API is a compromise between speed and accuracy of work, although its result is still quite good, they are not the best possible.  But then, if necessary, the results of individual tasks can be increased due to this by connecting a slower model. <br><br>  <b>When it can be useful opportunities and limitations of implementation:</b> We have prepared a small table that shows in which cases our API can benefit you, what results can be expected, and what - you should not. <br><br><table><tbody><tr><td>  <b>When will be useful</b> <br></td><td>  <b>When will not be useful</b> </td></tr><tr><td>  <b>If you want to create applications with means of understanding texts, but are not familiar with the theory of language analyzers or have little experience</b> .  We tried to make the system create competitive models without manual configuration. <br></td><td>  <b>You are an expert in computer linguistics and you want to improve the quality of solving a problem that you have been working on for 5 years</b> .  We do not guarantee that the current implementation will exceed all specialized solutions. <br></td></tr><tr><td>  <b>You are solving a specific task of extracting information from the text, for which there is no ready-made API (that is, it is not easy to find the names of people, organizations, dates and geographical locations)</b> .  Our system can be trained for different tasks. <br></td><td>  <b>For your task there is already a specialized solution, for example, a ready-made named entity recognition API</b> .  Most likely you will find it easier to use a ready-made solution if you are sure that your needs are fully met. <br></td></tr><tr><td>  <b>You are limited in budget and available resources, and do not want to engage in further support and development of your own language analyzer.</b>  We follow the new research and introduce modern algorithms ourselves, so over time, the quality of the system designed on our API will increase at no additional cost <br></td><td>  <b>You have your own team of specialists, which is engaged in constant maintenance and development of the language analyzer.</b> <br></td></tr><tr><td>  <b>You want to save disk space or computing resources for the final application.</b>  You can save from 5 to 100 mb of space on the target device, which may be important for mobile applications.  You can easily install analysis functions in web applications that are on entry-level VPS or shared hosting. <br></td><td>  <b>Memory and CPU resources are available in unlimited quantities.</b> <br></td></tr></tbody></table><br>  Finally, on the limitations of the free API key.  At the time of this writing, the restrictions relate to the size of the training sample (up to 240 thousand characters of the text, not including class labels), the number of simultaneously working different models (up to 2 pieces) and the number of requests (42 thousand characters per day).  This should be enough for development, testing of most applications, for personal use, as well as for live work of not heavily loaded systems. </div><p>Source: <a href="https://habr.com/ru/post/258211/">https://habr.com/ru/post/258211/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258197/index.html">With enough money, all the mistakes come to the surface.</a></li>
<li><a href="../258199/index.html">ntfsclone - will create an image as others can not afford</a></li>
<li><a href="../258201/index.html">Discounts on upgrades to ReSharper Ultimate</a></li>
<li><a href="../258205/index.html">Elasticsearch - sort the issue by hand</a></li>
<li><a href="../258209/index.html">New PyCharm 4.5 brought together all the tools to work with Python</a></li>
<li><a href="../258213/index.html">Count the life of the site, or visualize the connection between pages</a></li>
<li><a href="../258217/index.html">Course young fighter. Practical course on Cisco Packet Tracer. Conclusion</a></li>
<li><a href="../258219/index.html">AI, Big Data and Disinformation Technologies</a></li>
<li><a href="../258223/index.html">All-weather meetings, hackathons, lectures and even internships for the IT community</a></li>
<li><a href="../258225/index.html">Callback - a great overview of callback services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>