<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hash steganography using vkapi</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr. Some time ago I decided to figure out what steganography is, what its meaning is and what it is like. And after a few links I came across an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hash steganography using vkapi</h1><div class="post__text post__text-html js-mediator-article"><p>  Hi, Habr.  Some time ago I decided to figure out what steganography is, what its meaning is and what it is like.  And after a few links I came across an interesting <a href="https://habrahabr.ru/post/272935/">article</a> about hash-steganography.  The question arose - why not try to implement this method of transmission in practice?  For starters - in the form of proof of concept. <br><img src="https://habrastorage.org/webt/6m/s4/h-/6ms4h-i3ou4napfv7xclccp9k-u.png" alt="image"></p><a name="habracut"></a><br><h2 id="hesh-steganografiya">  Hash steganography? </h2><br><p>  If the reader did not want to get acquainted with the mentioned article (I strongly advise), briefly convey the meaning. <br>  What do we imagine when we hear the word steganography?  We have a container in which we insert information.  We insert it so that at first (preferably at second) the container does not change.  But is there a way to transfer information without touching the container? </p><br><p>  Here hash steganography comes to the rescue.  The meaning is simple - we take a container (the best option is a picture with cats) and take a hash from it.  We cut off the hash 1 (2,5,10) character - let's say we received the letter z.  We take another 25 pictures and if we are lucky, then we got a kind of dictionary containing 26 entries of the form "letter" - "picture".  If you are unlucky, you will have to go through more pictures  Thus, we have an alphabet that can be used to send messages.  We load 10 specific cats on the server, the recipient downloads them from the server, gets a hash, cuts off 1 character and gets "HelloWorld".  And if you also encrypt it ... </p><br><p><img src="https://habrastorage.org/files/912/1c9/806/9121c9806ada40619a316812d823d5db.gif" alt="image"></p><br><h2 id="chto-iz-etogo-poluchilos-i-prichem-zdes-vkapi">  What came out of it and where is vkapi? </h2><br><p>  So, the task is clear - we need a program that will receive a message at the input, compress it, encrypt it, turn it into a seal, send it to the server.  On the other side, you need to get pictures, convert them to letters, decipher, "unclamp." </p><br><p>  Now we need a convenient Internet service, which would give the opportunity to freely (to a certain extent) upload pictures to the server and back.  I chose vk.com.  Everything you need for us is there - convenient albums that preserve the order of the uploaded photos, nice api. </p><br><p>  And the last - somewhere we need to store a lot of pictures.  MongoDB has been selected.  There are stored records of the form "path to the picture - hash pictures - the date of last use."  Find the desired hash, select the image that has been used for a long time, load it using the path shown. </p><br><h2 id="i-eto-rabotaet">  And does it work? </h2><br><p>  Yes, and it really works.  After <a href="https://github.com/RomaLash/vkhs_POC">downloading</a> and installing run the program: </p><br><pre><code class="hljs pgsql">python vkhs.py -e -l [<span class="hljs-keyword"><span class="hljs-keyword">login</span></span>] -aid [album id] -m HelloHabr <span class="hljs-keyword"><span class="hljs-keyword">Password</span></span>: message = HelloHabr len = <span class="hljs-number"><span class="hljs-number">10</span></span> chip = b<span class="hljs-string"><span class="hljs-string">'....'</span></span> len = <span class="hljs-number"><span class="hljs-number">18</span></span> upload message? Total uploaded: <span class="hljs-number"><span class="hljs-number">18</span></span></code> </pre> <br><p>  We run to see what we did: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/f2/5e/cd/f25ecdhjcvdthjhqbab8ebauufo.png"></a> </p><br><p>  We received a message consisting of 18 pictures.  It does not cause suspicions - especially if the pictures on one topic. </p><br><p>  Now we need to get our message: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">python</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vkhs</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.py</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-l</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[login]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-aurl</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[albumxxxxxxxx_xxxxxxxxx]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Password</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Login</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">success</span></span> 1 2 3 4 ... <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">HelloHabr</span></span>    ?</code> </pre> <br><p>  Voila, hidden chat works. </p><br><h2 id="problemy">  Problems </h2><br><p>  Here are some of them: </p><br><ol><li>  The compression algorithm - as seen on the provided screens, a message 11 characters long turns into a message 18 characters long.  On a long message length, this algorithm works fine, reducing the source code more than twice.  On a small - terrible. </li><li>  DB.  It needs to be updated regularly.  However, vk uses a very interesting way to store photos.  When we upload a photo there, the server automatically compresses it - it means that the hash changes.  However, there are photos whose hash does not change.  The reasons I did not understand.  And so the database is filled in according to the following algorithm - we download images from the Internet (ideally, we photograph beautiful landscapes in the park ourselves).  Then we upload them to the server, download it back.  Now we fill it again, saving the hashes in the database, load it back again.  We check the changed, delete and repeat the procedure.  After "sifting" there are those photos that "like" the server.  They are also loaded into the database. <br>  As you can see, the operation is not very pleasant, you need to think about how to do better.  However, there are so-called comparable hashes.  For example on Habr√© was a <a href="https://habrahabr.ru/post/120562/">cool article</a> .  To bypass this "random attack" instead of the usual hash, you can take a comparable hash. </li></ol><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  As a result of the work done, it was proved that the concept of using <del>  seals </del>  hash steganography has the right to life.  If you correct the problems and shortcomings in the existing version, you can create a chat that is absolutely safe (in theory). </p><br><p>  All materials related to this project are presented in my <a href="https://github.com/RomaLash/vkhs_POC">repository</a> . </p><br><p>  I want to thank the user <a href="https://habrahabr.ru/users/pavelmstu/" class="user_link">PavelMSTU</a> for help in developing the concept of the program and this article. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/351370/">https://habr.com/ru/post/351370/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351360/index.html">The art of exploiting minefields: We analyze CTF-task about the game of Minesweeper from "Mr. Robot"</a></li>
<li><a href="../351362/index.html">‚ÄúDigital States‚Äù: how they evolved</a></li>
<li><a href="../351364/index.html">The battle for network neutrality: two and a half years Net Neutrality</a></li>
<li><a href="../351366/index.html">Battle of Network Neutrality: A State War</a></li>
<li><a href="../351368/index.html">Network Digest: 20 materials on networks, protocols and the battle for Net Neutrality</a></li>
<li><a href="../351372/index.html">FFMPEG. Downloading part of a video from YouTube</a></li>
<li><a href="../351374/index.html">Barcode scanners for USAIS: myths and reality, selection criteria</a></li>
<li><a href="../351376/index.html">Speech recognition in python using pocketsphinx or how I tried to make a voice assistant</a></li>
<li><a href="../351378/index.html">Develop isomorphic RealWorld applications with SSR and Progressive Enhancement. Part 4 - Components and Composition</a></li>
<li><a href="../351380/index.html">Different Hibernate Naming Strategies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>