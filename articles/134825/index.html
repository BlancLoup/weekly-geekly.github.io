<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Recognition and speech synthesis in any iOS application in an hour</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction: 

 The toolbox itself is called NDEV. To get the necessary code (it‚Äôs not enough) and documentation (there‚Äôs a lot of it), you need to r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Recognition and speech synthesis in any iOS application in an hour</h1><div class="post__text post__text-html js-mediator-article"> <b>Introduction:</b> <br><br>  The toolbox itself is called NDEV.  To get the necessary code (it‚Äôs not enough) and documentation (there‚Äôs a lot of it), you need to register on the website in the ‚Äúcooperation program‚Äù  Site: <br><br>  <a href="http://dragonmobile.nuancemobiledeveloper.com/public/index.php">dragonmobile.nuancemobiledeveloper.com/public/index.php</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is the whole "hemorrhoids" if the clients of your application are less than half a million and they use services less than 20 times a day.  After registration, you will receive a Silver membership, which will allow you to use these services for free. <br>  Developers are offered step-by-step instructions for integrating speech recognition and synthesis services into their iOS application: <br><br><a name="habracut"></a><br><br>  The toolkit (SDK) contains the components of both the client and the server.  The diagram illustrates their interaction at the top level: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/351/8cb/dac/3518cbdacab4c00b8c31d7cf5d3950ef.jpg" alt="image"><br><br>  The Dragon Mobile SDK bundle consists of various code samples and project templates, documentation, and a software platform (framework) that simplifies the integration of voice services into any application. <br>  The Speech Kit framework allows you to easily and quickly add speech recognition and synthesis services (TTS, Text-to-Speech) to your applications.  This platform also provides access to speech processing components located on the server through asynchronous ‚Äúclean‚Äù network APIs, minimizing overhead and resource consumption. <br>  The Speech Kit platform is a full-featured high-level framework that automatically manages all low-level services. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f5f/ebc/0fe/f5febc0fefffd6133550e268db11de29.png" alt="image"><br>  Speech Kit Architecture <br><br>  <b>Main part</b> <br><br>  At the application level, the developer has two main services: speech recognition and speech synthesis from text. <br>  <b>The platform performs several consistent processes:</b> <br><br>  ÔÇß Provides full control of the audio system for recording and playback. <br>  ÔÇß The network component manages connections to the server and automatically restores connections that have elapsed timeout with each new request. <br>  ÔÇß The speech end detector detects when the user has finished speaking and automatically stops recording if necessary. <br>  ÔÇß The coding component compresses and decompresses audio streaming, reducing bandwidth requirements and reducing average latency. <br>  The server system is responsible for most of the operations involved in the speech processing cycle.  The process of recognition or speech synthesis is performed entirely on the server, processing or synthesizing the audio stream.  In addition, the server performs authentication in accordance with the configuration of the developer. <br>  In this particular article, we will focus on developing for iOS.  The Speech Kit framework can be used just like any standard iPhone software platform, such as Foundation or UIKit.  The only difference is that the Speech Kit is a static framework, and is entirely contained in the compilation of your application.  Speech Kit is directly related to some of the key operating components of the iPhone OS, which need to be included in the application as interdependent, so that they are available while the application is running.  In addition to Foundation, you need to add the System Configuration and Audio Toolbox components to the Xcode project: <br>  1. Start by selecting software platforms (Framework group) within your project. <br>  2. Then click the right or command button of the ‚ÄúPlatforms‚Äù (Frameworks) and in the appeared menu choose: Add ‚Ä£ Existing frameworks (Existing frameworks) ... <br>  3. Finally, select the required frameworks and click the Add button.  The selected platforms are displayed in the Frameworks folder (see figure above). <br>  To start using the SpeechKit software platform, add it to your new or existing project: <br>  1. Open your project and select the group in which you want the Speech Kit platform to be located, for example: file: Frameworks. <br>  2. From the menu, select Project (Project) ‚Ä£ Add to Project ... <br>  3. Next, find the SpeechKit.framework framework into which you unpacked the Dragon Mobile SDK toolkit and select Add. <br>  4. To make sure the Speech Kit is in your project and does not refer to the original location, select Copy items ... and then Add. <br>  5. As you can see, the Speech Kit platform has been added to your project, which you can extend to access public headers. <br><br>  <b>Speech Kit Platform Required</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/989/8c7/f2d/9898c7f2d3442e8b179e1a5e3214d5cd.png" alt="image"><br><br>  The Speech Kit framework provides a single top-level header that provides access to the full application programming interface (API), up to and including classes and constants.  You need to import Speech Kit headers into all the source files where you are going to use the Speech Kit services: <br><br>  #import &lt;SpeechKit / SpeechKit.h&gt; <br><br>  Now you can start using text-to-speech (speech synthesis) services. <br><br>  The Speech Kit platform is a network service and needs some basic settings before starting to use recognition classes or speech synthesis. <br>  This installation performs two basic operations: <br>  First, it identifies and authorizes your application. <br>  ÔÇß Secondly, - establishes a connection with a speech server, - this allows you to make quick requests for speech processing and, consequently, improves the quality of customer service. <br>  Note <br>  The specified network connection requires the authorization of the credentials and server settings specified by the developer.  Required credentials are provided through the Dragon Mobile SDK portal: <a href="http://dragonmobile.nuancemobiledeveloper.com/">dragonmobile.nuancemobiledeveloper.com</a> . <br>  Kit Setup Setup <br>  The key for the SpeechKitApplicationKey application is requested by the software platform and must be installed by the developer.  The key serves as the password for your application for speech processing servers and should be kept confidential to prevent misuse. <br>  Your unique credentials, including the Application Key, provided through the developer portal, imply the introduction of several additional lines of code to set these rights.  Thus, the process is reduced to copying and pasting lines in the source file.  You need to install your application key before initializing the Speech Kit system.  For example, you can configure an application key as follows: <br><br>  const unsigned char [] SpeechKitApplicationKey = {0x12, 0x34, ..., 0x89}; <br><br>  The setup method, setupWithID: host: port, contains 3 parameters: <br>   Application ID <br>  ÔÇß Server Address <br>  ÔÇß Port <br>  The ID parameter identifies your application and is used in conjunction with your application key, providing authorization for access to voice servers. <br>  Host and port settings define a voice server, which can vary from application to application.  Thus, you should always use the values ‚Äã‚Äãspecified by the authentication parameters. <br>  The framework is configured using the following example: <br><br>  [SpeechKit setupWithID: @ "NMDPTRIAL_Acme20100604154233_aaea77bc5b900dc4005faae89f60a029214d450b" <br>  host: @ "10.0.0.100" <br>  port: 443]; <br><br>  <b>Note</b> <br><br>  The setupWithID: host: port method is a class method and does not generate an object (instance).  This method is designed to make a one-time call while the application is running, it configures the main network connection.  This is an asynchronous method that runs in the background, establishes a connection, and performs authorization.  The method does not report a connection / authorization error.  The success or failure of this installation becomes known using the SKRecognizer and SKVocalizer classes. <br>  At this stage, the voice server is fully configured, and the platform begins to establish a connection.  This connection will remain open for some time, acting as a guarantee that subsequent voice requests are processed promptly as long as voice services are actively used.  If the connection times out, it is interrupted, but will be restored automatically at the same time as the next voice request. <br>  The application is configured and ready to recognize and synthesize speech. <br><br>  <b>Speech recognition</b> <br><br>  Recognition technology allows users to dictate instead of typing where text input is usually required.  Speech Recognizer provides a list of text results.  It is not tied to any user interface (UI) object, so the selection of the most appropriate result and the selection of alternative results are left to the user interface of each application. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b44/91f/8e9/b4491f8e9d86a98601b78561a70f4759.png" alt="image"><br>  Speech recognition process <br><br>  <b>Initiating the recognition process</b> <br><br>  1. Before using the speech recognition service, make sure that the original Speech Kit platform is configured by you using the setupWithID method: host: port. <br>  2. Then create and initialize the SKRecognizer object: <br>  3. recognizer = [[SKRecognizer alloc] initWithType: SKSearchRecognizerType <br>  4. detection: SKShortEndOfSpeechDetection <br>  5. language: @ "en_US" <br>  6. delegate: self]; <br>  7. The initWithType: detection: language: delegate method initializes the recognizer and starts the speech recognition process. <br>  ÔÇß Typical parameter - NSString *, this is one of the typical recognition constants defined by the Speech Kit platform and accessible through the SKRecognizer.h header.  Nuance can provide you with other values ‚Äã‚Äãfor your unique recognition needs, in which case you will need to add the NSString extension. <br>   The detection parameter sets the ‚Äúend of speech definition‚Äù model and must match one of the SKEndOfSpeechDetection types. <br>  ÔÇß The language parameter defines the language of speech as a string in the format of the ISO 639 language code, followed by the underscore ‚Äú_‚Äù, followed by the country code in the ISO 3166-1 format. <br>  Note <br>  For example, English, which is spoken in the United States, has the designation en_US.  An updated list of supported languages ‚Äã‚Äãfor recognition is available on the FAQ: <a href="http://dragonmobile.nuancemobiledeveloper.com/faq.php">dragonmobile.nuancemobiledeveloper.com/faq.php</a> . <br>  8. The delegate receives the recognition result or error message, as described below. <br>  Getting recognition results <br>  For recognition results, refer to the delegate method recognizer: didFinishWithResults: <br>  - (void) recognizer: (SKRecognizer *) recognizer didFinishWithResults: (SKRecognition *) results { <br>  [recognizer autorelease]; <br>  // perform any actions on the results <br>  } <br><br>  The delegation method will be applied only upon successful completion of the process; the list of results will contain zero or more results.  The first result can always be found using the firstResult method.  Even in the absence of an error, there may be advice (suggestion) from the speech server, which is present in the object of recognition results.  Such advice (suggestion) should be presented to the user. <br><br>  <b>Error processing</b> <br><br>  To get information about any recognition errors, use the delegation method recognizer: didFinishWithError: suggestion :.  In case of an error, only this method will be called;  on the contrary, if successful, this method will not be called.  In addition to the error, as mentioned in the previous section, advice may or may not be present as a result. <br>  - (void) recognizer: (SKRecognizer *) recognizer didFinishWithError: (NSError *) error suggestion: (NSString *) suggestion { <br>  [recognizer autorelease]; <br>  // inform the user about the error and advice <br>  } <br><br>  <b>Recording stage management</b> <br><br>  If you want to get information about when the recognizer starts or ends recording audio, use the delegation methods recognizerDidBeginRecording: and recognizerDidFinishRecording :.  So, there may be a delay between the initialization of recognition and the actual start of the recording, and the message recognizerDidBeginRecording: may signal to the user that the system is ready to listen. <br>  - (void) recognizerDidBeginRecording: (SKRecognizer *) recognizer { <br>  // Update UI to indicate that the system is recording <br>  } <br><br>  The message recognizerDidFinishRecording: is sent before the voice server finishes receiving and processing the sound file, and therefore, before the result is available. <br>  - (void) recognizerDidFinishRecording: (SKRecognizer *) recognizer { <br>  // Update UI to indicate that the recording has stopped and speech is still being processed <br>  } <br><br>  This message is sent regardless of the presence of a record end detection model.  The message is sent in the same way by calling the stopRecording method, and by the signal for detecting the end of the recording. <br>  Installation of "sound icons" (signals) <br>  In addition, ‚Äúsound icons‚Äù can be used to play sound signals before and after recording, as well as after canceling a recording session.  You need to create a SKEarcon object and set the setEarcon: forType: Speech Kit Platform method for it.  The example below demonstrates how the sound icons are set up in the example application. <br><br>  - (void) setEarcons { <br>  // Play ‚Äúsound icons‚Äù <br>  SKEarcon * earconStart = [SKEarcon earconWithName: @ "earcon_listening.wav"]; <br>  SKEarcon * earconStop = [SKEarcon earconWithName: @ "earcon_done_listening.wav"]; <br>  SKEarcon * earconCancel = [SKEarcon earconWithName: @ "earcon_cancel.wav"]; <br><br>  [SpeechKit setEarcon: earconStart forType: SKStartRecordingEarconType]; <br>  [SpeechKit setEarcon: earconStop forType: SKStopRecordingEarconType]; <br>  [SpeechKit setEarcon: earconCancel forType: SKCancelRecordingEarconType]; <br>  } <br><br>  When a higher-level code block is called (after you set up the main Speech Kit software platform using the setupWithID: host: port method), the earcon_listening.wav audio file plays and the earcon_done_listening.wav audio file plays when recording is completed.  If the recording session is canceled, the earcon_cancel.wav audio file sounds for the user. The ` ªearconWithName: method works only for audio files that are supported by the device. <br>  Sound level display <br><br>  In some cases, especially with long dictations, it is convenient to provide the user with a visual display of the sound power of his speech.  The recording interface supports this feature when applying the audioLevel attribute, which returns the relative power level of the recorded sound in decibels.  The range of this value is characterized by a floating point and is between 0.0 and -90.0 dB where 0.0 is the highest power level and -90.0 is the lower limit of the sound power.  This attribute must be available during recording, in particular, between the receipt of recognizerDidBeginRecording: and recognizerDidFinishRecording :.  In general, you will need to use a timer method, such as performSelector: withObject: afterDelay: to regularly display the power level. <br><br>  <b>Text to Speech</b> <br><br>  The SKVocalizer class provides developers with a speech synthesis network interface. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/afb/3b0/d97/afb3b0d97801f6bb85b2f428d20f0947.png" alt="image"><br>  Speech synthesis process <br><br>  <b>Initialization of the process of speech synthesis</b> <br><br>  1. Before using the speech synthesis service, make sure that the main software platform is configured with the Speech Kit using the setupWithID method: host: port. <br>  2. Then create and initialize a SKVocalizer object for text-to-speech: <br>  3. vocalizer = [[SKVocalizer alloc] initWithLanguage: @ "en_US" <br>  4. delegate: self]; <br>  five. <br>  1. The initWithLanguage method: delegate: initializes the speech synthesis service with the default language. <br>  ÔÇß Language parameter - NSString * which defines the language as an ISO 639 language code, an underscore ‚Äú_‚Äù and the country code following them in ISO 3166-1 format.  For example, English, which is used in the United States, has the format en_US.  Each supported language has one or more unique voices, male or female. <br>  Note <br>  An updated list of supported languages ‚Äã‚Äãfor speech synthesis is available at: <a href="http://dragonmobile.nuancemobiledeveloper.com/faq.php">dragonmobile.nuancemobiledeveloper.com/faq.php</a> .  The list of supported languages ‚Äã‚Äãwill be updated when new language support (s) appears.  New languages ‚Äã‚Äãwill not necessarily require updating the existing Dragon Mobile SDK. <br>  ÔÇß The delegated parameter defines the object for receiving status and error messages from the speech synthesizer. <br>  2. Method initWithLanguage: delegate: uses the default voice selected by Nuance.  To select a different voice, use the initWithVoice: delegate: method instead of the previous one. <br>  ÔÇß The voice parameter is NSString *, it defines the sound model.  For example, the voice for British English by default is Samantha (Samantha). <br>  Note <br>  An updated list of supported voices, mapped to supported languages, is posted on the site: <br>  <a href="http://dragonmobile.nuancemobiledeveloper.com/faq.php">dragonmobile.nuancemobiledeveloper.com/faq.php</a> . <br>  5. To start the text-to-speech process, you need to use the speakString: or speakMarkupString: method.  These methods send the requested string to the voice server and initialize the stream processing and playback of audio on the device. <br>  6. [vocalizer speakString: @ "Hello world."] <br><br>  <b>Note</b> <br><br>  The speakMarkupString method is used in exactly the same way as the speakString method with the only difference that the NSString * class is executed by the speech synthesis markup language used to describe synthesized speech.  Recent discussions of markup languages ‚Äã‚Äãfor speech synthesis are beyond the scope of this document, but you can find more detailed information on this topic provided by W3C at <a href="http://www.w3.org/TR/speech-synthesis/">www.w3.org/TR/speech-synthesis</a> . <br>  Speech synthesis is a network service and, therefore, the methods mentioned above are asynchronous - in general, the error message is not displayed immediately.  Any errors are presented as messages to the delegate. <br><br>  <b>Manage the response response of the speech synthesis system</b> <br><br>  Synthesized speech will not be reproduced instantly.  Most likely there will be a small time delay, during which the request is sent to the voice service and redirected back.  The optional delegational method of vocalizer: willBeginSpeakingString: is used to coordinate the user interface and is intended to indicate the point at which the sound begins to play. <br>  - (void) vocalizer: (SKVocalizer *) vocalizer willBeginSpeakingString: (NSString *) text { <br>  // Update the user interface to indicate the start of speech playback <br>  } <br><br>  The NSString * class in the message serves as a reference to the original string executed by one of the methods: speakString or speakMarkupString, and can be used during the sequential playback of a track when the corresponding text-to-speech requests are made. <br>  At the end of the speech, a message is sent to the vocalizer: didFinishSpeakingString: withError.  This message is always sent both in case of successful completion of the playback process and in case of an error.  If successful, the error is ‚Äúzeroed out‚Äù. <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- (void) vocalizer: (SKVocalizer *) vocalizer didFinishSpeakingString: (NSString *) text withError: (NSError *) error { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if (error) { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">// Display the error dialog for the user</font></font><br>  } else { <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> // Update user interface, indicate that playback is complete </font></font><br>  } <br>  } <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> After these manipulations, you just have to debug the appropriate service and use. </font></font></div><p>Source: <a href="https://habr.com/ru/post/134825/">https://habr.com/ru/post/134825/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134820/index.html">Introduction to mnemonics</a></li>
<li><a href="../134821/index.html">Three20 demystifying: TTModel</a></li>
<li><a href="../134822/index.html">SockJS server performance study</a></li>
<li><a href="../134823/index.html">Asynchronous function sequential call</a></li>
<li><a href="../134824/index.html">2GIS - iOS version appeared</a></li>
<li><a href="../134826/index.html">Do I need authorization after registration?</a></li>
<li><a href="../134828/index.html">Optimize battery consumption</a></li>
<li><a href="../134830/index.html">Bleed, I'm sorry. Or a post dedicated to hamsters from IT</a></li>
<li><a href="../134833/index.html">Easy publication of PEAR packages</a></li>
<li><a href="../134834/index.html">PCB manufacturing process at home</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>