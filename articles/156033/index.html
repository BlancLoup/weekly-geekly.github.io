<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CDN for 70,000 sites with one button</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What comes first to your mind when you hear the abbreviation CDN? Surely, "heavy content", "a lot of video", "terabytes of data", "millions of hits a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CDN for 70,000 sites with one button</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/cde/f90/364/cdef903643e8dfc89d5348f35c279b7f.jpg" align="left">  What comes first to your mind when you hear the abbreviation CDN?  Surely, "heavy content", "a lot of video", "terabytes of data", "millions of hits a day." <br><br>  There are not so many projects in RuNet that are characterized by similar words.  Oleg Bunin, the organizer of the HighLoad ++ conference (we trust him in matters of workload :)), recently gave this assessment: CDN is needed in Russia and at the same time economically justified by several dozen sites in Russia. <br><br>  And what about the smaller sites (which - in fact - the vast majority: online stores, blogs, corporate sites, etc.)?  Do they need a CDN?  And if so, why is there no rush demand for this service?  And is it possible to make a small revolution on the web with a single module in the CMS? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Answers to these questions - under the cut ... <br><a name="habracut"></a><br>  Let's start with the question ... <br><br>  <b>Why ordinary sites do not connect CDN?</b> <br><br>  In short, it is expensive and difficult. <br><br>  For example, in the company <a href="http://cdnvideo.ru/">CDNvideo</a> (one of the few Russian CDNs in general, which at the same time also have a clear price list for services on the site), <a href="http://cdnvideo.ru/uslugi/tarify">tariffs</a> start at 3,000 rubles.  per month with traffic from 1 TB. <br><br>  For the owner of the site, choosing between hosting, for example, for 300 and 500 rubles.  - expensive. <br><br>  The connection itself, it seems, should not cause difficulties (configure the DNS, replace local links with new ones), but the devil, as is well known, is in the details.  How not to forget to replace all links (they can be generated dynamically by an application, be rigidly written on pages, can be specified in style files (css) and scripts (js))?  How to keep development and debugging convenience while working on development servers with local copies?  How to update the CDN cache when updating files?  In general, everything is not too clear ... <br><br>  If everything is expensive and difficult, then ... <br><br>  <b>Does CDN need a regular site?</b> <br><br>  On the usual site there is no heavy content, which literally ‚Äúasks‚Äù itself in the CDN.  Even the most progressive online stores that post on the site, for example, video reviews from customers, most likely just put links to YouTube, and do not keep everything at home. <br><br>  However, a lot can be ‚Äúmoved‚Äù closer to the visitor: all pictures, style files (css), javascript (js), etc.  - in fact, almost all static content can be transferred to the CDN.  And this is an average of up to 80% of traffic. <br><br>  In addition to speeding up the CDN network itself by distributing content from the servers closest to the visitors, the site that included the CDN receives additional acceleration on the client side (when the page is rendered by the browser) by distributing requests across different domains. <br><br>  All modern browsers have a limit on the number of simultaneous connections to one domain (usually - no more than 6). <br><br><img src="https://habrastorage.org/storage2/338/c54/c7f/338c54c7fad694481327eef384d2b569.png"><br>  According to <a href="http://www.browserscope.org/%3Fcategory%3Dnetwork">www.browserscope.org/?category=network</a> <br><br>  Thus, even if the server can render pages at maximum speed, and the client connection speed is high enough, anyway, the loading of all page elements (pictures, scripts, style files) will be carried out with a maximum of 6 threads. <br><br>  When a CDN is connected, local links are replaced with different domains, and only each individual domain has a limit on the number of connections.  Their actual maximum number becomes several times larger (according to the number of domains from which files are loaded). <br><br>  <b>Speed ‚Äã‚Äãwin is seconds.</b>  <b>And what is the practical use of this?</b>  <b>For example, for an online store.</b> <br><br>  The main advantage in performance growth ... <br><br>  <b>1. On a fast site, higher conversion and more page views.</b> <br><br>  The longer the page of the site loads, the more likely that the most impatient visitors will not wait for it to load, leave the site and no longer return to it. <br><br>  There are various studies in which attempts are made to find such potential customers that the site ‚Äúloses‚Äù.  For example, an <a href="http://5coins.ru/2012/09/28/mgnovennaya-amerika/">infographic from 5coins</a> says that 25% of site visitors leave a page that takes more than 4 seconds to load: <br><br><img src="https://habrastorage.org/storage2/dd3/044/5ae/dd30445ae91223195facd0ddda981342.png"><br><br>  Having <a href="http://www.gomez.com/pdfs/wp_why_web_performance_matters.pdf">analyzed 150 million hits on 150 sites</a> , GoMez specialists received the following figures: slowing down the page load by 1 second reduces the conversion by 7%, and the number of views by 11%. <br><br><img src="https://habrastorage.org/storage2/e35/d22/74c/e35d2274cff7a6d1a49276e73b4e5f26.png"><br><br>  All these studies, of course, are not indisputable, they raise questions and research methods, and the numbers obtained.  But the main conclusion - ‚Äúfaster website - more views‚Äù - seems absolutely fair. <br><br>  <b>2. In search engines, the position of the fast site is higher.</b> <br><br>  Search algorithms and results ranking formulas are kept secret by each search engine.  However, it is absolutely obvious that search robots indexing websites on the Internet, without waiting for the page to load, will not take it into account in the general search index.  In addition, behavioral factors have an increasing importance on search results.  And this means that a visitor who has left a ‚Äúslow‚Äù page will automatically lower its weight for the search engine.  And finally, representatives of almost all popular search engines in one way or another say that they directly take into account the speed of loading pages in the ranking formulas. <br><br>  <b>3. A slow site brings direct financial losses during ad campaigns.</b> <br><br>  You want to actively promote your project.  Order for him contextual, banner advertising.  Each click costs a certain amount of money.  If a visitor to your site came to you on an advertisement, but did not wait for the page to load, then you simply paid for his click. <br><br>  <b>4. Connecting CDN reduces the load on the main servers of the site.</b> <br><br>  Since all static content is loaded by visitors to your site not directly from your servers, but from CDN nodes that can cache content very effectively, the number of direct calls to your servers is reduced.  On average, for static content, the ratio of the number of requests to the site itself from CDN servers to the number of requests from live visitors to the site is 1:50. <br><br>  <b>And now - about the magic button for 70,000 sites ...</b> <br><br>  70,000 - just as many sites work on the <a href="http://www.1c-bitrix.ru/products/cms/">1C-Bitrix: Site Management</a> platform. <br><br>  A week ago <a href="http://www.1c-bitrix.ru/products/cms/">, the release of a new version 12.0 was announced</a> , which will be available to partners and customers in early November. <br><br>  One of the key novelties of the new version is the <a href="http://www.1c-bitrix.ru/products/cms/features/cdn.php">integration of the platform with CDN</a> , is available now. <br><br>  From a client‚Äôs point of view, everything looks as simple as possible: first you need to install a new module ‚ÄúBitrix Cloud Services‚Äù through the standard update system (yes, if you have a commercial license), and then in the administrative panel of the site in the ‚ÄúSettings‚Äù section - ‚ÄúBitrix Cloud Services "-" Site Acceleration (CDN) "tick" Enable site acceleration "and save the changes. <br><br><img src="https://habrastorage.org/storage2/a2a/709/1ee/a2a7091ee9f5d52934c9bec7a7925e09.png"><br><br>  Actually everything: after this, links to static site files (images, css style files, js scripts) will be replaced - instead of local URLs, the service names of the CDN servers will be used.  You do not need to make any changes to the DNS and do not have to worry about flushing the CDN cache when updating files. <br><br>  Directly for distribution of content, the network of the Russian CDN provider, <a href="http://cdnvideo.ru/">CDNvideo</a> , is used in the <a href="http://cdnvideo.ru/">future</a> , in partnership with which this service is implemented. <br><br><img src="https://habrastorage.org/storage2/e75/1c6/030/e751c6030e0c08a09b9e0e84c5288883.png"><br><br>  <b>How much is?</b> <br><br>  Not at all.  Zero. <br><br>  The Site Acceleration (CDN) module is a free additional option for any active commercial license for 1C-Bitrix: Site Management.  No additional charges other than the cost of the license itself or its renewal. <br><br>  For each individual license, the monthly traffic limits are determined, which can be transferred through CDN nodes to end users: <br><br><img src="https://habrastorage.org/storage2/9c6/eef/deb/9c6eefdebf03b2d80c591d282e6ad32c.png"><br><br>  <b>And now - the details: how it all works inside.</b> <br><br>  The scheme of the CDN when connecting one site looks like this: <br><br><img src="https://habrastorage.org/storage2/42f/516/440/42f5164403ea2eecfcd1ec43759e6389.png"><br><br>  Each appeal of any site visitor to static content is directed to the nearest CDN site.  During the first access, the necessary files are loaded from the source site or specifically for this dedicated node - the origin, and on subsequent calls they will be sent from the CDN server cache.  Placing content on many CDN servers and giving it to visitors from the point closest to it reduces the network data transfer route and makes the site loading faster from the user's point of view. <br><br>  All CDNs work on similar principles, and the source of the content, origin, must be one.  How to organize it at once for many sites? <br><br>  We organized a piece of our own cloud infrastructure (resilient and scalable): <br><br><img src="https://habrastorage.org/storage2/9cb/63f/bf8/9cb63fbf8d37b424faa32119a192da75.png"><br><br>  Our small ‚Äúcloud‚Äù in essence is such an origin for the CDN network, proxying the traffic of connected clients through itself and solving several important tasks: <br><br><ul><li>  In our cloud, we determine whether a site can use our CDN (check license activity, traffic quotas, etc.) </li><li>  We determine compliance of requests to this or that domain. </li><li>  We distribute requests to pictures, css, js across different domains (remember about parallelization, which was mentioned above). </li><li>  Carefully manage requests, if there is a disconnection (due to license inactivity or excess traffic) - change the links to redirects and wait until the replacement of links on the site itself is disabled.  That is, under no option does the site "break". </li><li>  Manage HTTP headers to ensure the most effective caching. </li></ul><br>  The Site Acceleration (CDN) module itself, working directly on the client site, does the following things: <br><br><ul><li>  Manages the replacement of links in the content. </li><li>  To each link adds a modifier in QUERY STRING of the form "/image.gif?1339164408" with the date of file modification.  If the file is changed, the modifier changes, and for the CDN cache, in effect, a new object appears.  Thus, we solve the problem of invalidation (reset) of the cache when files with the same names change. </li></ul><br><br>  <b>A small result.</b> <br><br>  A little more than a week ago, <a href="http://www.1c-bitrix.ru/products/cms/features/cdn.php">the Site Acceleration (CDN)</a> module became available to developers ‚Äî 1C-Bitrix partners.  Two days ago we opened public access to it for all customers. <br><br>  During this time about 600 sites were connected.  Mostly - online shopping.  As well as personal blogs, corporate sites, several large thematic portals. <br><br>  If your site works on ‚Äú1C-Bitrix: Site Management‚Äù - <a href="http://www.1c-bitrix.ru/products/cms/features/cdn.php">connect the CDN to it in a couple of clicks</a> , please yourself and your visitors with the speed of work.  :) </div><p>Source: <a href="https://habr.com/ru/post/156033/">https://habr.com/ru/post/156033/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../156017/index.html">We make YouTube online cinema</a></li>
<li><a href="../156023/index.html">Boston Dynamics's Pet-Proto Robot overcomes obstacles and keeps balance after a jump</a></li>
<li><a href="../156025/index.html">Github dating</a></li>
<li><a href="../156027/index.html">Robotic wheelchair capable of stepping on steps</a></li>
<li><a href="../156029/index.html">Domain pearls or the most stupid domains</a></li>
<li><a href="../156035/index.html">.Net-detective: about interfaces and reflection</a></li>
<li><a href="../156037/index.html">A bit about the interfaces in .Net (based on one interview)</a></li>
<li><a href="../156039/index.html">Battle City on unity in 1 day?</a></li>
<li><a href="../156045/index.html">Determining the dominant colors: Python and the k-means method</a></li>
<li><a href="../156047/index.html">The data center is the engine of energy efficiency in the world. But in Russia?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>