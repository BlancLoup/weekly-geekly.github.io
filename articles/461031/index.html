<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We connect online maps to the navigator on the smartphone. Part 1 - standard raster maps</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What are online cards like? How to find out the server address of the card you are interested in? How to create a settings file that allows the naviga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We connect online maps to the navigator on the smartphone. Part 1 - standard raster maps</h1><div class="post__text post__text-html js-mediator-article"><p>  What are online cards like?  How to find out the server address of the card you are interested in?  How to create a settings file that allows the navigator on the smartphone to connect to this map? </p><a name="habracut"></a><br><h3 id="soderzhanie">  Content: </h3><br><p>  1 - Introduction.  Standard raster maps <br>  2 - <a href="https://habr.com/ru/post/461053/">Continued.</a>  <a href="https://habr.com/ru/post/461053/">Writing a simple rasterizer for vector maps</a> <br>  3 - <a href="https://habr.com/ru/post/461073/">A special case.</a>  <a href="https://habr.com/ru/post/461073/">We connect the OverpassTurbo card</a> </p><br><h3 id="vstuplenie">  Introduction </h3><br><p>  Among the navigation applications for smartphones, there are those that are designed for tourism and all kinds of suburban activities.  Among the most famous of them are OsmAnd, Locus and GuruMaps.  All of them are distinguished by a large number of specialized functions that can come in handy along the way.  And also an even greater number of all kinds of (sometimes very confusing) settings.  But now we are most interested in one thing: the ability to add additional cards and quickly switch between them. </p><br><p>  I note that this is an extremely useful feature.  After all, one and the same area of ‚Äã‚Äãthe terrain can be very differently drawn on <a href="https://shuriktravel.ru/maps/">maps of different types</a> .  And therefore, before overcoming difficult areas, it is useful to be able to check with each of them.  However, if for this it was required to run several separate applications on a smartphone, this would be extremely inconvenient.  Performance worsens, and the battery is consumed faster.  So it‚Äôs very nice that there is the opportunity to get by with just one application: a sort of cartographic aggregator with a convenient interface, specially designed for quick switching between cards. </p><br><p>  So here.  As a rule, adding new cards is relatively simple.  The application folder has a subfolder with <strong>presets</strong> .  That is, with save files, in which the settings for downloading a particular card are indicated.  Let's see what they are. </p><br><p>  I note that for all applications, presets are more or less similar.  So, as an example, we will consider GuruMaps, because it is both for Android and iOS.  So, let's imagine that we went into the folder with its presets, found there a file called <em>openstreetmaps.ms</em> , and then opened it using a regular text editor. </p><br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">customMapSource</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>OpenStreetMaps<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">minZoom</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">minZoom</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maxZoom</span></span></span><span class="hljs-tag">&gt;</span></span>18<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maxZoom</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://{$serverpart}.tile.openstreetmap.org/{$z}/{$x}/{$y}.png<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serverParts</span></span></span><span class="hljs-tag">&gt;</span></span>ab c<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serverParts</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">customMapSource</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  In fact, we just have a list of several values.  Let's consider them in order: </p><br><p>  <strong>name</strong> - The name of the map that will be displayed in the application <br>  <strong>minZoom</strong> - From what zoom level will this map be displayed <br>  <strong>maxZoom</strong> - Up to what zoom level will this map show <br>  <strong>url</strong> - Template for accessing map files <br>  <strong>serverParts</strong> - If the server on which the map files are stored has several mirrors, then you need to list their names </p><br><p>  Before moving on, I note that for storage on servers, large cards are broken into small pieces.  Usually these are png images with a size of 256x256 pixels.  These fragments are called <strong>tiles</strong> . </p><br><p><img src="https://habrastorage.org/webt/f7/vd/gs/f7vdgskm8jqcztskwkp3eo-efgo.png"></p><br><p>  Now let's take a closer look at the url template. </p><br><p> <code>http://{$serverpart}.tile.openstreetmap.org /{$z}/{$x}/{$y}.png</code> </p> <br><p>  The navigator automatically replaces the words in braces with the ‚Äúcoordinates‚Äù of the map fragment that is currently required.  Here is what exactly will be substituted for the stubs: </p><br><p>  <strong>{$ serverpart}</strong> - One of the serverParts values ‚Äã‚Äãwill be substituted here. <br>  <strong>{$ z}</strong> - The zoom level for which you want to download a map fragment <br>  <strong>{$ x}</strong> - The horizontal number of the map fragment <br>  <strong>{$ y}</strong> - The number of the map fragment vertically </p><br><p>  After substituting the values, the navigator will receive a link, which then downloads the file with the required map fragment.  For example, this: </p><br><p> <code>http://a.tile.openstreetmap.org /12/2478/1265.png</code> </p> <br><p>  When the download is completed, the downloaded tile will be displayed on the smartphone screen. </p><br><h3 id="dobavlyaem-svoyu-kartu">  Add your card </h3><br><p>  So, let's say you found on the Internet a card that interested you and that you would really like to connect to your smartphone.  Let's try.  First, using a browser on your computer, go to the site with a window for viewing this map.  For example <a href="https://nakarte.me/">, this one</a> . </p><br><p><img src="https://habrastorage.org/webt/o9/7j/n4/o97jn4dv55rqiauzbul5nrixoci.png"></p><br><p>  Open the panel with the developer tools (Ctrl + Alt + I for Google Chrome) </p><br><p>  In the panel that opens, go to the Sources tab. </p><br><p>  We open all the folders in order until we find the folder with images of slices of the displayed map. </p><br><p>  Right click on the file name.  In the menu that opens, select Coly link address </p><br><p><img src="https://habrastorage.org/webt/o2/wy/jh/o2wyjhv9srqwqfq0789r-ggttws.png"></p><br><p>  For example, we came across such a link <br> <code>http://anygis.herokuapp.com/Combo_Best_Genshtab/1242/639/11</code> </p> <br><p>  You need to understand what exactly these numbers mean.  We check from our reference card - OpenStreetMaps. </p><br><p> <code>http://a.tile.openstreetmap.org/1242/639/11.png</code> </p> <br><p>  Is not downloading.  Let's try to swap the numbers. <br> <code>http://a.tile.openstreetmap.org/11/1242/639.png</code> </p> <br><p>  Loaded!  Now compare the tile obtained by the first and second links: </p><br><p><img src="https://habrastorage.org/webt/ad/gs/eb/adgseb703cdamjohxfosiuu8po4.png"></p><br><p>  We made sure that the tiles of both of these cards show the same place.  And, most importantly, no offsets.  So the map we found is made in a standard projection and it is suitable for connection. </p><br><p>  Well, and now, knowing in what order the coordinates of OpenStreetMaps went - <strong>z, x, y</strong> - we can confidently say in which they go in our map. </p><br><p> <code>http://anygis.herokuapp.com/Combo_Best_Genshtab/{$x}/{$y}/{$z}</code> </p> <br><p>  Now zoom in and out on the map in the viewport.  So we find out that the card is loaded only from the 0th and the 15th zoom. </p><br><p>  Further, if the url began with a single letter or number, then we could substitute other values ‚Äã‚Äãthere.  But usually there is either <strong>a, b, c</strong> or <strong>0,1,2,3</strong> . </p><br><p>  So, now we have figured out all the necessary parameters and can make a preset for our new map. </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">customMapSource</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>.   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">minZoom</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">minZoom</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maxZoom</span></span></span><span class="hljs-tag">&gt;</span></span>15<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maxZoom</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://anygis.herokuapp.com/Combo_Best_Genshtab/{$x}/{$y}/{$z}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">customMapSource</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  It remains to save the file under a new name and add it to your navigation application.  For iOS - just drag and drop the file into the application folder (via iTunes).  For Android - copy the file to the following directory: </p><br><p> <code>Android\data\com.bodunov.GalileoPro\files\Imported</code> </p> <br><p>  Now, when you open the navigator, what you have done appears in the map list.  Congratulations! </p><br><p><img src="https://habrastorage.org/webt/ei/qp/qf/eiqpqfzt3mntr2p9g68ewvhnf04.png"></p><br><p>  As you can see, it was pretty simple.  And best of all, the whole process is more or less similar for all of the above navigators.  Fast, universal, cross-platform. </p><br><p>  Of course, there are cards in non-standard projections.  Or with non-standard numbering.  <a href="https://nnngrach.github.io/AnyGIS_maps/Web/Html/Description_ru">In this article,</a> I described how to solve this problem.  Nevertheless, the vast majority of cards that are found on the Internet are connected easily and without additional troubles. </p><br><p>  By the way, on my <a href="https://nnngrach.github.io/AnyGIS_maps/Web/Html/DownloadPage_ru">AnyGIS</a> website you can download ready-made presets.  They are automatically generated in the formats of all of the above navigators based on the database I collected.  And periodically updated.  So, if necessary, download and use. </p><br><p>  Well, that's over with the introduction.  <a href="https://habr.com/ru/post/461053/">In the next article</a> I will tell you how to connect vector online maps. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/461031/">https://habr.com/ru/post/461031/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461017/index.html">New GPU Tracking Algorithm: Wavefront Path Tracing</a></li>
<li><a href="../461019/index.html">How is life for developers in Iran</a></li>
<li><a href="../461021/index.html">Comet Lake - picture is clearing up</a></li>
<li><a href="../461027/index.html">Java REPL you do not ScriptEngine</a></li>
<li><a href="../461029/index.html">A lake of marketing data - from monstrous tables to reports and visualizations</a></li>
<li><a href="../461033/index.html">Where does this config come from? [Debian / Ubuntu]</a></li>
<li><a href="../461035/index.html">Instructive episodes from the series Silicon Valley (Season 1)</a></li>
<li><a href="../461037/index.html">And here I am ‚Äúreal‚Äù</a></li>
<li><a href="../461039/index.html">The book ‚ÄúPerfect Algorithm. Graph Algorithms and Data Structures "</a></li>
<li><a href="../461041/index.html">Rounded or acute-angled?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>