<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we made a highload ++ game with voxel graphics and VR</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In fact, this is a lightweight technical longrid, we hope that after reading you will have an additional interest in making some kind of game, or at l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we made a highload ++ game with voxel graphics and VR</h1><div class="post__text post__text-html js-mediator-article">  In fact, this is a lightweight technical longrid, we hope that after reading you will have an additional interest in making some kind of game, or at least you will learn how it works. <br><br><img src="https://habrastorage.org/webt/pp/aw/li/ppawlioqok-5daxbbmr3ypukt3a.jpeg"><br><br>  <b>About Speaker:</b> Alexander Khayorov ( <a href="https://habr.com/users/allexx/">@allexx</a> ) leads the development department at <a href="https://habr.com/company/odin_ingram_micro/">Ingram Micro Cloud</a> .  The guys in the team of Alexander consider themselves not just excellent engineers, but call themselves a great team of voxel Jedi, optimization masters, 3D gurus and masters of big data!  [note: similar to job titles on LinkedIn and Medium] 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This cool team, preparing for a speech at <a href="http://www.highload.ru/">Highload ++</a> 2017, decided to entertain the audience and make something new and interesting for the stand.  Therefore, they gash the game, the creation of which will be discussed further. <br><br><blockquote>  Hostess note: from the organizers, we very much welcome the efforts to prepare for participation in the conference.  They pay for themselves many times, attracting participants, and, as it turns out, benefit the team. <br></blockquote><br>  So let's go! <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/0GD78vKTdg0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br>  Often, when sorting out mail, I look through the headlines of informational tapes, where a variety of news flashes.  Once I saw the headline "Who are indie developers."  For some reason he hooked me, and I decided to read this article.  I opened it - there were a lot of numbers, letters and statistics. <br><br><blockquote>  <strong>Reference:</strong> Indie developers are people who create games without a special budget and without the financial support of computer game publishers. <br></blockquote><br>  As a rule, indie developers are not burdened with the framework of the script and templates, so they get quite interesting games, movies, and so on. <br><br>  In this article, I learned a few funny facts: <br><br><ul><li>  97% of mythical indie developers are men; <br></li><li>  60% of them are not, not singles, but they make games alone; <br></li><li>  On average, it takes 1 to 3 months to make an indie game. <br></li></ul><br><br><img src="https://habrastorage.org/webt/_p/yj/79/_pyj79yk_22gfxm0vsvy-wura50.jpeg"><br><br>  It so happened that we also started to make the game. <br><br><h2>  <strong>Why we started making the game</strong> <br></h2><br>  I always liked the games from the Reddit service.  I think that you have spent more than one month on this resource. <br><br><h3>  A social experiment by Reddit <br></h3><br>  Every year Reddit conducts a social experiment, as they call it.  Although in reality these are different games for the community.  In 2017, a social experiment took place, as always, at the beginning of April (on fool's day). <br><br><img src="https://habrastorage.org/webt/pd/ee/-c/pdee-cguhxp2cv9qevgiqfggbhk.jpeg"><br><br>  The essence of the game was promising.  The developers of Reddit created a picture of 1,000 x 1,000 pixels.  Each registered user on Reddit, and there are several million of them, was asked to paint over 1 pixel of this canvas with one color from a fairly wide palette. <br><br>  The event lasted 72 hours, and each participant every 5 minutes could draw only one point on the screen.  People created different pictures, fought among themselves, repainting pixels.  Some countries and communities united and collaborated. <br><br>  In the end, it turned out an interesting panel, from which someone then made a puzzle, someone tied socks with such an ornament, etc. <br><br>  I really liked the idea that you can <strong>engage people in massive online games</strong> , even with a simple gameplay.  This was probably the main inspiration for us to create an online game.  In general, I believe that the games are full of fun and I am sure that you sometimes play different games and this brings you pleasure. <br><br>  But for the techie, the most interesting thing was inside, since the game attracted a huge number of people - more than a million registered unique users participated in it - up to 90 thousand people at the same time painted over pixels every second! <br><br>  Professionally, I develop web services and various M2M services when a server communicates with servers.  This is actually very important and responsible, but sometimes a little boring.  Therefore, the <strong>new developer experience is always interesting</strong> .  I'll share it with you right now. <br><br>  Looking ahead, I will say that we really learned a lot of new and interesting about the game, without having any experience from the beginning. <br><br><h2>  The game <br></h2><br><h3>  Features <br></h3><br>  We got together with the guys and sketched out a skeleton of ideas about what to make the game.  At first we decided to go with trumps and write cool features. <br><br><ul><li>  Definitely wanted to make a <strong>multiplayer</strong> . </li></ul><br>  We decided that the game would be <strong>networked</strong> , and even massive, and not in split-screen format. <br><br><ul><li>  We chose 3D graphics. </li></ul><br>  Although it would probably be easier to make 2D without experience, the team wanted volume. <br><br><ul><li>  We decided to take the HYIP technology - let it be <strong>Virtual Reality</strong> . </li></ul><br>  We understood that without overvalued technology, it was impossible to make a successful game. <br><br>  This is how we formed the Features set, but without a certain gameplay. <br><br><h3>  Concessions <br></h3><br>  But, after thinking about a week, we decided that we needed to somehow limit our Wishlist and made small compromises. <br><br><img src="https://habrastorage.org/webt/da/vy/xb/davyxb-vkzcbl7eilhmdsvsneuc.jpeg"><br><br><ul><li>  We really did not want to write a separate client, and we decided that the game would be <strong>browser-based</strong> , especially since we heard that modern browsers have become very powerful and allow you to make 3D graphics. </li><li>  The second important factor was that we, as engineers, of course, <strong>strive for beauty</strong> , but we have a mediocre attitude to graphics.  Therefore, the idea of ‚Äã‚Äãusing small <strong>voxels</strong> or blocks in order to create the whole world and construction seemed to us to be a kind of panacea. </li><li>  Finally, we decided that the world would not be infinite (although I am sure that the universe is infinite) and limited ourselves to 1000 √ó 1000 √ó 200 voxels, thereby simplifying the technical features of the game a little. </li></ul><br><blockquote>  <strong>Reference:</strong> Voxel is almost a pixel, but in a 3-dimensional world.  For example, in Minecraft, the world is represented by voxels. <br></blockquote><br><br><img src="https://habrastorage.org/webt/hw/-0/lq/hw-0lq5xyz9cqal_qkoc_2--fyo.jpeg"><br><br>  On this we parted for some time and later decided to talk only on the matter, in particular, to discuss the gameplay and rules. <br><br><h3>  Gameplay and rules <br></h3><br>  It seems that the gameplay is a very simple thing!  We know how to play StarCraft, Doom or Quack.  But when you create your game, you have a lot of ideas.  These thoughts are scattered in different directions and it is very difficult (especially in a team) to agree on how the game will look and what will happen in it. <br><br>  This process was not linear, we could not immediately determine everything.  The final version of our rules looks quite simple: <br><br><ul><li>  We need to find a spot - a kind of building - which is why the game is called Urban (City). </li><li>  On the spot there is a flag to be captured, points are awarded for this. </li><li>  The participant with the most points gets a prize. </li><li> Players can freely move around the common world and retake flags (a variation of "capture the flag"). </li></ul><br><br><img src="https://habrastorage.org/webt/ol/dy/w1/oldyw1ulqnoddgqkvtxcu2xyigk.jpeg"><br><br>  On this we decided on all the managerial functions and decided to take up architecture. <br><br><h2>  <strong>Architecture</strong> <br></h2><br>  Since we are creating enterprise products, we decided to start with the enterprise architecture of our game.  We thought that it should definitely be: <br><br><ol><li>  <strong>The players</strong> . </li><li>  Special <strong>stand</strong> for playing in a virtual reality helmet. </li><li>  <strong>Browser</strong> , as we decided it would be a browser game.  People will go there and receive data from there. </li><li>  Some <strong>kind of</strong> " <strong>storage</strong> " - because we have a multiplayer game on the network, we need to store data about different players somewhere. </li></ol><br>  It was the original, rather naive architecture diagram. <br><br><img src="https://habrastorage.org/webt/qg/bl/go/qgblgomt9amvdcipn2qcrhsmd8s.jpeg"><br><br><h3>  The problem of replication in distributed systems <br></h3><br>  How should the "store" communicate with the browser where the game works?  Here the interesting moments begin, and I would like to take you to a more familiar area. <br><br>  In general, the problem of replication in distributed systems has been well studied.  Replications are used daily in our industry.  But any game, especially online, is an atypical situation of replications when it is necessary to provide replication only for the game to happen.  If you do not have replication and coherence in the distributed system, consistency between players, then the game can be terminated because it is impossible to play it. <br><br><img src="https://habrastorage.org/webt/lx/-r/lv/lx-rlvms-5m0rdp-i2261zru2g0.jpeg"><br><br>  There are two types of replications: <br><br><ol><li>  <strong>Active replication</strong> , when data is taken directly from one client and transmitted to all other players, for example, information is sent that a player has captured the flag.  Other clients receive exactly the same animation, the same events, etc. </li><li>  <strong>Passive replication</strong> , in this case, the player sends information to a server, and already this server provides data transfer to all other players. </li></ol><br>  Let's try to figure out what the salt is, what is better, what is worse, and if there is any difference between active and passive replication. <br><br><h4>  Pros and cons of active replication: <br></h4><br>  + In active replication, everything is <strong>simple and intuitive</strong> : we take the data, send it to all other players, receive information from all other players. <br><br>  + The second important point - this system is quite <strong>effective</strong> .  Indeed, you do not need any additional device in the form of a server that will receive, process and transmit data to other players. <br><br>  - But there is a huge minus - systems built on active replication are very <strong>fragile</strong> .  The appearance of network problems, for example, losses, delays or difficulties with clients, is enough; a completely inconsistent system is obtained.  Synchronization breaks, and our task is to have the same common world. <br><br>  In fact, getting out of a situation with a broken sync is quite difficult.  There are various protocols for this, for example, Paxos, but all of them imperceptibly complicate the simple scheme of active replication, they require time and computational resources. <br><br>  For example, I can say that the classic StarCraft game is built on active replication.  This is one of the clear examples of using a simple but fragile model.  That is why, when certain problems appear in synchronization, the game usually has to be completed and restarted. <br><br><h4>  Pros and cons of passive replication: <br></h4><br>  + Unlike active, passive replication is very <strong>resistant to desynchronization</strong> .  If something goes wrong, there is a special device - a server that can bring the system back to normal. <br><br>  The second point, and often very undervalued and important, is the <strong>safety of</strong> games.  Recently there was a game <strong>VKpixel Battle</strong> - a direct analogue of the game Place from Reddit, in which it was also possible to paint a board.  This game was hacked in a few hours ( <a href="https://tjournal.ru/60476-kak-polzovateli-tj-vzlomali-igru-pikseli-k-11-letiyu-vkontakte">source</a> ).  In the passive model, the security of the game is noticeably easier to provide for the reason that, again, there is a server where you can control a lot. <br><br>  - But there are no pros without cons.  With the advent of the server - a device that receives and sends data, a classic <strong>point of failure</strong> occurs.  If you do not use special tools, such as sharding, division into nodes, you can lose the whole game by crashing the server. <br><br>  We did not think long, and, like the developers of all modern games, chose a passive replication method.  In fact, now the vast majority of games (about 99%) use passive replication.  Therefore, our powerful enterprise architecture has another component - the game-backend, which takes on the task of synchronization. <br><br><img src="https://habrastorage.org/webt/-z/fi/z_/-zfiz_z_mhesgqynda8vpuwhdto.jpeg"><br><br><h3>  Data structure <br></h3><br>  Let's talk a little about the storage system.  The fact is that the choice of storage we treated, so to speak, without proper attention, as is customary in some circles. <br><br>  In order to understand where to store data, you need to know how to present them.  This is probably the most important question that determines certain criteria.  Consider the data structure that is possible in our game. <br><br><img src="https://habrastorage.org/webt/5j/lg/_t/5jlg_tew92iydl9o9ifb4mstppo.jpeg"><br><br>  It has a lot of voxels and a limited world.  You can take all the information about the cubes (voxels) and store them in a regular linear large array.  This is a very simple and straightforward way.  Its main advantage is constant writing and reading in a cell.  We can safely get information about the voxel, and this will require some constant time. <br><br>  In fact, a lot of modern games, including Minecraft, started with such a model, and it proved to be quite successful. <br><br>  The downside is the <strong>high memory consumption</strong> .  The fact is that our world is growing in three dimensions, so the amount of memory required to store this data increases nonlinearly. <br><br>  This problem can be solved, for example, with the help of <strong>octree trees</strong> .  We will not go into what it is, I suggest for understanding just to look at the picture. <br><br><img src="https://habrastorage.org/webt/w6/tm/t7/w6tmt7vmqxwrbfwo136f3ajup4m.jpeg"><br><br>  If the 3-dimensional world is represented in the form of a large cube, then it can be divided into 8 parts - octas.  Each of them can also be divided into 8 sections.  This mechanism saves a lot of storage structure due to areas in which data is missing. <br><br>  There is a clear advantage here - this is a more <strong>profitable structure in terms of storage</strong> .  The minus is initially not so obvious, but quickly gets out in practice.  The point is that you need to use different caches.  As a rule, everyone who uses octree complains that it works much slower than regular arrays. <br><br><img src="https://habrastorage.org/webt/jb/m3/cd/jbm3cd2dxizl31ysvul_tp23eh4.jpeg"><br><br>  Finally, there is a third option, I would call it a compromise - you can take an ordinary linear array and divide it into some uniform areas (chunks).  This gives certain advantages.  For example, unlike a regular array, you can load individual blocks.  We do not need to download the whole world of one user.  We can load only blocks coming from it. <br><br>  But there is a certain minus - it certainly <strong>complicates the whole model of a regular array</strong> , because you need to store references to chunks, operate chunks, add logic to the front-end of the game, etc. <br><br>  We decided that the last option was optimal for our game and we chose it.  After that, the choice of storage for us went unnoticed: we decided - let it be <strong>MongoDB</strong> .  Now I would not want to breed holivar on this topic - I am sure that this can also be implemented on many other excellent databases.  However, we had little experience with this base and therefore decided to dwell on it for experiments. <br><br><h3>  Front End / Backend Interaction Protocol <br></h3><br>  We have a certain structure, there are clients, probably, some browser will appear in which all this will be displayed.  But how to transfer data between storage and game?  It's time to think about the protocol. <br><br>  As we already know, our world is represented as a parallelepiped with a base of 1000 √ó 1000 and a height of 200. You can ignore the height and always use the maximum height in the unloading.  This greatly simplifies the creation of the game. <br><br>  In turn, each square, according to our standard, we broke into 32 √ó 32 voxels inside the chunks. <br><br>  As I said, we decided to use MongoDB.  The voxels are stored in it quite simply, for this we use ordinary documents.  Inside the document looks like, as we slide below: <br><br><ul><li>  service id field </li><li>  coordinates, </li><li>  the name of the player's color, </li><li>  some service name, </li><li>  the date when this block appeared. </li></ul><br><img src="https://habrastorage.org/webt/kp/ga/no/kpganorelwuoqhlzdjdachtoapu.jpeg"><br><br>  Now we have at least two tasks.  For example, we direct the player.  He is born in the world at some point. <br><br><ol><li>  <strong>We determine the nearest chunks</strong> that a player can see, and form a radius.  Actually it is not absolutely correct name.  We form an understanding of the distance and see how many chunks it affects.  Next, we make a get request to the database, in which we speak the current coordinate of the player and this radius. </li><li>  <strong>Create a set</strong> - block or cube on the map.  Here you simply send the coordinates of the cube that you want to install. </li></ol><br>  These are direct requests to our repository. <br><br>  In the opposite direction, you can observe requests for updating other cubes. <br><br><img src="https://habrastorage.org/webt/vq/tp/de/vqtpdet01mnbh946crh4mkjcphk.jpeg"><br><br>  In this case, the point is that, being in the world and having received some of its original state, we want to observe new cubes that other users create.  To do this, we subscribe to events and get updated messages about all the dice that appear in the game. <br><br>  Finally, we wanted to add a bit of interactivity to the game, and therefore added a special message about user activity - when someone entered the game, or went out, or intercepted a flag that allows you to get points. <br><br>  So we have formed an interaction protocol. <br><br>  We had a small choice of how we can communicate between the backend and the front end: HTTP, WebSocket, HTTP2.  We decided to stop at <strong>WebSocket</strong> for obvious reasons - in order to intuitively reduce the potential delays that were possible. <br><br>  We also thought that it would be nice to get the results of the game - for example, to see who entered the game, what were his points.  To do this, we made a separate ‚Äúview‚Äù, which we screwed to the frontend and decided to use HTTP for it, so as not to authorize it and not complicate this process. <br><br>  So we have formed a certain stack in architecture.  The key point of interaction in it was WebSocket. <br><br><h3>  Game backend <br></h3><br>  Backend, at a minimum, can be called the heart of our system. <br><br><img src="https://habrastorage.org/webt/a_/ji/-2/a_ji-2w8k7bpoohdbvhqvbmcq18.jpeg"><br><br><ul><li>  Since we have some experience in web development, we decided not to use new technologies, unknown for us.  We settled on <strong>Python 3.6 and aiohttp</strong> .  That is, we have a fully asynchronous server. </li><li>  We added a modified loop to it - this is <strong>uvloop</strong> , which allows you to work even faster. </li><li>  Since we are using MongoDB, we needed some kind of asynchronous client.  For this we used <strong>motor</strong> , which perfectly allows us to communicate with MongoDB in asynchronous mode. </li><li>  Finally, in order to expose our server to the outside, we used <strong>gunicorn</strong> , which develops in Python. </li></ul><br>  So we have a completely traditional stack that allows <br>  exchange data over our designated protocol. <br><br><h3>  Game-frontend <br></h3><br>  This is the highlight of our game - the way the game begins to live and exist. <br><br>  First of all, we have a question - how can we write a game engine, how to make games and how it all works.  After a brief study of the material, we realized that there is a library <strong>WebGL</strong> , which allows a lot.  It works with the OpenGL library, which already in turn works with hardware, with drivers, with a video card, etc. <br><br>  Therefore, the first thought was to use the usual native JavaScript, see which API provides WebGL and start making the game.  We quickly dismissed this idea, because from our experience in web development we understood that <strong>developing a web server itself is a very strange and long undertaking</strong> .  Moreover, we did not have so much time. <br><br>  After a brief search, we found a JS library called <strong>Voxel.js</strong> .  In fact, it became the Grail for us, because it represents a lot of tools. <br><br><img src="https://habrastorage.org/webt/bq/e5/mp/bqe5mptgjyv5eghcp1uaxxu8wjs.jpeg"><br><br>  The library has existed for more than 3 years, and, as the author claims, in fact, is a tool-kit for creating modern browser games, and voxel games.  It contains everything that is needed. <br><br><ul><li>  <strong>The concept of a world</strong> in which there are axes and coordinates; </li><li>  <strong>Work with blocks</strong> (voxels) that understand the concept of chunks; </li><li>  Video game creation tools: <br><ul><li>  bounding polyhedra in order to understand collisions, being near, working with objects, etc .; </li><li>  ray casting is a method that allows you to create a 2D view on a monitor from 3D objects; </li><li>  textures. </li></ul></li><li>  Most importantly, there is the <strong>concept of the player and his management</strong> .  In fact, we got almost finished game! </li><li>  All necessary <strong>events</strong> - the cycle of creation of the world, the cycle of installation of the block, etc.  All of them can subscribe and produce their actions. </li></ul><br><h5>  What does the whole stack look like <br></h5><br><ul><li>  We write our code using the Voxel.js library - this is our special logic. </li><li>  In turn, Voxel.js communicates with the library called three.js.  I will dwell on it a little bit, because it is the cornerstone and important stone in this whole scheme. </li><li>  Next, three.js already communicates with WebGL, which is actually built into the browser (uses its API). </li><li>  WebGL already works with this equipment - with the OpenGL driver, which draws a picture on the monitor. </li></ul><br><img src="https://habrastorage.org/webt/92/6a/s3/926as3dcr53tpvf7q_r0xlhplqs.jpeg"><br><br>  In fact, it is not so easy to create a scene using three.js, and in particular with Voxel.js, which it uses.  Although it seems there is nothing complicated at all. <br><br>  Let's look at the code, but we will not be afraid in advance. <br><br><img src="https://habrastorage.org/webt/pp/e3/np/ppe3npiccqtklju2tzxs0ggbhto.jpeg"><br><br>  To create a cool 3D image in the browser, you really need only 3-4 things: <br><br><ol><li>  First of all, we need a <strong>stage</strong> , as in the ordinary world. </li><li>  In this scene there must be a <strong>camera</strong> - we create a camera object, in which we designate the dimensions and the maximum / minimum distance that we see. </li><li>  After that, we need a device that will render - to create for the camera on stage what we want to see.  To do this, we create a <strong>render</strong> .  In this case, just used WebGL technology, and our video card will work to create the world. </li></ol><br>  In principle, we have everything to make the game work.  The only thing missing some objects. <br><br>  4. In order to create an object, we need: <br><br><ul><li>  Geometry (geometry) is how an object will look in space.  For example, if it is a cube, then it must have vertices and faces. </li><li>  Material - in order to color the object.  The easiest option is to use color shading. </li></ul><br>  Combining the geometry and material, we get the so-called mesh (or some kind of mesh object). <br><br>  Next, the simple <strong>animate</strong> function is <strong>called</strong> .  Like setInterval in the browser, each time it draws a new frame and it turns out animation.  In fact, this mechanism is used in ordinary 3D games and is available in the browser. <br><br><h2>  The virtual reality <br></h2><br>  I would like to talk a little bit about VR.  As I said before, we wanted to use HYIP technology to get attention.  We decided to use VR.  It was a random, spontaneous choice, but after studying the topic, we realized that VR is not a very new and not very high technology.  This picture is dated the beginning of the XX century - this is VR, but the XX century! <br><br><img src="https://habrastorage.org/webt/mr/kv/sk/mrkvskqlsy-ceufib3dwnirwozk.jpeg"><br><br>  You just need to use this helmet to view real 3D objects - the only thing that is static. <br><br><img src="https://habrastorage.org/webt/dg/c_/-q/dgc_-qmt3dxd2jps8mppmx2psqs.jpeg"><br><br><h3>  Oculus rift <br></h3><br>  We decided not to use a static image, but still create graphics with video.  Therefore, our choice fell on the <strong>Oculus Rift</strong> . <br><br><img src="https://habrastorage.org/webt/dk/hk/cf/dkhkcfhvl2dow6tgqnbnxzv0fre.jpeg"><br><br>  Again, the choice was quite intuitive and spontaneous.  There is nothing special about it, the Oculus Rift has at least 3 basic devices: <br><br><ol><li>  helmet; </li><li>  a special device in order to understand the tracking, that is, the movement of the head, which is auxiliary (left); </li><li>  the controller is a source of commands that can be represented by different <br>  devices. </li></ol><br>  None of us has dealt with VR technology and Oculus helmet before. <br><br><img src="https://habrastorage.org/webt/u_/vt/ux/u_vtuxx3yw69s0dxxzexwa7oghc.jpeg"><br><br>  Pros: <br><br>  + This is really a VR-picture - it is quite real and allows us to deceive our brain and imagine that we are in a 3D world. <br><br>  + A good screen resolution and a very decent picture update speed.  I personally did not observe any noticeable deterioration of my state of health while viewing the picture, unlike the first old virtual reality helmets. <br><br>  + This is really a very convenient device, well-made, which is perfectly in the hand and fits perfectly on the head.  We can say that this is really a consumer device. <br><br>  Minuses: <br><br>  - I imagined VR so that you can just put on a helmet, devices and it will be cool!  In fact, this is a huge number of wires.  In fact, each device requires a cable, or even two. <br><br>  - The second important moment for me and slight disappointment - I expected that I would take my usual laptop and be able to program while sitting on the sofa.  It turned out that there are serious limitations: you can only use Windows, Oculus and the SDK is not available for macOS / Linux.  Perhaps this is a company's strategy or a feature of the operating system - it's hard for me to say. <br><br>  - I could not even start a simple video or a game in VR without connecting a decent enough video card.  I am not an ardent gamer of modern 3D games, so I had to look for it in order to start developing. <br><br>  I think that if you are not hampered by these drawbacks, then you can safely try modern virtual reality helmets. <br><br><h2>  How to make games for VR <br></h2><br>  For us, this topic was completely closed and incomprehensible.  We thought we needed special magic, perhaps devices or a degree.  Not really. <br><br><h3>  A-Frame <br></h3><br>  Now there are not so many tools that allow to make VR games also in the browser. <br><br><img src="https://habrastorage.org/webt/lm/zj/co/lmzjco3jnahyvhd1ylldplri3mw.jpeg"><br><br>  Probably the first thing that can be found on the Internet is the A-Frame framework.             . <br><br>  ,      ,  Oculus Rift,     .      ,   ,     . <br><br> , ,   ,     web-,     ,       HTML.     ,     ‚Äî         ,    3D VR-  . <br><br>     ,   html-.        ,       . <br><br>  ,     .      ,    .      ,       .             3D-    ..    ,   . <br><br>       VR. <br><br>   ‚Äî    VR? VR         .     .        .     ,  VR-.    ,         ,    . <strong>    .</strong> <br><br>   ,     .            .     . <br><br><img src="https://habrastorage.org/webt/3n/5q/-o/3n5q-os4lb-jokpb0czhq3crr1i.jpeg"><br><br>    enterprise-,    ,      : <br><br><ol><li>       Voxel.js. </li><li>  ‚Äî    A-Frame. </li></ol><br> ,      ,      <br> ,   .     Firebase,       . <br><br><h2>  Optimization <br></h2><br>       . <br><br><img src="https://habrastorage.org/webt/ho/w7/sh/how7shxr_xyzj1leolrjsdc_cmc.jpeg"><br><br>    ,     ,       .    ,       . <br><br> <strong>1. Pre-process voxel models</strong> <br><br>    ,     ,          PowerPoint.  ,  ,   ,      . <br><br>    ,         ,     . ,     : ¬´     ,        ?       !¬ª <br><br>     ,      ,      , ,   .        ‚Äî   78%     . <br><br> <strong>2. User Mesher</strong> <br><br>       mesher.   , ,     ,          .    ,    Minecraft   ,   -. <br><br>     ,             ( Mesh).      mesher. <strong>   </strong> ,     , , .  ,  , ,    - ,    ,    . <br><br> ,    mesher   .  c Voxel.js     FPC .  A-Frame  ,    mesher  . <br><br> <strong>3. Enable compression for WebSocket (RFC 7692)</strong> <br><br> ,    web-. WebSocket ‚Äî  ,           ,     . <br><br>       (   JSON)    .        .      ‚Äî      ? <br><br>     WebSocket,    HTTP.   , ,       ,    <strong>RFC</strong> ,  ,      WebSocket. <br><br>    ,     .              ‚Äî  <strong> 5</strong> <strong>MB</strong> <strong>   1,8</strong> <strong>MB</strong> . <br><br> ,    ‚Äî ,  Chrome, Firefox, Safari ‚Äî     .          ,     . <br><br>     ,           ,      .     ‚Äî ,  ,   ,  ,  ,     . <br><br>     ‚Äî <strong>  -      !</strong>     ,    ,       . <br><br>   ,    <a href="https://github.com/theURBN"> </a> ,    .   ,    ,             ,      ‚Äî  VR    . <br><br><blockquote> ,  <a href="http://ritfest.ru/moscow/2018">++</a> 2018      Pipes ‚Äî  <a href="https://habr.com/company/odin_ingram_micro/blog/358862/">CloudPipes</a> . <br><br>     ,   ,  , ‚Äî  ! <br><br> <a href="http://ritfest.ru/moscow/2018/schedule.html"></a>   , ,   ¬´?  Where? ?¬ª ,        <a href="https://conf.ontico.ru/conference/join/rit2018.html"></a> . <br><br>     <a href="http://www.highload.ru/siberia/">Highload++ Siberia</a> ,     . <br></blockquote></div><p>Source: <a href="https://habr.com/ru/post/359130/">https://habr.com/ru/post/359130/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../359116/index.html">Reverse engineering of the device firmware on the example of a flashing "rhino". Part 1</a></li>
<li><a href="../359118/index.html">It's time to grow up for IT communities: why do we gather activists at RHS?</a></li>
<li><a href="../359120/index.html">Experiments with kube-proxy and node unavailability in Kubernetes</a></li>
<li><a href="../359122/index.html">A bunch of different ways to read bits</a></li>
<li><a href="../359124/index.html">TOTAL 3 months: Alternative to paid shutdown of advertising in the free Android application</a></li>
<li><a href="../359132/index.html">Go 1.11: AVX-512 with Go</a></li>
<li><a href="../359134/index.html">How to write a decentralized multiblockchein exchange in a day</a></li>
<li><a href="../359136/index.html">Machine learning and a polypropylene extruder: history 3 places on the hakatone Sibur</a></li>
<li><a href="../359142/index.html">Internet ombudsman invited the Prosecutor General‚Äôs Office to check Roskomnadzor, millions of Amazon addresses are still blocked</a></li>
<li><a href="../359144/index.html">The insides of the SDR chip AD9361 - when microelectronics is more profitable than drug trafficking</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>