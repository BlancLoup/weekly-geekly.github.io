<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Useful hacks and snippets for .htaccess</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This translation is a very interesting article for me personally, which I want to share with a respected associate. I have already met some of these r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Useful hacks and snippets for .htaccess</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/e3f/480/857/e3f480857115b57c2c5cbdd14f00b669.jpg"><br><br>  This translation is a very interesting <a href="http://speckyboy.com/2013/01/08/useful-htaccess-snippets-and-hacks/">article</a> for me personally, which I want to share with a respected associate.  I have already met some of these recipes on Habr√©, but not all of the following are fragmented and far from it. <br><br>  Every web developer knows about the purpose of the .htaccess file.  At a basic level, it allows you to control access to site directories.  But by adding various additional code fragments to it, many other interesting things can be done with it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you need basic information about the purpose of this file, then you can get an <a href="http://speckyboy.com/2012/07/26/what-is-htaccess/">introduction to .htaccess</a> from our article ( <i>I did not do the translation of this article, as there are basics, there are enough of them in the Russian segment of the Network, but if you are interested, you can to translate it to complete the picture - a comment of the translator</i> ), in which all aspects of its application are described in sufficient detail. <br><a name="habracut"></a><br>  So, useful examples of use.  htaccess: <br><br><h5>  1. Managing access to files and directories </h5><br>  Password protection is one thing, but sometimes it may be necessary to completely block user access to a particular file or folder.  This usually refers to system folders, such as includes, for example, which applications should have access to, but not users. <br><br>  To do this, put this code in a file.  htaccess and save it in the directory to which you are blocking access: <br><br><pre><code class="bash hljs">deny from all</code> </pre> <br>  However, keep in mind that access will be blocked for all users, including you.  You can open access for a specific user by registering his IP address.  Here is the code you need for this: <br><br><pre> <code class="bash hljs">order deny,allow deny from all allow from xxx.xxx.xxx.xxx</code> </pre><br>  where xxx.  xxx.  xxx.  xxx is your IP.  You can replace the last three digits to set the allowed IP address ranges.  For example, writing ‚Äú0/12‚Äù instead of them will set the range of IP addresses of one network, which will save you from having to enter all allowed IP addresses into the list separately. <br><br>  If you want to block access to a specific file, including itself.  htaccess, use the following code snippet: <br><br><pre> <code class="bash hljs">&lt;Files .htaccess&gt; order allow,deny deny from all &lt;/Files&gt;</code> </pre><br>  If you want to specify certain IP addresses that need to be denied access, list them with allow from. <br><br>  If you want to block access to files of a certain type, use this code: <br><br><pre> <code class="bash hljs">&lt;FilesMatch <span class="hljs-string"><span class="hljs-string">".(htaccess|htpasswd|ini|phps|fla|psd|log|sh)$"</span></span>&gt; Order Allow,Deny Deny from all &lt;/FilesMatch&gt;</code> </pre><br><h5>  2. Ban on directory browsing </h5><br>  To prevent viewing the site directories, add the following code to .htaccess: <br><br><pre> <code class="bash hljs">Options All -Indexes</code> </pre><br>  If for some reason you want to allow viewing of all directories, use the code: <br><br><pre> <code class="bash hljs">Options All +Indexes</code> </pre><br><h5>  3. Accelerate download time by compressing files </h5><br>  You can compress files of any type.  For example, to compress HTML files, add the code: <br><br><pre> <code class="bash hljs">AddOutputFilterByType DEFLATE text/html</code> </pre><br>  To compress text files, use: <br><br><pre> <code class="bash hljs">AddOutputFilterByType DEFLATE text/plain</code> </pre><br>  You can also compress JavaScript or enable compression for other different file types with the commands: <br><br><pre> <code class="bash hljs">AddOutputFilterByType DEFLATE application/javascript AddOutputFilterByType DEFLATE application/rss+xml</code> </pre><br>  In addition, you can compress all your javascript, html and css files with gzip.  To do this, use the following code: <br><br><pre> <code class="bash hljs">&lt;IfModule mod_gzip.c&gt; mod_gzip_on Yes mod_gzip_dechunk Yes mod_gzip_item_include file \.(html?|txt|css|js|php|pl)$ mod_gzip_item_include handler ^cgi-script$ mod_gzip_item_include mime ^text\.* mod_gzip_item_include mime ^application/x-javascript.* mod_gzip_item_exclude mime ^image\.* mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.* &lt;/IfModule&gt;</code> </pre><br><h5>  4. Protecting the site from inserting images from other resources </h5><br>  If you want to prohibit adding links to images from third-party resources, add the code to the .htaccess file: <br><br><pre> <code class="bash hljs">RewriteEngine on RewriteCond %{HTTP_REFERER} !^$ RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?yourdomain.com [NC] RewriteRule \.(jpg|jpeg|png|gif)$ - [NC,F,L]</code> </pre><br>  Remember to replace yourdomain.com with your domain name. <br><br><h5>  5. Blocking visitors referred from a specific domain </h5><br>  If you do not want to see users from a specific domain on your site, then you can deny them access.  For example, users with unwanted resources (adult sites, hacking sites, etc.) you can redirect to 403 Forbidden page.  To do this, you must enable mod_rewrite, although, as a rule, it is enabled by default.  Add in .htaccess code: <br><br><pre> <code class="bash hljs">&lt;IfModule mod_rewrite.c&gt; RewriteEngine on RewriteCond %{HTTP_REFERER} bannedurl1.com [NC,OR] RewriteCond %{HTTP_REFERER} bannedurl2.com [NC,OR] RewriteRule .* - [F] &lt;/ifModule&gt;</code> </pre><br>  You need to replace bannedurl1.com and bannedurl2.com with domains that you want to blacklist.  You can use the [NC] flag, indicating that the domain name entered is case-insensitive.  The [F] flag indicates the type of action, in this case, the display of 403 Forbidden error.  If you want to prohibit several sites, use the [NC, OR] flags for each domain, but if you want to prohibit the use of one domain, use only the [NC] flag. <br><br><h5>  6. Blocking requests from certain browsers </h5><br>  If records of visits to specific browsers have appeared in your log files (these can be bots or spiders simulating browser work), you can deny them access to your site by adding a few lines to.  htaccess: <br><br><pre> <code class="bash hljs">RewriteEngine On RewriteBase / SetEnvIfNoCase Referer <span class="hljs-string"><span class="hljs-string">"^$"</span></span> bad_user SetEnvIfNoCase User-Agent <span class="hljs-string"><span class="hljs-string">"^badbot1"</span></span> bad_user SetEnvIfNoCase User-Agent <span class="hljs-string"><span class="hljs-string">"^badbot2"</span></span> bad_user SetEnvIfNoCase User-Agent <span class="hljs-string"><span class="hljs-string">"^badbot3"</span></span> bad_user Deny from env=bad_user</code> </pre><br>  Replace badbot1, badbot1, etc. with bot names from your journal.  This will prevent outsiders from accessing your site. <br><br><h5>  7. File Caching </h5><br>  File caching is another way to speed up the loading of your site.  Here is what you need to register in .htaccess: <br><br><pre> <code class="bash hljs">&lt;FilesMatch <span class="hljs-string"><span class="hljs-string">".(flv|gif|jpg|jpeg|png|ico|swf|js|css|pdf)$"</span></span>&gt; Header <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> Cache-Control <span class="hljs-string"><span class="hljs-string">"max-age=2592000"</span></span> &lt;/FilesMatch&gt;</code> </pre><br>  You can add more file types (or delete some of them) to the list of files in this example listed.  You can also specify the time to save files in the cache (in seconds) using the max-age variable. <br><br><h5>  8. Disable caching for different file types. </h5><br>  If you do not want to cache certain types of files, you can not include them in the list.  However, sometimes files can be saved in the cache even without being explicitly listed in the list, in this case you can disable caching for them individually.  Most often, turning off caching is required for dynamic files, such as scripts.  An example of the code required for this: <br><pre> <code class="bash hljs">&lt;FilesMatch <span class="hljs-string"><span class="hljs-string">".(pl|php|cgi|spl|scgi|fcgi)$"</span></span>&gt; Header <span class="hljs-built_in"><span class="hljs-built_in">unset</span></span> Cache-Control &lt;/FilesMatch&gt;</code> </pre><br>  Just specify the file types for which you want to disable caching. <br><br><h5>  9. Bypassing the download dialog </h5><br>  By default, when you try to download a file from a web server, a dialog is displayed that asks you if you want to save the file or open it.  This dialogue is especially annoying when downloading large media or PDF files.  If the files you uploaded to the server are designed exclusively for downloading, you can make life easier for users by setting the download as the default action.  Add in  htaccess the following: <br><br><pre> <code class="bash hljs">AddType application/octet-stream .pdf AddType application/octet-stream .zip AddType application/octet-stream .mp3</code> </pre><br><h5>  10. Rename the .htaccess file </h5><br>  If you for some reason want to rename the .htaccess file, then you can do it.  Theoretically, renaming a .htaccess file should not cause problems with applications running on your server, but if you notice any script execution errors after renaming a file, just rename it back. <br><br><pre> <code class="bash hljs">AccessFileName htac.cess</code> </pre><br>  In addition, it is necessary to update all records that mention the .htaccess file, otherwise there will be a lot of errors. <br><br><h5>  11. Replacing the start page of the site </h5><br>  If you want to set a non-standard homepage (index.html, index.php, index.htm, etc.), add the following code to the .htaccess file: <br><br><pre> <code class="bash hljs">DirectoryIndex mypage.html</code> </pre><br>  Replace mypage.html with the URL of the page you want to use as the main one. <br><br><h5>  12. Redirect to secure HTTPS connection </h5><br>  If you are using HTTPS and want to redirect users to secure pages on your site, add the following lines to the .htaccess file: <br><br><pre> <code class="bash hljs">RewriteEngine On RewriteCond %{HTTPS} !on RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}</code> </pre><br><h5>  13. Limiting the maximum size of downloaded files in PHP, the maximum size of transmitted data, the maximum execution time of scripts, etc. </h5><br>  .htaccess allows you to set some values ‚Äã‚Äãthat directly affect the operation of PHP applications.  For example, if you want to set a limit on the size of uploaded files in PHP, in order not to overload hosting with large files: <br><br><pre> <code class="bash hljs">php_value upload_max_filesize 15M</code> </pre><br>  You can set any value; in the example, the file size is limited to 15M (MB).  In addition, you can limit the maximum size of the data transmitted when loading in PHP: <br><br><pre> <code class="bash hljs">php_value post_max_size 10M</code> </pre><br>  You can replace 10M with any value you require.  If you do not need constant execution of scripts, you can limit the time they are executed using the line: <br><br><pre> <code class="bash hljs">php_value max_execution_time 240</code> </pre><br>  240 - runtime (in seconds), after which the script will be stopped, you can change this value to any other.  Finally, if you want to limit the analysis time by the source data script, use the following code: <br><br><pre> <code class="bash hljs">php_value max_input_time 180</code> </pre><br>  Set instead of 180 whatever time you need (in seconds). <br><br><h5>  14. Hiding file types </h5><br>  Sometimes it is necessary that users do not know what types of files are on your site.  One way to hide this information is to have all your files displayed as HTML or PHP files: <br><br><pre> <code class="bash hljs">ForceType application/x-httpd-php ForceType application/x-httpd-php</code> </pre><br>  And this is only part of what can .htaccess, but in general it allows you to do much more.  For example, you can set automatic translation of pages on your site, set the server time zone, remove WWW from URLs, or use fancy directory views, etc.  But in any case, before you start experimenting with the .htaccess file, always save a backup of the original .htaccess so that if problems arise you can quickly restore the site. <br><br>  <a href="http://speckyboy.com/2013/01/08/useful-htaccess-snippets-and-hacks/">A source</a> <br><br>  <b>UPD</b> (thanks to <a href="http://habrahabr.ru/users/akuma/" class="user_link">akuma</a> ) The PHP extension for hiding the file format is given as an example and using this trick in a real project may prove unsafe. </div><p>Source: <a href="https://habr.com/ru/post/165701/">https://habr.com/ru/post/165701/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165681/index.html">Flyme 2.0 Review</a></li>
<li><a href="../165683/index.html">Where the hashCode legs grow</a></li>
<li><a href="../165695/index.html">Testing server 1C, DBMS MSSQL2008 on Windows 2008 OS on IBM x3650 M3 with 1 processor</a></li>
<li><a href="../165697/index.html">Adapting a website for users with disabilities is not difficult.</a></li>
<li><a href="../165699/index.html">Online IDE ShiftEdit</a></li>
<li><a href="../165703/index.html">Saving Excel documents to PDF on server</a></li>
<li><a href="../165705/index.html">A couple of words about application internationalization</a></li>
<li><a href="../165707/index.html">SoapServer in PHP. Let array be always Map</a></li>
<li><a href="../165709/index.html">GCW Zero on Kickstarter</a></li>
<li><a href="../165711/index.html">Prototyping with Wireframesketcher</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>