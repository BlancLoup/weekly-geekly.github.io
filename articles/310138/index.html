<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cisco OpenSOC - open source solution for creating your own cyber threat monitoring center</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As often happens, first you are looking for a solution on the market and, without finding it, you make it yourself and for yourself. And then it turns...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cisco OpenSOC - open source solution for creating your own cyber threat monitoring center</h1><div class="post__text post__text-html js-mediator-article">  As often happens, first you are looking for a solution on the market and, without finding it, you make it yourself and for yourself.  And then it turns out so well that you give it to others.  So it was with OpenSOC, an open source solution for managing large amounts of data in the field of cybersecurity, which was developed at Cisco for its own needs, and then laid out on GitHub for universal access. <br><br><img src="https://habrastorage.org/files/4f8/056/471/4f8056471dae400f9cae1b3cafa029f7.png" alt="Cisco OpenSOC Architecture"><br><a name="habracut"></a><br>  If you recall one of our previous <a href="https://habrahabr.ru/company/cisco/blog/308472/">notes</a> about how the access control process is built within Cisco, then you can pay attention to the number of devices that we have to monitor.  And now let's see how much safety-relevant data these devices generate / pass through on a <b>daily basis</b> : <br><br><ul><li>  47 Terabyte of network traffic data </li><li>  1.2 trillion network events </li><li>  4.8 billion DNS queries for Cisco Umbrella </li><li>  4.1 million email for Cisco Email Security Appliance </li><li>  45 Million Web Requests (URLs) for Cisco Web Security Appliance and Cisco Cloud Web Security </li><li>  15 Billion NetFlow Flows for Cisco Stealthwatch </li><li>  1.5 Million Alarms from Cisco NGIPS </li><li>  10 thousand files for the Cisco AMP ThreatGrid system. </li></ul><br>  In total, we collect and store 4 TB of data daily for analysis.  This is a huge amount of information for the effective management of which our cybersecurity service simply needed specialized tools.  The first thing that comes to mind when the topic of security event management arises is SIEM (Security Information Event Management), and we, like many other companies in the world, have also tried to use such solutions.  But unfortunately, not a single SIEM solution could solve our problems and there were several reasons for that: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  the complexity of data indexation is not from information security tools, including the support of data formats from our developed information security tools (in this case, this is not about the Cisco portfolio, which we not only sell to customers, but also use ourselves, but personally wrote various information security tools on our own ‚ÄúTools‚Äù for some tasks) </li><li>  serious problems with scaling and data processing speed (searching in just 10 GB of data took more than 6 minutes) </li><li>  complexity in customizing solutions for our tasks and the need to rewrite almost from scratch all built-in rules that generated too many false positives </li><li>  the complexity of working with structured and unstructured data. </li></ul><br>  As an alternative to existing SIEM solutions, we began to use Splunk, which allowed us to solve many of the problems listed above, and even cheaper.  But ... Splunk, in spite of everything, still could not solve all our problems;  only 95% of them.  He collected data from our antiviruses, ITU, IDS / IPS, content filtering systems, etc.  But 5% of the information, which is very important for our incident response team, was left out.  Very important information about threats, attackers, their methods and tactics.  It was not so easy to enrich the data in Splunk from the means of protection with this information.  At first we created various simple scripts and utilities, each of which solved its own narrow problems.  Then came the idea to make your decision, turning it into a full-fledged platform for analyzing big data in the field of cybersecurity (Threat Intelligence Platform). <br><br><img src="https://habrastorage.org/files/853/4a4/f54/8534a4f54ff54d98a5cbe37fcb7e9f92.png" alt="Levels and number of incident response specialists at Cisco"><br><br>  Since this system, called OpenSOC, was created for its own needs, it was impossible to attract any developers involved in the development of Cisco products - we had to use only our own information security forces.  Therefore, it is quite logical that we did not write everything from scratch, but used open source solutions, among which the main role was played: <br><br><ul><li>  Flume (https://flume.apache.org) is a distributed tool for collecting and aggregating large amounts of data from different sources in different formats (Syslog, SNMP, Netflow, JMS, HTTP, files, PCAP, etc.).  In OpenSOC, Flume collects telemetry from various protections, applications, and equipment. </li><li>  Kafka (http://kafka.apache.org) is a distributed high-performance message broker (bus). </li><li>  Storm ([http://storm.apache.org]) is a real-time distributed data handler that receives data to perform calculations on them, including from Kafka.  Built-in handlers allow you to perform various tasks on security events - filtering, normalizing, parsing (parsing), enriching information about threats.  In the latter case, the normalized data is extended by the context of information security - geolocation, IP reputation, information from Whois, etc.  The public version of OpenSOC by default includes only 4 processors involved in enriching the source data. </li></ul><br><img src="https://habrastorage.org/files/f80/95b/2b9/f8095b2b970d4c52a78df76eeefdd5c9.png" alt="Apache Storm Architecture in Cisco OpenSOC"><br><br><ul><li>  Hadoop ([hadoop.apache.org]) is a set of utilities and libraries for developing execution of distributed programs, for example, for search and contextual mechanisms.  Underlies the technology of ‚ÄúBig Data‚Äù.  Hadoop cluster in OpenSOC stores all data </li><li>  Elasticsearch is a real-time search and indexing system for large amounts of data. </li><li>  HBase is a non-relational distributed database.  In OpenSOC provides long-term storage of network packets (PCAP). </li><li>  Hive is a database management system based on Hadoop, including HBase.  In OpenSOC provides long-term storage of security events. </li><li>  MySQL is a relational database management system.  OpenSOC stores Hive metadata, as well as other data, such as geolocation. </li><li>  Kibana is a visualization system. </li></ul><br><img src="https://habrastorage.org/files/a53/119/ed5/a53119ed5ee940b6bec2904729626e2c.png" alt="The process of enriching the source data"><br><br>  OpenSOC has become a unified security data analysis platform at Cisco, which: <br><br><ul><li>  collects, stores, processes and analyzes data from various sides in order to detect anomalies and other obvious and implicit violations of information security </li><li>  allows you to use different predictive and correlation models to search for hidden interconnections in the collected data </li><li>  takes into account the context of the analyzed data in real time </li><li>  visualizes security events in the right environment and generates reports for interested parties. </li></ul><br>  From a technical point of view, it is based on a cluster of 45 servers of Cisco UCS (1440 processors, 12 TB of memory), the aforementioned technologies of Hadoop, Hive, HBase, Elasticsearch and a number of others.  The storage capacity of OpenSOC at Cisco is 1.2 PB.  In one table is over 1.3 trillion lines. <br><br><img src="https://habrastorage.org/files/65d/49f/cbb/65d49fcbb9f74a5198566d5c32c90c17.png" alt="Cisco OpenSOC Storage"><br><br>  We began to create Cisco OpenSOC in 2013, and in September 2013, the first prototype appeared.  In half the way, in December 2013, <a href="http://hortonworks.com/partner/cisco/">Hortonworks</a> joined us, which gave an impetus to the development of the project and brought many interesting ideas on using open source components for a high-performance and distributed platform, which was supposed to be OpenSOC.  In March 2014, we completed the development of OpenSOC, and in September 2014 we made it public and uploaded to <a href="http://opensoc.github.io/">GitHub</a> . <br><br><img src="https://habrastorage.org/files/fe9/61d/55e/fe961d55ecd2434c8c67f1ce48b4b8cd.png" alt="image"><br><br>  In the basic configuration supports the functions of data collection, their storage and analysis, as well as enriching the information about the threats, victims, attackers.  The number of adapters, which essentially perform the function of correlating various events, is small in the public version of OpenSOC.  As is the case with most SIEM, the out-of-box correlation rules do not work very well, and therefore in OpenSOC you need to write them yourself for each system user.  In the NTT group of companies, for example, the open source engine <a href="http://www.espertech.com/products/esper.php">Esper is</a> used as a tool for creating triggers and correlation rules. <br><br><img src="https://habrastorage.org/files/5e2/cd7/56d/5e2cd756dd55448f90ac586ccd649ad7.png" alt="An example of a correlation rule based on Esper"><br><br>  After the success of OpenSOC within the company, it was decided to develop it as the basis for our outsourcing services.  <a href="http://www.cisco.com/c/en/us/products/security/managed-services.html">Cisco Active Threat Analytics</a> (ATA) is essentially a distributed Security Operations Center (SOC), which takes over the functions of monitoring and managing the information security of our customers.  Developing OpenSOC both within the company and within the Cisco ATA, we are faced with the fact that the Apache 2.0 license does not always allow us to implement everything we wanted.  Yes, and only open source components, we could not be limited to solving all the problems we have. <br><br><img src="https://habrastorage.org/files/ec4/1d8/fbd/ec41d8fbd89d4539a63f5f68a8469ded.png" alt="OpenSOC based GUI"><br><br>  It was decided to divide the development of OpenSOC into two directions.  The first remained in Cisco, for the needs of our information service and ATA.  But the second direction was very interesting.  OpenSOC entered the Apache incubator, becoming a full-fledged project developed by the open source community.  OpenSOC changed the name, becoming <a href="https://metron.incubator.apache.org/about/">Apache Metron</a> .  In April 2016, the first version of Apache Metron 0.1 was released.  At the same time, the ideology remains unchanged and it will be easy for OpenSOC users to switch to Apache Metron. <br><br><img src="https://habrastorage.org/files/eb3/0c5/ecd/eb30c5ecd1ba40c5b817698d6fa1c262.png" alt="Apache metron"><br><br>  Cisco OpenSOC has been developed in a different direction.  On its basis, MapR has created its <a href="https://www.mapr.com/solutions/enterprise/security-and-risk-management">Security Log Analytics</a> solution, which is used by NTT, Zion Bank, and other customers mentioned above.  But, as in the case of Apache Metron, the ideology of OpenSOC remains unchanged - the analysis of big data for cybersecurity purposes and the ability to work not only with structured, but also with unstructured data.  This allows you to significantly expand the functions of monitoring threats in the company and "see" much more than before, using more information sources.  For example, in Cisco over the past few years, there has been a shift from the usual static rules and signatures towards behavioral analysis, anomalies, and threat intelligence.  All this would have been impossible without Cisco OpenSOC. <br><br><img src="https://habrastorage.org/files/a09/3c7/b2c/a093c7b2cb0f4ef68cbaca4bbc4b2f32.png" alt="Expansion of the spectrum of data used by Cisco to detect information security incidents"></div><p>Source: <a href="https://habr.com/ru/post/310138/">https://habr.com/ru/post/310138/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../310126/index.html">How I participated in the development of a new Internet standard</a></li>
<li><a href="../310128/index.html">Security Week 37: Windows patches will become more cumulative, Google vs. HTTP, vulnerability in MySQL</a></li>
<li><a href="../310130/index.html">Briefly about Java MemoryModel for those who have little time, but I wanted to figure it out</a></li>
<li><a href="../310134/index.html">Pixel Launcher vs Other Launchers</a></li>
<li><a href="../310136/index.html">A change in PHP 7 breaking some servers on Ubuntu when upgrading from version 5</a></li>
<li><a href="../310140/index.html">IBM Watson: the cognitive system in cinema</a></li>
<li><a href="../310142/index.html">The final release of Angular 2</a></li>
<li><a href="../310144/index.html">We raise Owncloud from scratch with dynamic IP and Let's Encrypt. A thousand elephants! *</a></li>
<li><a href="../310146/index.html">Chained together, or add comfort comments Vkontakte</a></li>
<li><a href="../310148/index.html">CUBA Platform: Java RAD open source framework</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>