<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ASP.NET MVC Lesson 8. View, Razor, error page</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The purpose of the lesson . Learn how to output data in html, using Razor. Helper. PageableData. Dynamic forms. RedirectToLogin, RedirectToNotFoundPag...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ASP.NET MVC Lesson 8. View, Razor, error page</h1><div class="post__text post__text-html js-mediator-article">  <b>The purpose of the lesson</b> .  Learn how to output data in html, using Razor.  Helper.  PageableData.  Dynamic forms.  RedirectToLogin, RedirectToNotFoundPage.  Error page.  RssActionResult. <br><br><h5>  The foundation </h5><br>  So, we will consider as part of View is arranged. <br>  In the controller, all action methods return the type ActionResult.  And to display the result, we use: <br> <code>return View(modelData);</code> <br> <br><a name="habracut"></a><br>  The main parameters of the View can be: <br><ul><li>  Name, usually it coincides with the name of the action method.  If it is necessary to call another by the name of View, then the <code>return View(‚ÄúViewName‚Äù, modelData).</code> </li><li>  Data to display in View.  Optional parameter.  When passed to View, this data object will be designated Model.  To bind a data type in View, the expected data type is specified: <br><pre> <code class="hljs pgsql"> @model LessonProject.Model.<span class="hljs-keyword"><span class="hljs-keyword">User</span></span></code> </pre><br></li><li>  Layout.  Optional parameter.  If you specify this parameter, this page will find the page-container and will be called.  View-part will be processed by RenderBody () method </li></ul><br><br>  The choice of which View to use is as follows: <br><ul><li>  Looks up in / Areas / [Area] / Views / [ControllerName] / </li><li>  Searched in folder / Areas / [Area] / Views / Shared / </li><li>  Searched in the folder / Views / [ControllerName] / </li><li>  Looks up in the folder / Views / Shared / </li></ul><br>  let's start the study. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Razor </h5><br>  When creating a View, there is a choice between two engines: ASPX and Razor.  We will not use the first one in the future, so let's talk about Razor. <br><br><img src="https://habrastorage.org/storage2/c06/f16/873/c06f16873cf42c20c35a65082118965f.jpg"><br><br>  ASPX was a thundering engine with <code>&lt;% %&gt;</code> %% <code>&lt;% %&gt;</code> tags for code execution and <code>&lt;%: %&gt;</code> for data output. <br><br>  Razor uses the <code>@Model.Name</code> .  Those.  everything that begins with <code>@</code> translates into either the code execution mode, or the <code>@foreach() {‚Ä¶}</code> data output, or <code>@if() { ‚Ä¶ } else { ‚Ä¶ }</code> : <br><br><pre> <code class="html hljs xml">@if (Model.Any()) { <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> } @foreach (var role in Model) { <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"id"</span></span></span><span class="hljs-tag">&gt;</span></span> @role.ID <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span><span class="hljs-tag">&gt;</span></span> @role.Name <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Code"</span></span></span><span class="hljs-tag">&gt;</span></span> @role.Code <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> }</code> </pre><br><br>  There are tags inside {} - this is a marker of what the template is.  For simple execution of code inside a template, use the @ {code} structure, for correct output of data inside attributes or with a text - (string result): <br><pre> <code class="html hljs xml">@{ int i = 0; } @foreach (var role in Model) { <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item @(i % 2 == 0 ? "</span></span></span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">odd</span></span></span><span class="hljs-tag">" </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:</span></span></span><span class="hljs-tag"> "")"&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"id"</span></span></span><span class="hljs-tag">&gt;</span></span> @role.ID <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span><span class="hljs-tag">&gt;</span></span> @role.Name <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Code"</span></span></span><span class="hljs-tag">&gt;</span></span> @role.Code <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> i++; }</code> </pre><br>  To display non-tagged text, you need to use pseudo tags: <br><pre> <code class="html hljs xml">@foreach (var role in Model) { @role.Name<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span>, <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span> }</code> </pre><br>  To output html text, either MvcHtmlString must be returned, or use the <a href="https://habrahabr.ru/users/html/" class="user_link">Html</a> .Raw (html-string-value) construct, otherwise the text will be output with tag escaping. <br><br><h5>  Pageabledata </h5><br>  Consider paginated table output from the database.  Let's analyze: <br><ol><li>  The controller should get in the parameters the value of the page that we will display </li><li>  By default this will be the first page. </li><li>  When withdrawing, we need to know: <br><ol><li>  List of database elements that are displayed </li><li>  Number of pages </li><li>  Current page </li></ol><br></li></ol><br>  Create a Generic PageableData class (/Models/Info/PageableData.cs): <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PageableData</span></span>&lt;<span class="hljs-title"><span class="hljs-title">T</span></span>&gt; <span class="hljs-title"><span class="hljs-title">where</span></span> <span class="hljs-title"><span class="hljs-title">T</span></span> : <span class="hljs-title"><span class="hljs-title">class</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ItemPerPageDefault = <span class="hljs-number"><span class="hljs-number">20</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IEnumerable&lt;T&gt; List { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> PageNo { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CountPage { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ItemPerPage { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PageableData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IQueryable&lt;T&gt; queryableSet, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> page, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> itemPerPage = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (itemPerPage == <span class="hljs-number"><span class="hljs-number">0</span></span>) { itemPerPage = ItemPerPageDefault; } ItemPerPage = itemPerPage; PageNo = page; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count = queryableSet.Count(); CountPage = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span>.Remainder(count, itemPerPage) == <span class="hljs-number"><span class="hljs-number">0</span></span> ? count / itemPerPage : count / itemPerPage + <span class="hljs-number"><span class="hljs-number">1</span></span>; List = queryableSet.Skip((PageNo - <span class="hljs-number"><span class="hljs-number">1</span></span>) * itemPerPage).Take(itemPerPage); } }</code> </pre><br><br>  By default, the number of displayed values ‚Äã‚Äãon a page is 20, but we can change this parameter in the constructor.  We transfer IQueryable and we calculate the number of CountPage pages.  Using PageNo, select the page: <br><pre> <code class="cs hljs">List = queryableSet.Skip((PageNo - <span class="hljs-number"><span class="hljs-number">1</span></span>) * itemPerPage).Take(itemPerPage);</code> </pre><br><br>  In the controller we use: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">UserController</span></span> : <span class="hljs-title"><span class="hljs-title">DefaultController</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ActionResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Index</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> page = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PageableData&lt;User&gt;(Repository.Users, page, <span class="hljs-number"><span class="hljs-number">30</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(data); } ‚Ä¶</code> </pre><br>  In View we use this class: <br><pre> <code class="html hljs xml">@model LessonProject.Models.Info.PageableData<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LessonProject.Model.User</span></span></span><span class="hljs-tag">&gt;</span></span> @{ ViewBag.Title = "Users"; Layout = "~/Areas/Default/Views/Shared/_Layout.cshtml"; } <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>Users<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> @foreach (var user in Model.List) { <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"id"</span></span></span><span class="hljs-tag">&gt;</span></span> @user.ID <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag">&gt;</span></span> @user.Email <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"activateDate"</span></span></span><span class="hljs-tag">&gt;</span></span> @user.AddedDate <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> } <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Run, check (http: // localhost / User) <br><br><img src="https://habrastorage.org/storage2/e4c/e4d/b78/e4ce4db78b65cbdfa86ef9e87f941303.jpg"><br><br>  To continue, we will generate more data (just ctrl-c, ctrl-v in the table in Server Explorer) <br><br><img src="https://habrastorage.org/storage2/005/973/135/005973135f525f7f9461170d04c652b1.jpg"><br><br>  Let us turn to the creation of the Helper paginator, which will give us the opportunity to scroll through this list. <br><br><h5>  Helper (PagerHelper) </h5><br>  Since we use bootstrap, we will do paginator on the basis of it.  In code, it looks like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pagination"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span>Prev<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span>5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span>Next<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  We are only interested in the inside. <br>  Helper is created as an Extension for the System.Web.Mvc.HtmlHelper class.  The plan is: <br><ul><li>  Print Prev (make active if necessary) </li><li>  Display links to the first three pages 1, 2, 3 </li><li>  Print the ellipsis if necessary </li><li>  Display the active link of the current page. </li><li>  Print the ellipsis if necessary </li><li>  Print the last three pages. </li><li>  Print Next (make active if necessary) </li><li>  Conclude everything in ul and output as MvcHtmlString </li></ul><br>  The code will look like this: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MvcHtmlString </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PageLinks</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HtmlHelper html, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> currentPage, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> totalPages, Func&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; pageUrl</span></span></span><span class="hljs-function">)</span></span> { StringBuilder builder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-comment"><span class="hljs-comment">//Prev var prevBuilder = new TagBuilder("a"); prevBuilder.InnerHtml = "¬´"; if (currentPage == 1) { prevBuilder.MergeAttribute("href", "#"); builder.AppendLine("&lt;li class=\"active\"&gt;" + prevBuilder.ToString() + "&lt;/li&gt;"); } else { prevBuilder.MergeAttribute("href", pageUrl.Invoke(currentPage - 1)); builder.AppendLine("&lt;li&gt;" + prevBuilder.ToString() + "&lt;/li&gt;"); } //  for (int i = 1; i &lt;= totalPages; i++) { //      if (((i &lt;= 3) || (i &gt; (totalPages - 3))) || ((i &gt; (currentPage - 2)) &amp;&amp; (i &lt; (currentPage + 2)))) { var subBuilder = new TagBuilder("a"); subBuilder.InnerHtml = i.ToString(CultureInfo.InvariantCulture); if (i == currentPage) { subBuilder.MergeAttribute("href", "#"); builder.AppendLine("&lt;li class=\"active\"&gt;" + subBuilder.ToString() + "&lt;/li&gt;"); } else { subBuilder.MergeAttribute("href", pageUrl.Invoke(i)); builder.AppendLine("&lt;li&gt;" + subBuilder.ToString() + "&lt;/li&gt;"); } } else if ((i == 4) &amp;&amp; (currentPage &gt; 5)) { //  builder.AppendLine("&lt;li class=\"disabled\"&gt; &lt;a href=\"#\"&gt;...&lt;/a&gt; &lt;/li&gt;"); } else if ((i == (totalPages - 3)) &amp;&amp; (currentPage &lt; (totalPages - 4))) { //  builder.AppendLine("&lt;li class=\"disabled\"&gt; &lt;a href=\"#\"&gt;...&lt;/a&gt; &lt;/li&gt;"); } } //Next var nextBuilder = new TagBuilder("a"); nextBuilder.InnerHtml = "¬ª"; if (currentPage == totalPages) { nextBuilder.MergeAttribute("href", "#"); builder.AppendLine("&lt;li class=\"active\"&gt;" + nextBuilder.ToString() + "&lt;/li&gt;"); } else { nextBuilder.MergeAttribute("href", pageUrl.Invoke(currentPage + 1)); builder.AppendLine("&lt;li&gt;" + nextBuilder.ToString() + "&lt;/li&gt;"); } return new MvcHtmlString("&lt;ul&gt;" + builder.ToString() + "&lt;/ul&gt;"); }</span></span></code> </pre><br><br>  Add the namespace LessonProject.Helper to the ads in the View.  This can be done in two ways: <br><ul><li>  In the View itself <br><pre> <code class="html hljs xml">@using LessonProject.Helper;</code> </pre><br></li><li>  In Web.config (recommended) <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configSections</span></span></span><span class="hljs-tag">&gt;</span></span> ‚Ä¶ <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sectionGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"system.web.webPages.razor"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"host"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">requirePermission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pages"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">requirePermission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sectionGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configSections</span></span></span><span class="hljs-tag">&gt;</span></span> + <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.web.webPages.razor</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pages</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pageBaseType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Web.Mvc.WebViewPage"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">namespaces</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"LessonProject.Helper"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">namespaces</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pages</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.web.webPages.razor</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br></li></ul><br><br>  Add a paginator in View: <br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pagination"</span></span></span><span class="hljs-tag">&gt;</span></span> @Html.PageLinks(Model.PageNo, Model.CountPage, x =&gt; Url.Action("Index", new {page = x})) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Pay attention to the design <br> <code>x =&gt; Url.Action("Index", new {page = x})</code> <br>  This is the delegate that returns the link to the page.  And Url.Action () - forms a link to the page / User / Index with the parameter page = x. <br>  That's what happened (reduced the number of output per page to 5, so that more pages were formed): <br><br><img src="https://habrastorage.org/storage2/22e/d2a/a25/22ed2aa2511ee301fd930e055927b248.jpg"><br><br><h5>  SearchEngine </h5><br>  The next step to view the data will be to create a search.  The search will be simple, by matching the substring in one of the data fields.  The input parameter is searchString. <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ActionResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Index</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> page = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> searchString = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(searchString)) { <span class="hljs-comment"><span class="hljs-comment">//  return View(data); } else { var data = new PageableData&lt;User&gt;(Repository.Users, page, 5); return View(data); } }</span></span></code> </pre><br><br>  Create a <code>SearchEngine</code> class that accepts values. <pre> <code class="hljs pgsql"><code class="cs"> IQueryable,   ,      (/<span class="hljs-keyword"><span class="hljs-keyword">Global</span></span>/SearchEngine.cs): <br>  ,      ,       [,], {,}, (,): <br> /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// The regex strip html. /// &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; private static readonly Regex RegexStripHtml = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Regex("&lt;[^&gt;]*&gt;", RegexOptions.Compiled); private static string StripHtml(string html) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> string.IsNullOrWhiteSpace(html) ? string.Empty : RegexStripHtml.Replace(html, string.Empty).Trim(); } private static string CleanContent(string content, <span class="hljs-type"><span class="hljs-type">bool</span></span> removeHtml) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (removeHtml) { content = StripHtml(content); } content = content.Replace("\\", string.Empty). Replace("|", string.Empty). Replace("(", string.Empty). Replace(")", string.Empty). Replace("[", string.Empty). Replace("]", string.Empty). Replace("*", string.Empty). Replace("?", string.Empty). Replace("}", string.Empty). Replace("{", string.Empty). Replace("^", string.Empty). Replace("+", string.Empty); var words = content.Split(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span>[] { <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'\n'</span></span>, <span class="hljs-string"><span class="hljs-string">'\r'</span></span> }, StringSplitOptions.RemoveEmptyEntries); var sb = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (var word <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> words.<span class="hljs-keyword"><span class="hljs-keyword">Select</span></span>(t =&gt; t.ToLowerInvariant().Trim()).<span class="hljs-keyword"><span class="hljs-keyword">Where</span></span>(word =&gt; word.Length &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>)) { sb.AppendFormat("{0} ", word); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sb.ToString(); }</code> <br> <br>  : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static IEnumerable&lt;<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">Search</span></span>(string searchString, IQueryable&lt;<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>&gt; source) { var term = CleanContent(searchString.ToLowerInvariant().Trim(), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var terms = term.Split(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span>[] { <span class="hljs-string"><span class="hljs-string">' '</span></span> }, StringSplitOptions.RemoveEmptyEntries); var regex = string.Format(CultureInfo.InvariantCulture, "({0})", string.<span class="hljs-keyword"><span class="hljs-keyword">Join</span></span>("|", terms)); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (var entry <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> source) { var rank = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!string.IsNullOrWhiteSpace(entry.Email)) { rank += Regex.Matches(entry.Email.ToLowerInvariant(), regex).Count; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rank &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entry; } } }</code> <br> <br>      .  regex  .   ,      Email  . <br> <br>   : <br>     , , ¬´cher [<span class="hljs-number"><span class="hljs-number">2</span></span>]¬ª,   ,  ¬´cher <span class="hljs-number"><span class="hljs-number">2</span></span>¬ª.  regex = (cher|<span class="hljs-number"><span class="hljs-number">2</span></span>).   ,   <code>IQueryable</code> <br>   ,     IEnumerable - yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entry <br></code> </pre> <code><code class="cs"> IQueryable,   ,      (/Global/SearchEngine.cs): <br>  ,      ,       [,], {,}, (,): <br> /// &lt;summary&gt; /// The regex strip html. /// &lt;/summary&gt; private static readonly Regex RegexStripHtml = new Regex("&lt;[^&gt;]*&gt;", RegexOptions.Compiled); private static string StripHtml(string html) { return string.IsNullOrWhiteSpace(html) ? string.Empty : RegexStripHtml.Replace(html, string.Empty).Trim(); } private static string CleanContent(string content, bool removeHtml) { if (removeHtml) { content = StripHtml(content); } content = content.Replace("\\", string.Empty). Replace("|", string.Empty). Replace("(", string.Empty). Replace(")", string.Empty). Replace("[", string.Empty). Replace("]", string.Empty). Replace("*", string.Empty). Replace("?", string.Empty). Replace("}", string.Empty). Replace("{", string.Empty). Replace("^", string.Empty). Replace("+", string.Empty); var words = content.Split(new[] { ' ', '\n', '\r' }, StringSplitOptions.RemoveEmptyEntries); var sb = new StringBuilder(); foreach (var word in words.Select(t =&gt; t.ToLowerInvariant().Trim()).Where(word =&gt; word.Length &gt; 1)) { sb.AppendFormat("{0} ", word); } return sb.ToString(); }</code> <br> <br>  : <br> <code class="cs">public static IEnumerable&lt;User&gt; Search(string searchString, IQueryable&lt;User&gt; source) { var term = CleanContent(searchString.ToLowerInvariant().Trim(), false); var terms = term.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries); var regex = string.Format(CultureInfo.InvariantCulture, "({0})", string.Join("|", terms)); foreach (var entry in source) { var rank = 0; if (!string.IsNullOrWhiteSpace(entry.Email)) { rank += Regex.Matches(entry.Email.ToLowerInvariant(), regex).Count; } if (rank &gt; 0) { yield return entry; } } }</code> <br> <br>      .  regex  .   ,      Email  . <br> <br>   : <br>     , , ¬´cher [2]¬ª,   ,  ¬´cher 2¬ª.  regex = (cher|2).   ,   <code>IQueryable</code> <br>   ,     IEnumerable - yield return entry <br></code> <pre> <code class="hljs pgsql"><code class="cs"> IQueryable,   ,      (/<span class="hljs-keyword"><span class="hljs-keyword">Global</span></span>/SearchEngine.cs): <br>  ,      ,       [,], {,}, (,): <br> /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// The regex strip html. /// &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; private static readonly Regex RegexStripHtml = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Regex("&lt;[^&gt;]*&gt;", RegexOptions.Compiled); private static string StripHtml(string html) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> string.IsNullOrWhiteSpace(html) ? string.Empty : RegexStripHtml.Replace(html, string.Empty).Trim(); } private static string CleanContent(string content, <span class="hljs-type"><span class="hljs-type">bool</span></span> removeHtml) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (removeHtml) { content = StripHtml(content); } content = content.Replace("\\", string.Empty). Replace("|", string.Empty). Replace("(", string.Empty). Replace(")", string.Empty). Replace("[", string.Empty). Replace("]", string.Empty). Replace("*", string.Empty). Replace("?", string.Empty). Replace("}", string.Empty). Replace("{", string.Empty). Replace("^", string.Empty). Replace("+", string.Empty); var words = content.Split(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span>[] { <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'\n'</span></span>, <span class="hljs-string"><span class="hljs-string">'\r'</span></span> }, StringSplitOptions.RemoveEmptyEntries); var sb = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (var word <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> words.<span class="hljs-keyword"><span class="hljs-keyword">Select</span></span>(t =&gt; t.ToLowerInvariant().Trim()).<span class="hljs-keyword"><span class="hljs-keyword">Where</span></span>(word =&gt; word.Length &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>)) { sb.AppendFormat("{0} ", word); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sb.ToString(); }</code> <br> <br>  : <br> <code class="cs"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static IEnumerable&lt;<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">Search</span></span>(string searchString, IQueryable&lt;<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>&gt; source) { var term = CleanContent(searchString.ToLowerInvariant().Trim(), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var terms = term.Split(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span>[] { <span class="hljs-string"><span class="hljs-string">' '</span></span> }, StringSplitOptions.RemoveEmptyEntries); var regex = string.Format(CultureInfo.InvariantCulture, "({0})", string.<span class="hljs-keyword"><span class="hljs-keyword">Join</span></span>("|", terms)); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (var entry <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> source) { var rank = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!string.IsNullOrWhiteSpace(entry.Email)) { rank += Regex.Matches(entry.Email.ToLowerInvariant(), regex).Count; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rank &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entry; } } }</code> <br> <br>      .  regex  .   ,      Email  . <br> <br>   : <br>     , , ¬´cher [<span class="hljs-number"><span class="hljs-number">2</span></span>]¬ª,   ,  ¬´cher <span class="hljs-number"><span class="hljs-number">2</span></span>¬ª.  regex = (cher|<span class="hljs-number"><span class="hljs-number">2</span></span>).   ,   <code>IQueryable</code> <br>   ,     IEnumerable - yield <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> entry <br></code> </pre> <code><code class="cs"> IQueryable,   ,      (/Global/SearchEngine.cs): <br>  ,      ,       [,], {,}, (,): <br> /// &lt;summary&gt; /// The regex strip html. /// &lt;/summary&gt; private static readonly Regex RegexStripHtml = new Regex("&lt;[^&gt;]*&gt;", RegexOptions.Compiled); private static string StripHtml(string html) { return string.IsNullOrWhiteSpace(html) ? string.Empty : RegexStripHtml.Replace(html, string.Empty).Trim(); } private static string CleanContent(string content, bool removeHtml) { if (removeHtml) { content = StripHtml(content); } content = content.Replace("\\", string.Empty). Replace("|", string.Empty). Replace("(", string.Empty). Replace(")", string.Empty). Replace("[", string.Empty). Replace("]", string.Empty). Replace("*", string.Empty). Replace("?", string.Empty). Replace("}", string.Empty). Replace("{", string.Empty). Replace("^", string.Empty). Replace("+", string.Empty); var words = content.Split(new[] { ' ', '\n', '\r' }, StringSplitOptions.RemoveEmptyEntries); var sb = new StringBuilder(); foreach (var word in words.Select(t =&gt; t.ToLowerInvariant().Trim()).Where(word =&gt; word.Length &gt; 1)) { sb.AppendFormat("{0} ", word); } return sb.ToString(); }</code> <br> <br>  : <br> <code class="cs">public static IEnumerable&lt;User&gt; Search(string searchString, IQueryable&lt;User&gt; source) { var term = CleanContent(searchString.ToLowerInvariant().Trim(), false); var terms = term.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries); var regex = string.Format(CultureInfo.InvariantCulture, "({0})", string.Join("|", terms)); foreach (var entry in source) { var rank = 0; if (!string.IsNullOrWhiteSpace(entry.Email)) { rank += Regex.Matches(entry.Email.ToLowerInvariant(), regex).Count; } if (rank &gt; 0) { yield return entry; } } }</code> <br> <br>      .  regex  .   ,      Email  . <br> <br>   : <br>     , , ¬´cher [2]¬ª,   ,  ¬´cher 2¬ª.  regex = (cher|2).   ,   <code>IQueryable</code> <br>   ,     IEnumerable - yield return entry <br></code> <ul><li> <code><code class="cs"> IQueryable,   ,      (/Global/SearchEngine.cs): <br>  ,      ,       [,], {,}, (,): <br> /// &lt;summary&gt; /// The regex strip html. /// &lt;/summary&gt; private static readonly Regex RegexStripHtml = new Regex("&lt;[^&gt;]*&gt;", RegexOptions.Compiled); private static string StripHtml(string html) { return string.IsNullOrWhiteSpace(html) ? string.Empty : RegexStripHtml.Replace(html, string.Empty).Trim(); } private static string CleanContent(string content, bool removeHtml) { if (removeHtml) { content = StripHtml(content); } content = content.Replace("\\", string.Empty). Replace("|", string.Empty). Replace("(", string.Empty). Replace(")", string.Empty). Replace("[", string.Empty). Replace("]", string.Empty). Replace("*", string.Empty). Replace("?", string.Empty). Replace("}", string.Empty). Replace("{", string.Empty). Replace("^", string.Empty). Replace("+", string.Empty); var words = content.Split(new[] { ' ', '\n', '\r' }, StringSplitOptions.RemoveEmptyEntries); var sb = new StringBuilder(); foreach (var word in words.Select(t =&gt; t.ToLowerInvariant().Trim()).Where(word =&gt; word.Length &gt; 1)) { sb.AppendFormat("{0} ", word); } return sb.ToString(); }</code> <br> <br>  : <br> <code class="cs">public static IEnumerable&lt;User&gt; Search(string searchString, IQueryable&lt;User&gt; source) { var term = CleanContent(searchString.ToLowerInvariant().Trim(), false); var terms = term.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries); var regex = string.Format(CultureInfo.InvariantCulture, "({0})", string.Join("|", terms)); foreach (var entry in source) { var rank = 0; if (!string.IsNullOrWhiteSpace(entry.Email)) { rank += Regex.Matches(entry.Email.ToLowerInvariant(), regex).Count; } if (rank &gt; 0) { yield return entry; } } }</code> <br> <br>      .  regex  .   ,      Email  . <br> <br>   : <br>     , , ¬´cher [2]¬ª,   ,  ¬´cher 2¬ª.  regex = (cher|2).   ,   <code>IQueryable</code> <br>   ,     IEnumerable - yield return entry <br></code> </li> <li> <code><code class="cs"> IQueryable,   ,      (/Global/SearchEngine.cs): <br>  ,      ,       [,], {,}, (,): <br> /// &lt;summary&gt; /// The regex strip html. /// &lt;/summary&gt; private static readonly Regex RegexStripHtml = new Regex("&lt;[^&gt;]*&gt;", RegexOptions.Compiled); private static string StripHtml(string html) { return string.IsNullOrWhiteSpace(html) ? string.Empty : RegexStripHtml.Replace(html, string.Empty).Trim(); } private static string CleanContent(string content, bool removeHtml) { if (removeHtml) { content = StripHtml(content); } content = content.Replace("\\", string.Empty). Replace("|", string.Empty). Replace("(", string.Empty). Replace(")", string.Empty). Replace("[", string.Empty). Replace("]", string.Empty). Replace("*", string.Empty). Replace("?", string.Empty). Replace("}", string.Empty). Replace("{", string.Empty). Replace("^", string.Empty). Replace("+", string.Empty); var words = content.Split(new[] { ' ', '\n', '\r' }, StringSplitOptions.RemoveEmptyEntries); var sb = new StringBuilder(); foreach (var word in words.Select(t =&gt; t.ToLowerInvariant().Trim()).Where(word =&gt; word.Length &gt; 1)) { sb.AppendFormat("{0} ", word); } return sb.ToString(); }</code> <br> <br>  : <br> <code class="cs">public static IEnumerable&lt;User&gt; Search(string searchString, IQueryable&lt;User&gt; source) { var term = CleanContent(searchString.ToLowerInvariant().Trim(), false); var terms = term.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries); var regex = string.Format(CultureInfo.InvariantCulture, "({0})", string.Join("|", terms)); foreach (var entry in source) { var rank = 0; if (!string.IsNullOrWhiteSpace(entry.Email)) { rank += Regex.Matches(entry.Email.ToLowerInvariant(), regex).Count; } if (rank &gt; 0) { yield return entry; } } }</code> <br> <br>      .  regex  .   ,      Email  . <br> <br>   : <br>     , , ¬´cher [2]¬ª,   ,  ¬´cher 2¬ª.  regex = (cher|2).   ,   <code>IQueryable</code> <br>   ,     IEnumerable - yield return entry <br></code> </li> <li> <code><code class="cs"> IQueryable,   ,      (/Global/SearchEngine.cs): <br>  ,      ,       [,], {,}, (,): <br> /// &lt;summary&gt; /// The regex strip html. /// &lt;/summary&gt; private static readonly Regex RegexStripHtml = new Regex("&lt;[^&gt;]*&gt;", RegexOptions.Compiled); private static string StripHtml(string html) { return string.IsNullOrWhiteSpace(html) ? string.Empty : RegexStripHtml.Replace(html, string.Empty).Trim(); } private static string CleanContent(string content, bool removeHtml) { if (removeHtml) { content = StripHtml(content); } content = content.Replace("\\", string.Empty). Replace("|", string.Empty). Replace("(", string.Empty). Replace(")", string.Empty). Replace("[", string.Empty). Replace("]", string.Empty). Replace("*", string.Empty). Replace("?", string.Empty). Replace("}", string.Empty). Replace("{", string.Empty). Replace("^", string.Empty). Replace("+", string.Empty); var words = content.Split(new[] { ' ', '\n', '\r' }, StringSplitOptions.RemoveEmptyEntries); var sb = new StringBuilder(); foreach (var word in words.Select(t =&gt; t.ToLowerInvariant().Trim()).Where(word =&gt; word.Length &gt; 1)) { sb.AppendFormat("{0} ", word); } return sb.ToString(); }</code> <br> <br>  : <br> <code class="cs">public static IEnumerable&lt;User&gt; Search(string searchString, IQueryable&lt;User&gt; source) { var term = CleanContent(searchString.ToLowerInvariant().Trim(), false); var terms = term.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries); var regex = string.Format(CultureInfo.InvariantCulture, "({0})", string.Join("|", terms)); foreach (var entry in source) { var rank = 0; if (!string.IsNullOrWhiteSpace(entry.Email)) { rank += Regex.Matches(entry.Email.ToLowerInvariant(), regex).Count; } if (rank &gt; 0) { yield return entry; } } }</code> <br> <br>      .  regex  .   ,      Email  . <br> <br>   : <br>     , , ¬´cher [2]¬ª,   ,  ¬´cher 2¬ª.  regex = (cher|2).   ,   <code>IQueryable</code> <br>   ,     IEnumerable - yield return entry <br></code> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/176063/">https://habr.com/ru/post/176063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../176049/index.html">Remote course on Unity and Modo from render.ru</a></li>
<li><a href="../176053/index.html">ASP.NET MVC Lesson 7. Bootstrap, jQuery, Ajax</a></li>
<li><a href="../176055/index.html">HITB 2013: New Operational Features and UEFI-bootkits</a></li>
<li><a href="../176057/index.html">Metric # 3 - Podcast on technologies and design of interfaces and services</a></li>
<li><a href="../176059/index.html">Classification of selling videos about IT products</a></li>
<li><a href="../176067/index.html">Easy customizable python daemon</a></li>
<li><a href="../176069/index.html">ASP.NET MVC Lesson 9. Configuration and File Upload</a></li>
<li><a href="../176071/index.html">How we searched for the first users and what Artemy Lebedev was wrong about</a></li>
<li><a href="../176073/index.html">Thoughts on the future of computer games</a></li>
<li><a href="../176075/index.html">ASP.NET MVC Lesson A. Notification and Distribution</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>