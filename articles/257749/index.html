<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PhoneGap for iOS and Android application development infrastructure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I will tell you about our experience in developing cross-platform mobile applications based on PhoneGap / Cordova. The project uses technologies...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PhoneGap for iOS and Android application development infrastructure</h1><div class="post__text post__text-html js-mediator-article">  Today I will tell you about our experience in developing cross-platform mobile applications based on PhoneGap / Cordova.  The project uses technologies such as HTML5, CSS3 and Angular.js.  <a href="http://gruntjs.com/">Grunt</a> is used as a task manager to simplify and speed up the execution of routine tasks.  All builds are compiled locally during the development process. <br><br><img src="https://habrastorage.org/files/43a/435/9de/43a4359de2bd4b958a5d9df58595d8e9.png"><br>  Source: build.phonegap.com <br><br>  When the version is ready for the testing phase, it is compiled using <a href="https://build.phonegap.com/apps">PhoneGap Build</a> and uploaded to <a href="http://ubertesters.com/">Ubertesters</a> , a mobile application distribution service that allows you to test quickly and efficiently on all connected devices.  The app supports minimum iOS 6 and Android 4.1 (87.5% <a href="https://developer.android.com/about/dashboards/index.html">market share</a> ). <br><a name="habracut"></a><br><h4>  <b>Setting up a local assembly and project structure</b> </h4><br>  To test the application locally, you need to install tools for PhoneGap / Cordova.  It is important to make sure <a href="https://nodejs.org/">NodeJS is</a> already installed, open a command prompt or Cygwin and do the following: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">npm install -g phonegap</code> </pre> <br>  After the installation is complete, an empty project can be created and compiled for the required platform: <br><br><pre> <code class="bash hljs">phonegap create my-app <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> my-app phonegap platform add android phonegap run android</code> </pre><br>  Note: phonegap = cordova.  You can use cordova instead of phonegap when writing commands: <br><br><pre> <code class="bash hljs">cordova run android</code> </pre><br>  The build for iOS can only be done under Mac OS X (according to the terms of the Apple license agreement), there is no way to run the build for iOS under Windows. <br><br>  The Android platform requires the SDK Tools; you can download it via the <a href="http://developer.android.com/sdk/index.html">link</a> (SDK Tools Only at the bottom of the page).  Immediately after installation, you need to check in the Android SDK Manager that Android 5.0 (API level 21) was installed successfully.  Android 5.0 is used as the target for the current version of Phonegap / Cordova in a local build. <br><br><h4>  <b>Application structure</b> </h4><br><h5>  Files and folders </h5><br>  ‚Ä¢ platforms - includes a separate code for each of the used platforms, compiles each time the build is performed; <br>  ‚Ä¢ plugins are plugins used in the application.  Plugins are described in more detail below; <br>  ‚Ä¢ www - HTML5 based web application / Angular.js, PhoneGap / Cordova displays using the Web View system component; <br>  ‚Ä¢ config.xml - the file must be located in the root folder of the project during the local assembly.  PhoneGap Build requires a config.xml file in / www.  The settings file is an important part of the PhoneGap-based project.  It includes links to application resources, sets the necessary permissions and adjusts parameters for each of the platforms (for example, the status bar behavior).  Application (bundle) id and publisher information must also be specified in config.xml. <br><br><h4>  <b>Plugins</b> </h4><br>  <a href="http://docs.phonegap.com/en/4.0.0/guide_hybrid_plugins_index.md.html">A plugin</a> is a package that allows you to automatically inject native code into an application and manage native methods from Cordova Web View.  All the basic functions of the PhoneGap / Cordova API are implemented using plug-ins that provide access to device and platform features and functions that are not available to a regular web application: QR code scanning, NFC, Push notifications, and even Touch ID for iOS. <br><br>  There is a <a href="https://build.phonegap.com/plugins">registry of</a> PhoneGap plugins.  It is very important to use plug-ins compatible with the PhoneGap Build, otherwise assembly will be possible only locally. <br>  To add a plug-in to a project during a local build, use the plugin add command from the project's root folder.  The argument to this command is the URL of the Git repository containing the plugin code: <br><br><pre> <code class="bash hljs">cordova plugin add https://github.com/phonegap-build/PushPlugin.git</code> </pre><br>  PhoneGap Build requires specifying an id in the config.xml file for each plug-in (something like dependencies).  It is not necessary to indicate a specific version, but it is desirable, since different assemblies of the plug-in may be incompatible, and you will have to find out for a long time the reason for the sudden errors.  <a href="https://build.phonegap.com/plugins/1199">Example</a> from the plugin page: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gap:plugin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.phonegap.plugins.pushplugin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2.4.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  Relevant .js files must be imported on the HTML page: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PushNotification.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  All plugins usually have documentation (though not always detailed) on GitHub. <br>  Since we are using the Angular.js framework, and not pure JavaScript, an additional component is required to wrap plugins.  It is called ngCordova. <br><br><h5>  ngCordova </h5><br>  <a href="http://ngcordova.com/">ngCordova</a> is a collection of more than 60 Angular.js extensions based on the Cordova API, which allows you to simplify the creation, testing and building of mobile applications PhoneGap / Cordova.  The project is supported and developed by the <a href="http://ionic.io/">Ionic Framework</a> team.  ngCordova provides simple Angular.js wrappers for the most popular and frequently used PhoneGap / Cordova plug-ins and allows you to take a photo, scan a QR code, upload a file, turn on the flash, get the current location, and much more with a few lines of code. <br><br>  For the local assembly, it is still necessary to add a plugin with the command: <br><br><pre> <code class="bash hljs">cordova plugin add https://github.com/phonegap-build/PushPlugin.git</code> </pre><br>  PhoneGap Build requires a link to the plugin id in config.xml: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gap:plugin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.phonegap.plugins.pushplugin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2.4.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  ng-cordova.js is imported from the ngCordova <a href="">package</a> , the script tag must be located after importing angular.js, otherwise errors will appear that are not related to the project: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"scripts/angular.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"scripts/ng-cordova.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  It is important to remember to add the ngCordova dependency to the module: <br><br><pre> <code class="javascript hljs">angular.module(<span class="hljs-string"><span class="hljs-string">'application'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'ngCordova'</span></span> ])</code> </pre><br>  Each ngCordova wrapper has its own <a href="http://ngcordova.com/docs/plugins/">documentation</a> .  Plugin for Push notifications and QR scanner were used and tested in our project.  The QR code scanner (Barcode Scanner) was integrated without any problems, you can even say "out-of-the-box", but the Push plug-in setup took quite a long time due to the lack of documentation - I had to gather information while viewing the huge list of issues on GitHub 'e. <br><br><h5>  Push notifications for Android (Google Cloud Messaging) </h5><br>  Brief documentation is available on <a href="http://ngcordova.com/docs/plugins/pushNotifications/">the</a> ngCordova <a href="http://ngcordova.com/docs/plugins/pushNotifications/">plugin</a> page. <br><br>  Important!  Payload part of the push notification sent from the server must follow a certain format, otherwise there may be problems with the automatic appearance of notifications in the system tray. <br><br>  It was found that the data object must have a ‚Äúmessage‚Äù field (as notification text) and a ‚Äútitle‚Äù (if absent, the notification title will be empty).  The ‚Äúuri‚Äù field is necessary in order to specify the action that is performed when the notification is opened. <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"data"</span></span>: { <span class="hljs-string"><span class="hljs-string">"message"</span></span>: <span class="hljs-string"><span class="hljs-string">"New message. You have 5 unread messages"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Your Application"</span></span>, <span class="hljs-string"><span class="hljs-string">"uri"</span></span>: <span class="hljs-string"><span class="hljs-string">"http://www.yourapp.com/messages"</span></span> } }</code> </pre><br>  It is also important to note that the notificationReceived listener is triggered when the application is in the foreground, as well as in the case when the user opens the notification (transition from background to foreground).  Push notifications appear automatically in the background and continue to arrive even after rebooting the system. <br><br><div class="spoiler">  <b class="spoiler_title">Uri can be obtained in the condition 'message' of the structure of the switch case listener.</b> <div class="spoiler_text"><pre> <code class="javascript hljs">$rootScope.$on(<span class="hljs-string"><span class="hljs-string">'$cordovaPush:notificationReceived'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event, notification</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(notification); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (notification.event) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'registered'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (notification.regid.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { registerOnServer(notification.regid); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'message'</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'message!'</span></span>); utils.goToApiUrl(notification.payload.uri); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'error'</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'GCM error: '</span></span> + notification.msg); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'An unknown GCM event has occurred: '</span></span> + notification.event); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } });</code> </pre><br></div></div><br><h5>  Push notifications on iOS </h5><br>  Brief documentation is available on <a href="http://ngcordova.com/docs/plugins/pushNotifications/">the</a> ngCordova <a href="http://ngcordova.com/docs/plugins/pushNotifications/">plugin</a> page. <br><br>  At the moment when the application was developed, the part of the backend that is responsible for sending Apple Push notifications (APNS) was not ready.  We decided to use a temporary solution for testing and debugging.  <a href="https://www.npmjs.com/package/node-pushserver">Node Push Server</a> was selected initially (as there were recommendations in some Phonegap / Cordova manuals), but during testing it turned out that it lacks support for custom fields for Push notifications on iOS (only badge, alert and sound are supported , and we need to transfer uri to open a certain page) and because of problems with the format it does not work correctly on iOS 6 and iOS 7 (the counter on the icon is not displayed). <br><br>  There are several common solutions on the market, but we chose the Parse.com platform for our test notifications on iOS, because  Free Plan conditions are sufficient for the development and testing process. <br>  To set up notifications: first you need to register and go to the settings, ‚ÄúSettings‚Äù section, then go to the ‚ÄúPush‚Äù section in order to enable the processing of push notifications and download the required <a href="http://appfurnace.com/2015/01/how-do-i-make-a-p12-file/">certificate</a> (* .p12).  You can learn more about how Apple Push Notification Service works <a href="https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Chapters/ApplePushService.html">here</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Sample code based on ngCordova documentation</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerInCordova</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> iosConfig = { <span class="hljs-string"><span class="hljs-string">"badge"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"sound"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"alert"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> authHeader = { <span class="hljs-attr"><span class="hljs-attr">headers</span></span>: { <span class="hljs-string"><span class="hljs-string">'X-Parse-Application-Id'</span></span>: <span class="hljs-string"><span class="hljs-string">'YOUR_APPLICATION_ID'</span></span>, <span class="hljs-string"><span class="hljs-string">'X-Parse-REST-API-Key'</span></span>: <span class="hljs-string"><span class="hljs-string">'YOUR_REST_API_KEY'</span></span>, <span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>: <span class="hljs-string"><span class="hljs-string">'application/json'</span></span> } }; $cordovaPush.register(iosConfig).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">deviceToken</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Success -- send deviceToken to server, and store for future use console.log("deviceToken: " + deviceToken); $http.post("https://api.parse.com/1/installations", { "deviceType": "ios", "deviceToken": deviceToken, "channels": ["ALL"] }); }, function(err) { console.log("Registration error: " + err); }); } &lt;/spoiler&gt;     'YOUR_APPLICATION_ID'  'YOUR_REST_API_KEY'     ‚ÄúSettings‚Äù -&gt; ‚ÄúKeys‚Äù.  listener' ,     foreground    background'  foreground (   push ). &lt;spoiler title=" listener'"&gt; &lt;source lang="javascript"&gt; function registerForegroundListener() { $rootScope.$on('$cordovaPush:notificationReceived', function(event, notification) { console.log("Notification: " + JSON.stringify(notification)); if (notification.sound) { var snd = new Media(event.sound); snd.play(); } if (notification.badge) { $cordovaPush.setBadgeNumber(notification.badge).then(function(result) { console.log("Badge set successfully"); }, function(err) { console.log("Error on badge setting: " + err); }); } if (notification.uri) { utils.goToApiUrl(notification.uri); } }); }</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">To send Push notifications via Parse.com to all registered devices, you must perform an HTTP POST request</b> <div class="spoiler_text"><pre> <code class="bash hljs">curl -X POST \ -H <span class="hljs-string"><span class="hljs-string">"X-Parse-Application-Id: YOUR_APPLICATION_ID"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"X-Parse-REST-API-Key: YOUR_API_KEY"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">'{ "channels": [ "" ], "data": { "alert": "New Messages", "badge": 3, "uri": "api/messages" } }'</span></span> \ https://api.parse.com/1/push</code> </pre><br></div></div><br><h4>  <b>Phonegap build</b> </h4><br>  - What is PhoneGap Build? <br>  PhoneGap Build is a free cloud service built on the basis of PhoneGap / Cordova, which allows you to build cross-platform mobile applications. <br><br>  - Why do we need PhoneGap Build? <br>  PhoneGap Build allows you to build for iOS, Android and Windows Phone at the same time, without having to install any SDK tools (of course, there is a share of cunning in this - it‚Äôs still better to build the build locally, at least on Android, before sending it for testing) .  But more importantly, this service allows you to build for iOS in the cloud without a Mac. <br><br>  PhoneGap Build has its own <a href="http://docs.build.phonegap.com/en_US/3.3.0/developer_api_api.md.html">REST API</a> , which can be used to automate the creation and updating of projects, run the build under iOS, Android and Windows Phone (you can choose the platform).  If you use GitHub, it is possible to configure the service for automatic assembly after each commit in the repository.  The REST API allows you to authorize each HTTP request to the server using a token, rather than passing the username and password in the header. <br><br>  To use PhoneGap Build, you need to make settings: <br>  - After registration, go to the "create new app".  It is necessary to download the zipped contents of the www, config.xml folder should be inside.  Access to private GitHub repositories is available only in the paid version of the account). <br>  - Next, go to the account settings: click on the icon in the right corner, ‚ÄúEdit account‚Äù -&gt; ‚ÄúSigning keys‚Äù, add the required certificates and keys (the build for iOS will be interrupted if there is no certificate * .p12 and profile, the build for Android will be completed in AdHoc mode, if the key is missing). <br><br>  After the installation packages for all the required platforms are generated using PhoneGap Build, you can manually upload them to the distribution service.  There are many alternatives: HockeyApp, TestFlight, TestFairy, but then we will look at Ubertesters and learn how to automate the assembly and distribution with the ability to integrate the Ubertesters Upload API. <br><br><h4>  <b>Ubertesters</b> </h4><br>  - Why Ubertesters? <br>  The features and benefits of this service are discussed in <a href="http://habrahabr.ru/company/arcadia/blog/254631/">this article</a> . <br><br>  Ubertesters provides an SDK for all major platforms (even Phonegap / Cordova).  Upload API, as already mentioned, allows you to use continuous integration and automate distribution. <br><br>  To open access to the Upload API, go to the <a href="http://beta.ubertesters.com/profile/api_access">profile</a> page. <br>  Documentation is available <a href="http://ubertesters.com/upload-api/">here</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Installation packages (ipa / apk) can be downloaded using curl</b> <div class="spoiler_text"><pre> <code class="bash hljs">curl -X POST http://beta.ubertesters.com/api/client/upload_build.json -H <span class="hljs-string"><span class="hljs-string">"X-UbertestersApiKey:PERSONAL_API_KEY"</span></span> -F <span class="hljs-string"><span class="hljs-string">"file=@upload.ipa"</span></span> -F <span class="hljs-string"><span class="hljs-string">"title=build title"</span></span> -F <span class="hljs-string"><span class="hljs-string">"notes=build notes"</span></span> -F <span class="hljs-string"><span class="hljs-string">"status=in_progress"</span></span> -F <span class="hljs-string"><span class="hljs-string">"stop_previous=true"</span></span></code> </pre></div></div><br>  To allow automatic distribution of testers and developers teams to devices, you need to create a default distribution group: ‚ÄúAdministration‚Äù -&gt; ‚ÄúDistribution Groups‚Äù -&gt; ‚ÄúAdd distribution group‚Äù, select the ‚ÄúDefault group‚Äù checkbox.  Since in our case 2 platforms are supported, you need to remember to perform the operation for each of the projects (iOS and Android). <br><br><h4>  <b>Task automation</b> </h4><br>  There are several ways to automate the build process for applications on PhoneGap / Cordova.  <a href="http://gruntjs.com/">Grunt</a> , <a href="http://ant.apache.org/">Ant</a> , <a href="http://maven.apache.org/">Maven</a> can be used as a task manager and as a medium for continuous integration <a href="http://jenkins-ci.org/">Jenkins CI</a> or <a href="https://www.jetbrains.com/teamcity/">Team City</a> . <br><br><h5>  Grunt configuration </h5><br>  Grunt requires two files: package.json (it defines dependencies and basic settings) and gruntfile.js (task configuration). <br>  First you need to install grunt-cli: <br><br><pre> <code class="bash hljs">npm install -g grunt-cli</code> </pre><br><div class="spoiler">  <b class="spoiler_title">You can use the following settings for package.json</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Your application"</span></span>, <span class="hljs-string"><span class="hljs-string">"version"</span></span>:<span class="hljs-string"><span class="hljs-string">"1.0.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Your App"</span></span>, <span class="hljs-string"><span class="hljs-string">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"index.html"</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"licenses"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"devDependencies"</span></span>: { <span class="hljs-string"><span class="hljs-string">"form-data"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.2.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"fs"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.0.2"</span></span>, <span class="hljs-string"><span class="hljs-string">"grunt"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.4.5"</span></span>, <span class="hljs-string"><span class="hljs-string">"grunt-contrib-compress"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.9.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"grunt-http"</span></span>: <span class="hljs-string"><span class="hljs-string">"^1.6.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"grunt-magikarp"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.2.5"</span></span>, <span class="hljs-string"><span class="hljs-string">"grunt-modify-json"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.1.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"grunt-xmlpoke"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.8.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"needle"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"read"</span></span>: <span class="hljs-string"><span class="hljs-string">"~1.0.4"</span></span> } }</code> </pre></div></div><br>  Dependencies specified in package.json can be satisfied using npm install <br>  All necessary modules will be installed in / node_modules <br>  But you also need to install grunt-phonegap-build manually: <br><br><pre> <code class="bash hljs">npm install grunt-phonegap-build</code> </pre><br>  A <a href="">sample of Gruntfile.js</a> is available on Dropbox: <br><br>  Several parameters need to be set before use: <br><ul><li>  var PHONEGAP_API_ID = "YOUR_PHONEGAP_API_ID"; </li><li>  var PHONEGAP_TOKEN = "YOUR_PHONEGAP_TOKEN"; </li><li>  var UBERTESTERS_API_KEY = "YOUR_UBERTESTERS_API_KEY"; </li><li>  In the phonegap-build task configuration, the password for the iOS certificate must be specified. </li></ul><br>  Next, we will look at all the Grunt task manager tasks used in the project in the order in which they are used in the script. <br><br><h5>  Grunt Task List </h5><br><h6>  1) <b>http: phonegap_build_version</b> </h6><br>  We get the current version from the PhoneGap Build service using an HTTP GET request: <br><br><pre> <code class="html hljs xml">http://build.phonegap.com/api/v1/apps/' + PHONEGAP_API_ID + '?auth_token=' + PHONEGAP_TOKEN</code> </pre><br>  Methods and documentation PhoneGap Build Read API available on the <a href="http://docs.build.phonegap.com/en_US/developer_api_read.md.html">link</a> . <br><br><h6>  2) <b>readCurrentVersion</b> </h6><br>  The result of http: phonegap_build_version is returned in JSON format and saved to the specified path: <br><br><pre> <code class="html hljs xml">ubertesters_response/phonegap_app.json</code> </pre><br>  At the moment, the script has a bug: phonegap_app.json must be created manually before launch (you can simply create an empty JSON file).  The current version is passed as a parameter to modify_json. <br><br><h6>  3) <b>modify_json</b> </h6><br>  Updates the value of the current version in package.json. <br><br><h6>  4) <b>magikarp</b> </h6><br>  Magikarp increments the current version in package.json.  Options available: major, minor and build. <br><br><h6>  5) <b>readNextVersion</b> </h6><br>  The incremented version from package.json is passed to xmlpoke. <br><br><h6>  6) <b>xmlpoke</b> </h6><br>  Changes the version in www / config.xml. <br><br><h6>  7) <b>compress</b> </h6><br>  Compresses the contents of the www folder (not the folder itself, this is important!), Excluding unnecessary files.  The compressed zip file is saved to the specified target / phonegapp.zip path. <br><br><h6>  8) <b>phonegap-build: debug</b> </h6><br>  At the moment, debug and release are no different (release key is not yet generated for Android).  The compressed zip file is sent to the PhoneGap Build service.  The task is completed only after the build (ios / android) and save the installation packages (ipa / apk). <br>  Methods and documentation PhoneGap Build Write API methods are available <a href="http://docs.build.phonegap.com/en_US/developer_api_write.md.html">here</a> . <br><br><h6>  9) <b>http: ubertesters_ios</b> </h6><br>  This task uploads the ipa assembly to Ubertesters using the Upload API.  Here you can use any mobile application distribution service if it has a REST API. <br><br><h6>  10) <b>http: ubertesters_android</b> </h6><br>  The same task, but for Android apk. <br><br><h6>  11) <b>PROFIT!</b> </h6><br>  Grunt is started locally using the 'grunt' command or on a configured build server (TeamCity in our case).  It is also possible to customize TeamCity to trigger the build and distribution process at every commit. <br><br>  So you can save a lot of time, using the integration integration when building and testing mobile applications. <br><br><h4>  useful links </h4><br>  <a href="http://www.tricedesigns.com/2014/01/17/automating-phonegap-builds/">Automating PhoneGap builds</a> <br>  <a href="http://habrahabr.ru/company/arcadia/blog/254631/">Mobile App Distribution Services for iOS.</a>  <a href="http://habrahabr.ru/company/arcadia/blog/254631/">Part 3: Ubertesters</a> </div><p>Source: <a href="https://habr.com/ru/post/257749/">https://habr.com/ru/post/257749/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../257739/index.html">Crying engineer</a></li>
<li><a href="../257741/index.html">The winner of the competition - "Kubotronic"</a></li>
<li><a href="../257743/index.html">Glitter and poverty of standard selects</a></li>
<li><a href="../257745/index.html">This is not forgotten - Oracle Database In-Memory</a></li>
<li><a href="../257747/index.html">Super-fast start with Arduino: you take and do</a></li>
<li><a href="../257751/index.html">Is it possible to combine unit tests and memory profiling?</a></li>
<li><a href="../257753/index.html">Forward to victory: PHDays V competition program published</a></li>
<li><a href="../257757/index.html">Solving the picture from the Intel company Twitter</a></li>
<li><a href="../257761/index.html">SAP HANA Cloud Platform: Download and Store Data</a></li>
<li><a href="../257763/index.html">Generating a QR code in the format of a machine embroidery file Tajima DST</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>