<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>TLS Logjam - FREAK with DH vulnerability</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Researchers from CNRS, Inria Nancy-Grand Est, Inria Paris-Rocquencourt, Microsoft Research, Johns Hopkins University, University of Michigan and Unive...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>TLS Logjam - FREAK with DH vulnerability</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/b20/235/ce2/b20235ce2a23b32dd7d204dae9d7f020.png" alt="image"><br><br>  Researchers from CNRS, Inria Nancy-Grand Est, Inria Paris-Rocquencourt, Microsoft Research, Johns Hopkins University, University of Michigan and University of Pennsylvania discovered a new TLS vulnerability, similar to <a href="http://habrahabr.ru/company/dsec/blog/252165/">FREAK</a> , but more dangerous and applicable in real life - Logjam.  In the case of Logjam, the attack is made on session keys, which are set during the exchange of the Diffie-Hellman protocol, in order to lower their cryptographic strength to 512-bit.  Such keys, as shown by FREAK researchers, can be cracked in a few hours, but the situation here is somewhat different: because a lot of (outdated) software uses publicly available static DH groups and the same predefined initial primes, there is a possibility preliminary execution of the discrete logarithm by the sieve method of the numerical field to a certain state, which allows quickly, within 2 minutes, to crack the session key of the DH group for which this calculation was made. <br><br>  Scientists made a preliminary calculation for two popular export DH-groups: the first group is used in Apache in versions 2.1.5-2.4.7 and is found on 7% of sites from TOP 1M according to Alexa, and the second is protected in OpenSSL, even when it was called SSLeay in 1995.  The calculation took a week for each group, and it was carried out using a modified version of <a href="http://cado-nfs.gforge.inria.fr/">CADO-NFS</a> . <br>  According to the researchers, a preliminary calculation of these two groups allows hacking up to 80% of encrypted connections on servers that support export DH-keys.  Three methods of attack were proposed and demonstrated on video: <br><ul><li>  Offline decryption of weak connections for servers using 512-bit DH keys by default, with passive listening to traffic </li><li>  Reducing the durability of keys to 512-bit using TLS False Start, by MiTM-substitution of data about type DH sent to the server </li><li>  Reducing the durability of keys to 512-bit by MiTM-substitution of data on the type DH sent to the server, and suspension of the connection until the keys are cracked </li></ul><a name="habracut"></a><br>  Consider each of the methods in more detail.  The first method is applicable only to those servers that use default 512-bit DH groups.  There are very few such servers, but they do not need to perform a man-in-the-middle attack, but rather passively record traffic.  After breaking the key, the traffic can be decrypted. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The second method exploits the TLS False Start feature - a special TLS-handshake acceleration mechanism, with which the client sends data even before the end of the hend-tail (Server Finished).  By performing a man-in-the-middle attack, an attacker can override the client‚Äôs request to use DHE_EXPORT instead of DHE, the server will give the parameters for the 512-bit DH group and the public DH key of the server (g ^ b), the attacker will return the server‚Äôs response with this data to the client and the record that this is DHE, as he requested.  Due to the fact that the standard does not prohibit the use of 512 keys in the non-export version, the client does not see the substitution until the request data is sent (the hash will not converge only at the moment when the server sends Server Finished, but the client request has already gone ). <br><br><img src="https://weakdh.org/i/falseStart.svg" alt="image"><br><br>  The third type of attack is based on the suspension of the TLS handshake for the time it takes to crack the session key (according to the researchers, up to 10 minutes with a preliminary calculation).  It also requires running MiTM and replacing DHE with DHE_EXPORT and back, but does not require support for TLS Fast Start.  Here‚Äôs how it happens: <br><br><img src="https://weakdh.org/i/dhead.svg" alt="image"><br><br><ol><li>  The client connects to <a href="http://www.tcl.tk/">www.tcl.tk</a> and offers at least one cipher suite that includes DHE, but does not include DHE_EXPORT. </li><li>  The attacker intercepts the request and modifies by sending to the server a cipher suite consisting only of DHE_EXPORT </li><li>  Server chooses DHE_EXPORT </li><li>  The attacker modifies the server's response, replacing the DHE_EXPORT with one of the non-export DHE options offered by the client </li><li>  The server sends key parameters with a 512-bit basis. </li><li>  The hacker begins to crack the key - to calculate the discrete logarithm, and breaks the connection to the server </li><li>  The client waits for the hacker to crack the key and send him a confirmation of the server </li><li>  As soon as the attacker hacks the key, he gets a master secret - a key for symmetric encryption, and sends a confirmation to the client. </li><li>  The client confirms the data from the server and sends a request.  An attacker could respond to client requests. </li></ol><br>  The researchers note that attackers with a lot of powerful equipment are able to recover 768-bit keys, and special services can recover 1024-bit keys, which are often used in IPsec IKEv1. <br><br>  Vulnerability exists in all popular browsers and in almost all popular server software.  The vulnerability <a href="https://weakdh.org/">site</a> describes the process of generating more persistent Diffie-Hellman groups, as well as the necessary TLS settings for Apache httpd, nginx, Microsoft IIS, Lighttpd, Apache Tomcat, Postfix, Sendmail, Dovecot and HAProxy.  On the same page the server configuration checker is available. <br><br>  Scientists report that 8.4% of sites from the Alexa Alexa top million are affected, and 17.9% of sites use 1024-bit keys.  Vulnerability can also be applied on mail servers in IMAPS (8.4%), POP3S (8.9%) and STARTTLS (14.8%) protocols.  In addition, the vulnerability can be exploited in not the latest versions of OpenSSH. <br><br>  <a href="https://weakdh.org/">Vulnerability site</a> <br>  <a href="https://weakdh.org/imperfect-forward-secrecy.pdf">PDF with a detailed description of the vulnerability</a> <br>  <a href="https://weakdh.org/sysadmin.html">Server configuration and validation check</a> <br>  <a href="https://blog.cloudflare.com/logjam-the-latest-tls-vulnerability-explained/">Description of vulnerability to CloudFlare</a> <br>  <a href="https://nohats.ca/wordpress/blog/2015/05/20/weakdh-and-ike-ipsec/">Clarification of the situation with IPsec from the developer Libreswan</a> </div><p>Source: <a href="https://habr.com/ru/post/258457/">https://habr.com/ru/post/258457/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258443/index.html">Kubernetes Basics</a></li>
<li><a href="../258445/index.html">Keeping recordings of conversations in mp3 in FreePBX / Asterisk</a></li>
<li><a href="../258447/index.html">We manage AB400S Wireless Switch socket without remote control</a></li>
<li><a href="../258449/index.html">How I hacked Starbucks for unlimited coffee</a></li>
<li><a href="../258451/index.html">Two opposite directions VIDEO ANALYTICS: "hard" and "flexible", who is stronger?</a></li>
<li><a href="../258459/index.html">Subscribe to 72 well-known PHP developers with one click</a></li>
<li><a href="../258461/index.html">Logjam - new TLS vulnerability</a></li>
<li><a href="../258463/index.html">Numerical characteristics of online games</a></li>
<li><a href="../258465/index.html">Amazon builds a 150 MW wind power station to provide its DC with "green" energy</a></li>
<li><a href="../258467/index.html">We program microcontrollers in QtCreator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>