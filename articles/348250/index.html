<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As I accelerated the work of the sales department more than 20 times</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you are familiar with the situation when you need to process a request from a client with a size of 150 or more positions, selecting the best price...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As I accelerated the work of the sales department more than 20 times</h1><div class="post__text post__text-html js-mediator-article">  If you are familiar with the situation when you need to process a request from a client with a size of 150 or more positions, selecting the best price for each of the 20 price lists of 10,000 + positions in each, but you are not ready to spend more than 30 minutes on this, then welcome welcome under cat. <br><a name="habracut"></a><br>  Imagine the following situation: you work in the sales department and you receive an application for 150+ positions of any products from more or less similar categories (for example, metal-cutting tools). <br><br>  Most likely, you already have a dozen other price lists from your suppliers, each of which may have 10,000+ items, and of course you want to give the customer the most competitive offer. <br><br>  It will be quite logical to assume that with very high probability, the same product from different suppliers may cost differently, and another product may be generally only from one supplier. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It turns out that in order to make the best offer to the client, you should search for each position consistently from all suppliers on a number of criteria (for example, find the cheapest offer or offer with the right amount in stock). <br><br>  But there is one nuance - since all price lists are different people, in almost 80% of cases they will call the same product at least a little, but in different ways. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f9/4df/045/8f94df0459f91b802b716f8108f92aa3.png" alt="image"><br>  <i>Figure 1 - Different variants of the names</i> <br><br>  So, if each product is not assigned its own unique and generally accepted identifier in all price lists and in all requests from customers, then just use the CRF function and even the Lookup, unfortunately will not work, and you, no matter how sad it would be, will have to do a long and not very interesting work, which can be delayed for a day, and maybe for all two. <br><br><h3>  Start </h3><br>  When I came to work in the sales department of one Russian manufacturer of metal-cutting tools, it turned out that such applications do not come once a day and the sooner the client gets an answer, the higher the likelihood that the sale will occur. <br><br>  And to me, as a newcomer, they bring a pack of A4 sheets on which an application of 1000+ positions is printed out in 11 fonts, and the prices are signed with a pen (!).  Yes, about each indicated with or without VAT. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0t/fl/xg/0tflxgbiasd260ltq5tjii6tuks.jpeg"></div><br>  As I was told, the most difficult things have already been done for me, so it only remains to transfer 1000+ prices to an electronic form without errors and to invoice. <br><br>  Indeed, ‚ÄúNot at all difficult!‚Äù - I thought, and began to hit the keys of the numpad. <br><br>  After 25 minutes of monotonous work and gazing is not always clear, in this case - the female handwriting, I suddenly thought: ‚ÄúSomething is wrong here.  So it definitely shouldn't be! ‚Äù <br><br>  To understand why this should not be, and how it should be in fact, I decided to look at the whole process step by step, and asking my colleagues, I learned how it all works: <br><br><ol><li>  The application comes by mail, usually in .xls format. </li><li>  It is printed and given to the supply department. </li><li>  There, a lovely girl studies him carefully, opens the necessary price lists on the monitor and begins to select. <br><br>  She knows about what and in what price lists to look for and where it is most likely cheaper, but no matter how well she was not oriented in all this, for more than 10 years of experience she would not have been able to memorize even hundreds of prices for the most popular positions, at least because they change at least once a year. </li><li>  After a couple of days, and sometimes weeks, the completed table falls into the hands of a sales manager, that is, into mine.  And the work that I have just been doing begins. </li><li>  I issue an invoice, I am glad to call the customer to inform about it, and he responds to me: <br>  ‚ÄúThank you very much for the offer, but I already paid the invoice that another company issued to me two days ago.‚Äù </li></ol><br>  Worse than words you can imagine.  It‚Äôs good that my colleague from the supply department didn‚Äôt hear - I thought, and I began to think how to arrange this process so that the eyes and hands of two people could not be erased before the mazol, even with zero result in the end. <br><br>  The next application I was given to process already myself.  I did the same thing as my colleague, but I did not print the spreadsheet, but opened it in the left half of the screen, placing three price lists in the right half. <br><br>  Starting from the first position, I found it in all three prices and copied the cell with the best price in the column to the right.  After repeating the action n times, I got the feeling that I know how to do this work a hundred times faster! <br><br><h3>  Decision </h3><br>  I thought - You just need to reduce all the price lists into one big table, and right away bring the best price to the cell to the right of the position request, and bring the name of the position with the best price to the right to check. <br><br>  Fine!  That same evening, I set to work. <br><br>  The whole problem was to explain to the system which position is suitable and which is not ... <br><br>  At this point, I had the experience of creating a system on pure formulas in Excel, which takes the names of garments in English and translates them into similar names in Russian. <br><br>  It defines the category, color, gender, brand, etc.  and it works like this: if the name has the word hat, then the Russian name has the word ‚Äúhat‚Äù, then if there is yellow or yell (some wrote this way), we get the name ‚Äúyellow hat‚Äù, the same with the rest of the words and as a result we get the name - ‚ÄúYellow Ski-doo men's hat‚Äù. <br><br>  The same is done with the description, and then downloaded to the online store.  Thus, I processed thousands of products with 90% accuracy.  Based on this, I began work on a new system. <br><br>  The first thing I needed was a category definition, for example, if the name contains ‚ÄúDrill‚Äù or ‚Äùdrills‚Äù, then the category ‚ÄúDrill‚Äù is assigned, and then the definition of its parameters begins. <br><br>  If the word ‚ÄúDrill‚Äù was most often written in one of 5 options (Drill, drill, drill, drill., Drill), then everyone wrote the parameters of this drill to the best of their competence, as in Figure 1. <br><br>  The next and most difficult step is to define and bring to one kind these categories for each position. <br><br>  I decided to do this with regular expressions.  But how to write an expression that will cover the maximum variation of the recording characteristics?  Of course, one expression is indispensable, and in order to speed up the work, it is necessary to understand which characterization description structures are used most often, and cover them first. <br><br>  Since I knew that I would have to do the same for a dozen other categories, I decided to automate it immediately and took up the system for identifying the most frequently used templates in the product description. <br><br>  This draws on a separate article, so I will immediately describe what happened: <br>  10 regular expressions that define from 1 to 5 digital parameters. <br>  3 expressions defining GOST. <br><br>  The remaining parameters, such as the metal grade or the shape of the shank, were determined by a simple condition for the content of the text in the title. <br><br>  The result was 10 characteristics. <br><br>  I immediately conducted the first test, on drills and everything worked!  I received a ready list with a typical description of all items in the price lists. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a00/85e/392/a0085e3921104c9394534a2917a011cc.png" alt="image"><br>  <i>Figure 2 - Typical Description</i> <br><br>  Then I did the same for the request - I brought the names to a type view.  Now, it remains only to use the good old CDF, and now, after a couple of seconds, I have a ready list with the best prices and the original names of the selected positions.  In addition, I immediately had information about who the supplier is and how many items there are in the warehouse.  This is useful if there is a sale - I will not forget where the prices are. <br><br>  This was only the first step. <br><br>  Since each category has its own characteristics, each also needs its own search pattern.  After spending a couple of days, I made a table with templates for 8 main categories, and was able to correctly determine approximately 70% of the positions.  But even with such accuracy, I was able to process the majority of applications not only faster than colleagues, but also faster than all competitors. <br><br>  As soon as they saw this in the department, all the applications flowed in to me for elaboration, and it became clear - either I would share the system with everyone, or return to what I wanted to leave - get bogged down in monotonous work. <br><br>  Since the system worked on Excel and macros and contained ~ 100,000 positions, it took about 40 minutes to update every day and it was impossible to work in the tables.  So, installing the same file on each computer, I decided not to even try, not to mention that each user would have to correct errors and make changes to the system separately.  It was necessary to quickly search for a suitable, easy to transfer system option, and I decided to try Google spreadsheets.  This should solve a number of problems: <br><br>  All price lists will be reduced and updated in the cloud on a schedule and all users will have access to them. <br><br>  It will be possible to work from any place where there is Internet, even from a smartphone. <br>  I can upgrade and correct the system at least from where and at once for all users. <br><br>  In the beginning, I tried to do everything on the same formulas, but when the table of 100 positions was processed for 3 minutes, I realized that the formulas would have to be abandoned, and I began to study the Google documentation. The app script (gas) is the same js, only with the addition functions from google. <br><br>  After transferring all the logic to gas, I discovered the following problem: if only one characteristic was described in the request, for example, only the drill diameter, then most of the prices had a diameter x length, and since the system determines the maximum parameters, then only positions in the selection Which number of the described characteristics coincides with their number in the request.  This is a serious flaw and it needed to be corrected. <br><br>  Here I used regular expressions again and each line from the query I just converted to a line with typical characteristics, I turned into a regular expression where the missing characteristic '*' was replaced with '. *?'  and it meant that the system will skip this characteristic during the search and move on to the next one. <br><br>  But here I am faced with a new problem - it is not always necessary to choose the most inexpensive position, sometimes you need to choose the longest or shortest drill bit, see what kind of drills have a given diameter, or who has the most in stock. <br><br>  Here the solution turned out to be simpler - I make a pass through all the lines, collect suitable positions for the template and bring them to the drop-down list, indicating all the information. <br><br>  The worksheet now looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/19e/0f4/875/19e0f4875e8e38e31bc4bd7c100144d6.png" alt="image"><br>  <i>Figure 3 - Sheet for matching applications and prices</i> <br><br>  The entire query is inserted into the first column in a tabular form, into the second quantity.  The third column automatically gets typed descriptions.  In the fourth column, a drop-down list is added to each row from all suitable positions that the system was able to find, sorted by default by price, but if necessary, you can switch to sorting by quantity in stock or supplier. <br><br>  Now the last thing to do is to invoice.  For this, a template is formed in the columns on the right, which can be quickly loaded into 1C: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3d3/dbe/bde/3d3dbebde6b1dfc21d3e95f89da44c41.png" alt="image"><br>  <i>Figure 4 - Template for loading in 1C</i> <br><br>  The template contains comprehensive information - the supplier with its article number, title, quantity, and price.  From here you can send requests to accounts to different suppliers, or create an account without going to 1C, as you need. <br><br>  Total: <br><br>  Processing applications became ~ 20 times faster (30 minutes instead of 1 day for an application from 100 positions), selection at optimal prices has become several times more efficient, since now there is no problem that someone is too lazy to go through all prices or make inquiries for all suppliers. <br><br>  Future plans: <br><br>  Learn how to use and translate massive calculations on a google engine, translate large tables into big data, and write a neural network to quickly identify patterns.  So I would be very grateful if someone shares their experience about using them in the comments. <br><br>  Afterword: <br><br>  In the process, dozens of useful functions were written that can be useful to many who are already working in gas, and even to those who are just going to.  For example: automatically downloading files from Gmail or a link to Gdrive and converting them into google table format, searching and copying strings from files on a disk by a word in the title, and so on.  They will be published in the following articles. <br><br>  In the case of interest in this article, I will describe in more detail how the program works with code inserts. <br><br>  Thanks for reading. </div><p>Source: <a href="https://habr.com/ru/post/348250/">https://habr.com/ru/post/348250/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348238/index.html">Reverse takeover: VMware can buy Dell</a></li>
<li><a href="../348240/index.html">Native validation as a framework. Lecture in Yandex</a></li>
<li><a href="../348244/index.html">Why the logistic regression results in SAS and R do not match</a></li>
<li><a href="../348246/index.html">The digest of interesting materials for the mobile developer # 239 (January 29 - February 4)</a></li>
<li><a href="../348248/index.html">Project management software development. Problems and solutions</a></li>
<li><a href="../348252/index.html">Castle or City</a></li>
<li><a href="../348254/index.html">Dart Summit 2018: basic thoughts</a></li>
<li><a href="../348258/index.html">W3View - Javascript library for which HTML was created.</a></li>
<li><a href="../348260/index.html">The combination of R and Python: why, when and how?</a></li>
<li><a href="../348262/index.html">Its a snake, or write the first draft. Part 0</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>