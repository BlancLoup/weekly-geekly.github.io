<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Algorithm for generating a QR code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A QR code is a monochrome picture in which some devices (for example, a smartphone with a special application) recognize the text. This text can be no...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Algorithm for generating a QR code</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/d8b/40b/f27/d8b40bf2737f9a681aaab483de3da242.png" align="left"><br><br>  A QR code is a monochrome picture in which some devices (for example, a smartphone with a special application) recognize the text.  This text can be not only a simple phrase, but, although it is not included in the official specification, a link, a phone number or a business card.  Such codes are most often used to encode a link and print it on a poster or business card. <br><br>  This article is a detailed instruction on creating a QR code with examples at each step, which requires you to have only basic skills in working with binary data and mastering any programming language (if you want to create an automatic QR code generator). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The basis of this article is taken by the cycle of articles "QR Code Demystified" by Jason Brown (Jason Brown).  There are many nuances in these articles that have caused me some problems.  All these nuances are taken into account and mentioned here. <br><br><a name="habracut"></a><br><br>  The process of generating a QR code is divided into several clear steps: <br><ol><li>  Encoding data. </li><li>  Add service information and fill. </li><li>  The division of information into blocks. </li><li>  Creating correction bytes. </li><li>  Combining blocks. </li><li>  Placing information on the QR code. </li></ol><br><br><h2>  Data coding </h2><br>  The QR code supports several ways of encoding data, depending on which characters are used: digital, alphanumeric, kanji (Chinese-Japanese hieroglyphs) and byte-coding.  Digital coding implies using only numbers from 0 to 9, alphanumeric - capital letters of the Latin alphabet, numbers and symbols $% + + -. /: And a space, I will not consider kanji, and encoding bytes are not required at all.  First you need to create an empty bit sequence, which will be filled further. <br><br><h3>  Digital coding </h3><br>  This type of encoding requires 10 bits by 3 characters.  The entire sequence of characters is divided into groups of 3 digits, and each group (a three-digit number) is translated into a 10-bit binary number and added to the sequence of bits.  If the total number of characters is not a multiple of 3, then if at the end there are 2 characters left, the resulting two-digit number is encoded with 7 bits, and if 1 character, then 4 bits. <br><br>  For example, there is the string "12345678" that needs to be encoded.  We divide it into numbers: 123, 456 and 78, then we translate each of them into binary form: 0001111011, 0111001000 and 1001110, and combine it into one stream: 000111101101110010001001110. <br><br><h3>  Alphanumeric encoding </h3><br>  In this case, 2 characters require 11 bits of information.  The input stream of characters is divided into groups of 2, in the group each character is encoded according to the table below, the value of the first character in the group is multiplied by 45 and added to the value of the second character.  The resulting number is converted to an 11-bit binary number and added to the bit sequence.  If the last group contains 1 character, then its value is immediately encoded with a 6-bit number and added to the bit sequence. <br><br><div class="spoiler">  <b class="spoiler_title">Table 1. Values ‚Äã‚Äãof characters in alphanumeric coding.</b> <div class="spoiler_text"><table><tbody><tr><td>  0 </td><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td><td>  6 </td><td>  7 </td><td>  eight </td><td>  9 </td><td>  A </td><td>  B </td><td>  C </td><td>  D </td><td>  E </td></tr><tr><td>  0 </td><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td><td>  6 </td><td>  7 </td><td>  eight </td><td>  9 </td><td>  ten </td><td>  eleven </td><td>  12 </td><td>  13 </td><td>  14 </td></tr></tbody></table><table><tbody><tr><td>  F </td><td>  G </td><td>  H </td><td>  I </td><td>  J </td><td>  K </td><td>  L </td><td>  M </td><td>  N </td><td>  O </td><td>  P </td><td>  Q </td><td>  R </td><td>  S </td><td>  T </td></tr><tr><td>  15 </td><td>  sixteen </td><td>  17 </td><td>  18 </td><td>  nineteen </td><td>  20 </td><td>  21 </td><td>  22 </td><td>  23 </td><td>  24 </td><td>  25 </td><td>  26 </td><td>  27 </td><td>  28 </td><td>  29 </td></tr></tbody></table><table><tbody><tr><td>  U </td><td>  V </td><td>  W </td><td>  X </td><td>  Y </td><td>  Z </td><td>  Space </td><td>  $ </td><td>  % </td><td>  * </td><td>  + </td><td>  - </td><td>  . </td><td>  / </td><td>  : </td></tr><tr><td>  thirty </td><td>  31 </td><td>  32 </td><td>  33 </td><td>  34 </td><td>  35 </td><td>  36 </td><td>  37 </td><td>  38 </td><td>  39 </td><td>  40 </td><td>  41 </td><td>  42 </td><td>  43 </td><td>  44 </td></tr></tbody></table></div></div><br><br>  For example, the string "HELLO" is encoded as follows.  We divide into groups: HE, LL, O;  we find the corresponding value of the symbols in each group: (17, 14), (21, 21), (24);  we find the value for each group: 17 * 45 + 14 = 779, 21 * 45 + 21 = 966, 24 = 24;  translate each value into a binary form: 779 = 01100001011, 966 = 01111000110, 24 = 011000;  and combine it all into one sequence of bits: 0110000101101111000110011000. <br><br><h3>  Byte coding </h3><br>  This is a universal encoding method that can encode any characters.  The only drawback of the method is the relatively low information density.  In this case, the text is encoded in any encoding (recommended in UTF-8) and the resulting sequence of bytes is taken unchanged. <br><br>  For example, the string "Habr", encoded UTF-8 encoding, a byte consists of the following: 11010000, 10100101, 11010000, 10110000, 11010000, 10110001, 11010001 and 10000000. They just need to be combined into a single bit stream: 1101000010100101110100001011000011010000101100011101000110000000. <br><br><h2>  Add service information </h2><br>  At this stage, it is necessary to determine the level of correction: the higher this level, the higher the permissible level of damage to the image and the less information with an equal size.  There are 4 levels of correction in total: L (maximum 7% damage is acceptable), M (15%), Q (25%) and H (30%).  Level M is most often used. If you want to add a picture to a QR code (there are several articles on this topic on Habr√©), then use level H. <br><br>  Another property of the QR code is its version (the larger it is, the larger the size).  There are 40 versions in total.  The version number depends on the amount of information encoded and on the level of correction.  Table 2 shows the maximum amount of useful information along with service information (in bits), which can be encoded in the QR code of this version.  The version of our QR code is determined from this table. <br><br><div class="spoiler">  <b class="spoiler_title">Table 2. The maximum amount of information.</b> <div class="spoiler_text">  Line - the level of correction, the column - the version number. <br><table><tbody><tr><td></td><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td><td>  6 </td><td>  7 </td><td>  eight </td><td>  9 </td><td>  ten </td></tr><tr><td>  L </td><td>  152 </td><td>  272 </td><td>  440 </td><td>  640 </td><td>  864 </td><td>  1088 </td><td>  1248 </td><td>  1552 </td><td>  1856 </td><td>  2192 </td></tr><tr><td>  M </td><td>  128 </td><td>  224 </td><td>  352 </td><td>  512 </td><td>  688 </td><td>  864 </td><td>  992 </td><td>  1232 </td><td>  1456 </td><td>  1728 </td></tr><tr><td>  Q </td><td>  104 </td><td>  176 </td><td>  272 </td><td>  384 </td><td>  496 </td><td>  608 </td><td>  704 </td><td>  880 </td><td>  1056 </td><td>  1232 </td></tr><tr><td>  H </td><td>  72 </td><td>  128 </td><td>  208 </td><td>  288 </td><td>  368 </td><td>  480 </td><td>  528 </td><td>  688 </td><td>  800 </td><td>  976 </td></tr></tbody></table><table><tbody><tr><td></td><td>  eleven </td><td>  12 </td><td>  13 </td><td>  14 </td><td>  15 </td><td>  sixteen </td><td>  17 </td><td>  18 </td><td>  nineteen </td><td>  20 </td></tr><tr><td>  L </td><td>  2592 </td><td>  2960 </td><td>  3424 </td><td>  3688 </td><td>  4184 </td><td>  4712 </td><td>  5176 </td><td>  5768 </td><td>  6360 </td><td>  6888 </td></tr><tr><td>  M </td><td>  2032 </td><td>  2320 </td><td>  2672 </td><td>  2920 </td><td>  3320 </td><td>  3624 </td><td>  4056 </td><td>  4504 </td><td>  5016 </td><td>  5352 </td></tr><tr><td>  Q </td><td>  1440 </td><td>  1648 </td><td>  1952 </td><td>  2088 </td><td>  2360 </td><td>  2600 </td><td>  2936 </td><td>  3176 </td><td>  3560 </td><td>  3880 </td></tr><tr><td>  H </td><td>  1120 </td><td>  1264 </td><td>  1440 </td><td>  1576 </td><td>  1784 </td><td>  2024 </td><td>  2264 </td><td>  2504 </td><td>  2728 </td><td>  3080 </td></tr></tbody></table><table><tbody><tr><td></td><td>  21 </td><td>  22 </td><td>  23 </td><td>  24 </td><td>  25 </td><td>  26 </td><td>  27 </td><td>  28 </td><td>  29 </td><td>  thirty </td></tr><tr><td>  L </td><td>  7456 </td><td>  8048 </td><td>  8752 </td><td>  9392 </td><td>  10208 </td><td>  10960 </td><td>  11744 </td><td>  12248 </td><td>  13048 </td><td>  13880 </td></tr><tr><td>  M </td><td>  5712 </td><td>  6256 </td><td>  6880 </td><td>  7312 </td><td>  8,000 </td><td>  8496 </td><td>  9024 </td><td>  9544 </td><td>  10136 </td><td>  10984 </td></tr><tr><td>  Q </td><td>  4096 </td><td>  4544 </td><td>  4912 </td><td>  5312 </td><td>  5744 </td><td>  6032 </td><td>  6464 </td><td>  6968 </td><td>  7288 </td><td>  7880 </td></tr><tr><td>  H </td><td>  3248 </td><td>  3536 </td><td>  3712 </td><td>  4112 </td><td>  4304 </td><td>  4768 </td><td>  5024 </td><td>  5288 </td><td>  5608 </td><td>  5960 </td></tr></tbody></table><table><tbody><tr><td></td><td>  31 </td><td>  32 </td><td>  33 </td><td>  34 </td><td>  35 </td><td>  36 </td><td>  37 </td><td>  38 </td><td>  39 </td><td>  40 </td></tr><tr><td>  L </td><td>  14744 </td><td>  15640 </td><td>  16568 </td><td>  17528 </td><td>  18448 </td><td>  19472 </td><td>  20528 </td><td>  21616 </td><td>  22496 </td><td>  23648 </td></tr><tr><td>  M </td><td>  11640 </td><td>  12328 </td><td>  13048 </td><td>  13800 </td><td>  14496 </td><td>  15312 </td><td>  15936 </td><td>  16816 </td><td>  17728 </td><td>  18672 </td></tr><tr><td>  Q </td><td>  8264 </td><td>  8920 </td><td>  9368 </td><td>  9848 </td><td>  10288 </td><td>  10832 </td><td>  11408 </td><td>  12016 </td><td>  12656 </td><td>  13328 </td></tr><tr><td>  H </td><td>  6344 </td><td>  6760 </td><td>  7208 </td><td>  7688 </td><td>  7888 </td><td>  8432 </td><td>  8768 </td><td>  9136 </td><td>  9776 </td><td>  10208 </td></tr></tbody></table></div></div><br><br><h3>  Adding service fields </h3><br>  At this point, the correction level should be selected and the version determined.  Now it is necessary, before the bit sequence obtained in the previous paragraph, to add two fields at the beginning: the encoding method and the amount of data.  The encoding method is a 4-bit field, which has the following values: 0001 for digital encoding, 0010 for alphanumeric and 0100 for byte-byte.  The amount of data is the number of characters to be encoded, and for byte bytes, the number of bytes (and not the bits in the received sequence), represented as a binary number of a certain length (determined according to Table 3). <br><br><div class="spoiler">  <b class="spoiler_title">Table 3. The length of the data quantity field.</b> <div class="spoiler_text"><table><tbody><tr><td></td><td>  Version 1‚Äì9 </td><td>  Version 10‚Äì26 </td><td>  Version 27‚Äì40 </td></tr><tr><td>  Digital </td><td>  10 bits </td><td>  12 bits </td><td>  14 bits </td></tr><tr><td>  Alphanumeric </td><td>  9 bits </td><td>  11 bits </td><td>  13 bits </td></tr><tr><td>  Byte byte </td><td>  8 bit </td><td>  16 bits </td><td>  16 bits </td></tr></tbody></table></div></div><br><br>  For example, given a string of 100 bytes, encoded byte-byte, the correction level is M. The length of the bit sequence of this string is 800 bits.  Using the table 2, you can determine that the best will use the 6th version.  The length of the field that determines the amount of data in our case is 8 bits (Table 3).  The field defining the encoding method is 0100, the data quantity field is 01100100 (100 in binary form).  The result is a sequence of bits 010001100100 &lt;original sequence&gt;. <br><br>  If the length of the received sequence of bits turned out to be more acceptable for the selected version, then the version should be increased by one and the service fields should be added anew. <br><br>  The specification allows the use of mixed coding.  This means that several data groups can be encoded in different ways and combined into one sequence.  This is done as follows: &lt;data encoding method 1&gt; &lt;data amount 1&gt; &lt;data 1&gt; &lt;data encoding method 2&gt; &lt;data amount 2&gt; &lt;data 2&gt; and so on. <br><br><h3>  Filling </h3><br>  At this stage, we have a sequence of data bits, the number of bits in which is probably not a multiple of 8. We must add zeros so that its length becomes a multiple of 8. Now our sequence of bits can be divided into groups of 8 bits and represented as a sequence of bytes ( then we will do so).  If the number of bits in the current byte sequence is less than that needed for the selected version, then it must be supplemented with alternating bytes 11101100 and 00010001. Thus, we have a sequence of bytes, the length of which corresponds to the selected version of the QR code. <br><br>  Example.  There is a sequence: &lt;a sequence of bits whose length is a multiple of 8&gt; 10101011101;  we fill it with zeros so that its length becomes a multiple of 8: &lt;a sequence of bits whose length is a multiple of 8&gt; 10101011101 00000;  Now suppose that its length is 104 bits, and for the selected version you need 128 bits, then you need to add 24 ‚Äúfill‚Äù bits (3 bytes) to fill: &lt;a sequence of bits that is a multiple of 8&gt; 10101011101 00000 11101100 00010001 11101100. Done. <br><br><h2>  Information division into blocks </h2><br>  The sequence of bytes obtained in the previous step (hereinafter referred to as data) is divided into the number of blocks specified for the version and correction level, which is shown in Table 4. If the number of blocks is one, then this step can be skipped. <br><br><div class="spoiler">  <b class="spoiler_title">Table 4. The number of blocks.</b> <div class="spoiler_text">  Line - the level of correction, the column - the version number. <br><table><tbody><tr><td></td><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td><td>  6 </td><td>  7 </td><td>  eight </td><td>  9 </td><td>  ten </td></tr><tr><td>  L </td><td>  one </td><td>  one </td><td>  one </td><td>  one </td><td>  one </td><td>  2 </td><td>  2 </td><td>  2 </td><td>  2 </td><td>  four </td></tr><tr><td>  M </td><td>  one </td><td>  one </td><td>  one </td><td>  2 </td><td>  2 </td><td>  four </td><td>  four </td><td>  four </td><td>  five </td><td>  five </td></tr><tr><td>  Q </td><td>  one </td><td>  one </td><td>  2 </td><td>  2 </td><td>  four </td><td>  four </td><td>  6 </td><td>  6 </td><td>  eight </td><td>  eight </td></tr><tr><td>  H </td><td>  one </td><td>  one </td><td>  2 </td><td>  four </td><td>  four </td><td>  four </td><td>  five </td><td>  6 </td><td>  eight </td><td>  eight </td></tr></tbody></table><table><tbody><tr><td></td><td>  eleven </td><td>  12 </td><td>  13 </td><td>  14 </td><td>  15 </td><td>  sixteen </td><td>  17 </td><td>  18 </td><td>  nineteen </td><td>  20 </td></tr><tr><td>  L </td><td>  four </td><td>  four </td><td>  four </td><td>  four </td><td>  6 </td><td>  6 </td><td>  6 </td><td>  6 </td><td>  7 </td><td>  eight </td></tr><tr><td>  M </td><td>  five </td><td>  eight </td><td>  9 </td><td>  9 </td><td>  ten </td><td>  ten </td><td>  eleven </td><td>  13 </td><td>  14 </td><td>  sixteen </td></tr><tr><td>  Q </td><td>  eight </td><td>  ten </td><td>  12 </td><td>  sixteen </td><td>  12 </td><td>  17 </td><td>  sixteen </td><td>  18 </td><td> 21 </td><td>  20 </td></tr><tr><td>  H </td><td>  eleven </td><td>  eleven </td><td>  sixteen </td><td>  sixteen </td><td>  18 </td><td>  sixteen </td><td>  nineteen </td><td>  21 </td><td>  25 </td><td>  25 </td></tr></tbody></table><table><tbody><tr><td></td><td>  21 </td><td>  22 </td><td>  23 </td><td>  24 </td><td>  25 </td><td>  26 </td><td>  27 </td><td>  28 </td><td>  29 </td><td>  thirty </td></tr><tr><td>  L </td><td>  eight </td><td>  9 </td><td>  9 </td><td>  ten </td><td>  12 </td><td>  12 </td><td>  12 </td><td>  13 </td><td>  14 </td><td>  15 </td></tr><tr><td>  M </td><td>  17 </td><td>  17 </td><td>  18 </td><td>  20 </td><td>  21 </td><td>  23 </td><td>  25 </td><td>  26 </td><td>  28 </td><td>  29 </td></tr><tr><td>  Q </td><td>  23 </td><td>  23 </td><td>  25 </td><td>  27 </td><td>  29 </td><td>  34 </td><td>  34 </td><td>  35 </td><td>  38 </td><td>  40 </td></tr><tr><td>  H </td><td>  25 </td><td>  34 </td><td>  thirty </td><td>  32 </td><td>  35 </td><td>  37 </td><td>  40 </td><td>  42 </td><td>  45 </td><td>  48 </td></tr></tbody></table><table><tbody><tr><td></td><td>  31 </td><td>  32 </td><td>  33 </td><td>  34 </td><td>  35 </td><td>  36 </td><td>  37 </td><td>  38 </td><td>  39 </td><td>  40 </td></tr><tr><td>  L </td><td>  sixteen </td><td>  17 </td><td>  18 </td><td>  nineteen </td><td>  nineteen </td><td>  20 </td><td>  21 </td><td>  22 </td><td>  24 </td><td>  25 </td></tr><tr><td>  M </td><td>  31 </td><td>  33 </td><td>  35 </td><td>  37 </td><td>  38 </td><td>  40 </td><td>  43 </td><td>  45 </td><td>  47 </td><td>  49 </td></tr><tr><td>  Q </td><td>  43 </td><td>  45 </td><td>  48 </td><td>  51 </td><td>  53 </td><td>  56 </td><td>  59 </td><td>  62 </td><td>  65 </td><td>  68 </td></tr><tr><td>  H </td><td>  51 </td><td>  54 </td><td>  57 </td><td>  60 </td><td>  63 </td><td>  66 </td><td>  70 </td><td>  74 </td><td>  77 </td><td>  81 </td></tr></tbody></table></div></div><br><br><h3>  Determining the number of bytes in each block </h3><br>  To do this, you need to divide the entire number of bytes (you can determine the number of bytes in the data or divide the number from table 2 by eight) by the number of data blocks.  If this number is not an integer, then it is necessary to determine the remainder of the division.  This remainder determines how many blocks of all are added (such blocks, the number of bytes in which is one more than in the others).  Contrary to expectations, the added blocks should not be the first blocks, but the last ones. <br><br>  For example, for version 9 and the correction level M data quanta are 182 bytes, the number of blocks is 5. Sharing the number of data bytes by the number of blocks, we get 36 bytes and 2 bytes in the remainder.  This means that the data blocks will have the following sizes: 36, 36, 36, 37, 37 (bytes).  If there was no residue, all 5 blocks would be 36 bytes in size. <br><br><h3>  Filling the blocks </h3><br>  The block is filled with bytes from the data completely.  When the current block is full, the queue moves to the next.  Data bytes should be enough for all blocks, no more and no less. <br><br><h2>  Creating correction bytes </h2><br>  The following algorithm is applied to each data block (if the data block is one, then just to the data). <br><br>  This algorithm is based on <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D0%25B4_%25D0%25A0%25D0%25B8%25D0%25B4%25D0%25B0_%25E2%2580%2594_%25D0%25A1%25D0%25BE%25D0%25BB%25D0%25BE%25D0%25BC%25D0%25BE%25D0%25BD%25D0%25B0">the Reed ‚Äì Solomon algorithm</a> .  The first thing to do is to determine how many bytes of correction should be created (table 5).  By the number of correction bytes, the so-called generating polynomial is determined (Table 6).  It is called a polynomial, because the original method uses a polynomial with the same coefficients. <br><br><div class="spoiler">  <b class="spoiler_title">Table 5. Number of correction bytes per block.</b> <div class="spoiler_text">  Line - the level of correction, the column - the version number. <br><table><tbody><tr><td></td><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td><td>  6 </td><td>  7 </td><td>  eight </td><td>  9 </td><td>  ten </td></tr><tr><td>  L </td><td>  7 </td><td>  ten </td><td>  15 </td><td>  20 </td><td>  26 </td><td>  18 </td><td>  20 </td><td>  24 </td><td>  thirty </td><td>  18 </td></tr><tr><td>  M </td><td>  ten </td><td>  sixteen </td><td>  26 </td><td>  18 </td><td>  24 </td><td>  sixteen </td><td>  18 </td><td>  22 </td><td>  22 </td><td>  26 </td></tr><tr><td>  Q </td><td>  13 </td><td>  22 </td><td>  18 </td><td>  26 </td><td>  18 </td><td>  24 </td><td>  18 </td><td>  22 </td><td>  20 </td><td>  24 </td></tr><tr><td>  H </td><td>  17 </td><td>  28 </td><td>  22 </td><td>  sixteen </td><td>  22 </td><td>  28 </td><td>  26 </td><td>  26 </td><td>  24 </td><td>  28 </td></tr></tbody></table><table><tbody><tr><td></td><td>  eleven </td><td>  12 </td><td>  13 </td><td>  14 </td><td>  15 </td><td>  sixteen </td><td>  17 </td><td>  18 </td><td>  nineteen </td><td>  20 </td></tr><tr><td>  L </td><td>  20 </td><td>  24 </td><td>  26 </td><td>  thirty </td><td>  22 </td><td>  24 </td><td>  28 </td><td>  thirty </td><td>  28 </td><td>  28 </td></tr><tr><td>  M </td><td>  thirty </td><td>  22 </td><td>  22 </td><td>  24 </td><td>  24 </td><td>  28 </td><td>  28 </td><td>  26 </td><td>  26 </td><td>  26 </td></tr><tr><td>  Q </td><td>  28 </td><td>  26 </td><td>  24 </td><td>  20 </td><td>  thirty </td><td>  24 </td><td>  28 </td><td>  28 </td><td>  26 </td><td>  thirty </td></tr><tr><td>  H </td><td>  24 </td><td>  28 </td><td>  22 </td><td>  24 </td><td>  24 </td><td>  thirty </td><td>  28 </td><td>  28 </td><td>  26 </td><td>  28 </td></tr></tbody></table><table><tbody><tr><td></td><td>  21 </td><td>  22 </td><td>  23 </td><td>  24 </td><td>  25 </td><td>  26 </td><td>  27 </td><td>  28 </td><td>  29 </td><td>  thirty </td></tr><tr><td>  L </td><td>  28 </td><td>  28 </td><td>  thirty </td><td>  thirty </td><td>  26 </td><td>  28 </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td></tr><tr><td>  M </td><td>  26 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td></tr><tr><td>  Q </td><td>  28 </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  28 </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td></tr><tr><td>  H </td><td>  thirty </td><td>  24 </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td></tr></tbody></table><table><tbody><tr><td></td><td>  31 </td><td>  32 </td><td>  33 </td><td>  34 </td><td>  35 </td><td>  36 </td><td>  37 </td><td>  38 </td><td>  39 </td><td>  40 </td></tr><tr><td>  L </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td></tr><tr><td>  M </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td><td>  28 </td></tr><tr><td>  Q </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td></tr><tr><td>  H </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td><td>  thirty </td></tr></tbody></table></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Table 6. Generating polynomials.</b> <div class="spoiler_text"><table><tbody><tr><td>  Number of correction bytes </td><td>  Generating polynomial </td></tr><tr><td>  7 </td><td>  87, 229, 146, 149, 238, 102, 21 </td></tr><tr><td>  ten </td><td>  251, 67, 46, 61, 118, 70, 64, 94, 32, 45 </td></tr><tr><td>  13 </td><td>  74, 152, 176, 100, 86, 100, 106, 104, 130, 218, 206, 140, 78 </td></tr><tr><td>  15 </td><td>  8, 183, 61, 91, 202, 37, 51, 58, 58, 237, 140, 124, 5, 99, 105 </td></tr><tr><td>  sixteen </td><td>  120, 104, 107, 109, 102, 161, 76, 3, 91, 191, 147, 169, 182, 194, 225, 120 </td></tr><tr><td>  17 </td><td>  43, 139, 206, 78, 43, 239, 123, 206, 214, 147, 24, 99, 150, 39, 243, 163, 136 </td></tr><tr><td>  18 </td><td>  215, 234, 158, 94, 184, 97, 118, 170, 79, 187, 152, 148, 252, 179, 5, 98, 96, 153 </td></tr><tr><td>  20 </td><td>  17, 60, 79, 50, 61, 163, 26, 187, 202, 180, 221, 225, 83, 239, 156, 164, 212, 212, 188, 190 </td></tr><tr><td>  22 </td><td>  210, 171, 247, 242, 93, 230, 14, 109, 221, 53, 200, 74, 8, 172, 98, 80, 219, 134, 160, 105, 165, 231 </td></tr><tr><td>  24 </td><td>  229, 121, 135, 48, 211, 117, 251, 126, 159, 180, 169, 152, 192, 226, 228, 218, 111, 0, 117, 232, 87, 96, 227, 21 </td></tr><tr><td>  26 </td><td>  173, 125, 158, 2, 103, 182, 118, 17, 145, 201, 111, 28, 165, 53, 161, 21, 245, 142, 13, 102, 48, 227, 153, 145, 218, 70 </td></tr><tr><td>  28 </td><td>  168, 223, 200, 104, 224, 234, 108, 180, 110, 190, 195, 147, 205, 27, 232, 201, 21, 43, 245, 87, 42, 195, 212, 119, 242, 37, 9, 123 </td></tr><tr><td>  thirty </td><td>  41, 173, 145, 152, 216, 31, 179, 182, 50, 48, 110, 86, 239, 96, 222, 125, 42, 173, 226, 193, 224, 130, 156, 37, 251, 216, 238, 40, 192, 180 </td></tr></tbody></table></div></div><br><br>  Before executing the loop, it is necessary to prepare an array whose length is equal to the maximum of the number of bytes in the current block and the number of correction bytes, and fill its beginning with bytes from the current block, and the end with zeros. <br><br>  The cycle described in this list is repeated as many times as the data bytes are contained in the current block. <br><ol><li>  We take the first element of the array, save its value in the variable A and remove it from the array (all the following values ‚Äã‚Äãare shifted one cell to the left, the last element is filled with zero). </li><li>  If A is zero, then skip the following steps (to the end of the list) and go to the next iteration of the loop. </li><li>  Find the corresponding number A number in table 8, put it in the variable B. </li><li>  Further, for the N first elements, where N is the number of correction bytes, i is the loop counter: <br><ul><li>  It is necessary to add the value of B to the i-th value of the generating polynomial and write this sum in variable C (do not change the polynomial itself). </li><li>  If B is greater than 254, it is necessary to use its remainder when divided by 255 (255, not 256). </li><li>  Find the corresponding B value in Table 7 and perform bitwise addition modulo 2 (XOR, operator ^ in many programming languages) with the i-th value of the prepared array and write the obtained value into the i-th cell of the prepared array. </li></ul></li></ol><br><br>  The first N bytes of the prepared array after this cycle are the correction bytes.  For each data block, the corresponding byte correction block is obtained. <br><br>  Nothing is clear?  Me too.  Look at the example and everything will become clear. <br><br><div class="spoiler">  <b class="spoiler_title">Table 7. Galois field.</b> <div class="spoiler_text">  This table is a value for a Galois field of length 256. It can be automatically calculated. <br><table><tbody><tr><td>  0 </td><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td><td>  6 </td><td>  7 </td><td>  eight </td><td>  9 </td><td>  ten </td><td>  eleven </td><td>  12 </td><td>  13 </td><td>  14 </td><td>  15 </td></tr><tr><td>  one </td><td>  2 </td><td>  four </td><td>  eight </td><td>  sixteen </td><td>  32 </td><td>  64 </td><td>  128 </td><td>  29 </td><td>  58 </td><td>  116 </td><td>  232 </td><td>  205 </td><td>  135 </td><td>  nineteen </td><td>  38 </td></tr></tbody></table><table><tbody><tr><td>  sixteen </td><td>  17 </td><td>  18 </td><td>  nineteen </td><td>  20 </td><td>  21 </td><td>  22 </td><td>  23 </td><td>  24 </td><td>  25 </td><td>  26 </td><td>  27 </td><td>  28 </td><td>  29 </td><td>  thirty </td><td>  31 </td></tr><tr><td>  76 </td><td>  152 </td><td>  45 </td><td>  90 </td><td>  180 </td><td>  117 </td><td>  234 </td><td>  201 </td><td>  143 </td><td>  3 </td><td>  6 </td><td>  12 </td><td>  24 </td><td>  48 </td><td>  96 </td><td>  192 </td></tr></tbody></table><table><tbody><tr><td>  32 </td><td>  33 </td><td>  34 </td><td>  35 </td><td>  36 </td><td>  37 </td><td>  38 </td><td>  39 </td><td>  40 </td><td>  41 </td><td>  42 </td><td>  43 </td><td>  44 </td><td>  45 </td><td>  46 </td><td>  47 </td></tr><tr><td>  157 </td><td>  39 </td><td>  78 </td><td>  156 </td><td>  37 </td><td>  74 </td><td>  148 </td><td>  53 </td><td>  106 </td><td>  212 </td><td>  181 </td><td>  119 </td><td>  238 </td><td>  193 </td><td>  159 </td><td>  35 </td></tr></tbody></table><table><tbody><tr><td>  48 </td><td>  49 </td><td>  50 </td><td>  51 </td><td>  52 </td><td>  53 </td><td>  54 </td><td>  55 </td><td>  56 </td><td>  57 </td><td>  58 </td><td>  59 </td><td>  60 </td><td>  61 </td><td>  62 </td><td>  63 </td></tr><tr><td>  70 </td><td>  140 </td><td>  five </td><td>  ten </td><td>  20 </td><td>  40 </td><td>  80 </td><td>  160 </td><td>  93 </td><td>  186 </td><td>  105 </td><td>  210 </td><td>  185 </td><td>  111 </td><td>  222 </td><td>  161 </td></tr></tbody></table><table><tbody><tr><td>  64 </td><td>  65 </td><td>  66 </td><td>  67 </td><td>  68 </td><td>  69 </td><td>  70 </td><td>  71 </td><td>  72 </td><td>  73 </td><td>  74 </td><td>  75 </td><td>  76 </td><td>  77 </td><td>  78 </td><td>  79 </td></tr><tr><td>  95 </td><td>  190 </td><td>  97 </td><td>  194 </td><td>  153 </td><td>  47 </td><td>  94 </td><td>  188 </td><td>  101 </td><td>  202 </td><td>  137 </td><td>  15 </td><td>  thirty </td><td>  60 </td><td>  120 </td><td>  240 </td></tr></tbody></table><table><tbody><tr><td>  80 </td><td>  81 </td><td>  82 </td><td>  83 </td><td>  84 </td><td>  85 </td><td>  86 </td><td>  87 </td><td>  88 </td><td>  89 </td><td>  90 </td><td>  91 </td><td>  92 </td><td>  93 </td><td>  94 </td><td>  95 </td></tr><tr><td>  253 </td><td>  231 </td><td>  211 </td><td>  187 </td><td>  107 </td><td>  214 </td><td>  177 </td><td>  127 </td><td>  254 </td><td>  225 </td><td>  223 </td><td>  163 </td><td>  91 </td><td>  182 </td><td>  113 </td><td>  226 </td></tr></tbody></table><table><tbody><tr><td>  96 </td><td>  97 </td><td>  98 </td><td>  99 </td><td>  100 </td><td>  101 </td><td>  102 </td><td>  103 </td><td>  104 </td><td>  105 </td><td>  106 </td><td>  107 </td><td>  108 </td><td>  109 </td><td>  110 </td><td>  111 </td></tr><tr><td>  217 </td><td>  175 </td><td>  67 </td><td>  134 </td><td>  17 </td><td>  34 </td><td>  68 </td><td>  136 </td><td>  13 </td><td>  26 </td><td>  52 </td><td>  104 </td><td>  208 </td><td>  189 </td><td>  103 </td><td>  206 </td></tr></tbody></table><table><tbody><tr><td>  112 </td><td>  113 </td><td>  114 </td><td>  115 </td><td>  116 </td><td>  117 </td><td>  118 </td><td>  119 </td><td>  120 </td><td>  121 </td><td>  122 </td><td>  123 </td><td>  124 </td><td>  125 </td><td>  126 </td><td>  127 </td></tr><tr><td>  129 </td><td>  31 </td><td>  62 </td><td>  124 </td><td>  248 </td><td>  237 </td><td>  199 </td><td>  147 </td><td>  59 </td><td>  118 </td><td>  236 </td><td>  197 </td><td>  151 </td><td>  51 </td><td>  102 </td><td>  204 </td></tr></tbody></table><table><tbody><tr><td>  128 </td><td>  129 </td><td>  130 </td><td>  131 </td><td>  132 </td><td>  133 </td><td>  134 </td><td>  135 </td><td>  136 </td><td>  137 </td><td>  138 </td><td>  139 </td><td>  140 </td><td>  141 </td><td>  142 </td><td>  143 </td></tr><tr><td>  133 </td><td>  23 </td><td>  46 </td><td>  92 </td><td>  184 </td><td>  109 </td><td>  218 </td><td>  169 </td><td>  79 </td><td>  158 </td><td>  33 </td><td>  66 </td><td>  132 </td><td>  21 </td><td>  42 </td><td>  84 </td></tr></tbody></table><table><tbody><tr><td>  144 </td><td>  145 </td><td>  146 </td><td>  147 </td><td>  148 </td><td>  149 </td><td>  150 </td><td>  151 </td><td>  152 </td><td>  153 </td><td>  154 </td><td>  155 </td><td>  156 </td><td>  157 </td><td>  158 </td><td>  159 </td></tr><tr><td>  168 </td><td>  77 </td><td>  154 </td><td>  41 </td><td>  82 </td><td>  164 </td><td>  85 </td><td>  170 </td><td>  73 </td><td>  146 </td><td>  57 </td><td>  114 </td><td>  228 </td><td>  213 </td><td>  183 </td><td>  115 </td></tr></tbody></table><table><tbody><tr><td>  160 </td><td>  161 </td><td>  162 </td><td>  163 </td><td>  164 </td><td>  165 </td><td>  166 </td><td>  167 </td><td>  168 </td><td>  169 </td><td>  170 </td><td>  171 </td><td>  172 </td><td>  173 </td><td>  174 </td><td>  175 </td></tr><tr><td>  230 </td><td>  209 </td><td>  191 </td><td>  99 </td><td>  198 </td><td>  145 </td><td>  63 </td><td>  126 </td><td>  252 </td><td>  229 </td><td>  215 </td><td>  179 </td><td>  123 </td><td>  246 </td><td>  241 </td><td>  255 </td></tr></tbody></table><table><tbody><tr><td>  176 </td><td>  177 </td><td>  178 </td><td>  179 </td><td>  180 </td><td>  181 </td><td>  182 </td><td>  183 </td><td>  184 </td><td>  185 </td><td>  186 </td><td>  187 </td><td>  188 </td><td>  189 </td><td>  190 </td><td>  191 </td></tr><tr><td>  227 </td><td>  219 </td><td>  171 </td><td>  75 </td><td>  150 </td><td>  49 </td><td>  98 </td><td>  196 </td><td>  149 </td><td>  55 </td><td>  110 </td><td>  220 </td><td>  165 </td><td>  87 </td><td>  174 </td><td>  65 </td></tr></tbody></table><table><tbody><tr><td>  192 </td><td>  193 </td><td>  194 </td><td>  195 </td><td>  196 </td><td>  197 </td><td>  198 </td><td>  199 </td><td>  200 </td><td>  201 </td><td>  202 </td><td>  203 </td><td>  204 </td><td>  205 </td><td>  206 </td><td>  207 </td></tr><tr><td>  130 </td><td>  25 </td><td>  50 </td><td>  100 </td><td>  200 </td><td>  141 </td><td>  7 </td><td>  14 </td><td>  28 </td><td>  56 </td><td>  112 </td><td>  224 </td><td>  221 </td><td>  167 </td><td>  83 </td><td>  166 </td></tr></tbody></table><table><tbody><tr><td>  208 </td><td>  209 </td><td>  210 </td><td>  211 </td><td>  212 </td><td>  213 </td><td>  214 </td><td>  215 </td><td>  216 </td><td>  217 </td><td>  218 </td><td>  219 </td><td>  220 </td><td>  221 </td><td>  222 </td><td>  223 </td></tr><tr><td>  81 </td><td>  162 </td><td>  89 </td><td>  178 </td><td>  121 </td><td>  242 </td><td>  249 </td><td>  239 </td><td>  195 </td><td>  155 </td><td>  43 </td><td>  86 </td><td>  172 </td><td>  69 </td><td>  138 </td><td>  9 </td></tr></tbody></table><table><tbody><tr><td>  224 </td><td>  225 </td><td>  226 </td><td>  227 </td><td>  228 </td><td>  229 </td><td>  230 </td><td>  231 </td><td>  232 </td><td>  233 </td><td>  234 </td><td>  235 </td><td>  236 </td><td>  237 </td><td>  238 </td><td>  239 </td></tr><tr><td>  18 </td><td>  36 </td><td>  72 </td><td>  144 </td><td>  61 </td><td>  122 </td><td>  244 </td><td>  245 </td><td>  247 </td><td>  243 </td><td>  251 </td><td>  235 </td><td>  203 </td><td>  139 </td><td>  eleven </td><td>  22 </td></tr></tbody></table><table><tbody><tr><td>  240 </td><td>  241 </td><td>  242 </td><td>  243 </td><td>  244 </td><td>  245 </td><td>  246 </td><td>  247 </td><td>  248 </td><td>  249 </td><td>  250 </td><td>  251 </td><td>  252 </td><td>  253 </td><td>  254 </td><td>  255 </td></tr><tr><td>  44 </td><td>  88 </td><td>  176 </td><td>  125 </td><td>  250 </td><td>  233 </td><td>  207 </td><td>  131 </td><td>  27 </td><td>  54 </td><td>  108 </td><td>  216 </td><td>  173 </td><td>  71 </td><td>  142 </td><td>  one </td></tr></tbody></table></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Table 8. Reverse Galois Field</b> <div class="spoiler_text">  This table can be calculated from table 7. <br><table><tbody><tr><td>  0 </td><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td><td>  6 </td><td>  7 </td><td>  eight </td><td>  9 </td><td>  ten </td><td>  eleven </td><td>  12 </td><td>  13 </td><td>  14 </td><td>  15 </td></tr><tr><td>  - </td><td>  0 </td><td>  one </td><td>  25 </td><td>  2 </td><td>  50 </td><td>  26 </td><td>  198 </td><td>  3 </td><td>  223 </td><td>  51 </td><td>  238 </td><td>  27 </td><td>  104 </td><td>  199 </td><td>  75 </td></tr></tbody></table><table><tbody><tr><td>  sixteen </td><td>  17 </td><td>  18 </td><td>  nineteen </td><td>  20 </td><td>  21 </td><td>  22 </td><td>  23 </td><td>  24 </td><td>  25 </td><td>  26 </td><td>  27 </td><td>  28 </td><td>  29 </td><td>  thirty </td><td>  31 </td></tr><tr><td>  four </td><td>  100 </td><td>  224 </td><td>  14 </td><td>  52 </td><td>  141 </td><td>  239 </td><td>  129 </td><td>  28 </td><td>  193 </td><td>  105 </td><td>  248 </td><td>  200 </td><td>  eight </td><td>  76 </td><td>  113 </td></tr></tbody></table><table><tbody><tr><td>  32 </td><td>  33 </td><td>  34 </td><td>  35 </td><td>  36 </td><td>  37 </td><td>  38 </td><td>  39 </td><td>  40 </td><td>  41 </td><td>  42 </td><td>  43 </td><td>  44 </td><td>  45 </td><td>  46 </td><td>  47 </td></tr><tr><td>  five </td><td>  138 </td><td>  101 </td><td>  47 </td><td>  225 </td><td>  36 </td><td>  15 </td><td>  33 </td><td>  53 </td><td>  147 </td><td>  142 </td><td>  218 </td><td>  240 </td><td>  18 </td><td>  130 </td><td>  69 </td></tr></tbody></table><table><tbody><tr><td>  48 </td><td>  49 </td><td>  50 </td><td>  51 </td><td>  52 </td><td>  53 </td><td>  54 </td><td>  55 </td><td>  56 </td><td>  57 </td><td>  58 </td><td>  59 </td><td>  60 </td><td>  61 </td><td>  62 </td><td>  63 </td></tr><tr><td>  29 </td><td>  181 </td><td>  194 </td><td>  125 </td><td>  106 </td><td>  39 </td><td>  249 </td><td>  185 </td><td>  201 </td><td>  154 </td><td>  9 </td><td>  120 </td><td>  77 </td><td>  228 </td><td>  114 </td><td>  166 </td></tr></tbody></table><table><tbody><tr><td>  64 </td><td>  65 </td><td>  66 </td><td>  67 </td><td>  68 </td><td>  69 </td><td>  70 </td><td>  71 </td><td>  72 </td><td>  73 </td><td>  74 </td><td>  75 </td><td>  76 </td><td>  77 </td><td>  78 </td><td>  79 </td></tr><tr><td>  6 </td><td>  191 </td><td>  139 </td><td>  98 </td><td>  102 </td><td>  221 </td><td>  48 </td><td>  253 </td><td>  226 </td><td>  152 </td><td>  37 </td><td>  179 </td><td>  sixteen </td><td>  145 </td><td>  34 </td><td>  136 </td></tr></tbody></table><table><tbody><tr><td>  80 </td><td>  81 </td><td>  82 </td><td>  83 </td><td>  84 </td><td>  85 </td><td>  86 </td><td>  87 </td><td>  88 </td><td>  89 </td><td>  90 </td><td>  91 </td><td>  92 </td><td>  93 </td><td>  94 </td><td>  95 </td></tr><tr><td>  54 </td><td>  208 </td><td>  148 </td><td>  206 </td><td>  143 </td><td>  150 </td><td>  219 </td><td>  189 </td><td>  241 </td><td>  210 </td><td>  nineteen </td><td>  92 </td><td>  131 </td><td>  56 </td><td>  70 </td><td>  64 </td></tr></tbody></table><table><tbody><tr><td>  96 </td><td>  97 </td><td>  98 </td><td>  99 </td><td>  100 </td><td>  101 </td><td>  102 </td><td>  103 </td><td>  104 </td><td>  105 </td><td>  106 </td><td>  107 </td><td>  108 </td><td>  109 </td><td>  110 </td><td>  111 </td></tr><tr><td>  thirty </td><td>  66 </td><td>  182 </td><td>  163 </td><td>  195 </td><td>  72 </td><td>  126 </td><td>  110 </td><td>  107 </td><td>  58 </td><td>  40 </td><td>  84 </td><td>  250 </td><td>  133 </td><td>  186 </td><td>  61 </td></tr></tbody></table><table><tbody><tr><td>  112 </td><td>  113 </td><td>  114 </td><td>  115 </td><td>  116 </td><td>  117 </td><td>  118 </td><td>  119 </td><td>  120 </td><td>  121 </td><td>  122 </td><td>  123 </td><td>  124 </td><td>  125 </td><td>  126 </td><td>  127 </td></tr><tr><td>  202 </td><td>  94 </td><td>  155 </td><td>  159 </td><td>  ten </td><td>  21 </td><td>  121 </td><td>  43 </td><td>  78 </td><td>  212 </td><td>  229 </td><td>  172 </td><td>  115 </td><td>  243 </td><td>  167 </td><td>  87 </td></tr></tbody></table><table><tbody><tr><td>  128 </td><td>  129 </td><td>  130 </td><td>  131 </td><td>  132 </td><td>  133 </td><td>  134 </td><td>  135 </td><td>  136 </td><td>  137 </td><td>  138 </td><td>  139 </td><td>  140 </td><td>  141 </td><td>  142 </td><td>  143 </td></tr><tr><td>  7 </td><td>  112 </td><td>  192 </td><td>  247 </td><td>  140 </td><td>  128 </td><td>  99 </td><td>  13 </td><td>  103 </td><td>  74 </td><td>  222 </td><td>  237 </td><td>  49 </td><td>  197 </td><td>  254 </td><td>  24 </td></tr></tbody></table><table><tbody><tr><td>  144 </td><td>  145 </td><td>  146 </td><td>  147 </td><td>  148 </td><td>  149 </td><td>  150 </td><td>  151 </td><td>  152 </td><td>  153 </td><td>  154 </td><td>  155 </td><td>  156 </td><td>  157 </td><td>  158 </td><td>  159 </td></tr><tr><td>  227 </td><td>  165 </td><td>  153 </td><td>  119 </td><td>  38 </td><td>  184 </td><td>  180 </td><td>  124 </td><td>  17 </td><td>  68 </td><td>  146 </td><td>  217 </td><td>  35 </td><td>  32 </td><td>  137 </td><td>  46 </td></tr></tbody></table><table><tbody><tr><td>  160 </td><td>  161 </td><td>  162 </td><td>  163 </td><td>  164 </td><td>  165 </td><td>  166 </td><td>  167 </td><td>  168 </td><td>  169 </td><td>  170 </td><td>  171 </td><td>  172 </td><td>  173 </td><td>  174 </td><td>  175 </td></tr><tr><td>  55 </td><td>  63 </td><td>  209 </td><td>  91 </td><td>  149 </td><td>  188 </td><td>  207 </td><td>  205 </td><td>  144 </td><td>  135 </td><td>  151 </td><td>  178 </td><td>  220 </td><td>  252 </td><td>  190 </td><td>  97 </td></tr></tbody></table><table><tbody><tr><td>  176 </td><td>  177 </td><td>  178 </td><td>  179 </td><td>  180 </td><td>  181 </td><td>  182 </td><td>  183 </td><td>  184 </td><td>  185 </td><td>  186 </td><td>  187 </td><td>  188 </td><td>  189 </td><td>  190 </td><td>  191 </td></tr><tr><td>  242 </td><td>  86 </td><td>  211 </td><td>  171 </td><td>  20 </td><td>  42 </td><td>  93 </td><td>  158 </td><td>  132 </td><td>  60 </td><td>  57 </td><td>  83 </td><td>  71 </td><td>  109 </td><td>  65 </td><td>  162 </td></tr></tbody></table><table><tbody><tr><td>  192 </td><td>  193 </td><td>  194 </td><td>  195 </td><td>  196 </td><td>  197 </td><td>  198 </td><td>  199 </td><td>  200 </td><td>  201 </td><td>  202 </td><td>  203 </td><td>  204 </td><td>  205 </td><td>  206 </td><td>  207 </td></tr><tr><td>  31 </td><td>  45 </td><td>  67 </td><td>  216 </td><td>  183 </td><td>  123 </td><td>  164 </td><td>  118 </td><td>  196 </td><td>  23 </td><td>  73 </td><td>  236 </td><td>  127 </td><td>  12 </td><td>  111 </td><td>  246 </td></tr></tbody></table><table><tbody><tr><td>  208 </td><td>  209 </td><td>  210 </td><td>  211 </td><td>  212 </td><td>  213 </td><td>  214 </td><td>  215 </td><td>  216 </td><td>  217 </td><td>  218 </td><td>  219 </td><td>  220 </td><td>  221 </td><td>  222 </td><td>  223 </td></tr><tr><td>  108 </td><td>  161 </td><td>  59 </td><td>  82 </td><td>  41 </td><td>  157 </td><td>  85 </td><td>  170 </td><td>  251 </td><td>  96 </td><td>  134 </td><td>  177 </td><td>  187 </td><td>  204 </td><td>  62 </td><td>  90 </td></tr></tbody></table><table><tbody><tr><td>  224 </td><td>  225 </td><td>  226 </td><td>  227 </td><td>  228 </td><td>  229 </td><td>  230 </td><td>  231 </td><td>  232 </td><td>  233 </td><td>  234 </td><td>  235 </td><td>  236 </td><td>  237 </td><td>  238 </td><td>  239 </td></tr><tr><td>  203 </td><td>  89 </td><td>  95 </td><td>  176 </td><td>  156 </td><td>  169 </td><td>  160 </td><td>  81 </td><td>  eleven </td><td>  245 </td><td>  22 </td><td>  235 </td><td>  122 </td><td>  117 </td><td>  44 </td><td>  215 </td></tr></tbody></table><table><tbody><tr><td>  240 </td><td>  241 </td><td>  242 </td><td>  243 </td><td>  244 </td><td>  245 </td><td>  246 </td><td>  247 </td><td>  248 </td><td>  249 </td><td>  250 </td><td>  251 </td><td>  252 </td><td>  253 </td><td>  254 </td><td>  255 </td></tr><tr><td>  79 </td><td>  174 </td><td>  213 </td><td>  233 </td><td>  230 </td><td>  231 </td><td>  173 </td><td>  232 </td><td>  116 </td><td>  214 </td><td>  244 </td><td>  234 </td><td>  168 </td><td>  80 </td><td>  88 </td><td>  175 </td></tr></tbody></table></div></div><br><br>  Example.  Here I will represent all the bytes in the form of decimal numbers from 0 to 255. The original data block: <br> <code>64 196 132  84 196 196 242 194   4 132  20  37  34  16 236  17</code> <br>  The 2nd version with the correction level H is used. In this case, you need to create 28 bytes of correction (table 5) and use the generating polynomial (table 6): <br> <code>168 223 200 104 224 234 108 180 110 190 195 147 205  27 232 201  21  43 245  87  42 195 212 119 242  37   9 123</code> <br>  Create an array (prepared array) for 28 elements and fill it with data bytes: <br> <code>64 196 132  84 196 196 242 194   4 132  20  37  34  16 236  17   0   0   0   0   0   0   0   0   0   0   0   0</code> <br>  I will paint in detail the first step of the cycle, the rest in the form of a finished array.  The first element of the array is 64. We remove it from the prepared array: <br> <code>196 132  84 196 196 242 194   4 132  20  37  34  16 236  17   0   0   0   0   0   0   0   0   0   0   0   0   0</code> <br>  In table 8, we find a match for it - 6;  add 255 this number to each number of the generating polynomial: <br> <code>174 229 206 110 230 240 114 186 116 196 201 153 211  33 238 207  27  49 251  93  48 201 218 125 248  43  15 129</code> <br>  For each number of the generating polynomial, we find the correspondence in table 7: <br> <code>241 122  83 103 244  44  62 110 248 200  56 146 178  39  11 166  12 140 216 182  70  56  43  51  27 119  38  23</code> <br>  And we perform the operation of bitwise addition modulo 2 with the prepared array: <br> <code>53 254   7 163  48 222 252 106 124 220  29 176 162 203  26 166  12 140 216 182  70  56  43  51  27 119  38  23</code> <br>  Repeat these steps 16 times (16 bytes of data).  The result will be the following correction bytes: <br> <code>16  85  12 231  54  54 140  70 118  84  10 174 235 197  99 218  12 254 246   4 190  56  39 217 115 189 193  24</code> <br> <br><div class="spoiler">  <b class="spoiler_title">All steps create correction bytes in the example.</b> <div class="spoiler_text"><ol><li> <code>53 254   7 163  48 222 252 106 124 220  29 176 162 203  26 166  12 140 216 182  70  56  43  51  27 119  38  23</code> </li> <li> <code>88 135 181 100 195 209  67  42 120 103  75 204  49 123 234  32  53  11 134  32 223 208 235 172 113  56  81 191</code> </li> <li> <code>190  23  10  28 136 239  91  71 190 168 253  92  58 109  11 233 139 182 213  21 200 218 171 107   5 152 211 189</code> </li> <li> <code>228  45 104 109 161 181 177  87  87 252 124  67  75  80  92  99   7   5 181 129 178 139 129 144 140 151  52 165</code> </li> <li> <code>2 255  79 129 134  24 109 176  20 223 154  13 100 152  14  67 222 187  27 207 140  88 143  56 195  45  52 143</code> </li> <li> <code>26  93 185 156  60 134  13  37  17 219 197  54 203  22 176 174  81 245   0 114  47  71 202 248  80 160 251 151</code> </li> <li> <code>112 115 153 158  15 102 215 113  52 175 247 102 182   8 125  91 147  82 144 173 110  11  38  66 251 209 169  61</code> </li> <li> <code>15  78 183   5 213 230 209 248  21 105  76 199  65   7  16 193  91 121  47  32 241  12  49 154 134 191 143  94</code> </li> <li> <code>51 192 177 158   8 129  60  20  94  56 225 203   4  84 213  46 160 232 158  78 225  23   7 180  97  14  53   7</code> </li> <li> <code>84   7 192 114 240  49 231  91 211  88 117 156  91 156 106  28 114  98  50 152 105 185 103 155 143 138 221  27</code> </li> <li> <code>90  14 140 115 176  11 131  74  31  13  39 199  42 189  39 147 164  92 245 157 142 220 138  15 164  75  82 232</code> </li> <li> <code>210  60  37 117 118 196 134  17  26 133  62  21 175 184  75   8  54  43 167 186 179 115 250 133  11  15 240  42</code> </li> <li> <code>172  41 101  21 220  18 111  12  96   8 155 252 130 250  45  22 214 227  54  41  81 116 201 160 144  41 179  98</code> </li> <li> <code>68 192 132 243  69  97 198  45   7 233  26   3  45 174 155 233 187  43 112  69 244  47 123 251 143 183  24 254</code> </li> <li> <code>230 218 208  22 221  33 116  11 144  80 182  27 186 140  25 253 238  61  30 163 135 206  41 202  86  90  48  36</code> </li> <li> <code>16  85  12 231  54  54 140  70 118  84  10 174 235 197  99 218  12 254 246   4 190  56  39 217 115 189 193  24</code> </li> </ol><br></div></div><br><br><h2>  Combining blocks </h2><br>  We have several data blocks and as many blocks of correction bytes, they need to be combined into one stream of bytes.  This is done as follows: from each data block, one byte of information is taken in turn, when the queue reaches the last block, a byte is taken from it, and the queue goes to the first block.  This continues until bytes in each block run out.  If there are no more bytes in the current block, then it is skipped (this happens when the usual blocks are already empty, and in the added blocks there is one byte).  Similarly, you need to do with blocks of bytes correction.  They are taken in the same order as the corresponding data blocks. <br><br>  The result should be something like this: &lt;1st byte of 1st data block&gt; &lt;1st byte of 2nd data block&gt; ... &lt;1st byte of nth data block&gt; &lt;2nd byte 1st data block&gt; ... &lt;(m - 1) -th byte of the 1st data block&gt; ... &lt;(m - 1) -th byte of the n-th data block&gt; &lt;m-th byte of k-th data block&gt; ... &lt;m-th byte of n-th data block&gt; &lt;1st byte of 1st correction byte block&gt; &lt;1st byte of 2nd correction byte block&gt; ... &lt;1st byte n th block of correction bytes&gt; &lt;2nd byte of 1st correction byte block&gt; ... &lt;lth byte of 1st correction byte block&gt; ... &lt;lth byte of nth correction byte block&gt;.  Here n is the number of data blocks, m is the number of bytes per data block of ordinary blocks, l is the number of correction bytes, k is the number of data blocks minus the number of padded data blocks (those with 1 more byte). <br><br><h2>  Placing information on the QR code </h2><br>  We have a byte sequence, which is ready to be placed on the canvas.  Canvas consists of modules - elementary squares. <br><br><img src="https://habrastorage.org/storage2/b56/038/b09/b56038b09b8dc9e2ead2ea83539c56fb.jpg"><br><br><h4>  Basic elements </h4><br>  The size of the QR code depends only on the version.  For the first version, this is 21 modules, and the sizes of the older versions are determined from table 9. In general, it shows the locations of the alignment patterns (more on that later), but the canvas size can be defined as the last number + 7 modules.  I want to draw your attention that the indent, a frame of white modules 4 modules wide, is a full-fledged part of a QR code, and it cannot be ignored.  Despite this, I indicate the width of the width of the part with black modules and start the report with its upper left corner ((0, 0) - the upper left module of the upper left search pattern). <br><br><div class="spoiler">  <b class="spoiler_title">Table 9. The location of the leveling patterns.</b> <div class="spoiler_text">  The top line is the version number. <br><table><tbody><tr><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td><td>  6 </td><td>  7 </td><td>  eight </td></tr><tr><td>  - </td><td>  18 </td><td>  22 </td><td>  26 </td><td>  thirty </td><td>  34 </td><td>  6, 22, 38 </td><td>  6, 24, 42 </td></tr></tbody></table><table><tbody><tr><td>  9 </td><td>  ten </td><td>  eleven </td><td>  12 </td><td>  13 </td></tr><tr><td>  6, 26, 46 </td><td>  6, 28, 50 </td><td>  6, 30, 54 </td><td>  6, 32, 58 </td><td>  6, 34, 62 </td></tr></tbody></table><table><tbody><tr><td>  14 </td><td>  15 </td><td>  sixteen </td><td>  17 </td><td>  18 </td></tr><tr><td>  6, 26, 46, 66 </td><td>  6, 26, 48, 70 </td><td>  6, 26, 50, 74 </td><td>  6, 30, 54, 78 </td><td>  6, 30, 56, 82 </td></tr></tbody></table><table><tbody><tr><td>  9 </td><td>  20 </td><td>  21 </td><td>  22 </td><td>  23 </td></tr><tr><td>  6, 30, 58, 86 </td><td>  6, 34, 62, 90 </td><td>  6, 28, 50, 72, 94 </td><td>  6, 26, 50, 74, 98 </td><td>  6, 30, 54, 78, 102 </td></tr></tbody></table><table><tbody><tr><td>  24 </td><td>  25 </td><td>  26 </td><td>  27 </td><td>  28 </td></tr><tr><td>  6, 28, 54, 80, 106 </td><td>  6, 32, 58, 84, 110 </td><td>  6, 30, 58, 86, 114 </td><td>  6, 34, 62, 90, 118 </td><td>  6, 26, 50, 74, 98, 122 </td></tr></tbody></table><table><tbody><tr><td>  29 </td><td>  thirty </td><td>  31 </td><td>  32 </td></tr><tr><td>  6, 30, 54, 78, 102, 126 </td><td>  6, 26, 52, 78, 104, 130 </td><td>  6, 30, 56, 82, 108, 134 </td><td>  6, 34, 60, 86, 112, 138 </td></tr></tbody></table><table><tbody><tr><td>  33 </td><td>  34 </td><td>  35 </td><td>  36 </td></tr><tr><td>  6, 30, 58, 86, 114, 142 </td><td>  6, 34, 62, 90, 118, 146 </td><td>  6, 30, 54, 78, 102, 126, 150 </td><td>  6, 24, 50, 76, 102, 128, 154 </td></tr></tbody></table><table><tbody><tr><td>  37 </td><td>  38 </td><td>  39 </td><td>  40 </td></tr><tr><td>  6, 28, 54, 80, 106, 132, 158 </td><td>  6, 32, 58, 84, 110, 136, 162 </td><td>  6, 26, 54, 82, 110, 138, 166 </td><td>  6, 30, 58, 86, 114, 142, 170 </td></tr></tbody></table></div></div><br><br><h4>  Search patterns </h4><br>  These are patterns that are a black square measuring 3 by 3 modules, which is surrounded by a frame of white modules, which is surrounded by a frame of black modules, which is surrounded by a frame of white modules only from those sides where there is no indent.  Search patterns are located in the upper and left corners (3 total). <br><br><h4>  Leveling patterns </h4><br>  Used from the 2nd version, they are a black square with a size of 1 to 1 module, which is surrounded by a frame of white modules, which is surrounded by a frame of black modules, as a result, this pattern has a size of 5 by 5. The places where the alignment patterns are located, are shown in table 9. More precisely, there are grid nodes vertically and horizontally, where the central modules of the patterns are located.  For example, if the table says 6, 22, 38, this means that the centers of the modules should be located at the following points: (6, 6), (6, 22), (6, 38), (22, 6), (22 , 22), (22, 38), (38, 6), (38, 22), (38, 38).  There is one important condition: the leveling patterns should not be layered on the search patterns.  That is, when the version is greater than 6, there should be no alignment patterns at the points (first, first), (first, last) and (last, first) alignment patterns.  In our example, these are (6, 6), (6, 38) and (38, 6). <br><br><h4>  Sync bands </h4><br>  Everything is simple here.  The stripes start from the lower-right black module of the upper left search pattern and go, alternating black and white modules, down and to the right to opposite search patterns.  When layered on the leveling pattern, it should remain unchanged. <br><br><h4>  Version code </h4><br>  These elements are used starting with the 7th version.  The version code is duplicated in 2 places, and it is mirrored, that is, specifying the color of the module in coordinates (x, y), you can safely specify the same color in coordinates (y, x).  The modules in these places are arranged in accordance with the figure below and table 10 (1 - black, 0 - white). <br><br><img src="https://habrastorage.org/storage2/e4e/75d/f44/e4e75df4432f8da99320e1b132e47d77.jpg"><br><br><div class="spoiler">  <b class="spoiler_title">Table 10. Version codes.</b> <div class="spoiler_text"><table><tbody><tr><td>  Version </td><td>  Version code </td></tr><tr><td>  7 </td><td>  000010 011110 100110 </td></tr><tr><td>  eight </td><td>  010001 011100 111000 </td></tr><tr><td>  9 </td><td>  110111 011000 000100 </td></tr><tr><td>  ten </td><td>  101001 111110 000000 </td></tr><tr><td>  eleven </td><td>  001111 111010 111100 </td></tr><tr><td>  12 </td><td>  001101 100100 011010 </td></tr><tr><td>  13 </td><td>  101011 100000 100110 </td></tr><tr><td>  14 </td><td>  110101 000110 100010 </td></tr><tr><td>  15 </td><td>  010011 000010 011110 </td></tr><tr><td>  sixteen </td><td>  011100 010001 011100 </td></tr><tr><td>  17 </td><td>  111010 010101 100000 </td></tr><tr><td>  18 </td><td>  100100 110011 100100 </td></tr><tr><td>  nineteen </td><td>  000010 110111 011000 </td></tr><tr><td>  20 </td><td>  000000 101001 111110 </td></tr><tr><td>  21 </td><td>  100110 101101 000010 </td></tr><tr><td>  22 </td><td>  111000 001011 000110 </td></tr><tr><td>  23 </td><td>  011110 001111 111010 </td></tr><tr><td>  24 </td><td>  001101 001101 100100 </td></tr><tr><td>  25 </td><td>  101011 001001 011000 </td></tr><tr><td>  26 </td><td>  110101 101111 011100 </td></tr><tr><td>  27 </td><td>  010011 101011 100000 </td></tr><tr><td>  28 </td><td>  010001 110101 000110 </td></tr><tr><td>  29 </td><td>  110111 110001 111010 </td></tr><tr><td>  thirty </td><td>  101001 010111 111110 </td></tr><tr><td>  31 </td><td>  001111 010011 000010 </td></tr><tr><td>  32 </td><td>  101000 011000 101101 </td></tr><tr><td>  33 </td><td>  001110 011100 010001 </td></tr><tr><td>  34 </td><td>  010000 111010 010101 </td></tr><tr><td>  35 </td><td>  110110 111110 101001 </td></tr><tr><td>  36 </td><td>  110100 100000 001111 </td></tr><tr><td>  37 </td><td>  010010 100100 110011 </td></tr><tr><td>  38 </td><td>  001100 000010 110111 </td></tr><tr><td>  39 </td><td>  101010 000110 001011 </td></tr><tr><td>  40 </td><td>  111001 000100 010101 </td></tr></tbody></table></div></div><br><br><h4>  Mask code and correction level </h4><br>  This code, as well as the previous one, is duplicated in 2 places: next to the upper left search pattern and next to the lower and right search patterns (the element has a break).  In it, the mask code is ciphered in a special way (more on this later) and the code of the correction level.  The finished codes are given in Table 11. The mask is determined at the very last step, when all the rest of the free space is filled with data.  Due to the fact that the mask is selected on the basis of the best option (for this you need to go through all the masks), you will have to return more than once to adding the mask code and the level of correction.  Do not add this item yet.  The figure shows exactly where and in which direction the modules of this element are lined up, and also the module, which is always black, is marked in red. <br><br><img src="https://habrastorage.org/storage2/c37/a82/f76/c37a82f7617392b9f2b732e9eb8fce95.jpg"><br><br><div class="spoiler">  <b class="spoiler_title">Table 11. Mask codes and level of correction.</b> <div class="spoiler_text"><table><tbody><tr><td>  Correction level </td><td>  Mask code </td><td>  Code </td></tr><tr><td>  L </td><td>  0 </td><td>  111011111000100 </td></tr><tr><td>  L </td><td>  one </td><td>  111001011110011 </td></tr><tr><td>  L </td><td>  2 </td><td>  111110110101010 </td></tr><tr><td>  L </td><td>  3 </td><td>  111100010011101 </td></tr><tr><td>  L </td><td>  four </td><td>  110011000101111 </td></tr><tr><td>  L </td><td>  five </td><td>  110001100011000 </td></tr><tr><td>  L </td><td>  6 </td><td>  110110001000001 </td></tr><tr><td>  L </td><td>  7 </td><td>  110100101110110 </td></tr><tr><td>  M </td><td>  0 </td><td>  10,1010000010010 </td></tr><tr><td>  M </td><td>  one </td><td>  101000100100101 </td></tr><tr><td>  M </td><td>  2 </td><td>  101111001111100 </td></tr><tr><td>  M </td><td>  3 </td><td>  101101101001011 </td></tr><tr><td>  M </td><td>  four </td><td>  100010111111001 </td></tr><tr><td>  M </td><td>  five </td><td>  100000011001110 </td></tr><tr><td>  M </td><td>  6 </td><td>  100111110010111 </td></tr><tr><td>  M </td><td>  7 </td><td>  100101010100000 </td></tr><tr><td>  Q </td><td>  0 </td><td>  011010101011111 </td></tr><tr><td>  Q </td><td>  one </td><td>  011000001101000 </td></tr><tr><td>  Q </td><td>  2 </td><td>  011111100110001 </td></tr><tr><td>  Q </td><td>  3 </td><td>  011101000000110 </td></tr><tr><td>  Q </td><td>  four </td><td>  010010010110100 </td></tr><tr><td>  Q </td><td>  five </td><td>  010000110000011 </td></tr><tr><td>  Q </td><td>  6 </td><td>  010111011011010 </td></tr><tr><td>  Q </td><td>  7 </td><td>  010101111101101 </td></tr><tr><td>  H </td><td>  0 </td><td>  001011010001001 </td></tr><tr><td>  H </td><td>  one </td><td>  001001110111110 </td></tr><tr><td>  H </td><td>  2 </td><td>  001110011100111 </td></tr><tr><td>  H </td><td>  3 </td><td>  001100111010000 </td></tr><tr><td>  H </td><td>  four </td><td>  000011101100010 </td></tr><tr><td>  H </td><td>  five </td><td>  000001001010101 </td></tr><tr><td>  H </td><td>  6 </td><td>  000110100001100 </td></tr><tr><td>  H </td><td>  7 </td><td>  000100000111011 </td></tr></tbody></table></div></div><br><br><h3>  Adding data </h3><br>  All the remaining free space on the canvas is divided into columns: every 2 modules, no matter what is in these modules, except for the vertical sync band, which is simply skipped.  Filling starts from the bottom right corner, goes within the bounds from right to left, from bottom to top.  If the current module is busy (for example, a sync stripe or an alignment pattern), then it is simply skipped.  If the top of the bar is reached, the movement continues from the upper right corner of the bar, which is located to the left, and goes from top to bottom.  Reaching the bottom, the movement continues from the lower right corner of the column, which is located to the left, and goes upwards.  And so on, until all the free space is filled. <br><br><img src="https://habrastorage.org/storage2/67e/4df/9c9/67e4df9c9e5b0067edb5220f46b3edce.jpg"><br><br>  Filling takes place bit by bit from the data bytes, with 1 being the black module and 0 being the white.  If there is not enough data, the remaining space is filled with zero modules. <br><br>  In this case, one of the masks is superimposed on each module.  The total number of masks is 8 pieces (from 0 to 7), their list is in table 12. If the expression from the table is zero, the color of the module is inverted, otherwise it remains unchanged.  The mask applies only to data modules. <br><br><div class="spoiler">  <b class="spoiler_title">Table 12. Masks.</b> <div class="spoiler_text">  X is a column, Y is a string,% is the remainder of a division, / is integer division. <br><table><tbody><tr><td>  Mask number </td><td>  Mask </td></tr><tr><td>  0 </td><td>  (X + Y)% 2 </td></tr><tr><td>  one </td><td>  Y% 2 </td></tr><tr><td>  2 </td><td>  X% 3 </td></tr><tr><td>  3 </td><td>  (X + Y)% 3 </td></tr><tr><td>  four </td><td>  (X / 3 + Y / 2)% 2 </td></tr><tr><td>  five </td><td>  (X * Y)% 2 + (X * Y)% 3 </td></tr><tr><td>  6 </td><td>  ((X * Y)% 2 + (X * Y)% 3)% 2 </td></tr><tr><td>  7 </td><td>  ((X * Y)% 3 + (X + Y)% 2)% 2 </td></tr></tbody></table></div></div><br><br>  The mask is chosen in different ways: some always use the same, others are random each time, but the specification insists that each mask is evaluated and the most optimal is chosen.  The method with the assessment requires more time, but there is nothing terrible if an optimal mask is not chosen, so it is not necessary to use it, but I will still tell about it.  The mask code and correction level (see above) depends on the selected mask; now is the time to add this element. <br><br><h3>  Choosing the best mask </h3><br>  This part is optional, and if you have already decided on the choice of mask and added data to the canvas, your QR code is ready. <br><br>  The essence of this procedure is to generate a QR code with each of the eight masks, to charge each penalty points according to certain rules and choose a mask with the least amount of points.  Remember that together with the data, the element of the mask code and the level of correction is added to the canvas again. <br><br><h4>  Rule 1 </h4><br>  Horizontally and vertically for every 5 or more modules of the same color running in a row, the number of points equal to the length of this section is minus 2. In this and all other rules, the indent is not considered, everything is limited to the main field. <br><br><img src="https://habrastorage.org/storage2/1a7/376/93d/1a737693dcf981ad18fb11c0fa469d54.jpg"><br><br><h4>  Rule 2 </h4><br>  For each square of modules of the same color with a size of 2 by 2, 3 points are awarded. <br><br><img src="https://habrastorage.org/storage2/659/7cf/f8c/6597cff8c3d9c0a482051cbf353936b5.jpg"><br><br><h4>  Rule 3 </h4><br>  For each sequence of modules CHBCHCHBCH, with 4 white modules on one side (or from 2 at once), 40 points are added (vertically or horizontally).  Simply put, for these elements: <br><br><img src="https://habrastorage.org/storage2/a5f/8ec/f56/a5f8ecf56691de4caf612af40cac620d.jpg"><br><br>  In our example, there are only 3 such elements, for which he gets 120 additional points (these elements need not intersect with the search pattern): <br><br><img src="https://habrastorage.org/storage2/1c2/e06/f1e/1c2e06f1ecf8c642478f181fdd2c44f8.jpg"><br><br><h4>  Rule 4 </h4><br>  The number of points in this step depends on the ratio of the number of black and white modules.  The closer it is to the 50% to 50% ratio, the better.  The first thing to do is to divide the number of black modules by the total number of modules (again, the indent is not considered). <br> <code>203 / 441 = 0.46032</code> <br>  Then multiply the result by 100 and subtract 50. <br> <code>0.46032 * 100 - 50 = -3.986</code> <br>  Discard the decimal part and take the number modulo. <br> <code>-3.986 -&gt; 3</code> <br>  Multiply the resulting number by 2. <br> <code>3 * 2 = 6</code> <br>  Add this number to the total number of penalty points. <br><br><h4>  Total </h4><br>  In the end, for each mask, you will get your number of penalty points, you will only have to choose the one with less points and your QR code is completely ready.  As practice shows, the lower the mask number, the greater the likelihood that it will be the best, so for optimization you can choose the best mask not from all, but, for example, from 4. <br><br><h2>  Articles taken as a basis </h2><br><ul><li>  <a href="http://www.matchadesign.com/_blog/Matcha_Design_Blog/post/QR_Code_Demystified_-_Part_1/">QR Code Demystified - Part 1</a> </li><li>  <a href="http://www.matchadesign.com/_blog/Matcha_Design_Blog/post/QR_Code_Demystified_-_Part_2/">QR Code Demystified - Part 2</a> </li><li>  <a href="http://www.matchadesign.com/_blog/Matcha_Design_Blog/post/QR_Code_Demystified_-_Part_3/">QR Code Demystified - Part 3</a> </li><li>  <a href="http://www.matchadesign.com/_blog/Matcha_Design_Blog/post/QR_Code_Demystified_-_Part_4/">QR Code Demystified - Part 4</a> </li><li>  <a href="http://www.matchadesign.com/_blog/Matcha_Design_Blog/post/QR_Code_Demystified_-_Part_5/">QR Code Demystified - Part 5</a> </li><li>  <a href="http://www.matchadesign.com/_blog/Matcha_Design_Blog/post/QR_Code_Demystified_-_Part_6/">QR Code Demystified - Part 6</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/172525/">https://habr.com/ru/post/172525/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../172511/index.html">Clay is, no life - new Curiosity results</a></li>
<li><a href="../172513/index.html">Installing ORACLE 11gR2 DBMS on a stand-alone server running ORACLE Linux 6 OS</a></li>
<li><a href="../172519/index.html">Curiosity has confirmed that life can exist on Mars</a></li>
<li><a href="../172521/index.html">The obsession with mailing efficiency: a couple of tests and stories</a></li>
<li><a href="../172523/index.html">Part 2: if I have 30.000 rubles, where can I invest them?</a></li>
<li><a href="../172527/index.html">The results of the promotion "Great eight applications"</a></li>
<li><a href="../172529/index.html">Scientists have proven the superiority of the Terran race in StarCraft 2</a></li>
<li><a href="../172531/index.html">Ruby on Rails and Nginx: effectively giving away large files</a></li>
<li><a href="../172535/index.html">Convenient accounting of working hours. UPD</a></li>
<li><a href="../172539/index.html">Was the accounting?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>