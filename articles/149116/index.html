<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>List of functions for getting the text of errors from their codes (WinAPI)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 I present an overview of the functions for obtaining the text of errors from their codes, which is presented in the Error Lookup program. 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>List of functions for getting the text of errors from their codes (WinAPI)</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/a22/7dd/3f3/a227dd3f3c05fc03f4a6115cea339767.jpg"><br><br>  Hello! <br><br>  I present an overview of the functions for obtaining the text of errors from their codes, which is presented in the <a href="http://www.henrypp.org/%3Fproduct%3Derrorlookup">Error Lookup</a> program. <br><a name="habracut"></a><br><h5>  1. <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms679351%2528v%3Dvs.85%2529.aspx">FormatMessage</a> </h5><br>  This function is not so simple as it may seem (most of the functionality in the above program is implemented through it, because this function can be configured to receive NOT only system error codes, see clause 2).  By default, the function gives the system error code. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Example:</b> <br>  The function gets the error text from <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms681381%2528v%3Dvs.85%2529.aspx">the system error code.</a> <br><br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//      FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM, NULL, 1337, 0, lpszBuffer, cchBuffer, NULL); printf("Error Code: %d\nError Name: %s", 1337, lpszBuffer);</span></span></code> </pre> <br><br>  <b>Result:</b> <br><pre> <code class="hljs vhdl"><span class="hljs-literal"><span class="hljs-literal">Error</span></span> Code: <span class="hljs-number"><span class="hljs-number">1337</span></span> <span class="hljs-literal"><span class="hljs-literal">Error</span></span> <span class="hljs-literal"><span class="hljs-literal">Text</span></span>:     .</code> </pre> <br><h5>  2. <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms679351%2528v%3Dvs.85%2529.aspx">FormatMessage + FORMAT_MESSAGE_FROM_HMODULE</a> </h5><br>  When the <b>FORMAT_MESSAGE_FROM_HMODULE</b> flag is <b>set,</b> you can load a list of errors from the module (DLL) which contains the list of errors: <br><ul><li>  ntdll.dll - list of <a href="http://msdn.microsoft.com/en-us/library/cc704588%2528v%3Dprot.10%2529.aspx">NTSTATUS</a> errors </li><li>  wininet.dll - <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa385465%2528v%3Dvs.85%2529.aspx">Wininet</a> error <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa385465%2528v%3Dvs.85%2529.aspx">list</a> </li><li>  pdh.dll - List of <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa373046%2528v%3Dvs.85%2529.aspx">Performance Data Helper</a> errors </li><li>  ... add in the comments if you know more </li></ul><br><br>  You can also use this method in your projects; you just need to pack a <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa381027(v%3Dvs.85).aspx">message table</a> resource inside the library (thanks to <a href="https://habrahabr.ru/users/ertaquo/" class="user_link">ertaquo</a> ) <br><br>  <b>Example:</b> <br>  In this example, the error base is loaded from the <u>ntdll.dll</u> file. <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  ntdll.dll    NTSTATUS  FormatMessage(FORMAT_MESSAGE_FROM_HMODULE, LoadLibrary("ntdll.dll"), -1072037872, 0, lpszBuffer, cchBuffer, NULL); printf("Error Code: %d\nError Name: %s", -1072037872, lpszBuffer);</span></span></code> </pre><br><br>  <b>Result:</b> <br><pre> <code class="hljs vhdl"><span class="hljs-literal"><span class="hljs-literal">Error</span></span> Code: -<span class="hljs-number"><span class="hljs-number">1072037872</span></span> <span class="hljs-literal"><span class="hljs-literal">Error</span></span> <span class="hljs-literal"><span class="hljs-literal">Text</span></span>:          .</code> </pre> <br><h5>  3. <a href="http://msdn.microsoft.com/ja-jp/library/bb173057%2528v%3Dvs.85%2529.aspx">DXGetErrorString</a> &amp; <a href="http://msdn.microsoft.com/ja-jp/library/bb173056%2528v%3Dvs.85%2529.aspx">DXGetErrorDescription</a> </h5><br><ul><li>  DXGetErrorString - function for getting the name of the error (for example <u>ERROR_INVALID_SID</u> ) </li><li>  DXGetErrorDescription - a function to get the error text (for example, <u>The security ID structure is invalid.</u> ) </li></ul><br><br>  <b>Example:</b> <br>  An example of getting a DirectX error: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   DirectX  printf("Error Code: %d\nError Name: %s\nError Text: %s", 1337, DXGetErrorString((HRESULT)1337), DXGetErrorDescription((HRESULT)1337));</span></span></code> </pre> <br><br>  <b>Result:</b> <br><pre> <code class="hljs vhdl"><span class="hljs-literal"><span class="hljs-literal">Error</span></span> Code: <span class="hljs-number"><span class="hljs-number">1337</span></span> <span class="hljs-literal"><span class="hljs-literal">Error</span></span> Name: ERROR_INVALID_SID <span class="hljs-literal"><span class="hljs-literal">Error</span></span> <span class="hljs-literal"><span class="hljs-literal">Text</span></span>: The security ID structure <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> invalid.</code> </pre> <br><h5>  4. <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa377539%2528v%3Dvs.85%2529.aspx">RasGetErrorString</a> </h5><br>  This function receives error text from the RAS function library. <br><br>  <b>Example:</b> <br>  The function gets the error text from <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb530704%2528v%3Dvs.85%2529.aspx">the RAS error code.</a> <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//    RAS  RasGetErrorString(633, lpszBuffer, cchBuffer); printf("Error Code %d\nError Text: %s", 633, lpszBuffer);</span></span></code> </pre><br><br>  <b>Result:</b> <br><pre> <code class="hljs 1c">Error Code: <span class="hljs-number"><span class="hljs-number">633</span></span> Error Text:  <span class="hljs-keyword"><span class="hljs-keyword"></span></span>      <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span> .</code> </pre> <br><h5>  5. <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa365951%2528v%3Dvs.85%2529.aspx">GetIpErrorString</a> </h5><br>  This function is to get the error text from the IP Helper Library function library. <br><br>  <b>Example:</b> <br>  The function gets the error text <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//    IP Helper Library GetIpErrorString(12, lpszBuffer, cchBuffer); printf("Error Code %d\nError Text: %s", 12, lpszBuffer);</span></span></code> </pre> <br><br>  <b>Result:</b> <br><pre> <code class="hljs vhdl"><span class="hljs-literal"><span class="hljs-literal">Error</span></span> Code: <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-literal"><span class="hljs-literal">Error</span></span> <span class="hljs-literal"><span class="hljs-literal">Text</span></span>: General <span class="hljs-literal"><span class="hljs-literal">failure</span></span>.</code> </pre> <br><h5>  Bonus </h5><ul><li>  <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms680357%2528v%3Dvs.85%2529.aspx">Message Table structure (see clause 2)</a> </li><li>  <a href="http://www.codeproject.com/Articles/14444/Enumerating-Message-Table-Contents">Message Table parsing example</a> </li></ul><br><h5>  Links to download the program </h5><ul><li>  <a href="">Setup</a> </li><li>  <a href="">Portable</a> </li><li>  <a href="">Source (C ++)</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/149116/">https://habr.com/ru/post/149116/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149110/index.html">To whom MTS trusts its advertisement</a></li>
<li><a href="../149111/index.html">Master class on the results of the competition ‚ÄúBig $ h ku‚Äù in Ne√∫ron hackspace</a></li>
<li><a href="../149112/index.html">NASA Mars Rover successfully primarsy.</a></li>
<li><a href="../149114/index.html">AMatch - checking input parameters in PHP</a></li>
<li><a href="../149115/index.html">A gentleman's set of modules for Drupal 7</a></li>
<li><a href="../149117/index.html">Mobile update 2GIS: outside and inside</a></li>
<li><a href="../149119/index.html">Thunderbolt: lightning-fast interface</a></li>
<li><a href="../149120/index.html">JetBrains News Digest July 26th to August 5th</a></li>
<li><a href="../149121/index.html">Active Directory Replication Status Tool: New utility from Microsoft to determine AD replication status</a></li>
<li><a href="../149124/index.html">Big update Yandex. Navigator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>