<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Functional JavaScript: five ways to find the arithmetic average of array elements and the .reduce () method</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Array iteration methods are similar to ‚Äústarting drugs‚Äù (these are, of course, not drugs; and I‚Äôm not saying that drugs are good; they are just a figu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Functional JavaScript: five ways to find the arithmetic average of array elements and the .reduce () method</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habr.com/ru/company/ruvds/blog/322850/">Array iteration methods are</a> similar to ‚Äústarting drugs‚Äù (these are, of course, not drugs; and I‚Äôm not saying that drugs are good; they are just a figure of speech).  Because of them, many "sit down" on functional programming.  The thing is, they are incredibly comfortable.  In addition, most of these methods are very simple to understand.  Methods like <code>.map()</code> and <code>.filter()</code> take just one callback argument and allow you to solve simple problems.  But it <code>.reduce()</code> that the <code>.reduce()</code> method causes certain difficulties for many.  To understand it is a little more difficult. <br><br> <a href="https://habr.com/ru/company/ruvds/blog/458030/"><img src="https://habrastorage.org/webt/zd/ig/jp/zdigjpelbgmyf4qdprvkrxo5bu4.png"></a> <br><a name="habracut"></a><br>  I already <a href="https://jrsinclair.com/articles/2019/functional-js-do-more-with-reduce/">wrote</a> about why I think that <code>.reduce()</code> creates a lot of problems.  In part, this is due to the fact that many manuals demonstrate the use of <code>.reduce()</code> only when processing numbers.  That's why I wrote about how many tasks that do not imply the execution of arithmetic operations can be solved using <code>.reduce()</code> .  But what if you absolutely need to work with numbers? <br><br>  A typical case of using <code>.reduce()</code> looks like the calculation of the arithmetic average of the elements of an array.  At first glance it seems that there is nothing special in this task.  But it is not so simple.  The fact is that before you calculate the average, you need to find the following indicators: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  The total sum of the values ‚Äã‚Äãof the elements of the array. </li><li>  The length of the array. </li></ol><br>  It‚Äôs pretty easy to figure out.  And the calculation of average values ‚Äã‚Äãfor numeric arrays is also not a complex operation.  Here is an elementary example: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">average</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">nums</span></span></span><span class="hljs-function">) </span></span>{    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> nums.reduce(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) =&gt;</span></span> (a + b)) / nums.length; }</code> </pre> <br>  As you can see, there are no special incomprehensibilities.  But the task becomes harder if you have to work with more complex data structures.  What if we have an array of objects?  What if some objects from this array need to be filtered?  What if objects need to extract certain numerical values?  In this scenario, the calculation of the average for the elements of the array is already a bit more complicated task. <br><br>  In order to deal with this, we will solve the learning problem (it is based on <a href="https://learn.freecodecamp.org/javascript-algorithms-and-data-structures/functional-programming/use-the-reduce-method-to-analyze-data/">this</a> task with FreeCodeCamp).  We will solve it in five different ways.  Each of them has its own advantages and disadvantages.  An analysis of these five approaches to solving this problem will show how flexible JavaScript can be.  And I hope that decision analysis will give you some food for thought about how to use <code>.reduce()</code> in real projects. <br><br><h2>  <font color="#3AC1EF">Task Overview</font> </h2><br>  Suppose that we have an array of objects describing slang expressions of the Victorian era.  You need to filter out those expressions that are not found in Google Books (the <code>found</code> property of the corresponding objects is <code>false</code> ) and find the average rating of the popularity of expressions.  Here is what similar data might look like (it is taken <a href="https://books.google.com/ngrams/graph%3Fcontent%3Ddoing%2Bthe%2Bbear%252Cbone%2Bshaker%252Cdamfino%252Cdonkey%25E2%2580%2599s%2Bbreakfast%252Cmind%2Bthe%2Bgrease%252Crational%2Bcostume%252Crain%2Bnapper%252Csmothering%2Ba%2Bparrot%252Ckatterzem%26year_start%3D1860%26year_end%3D2008%26corpus%3D15%26smoothing%3D3%26share%3D%26direct_url%3Dt1%253B%252Cdoing%2520the%2520bear%253B%252Cc0%253B.t1%253B%252Cbone%2520shaker%253B%252Cc0%253B.t1%253B%252Cdamfino%253B%252Cc0%253B.t1%253B%252Cdonkey%2520%2527s%2520breakfast%253B%252Cc0%253B.t1%253B%252Cmind%2520the%2520grease%253B%252Cc0%253B.t1%253B%252Crational%2520costume%253B%252Cc0">from here</a> ): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> victorianSlang = [           term: <span class="hljs-string"><span class="hljs-string">'doing the bear'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-number"><span class="hljs-number">108</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'katterzem'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'bone shaker'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-number"><span class="hljs-number">609</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'smothering a parrot'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'damfino'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-number"><span class="hljs-number">232</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'rain napper'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'donkey'</span></span>s breakfast<span class="hljs-string"><span class="hljs-string">',        found: true,        popularity: 787,    },           term: '</span></span>rational costume<span class="hljs-string"><span class="hljs-string">',        found: true,        popularity: 513,    },           term: '</span></span>mind the grease<span class="hljs-string"><span class="hljs-string">',        found: true,        popularity: 154,    }, ];</span></span></code> </pre> <br>  Consider 5 ways to find the average estimate of the popularity of expressions from this array. <br><br><h2>  <font color="#3AC1EF">1. Solution of the problem without using .reduce () (imperative cycle)</font> </h2><br>  In our first approach to solving the problem, the <code>.reduce()</code> method will not be used.  If you have not come across methods for iterating arrays before, then I hope the analysis of this example will clarify the situation for you a bit. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> popularitySum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> itemsFound = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> len = victorianSlang.length; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> item = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; len; i++) {    item = victorianSlang[i];    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item.found) {        popularitySum = item.popularity + popularitySum;        itemsFound = itemsFound + <span class="hljs-number"><span class="hljs-number">1</span></span>;   } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> averagePopularity = popularitySum / itemsFound; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Average popularity:"</span></span>, averagePopularity);</code> </pre> <br>  If you are familiar with JavaScript, you will easily understand this example.  In fact, the following happens here: <br><br><ol><li>  We initialize the variables <code>itemsFound</code> and <code>itemsFound</code> .  The first variable, <code>popularitySum</code> , stores the overall popularity of expressions.  And the second variable, <code>itemsFound</code> , (that's a surprise) stores the number of expressions found. </li><li>  Then we initialize the <code>len</code> constant and the <code>item</code> variable, which will be useful to us when traversing the array. </li><li>  In the <code>for</code> loop, counter <code>i</code> incremented until its value reaches the index value of the last element of the array. </li><li>  Inside the loop, we take the element of the array that we want to explore.  The element is accessed using the <code>victorianSlang[i]</code> construction. </li><li>  Then we find out if the given expression is found in the book collection. </li><li>  If the expression in the books is found - we take the value of its popularity rating and add to the value of the variable <code>popularitySum</code> . </li><li>  At the same time, we also increase the counter of found expressions - <code>itemsFound</code> . </li><li>  And finally, we find the average value, dividing the <code>popularitySum</code> by <code>itemsFound</code> . </li></ol><br>  So, we coped with the task.  Perhaps the solution we got was not particularly beautiful, but it does its job.  Using methods to iterate arrays will make it a little cleaner.  Let's take a look at whether we can, and really, ‚Äúclean‚Äù this solution. <br><br><h2>  <font color="#3AC1EF">2. Simple solution ‚Ññ1: .filter (), .map () and finding the amount using .reduce ()</font> </h2><br>  Let's, before the first attempt to use the array methods to solve the problem, break it into small parts.  Namely, here is what we need to do: <br><br><ol><li>  Select objects representing expressions that are in the Google Books collection.  Here you can use the <code>.filter()</code> method. </li><li>  Extract expressions from the object of evaluation.  To solve this subtask, the <code>.map()</code> method is suitable. </li><li>  Calculate the amount of estimates.  Here we can resort to using our old friend <code>.reduce()</code> . </li><li>  And finally, find the average value of the estimates. </li></ol><br>  Here is how it looks in code: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   // ---------------------------------------------------------------------------- function isFound(item) {    return item.found; }; function getPopularity(item) {    return item.popularity; } function addScores(runningTotal, popularity) {    return runningTotal + popularity; } //  // ---------------------------------------------------------------------------- //  ,      . const foundSlangTerms = victorianSlang.filter(isFound); //   ,   . const popularityScores = foundSlangTerms.map(getPopularity); //     .    ,    //   ,  reduce     ,  0. const scoresTotal = popularityScores.reduce(addScores, 0); //       . const averagePopularity = scoresTotal / popularityScores.length; console.log("Average popularity:", averagePopularity);</span></span></code> </pre> <br>  Look at the <code>addScore</code> function, and the line where <code>.reduce()</code> called.  Notice that the <code>addScore</code> takes two parameters.  The first, <code>runningTotal</code> , is known as a battery.  It stores the sum of the values.  Its value changes every time when we iterate over the array and execute the <code>return</code> .  The second parameter, <code>popularity</code> , is a separate element of the array that we process.  At the very beginning of the array <code>addScore</code> , the <code>return</code> in <code>addScore</code> has never been executed yet.  This means that the <code>runningTotal</code> value <code>runningTotal</code> not yet been set automatically.  Therefore, by calling <code>.reduce()</code> , we pass this value to the method that needs to be written to <code>runningTotal</code> at the very beginning.  This is the second parameter passed to <code>.reduce()</code> . <br><br>  So, we used to solve the problem the methods of array iteration.  The new version of the solution turned out much cleaner than the previous one.  In other words, the decision was more declarative.  We do not tell JavaScript about exactly how to execute the loop, do not follow the indexes of the elements of the arrays.  Instead, we declare simple auxiliary functions of small size and combine them.  All the hard work is done for us by the array <code>.filter()</code> , <code>.map()</code> and <code>.reduce()</code> .  This approach to solving such problems is more expressive.  These array methods are much more complete than a cycle can do; they inform us of the intent contained in the code. <br><br><h2>  <font color="#3AC1EF">3. Simple solution number 2: the use of multiple batteries</font> </h2><br>  In the previous version of the solution, we created a whole bunch of intermediate variables.  For example - <code>foundSlangTerms</code> and <code>popularityScores</code> .  In our case, this solution is quite acceptable.  But what if we set a more complex goal for the device code?  It would be nice if we could use the <a href="https://en.wikipedia.org/wiki/Fluent_interface">fluent interface</a> design pattern in the program.  With this approach, we could chain the calls of all functions and be able to do without intermediate variables.  However, there is one problem waiting for us.  Pay attention to the fact that we need to get the value of <code>popularityScores.length</code> .  If we are going to combine everything into a chain, then we need some other way to find the number of elements in the array.  The number of elements in the array plays the role of the divisor in calculating the average value.  Let's see if we can change the approach to solving the problem so that everything can be done by combining the method calls into a chain.  We will do this by tracking two values ‚Äã‚Äãwhen sorting the elements of an array, that is, using a ‚Äúdouble battery‚Äù. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   // --------------------------------------------------------------------------------- function isFound(item) {    return item.found; }; function getPopularity(item) {    return item.popularity; } //    ,  return,   . function addScores({totalPopularity, itemCount}, popularity) {    return {        totalPopularity: totalPopularity + popularity,        itemCount:    itemCount + 1,    }; } //  // --------------------------------------------------------------------------------- const initialInfo  = {totalPopularity: 0, itemCount: 0}; const popularityInfo = victorianSlang.filter(isFound)    .map(getPopularity)    .reduce(addScores, initialInfo); //       . const {totalPopularity, itemCount} = popularityInfo; const averagePopularity = totalPopularity / itemCount; console.log("Average popularity:", averagePopularity);</span></span></code> </pre> <br>  Here we, for work with two values, used an object in the reduction function.  With each pass through the array, performed using <code>addScrores</code> , we update the total value of the popularity rating and the number of elements.  It is important to note that these two values ‚Äã‚Äãare represented as a single object.  With this approach, we can "deceive" the system and store two entities within the same return value. <br><br>  The <code>addScrores</code> function was a bit more complex than the function with the same name of the previous example.  But now it turns out that we can use a single chain of method calls to perform all operations with an array.  As a result of array processing, a <code>popularityInfo</code> object is obtained, which stores everything needed to find the average.  This makes the call chain neat and simple. <br><br>  If you feel the desire to improve this code, then you can experiment with it.  For example - you can remake it to get rid of the set of intermediate variables.  This code can even try to put in one line. <br><br><h2>  <font color="#3AC1EF">4. Composition of functions without the use of dot notation</font> </h2><br>  If you are new to functional programming, or if you think that functional programming is too difficult, you can skip this section.  His parsing will benefit you if you are already familiar with <code>curry()</code> and <code>compose()</code> .  If you want to delve into this topic - take a look at <a href="https://jrsinclair.com/articles/2016/gentle-introduction-to-functional-javascript-intro/">this</a> material on functional programming in JavaScript, and, in particular, on the <a href="https://jrsinclair.com/articles/2016/gentle-introduction-to-functional-javascript-functions/">third</a> part of the series, in which it is included. <br><br>  We are programmers who adhere to the functional approach.  This means that we strive to build complex functions from other functions ‚Äî small and simple.  So far, in the course of considering various options for solving the problem, we have reduced the number of intermediate variables.  As a result, the solution code became simpler and simpler.  But what if you bring this idea to the extreme?  What if you try to get rid of all intermediate variables?  And even try to get away from some of the parameters? <br><br>  You can create a function to calculate the average using only the <code>compose()</code> function, without using variables.  We call it ‚Äúprogramming without using fine notation‚Äù or ‚Äúimplicit programming‚Äù.  In order to write such programs will need a lot of auxiliary functions. <br><br>  Sometimes this code shocks people.  This is due to the fact that this approach is very different from the conventional one.  But I found out that writing code in the style of implicit programming is one of the fastest ways to get into the essence of functional programming.  Therefore, I can advise you to try this technique in any personal project.  But I want to say that perhaps you should not write in the style of implicit programming the code that other people have to read. <br><br>  So, back to our task of building a system for computing average values.  For the sake of space, we will use the switch functions here.  Usually, it is usually better to use named functions.  <a href="https://davidwalsh.name/i-dont-hate-arrow-functions">Here is a</a> good article on this topic.  This allows us to obtain better stack trace results in the event of errors. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   // ---------------------------------------------------------------------------- const filter = p =&gt; a =&gt; a.filter(p); const map   = f =&gt; a =&gt; a.map(f); const prop  = k =&gt; x =&gt; x[k]; const reduce = r =&gt; i =&gt; a =&gt; a.reduce(r, i); const compose = (...fns) =&gt; (arg) =&gt; fns.reduceRight((arg, fn) =&gt; fn(arg), arg); //  -   "blackbird combinator". //     : https://jrsinclair.com/articles/2019/compose-js-functions-multiple-parameters/ const B1 = f =&gt; g =&gt; h =&gt; x =&gt; f(g(x))(h(x)); //  // ---------------------------------------------------------------------------- //   sum,    . const sum = reduce((a, i) =&gt; a + i)(0); //     . const length = a =&gt; a.length; //       . const div = a =&gt; b =&gt; a / b; //   compose()        . //    compose()     . const calcPopularity = compose(    B1(div)(sum)(length),    map(prop('popularity')),    filter(prop('found')), ); const averagePopularity = calcPopularity(victorianSlang); console.log("Average popularity:", averagePopularity);</span></span></code> </pre> <br>  If all this code seems to you utter nonsense - do not worry about it.  I included it here as an intellectual exercise, not to upset you. <br><br>  In this case, the main work goes to the <code>compose()</code> function.  If you read its contents from the bottom up, it turns out that the calculations begin with filtering the array by the property of its <code>found</code> elements.  Then we retrieve the property of the <code>popularity</code> elements with <code>map()</code> .  After that we use the so-called ‚Äú <a href="https://jrsinclair.com/articles/2019/compose-js-functions-multiple-parameters/">blackbird combinator</a> ‚Äù.  This entity is represented as a function <code>B1</code> , which is used to perform two computation passes on one set of input data.  To better understand this, take a look at these examples: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,  , : const avg1 = B1(div)(sum)(length); const avg2 = arr =&gt; div(sum(arr))(length(arr)); const avg3 = arr =&gt; ( sum(arr) / length(arr) ); const avg4 = arr =&gt; arr.reduce((a, x) =&gt; a + x, 0) / arr.length;</span></span></code> </pre> <br>  Again, if you again did not understand - do not worry.  This is just a demonstration of the fact that you can write in JavaScript in very different ways.  The beauty of this language is made up of such features. <br><br><h2>  <font color="#3AC1EF">5. Solution of the problem in one pass with the calculation of the cumulative average value</font> </h2><br>  All the above program constructions cope well with the solution of our problem (including the imperative cycle).  Those that use the <code>.reduce()</code> method have something in common.  They are based on breaking the problem into small fragments.  These fragments are then assembled in various ways.  Analyzing these solutions, you may have noticed that in them we go around the array three times.  There is a feeling that it is ineffective.  It would be nice if there was a way to process the array and return the result in one pass.  Such a method exists, but its application will require resort to mathematics. <br><br>  In order to calculate the average value for the elements of the array in one pass, we need a new method.  We need to find a way to calculate the average using the previously calculated average and new value.  Let's look for this method using algebra. <br><br>  The average value of <code>n</code> numbers can be found using the following formula: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea8/922/a8a/ea8922a8ad59e55aa604bf01c72b55e4.png"></div><br>  In order to find out the average <code>n + 1</code> numbers, the same formula is suitable, but in another record: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/77c/ee8/a1f/77cee8a1fe717b88a55b2f2af6f222e2.png"></div><br>  This formula is the same as this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/651/b3a/0ca/651b3a0caa501b140e23cbce68a96720.png"></div><br>  And the same as this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f7b/e1b/da4/f7be1bda4b12343eee3dde51d80f95c0.png"></div><br>  If you convert this a little bit, you get the following: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/038/165/1b5/0381651b520c5136458129c1882a44af.png"></div><br>  If you do not see in all this sense - do not worry.  The result of all these transformations is that with the help of the last formula we can calculate the average value in the process of a single bypass of the array.  To do this, you need to know the value of the current element, the average value calculated at the previous step, and the number of elements.  In addition, most of the calculations can be made to the reducer function: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//      // ---------------------------------------------------------------------------- function averageScores({avg, n}, slangTermInfo) {    if (!slangTermInfo.found) {        return {avg, n};       return {        avg: (slangTermInfo.popularity + n * avg) / (n + 1),        n:  n + 1,    }; } //  // ---------------------------------------------------------------------------- //       . const initialVals    = {avg: 0, n: 0}; const averagePopularity = victorianSlang.reduce(averageScores, initialVals).avg; console.log("Average popularity:", averagePopularity);</span></span></code> </pre> <br>  By using this approach, the required value can be found by going around the array only once.  Other approaches use one pass to filter the array, another one to extract the necessary data from it, and another one to find the sum of the values ‚Äã‚Äãof the elements.  Here, everything fits in a single pass through the array. <br><br>  Note that this does not necessarily make the calculations more efficient.  With this approach, it is necessary to perform more calculations.  When entering each new value, we perform multiplication and division operations, doing this to keep the current mean value up to date.  In other versions of this task, we divide one number into another only once - at the end of the program.  But this approach is much more efficient in terms of memory usage.  Intermediate arrays are not used here, as a result we have to store in memory only an object with two values. <br><br>         .        .     ,     .   .  ,   ,      . <br><br><h2> <font color="#3AC1EF"> ?</font> </h2><br>              ?   ,     . ,    -  . , ,      ,       .         ,       .       ,           .          ,      ,       . <br><br> ,  -     ,           .       ,         ?   .      .  ‚Äî   . <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>         : <br><br><ol><li>   <code>.reduce()</code> . </li><li>    <code>.filter()</code>  <code>.map()</code> ,   ‚Äî  <code>.reduce()</code>       . </li><li>   ,      . </li><li>     . </li><li>         . </li></ol><br>  , -,     ?    ‚Äî  .      -  ‚Äî     ,          : <br><br><ol><li>    ,     .      ‚Äî   . </li><li>    ,    ,    ‚Äî     . </li><li> , ,        ‚Äî   ,     . </li></ol><br>  <b>Dear readers!</b>        JavaScript-? <br><br><div style="text-align:center;"> <a href="https://ruvds.com/news/read/104"><img src="https://habrastorage.org/getpro/habr/post_images/a09/9e4/5a8/a099e45a81c9dafd3a3673edd5ea415b.jpg"></a> </div></div><p>Source: <a href="https://habr.com/ru/post/458030/">https://habr.com/ru/post/458030/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../458010/index.html">The Adventures of the Elusive Malvar, Part II: Secretive VBA Scripts</a></li>
<li><a href="../458014/index.html">FEDOR robot - training with the new crew of the ISS and the first space tasks</a></li>
<li><a href="../458020/index.html">Digest of July IT events</a></li>
<li><a href="../458022/index.html">Fingerprinting via banner ads? Now it's common</a></li>
<li><a href="../458026/index.html">Comparison of serialization formats</a></li>
<li><a href="../45804/index.html">The unifying power of user experience</a></li>
<li><a href="../458040/index.html">From Moscow to Tomsk. The story of one move</a></li>
<li><a href="../458042/index.html">How I organized machine learning trainings at NSU</a></li>
<li><a href="../458044/index.html">Provincial IS - Stagnation or Development?</a></li>
<li><a href="../458046/index.html">Cheat Sheet by Gradle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>