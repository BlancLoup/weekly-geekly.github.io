<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Clouds are even cheaper</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Surely you've heard about Amazon EC2, Rackspace, and the like. Maybe even enjoyed. Personally, I sometimes need a personal VPN server. For these purpo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Clouds are even cheaper</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/0a0/652/55a/0a065255ab64d7300bef3925c7fc342b.jpg" align="right">  Surely you've heard about Amazon EC2, Rackspace, and the like.  Maybe even enjoyed.  Personally, I sometimes need a personal VPN server.  For these purposes, I have long kept a micro-instance on Amazon, provided for free during the first year.  Plus, I used Amazon Glacier archives, which, with its price of ‚Äú1 cent per gigabyte per month,‚Äù can also be considered almost free.  But the year ended and it became necessary to pay for EC2.  My archives also grew decently and the costs of Glacier likewise ceased to please. <br><br>  Randomly ran past review of the service DigitalOcean in the beginning left me indifferent.  Well, cloud service, well, virtuals.  Well, yes, a bit cheaper (but not so very much), something similar to the Glacier seems to be gone, and indeed it‚Äôs not worth it. <br><br>  I was very wrong.  Below we will explain how to make a VPN server on the basis of DigitalOcean a couple of dozen times cheaper than the same on Amazon and the archive storage service, infinitely cheaper than Glacier. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  VPN server </h4><br>  How to raise a VPN server on the Internet in Linux is a dime a dozen.  Here <a href="http://habrahabr.ru/post/107631/">again</a> , here are <a href="http://habrahabr.ru/post/157547/">two</a> , but the script is guaranteed to work on the image of Ubuntu 12.04 x64 Server, which is provided by DigitalOcean. <br><br><div class="spoiler">  <b class="spoiler_title">Installing and configuring the VPN server</b> <div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash echo "Select on option:" echo "1) Set up new PoPToP server AND create one user" echo "2) Create additional users" read x if test $x -eq 1; then echo "Enter username that you want to create (eg. client1 or john):" read u echo "Specify password that you want the server to use:" read p # get the VPS IP ip=`ifconfig eth0 | grep 'inet addr' | awk {'print $2'} | sed s/.*://` echo echo "Downloading and Installing PoPToP" apt-get update apt-get install pptpd echo echo "Creating Server Config" cat &gt; /etc/ppp/pptpd-options &lt;&lt;END name pptpd refuse-pap refuse-chap refuse-mschap require-mschap-v2 require-mppe-128 ms-dns 8.8.8.8 ms-dns 8.8.4.4 proxyarp nodefaultroute lock nobsdcomp END # setting up pptpd.conf echo "option /etc/ppp/pptpd-options" &gt; /etc/pptpd.conf echo "logwtmp" &gt;&gt; /etc/pptpd.conf echo "localip $ip" &gt;&gt; /etc/pptpd.conf echo "remoteip 10.1.0.1-100" &gt;&gt; /etc/pptpd.conf # adding new user echo "$u * $p *" &gt;&gt; /etc/ppp/chap-secrets echo echo "Forwarding IPv4 and Enabling it on boot" cat &gt;&gt; /etc/sysctl.conf &lt;&lt;END net.ipv4.ip_forward=1 END sysctl -p echo echo "Updating IPtables Routing and Enabling it on boot" iptables -t nat -A POSTROUTING -j SNAT --to $ip # saves iptables routing rules and enables them on-boot iptables-save &gt; /etc/iptables.conf cat &gt; /etc/network/if-pre-up.d/iptables &lt;&lt;END #!/bin/sh iptables-restore &lt; /etc/iptables.conf END chmod +x /etc/network/if-pre-up.d/iptables cat &gt;&gt; /etc/ppp/ip-up &lt;&lt;END ifconfig ppp0 mtu 1400 END echo echo "Restarting PoPToP" /etc/init.d/pptpd restart echo echo "Server setup complete!" echo "Connect to your VPS at $ip with these credentials:" echo "Username:$u ##### Password: $p" # runs this if option 2 is selected elif test $x -eq 2; then echo "Enter username that you want to create (eg. client1 or john):" read u echo "Specify password that you want the server to use:" read p # get the VPS IP ip=`ifconfig venet0:0 | grep 'inet addr' | awk {'print $2'} | sed s/.*://` # adding new user echo "$u * $p *" &gt;&gt; /etc/ppp/chap-secrets echo echo "Addtional user added!" echo "Connect to your VPS at $ip with these credentials:" echo "Username:$u ##### Password: $p" else echo "Invalid selection, quitting." exit fi</span></span></code> </pre> <br></div></div><br><br>  Just run it, it will ask for the username / password for the VPN user - and that's it. <br><br>  All this can be raised on the cheapest DigitalOcean instance (for $ 5 per month) - one active VPN connection loads the processor by 4-6% and leaves 60% of the virtual virtual RAM free.  We are already seeing savings, since even a micro instance on Amazon costs about $ 15 a month, and here it's only $ 5.  But that's not all.  If you, like me, do not need a VPN server that works 24 hours a day (I use it at most a couple of times a week for a couple of hours - to see something that is inaccessible from our Slavic edges), then you can turn off the virtual machine.  At this point, an attentive reader will exclaim ‚ÄúAha!  And the author of the article, it turns out, is a fool-fool, and does not know that DigitalOcean takes money even for the virtual machine turned off! ‚Äù  No, I know.  For off - takes.  But for the remote - no, it does not take.  Therefore, immediately after setting up, we turn off our machine, take a snapshot from it - it will cost us about 4 cents and remove the virtual machine.  Everything, now we pay nothing. <br><br>  The beauty is that the VPN server does not contain any changing data, and every time we need a VPN, we simply restore the snapshot and virtual machine launches.  Do not need more - kill.  The most convenient way to do this is through the API Digital Ocean.  Here are some links that you can add to your browser bookmarks and use to quickly create and delete virtuals. <br><br><div class="spoiler">  <b class="spoiler_title">All images</b> <div class="spoiler_text"><pre>  https://api.digitalocean.com/images/?client_id=[client_id[&amp;api_key=[api_key] </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">All running virtuals</b> <div class="spoiler_text"><pre>  https://api.digitalocean.com/droplets/?client_id=[client_id[&amp;api_key=[api_key] </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Start VPN server</b> <div class="spoiler_text"><pre> <code class="javascript hljs">https:<span class="hljs-comment"><span class="hljs-comment">//api.digitalocean.com/droplets/new?client_id=[client_id]&amp;api_key=[api_key]&amp;name=VPN&amp;size_id=66&amp;image_id=[image_id]&amp;region_id=1</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Get link to delete VPN server</b> <div class="spoiler_text"><pre> <code class="javascript hljs">javascript: <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerText); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> el = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'a'</span></span>);el.href=<span class="hljs-string"><span class="hljs-string">'https://api.digitalocean.com/droplets/'</span></span>+ response.droplet.id+ <span class="hljs-string"><span class="hljs-string">'/destroy/?client_id=[client_id]&amp;api_key=[api_key]'</span></span>;el.innerText = <span class="hljs-string"><span class="hljs-string">'Destroy VPN server'</span></span>;<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.appendChild(el)})();</code> </pre><br><br></div></div><br><br>  A couple of nuances of use: <br><ol><li>  Do not forget to enter your <b>[client_id]</b> and <b>[api_key]</b> - they can be taken from the page <a href="https://www.digitalocean.com/api_access">www.digitalocean.com/api_access</a> </li><li>  In the link "Start VPN server" you need to enter the correct image number instead of <b>[image_id]</b> - it can be taken from the data on the first link ("All images"). </li><li>  The tab ‚ÄúGet a link to delete the VPN server‚Äù should be clicked with the tab open with the results of the start of the VPN server - this is needed in order to get the id of the created virtual machine from there.  The resulting link can be added to bookmarks (well, or just not to close the page in the browser). </li></ol><br><br>  From a click on a bookmark to a working VPN server it takes less than a minute.  As a result, my VPN costs for using it 10-15 hours a week are <b>$ 0.2 - $ 0.4 a month</b> . <br><br><h4>  Archive storage </h4><br>  There is no direct analogue to Glacier, as I have already said, in DigitalOcean.  But remember, I wrote above that it would cost us 4 cents to take a picture of a virtual machine?  Where does this figure come from?  Everything is simple - 2 cents for each gigabyte of data stored in the snapshot.  And pay attention - only saving is paid.  Nowhere on the site or forum is it indicated that some money is taken for storage.  People on the forum even offered to pay for data storage, but the answer from DigitalOcean was unequivocal - the <a href="https://www.digitalocean.com/community/questions/question-about-snapshot-pricing">payment was only at the time of the snapshot</a> .  Thus, if the 100 GB archive on Amazon will cost us $ 1 every month, then we will pay $ 2 for a one-time payment at DigitalOcean (well, plus payment for the virtual time while we load data - but these are just a few cents) and nothing more.  I haven‚Äôt found any restrictions on the storage periods of images or plans to change tariffs.  Plus, speed is added here (take data from Glacier oh, how not fast, but everything will be available within a couple of minutes) and convenience (Glacier sometimes annoys its protocol, but we can upload data to DigitalOcean virtual machine even via HTTP , even though torrents, even Dropbox - whatever we want, then we will install this virtual machine). <br><br><h4>  Morality </h4><br>  If you pay dozens of times more to everyone there "the best VPN-servers of the Internet" and "the most reliable file storage" - drop this thing.  Take the scripts \ links in the article and use. <br><br>  <b>PS</b> Many people wrote to me that they have questions about the installation.  Some people did not even believe that it was so simple and fast.  Especially for them, I made a video where a virtual machine is created in 2 minutes, a VPN server rises on it, and in Windows a VPN connection is created and connected.  Look better in high quality, but otherwise the font is too small. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/FymWVlGA5k8%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700253&amp;usg=ALkJrhi8iC-q_jaHOToVUL2zs16XvXOUUQ" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/183628/">https://habr.com/ru/post/183628/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../183618/index.html">Samsung announced GALAXY S4 zoom - the first smartphone with 10x optical zoom</a></li>
<li><a href="../183620/index.html">Verify site ownership in Webmaster Tools with Google Tag Manager</a></li>
<li><a href="../183622/index.html">June 28, 2013 Wall Street is waiting for "Quantum Dawn"</a></li>
<li><a href="../183624/index.html">Yandex.Money opened identification in Euroset</a></li>
<li><a href="../183626/index.html">Convenient torrentokachalkal managed through the web and android for a dedicated server</a></li>
<li><a href="../183630/index.html">HTML 5 Notifications API</a></li>
<li><a href="../183634/index.html">New design admin WordPress.com</a></li>
<li><a href="../183636/index.html">Study of the ‚Äúworking‚Äù diaphragm numbers of the lens on the example of Canon EF 1.8 / 50 II</a></li>
<li><a href="../183638/index.html">Algorithm seam carving for image resizing</a></li>
<li><a href="../183642/index.html">The digest of interesting news and materials from the world of PHP over the last two weeks, No. 19 (06/03/2013 - 06/17/2013)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>