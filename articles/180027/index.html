<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calculation of arithmetic expressions in a text editor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In his book, Interface: New Directions in Computer Systems Design, Jeff Raskin describes the ability to calculate arithmetic expressions right in the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calculation of arithmetic expressions in a text editor</h1><div class="post__text post__text-html js-mediator-article">  In his book, Interface: New Directions in Computer Systems Design, Jeff Raskin describes the ability to calculate arithmetic expressions right in the text editor window, without the need to run a calculator.  Being inspired by this book, as well as articles <a href="https://habrahabr.ru/users/boo1ean/" class="user_link">boo1ean</a> <a href="http://habrahabr.ru/post/137215/">"Translate selected text from any language into Russian"</a> and <a href="https://habrahabr.ru/users/imitsuran/" class="user_link">imitsuran</a> <a href="http://habrahabr.ru/post/120502/">"Fix keyboard layout a la Punto Switcher to bash"</a> decided to write an implementation of this idea for Linux OS.  As a result, we have a simple script called by a hot key that calculates the selected arithmetic expressions, replacing them with the results of calculations. <br><a name="habracut"></a><br><h4>  Decision </h4><br>  The script requires the following packages: xsel, xvkbd and bc.  Install: <br><br> <code>sudo aptitude install xsel xvkbd bc</code> <br> <br>  Next, open any text editor and write: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh PRECISION=4; SELECTION=$(xsel -o); if [ $SELECTION = "" ]; then exit 1; fi RESULT=$(echo "scale=$PRECISION;$SELECTION" | bc); if [ $RESULT ]; then BUFFER=$(xsel -b); echo -n "$RESULT" | xsel -b -i; xvkbd -xsendevent -text "\[Control_L]\[v]"; echo -n "$BUFFER" | xsel -b -i fi</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the variable PRECISION, we specify the accuracy of the decimal fraction (in the present embodiment, 4 decimal places).  In the SELECTION variable, we write the selected arithmetic expression, and if the selection is not empty, then we calculate its value using bc, the result is written to the RESULT variable.  If the result is not null, then we write the current contents of the clipboard to the BUFFER variable, rewrite the contents of the clipboard with the result of the calculation, and use the xvkbd utility to insert Ctrl + V via emulation (since the calculated expression is selected, the insertion will overwrite it with the result).  We return the contents of the clipboard to the user. <br><br>  Save the file, for example, under the name selcalc, grant permissions to execute and transfer to / usr / bin: <br><br> <code>sudo chmod +x ./selcalc &amp;&amp; sudo mv ./selcalc /usr/bin/</code> <br> <br>  We assign a hotkey to launch the script, for example, Ctrl + Shift + C (I used the standard GNOME 2 tools). <br><br><h4>  Using </h4><br><ul><li>  select the arithmetic expression </li><li>  press Ctrl + Shift + C </li><li>  in the place of the selected expression we see the result of the calculation </li></ul><br><br><h4>  Advantages and disadvantages </h4><br>  + Calculation of arithmetic expressions without the need to run the calculator <br>  + Support for complex expressions (in fact, any expressions that bc is capable of calculating, including managing the priorities of calculations, exponentiation, etc.) <br>  - Does not work in text editors that do not support pasting via Ctrl + V, it works crookedly in some editors (Mozilla Thunderbird, Skype) <br><br>  Tested in Open Office, Sublime Text 2, gedit, Pidgin, Nautilus (in file rename mode). <br><br>  The script can be downloaded <a href="https://dl.dropboxusercontent.com/u/15448112/selcalc">from the link</a> . </div><p>Source: <a href="https://habr.com/ru/post/180027/">https://habr.com/ru/post/180027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180015/index.html">Building HA systems based on Jboss AS 6</a></li>
<li><a href="../180017/index.html">Introduction to IBM Tivoli Monitoring</a></li>
<li><a href="../180019/index.html">SSI mapping when using a proxy on nginx and splitting the cache by language</a></li>
<li><a href="../180021/index.html">Enchanting arrangement of points above private space programs</a></li>
<li><a href="../180023/index.html">GSM Modem M95 from QUECTEL - mastering experience</a></li>
<li><a href="../180033/index.html">Google calls for a speedy transition to the VP9 codec</a></li>
<li><a href="../180037/index.html">Avast! removes calc.exe as a virus (2: 0)</a></li>
<li><a href="../180041/index.html">Mobile marketing and application design on AppClub {build, monetize} # 6 Kyiv</a></li>
<li><a href="../180043/index.html">The case of the maloksky safe</a></li>
<li><a href="../180047/index.html">Automated testing of a web application (MS Unit Testing Framework + Selenium WebDriver C #). Part 2.1: Selenium API wrapper - Browser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>