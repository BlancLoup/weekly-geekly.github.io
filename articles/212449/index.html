<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Connecting a Wacom Pro pen tablet to Linux or how bash helps artists</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you are a happy owner of Intuos Pro and a proud Linux user, you may have suffered the same failure as me. The fact is that at the time of this writ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Connecting a Wacom Pro pen tablet to Linux or how bash helps artists</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/bb5/4d4/ee7/bb54d4ee7ca585e7dc8c43adef818657.png"><br>  If you are a happy owner of Intuos Pro and a proud Linux user, you may have suffered the same failure as me.  The fact is that at the time of this writing, there was no normal support for the latest <a href="http://wacom.com/">Wacom</a> tablet <a href="http://wacom.com/">PCs</a> .  However, thanks to the Linux Wacom project and several bash scripts, this problem can be solved. <a name="habracut"></a><br><habracut><br>  The whole story began with the fact that I needed to draw a lot for my home project, and the old Genius tablet didn‚Äôt fit for that at all.  And it was bought by <a href="http://www.wacom.com/en/de/creative/intuos-pro-m">Wacom Intuos Pro Midlle</a> .  On a computer with Win7, it was very easy to install and configure.  I was particularly pleased with the ability to customize profiles to assign different functions to the keys on the device, depending on the application used.  Joy knew no bounds. <br><br>  Along with this, I realized that buying Photoshop for a project that does not generate income is not at all interesting.  The work of developers, however, as well as my freedom, I appreciate and therefore I do not use anything pirated.  The gaze was towards free software. <br><br>  Climbing the sites and forums and disliking the <a href="http://gimp.org/">Gimp</a> , I stopped at the program <a href="http://krita.org/">Krita</a> - a very convenient raster editor, with rich settings for brushes.  In order to immediately avoid holivar, I will say that Krita is not a replacement for Photoshop, but in terms of drawing it is sometimes more advanced. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  What is unlucky </h4><br>  By this time, I had to completely transfer to the computer with Ubuntu.  Remembering that I had always seen the Wacom section in the settings, I boldly connected the tablet wire.  And nothing ... Then I connected the wireless adapter.  No result.  Search and all sorts of tips - all the same.  At one time, I conjured with the settings of Genius and thought that there was a conflict somewhere.  Long wanted to try <a href="http://">Mint and Cinnamon</a> , I downloaded and fixed it.  Nothing again. <br><br>  The <a href="http://sourceforge.net/projects/linuxwacom/">Linux Wacom Tablet Project</a> came to the rescue, one of the main authors of which is Red Hat employee Peter Hatterer.  Not to say that everything was smooth from the first, but this sequence of actions with <a href="http://askubuntu.com/questions/368242/wacom-graphics-tablet-cth-480-ctl-480-not-detected-in-ubuntu-13-10">askubuntu</a> helped me: <br><ol><li>  Download the latest version of the input-wacom kernel driver from here: <br>  <a href="http://sourceforge.net/projects/linuxwacom/files/latest/download">http://sourceforge.net/projects/linuxwacom/files/latest/download</a> </li><li> If necessary, install the dependencies: <br> <code>sudo apt-get install build-essential libX11-dev libxi-dev x11proto-input-dev xserver-xorg-dev libxrandr-dev libncurses5-dev autoconf libtool</code> <br> <code>sudo apt-get install linux-headers-generic</code> <br> </li><li>  Unpacking <br> <code>tar xjvf input-wacom-0.20.0.tar.bz2</code> <br> </li><li>  Turn inside <br> <code>cd input-wacom-0.20.0 <br></code> <br> <code>./configure --prefix=/usr</code> <br> </li><li>  We put the drivers from the folder under our kernel (I have 3.7) <br> <code>sudo cp ./3.7/wacom.ko /lib/modules/`uname -r`/kernel/drivers/input/tablet/wacom.ko <br></code> <br> <code>sudo depmod -a</code> </li> </ol><br>  Depending on whether the tablet was connected, a reboot may be required. <br><br><h4>  Minutes of happiness </h4><br>  I was happy again, until I realized that only 2 buttons work, and the touch does not turn off when drawing with the stylus.  Under KDE and Gnome, there were <a href="http://sourceforge.net/apps/mediawiki/linuxwacom/index.php%3Ftitle%3DExternal_applications">GUIs</a> , and under my Cinnamon, I had to use the console utility xsetwacom, which later gave a more flexible configuration, and in conjunction with bash, additional features. <br><br>  The project site has examples of scripts with xsetwacom, but they are not designed for the version of Intuos Pro.  I had to experimentally determine the number of buttons (they are somewhat randomly scattered).  Plus, in the device list, the tablet is determined differently when connected with a wire \ without a wire. <br><br><h4>  Pretty advanced setup </h4><br>  I'm not a programmer, but I hoped that I could figure out the scripting language.  With output from xsetwacom and <a href="http://ru.wikipedia.org/wiki/Grep">grep</a> , the desired device is always substituted into the variable, and <a href="http://ubuntuforums.org/showthread.php%3Ft%3D1411620">notify-send</a> outputs the profile used. <br><div class="spoiler">  <b class="spoiler_title">Sample script for Krita</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ,   ,       DEVICE_STYLUS=`xsetwacom list dev | grep -E -o ".*stylus"` DEVICE_ERASER=`xsetwacom list dev | grep -E -o ".*eraser"` DEVICE_CURSOR=`xsetwacom list dev | grep -E -o ".*cursor"` DEVICE_PAD=`xsetwacom list dev | grep -E -o ".*pad"` DEVICE_TOUCH=`xsetwacom list dev | grep -E -o ".*touch"` #    . notify-send "Using Krita profile" #    #     2    1: MapToOutput 3286x1080+0+0 xsetwacom set "$DEVICE_STYLUS" MapToOutput 1920x1080+0+0 ##    xsetwacom set "$DEVICE_STYLUS" RawSample "2" # -      xsetwacom set "$DEVICE_STYLUS" Threshold "27" #    xsetwacom set "$DEVICE_STYLUS" PressureCurve "5 10 90 95" #    xsetwacom set "$DEVICE_STYLUS" TabletPCButton "off" #       xsetwacom set "$DEVICE_STYLUS" Mode "Absolute" #        xsetwacom set "$DEVICE_STYLUS" Button 1 "1" #   xsetwacom set "$DEVICE_STYLUS" Button 2 "3" #   xsetwacom set "$DEVICE_STYLUS" Button 3 "2" #   ##  xsetwacom set "$DEVICE_ERASER" RawSample "2" xsetwacom set "$DEVICE_ERASER" Threshold "27" xsetwacom set "$DEVICE_ERASER" PressureCurve "0 10 90 100" xsetwacom set "$DEVICE_ERASER" Mode "Absolute" xsetwacom set "$DEVICE_ERASER" Button 1 "1" ##   xsetwacom set "$DEVICE_PAD" Button 2 "key shift" xsetwacom set "$DEVICE_PAD" Button 3 "key ctrl" xsetwacom set "$DEVICE_PAD" Button 8 "key ctrl Z" xsetwacom set "$DEVICE_PAD" Button 9 "key ctrl shift A" # ,     #xsetwacom set "$DEVICE_PAD" Button 4 "key D" #xsetwacom set "$DEVICE_PAD" Button 5 "key E" xsetwacom set "$DEVICE_PAD" AbsWheelDown "5" #    xsetwacom set "$DEVICE_PAD" Button 1 "key E" #    xsetwacom set "$DEVICE_PAD" AbsWheelUp "4" #    xsetwacom set "$DEVICE_PAD" Button 10 "key ctrl K" xsetwacom set "$DEVICE_PAD" Button 11 "key ctrl M" xsetwacom set "$DEVICE_PAD" Button 12 "key O" xsetwacom set "$DEVICE_PAD" Button 13 "key I" xsetwacom set "$DEVICE_PAD" ScrollDistance "10" xsetwacom set "$DEVICE_PAD" TapTime "50"</span></span></code> </pre><br></div></div><br>  In principle, it is clear from the comments what each parameter is responsible for.  Notice how the physical keys are associated with their numbers within the program. <br><div class="spoiler">  <b class="spoiler_title">Connection</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/f09/e8b/890/f09e8b8904decc1a7e3aee735b8d4885.png"><br></div></div><br>  The next disappointment was that there were no profiles for various programs.  In principle, you can make several scripts and configure hot keys to activate each.  However, with frequent switching between applications, it begins to cause some inconvenience. <br><br><h4>  Bash to help </h4><br>  I understand that the implementation below is still that bike, but in practice it does its job well, without loading the system. <br>  And so, we will need: <br><ul><li>  <a href="http://ru.wikipedia.org/wiki/AWK">awk</a> - to find the window ID in the output.  It was possible to do with a cut or grep, but after reading the discussion, I decided to implement it on awk </li><li>  <a href="http://www.xfree86.org/current/xprop.1.html">xprop</a> - used to get the current window in focus </li><li>  <a href="http://packages.ubuntu.com/ru/lucid/wmctrl">wmctrl</a> - to get a list of IDs of windows that have the desired keyword, for example, Firefox - to reassign keys when switching to a browser.  There are also cases when several windows are running, for example, with the name Terminal, they have different IDs, and the profile should be the same </li></ul><br><div class="spoiler">  <b class="spoiler_title">Script to switch profiles</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash awk_string1="/" awk_string2="/{print \$1}" window_in_focus_old="" while true do #ID ,    window_in_focus=`xprop -root |awk '/_NET_ACTIVE_WINDOW/ {print $5; exit;}'` #     ,     if [[ "$window_in_focus" -ne "$window_in_focus_old" ]] then window_in_focus_old=$window_in_focus #    list_of_progr=$(&lt;$HOME/xsetwacom/programs) #     for name_of_progr in $list_of_progr do awk_string_result="$awk_string1$name_of_progr$awk_string2" #  ,        list_of_running_prog=`wmctrl -l | awk "${awk_string_result}"` #         - #    for running_progr in $list_of_running_prog do if [[ "$running_progr" -eq "$window_in_focus" ]] then $HOME/xsetwacom/$name_of_progr fi done done fi sleep 1 done</span></span></code> </pre><br></div></div><br>  In general, the installation algorithm is as follows: <br><ol><li>  Copy the folder wacom-profile-switcher to your home directory. </li><li>  In the file programs we enter the names of those applications for which profiles are needed.  The names must correspond to the inscriptions from the application windows, for example: gedit, LibreOffece, etc. </li><li>  For each such name, we create a file in which we make the necessary settings for the graphics tablet.  File names must be written in the same way as in the file programs. </li><li>  Then you can either run the script if necessary, or throw it into autoload.  Until the user switches from one window to another, the script will only check once per second if the window ID has changed in focus. </li></ol><br><br>  This entire two-wheeled sports simulator was tested on Linux Mint Petra and Wacom Pro M. In theory, it will work on other family members of this version.  For all others, you will have to edit the script, because the buttons will not match. <br><br><h4>  I want tooltips and that's it! </h4><br>  And I still hope that Wacom will turn its attention to Linux and start releasing normal drivers, because sometimes there are not enough tooltips about the key assignment when you lightly tap on it, some gestures.  And here you will not get off with one scenario. <br><br>  <a href="https://github.com/HedgeInSmog/wacom-profile-switcher">For convenience, placed all the scripts on github</a> </habracut></div><p>Source: <a href="https://habr.com/ru/post/212449/">https://habr.com/ru/post/212449/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../212435/index.html">How we ran 1C-Bitrix in Windows Azure</a></li>
<li><a href="../212437/index.html">StubDb - database on stubs for rapid prototyping and not only</a></li>
<li><a href="../212441/index.html">Anatomy of Ember.js (part one, theoretical)</a></li>
<li><a href="../212443/index.html">Migrating from raid1 to raid10 without losing data in Debian</a></li>
<li><a href="../212447/index.html">Social Cloud - All-In-One Collaboration Solution</a></li>
<li><a href="../212451/index.html">Fake Debian developers require free access to Valve games</a></li>
<li><a href="../212453/index.html">Netapp - Reality vs. Marketing</a></li>
<li><a href="../212455/index.html">MtGox problems and spambo-smith</a></li>
<li><a href="../212457/index.html">Analogue cmd from Python for Groovy</a></li>
<li><a href="../212459/index.html">Home current measurement</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>