<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Little about libunique</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I would like to talk about one of the ways to create an application that has one instance - the library LibUnique . 

 Why do you need it?  In m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Little about libunique</h1><div class="post__text post__text-html js-mediator-article">  Today I would like to talk about one of the ways to create an application that has one instance - the library <a href="http://live.gnome.org/LibUnique">LibUnique</a> . <a name="habracut"></a><br><br><h4>  Why do you need it? </h4>  In my case, this was needed when writing a small calendar applet for the <a href="http://code.google.com/p/tint2/">tint2</a> panel.  I wanted the calendar to appear when I clicked on the clock, and when I clicked again, I would hide it, as in the gnome-panel.  At first, I was hampered by the fact that tint2 did not have such functionality.  But this is open source!  An evening to read the code, an evening to write the patch ... Now in tint2 there is such a functionality. <br><br>  Then I began to look for what could serve as such an applet, but did not find anything suitable.  <a href="http://www.xfce.org/projects/orage/">Orage</a> was too heavy, <a href="http://live.gnome.org/Zenity">zenity - calendar</a> jumped out in the center of the screen, and it could not be closed by clicking again on the clock.  In the end, I decided to write my little calendars: <a href="http://code.google.com/p/gsimplecal/">gsimplecal</a> .  Moreover, I wanted to try to write something under Linux. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      On his example, and consider the use of LibUnique. <br><br><h4>  Let's write the code </h4><br>  To start the link to the <a href="">full listing</a> . <br><br>  In fact, everything is very simple, and the essence of this post is rather to let know about the existence of such a solution.  And with this knowledge you will need to complete only a few steps: <ol><li> To begin with, of course, we need to include the header file <em>unique.h</em> . <br> <code><font color="#0000ff">#include</font> <font color="#004488">&lt;unique/unique.h&gt;</font></code> <br> <br></li><li>  Then, somewhere at the very beginning of the main function, you need to call the function <em>unique_app_new</em> , passing it the application identifier in the form of a domain name, like <em>‚Äúru.habrahabr.singletone_app‚Äù</em> . <br><br> <code><font color="#0000ff">int</font> main( <font color="#0000ff">int</font> argc, <font color="#0000ff">char</font> *argv[]) <br> { <br> UniqueApp *app; <br> app = unique_app_new( <font color="#004488">"org.dmedvinsky.gsimplecal"</font> , <font color="#004488">NULL</font> );</code> <br> <br>  If you want to use your own commands (from the predefined ones there is <em>ACTIVATE</em> , <em>NEW</em> , <em>OPEN</em> , <em>CLOSE</em> ), then you can call <em>unique_app_new_with_commands</em> immediately <em>instead of unique_app_new</em> (commands can be added separately by calling <em>unique_app_add_command</em> ). <br><br></li><li>  After that, call the function <em>unique_app_is_running</em> , and act depending on its result: <ul><li>  <em>true</em> : send an already existing instance of one of the predefined or custom messages. <br><br> <code><font color="#0000ff">if</font> (unique_app_is_running(app)) { <br> unique_app_send_message(app, UNIQUE_CLOSE, <font color="#004488">NULL</font> ); <br> } <br></code> <br></li><li>  <em>false</em> : the program is started for the first time;  you need to create our window and attach a libunique message handler to it. <br><br> <code><font color="#0000ff">else</font> { <br> create_main_window(); <br> unique_app_watch_window(app, GTK_WINDOW(main_window)); <br> g_signal_connect(app, <font color="#004488">"message-received"</font> , G_CALLBACK(message_received_cb), <font color="#004488">NULL</font> ); <br> } <br></code> </li></ul></li><li>  Actually, write the message handler itself. <br><br> <code><font color="#0000ff">static</font> UniqueResponse message_received_cb(UniqueApp *app, UniqueCommand command, <br> UniqueMessageData *message, guint time_, gpointer user_data) <br> { <br> <font color="#0000ff">if</font> (command == UNIQUE_CLOSE) { <br> gtk_signal_emit_by_name(GTK_OBJECT(main_window), <font color="#004488">"destroy"</font> ); <br> } <br> <br> <font color="#0000ff">return</font> UNIQUE_RESPONSE_OK; <br> } <br></code> <br></li><li>  Do not forget to clean up for yourself. <br> <code>g_object_unref(app);</code> <br> <br></li><li>  ... </li><li>  Profit! </li></ol></div><p>Source: <a href="https://habr.com/ru/post/88314/">https://habr.com/ru/post/88314/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../88306/index.html">iFolder service resumed its work</a></li>
<li><a href="../88307/index.html">Google Mapping Party Minsk. OpenStreetMap Belarus Team is visiting!</a></li>
<li><a href="../88309/index.html">New version of the panorama stapler Microsoft Image Composite Editor (ICE), future features</a></li>
<li><a href="../88312/index.html">New version of the Divx H.264 decoder with DXVA support</a></li>
<li><a href="../88313/index.html">New UNIX-packages of Opera are posted.</a></li>
<li><a href="../88317/index.html">Miranda IM versus QIP Infium</a></li>
<li><a href="../88320/index.html">Let's help inexperienced users?</a></li>
<li><a href="../88327/index.html">From a fly to an elephant</a></li>
<li><a href="../88328/index.html">IPad closed system</a></li>
<li><a href="../88330/index.html">Instead of nets on the numbers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>