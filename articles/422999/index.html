<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create your own dataset with aliens</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Segmentation of people using neural networks is no surprise. There are many applications, such as Sticky Ai , Teleport Live , Instagram , which allow ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create your own dataset with aliens</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/0n/pb/2v/0npb2v4d-tgt7iquaqtlct4feoe.jpeg"></p><br><p>  Segmentation of people using neural networks is no surprise.  There are many applications, such as <a href="https://sticky-ai.com/">Sticky Ai</a> , <a href="https://itunes.apple.com/ua/app/teleport-live-video-360/id1267267152%3Fl%3Dru%26mt%3D8">Teleport Live</a> , <a href="https://techcrunch.com/2018/04/10/instagram-focus-portrait-mode/">Instagram</a> , which allow you to perform such a complex task on a mobile phone in real-time. </p><br><p>  So, suppose planet Earth is confronted with extraterrestrial civilizations.  And from aliens from the star system Alpha Centauri comes a request for the development of a new product.  They really liked the <a href="https://sticky-ai.com/">Sticky Ai</a> application, which allows you to cut people and make stickers, so they want to port the application to their intergalactic market. </p><a name="habracut"></a><br><p>  Unfortunately, our neural network, which is used in the segmentation application, is trained only on images of the human race, so it doesn't work well on aliens.  There is an urgent need to expand our datas with aliens. </p><br><p>  Asking aliens for several thousand of their images, we proceed to the markup. </p><br><p>  <strong>Task:</strong> <br>  There are images of aliens, for each image it is necessary to create a black and white mask in which the alien will be highlighted with white and the background with black. </p><br><p><img src="https://habrastorage.org/webt/my/8m/ef/my8mefxpcgtvx1jjnugzas_yk7o.png"></p><br><p>  <strong>Decision:</strong> <br>  The first thing you need to make a TZ for freelancers who will mark the image.  Since we need very high quality, we will mark the images in Photoshop. </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text"><p>  If we do not need a very good quality, or the object to be selected is very simple, then such marking can be done with the help of broken lines (polygon vertices).  This type of markup is available on <a href="https://www.mturk.com/">Amazon Mechanical Turk</a> and <a href="https://toloka.yandex.ru/">Yandeks.Toloki</a> , where labor is very cheap. </p></div></div><br><p>  You can make the TOR in the form of a 10-page PDF document, but: </p><br><ol><li>  Freelancers usually do not read the TK, and browse. </li><li>  The document is difficult to describe in detail the algorithm as to correctly and quickly need to mark. </li><li>  It takes a lot of time to write the document itself. </li></ol><br><p>  Therefore, now we have completely abandoned TK in the form of a PDF document, and provide the task in <br>  as a training video.  After this innovation: </p><br><ul><li>  The performance of freelancers has increased 2 times (since the video presents the fastest and best way to markup). </li><li>  The questions asked by freelancers were reduced 3 times (as each step is shown on the video). </li><li>  2 times it turned out to reduce the cost of markup (since the price of an hour of work has not changed, but freelancers mark out twice as fast). </li></ul><br><p>  Particular attention should be paid to the markup method in Photoshop.  Photoshop is a very flexible program in which you can produce markup in different ways.  Therefore, it is advisable to determine in advance what quality of markup you need, study different selection tools, compare them with each other and choose the one with which the image processing is the fastest. </p><br><p>  <strong>Example:</strong> <br>  There are two ways to select: <br>  Method A takes 5 minutes to image. <br>  Method B takes 10 minutes to image. </p><br><p>  With method A, in an hour, the freelancer marks out 12 images, so the price per image will be 150/12 = 12.5 rubles. <br>  With method B, the freelancer marks out 6 images per hour, so the price for the image will be 150/6 = 25 rubles. </p><br><p>  So, we found the best way to select and recorded a video instruction, what next? </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/nsIFPPU4iuo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  It remains to find freelancers.  There are many freelance exchanges, such as <a href="https://www.fl.ru/">Fl.ru</a> , <a href="https://www.weblancer.net/">Weblancer</a> , <a href="https://freelance.ru/">Freelans.ru</a> . <br>  But lately we have been using the <a href="https://work-zilla.com/">WORK-ZILLA</a> freelance exchange because: </p><br><ol><li>  There's pretty cheap labor. </li><li>  A lot of performers. </li><li>  Convenient interface for creating tasks. </li></ol><br><p>  To create a task: <br>  We register, replenish the balance, click "Submit Task", select "Design" -&gt; "Photo Processing". </p><br><p><img src="https://habrastorage.org/webt/bq/m9/6j/bqm96j-rxrnltjrnt4-mwarxdzk.png"></p><br><p>  Fill in the title and description, determine the time to complete the task.  Having processed several aliens, I noticed that on average one image takes 4 minutes.  Those.  15 images are released per hour, so we set the price for one image 150/15 = 10 rubles. </p><br><p><img src="https://habrastorage.org/webt/dd/oa/ry/ddoarygio8jwduibrzuu9fgtiv0.png"></p><br><p>  Immediately after the publication of the job performers begin to offer their services. </p><br><p><img src="https://habrastorage.org/webt/dy/c8/nx/dyc8nxhrme-znqb3r1el0y-tzwa.png"></p><br><p>  We choose the most <strike>beautiful avatar</strike> experienced by reviews and approve as a performer, issue images.  As you can see, the search for a freelancer took less than 15 minutes. </p><br><p><img src="https://habrastorage.org/webt/fc/bm/d8/fcbmd8kovltedt_u20zhoelv5hc.png"></p><br><p>  The next morning, the performer sent the work. </p><br><p><img src="https://habrastorage.org/webt/9q/xs/ad/9qxsadyhhf4li5nnumigwd5qb_q.png"><br><img src="https://habrastorage.org/webt/s_/dh/ji/s_dhjiggthjfgvwlfygpf914l-q.png"></p><br><p>  How to check it now? </p><br><p>  Of course, you can open each image in Photoshop and see how well everything is selected, but what to do if 20 people work for you at the same time, and each sends 40 images a day? </p><br><p>  Automate!  To facilitate verification, I have implemented the following script on python: </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cv2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> shutil <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tqdm <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tqdm_notebook <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tqdm <span class="hljs-comment"><span class="hljs-comment">#,       def generate_checkerboard(shape, size): res = np.ones(shape, dtype=np.float32) for i in range(0, shape[0] // size + 1): for j in range(0, shape[1] // size + 1): if (i + j) % 2 == 0: res[i * size:i * size + size, j * size:j * size + size] = 0.7 return np.stack([res] * 3, axis=2) path = '01_ ÃÜ_13' files_im = filter(lambda x: x[-4:] == '.jpg', os.listdir(path + '/images')) files_masks = filter(lambda x: x[-4:] == '.png', os.listdir(path + '/masks')) print('- : %s' % len(files_im)) print('- : %s' % len(files_masks)) if len(files_im) != len(files_masks): print('-     ') raise Exception('bad count') #  res,      os.makedirs(path + '/res') for idd in tqdm(map(lambda x: x[:-4], files_im)): print(idd) mask = cv2.imread(path + '/masks/' + idd + ".png") / 255. im = cv2.imread(path + '/images/' + idd + ".jpg") checkerboard = generate_checkerboard(im.shape[:2], 40) * 255 cv2.imwrite(path + '/res/' + idd + ".jpg", np.concatenate([im, im * (1 - mask), im * mask + (1 - mask) * checkerboard],axis=1))</span></span></code> </pre> <br><p>  The script takes the original image, a mask, and makes a collage of them consisting of the original image, the cut out background and the cut out alien. </p><br><div class="spoiler">  <b class="spoiler_title">Run the script and get these collages:</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/wz/yf/us/wzyfusy_3yvq5sxupzowiezyrew.jpeg"><br><img src="https://habrastorage.org/webt/ax/lw/3a/axlw3ann0onq1jp4hchd6zp2lqw.jpeg"><br><img src="https://habrastorage.org/webt/_j/ot/jb/_jotjb1ivkuxj0lxepgf33_vomq.jpeg"><br><img src="https://habrastorage.org/webt/5e/lz/wm/5elzwmgmfyaivftoyhtr0d-juja.jpeg"><br><img src="https://habrastorage.org/webt/x5/fu/-5/x5fu-588bxi8s4nfthft942myds.jpeg"><br><img src="https://habrastorage.org/webt/lp/gr/zn/lpgrznuxuxy-3hvmkealu9f_-fc.jpeg"><br><img src="https://habrastorage.org/webt/b_/1l/8q/b_1l8qgivhkg6zyvc-hunudth-8.jpeg"><br><img src="https://habrastorage.org/webt/r3/wb/ln/r3wblnbv1qzb7y53xtcizah8yjk.jpeg"><br><img src="https://habrastorage.org/webt/0n/pb/2v/0npb2v4d-tgt7iquaqtlct4feoe.jpeg"><br><img src="https://habrastorage.org/webt/5p/2s/wg/5p2swga8lwpqpu6etmpfudhnjs0.jpeg"></p></div></div><br><p>  After reviewing the images, we note that the artist singled out one image not very well. </p><br><p><img src="https://habrastorage.org/webt/5e/lz/wm/5elzwmgmfyaivftoyhtr0d-juja.jpeg"></p><br><p>  Please correct the image. </p><br><p><img src="https://habrastorage.org/webt/cv/fq/5b/cvfq5bpts9fnfdpiruwetvmemn8.png"></p><br><p>  After the freelancer has corrected all our comments, we confirm the work and write a grateful feedback to the freelancer. </p><br><p><img src="https://habrastorage.org/webt/mn/jj/ir/mnjjirvnybsybybs2dwi_ors2ly.png"></p><br><p>  <strong>Total:</strong> <br>  Suppose that in order to train a neural network, you will need 2000 alien images. <br>  Then, in order to collect such a dataset, you will need to spend only 2000 x 10 = 20,000 rubles, and if you consider that on average one freelancer processes 40 images per day and 10 people work on markup at the same time, then creating a dataset will take 2000 / (10 x 40) = 5 days. </p><br><p>  <strong>PS</strong> <br>  Of course, we have not yet encountered aliens, no one from the Prisma AI team is going to segment aliens, but with this example I wanted to show you how simple and cost-effective you can create your own datas for any task, be it to detect pedestrians for an unmanned vehicle or identification of forests in satellite imagery. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/422999/">https://habr.com/ru/post/422999/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../422987/index.html">And again the 256th day of the year</a></li>
<li><a href="../422989/index.html">DB is not only data storage</a></li>
<li><a href="../422993/index.html">Burnout OLED TVs in real tests</a></li>
<li><a href="../422995/index.html">QA mitap in Redmadrobot</a></li>
<li><a href="../422997/index.html">The book "Modern PHP"</a></li>
<li><a href="../423003/index.html">Peskov: Roscomnadzor requirements for Facebook are not super complex</a></li>
<li><a href="../423005/index.html">How Yandex.DZen, the caching plugin for WordPress and hosting have increased my pressure</a></li>
<li><a href="../423007/index.html">‚ÄúFaint, but good‚Äù: how we took the students to practice</a></li>
<li><a href="../423009/index.html">SENS-Diagnosis. Protein glycation biomarkers</a></li>
<li><a href="../423011/index.html">Managing Microservices with Kubernetes and Istio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>