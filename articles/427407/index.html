<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Meta-clustering with error minimization, and why I think the brain works that way</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all! I want to share with you my idea of ‚Äã‚Äãmachine learning. 

 Great achievements in the field of machine learning are impressive. Convoluti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Meta-clustering with error minimization, and why I think the brain works that way</h1><div class="post__text post__text-html js-mediator-article">  Hello to all!  I want to share with you my idea of ‚Äã‚Äãmachine learning. <br><br>  Great achievements in the field of machine learning are impressive.  Convolutional networks and LSTM are cool.  But almost all modern technologies are based on the reverse propagation of error.  Based on this method, it is unlikely to build a thinking machine.  Neural networks are something of a frozen brain, trained once and for all, unable to <strike>change to</strike> reflect. <br><br>  I thought, why not try to create something like a living brain.  A sort of reengineering.  Since in all animals, despite differences in intelligence, the brain consists of approximately identical neurons, some basic principle must lie at the heart of its work. <br><a name="habracut"></a><br><h2>  What I do not know about neurons </h2><br>  There are several questions to which I have not found definite answers in popular literature; 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Obviously, the neuron somehow reacts to neurotransmitters, but how exactly?  The simple assumption that the larger the neurotransmitter, the more frequent the adhesions, obviously does not hold water.  If it were so, then the triggering of a single neuron would trigger the operation of several neighbors, the next ones, and in a short time this avalanche would capture the entire brain.  But in reality this does not happen, at the same time only a small part of neurons work in the brain.  Why? </li><li>  Obviously, neurons are units of memory, but how do they store information?  The central part of the neuron is nothing special: the nucleus of the mitochondria and the like.  The axon cannot influence the spike, since the information goes only in one direction, from the nucleus.  So the only thing left is dendrites.  But how is information stored in them?  In analog or digital form? </li><li>  Obviously, neurons somehow learn.  But how exactly?  Suppose that dendrites grow in those places where there was a lot of neurotransmitter just before the spike.  But if this is so, then the triggered neuron will grow a little and the next time the neurotransmitter appears, it will be the thickest among the neighbors, it will absorb the most neurotransmitter and work again.  And again, a little older.  And so on to infinity, until you strangle all your neighbors?  Is something wrong here? </li><li>  If one neuron grows, then the neighboring ones should decrease, the head is not rubber.  Something should encourage the neuron to dry out.  What? </li></ul><br><h2>  Just clustering </h2><br>  The plausible answer to all these questions seems to me that the brain works like a multitude of simple clusterizers.  Is it possible to perform such an algorithm on a group of neurons?  For example, the K-means method.  Completely, you just need to simplify it a bit.  In the classical algorithm, the centers are calculated iteratively as the average of all the considered examples, but we will shift the center immediately after each example. <br><br>  Let's see what we need to implement the clustering algorithm. <br><br><ul><li>  Cluster centers, of course, are dendrites of the neurons of our group.  But how to remember the information?  Suppose that the unit cell of information storage in a dendrite is the volume of a dendrite branch in the region of the synapse.  The thicker the branch, respectively, the greater its volume, the greater the value saved.  Thus, each dendrite can memorize several analog quantities. </li><li>  Comparators to calculate the proximity of the example.  It's more complicated here.  Suppose that after submitting the data (the axons have thrown out the neurotransmitter), each neuron will work the faster, the more stored data (cluster center) are similar to the example (number of neurotransmitters).  Note that the absolute neurotransmitter quantity does not affect the neuron response rate, but it is the proximity of the neurotransmitter quantity to the value stored in the dendrites.  Suppose that if a neurotransmitter is low, then the dendrite does not give a command for a spike.  Nothing happens and if there is a lot of neurotransmitter, the spike of the dendritic branch occurs earlier than that of other dendritic branches and does not reach the nucleus.  But if the neurotransmitter is just right, then all the dendritic twigs will give a mini-spike at about the same time, and this wave will turn into a spike of a neuron that will follow an axon. </li><li>  Multi-input comparator allows you to compare results and select the best.  Suppose that nearby neurons have an inhibitory effect on all their neighbors.  So, in some group of neurons, only one can be active at a time.  It is the one that worked first.  Since the neurons in the group are nearby, they have the same access to all axons coming to this group.  Thus, in the group, the neuron with which the stored information is closest to the considered example will work. </li><li>  The mechanism of displacement of the center in the direction of the example.  Well, everything is simple.  After spike of the neuron, all the dendrites of this neuron change their volume.  Where the concentration of the neurotransmitter was too large, the branches grow.  Where there was insufficient, the twigs are reduced.  Where the concentration is just right, the volume does not change.  The volumes of the branches vary slightly.  But right away.  The next spike is the next change. </li></ul><br>  Check the resulting algorithm in practice.  I scribbled a few lines on Python.  This is what happens with two measurements from random numbers: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2a4/5b2/a12/2a45b2a122a9536cf95e3768af65d4f2.gif"></div><br>  But MNIST: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ceb/6a5/61a/ceb6a561a711c640904a74d1443fa706.gif"></div><br>  At first glance, it seems that all of the above has not changed anything.  Well, we had some data at the input, we somehow converted it, got other data. <br><br>  But in fact there is a difference.  If before the conversion, we had a bunch of analog parameters, then after the conversion we have only one parameter, with a coded unitary code.  Each neuron in the group can be associated with a specific action. <br><br>  I will give an example: Suppose there are only two neurons in a clustering group.  Let's call them "TASTY" and "SCARY."  To allow the brain to make a decision, it is necessary only to connect the neuron ‚ÄúEAT‚Äù to the first one, and ‚ÄúRUN‚Äù to the second one.  For this we need a teacher.  But this is not about that, training with a teacher is a topic for another article. <br><br>  If you increase the number of clusters, then the accuracy will gradually increase.  The extreme case is the number of clusters equal to the number of examples.  But there is a problem, the number of neurons in the brain is limited.  You need to constantly compromise, either accuracy or brain size. <br><br><h2>  Meta clustering </h2><br>  Suppose that we have not one clustering group, but two.  In this case, the inputs are fed the same values.  Obviously, you get the same result. <br><br>  Let's make a small random error.  Let, sometimes, each clusteriser selects not the closest center of the cluster, but which one.  Then the values ‚Äã‚Äãwill begin to differ, over time the difference will accumulate. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/844/742/6ce/8447426cea375229e23546b4be16ee1b.gif"></div><br>  And now, let's calculate the error for each clusteriser.  Error is the difference between the input example and the center of the selected cluster.  If one clusteriser chooses the nearest value, and the other random, then the error of the second will be greater. <br><br>  Go ahead, add a mask to the input of each clusteriser.  A mask is a set of coefficients for each input.  Not zero or one, as commonly used in masks, but a real number from zero to one. <br><br>  Before giving an example to the input of the clusterer, we will multiply this example by the mask.  For example, if a mask is used for a picture, then if for some pixel the mask is equal to one, then it is as if completely transparent.  And if the mask is zero, then this pixel is always black.  And if the mask is 1/2, then the pixel is darkened by half. <br><br>  And now the main action, we will reduce the mask value in proportion to the error of the clusterizer.  That is, if the error is large, then we will reduce the value more strongly, and if it is zero, then we will not reduce it at all. <br><br>  To ensure that the values ‚Äã‚Äãof the masks are not gradually zeroed, we will normalize them.  That is, the sum of the values ‚Äã‚Äãof the masks for each input parameter is always one.  If something is taken away in one mask, this is added to another. <br><br>  Let's try to see what happens by the example of MNIST.  We see that the masks gradually divide the pixels into two parts. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/39c/204/a45/39c204a45731b8408b14cb9621cd91b0.gif"></div><br>  The right side of the picture shows the resulting masks.  At the end of the process, the top clusteriser examines the bottom right, and the bottom clusteriser considers the rest of the examples being submitted.  Interestingly, if we rerun the process, we‚Äôll get another separation.  But at the same time, the groups of parameters are not obtained as they were, but so as to reduce the prediction error.  Clusterizers, as it were, try on each pixel to their mask, and at the same time, the pixel takes that clusterizer to which the pixel fits better. <br><br>  Let's try to submit to the input double numbers, not superimposed on each other, but located side by side, here are the ones (this is one example, not two): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ee/675/145/9ee6751458d904e22d9d286e704084eb.jpg" alt="image"></div><br>  Now we see that every time, the separation is the same.  That is, if there is a single, clearly the best way to separate the masks, then it will be selected. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/48b/55c/487/48b55c4877b5938ed22f5473bb4fb033.gif"></div><br>  Only one will be random, whether the first mask chooses the left figure or the right one. <br><br>  I call the resulting masks meta-clusters.  And the process of forming masks by meta-clustering.  Why meta?  Because clustering is not the input examples, but the inputs themselves. <br><br>  The example is more complicated.  Let's try to divide 25 parameters into 5 meta-clusters. <br><br>  To do this, take five groups of five parameters, encoded with a unitary code. <br><br>  That is, in each group one and only one unit in a random place.  In each given example, always five units. <br><br>  In the pictures below, each column is an input parameter, and each row is a meta-cluster mask.  The clusters themselves are not shown. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/95e/a47/42b/95ea4742b10e16dac89d9a27dc02822a.gif"></div><br>  100 parameters and 10 meta clusters: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/55a/632/b55/55a632b5503d6b4c439c8905d1bdf46b.gif"></div><br>  Works!  In some places, even a bit like the image of the matrix from the movie of the same name. <br><br>  Using meta-clustering can drastically reduce the number of clusters. <br><br>  For example, take ten groups of ten parameters, in each group one unit. <br><br>  If we have one clusterizer (there are no meta-clusters), then we need 10 <sup>10</sup> = 10000000000 clusters to get a zero error. <br><br>  And if we have ten clusterizers, then we need only 10 * 10 = 100 clusters.  This is similar to the decimal number system, no need to come up with notation for all possible numbers, you can do with ten numbers. <br><br>  Meta clustering is very well parallelized.  The most costly computations (comparison of the example with the cluster center) can be performed independently for each cluster.  Notice, not for the clusteriser, but for the cluster. <br><br><h2>  How it works in the brain </h2><br>  Before that, I was talking only about dendrites, but neurons have axons.  And they also learn.  So, it seems that axons are masks of meta-clusters. <br><br>  Add to the description of the work of the dendrites, above, another function. <br><br>  Suppose that if a neuron spike occurs, all the dendrites somehow throw something into the synapse that indicates the concentration of the neurotransmitter in the dendrite.  Not from an axon to a dendrite, but back.  The concentration of this substance depends on the comparison error.  Let, the smaller the error, the greater the amount of substance emitted.  Well, the axon reacts to the amount of this substance and grows.  And if the substance is small, which means a big mistake, then the axon gradually decreases. <br><br>  And if axons are changed in this way from the very birth of the brain, then over time, they will only go to those groups of neurons where their spikes of these axons are needed (do not lead to big mistakes). <br><br>  Example: let it be necessary to memorize human faces.  Let each face be depicted using a megapixel image.  Then for each person you need a neuron with a million dendrites, which is unrealistic.  And now we divide all pixels into meta-clusters, such as eyes, nose, ears, and so on.  Only ten such meta-clusters.  Let there be ten clusters in each meta-cluster, ten variants of the nose, ten variants of the ears, and so on for everything.  Now, to memorize a face, a neuron with ten dendrites is enough.  This reduces the amount of memory (well, brain volume) by five orders of magnitude. <br><br><h2>  Conclusion </h2><br>  And now, if we assume that the brain consists of meta-clusters, we can try to consider from this point of view some concepts inherent in the living brain: <br><br>  Clusters must be constantly trained, otherwise new data will not be processed correctly.  For learning clusters in the brain, a balanced sample is needed.  Let me clarify that if it is winter now, then the brain will learn only from winter examples, and the resulting clusters will gradually become relevant only to winter, and in the summer everything will be bad for this brain.  What to do with it?  It is necessary to submit periodically to all clusterizers not only new, but also old important examples (memories of both winter and summer).  And so that these memories do not interfere with the current sensations, you need to temporarily disable the senses.  In animals, this is called a <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BE%25D0%25BD">dream</a> . <br><br>  Imagine the brain is seeing something small, GRAY, that is running.  After meta-clustering, we have three active neurons in three meta-clusters.  And thanks to the memory, the brain knows that it is delicious.  Then, the brain sees something small, BLUE, that runs.  But the brain does not know whether it is tasty or scary.  It is enough to temporarily disable the meta-cluster where the colors are located, and only the small one that runs will remain.  And the brain knows it is delicious.  This is called <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BD%25D0%25B0%25D0%25BB%25D0%25BE%25D0%25B3%25D0%25B8%25D1%258F">an analogy</a> . <br><br>  Suppose the brain remembered something, and then changed the active neuron-cluster in some group to any other, while in the other meta-clusters there remains a real memory.  And so, the brain has already presented something that has never seen before.  And this is the <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D0%25BE%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">imagination</a> . <br><br>  Thank you for your attention, the code is <a href="https://github.com/ivalnic/E2mc">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/427407/">https://habr.com/ru/post/427407/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../427397/index.html">Development of acoustic dataset for training neural network</a></li>
<li><a href="../427399/index.html">Working with data when building an API based on GraphQL</a></li>
<li><a href="../427401/index.html">Shaders of dissolution and exploration of the world</a></li>
<li><a href="../427403/index.html">API ReportingObserver: a look at the code of web pages from a new point of view</a></li>
<li><a href="../427405/index.html">ES2018 - finally promis method</a></li>
<li><a href="../427409/index.html">The book "Brilliant Agile. Flexible project management with Agile, Scrum and Kanban</a></li>
<li><a href="../427413/index.html">Fight for resources, part 4: Remarkably coming out</a></li>
<li><a href="../427415/index.html">Use Node.js to work with large files and raw data sets.</a></li>
<li><a href="../427417/index.html">With humor about 8-inch diskettes (in the 70s there were only such)</a></li>
<li><a href="../427419/index.html">What to do the processor when there is nothing to do?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>