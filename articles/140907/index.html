<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NetApp Data ONTAP 8 - Storage Hypervisor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This year for the company will become ‚Äúthe year of Cluster-mode‚Äù, despite the fact that the version of Data ONTAP supporting this mode of operation, i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>NetApp Data ONTAP 8 - Storage Hypervisor</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/efb/7ac/aee/efb7acaeebc0f111f8c496c2d94d26dc.png"><br><br>  This year for the company will become ‚Äúthe year of Cluster-mode‚Äù, despite the fact that the version of Data ONTAP supporting this mode of operation, its own internal OS that works in all NetApp storage systems, was released in version 8.0 in 2008, and its capabilities the creation of a ‚Äúmulti-node storage cluster‚Äù is starting to be realized only now. <br><br>  But first, a little history. <br>  A few years ago, the prospects for the development of storage systems in the direction of ‚Äúcloud‚Äù systems began to be spoken about, although it was not yet included in the IT-lexicon this buzzword, and then they talked about GRID systems that are replacing ‚Äúclassic‚Äù network storage systems. <br>  There is nothing surprising in the fact that NetApp, as a company that has traditionally paid a lot of attention to promising areas in the industry, was one of the first to focus on the ‚Äúcloud‚Äù cluster systems.  And that's what came out of it. <br><a name="habracut"></a><br>  Back in 2003, NetApp bought start-up Spinnaker, which developed in the field of cluster file systems and Global Namespace tools, and several years later launched a special OS on the market called Data ONTAP Generation X (GX or v10).  It was a special OS for some NetApp systems that allowed building multi-node storage clusters.  Unfortunately, it had many limitations, in particular, it worked only as an NFS server, and did not have many important and familiar features of the ‚Äúclassic‚Äù Data ONTAP 7.x, therefore it did not gain much popularity, was expensive, limited, and required considerable specialized knowledge for launch and use, and as a result, its use was limited to the market for high-performance file servers for HPC (High-performance Computing) and storage systems for scientific and audio-video information.  The total number of customers in the world who used Data ONTAP GX did not exceed a couple of hundred. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The next step NetApp, was an attempt to combine, ‚Äúmerge‚Äù these two OS together, the ‚Äúclassic‚Äù Data ONTAP 7, which has rich functionality, which I described in detail in this blog, and running on tens of thousands of systems, and a new, ‚Äúcluster‚Äù, ‚Äú cloudy. "  However, the ‚Äúmerge‚Äù announced in 2008 turned out to be largely ‚Äúfictitious‚Äù, simply from one OS distribution, called Data ONTAP 8.x, it became possible to install two OSs: either in 7-mode, that is, ‚Äúclassical‚Äù Data ONTAP, or in the mode called ‚ÄúCluster-mode‚Äù, which was the development of Data ONTAP 10. Unfortunately, as I said above, these were just two OSes installed from the same distribution, and only.  In Cluster-mode, the usual features of Data ONTAP Classic did not appear, and still they were two incompatible OSs that did not have the ability to migrate data or interact, completely different in data storage structures and work with them. <br><br>  As a consequence, the existing couple of hundreds of GX clients were upgraded to 8.x Cluster-mode, and the majority of NetApp users continued to use ‚Äú7-mode‚Äù.  A significant barrier, apart from functional limitations, was the price of the solution, as well as the complexity of the infrastructure implementation that required expensive components, such as an internal Cluster Network using 10 Gigabit Ethernet. <br>  However, the work continued, and gradually, in 8.x Cluster-mode, all those familiar 7-mode features, such as replication, block deduplication, and, most importantly, work with block protocols ‚Äî FC, iSCSI and Fcoe.  Let me remind you that, prior to version 8.1, Cluster-mode was a purely ‚Äúfile storage‚Äù operating under the NFS and CIFS protocols, which, alas, did not suit everyone. <br><br>  In the meantime, as NetApp ‚Äúdigested‚Äù Spinnaker‚Äôs legacy, competitors in this area began to appear on the market, and Isilon‚Äôs product began to be sold (and eventually sold entirely to EMC), and the growing interest in ‚Äúcloudy‚Äù IT systems naturally became ‚Äú the engine of development and storage clouds are multi-node clusters, original cloud storages, which could not be better placed in the cloud paradigm. <br><br>  And now, starting from the Data ONTAP 8.1 version, the Cluster-mode version began to be able to work with block SAN protocols, the asynchronous replication and snapshots familiar to <i>Data ONTAP Classic</i> , deduplication and compression, finally, the prices were reduced, and the use of Cluster-mode has become somewhat more accessible to users. <br><br>  What gives this Cluster-mode, from what we have not had so far, and how does it work at all? <br><br>  In order to answer this question, the easiest way is to present Data ONTAP in Cluster-mode as a kind of ‚Äústorage hypervisor‚Äù.  With how the server virtualization system hypervisor works, for example VMware ESX, MS Hyper-V or Citrix XEN, you are already about familiar, I think.  Data ONTAP in Cluster-mode works very similarly, only instead of virtual machines with applications under such a hypervisor there will be user-created ‚Äúvirtual storage systems‚Äù with data called Vserver, which, like virtual machines under the server hypervisor, can without interrupting work and access for them to migrate from one physical controller in a cluster to another, depending on their availability or speed requirements, or any other needs that you specify.  Migration can also be carried out between different platforms, as well as in the server hypervisor cluster we can enable various (of course, with a number of restrictions) on the physical platform of the host server and transparently for our applications to move them inside from one physical host to another. <br><br>  Thus, Data ONTAP Cluster-mode is the ‚Äúhypervisor‚Äù for the storage system. <br><br><img src="https://habrastorage.org/storage2/2df/9e2/f79/2df9e2f79fc21b6422869b61b0f6639d.png"><br><br>  At the risk of inflating the article with many technical details that are interesting only to already active users of NetApp, I will tell you some more details. <br><br>  First of all, when dealing with Cluster-mode, you should understand the difference between the concepts of <b>Global Filesystem</b> and <b>Global Namespace</b> .  Data ONTAP 8.1 Cluster-mode is the <b>Global Namespace</b> , but <b>NOT the Global Filesystem</b> . <br><br>  Global Namespace allows you to see a cluster and its space as a set of nodes of its components, as a single ‚Äúentity‚Äù, a holistic space, regardless of where and how your data is stored.  However, in terms of storage, each node controller still operates with data stored in its aggregates and volumes.  A single file <b>cannot be</b> located in more than one aggregate / node controller.  Also, it cannot migrate, being distributed partly on one, partly on another node controller. <br>  It seems to me that it is very important to understand, that‚Äôs why I‚Äôm focusing on it so much. <br><br>  Of course, devices that implement the Global Filesystem have fewer restrictions in this place (for example, EMC Isilon with its OneFS is just the Global Filesystem), however, in our world, as you remember, nothing is free, you have to pay for everything, and Global Filesystem entails a number of very unpleasant adverse effects, primarily for performance.  Isilon is quite good for a certain number of tasks, but it is good, first of all, on certain types of workload (mainly sequential access).  How important in your particular case is the ability to store huge file (s) larger than the total capacity of disks connected to one controller and distributed to several cluster nodes, and are you ready for such an opportunity to pay for the deterioration of random access to them - decide you.  Today on the market there is both one and the other option. <br><br>  The performance advantage was quite convincingly demonstrated by NetApp in the recent <a href="http://www.spec.org/sfs2008/results/">SPECsfs2008 testing</a> on the NFS protocol, where the 24-node FAS6240 system running Data ONTAP 8.1 almost outperformed the 140-node EMC Isilon S200 system. <br>  At the same time, it should be noted that, in the case of NetApp, the worst case was specially tested, the ‚Äúworst case‚Äù that is, only 1/24 of all operations went to the owner-controller, 23 out of every 24 operations went through ‚Äúnon-native‚Äù controllers, transmitted through cluster network, and none of the existing optimization tools of NetApp, such as, for example, Load Sharing Mirrors (RO-copies) on non-native cluster nodes, which will certainly increase productivity in real life, were not used. <br><br>  Let me remind you that the <a href="http://www.spec.org/sfs2008/results/">SPECsfs2008</a> test is a classic and authoritative test that mimics the average typical file access using the NFS (and CIFS) protocols, generated by a mixture of operations of the corresponding protocol, and there, of course, there are many metadata operations and, mainly, random access. <br><br>  So - Data ONTAP 8.1 Cluster-mode is a <b>Global Storage Namespace</b> , but <b>NOT a Global Storage Filesystem</b> .  Despite the fact that you see the cluster as a single entity, a separate file stored on it <b>can</b> not exceed the capacity of aggregate of one controller.  However, you <b>can</b> access the data in this file through any of the cluster controllers.  This is the difference between Global Filesystem and Global Namespace. <br><br>  The second point on which I would like to stop in more detail is how the cluster is built physically. <br><br>  Despite the fact that, formally, the ‚Äúunit of measurement‚Äù of the cluster size is one node, which represents one physical controller, these nodes are always included in HA pairs.  For this reason, the number of nodes in a NetApp Data ONTAP 8.x cluster is always even.  This ensures reliability and high availability (High Availability) of the node, using the same method as was done for the controllers at 7.x. <br>  Therefore, you cannot make a 5- or 15-node cluster, but you can make a 4-, 6- or 16-node cluster. <br><br>  At the moment, it is possible to build a cluster operating as a NAS server (NFS or CIFS) from 24 controller nodes (nodes), that is, from <b>12 HA pairs of</b> controllers. <br>  The version of Data ONTAP 8.1 also introduced support for block protocols (iSCSI, FC, FCoE).  However, when using block protocols (only them alone, or in combination with NAS), the maximum cluster size is currently supported at a rate of <b>four nodes, or two HA pairs</b> .  This value, as I think, will grow as soon as everything is debugged and reliability is ensured, yet 8.1 is the first version with such functionality, but for now - keep that in mind.  This is due primarily to the fact that file protocols such as NFS or CIFS are, in fact, fully managed and controlled on the storage side, and it is easier for him to ensure all the necessary work procedures and synchronization processes between cluster nodes. <br><br>  The third point, which I would like to highlight in more detail, is that at the moment NetApp has quite strict hardware requirements for implementing cluster communications.  To build a Cluster network, that is, the internal inter-control network of the cluster itself, currently only two models of 10-Gigabit switches are supported, these are Cisco Nexus 5010 (20 ports, cluster up to 12/18 nodes) and Cisco Nexus 5020 (40 ports, cluster more than 18 nodes), they are sold by NetApp with their partner numbers, as part of the overall quota of such a system, and a specially designed NetApp configuration file for these switches is installed on them.  Moreover, it is possible <b>to</b> use these switches <b>only for the tasks of the internal cluster network</b> ; <b>it</b> is <b>impossible to</b> combine them with other tasks, for example, to connect a client network to them.  Even if there are still ports left. <br><br>  However, there is good news.  Now, NetApp and Cisco, as a time-limited promotion, when ordering cluster-mode storage from NetApp, donate the infrastructure equipment necessary for building a cluster for a symbolic price of $ 1 for Cisco Nexus for Cluster network and Cisco Catalyst 2960 for Cluster management network, plus the necessary SFP and cable.  At the same time, the price for the Data ONTAP 8.1 Cluster-mode system from two nodes, for promotion, is equalized with the price of a similar 7-mode configuration, and the infrastructure part will come at a price of $ 5, for five devices (two Nexus 5010, two Catalyst 2960, a set of cables ), plus service charges. <br><br>  Before your eyes light up and shake hands ‚Äúto buy the Nexus 5010 for one dollar,‚Äù I would like to clarify in a separate line that this offer is valid <b>only for the purchase of the cluster-mode system, and, under the terms of the purchase, cannot be used what else.</b> <br>  The two-node system purchased for the promotion can be extended to 12 nodes (6 HA-pairs) by purchasing only SFP and cable. <br>  The cluster-mode cluster structure is as follows (in the figure, for example, a two-node system is shown): <br><br><img src="https://habrastorage.org/storage2/9b2/79d/e91/9b279de91813af073bc226d0322b308d.png"><br><br>  As the <b>switches of the client network,</b> you can use any switches, Ethernet or FC, depending on the user's needs. <br><br>  Only Cisco Nexus 5010 (for clusters with up to 12/18 nodes) or 5020 (for a greater number of nodes) can be used as <b>Cluster network switches</b> . <br><br>  As a <b>Cluster Management Switch,</b> NetApp recommends Cisco Catalyst 2960, but does not currently require you to buy this particular model, use a different model available from the client if necessary, this can be done through the PVR institution, a special verification request and configuration instructions from NetApp .  NB: SMARTnet for such a switch is a must! <br><br>  Cluster Network is dedicated only for this task network 10Gb Ethernet.  The only exception is the FAS2040, which can be used in Cluster-mode using Gigabit Ethernet, but its use with other controllers is not recommended.  Please note that even for 2040 and its Gigabit Ethernet, <b>other switches besides Nexus 5010/5020 are not supported</b> ! <br><br>  Cluster nodes <b>may</b> vary by model.  You can merge into a single cluster any controllers for which compatibility with cluster-mode is declared (with the only exception in the form of FAS2040, the use of which with other controllers is not recommended (although possible), for the above reason for the absence of 10G ports) <br><br>  You can also cluster and system with disks of different types, for example, you can build a system with SAS, SATA and SSD disks within one single cluster, and organize data migration between different controller-nodes and disks of different types. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/yfI45fNusgk%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhg84ibJbx-R33yh6Dzv_Eckk0qHeQ" frameborder="0" allowfullscreen=""></iframe><br><br>  Thus, using Data ONTAP Cluster-mode, which, I recall, can work on any NetApp controllers sold today, you create ‚Äúvirtual storage systems‚Äù in much the same way as you create ‚Äúvirtual servers‚Äù under the virtualization hypervisor that are independent from the host hardware, can arbitrarily and ‚Äúlive‚Äù migrate between physical controllers according to your requirements or applications, you can increase the cluster performance on the fly, scaling such a cluster, adding new ‚Äúho  you "Controller, and do much, already familiar to users of VMware vSphere, MS Hyper-V or Citrix Xen Server.  Only for storage system. <br><br>  Judging by the activity with which NetApp is now publishing on its website Best Practices for applying Cluster-mode for databases (including Oracle and MS SQL Server), application systems such as SAP, MS Sharepoint, and other ‚Äúbusiness heavyweights‚Äù. ‚ÄúThe demand for such solutions is now very high. <br>  I think that this year we will see the implementation of systems using Data ONTAP Cluster-mode in Russia. </div><p>Source: <a href="https://habr.com/ru/post/140907/">https://habr.com/ru/post/140907/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140901/index.html">Several alternative options for integrating the site with 1C</a></li>
<li><a href="../140902/index.html">Microsoft crossed SPDY and WebSockets</a></li>
<li><a href="../140903/index.html">Knowledge management, knowledge base creation. And what in practice?</a></li>
<li><a href="../140904/index.html">DEVCONF 2012 - June 9-10 in Moscow. Authors come to PHP, MySQL, MariaDB, MongoDB</a></li>
<li><a href="../140905/index.html">Dynamic tariffs have become available for individuals!</a></li>
<li><a href="../140909/index.html">The balance of game elements in Cut the Rope: Experiments</a></li>
<li><a href="../140910/index.html">Ruby on Rails. From the local host to VDS in 15 minutes</a></li>
<li><a href="../140911/index.html">Top 10 Companies at the Y Combinator Bottom Demo</a></li>
<li><a href="../140912/index.html">How to make friends Yii (ActiveDataProvider) and Text Search in PostgreSQL</a></li>
<li><a href="../140913/index.html">GNOME 3.4</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>