<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using mutexes to detect active infection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When infecting a system, a virmaker is always faced with the task of determining whether the system is already infected. Otherwise, the implementation...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using mutexes to detect active infection</h1><div class="post__text post__text-html js-mediator-article"> When infecting a system, a virmaker is always faced with the task of determining whether the system is already infected.  Otherwise, the implementation of repeated mechanisms of infection in some cases can lead to disruption of the Trojan or destabilization of the entire system.  Both are undesirable. <br><br>  One of the mechanisms to prevent this phenomenon is the creation of specific mutexes, the presence of which concludes the presence of active infection.  At the same time, mutexes are not hidden at all, and therefore can be a reliable signal of the presence of a certain infection. <a name="habracut"></a><br><br>  Making a list of handles on all mutexes opened in the system can be done using the <a href="http://technet.microsoft.com/ru-ru/sysinternals/bb896655">Handle utility from Mark Russinovich</a> .  This is done by a simple command: <br> <code>handle.exe -a &gt; log.txt</code> <br> <br>  After parsing the received list, you can not only get information about whether there is an infection in the system, but in some cases you can get information on which file is potentially infected. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Considering that the full collection of logs even on a very busy machine takes a few seconds, it seems promising to create black and white lists of mutexes that allow for a rapid assessment of infection.  For example, it is well known that: <br><br>  <b>_AVIRA_ [letters]</b> or <b>__SYSTEM __ [letters]</b> - ZBot marker <br>  <b>svchost_test_started</b> - <b>TDL3</b> marker <br>  <b>Flameddos</b> - Bifrost marker <br>  <b>__b4ng__b4ng__38</b> - Tigger marker <br>  <b>Jo1ezdsl</b> - Bankpatch.C marker <br>  <b>Op1mutx9</b> or <b>Ap1mutx7</b> - and always in combination with <b>* exeM_ *</b> - Sality marker <br>  <b>Jhdheddfffffhjk5trh</b> - Allaple marker <br>  <b>1337bot</b> - Spybot marker <br>  <b>Rootz</b> - Sdbot marker <br><br>  It should be noted that the presence of specific mutexes can also be detected by full memory dumps of an infected system using <a href="https://code.google.com/p/volatility/">the mutantscan plugin for Andreas Schuster for Volatility</a> . <br><br>  Of course, this method does not provide 100% of the information about the full mechanism of subsequent treatment, besides, the virmaker can remove the specified ‚Äúdetection‚Äù with just a few changes in the code, but on the other hand, the advantage is expressivity and simplicity of database management. </div><p>Source: <a href="https://habr.com/ru/post/114713/">https://habr.com/ru/post/114713/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../114705/index.html">Disable ClickPad on X220; a bit of detective</a></li>
<li><a href="../114707/index.html">RBK Money cancels the commission</a></li>
<li><a href="../114708/index.html">Virtuous mafia</a></li>
<li><a href="../114710/index.html">The first birthday of LinguaLeo: results and a look into the future</a></li>
<li><a href="../114711/index.html">AT & T launches Placecast service for geolocation shopping</a></li>
<li><a href="../114714/index.html">Stub for IE6 under Drupal 7</a></li>
<li><a href="../114715/index.html">Who are the MST and what we can do best</a></li>
<li><a href="../114716/index.html">Toshiba Develops New Energy Saving Triggers</a></li>
<li><a href="../114717/index.html">19 vulnerabilities fixed in Google Chrome</a></li>
<li><a href="../114719/index.html">How the internet sent the minister to resign</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>