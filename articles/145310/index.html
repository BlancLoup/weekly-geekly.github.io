<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Time in phones: what and how it works</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Surely many people noticed problems with the readings of the built-in watches. Someone may have noticed the oddities with the display of time related ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Time in phones: what and how it works</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/7cb/9d3/4ec/7cb9d34ec4e8e2576d4f4ab63a275320.jpg"><br><br>  Surely many people noticed problems with the readings of the built-in watches.  Someone may have noticed the oddities with the display of time related to SMS.  This is especially noticeable immediately after the days when in many countries there is a transition to winter or summer time. <br><br>  <b>To understand how it all works, you will need to dig a little into the architecture.</b>  Let's try to figure out why such problems may arise, what affects the time reading, and what can be done if the phone suddenly started to show the wrong time. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Zone time </h4><br>  About what geographic and administrative ‚Äútime zones‚Äù, or ‚Äútime zones,‚Äù as it is now called in the Federal Law No. 107-FZ of 2011 ‚ÄúOn the calculation of time‚Äù, I will not tell, because it is in Wiki. <br><br>  From this basic information, it is important to remember that the difference in the zone time from the ‚Äúuniversal‚Äù (UTC) (in everyday life equivalent to ‚ÄúGreenwich‚Äù - GMT) is the result of purely administrative actions of the authorities.  What is the difference for a particular locality authorities will appoint, so it will be.  We will try to first understand the functions of processing time in the network equipment. <br><br><h4>  Time and SMS </h4><br>  The text message sent from the phone (SMS-SUBMIT) does not provide a place for time information at all. <br><br>  Only when the message arrives at the SMS center does it acquire the time stamp field - TP-Service-Center-Time-Stamp (TP-SCTS), consisting of 7 octets with rearranged semi-octets (GSM 03.40, TS 23.040) and present the information in binary - a decimal code (BCD), that is, each half-octet encodes one digit. <br><br>  The first 6 octets represent the year, month, day, hour, minutes, and seconds of the sender's local time. <br>  The seventh octet contains information about the time zone, and indicates the difference between local time and UTC (GMT).  The unit of measurement of the time difference is the 15-minute interval, and the third bit (the highest in the right half octte) indicates the algebraic sign of the difference (‚Äú0‚Äù is positive, ‚Äú1‚Äù is negative). <br>  "Summer time" should be taken into account in the value of information about the time zone.  For example, in the UK, the octet value of the time zone is 00000000b (UTC + 00: 00) during the winter time, and 01000000b (4 x 15 minutes, that is, UTC + 01: 00) during the summer time period. <br><br>  In the structure of a short message delivered to the recipient's phone (SMS-DELIVER), information about the time of arrival of the message to the SMS center is already present, and can be used by the phone when the information about the message is displayed to the user. <br><br><h4>  What information about the current time the mobile network can communicate to the phone </h4><br>  In 1996, in the GSM specifications (GSM 02.42, 04.08, etc.), tools appeared that allow cellular operators to deliver date, time, and time zone information to their phones.  For this purpose, in the signal messages intended for mobility management (Mobility Management), several information elements are provided that can be used by the operator at their discretion, since they are optional. <br><br>  First of all, this is the information element <b>"Time Zone and Time" IE</b> .  It contains the whole complex of data (year, month, day, hour, minutes and seconds) indicating the moment when the network transmits a signal message, as well as a value indicating the time zone in which the base station is located. <br>  Values ‚Äã‚Äãof year, month, day, hour, minutes and seconds, as in the case of SMS, are transmitted in BCD encoding with permutation of semi-octets, but, unlike the time center of the SMS center, indicate universal time (UTC), and not local time! <br><br>  The part of the information element indicating the time zone is transmitted in the same encoding as in the case of the time center of the SMS center. <br><br>  Here is the block of information transmitted to the phone at a specific point in time: <br><br>  <b>Octet value / interpretation</b> <br> <code>47 , ,    7  IE ¬´Time Zone and Time¬ª <br> 11 YEAR: 11 <br> 20 MONTH: 02 <br> 71 DAY: 17 <br> 70 HOUR: 07 <br> 71 MINUTE: 17 <br> 30 SECOND: 03 <br> 21 TIME ZONE: 12 = GMT+03:00 <br> 49 , ,    IE ¬´Daylight Saving Time¬ª <br> 01  IE ¬´Daylight Saving Time¬ª = 1  <br> 00 ,    - ¬´ ¬ª</code> <br> <br>  Since in this information element the network transmits the value of ‚Äúuniversal time‚Äù - UTC, in order for the phone to display local time, it must adjust UTC to the value corresponding to the time shift in the time zone in which the phone is located.  In this particular case, the case took place in Moscow, before the adoption of the law ‚ÄúOn the calculation of time‚Äù and the abolition of the transition to winter time. <br><br>  Thus, the time transmitted by the network corresponded to 10 hours 17 minutes and 3 seconds in the morning of Moscow time on February 17, 2011.  For comparison, a block of information transmitted to the phone recently: <br><br>  <b>Octet value / interpretation</b> <br> <code>47 , ,    7  IE ¬´Time Zone and Time¬ª <br> 21 YEAR: 12 <br> 40 MONTH: 04 <br> 81 DAY: 18 <br> 80 HOUR: 08 <br> 45 MINUTE: 54 <br> 44 SECOND: 44 <br> 61 TIME ZONE: 16 = GMT+04:00 <br> 49 , ,    IE ¬´Daylight Saving Time¬ª <br> 01  IE ¬´Daylight Saving Time¬ª = 1  <br> 00 ,    - ¬´ ¬ª <br>        12:54:44 18  2012 .</code> <br> <br>  In addition to the information element ‚ÄúTime Zone and Time‚Äù, the specifications also provide a separate 8-bit information element intended to transmit information only about the time zone ( <b>‚ÄúTime Zone‚Äù IE</b> ). <br><br>  The information in it is encoded in the same way as the value of the time zone in the mark of the SMS center. <br>  However, there is little point in transmitting ‚ÄúTime Zone‚Äù together with ‚ÄúTime Zone and Time‚Äù. <br><br>  A separate information element ( <b>‚ÄúDaylight Saving Time‚Äù IE</b> ) is also provided, which, if transmitted, indicates the time shift value caused by the use of ‚Äúsummer time‚Äù, which was taken into account when calculating the value of the time zone field. <br><br>  A specific value may indicate the absence of a shift (‚Äú00b‚Äù), a shift of +1 hour (‚Äú01b‚Äù), and a shift of even +2 hours (‚Äú10b‚Äù). <br><br>  According to the GSM / 3GPP specifications, the time information should be delivered to the mobile phone at the earliest opportunity when the phone is registered on the network, the time zone changes, or the transition to summer or winter time is made. <br><br>  Thus, using the means described above, the network can supply the phones with all the information necessary to correctly set and display the current time, as well as the time associated with short messages. <br><br>  But, according to the provisions of the standards, the use of this information is assumed solely <b>at the discretion of the phone manufacturer</b> . <br><br>  However, users may experience some problems for reasons that are completely or partially independent of the phones and their manufacturers. <br><br>  For example, an SMS center serving several time zones must take into account the time at the location of the sending phone.  Otherwise, the time of sending the SMS will be recorded with an error equal to the time difference in the time zones where the SMS center and the sender's phone are located.  In the zones located near the borders of the time zones, the operator must ensure that the base stations transmit the value of the time zone in whose territory the base stations are located.  Of course, operators take these features into account when planning and setting up a network. <br><br>  However, due to the laws of radio wave propagation, operators cannot fully guarantee the correctness of time information delivered to the phone.  After all, a phone located near the administrative boundary of the time zones can receive signals and use information about the date and time from base stations located in the neighboring time zone and transmitting the relevant information. <br><br>  For the same reason, the SMS center may incorrectly determine the time zone where the phone is actually located if the SMS transmission occurred through the base station located in the neighboring time zone. <br><br>  In addition, short-term problems are potentially possible due to the fact that the software of network equipment and SMS-centers will automatically switch to summer / winter time in spite of new Russian realities, or it was incorrectly configured at the time of commissioning.  But such "nuances" are usually quickly corrected by service personnel. <br><br><h4>  Other sources of information about time and place </h4><br>  There are other channels for the delivery of information about the date, time and place of stay in mobile phones. <br><br>  Many phones have the functionality of navigators and can use information about time and location from positioning systems (GPS, GLONASS, etc.). <br><br>  Phones (tablets) connected to the Internet can use additional time information using NTP or SNTP, as well as information about the location of the "binding" of public IP addresses. <br>  Along with the manual settings of time and time zone, such an abundance of source information in some cases can cause problems for the phone with a choice - which information about time and location to use. <br><br><h4>  How phones use time information </h4><br>  In the phones, the watches first appeared in a fairly simple configuration - they simply showed the time on the display.  In case of moving or changing the time to summer or winter time, it was enough just to translate the clock in accordance with the new realities. <br><br>  Naturally, the ability to manually set the date and time parameters in the phones is still available. <br><br>  In manual configuration, the user enters the current date, time and location (time zone) and is responsible for the correctness of the entered information. <br><br>  It would seem simple and straightforward? <br>  But also in the manual configuration option, problems may arise if the phone software is set to incorrectly match the time zone and city that the user has indicated as his location. <br><br>  If you use the wrong value for the time zone, later, when you move to another city / country and the corresponding change in the value of the time zone, you can find that the time on the phone is different from the real administrative time in a new place. <br><br>  As the performance of processors and the capacity of memory elements increased, more complex functions related to time, dates, and the calendar began to be built into the phones. <br><br>  And now the situation with the automatic mode of setting the date and time looks much more interesting. <br>  If the GSM / UMTS mobile communications network in which the phone is registered does not transmit information about the current date and time, the phone would seem to display the data that the user entered in manual mode, despite the fact that the automatic mode is set.  However, it cannot be completely ruled out that developers of some models can use information from positioning systems or from the Internet. <br><br>  In cases where the operator in the signaling traffic transmits information about the date, time, and time zone, the most logical way out would be to use this particular information ‚Äî to display the local time calculated from the UTC values ‚Äã‚Äãand the time zone shift received from the operator. <br><br>  However, in practice, some manufacturers (their software developers) began to take not always a reasonable initiative in attracting other sources of information.  For example, it was noticed that in the automatic time correction mode, for some reason, some models, instead of information about the time zone transmitted by the network, use the value set by the user in the manual setting mode! <br><br>  Due to the change of time zones in the Russian Federation under the Federal Law No. 107-FZ of 2011 ‚ÄúOn the calculation of time‚Äù, in phones whose software was developed earlier, data on the time zones of many Russian cities have now become incorrect.  As a result, if such a phone, instead of information about the time zone received from the network, uses the value set in the manual settings, the time may be incorrectly displayed. <br><br>  It is obvious that the correction of such errors should be handled by the phone manufacturer, who is responsible for standards for using the information received from the operator. <br>  However, in conditions of tough competition, manufacturers, seeking to ensure the release of more and more new models, rather quickly stop making changes to the software of previously released models. <br><br>  In such cases, the manual setting of the time zone value, adjusted in accordance with the above Federal Law, can help. <br><br>  For example, for Moscow you can set not the old value UTC + 03: 00, but UTC + 04: 00, not paying attention to the name of the city (for example, Baku, Yerevan or Tbilisi). <br><br>  With regard to older phones, the time may be incorrectly displayed, because they interpret the time value received from the network as local time, not universal time.  Obviously, in this case only the manufacturer could correct the problem by developing a new version of the software.  Truth and it is difficult to hope. <br><br>  <b>Known and problems in some models with the interpretation of the time of sending SMS.</b>  The receiving phone receives in SMS information about the local time and time zone in which the sending phone was located on the one hand, as well as the network UTC values ‚Äã‚Äãand time zone at the place where the SMS was received. <br><br>  Further, the receiving phone can do everything that the manufacturer intended with this information - how it will process all this information before showing to the owner, the standards were attributed solely to the area of ‚Äã‚Äãresponsibility of the phone manufacturer. <br><br>  Unfortunately, the software developers of some models made mistakes in processing the parameters for sending SMS, and mislead the user. <br><br>  Without pretending to a comprehensive description of all possible problems with the display of time, I tried to describe the mechanisms, knowledge of which can help to understand the causes of the problem in a particular case and find an acceptable solution. </div><p>Source: <a href="https://habr.com/ru/post/145310/">https://habr.com/ru/post/145310/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145304/index.html">Posters on IT subjects</a></li>
<li><a href="../145306/index.html">Introduction to Claims-based identity</a></li>
<li><a href="../145307/index.html">The latest Windows Azure technology will be highlighted at the Meet Windows Azure event, see online.</a></li>
<li><a href="../145308/index.html">WebSphere Application Server application server topologies for high availability</a></li>
<li><a href="../145309/index.html">Fundamentals of the approach to the construction of universal intelligence. Part 1</a></li>
<li><a href="../145311/index.html">New line from Lenovo</a></li>
<li><a href="../145312/index.html">Worldwide Start IPv6 Day</a></li>
<li><a href="../145313/index.html">Runetology (150): Founder Championship.com Dmitry Sergeyev</a></li>
<li><a href="../145315/index.html">Algorithm for modeling a multidimensional array of data distributed according to the normal law</a></li>
<li><a href="../145317/index.html">A good example of using closures in PHP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>