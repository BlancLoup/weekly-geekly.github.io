<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hex editor reference material 010 Editor: templates</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Having written a couple of articles about the work in the 010 Editor ( part I , part II ), I came to the conclusion that it‚Äôs better to start translat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hex editor reference material 010 Editor: templates</h1><div class="post__text post__text-html js-mediator-article">  <i>Having written a couple of articles about the work in the 010 Editor ( <a href="http://habrahabr.ru/post/213211/">part I</a> , <a href="http://habrahabr.ru/post/213435/">part II</a> ), I came to the conclusion that it‚Äôs better to start translating the certificate from the program in more detail than basic things, since everything is not bad in it but the Russian translation is not.</i>  <i>So, in this article we will get acquainted with the peculiarities of writing templates 010 Editor, which the developers themselves are talking about.</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eef/56e/66b/eef56e66bb94aabb75a025e8a7a89fc8.png"><br>  Binary templates are one of the most powerful features of the 010 Editor, which allows you to represent any file as an ordered set of variables and structures.  Templates help you explore and edit files in a much more convenient way than regular hex editors allow.  Each template is a text file with the extension "* .bt", which can be edited in notepad and right in 010 Editor (see the Templates menu).  The template runs as an interpreted code, after it works, the execution result is displayed on the Template Results panel.  Templates can be configured to automatically download and run when a file with a certain extension is opened in the editor, for example, the standard set of 010 Editor includes templates for working with * .zip, * .bmp and * .wav. <br><a name="habracut"></a><br><h4>  I - Declaring Variables </h4><br>  A variable declaration is identical to C, but with one important difference: whenever a variable is declared in a template, it is ‚Äútransferred‚Äù in its presentation to a set of bytes in the file.  For example, consider the pattern: <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> header[<span class="hljs-number"><span class="hljs-number">4</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> numRecords;</code> </pre> <br>  This pattern will create an array of header characters that will ‚Äúcover‚Äù the first 4 bytes of the file being examined, and the integer variable numRecords will cover the next 4 bytes.  Both variables will be displayed in the Template Results panel and can be used for editing directly in the file.  The main way to group variables together is to declare structures (structs) and unions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Special Attributes </h5><br>  Special attributes can be defined after the declared variable inside the 'corner' ('&lt;' and '&gt;') brackets.  The following attributes are supported: <br><br><pre> <code class="cpp hljs"> &lt; format=hex|decimal|octal|binary, <span class="hljs-comment"><span class="hljs-comment">//  : , , ,  fgcolor=&lt;color&gt;, //   bgcolor=&lt;color&gt;, //   comment="&lt;string&gt;"|&lt;function_name&gt;, //  name="&lt;string&gt;"|&lt;function_name&gt;, //  open=true|false|suppress, //   hidden=true|false, //   read=&lt;function_name&gt;, //    write=&lt;function_name&gt; //    size=&lt;number&gt;|&lt;function_name&gt; &gt; // </span></span></code> </pre><br>  The assignment of all attributes is discussed below, with the exception of the read and write functions (they are discussed in the Custom Varuables item), as well as the size (discussed in the On-Demand Structures section). <br><br><h5>  Display mode </h5><br>  By default, all variables displayed in Template Results are in decimal format.  To switch between hexadecimal, decimal, octal, and binary, you can use the DisplayFormatDecimal, DisplayFormatHex, DisplayFormatBinary, and DisplayFormatOctal functions.  An alternative way is to use the following attribute: <br><br><pre> <code class="cpp hljs"><span class="hljs-string"><span class="hljs-string">'&lt;format=hex|decimal|octal|binary&gt;'</span></span></code> </pre> <br>  After declaring a variable or typedef.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> crc &lt;format=hex&gt;; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> flags &lt;format=binary&gt;;</code> </pre> <br><h5>  Colors </h5><br>  When parsing a file using templates, you can color the hex code in different colors.  For example, a file header may be displayed in a color different from the rest of the file.  There are two ways to use ‚Äúcolors.  If you want to set the color of a single variable, you can use the attribute '&lt;fgcolor = ???&gt;' or '&lt;bgcolor = ???&gt;' to set the color of the characters and the background, respectively.  The argument ('???') can be either a built-in color constant (cBlack, cYellow, cWhile, etc.), or a number in the format '0xBBGGRR' (for example, 0xFF0000 is blue).  For example: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> id &lt;fgcolor=cBlack, bgcolor=<span class="hljs-number"><span class="hljs-number">0x0000FF</span></span>&gt;;</code> </pre><br>  The second way is to use the SetForeColor, SetBackColor and SetColor functions.  All variables used after one of these functions will be assigned a color defined by them.  The constant 'cNone' turns off the use of colors.  For example: <br><br><pre> <code class="cpp hljs"> SetForeColor( cRed ); <span class="hljs-comment"><span class="hljs-comment">//     int first; //      int second; //      SetForeColor( cNone ); //      int third; //     - </span></span></code> </pre><br><br><h5>  Byte order (endian) </h5><br>  The way of reading and writing depends on the order of the bytes in the file: big-endian or little-endian.  By default, all declared variables have the same byte order as the file being examined, but the modes can be switched using the BigEndian () and LittleEndian () functions.  Use this technique if the file contains data with different byte order. <br><br><h5>  Comments </h5><br>  You can add comments to variables using the '&lt;comment =' '&gt;' attribute.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> machineStatus &lt;comment=<span class="hljs-string"><span class="hljs-string">"    ,  15."</span></span>&gt;;</code> </pre> <br>  This comment will be displayed in the Comment column of the Template Results panel.  An arbitrary function can also be specified as a comment: '&lt;comment = &lt;function_name &gt;&gt;'.  Such a function takes a variable as an argument and returns a string that will be displayed in the Comment column.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> machineStatus &lt;comment=MachineStatusComment&gt;; <span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MachineStatusComment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> status )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( status &lt;= <span class="hljs-number"><span class="hljs-number">15</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"*** -  "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span>; }</code> </pre> <br><h5>  Names </h5><br>  The parameter "name" can be used to replace the text displayed in the Name column of the Template Results panel.  As well as the comment parameter discussed above, the name parameter can be set using '&lt;name = ""&gt;' or it can contain an arbitrary function '&lt;name = &lt;function_name &gt;&gt;'. Using functions in the "name" parameter is equivalent to using the parameter ‚ÄúComment‚Äù: this function takes a variable as an argument and returns a string. For example: <br><br><pre> <code class="cpp hljs"> byte _si8 &lt;name=<span class="hljs-string"><span class="hljs-string">"Signed Byte"</span></span>&gt;;</code> </pre> <br>  This variable will be displayed in the Template Results panel not as ‚Äúbyte _si8‚Äù, but as ‚ÄúSigned Byte‚Äù.  Note that if a variable is part of an array, array indices will be automatically assigned to the name. <br><br><h5>  Variable reading order </h5><br>  After each variable is declared in the template, the current read address is shifted.  The current address can be read using the FTell function, and the movements are processed using FSeek and FSkip.  This technique allows you to parse the file without a strictly defined order.  Note that you can use the ReadByte, ReadShort, ReadInt, etc. functions to read a file without declaring variables. <br><br><h5>  Local variables </h5><br>  In some cases, you have to use variables that should not be displayed in the Template Results panel, and which generally may not relate to the internal structure of the file (that is, be ordinary C / C ++ variables).  In this case, the declaration of variables should use the 'local' keyword.  For example: <br><br><pre> <code class="cpp hljs"> local <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i, total = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> recordCounts[<span class="hljs-number"><span class="hljs-number">5</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>; i++ ) total += recordCounts[i]; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> records[ total ];</code> </pre> <br>  In this example, the variable i is not added to the Template Results pane, but, nevertheless, you can turn on the display of local variables by using the Show Local Variables command (right-click on Template Results). <br><br><h5>  Variable status </h5><br>  After starting the template, all created variables are displayed in the tree in the Template Results panel.  By default, all arrays and structures are "collapsed" and have the ability to "expand" only by clicking on the '+' in the list;  nevertheless, it is sometimes useful to have an expanded structure or a complete list of array elements before your eyes, so that they are displayed in this way in Template Results immediately after the template is completed.  To do this, you can use the '&lt;open = true&gt;' attribute in the variable parameters, and the '&lt;open = false&gt;' attribute can also be used to display a certain structure or array collapsed (as set by default). <br><br><h5>  Strings </h5><br>  In 010 Editor, there are two syntax options for working with null-terminated strings: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> str[];</code> </pre>  or <br><pre> <code class="cpp hljs"> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> str;</code> </pre> <br>  Both imply reading the string before it hits 0. Unicode strings (long strings) can be read using: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">wchar_t</span></span> str[];</code> </pre>  or <br><pre> <code class="cpp hljs"> wstring str;</code> </pre> <br><h5>  Transfers </h5><br>  When declaring a variable of type enum (enumeration), an arrow is displayed in the Template Results panel with a drop-down list in which the entire contents of the enumeration will be displayed. <br><br><h5>  Hidden variables </h5><br>  The attribute '&lt;hidden = true&gt;' allows you to hide the display of variables in the Template Results panel, '&lt;hidden = false&gt;' to cancel. <br><br><h4>  II - Structures and associations </h4><br><h5>  Structures </h5><br>  In C, the 'struct' keyword is used to declare a hierarchical data structure; at 010, it has the exact same purpose.  Structures are declared using C / C ++ syntax, for example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">myStruct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c; };</code> </pre> <br>  This code automatically creates a new type of myStruct, the next step is to declare a variable of this type (structure instance): <br><br><pre> <code class="cpp hljs"> myStruct s;</code> </pre> <br>  After you declare a variable of type myStruct in Template Results, the entry 'myStruct s' appears with a '+' sign.  By clicking on '+', you can see the drop-down list of variables and their values: a, b, c. <br><br>  Instances may also be declared in an alternative way: <br><br><pre> <code class="cpp hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">myStruct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c; } s1, s2;</code> </pre> <br>  This code will create two instances of the myStruct type, with s1 occupying the first 12 bytes of the file (3 integer values ‚Äã‚Äãof 4 bytes each), and s2 - the next 12 bytes. <br><br>  These structures are more ‚Äúpowerful‚Äù than the structures of the C standard. In 010, the use of expressions such as if, for, while is supported.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">myIfStruct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( a &gt; <span class="hljs-number"><span class="hljs-number">5</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c; } s;</code> </pre> <br>  In this example, after declaring an instance of the structure s, only two variables are created: a and either b or c.  Note that patterns are executed as interpretable code, so all strings are executed sequentially.  The value of the variable a is read directly from the file. <br><br>  Structures can also be nested, for example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> width; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">COLOR</span></span></span><span class="hljs-class"> {</span></span> uchar r, g, b; } colors[width]; } line1;</code> </pre> <br>  An alternative way to declare structures is typedef.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> ushort id; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size; } myData;</code> </pre> <br><br><h5>  Associations </h5><br>  Associations can be declared in the same way as structures, with the only difference being that the keyword 'union' is used instead of 'struct'.  In associations, all variables begin with a ‚Äúzero position‚Äù, that is, from the address of the association itself (in fact, they ‚Äúoverlap‚Äù each other).  The union size is equal to the maximum by the number of bytes of the variable.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> myUnion { ushort s; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> d; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; } u;</code> </pre> <br>  All three variables will be read starting from one address and the union size will be 8 bytes, since it contains a double variable. <br><br><h5>  Structures and unions with arguments </h5><br>  When declaring structures or unions after the keyword 'struct' or 'union', you can use an argument list.  This is a convenient way to work with complex structures, the list of arguments is determined in the same way as for functions.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-function">struct </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VarSizeStruct</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arraySize)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-built_in"><span class="hljs-built_in">array</span></span>[arraySize]; };</code> </pre> <br>  After declaring this structure, when creating its instance, you must enclose the corresponding arguments in parentheses, for example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-function">VarSizeStruct </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">VarSizeStruct </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">7</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>;</code> </pre> <br>  Arguments can also be used in structures and unions declared as typedefs.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">struct</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arraySize)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-built_in"><span class="hljs-built_in">array</span></span>[arraySize]; } VarSizeStruct;</code> </pre> <br><br><h4>  III - Arrays, duplicates, optimization </h4><br><h5>  Arrays and Duplicates </h5><br>  In 010 Editor there is a special syntax that allows you to create arrays in a special way.  Variable declaration with the same name (duplicates) is supported, for example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x;</code> </pre> <br>  In 010 Editor, a variable declaration with the same name is equivalent to creating an array.  In this example, x [0] can be used as a reference to the first use of x, and x [1] as a reference to the second.  Duplicates can be declared in cycles, for example: <br><br><pre> <code class="cpp hljs"> local <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>; i++ ) <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x;</code> </pre> <br><h5>  Structure optimization </h5><br>  010 Editor supports optimization by default, which makes it possible to work with arrays of structures with a large number of elements (for example, a million).  Optimization works as follows: the size of the first element of the array is calculated, after which it is assumed that all other elements will be the same size.  Accordingly, in the case of elements of variable size, the result will be erroneous.  To turn off optimization, use the '&lt;optimize = false&gt;' attribute.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length; uchar data[ length ]; } RECORD; RECORD record[<span class="hljs-number"><span class="hljs-number">5</span></span>] &lt;optimize=<span class="hljs-literal"><span class="hljs-literal">false</span></span>&gt;;</code> </pre> <br>  If 010 Editor displays a warning in the Output field, but you still want to use optimization, enable it using the '&lt;optimize = true&gt;' attribute, the warning will be hidden.  The attribute '&lt;optimize = false&gt;' can also be used for structures declared not through typedef. <br><br><h4>  IV - Bitwise structures </h4><br>  Fields in structures can be divided into groups of bits, this feature allows you to store several variables in a single memory block.  The syntax for declaring a bit field is: <br><br><pre> <code class="cpp hljs">_ &lt;_&gt; : _</code> </pre> <br>  The type can be char, short, int, int64 (unsigned or signed) or any other equivalent type.  If the name of some variable is not specified, it will be skipped.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> alpha : <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> : <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> beta : <span class="hljs-number"><span class="hljs-number">15</span></span>;</code> </pre> <br>  Thus, in one four-byte field (32 bits) there will be two variables: alpha and beta, the first one takes 5 bits, the second one - 15 bits, and 12 bits between variables are omitted. <br><br>  Bitwise structures can be combined with joins by adding a colon character and a value defining the number of bits after its declaration.  For example, in order to ‚Äúpack‚Äù two unions into a single ushort, you can do the following: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> &lt;ushort&gt; ENUM1 { VAL1_1=<span class="hljs-number"><span class="hljs-number">25</span></span>, VAL1_2=<span class="hljs-number"><span class="hljs-number">29</span></span>, VAL1_3=<span class="hljs-number"><span class="hljs-number">7</span></span> } var1 : <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> &lt;ushort&gt; ENUM2 { VAL2_1=<span class="hljs-number"><span class="hljs-number">5</span></span>, VAL2_2=<span class="hljs-number"><span class="hljs-number">6</span></span> } var2 : <span class="hljs-number"><span class="hljs-number">4</span></span>;</code> </pre> <br><br><h4>  V - Arbitrary variables (custom variables) </h4><br>  Some binary formats use variables of specific types that are inconvenient for visual presentation.  The 010 Editor has a good mechanism for defining a variable in any way.  To do this, you can create a function that translates the value of a variable into a string (after performing a series of transformations), this string will be displayed on the Template Results panel as a variable value.  Such is the reading mechanism, the writing mechanism is similarly defined. <br><br>  To assign a read and write function for a variable, use the attribute '&lt;read = &lt;function_name &gt;&gt; and &lt;write = &lt;name_function &gt;&gt;', respectively.  The read function takes a variable as an argument and returns a string; the write function takes as its argument a pointer to the variable and its value in the string representation.  For example, to define a ‚Äúfractional‚Äù type using 16 bits (8 high bits define the integer part, and 8 low bits - fractional), you can use the function: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> ushort FIXEDPT &lt;read=FIXEDPTRead, write=FIXEDPTWrite&gt;; <span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FIXEDPTRead</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( FIXEDPT f )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> s; SPrintf( s, <span class="hljs-string"><span class="hljs-string">"%lg"</span></span>, f / <span class="hljs-number"><span class="hljs-number">256.0</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FIXEDPTWrite</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( FIXEDPT &amp;f, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> s )</span></span></span><span class="hljs-function"> </span></span>{ f = (FIXEDPT)( Atof( s ) * <span class="hljs-number"><span class="hljs-number">256</span></span> ); }</code> </pre> <br>  In this example, the FIXEDPT variable can be defined without the record attribute, but in this case it will be read-only. <br><br>  When displaying arrays in the Template Results panel, usually no values ‚Äã‚Äãare displayed until the array is ‚Äúexpanded‚Äù.  In order to determine a value at once for the entire array, you can use an arbitrary variable, read and write functions.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> VEC3F[<span class="hljs-number"><span class="hljs-number">3</span></span>] &lt;read=Vec3FRead, write=Vec3FWrite&gt;; <span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Vec3FRead</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( VEC3F v )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> s; SPrintf( s, <span class="hljs-string"><span class="hljs-string">"(%f %f %f)"</span></span>, v[<span class="hljs-number"><span class="hljs-number">0</span></span>], v[<span class="hljs-number"><span class="hljs-number">1</span></span>], v[<span class="hljs-number"><span class="hljs-number">2</span></span>] ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Vec3FWrite</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( VEC3F &amp;v, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> s )</span></span></span><span class="hljs-function"> </span></span>{ SScanf( s, <span class="hljs-string"><span class="hljs-string">"(%f %f %f)"</span></span>, v[<span class="hljs-number"><span class="hljs-number">0</span></span>], v[<span class="hljs-number"><span class="hljs-number">1</span></span>], v[<span class="hljs-number"><span class="hljs-number">2</span></span>] ); }</code> </pre> <br>  Learn that now the functions of reading and writing can not be defined for individual elements of an array or each element. <br><br><h4>  VI - On-Demand Structures </h4><br>  A large number of variables can be defined in a template, which is very expensive in terms of system memory.  In order to take into account this nuance, you can use On-Demand structures.  In this case, the variables within the structure or union are not ‚Äútransferred‚Äù to the examined file until it is necessary (for example, until the structure is expanded in the Template Resilts panel).  In order to use On-Demand structures or unions, you must manually specify their sizes in advance: '&lt;size = |'.  The size of such structures and associations is always fixed.  For example: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> header; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> value1; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> value2; } MyStruct &lt;size=<span class="hljs-number"><span class="hljs-number">12</span></span>&gt;;</code> </pre> <br>  In this case, the contents of the MyStruct structure (header, value1, and value2) are not determined until it is necessary. <br><br><h4>  VII - Restrictions </h4><br>  The 010 Editor templates, despite a number of similarities with ANSI C, have a number of significant differences and are not fully compatible.  The list of important differences between ANSI C and 010 Editor templates: <br><br><h5>  Pointers </h5>  Currently, the use of '* "pointers is not supported. Only' &amp; 'links are supported for function arguments. <br><br><h5>  Directives </h5>  Most preprocessor directives are supported, including #define, #ifdef, #ifndef, etc.  However, the #if directive is not currently supported, as is a macro declaration using the #define directive. <br><br><h5>  Multidimensional arrays </h5>  Currently, multidimensional arrays are not supported, but there is an alternative way to use them.  For example, instead of defining 'float matrix [4] [4]', the same array can be defined as: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> row[<span class="hljs-number"><span class="hljs-number">4</span></span>]; } MATRIX[<span class="hljs-number"><span class="hljs-number">4</span></span>]; MATRIX m;</code> </pre> <br><h5>  Transfer of control </h5>  Goto is not supported. <br><br>  <i>If you have questions, ask, always ready to answer.</i> <i><br></i>  <i>The translation may be minor inaccuracies, if you find anything, write to the LAN, I will correct it.</i> <i><br></i>  <i>Regards, <a href="https://habrahabr.ru/users/dageron/" class="user_link">Dageron</a> .</i> <br><br>  See also: <br><ul><li>  <a href="http://habrahabr.ru/post/213211/">Skills in writing templates and working in the hex editor 010 Editor - Part I</a> </li><li>  <a href="http://habrahabr.ru/post/213435/">Skills in writing templates and working in the hex editor 010 Editor - Part II</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/213639/">https://habr.com/ru/post/213639/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213625/index.html">Oktodon keyboard and world record</a></li>
<li><a href="../213627/index.html">YM modular system</a></li>
<li><a href="../213629/index.html">Screenshot Editor at Yandex.Disk</a></li>
<li><a href="../213633/index.html">Belarusian companies were demanded to certify sold information security tools</a></li>
<li><a href="../213635/index.html">Electronics manufacturing in China - what to expect? (part two)</a></li>
<li><a href="../213645/index.html">Python-digest # 15. News, interesting projects, articles and interviews [February 18, 2013 - February 23, 2014]</a></li>
<li><a href="../213647/index.html">Contactless communication</a></li>
<li><a href="../213651/index.html">The Bank of Russia considers bitcoins as a financial pyramid</a></li>
<li><a href="../213653/index.html">Mt.Gox CEO Mark Karples resigned on the board of directors of the Bitcoin Foundation</a></li>
<li><a href="../213655/index.html">Is M.2 the prince of SSD form factors?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>