<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create a convenient viewer for vk.com using Fluid.app with notification of new messages in the dock Mac OS X</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 One day after reading one article , I was eager to make such a wrapper for contacting preference and courtesans, especially since with adequ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create a convenient viewer for vk.com using Fluid.app with notification of new messages in the dock Mac OS X</h1><div class="post__text post__text-html js-mediator-article"> Hello! <br><br>  One day after reading one <a href="http://habrahabr.ru/post/28706/">article</a> , I was eager to make such a wrapper for contacting preference and courtesans, especially since with adequate applications for Mac from Durov's team, things are very tight, and with this approach you can get an almost complete desktop application. <br><br><img src="https://habrastorage.org/storage2/2f4/82a/2b6/2f482a2b666b153226be96a7240045c7.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And what came out of it - under the cut. <br><a name="habracut"></a><br>  First of all, downloading <a href="http://fluidapp.com/">the</a> free version from the <a href="http://fluidapp.com/">official site</a> , I wanted to understand what is being proposed and how it can work with notifications, especially since the site in the <a href="http://fluidapp.com/developer/">section for developers</a> flashed the cherished API abbreviation.  However, immediately after installation and first acquaintance with the program, a slight disappointment awaited - the free version does not want to work with notifications, and this functionality is only available in the full version for $ 4.99 along with a couple of other very interesting features, such as: connecting your own js and css, as well as the opportunity to fix our application in the status bar.  I will not describe the use of the program in detail, because the site has made more than an available video for this. <br><br>  Interest nevertheless took its toll, and five green American presidents for the experiments turned out to be not at all a pity.  And just after the purchase (the activation is done with an xml-like .fluidlicense file, which is automatically sent to the email from support@fluidapp.com), the most interesting begins. <br><br>  The fact is that the bundled notifications are pre-configured only for facebook, gmail and Google Reader (hee-hee), and they are nothing more than a regular javascript code hidden in the program's Userscripts settings: <br><img src="https://habrastorage.org/storage2/ae1/b66/12f/ae1b6612f00d6e674e9e8fdb66d42e87.png"><br>  On the one hand, this is a disappointment, but on the other, the open space for creativity. <br><br>  As can be seen from the settings window, you can specify not only the script itself, but also the mask of the address to which it will apply.  For example, the string <code>*facebook.com*</code> will cover all subdomains and pages where <code>facebook.com</code> is found. <br>  From the given example code for facebook, it is clear that there is no talk of API work directly, the script just parses the page, and draws the necessary part of it, passing it as a value for the application's badge in the dock using <code>window.fluid.dockBadge</code> . <br><br>  Thanks to existing examples for Facebook, all we have to do is use this model for contact. <br>  So, we add a new user script, called for example VK, and the mask <code>*vk.com*</code> (you can do it for other addresses, including vkontakte.ru, but personally I go only by a short name, and so this makes no sense). <br><br>  Having slightly edited the script, I decided to also add a sound for each new unread message using the <code>window.fluid.playSound("Glass")</code> method from the Fluid API. <br><br>  Here is the complete code for the resulting script with comments: <br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.fluid.dockBadge = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  ,            setTimeout(updateDockBadge, 500); //       setInterval(updateDockBadge, 1000); //    function updateDockBadge() { var msgCounter = document.querySelector( "#l_msg&gt;a&gt;span&gt;span&gt;span" ); //    DOM-         var val = +msgCounter.innerHTML; //   HTML     ,    val if(isNaN(val)) { } else { newBadge = val; } //      ,     --   ,    --     val if(val &gt; window.fluid.dockBadge) {window.fluid.playSound("Glass");} //    ,   ,   var newBadge; //       window.fluid.dockBadge = newBadge; //     API     }</span></span></code> </pre><br><br>  The only small ‚Äúpichalka‚Äù is that the number of messages is shown only if the program is in icon mode in the dock, and when it is minimized to the status bar, the ability to display quantitative indicators there by regular means is no longer there. <br><br>  In fact, we completed the main task, however, a small, still slightly annoying item in the form of advertising remained, which we can also simply get rid of using Userstyles, creating a new style with the same mask for the URL and inserting a tiny CSS code: <br><pre> <code class="css hljs"><span class="hljs-selector-id"><span class="hljs-selector-id">#left_ads</span></span> {<span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:none}</code> </pre><br><br>  Everything.  Thanks to these simple manipulations, we got quite a convenient application for using the contact from under Mac OS X without clogging the Safari tabs and receiving an audio notification with the display of the number of unread messages. <br><br>  I hope the article will be useful to someone, and despite the fact that it considers an example only for vk.com, this approach can be applied to a huge number of any other sites convenient to you.  What is the most valuable, we did not use so disliked by many Vkontakte APIs at all and cost just a few lines of code. </div><p>Source: <a href="https://habr.com/ru/post/174197/">https://habr.com/ru/post/174197/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../174181/index.html">How to save money in Amazon Web Services - choosing an efficient architecture</a></li>
<li><a href="../174183/index.html">5% of computers protected by antivirus are still infected</a></li>
<li><a href="../174187/index.html">The digest of interesting news and materials from the world of PHP over the past two weeks, number 13 (03/12/2013 - 03/25/2013)</a></li>
<li><a href="../174189/index.html">GamePlay 3D Framework - easy start to cross-platform development of 3D games</a></li>
<li><a href="../174195/index.html">Programming ARM Controllers in Eclipse on Ubuntu: how to do it</a></li>
<li><a href="../174201/index.html">Sony SmartWatch, 7 dream apps</a></li>
<li><a href="../174205/index.html">Easy setup of replication in PostgreSQL</a></li>
<li><a href="../174207/index.html">Swig - JavaScript Template Engine with Django Template Syntax</a></li>
<li><a href="../174209/index.html">Report on the eighth Habrebest</a></li>
<li><a href="../174211/index.html">BYOD in a container: we virtualize Android. Part one</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>