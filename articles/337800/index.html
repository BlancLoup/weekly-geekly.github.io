<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Two-factor authentication for VPN connections</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In order to further enhance the security of external connections to the internal resources of the corporate network, it is recommended to ‚Äústrengthen‚Äù...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Two-factor authentication for VPN connections</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/845/6ed/416/8456ed4166bc42bda8090650f6a69542.jpg"><br><br>  In order to further enhance the security of external connections to the internal resources of the corporate network, it is recommended to ‚Äústrengthen‚Äù VPN connections with a two-factor authentication procedure.  This can be done easily with <a href="https://habrahabr.ru/company/panda/blog/337174/">Panda GateDefender</a> . <a name="habracut"></a><br><br>  VPN allows two separate local networks to directly connect to each other securely using potentially insecure networks, such as the Internet.  All network traffic within a VPN connection is safely transmitted inside an encrypted tunnel, hidden from prying eyes.  This configuration is called Gateway-to-Gateway VPN (Gw2Gw VPN).  Similarly, a single remote computer located somewhere on the Internet can use a VPN tunnel to connect to the desired local area network.  In this case, the remote computer, sometimes called Road Warrior, looks as if it is physically present on this local network as long as the VPN tunnel is active. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Such VPN capabilities are very convenient: in the era of BYOD and distributed information systems, secure VPN connections are a fairly simple and effective solution that allows <b>secure access of remote and mobile employees to internal corporate IT resources</b> (internal local network, database, file servers and etc.). <br><br>  <a href="https://www.cloudav.ru/enterprise/downloads/docs/product/gatedefender/">Panda GateDefender's</a> UTM solution for protecting the perimeter of the corporate network allows you to solve this issue.  The solution supports the creation of a VPN based either on the IPsec protocol, which is supported by most operating systems and network devices, or on the OpenVPN service. <br><br>  The Panda GateDefender solution can be configured as an OpenVPN server or client (or can play both of these roles at the same time) to create a network of devices connected via OpenVPN.  In short, the capabilities of the solution allow: <br><br>  ‚Ä¢ configure the OpenVPN server so that clients can connect to one of the local zones <br>  ‚Ä¢ configure the client part of the Gateway-to-Gateway scheme between two or more Panda GateDefender solutions <br>  ‚Ä¢ configure IPsec-based VPN tunnels and L2TP connections <br>  ‚Ä¢ manage VPN connection users <br>  ‚Ä¢ Configure the certificates that will be used for VPN connections. <br><br>  By themselves, VPN connections are secure enough to be intercepted and decrypted.  But what to do if the attacker in some way (and there are a lot of them ...) found out the login and password for the VPN connection and / or even got remote (physical) access to the computer of your mobile or remote employee on his behalf to connect to a corporate VPN network?  How can I increase the security of VPN connections? <br><br>  <b>Two-factor authentication</b> <br><br>  In this case, two-factor authentication (2FA) will help - this is a security process in which users must provide an additional temporary one-time password (TOTP) for more secure self-identification.  This additional password is generated by a token or code generation device, or, as an alternative, by a special application installed on the user's smartphone. <br><br>  Two-factor authentication increases the security of a VPN connection, since  in this case, it requires not only a username and password, but also an additional temporary one-time code (TOTP) generated by the token.  Therefore, the user authentication process is a combination of the data that the user already knows (username and password) and the data that the user receives separately (code generated by a token or TOTP-compatible application installed on the user's smartphone). <br><br>  There is a wide variety of token devices and their manufacturers on the market.  Each of them implements its own algorithm, but they all require the integration of their technologies on the server.  Many of these manufacturers provide both hardware solutions ( <b>physical tokens, generating codes</b> ) and software solutions, such as smartphone applications that generate <b>TOTPs</b> . <br><br>  To achieve interoperability between manufacturers, there is an open standard that can be used without the need for third-party software licensing.  This standard was published in RFC 6238. <br><br>  <b>Installing a token on the user's device</b> <br><br>  Users can use any <b>TOTP-</b> compatible device or smartphone app.  There are a huge number of free applications that support this standard, for example: <br><br><img src="https://habrastorage.org/web/e4b/8af/4f2/e4b8af4f282143f48fa5a9e8b1b799de.JPG"><br><br>  To generate TOTP codes, the user must set up an account in the application.  There are two ways to set up an account for the Panda GateDefender solution: <br><br>  ‚Ä¢ Manually create an account by copying the one-time password text code generated in the Panda GateDefender management console. <br>  ‚Ä¢ Photograph a QR code generated by the GateDefender console using a smartphone camera. <br><br>  The text code and QR code contain all the information needed to set up an account. <br>  After the account has been configured, the token application will generate one-time passwords every 30 seconds.  Since  the password generation algorithm is based on the device clock, then no internet connection is required.  However, there should not be much difference between the time configured in the GateDefender solution and on the user's device.  The figure below shows the interfaces of some applications for smart phones to generate passwords. <br><br><img src="https://habrastorage.org/web/4ef/1e4/0dc/4ef1e40dc551473f92947fff22fe5198.jpg"><br><br><h4>  Configuring two-factor authentication in GateDefender </h4><br>  Follow the steps below to enable two-factor authentication in the GateDefender solution: <br><br>  ‚Ä¢ Add a one-time password authorization server. <br>  ‚Ä¢ Define a new mapping to this server. <br><br>  <b>Adding a new one-time password authorization server</b> <br><br>  Go to <b>VPN -&gt; Authorization -&gt; Settings</b> and click the <b>Add new authorization server</b> link. <br><br><img src="https://habrastorage.org/web/99e/007/c74/99e007c74cbd4e8cad3bc43d756d7b16.jpg"><br><br>  For the Type option, select <b>One-time password</b> .  Then select <b>Local (local)</b> in <b>the User Information</b> <b>Provider</b> and <b>Password Provider</b> fields.  Enter the name of the new authorization server in the <b>Name</b> field and click the <b>Add</b> button. <br><br><img src="https://habrastorage.org/web/9ae/02c/9af/9ae02c9af72b4d8f9735b18b93d52d13.JPG"><br><br>  In this example, we used a local password provider to verify the username and password entered by the user.  However, two-factor authentication also supports other types of password providers. <br><br>  <b>Defining a new mapping to the authorization server</b> <br><br>  After creating the authorization server, you need to configure a new mapping for one of the VPN types supported by GateDefender. <br>  To add a new mapping to the authorization server, click on the icon <img src="https://habrastorage.org/web/b05/dac/c31/b05dacc3193e46dcad880bce6036e324.jpg">  corresponding to the type of VPN you want to configure. <br><br><img src="https://habrastorage.org/web/962/96b/0fc/96296b0fc08a4265a81950b9288d5d89.jpg"><br><br>  In the new window, click the icon <img src="https://habrastorage.org/web/eac/730/f67/eac730f67a984ea3ae5a9d0925336e7e.jpg">  to add a new mapping to the authorization server.  The new server will appear in the right pane.  To remove the mapping, click the icon <img src="https://habrastorage.org/web/64d/d12/404/64dd12404fe14266a2e38d6e3a7c916d.jpg">  .  To add or remove all mappings, click the <b>Add All</b> and <b>Delete All</b> links, respectively. <br><br><img src="https://habrastorage.org/web/e4b/baf/850/e4bbaf850487461da646ed7ce7185fd6.jpg"><br><br><h4>  Setting up the 2FA service on the user's device </h4><br>  The figure below shows the configuration procedure: <br><br><img src="https://habrastorage.org/web/bf4/0b6/5f8/bf40b65f88164cd3b16b7c8034569171.jpg"><br><br>  ‚Ä¢ Create a new user in GateDefender and generate a QR code or key. <br>  ‚Ä¢ Mail a QR code to the user or print it out and send it manually.  If the user does not have a camera on the smartphone, then give him the text code. <br>  ‚Ä¢ The user must scan the QR code (enter a text code) using the TOPT-compatible application installed on his smartphone. <br>  ‚Ä¢ The application will be able to generate access codes. <br><br>  <b>Creating a new user in GateDefender and generating a QR code or text code</b> <b><br></b> <br>  Go to <b>VPN-&gt; Authorization-&gt; Users</b> and click <b>Add New Local User</b> . <br><br><img src="https://habrastorage.org/web/6d4/9b1/06d/6d49b106d72f4c6483e989b394d9f109.jpg"><br><br>  When adding a new user, click then <b>Show QR Code</b> .  Send the code in text form to those users who do not have an application on their smartphones to read QR codes so that it can be scanned. <br><br><img src="https://habrastorage.org/web/442/2ab/0bf/4422ab0bfbee4e7c8c6eb9a2ca34cade.jpg"><br><br>  To download the QR code from the GateDefender console, simply right-click on it and select the <b>Read QR code from image</b> option in the context menu. <br><br><img src="https://habrastorage.org/web/70d/332/bf0/70d332bf0f3a462dabacb25a97897acf.jpg"><br><br>  <b>Sending a QR code (text code) by mail to the user or printing and sending it manually</b> <b><br></b> <br>  After you have downloaded the QR code (copied the text code), you can send it to the user by email or print it and transfer it to him manually. <br><br>  <b>User scanning of a QR code (text code entry) using a TOPT-compatible application installed on his smartphone</b> <br><br>  After receiving a QR code or a text code, the user must import it into the TOPT-compatible application. <br>  You can cancel the previously set up account on the user's smartphone by generating a new text code or QR code and scanning it using the application. <br><br>  <b>User connection</b> <br><br>  After the two-factor authentication has been enabled, the user connection process will change: the user will be required to provide a valid code generated by the token when connecting with his VPN account.  The process is shown in the figure below. <br><br><img src="https://habrastorage.org/web/4f6/a34/557/4f6a345577f24ba39812c4e8b2df5ed0.jpg"><br><br><h4>  Conclusion </h4><br>  In our article, we examined the case when it was necessary to increase the level of security of VPN connections for remote and mobile employees of an enterprise.  As a solution to the task, we used the two-factor authentication feature implemented using the Panda GateDefender UTM solution to protect the perimeter of the network. <br><br>  <b><a href="https://www.cloudav.ru/enterprise/downloads/docs/product/gatedefender/">More information about Panda GateDefender</a></b> <br><br>  You can also order a free version of Panda GateDefender for a period of 1 month by sending a request to sales@rus.pandasecurity.com. </div><p>Source: <a href="https://habr.com/ru/post/337800/">https://habr.com/ru/post/337800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337778/index.html">To root and features were</a></li>
<li><a href="../337780/index.html">BlueBorne's Bluetooth vulnerability affects billions of devices</a></li>
<li><a href="../337782/index.html">BlueBorne exploit on Android, iOS, Linux and Windows: more than 8 billion devices are critically vulnerable</a></li>
<li><a href="../337784/index.html">Implementing OpenId Connect in ASP.NET Core using IdentityServer4 and oidc-client</a></li>
<li><a href="../337786/index.html">VMworld 2017 Europe Conference. Day 0</a></li>
<li><a href="../337802/index.html">The practice of forming requirements in IT projects from A to Z. Part 7. Transfer of requirements into production. Conclusion</a></li>
<li><a href="../337804/index.html">Investigation of information leaks from the carrier‚Äôs corporate database</a></li>
<li><a href="../337806/index.html">Selection: 10 useful tools for an internet marketer</a></li>
<li><a href="../337808/index.html">When size matters: create a ruler application with ARKit</a></li>
<li><a href="../337810/index.html">Computer vision. Ask an Intel Expert Question</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>