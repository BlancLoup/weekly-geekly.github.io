<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cyber ‚Äã‚Äãoracle: search for anomalies in monitoring data using a neural network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The amount of data that our monitoring receives has grown so much that only the human mind is not enough for processing them. Therefore, we have train...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cyber ‚Äã‚Äãoracle: search for anomalies in monitoring data using a neural network</h1><div class="post__text post__text-html js-mediator-article"><p>  The amount of data that our monitoring receives has grown so much that only the human mind is not enough for processing them.  Therefore, we have trained artificial intelligence to help us look for anomalies in the data obtained.  And now we have a Cyber-Oracle. </p><br><p><img src="https://habrastorage.org/webt/l6/5x/8z/l65x8z6ghiqf0poblw8mltx7kse.png" alt="Cyber ‚Äã‚Äãoracle obviously"></p><a name="habracut"></a><br><h2 id="1-postanovka-zadachi-i-motivaciya">  1. Problem statement and motivation </h2><br><p>  Hello, my name is Ivan Khozyainov, I work at ITSumma.  The company is engaged in the support and administration of a large number of sites, the main task is to quickly respond to incidents and prevent them.  To do this, we have a staff of duty administrators and a monitoring system that collects important indicators from servers and stores this data into a common database. </p><br><p>  The monitoring system sends an alert when the limit value of one of the important parameters is reached.  What parameters should be considered important and which values ‚Äã‚Äãwill be the limit for them by the system administrators on duty when setting up monitoring.  But there is obviously a strange behavior that passes by the monitoring system, because the limit values ‚Äã‚Äãhave not been reached. </p><br><p><img src="https://habrastorage.org/webt/cl/xm/mk/clxmmkbskd4ifthkbhuxk3dgtmm.png" alt="Fig.1 Monitoring system"><br>  <em>Fig.1 Monitoring system</em> </p><br><p>  To notice such anomalies, it is necessary to constantly look through a huge amount of data, the physical capabilities of a person for this are simply not enough.  Therefore, always vigorous computer hardware and mathematics come to the rescue.  I want to tell you about the problem of searching for anomalies in the accumulated array of data about the life of servers. </p><br><h2 id="2-istoriya-voprosa">  2. Background </h2><br><p>  The task of finding anomalies is quite common and it is intuitive: we are looking for something unusual among the data.  The topic excites consciousness, so it is logical that there are commercial products that do this, for example <a href="http://anomaly.io/">http://anomaly.io</a> and <a href="http://grokstream.com/">http://grokstream.com</a> . </p><br><p>  But back to the task itself.  We assume that the data is represented by a set of measurements and each measurement is represented by a set of parameters, for example, the current Load Average readings for the CPU, HDD Free Space, etc.  From the point of view of mathematics, this can be represented as a vector function: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.319ex" height="2.66ex" viewBox="0 -832 12623.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-28" x="572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-29" x="1323" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-3D" x="1990" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-28" x="3047" y="0"></use><g transform="translate(3436,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-31" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-28" x="4462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="4852" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-29" x="5213" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-2C" x="5603" y="0"></use><g transform="translate(6048,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-32" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-28" x="7075" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="7464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-29" x="7826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-2C" x="8215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-2E" x="8660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-2E" x="9105" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-2E" x="9551" y="0"></use><g transform="translate(9996,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-6E" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-28" x="11093" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="11482" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-29" x="11844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-29" x="12233" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> x (t) = (x_1 (t), x_2 (t), ... x_n (t)) </script></p><br><p>  Where t is time, and n is the number of measured parameters. <br>  There are many articles on mathematical formalization and approaches to its solution.  The review article <a href="http://cucis.ece.northwestern.edu/projects/DMS/publications/AnomalyDetection.pdf">[1]</a> provides a classification for the types of anomalies: </p><br><ul><li>  <strong>point</strong> - this is when a specific dimension is knocked out of the big picture: the so-called <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D1%258B%25D0%25B1%25D1%2580%25D0%25BE%25D1%2581_(%25D1%2581%25D1%2582%25D0%25B0%25D1%2582%25D0%25B8%25D1%2581%25D1%2582%25D0%25B8%25D0%25BA%25D0%25B0)">overshoot</a> or outlier </li><li>  <strong>collective</strong> - when the totality of measurements is abnormal with respect to the entire data set, even when each measurement is not out of the general picture: for example, a cardiogram, where a collective anomaly is highlighted with red due to arrhythmia (Fig. 2) <br><img src="https://habrastorage.org/webt/ie/eq/w2/ieeqw2bqlse0qomxpv1awkw-v2c.png" alt="Fig. 2. Anomaly on the cardiogram"><br>  <em>Fig.</em>  <em>2. Anomaly on the cardiogram</em> </li><li>  <strong>contextual</strong> - in this case, the anomaly is determined according to the context: for example, low winter temperatures are normal, but in summer this will be an anomaly (Fig. 3).  Although, depending on where, it depends on the context. <br><img src="https://habrastorage.org/webt/uu/as/sa/uuassaml1a69nz_ii7ugsosvw8e.png" alt="Fig. 3. Seasonality can set the context: t2 is an anomaly, and t1 is not"><br>  <em>Fig.</em>  <em>3. Seasonality can set the context: t2 is an anomaly, and t1 is not</em> </li></ul><br><p>  Finding a point anomaly often comes down to finding the expectation and standard deviation, and then everything that breaks out beyond a certain threshold after the standard deviation is considered an anomaly.  But things get interesting with contextual and collective anomalies. </p><br><p>  Seasonality ( <em>English</em> Seasonality) and trends are most often used as a context for time series.  For filtering seasonality, the <a href="https://en.wikipedia.org/wiki/Exponential_smoothing">Holt-Winter</a> exponential <a href="https://en.wikipedia.org/wiki/Exponential_smoothing">smoothing</a> <a href="http://www.imvu.com/technology/anomalous-behavior.pdf">[2]</a> <a href="http://www.oreilly.com/webops-perf/free/files/anomaly-detection-monitoring.pdf">[3]</a> can be used.  But for now, we will not touch upon this context, as well as trends.  Also, as a context, additional data can act like logs on the server <a href="https://www.microsoft.com/en-us/research/publication/context-aware-time-series-anomaly-detection-for-complex-systems/">[4]</a> .  For the time being, we will not touch this either, but let us look at the possibility of finding collective anomalies, such as vibrations and peaks.  Among the publications you can find tips on the use of neural networks <a href="http://www.oreilly.com/webops-perf/free/files/anomaly-detection-monitoring.pdf">[3]</a> and specific architectures when searching for anomalies in the time series <a href="https://www.elen.ucl.ac.be/Proceedings/esann/esannpdf/es2015-56.pdf">[5]</a> .  Let's try to take into account the recommendations as much as possible, although the rake will still be expected. </p><br><h2 id="3-vybor-instrumentov">  3. Selection of tools </h2><br><p>  The first thing we need is the choice of software and mathematical tools.  As a mathematical tool, we will use naive formulas for detecting strong oscillations on a graph, such as this: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>S</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><msubsup><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mn>1</mn></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mn>2</mn></msub></mrow></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mspace width=&quot;thinmathspace&quot; /><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>r</mi><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi></mrow><mi>t</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.305ex" height="3.383ex" viewBox="0 -987.6 11756.1 1456.5" role="img" focusable="false" style="vertical-align: -1.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-3D" x="923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-69" x="2229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-6E" x="2575" y="0"></use><g transform="translate(3175,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="0" y="0"></use><g transform="translate(361,451)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-32" x="511" y="-213"></use></g><g transform="translate(361,-279)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-31" x="511" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-7C" x="4213" y="0"></use><g transform="translate(4492,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-2032" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-28" x="5359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="5748" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-29" x="6110" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-7C" x="6499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-6D" x="7195" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-61" x="8073" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="8603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-68" x="8964" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-72" x="9541" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-6D" x="9992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-64" x="10871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="11394" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><msubsup><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mn>1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mn>2</mn></msub></mrow></msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>x</mi><mo>‚Ä≤</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>r</mi><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi></mrow><mi>t</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> S = \ int_ {t_1} ^ {t_2} | x '(t) | \, \ mathrm {d} t </script></p><br><p>  At the ideological level, this means the sum of all possible variations for a certain period of time. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.115ex" height="2.66ex" viewBox="0 -832 2633 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-31" x="511" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-2C" x="1093" y="0"></use><g transform="translate(1539,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-32" x="511" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-5D" x="2354" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-3"> [t_1, t_2] </script></p><br><p>  Since our function is discrete, the formula accordingly will look something like this: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>S</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>t</mi><msubsup><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><msub><mi>t</mi><mn>1</mn></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mn>2</mn></msub><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mtext>&amp;#xA0;</mtext><mi>t</mi><mi>a</mi><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.183ex" height="3.383ex" viewBox="0 -987.6 17731.4 1456.5" role="img" focusable="false" style="vertical-align: -1.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-3D" x="923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-73" x="2229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-75" x="2699" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-6D" x="3271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-6C" x="4400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-69" x="4698" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-6D" x="5044" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-69" x="5922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="6268" y="0"></use><g transform="translate(6629,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,451)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-32" x="511" y="-213"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-2212" x="815" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-31" x="1593" y="0"></use></g><g transform="translate(469,-279)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-3D" x="361" y="0"></use><g transform="translate(806,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-31" x="511" y="-213"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-7C" x="8680" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-78" x="8958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-28" x="9531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="9920" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-2B" x="10504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-31" x="11504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-29" x="12005" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-2212" x="12617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-78" x="13617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-28" x="14190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="14579" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-29" x="14941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-7C" x="15330" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-74" x="15859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-61" x="16220" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-67" x="16750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-31" x="17230" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mtext>&nbsp;</mtext><mi>l</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>t</mi><msubsup><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><msub><mi>t</mi><mn>1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mn>2</mn></msub><mo>‚àí</mo><mn>1</mn></mrow></msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>‚àí</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi>t</mi><mi>a</mi><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> S = \ sum \ limits_ {t = t_1} ^ {t_2-1} | x (t + 1) - x (t) | \ tag {1} </script></p><br><p>  Now you can determine the threshold and it will be a ready-made detector of any bursts.  But we will not determine independently, but we will charge this to the neural network. </p><br><p>  Python was chosen as the prototyping language for <a href="https://clickhouse.yandex/">Yandex‚Äôs Clickhouse</a> database server with quite convenient <a href="https://github.com/Infinidat/infi.clickhouse_orm">use of it from Python</a> .  To work with neural networks, the <a href="http://tensorflow.org/">Tensorflow</a> framework <a href="http://tensorflow.org/">from Google</a> was chosen.  We will count everything on two Nvidia GTX1080 GPUs, spending precious power not on mining, but on real research tasks. </p><br><p>  From the point of view of mathematics, a neural network is a function: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Y</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.289ex" height="2.66ex" viewBox="0 -832 3999.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-59" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-3D" x="1041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-66" x="2097" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-28" x="2648" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMATHI-78" x="3037" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/itsumma/blog/341598/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgvmDdMeufFXx_79XBwjLC8bzp4SQ#MJMAIN-29" x="3610" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> Y = f (x) </script></p><br><p>  where Y is the answer to the question, and X is the input.  The function is rather complicated, but it can be trained, for example, <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE_%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D1%2580%25D0%25BE%25D1%2581%25D1%2582%25D1%2580%25D0%25B0%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25BE%25D1%2588%25D0%25B8%25D0%25B1%25D0%25BA%25D0%25B8">by the method of back propagation of an error</a> . </p><br><h2 id="4-podgotovka-dannyh">  4. Data preparation </h2><br><p>  Recently, a <a href="https://habrahabr.ru/post/340792/">good article</a> was published on Habr√© on the topic of neural networks, where a separate preprocessing item was highlighted.  I would like to add that in addition to normalizing the data, at this stage you can also attend to the completion of data (for example, interpolation) so that there are no gaps.  In an ideal world, measurements should come from the servers and be written to the database every 15 seconds, but in the real world, some metrics for various reasons may not reach or reach at the wrong time, so you need to somehow fill this missing information with various assumptions.  For example, we want to know the change in the Load Average parameter for the CPU, and in the database it will look conditional like this: </p><br><table><thead><tr><th></th></tr></thead><tbody><tr><td>  Time </td><td>  0:13 </td><td>  0:14 </td><td>  0:47 </td><td>  1:53 </td><td>  Two o'clock </td></tr><tr><td>  Load average </td><td>  1.73 </td><td>  1.8 </td><td>  1.6 </td><td>  1.5 </td><td>  1.48 </td></tr></tbody></table><br><p>  Imagine that every 15 seconds is one unit of time t.  Then, if you make a simple enough filling of the array, then everything will look like this: </p><br><table><thead><tr><th></th></tr></thead><tbody><tr><td>  <em>t</em> </td><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td></tr><tr><td>  <em>x (t)</em> </td><td>  1.8 </td><td>  - </td><td>  - </td><td>  1.5 </td><td>  1.48 </td></tr></tbody></table><br><p>  Of course, you can build a linear interpolation, but then the time of preliminary data processing can grow many times (not to mention more complex methods), which is critical for large amounts of data.  Even a seemingly simple addition with such assumptions can also slow down the process of data preparation: </p><br><table><thead><tr><th></th></tr></thead><tbody><tr><td>  <em>t</em> </td><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td></tr><tr><td>  <em>x (t)</em> </td><td>  1.8 </td><td>  1.7 </td><td>  1.6 </td><td>  1.5 </td><td>  1.48 </td></tr></tbody></table><br><p>  Therefore, in the final version, the dumbest possible method was chosen (it‚Äôs also the fastest) - if the value is omitted, then we take the nearest previous one: </p><br><table><thead><tr><th></th></tr></thead><tbody><tr><td>  <em>t</em> </td><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td></tr><tr><td>  <em>x (t)</em> </td><td>  1.8 </td><td>  1.8 </td><td>  1.8 </td><td>  1.5 </td><td>  1.48 </td></tr></tbody></table><br><p>  So, we have some function and we can begin to form tensors for learning.  From the point of view of the python program, tensors are simply multi-dimensional arrays. </p><br><h2 id="5-chto-bylo-sdelano-snachala-i-kak-delat-ne-stoit">  5. What was done first and how not to do </h2><br><p> According to one of Clark's laws: "Any sufficiently advanced technology is indistinguishable from magic."  And given that the neural network is quite difficult to understand due to its objective structural complexity and is capable of incredible things, you can begin to feel some reverence for this tool and make rash actions. </p><br><p>  From the very beginning, I wanted to try to train a neural network on all existing data, dividing something like this: 90% for data that we will consider normal.  And 10% of the data is just to check - suddenly there will be something abnormal.  Well, and vice versa, choose the most boring server life of 10%, where nothing happens and after learning check on the remaining 90% of the data. </p><br><p>  I wanted to believe that if you make enough layers and drive all the data into it, she will select the contexts and everything will be able, if brute force goes through a sufficient number of architectures.  But first, let's try how it works on simple functions like sine-cosines with small changes. </p><br><p>  The input to the neural network was a set of data on a logarithmic scale or, more simply, this: the current reading, 15 seconds ago, a minute ago, five minutes ago, half an hour, and so on up to a week.  It seemed that it would help to identify seasonality.  After a little success on a simple sine wave, it's time for prototypes. </p><br><p>  To make it easier to write prototypes, a <a href="http://tflearn.org/">tflearn</a> framework based on tensorflow was used.  As it turned out, it‚Äôs more difficult to distribute tasks between GPUs and this can be done only through environment variables ( <a href="https://github.com/tflearn/tflearn/issues/32">https://github.com/tflearn/tflearn/issues/32</a> ), unlike tensorflow, where you can count part of tasks on one GPU, part - on another within the same program. </p><br><p>  So, for each server - its own neural network for training.  After a chaotic search of architectures from the framework, it became clear that a terabyte hard drive on a machine with neurons is not enough. </p><br><p>  The neural network for each server took more than 100 MB and was trained for an average of 40 minutes, not counting the preliminary training, which also took time.  The data set for training after all the pre-processing took about 5-6 GB. </p><br><p>  Of course, it was nice to look at the console and see how something is happening there.  There was a belief in the magic power of this black box: suddenly it will be possible for bruteforce to pick up the magical parameters of the network, without delving into what is happening.  As you might guess, this approach was unsuccessful. </p><br><h2 id="6-chto-rabotaet-seychas-i-kakoy-put-skoree-vsego-pravilnyy">  6. What is working now and which path is most likely the right one </h2><br><p>  Let's start with simple architectures and <a href="https://en.wikipedia.org/wiki/Multilayer_perceptron">multilayer perceptron</a> .  We assume that we have a classification task and there are two classes - ‚Äúanomaly‚Äù and ‚Äúnot anomaly‚Äù.  Accordingly, we need training data that we need to prepare ourselves.  This approach is described in <a href="http://cucis.ece.northwestern.edu/projects/DMS/publications/AnomalyDetection.pdf">[1]</a> and we need to prepare data sets with <a href="https://en.wikipedia.org/wiki/Labeled_data">‚Äúlabels‚Äù</a> .  The logarithmic scale was removed and just a 25-minute time interval (100 measurements) + the S value from formula (1) began to be input. </p><br><p>  The graph of the function on which the training was carried out is presented in Fig.  4. On the graph, the data is not normalized, but the training was done on normalized.  By the way, free memory on one of the servers is presented here - this is something that changes quite often. </p><br><p><img src="https://habrastorage.org/webt/gx/wu/kl/gxwuklrgi_wb6jed25lj0b2ezjy.png" alt="Fig. 4. Teaching with a teacher, gray highlighted anomalies"><br>  <em>Fig.</em>  <em>4. Teaching with a teacher, gray highlighted anomalies</em> </p><br><p>  We have an input layer, there will be 101 neurons, on the first hidden layer - 55 neurons, on the second hidden layer - 1024, on the output - the class ‚Äúanomaly‚Äù, ‚Äúnot anomaly‚Äù.  The network architecture was chosen, it may be said, by chance, therefore the best option is probably possible. </p><br><p><img src="https://habrastorage.org/webt/d-/mj/ir/d-mjirvzpqr026-l17yl-4yde8a.png" alt="Figure 5. Learning perceptron with two hidden layers"><br>  <em>Figure 5. Learning perceptron with two hidden layers</em> </p><br><p>  The network was trained by <a href="https://www.tensorflow.org/api_docs/python/tf/train/AdamOptimizer">Adam's stochastic gradient descent</a> with the parameter learning_rate = 0.00005, the remaining parameters are left by default.  As a measure, the <a href="https://en.wikipedia.org/wiki/Cross_entropy">cross entropy</a> between the output of the neural network and the training set was chosen, the activation function is sigmoid or the logistic function.  Since there are two hidden layers, it can already be said deep learning. </p><br><p>  Search for anomalies using a trained network on the same server, but for a longer period of time - in two days, it is clear that it is necessary to get rid of seasonality (Fig. 6). </p><br><p><img src="https://habrastorage.org/webt/pk/g9/gl/pkg9gldlra-kojgkypdfl4c6nyu.png" alt="Figure 6. The result of the neural network - the schedule in the middle, the bottom - the input, the top - the interpretation of the non-normalized data"><br>  <em>Figure 6. The result of the neural network - the schedule in the middle, the bottom - the input, the top - the interpretation of the non-normalized data</em> </p><br><p>  It is interesting to check how a trained neural network on one parameter (free memory) will cope with another (load average) on a completely different server.  The result can be seen in the picture.  Due to the fact that the data are normalized, it can be seen that the ‚Äúanomalies‚Äù are on a different scale (Fig. 7). </p><br><p><img src="https://habrastorage.org/webt/05/uh/t3/05uht3oovwtbsojpfx9qog1d7u8.png" alt="Fig. 7. The result of the neural network on another data set"><br>  <em>Fig.</em>  <em>7. The result of the neural network on another data set</em> </p><br><h2 id="7-vyvody">  7. Conclusions </h2><br><p>  The neural networks manifested themselves in the most efficient way after suitable data preparation.  Actually, in <a href="http://www.oreilly.com/webops-perf/free/files/anomaly-detection-monitoring.pdf">[3]</a> it is mentioned that ‚Äúmachine learning is a meta-tool that can be used on top of other tools for working with data‚Äù.  I hope someone this experience will be useful.  Thanks for reading, I will be glad to comment. </p><br><hr><br><h4 id="literatura">  Literature </h4><br><p>  [1] <a href="http://cucis.ece.northwestern.edu/projects/DMS/publications/AnomalyDetection.pdf">http://cucis.ece.northwestern.edu/projects/DMS/publications/AnomalyDetection.pdf</a> - Varun Chandola, Arindam Banerjee, and Vipin Kumar.  2009. Anomaly detection: A survey.  ACM Comput.  Surv.  41, 3, Article 15 (July 2009), 58 pages. <br>  [2] <a href="http://www.imvu.com/technology/anomalous-behavior.pdf">http://www.imvu.com/technology/anomalous-behavior.pdf</a> Evan Miller.  2007. Business Critical Metrics (DRAFT) <br>  [3] <a href="http://www.oreilly.com/webops-perf/free/files/anomaly-detection-monitoring.pdf">http://www.oreilly.com/webops-perf/free/files/anomaly-detection-monitoring.pdf</a> <br>  Preetam Jinka &amp; Baron Schwartz.  2015. Anomaly detection for monitoring: A statistical approach to time series anomaly detection.  O'Reilly. <br>  [4] <a href="https://xn--www-hed.microsoft.com/en-us/research/publication/context-aware-time-series-anomaly-detection-for-complex-systems/">https: //wwLw.microsoft.com/en-us/research/publication/context-aware-time-series-anomaly-detection-for-complex-systems/</a> Gupta M., Sharma AB, Chen H., Jiang G. 2013 Context-Aware Time Series Anomaly Detection for Complex Systems.  Proceedings of the SDM Workshop. <br>  [5] <a href="https://www.elen.ucl.ac.be/Proceedings/esann/esannpdf/es2015-56.pdf">https://www.elen.ucl.ac.be/Proceedings/esann/esannpdf/es2015-56.pdf</a> Pankaj Malhotra, Lovekesh Vig, Gautam Shroff, Puneet Agarwal.  Long Short Term Memory Networks for Anomaly Detection in Time Series.  ESANN 2015 Proceedings. </p><br><hr><br><h4 id="ssylki">  Links </h4><br><p>  <a href="https://clickhouse.yandex/">https://clickhouse.yandex/</a> - a database convenient for storing and working with large volumes of similar data <br>  <a href="https://github.com/Infinidat/infi.clickhouse_orm">https://github.com/Infinidat/infi.clickhouse_orm</a> - python library to work with clickhouse <br>  <a href="http://tensorflow.org/">http://tensorflow.org/</a> - Google's open source library for working with neural networks <br>  <a href="http://tflearn.org/">http://tflearn.org</a> is a convenient framework for working with tensorflow <br>  <a href="http://anomaly.io/">http://anomaly.io</a> , <a href="http://grokstream.com/">http://grokstream.com</a> - products that deal with the detection of anomalies </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/341598/">https://habr.com/ru/post/341598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341578/index.html">Announcement of Moscow Python Meetup # 50</a></li>
<li><a href="../341580/index.html">Writing a to-do list in Python 3 for Android via QPython3 and SL4A</a></li>
<li><a href="../341584/index.html">Bestiary C ++. Mysterious Characters Handbook</a></li>
<li><a href="../341586/index.html">About the stack in simple words - for students and beginners.</a></li>
<li><a href="../341590/index.html">How can I hack your own Web project?</a></li>
<li><a href="../341600/index.html">Open broadcast of the main hall HighLoad ++</a></li>
<li><a href="../341602/index.html">Modern Android development on Kotlin. Part 1</a></li>
<li><a href="../341606/index.html">Console assistants to work with Kubernetes via kubectl</a></li>
<li><a href="../341608/index.html">Long road in the dunes, or how the ESF engineering subculture changed</a></li>
<li><a href="../341612/index.html">Kaspersky Industrial CTF 2017: seven hours to cut down a plant</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>