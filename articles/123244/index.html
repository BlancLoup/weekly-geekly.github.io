<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Trojan using the computing power of a PC to generate bitcoin</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It happened to me yesterday to bring one trojan from a business trip, Trojan.Win32.Powp.rdf (according to the classification of LC). There I defeated ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Trojan using the computing power of a PC to generate bitcoin</h1><div class="post__text post__text-html js-mediator-article"> It happened to me yesterday to bring one trojan from a business trip, <b>Trojan.Win32.Powp.rdf</b> (according to the classification of LC).  There I defeated him, but he managed to impress me with flash drives.  So that the good did not do anything, I decided to pick it up at leisure. <br>  As always, the name of the malware in LK turned out not to be all right, it belongs more to the Trojan-Downloader class, since  The main task is to <i>download</i> files from <i>fileave.com</i> .  I put on a virtual player to play, among a heap of mediocre junk downloaded by them onto the machine, I noticed one sfx-archive and as it turned out not in vain ... <br><a name="habracut"></a><br>  The link <i>http_: //pasic.fileave.com/BTxDEF.exe</i> downloads a self-extracting archive. <br><br><img src="https://habrastorage.org/storage1/4171bc68/44f329c8/16efe9bc/d63296aa.png"><br><br>  We look, what is inside ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage1/763cb93d/e63cae9d/6e888258/398ee905.png"><br><br>  And inside we have the <a href="http://www.ntwind.com/software/utilities/hstart.html">Hidden Start 3.2</a> program (hstart.exe), which is launched by the archive script, with the <code>/NOCONSOLE test.bat</code> , which allows you to silently execute test.bat. <br><br><img src="https://habrastorage.org/storage1/8583820e/2127e191/142828cb/2124758c.png"><br><br>  We look that we have in a batch file ... <br><br><img src="https://habrastorage.org/storage1/4e8f0195/75ecfedb/a263d79f/72be3aff.png"><br><br>  So far, nothing is clear, although <b><i>btc.mobinil.biz</i></b> already suggests some thoughts.  The last file remains - taskmgr.exe, which, apparently, strenuously mows under the Windows Task Manager. <br><br><img src="https://habrastorage.org/storage1/ccf1a270/44387766/345a452a/e4164589.png"><br><br>  Opanki!  The file is <b>BitCoin Miner</b> 'ohm, designed to generate Bitcoins.  The batch file starts it with parameters: <br>  <code>bitcoin-miner [-a seconds] [-g|l yes|no] [-t threads] [-v] [-o url] [-x proxy] -u user -p password</code> , <br>  Where <br> <code><a href="http://server.tld/"></a> <a href="http://127.0.0.1/"></a> -a #seconds# time between getwork requests 1..60, default 15 <br> -g yes|no set 'no' to disable GPU, default 'yes' <br> -h this help -l yes|no set 'no' to disable Long-Polling, default 'yes' <br> -t #threads# Number of threads for CPU mining, by default is number of CPUs (Cores), 0 - disable CPU mining <br> -v Verbose output <br> -o url in form server.tld:port/path, by default 127.0.0.1:8332 <br> -x type=host:port Use HTTP or SOCKS proxy. <br> Thread number should be 0..32</code> <br> <br>  So, the timeout is 5 seconds, url - <a href="http://btc.mobinil.biz/">btc.mobinil.biz</a> : 8332 /, user - redem_guild, pass - redem, 2 threads. <br>  With the Internet, BitCoin Miner begins to work hard for the benefit of the unknown ... <br><br><img src="https://habrastorage.org/storage1/1e6b56af/5407b087/2deb9c3b/5c48175c.png"><br><br>  And so, now the computing power of computers began to bring in income to cybercriminals.  The user pays not only for botnet traffic, for example, but also for electricity, and his uncle is dripping money at the other end of the world :) <br><br><h4>  PS </h4><br>  The most interesting thing is that both programs from the archive are legitimate, and a trojan can only be considered a batch file that runs the whole farm ... KIS 2011 will detect the entire archive, using KSN, without a name. <br><br><h4>  Upd </h4><br>  Now it is disguised as svchost.exe.  <a href="http://www.virustotal.com/file-scan/report.html%3Fid%3Df17b0fa7d99bf4cf6f47f82ad3b2c6f7fbb5e4b0db49c5fcf06b54fa9c3c97b6-1309745126">Some</a> antiviruses began to detect a batch file inside the archive as malicious. </div><p>Source: <a href="https://habr.com/ru/post/123244/">https://habr.com/ru/post/123244/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123233/index.html">I used SSD ...</a></li>
<li><a href="../123236/index.html">Mini-review of Arduino-compatible boards of various architectures</a></li>
<li><a href="../123238/index.html">I looked into the Prisma application, and you will not believe what I found there</a></li>
<li><a href="../123241/index.html">cssHooks - extend many CSS properties</a></li>
<li><a href="../123243/index.html">Google will not receive Nortel patents. Not even pi</a></li>
<li><a href="../123246/index.html">Why do lithium-ion batteries die so early?</a></li>
<li><a href="../123247/index.html">Facebook will introduce Skype based video chat next week.</a></li>
<li><a href="../123249/index.html">Google is negotiating the purchase of the service Hulu</a></li>
<li><a href="../123252/index.html">On the Paths - Interim Report</a></li>
<li><a href="../123253/index.html">We collect statistics on the deaths of HDD and SSD drives</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>