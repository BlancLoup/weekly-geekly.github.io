<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fix Alt-Tab in LabView</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When you write a program in LabView, at some point it becomes too much to fit in one screen. LabView's ‚Äúgood tone rules‚Äù suggest that in such cases it...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fix Alt-Tab in LabView</h1><div class="post__text post__text-html js-mediator-article">  When you write a program in LabView, at some point it becomes too much to fit in one screen.  LabView's ‚Äúgood tone rules‚Äù suggest that in such cases it is necessary to split one vi file into several subvi files.  Over time, these subvi becomes very much.  However, the guys from NI somehow did not take care of the easy navigation. <br><br>  Not only does LabView move all its windows to the top of the Alt-Tab list (no one else does this: <a href="https://en.wikipedia.org/wiki/Alt-Tab">en.wikipedia.org/wiki/Alt-Tab</a> ), but also, despite the extensive use of the ability to override icons for vi files, Alt-Tab list instead of them - slim rows of LabView logos: <br><br><img src="https://habrastorage.org/files/eb1/677/117/eb1677117c194fd884572efe6eb664fc.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Some of this behavior pushes to buy a second monitor.  For them, the problem is largely solved.  Still partially helps the Windows Aero interface with its thumbnails in the Alt-Tab menu.  But the solution that seems to be lying on the surface is (a) making the switch is the same as in all other applications, and (b) displaying vi icons in the list is not possible with standard tools. <br><br>  Judging by the fact that it began almost from the very first version, and the corresponding ‚Äúimprovement idea‚Äù has been <a href="https://forums.ni.com/t5/LabVIEW-Idea-Exchange/Make-Alt-Tab-behaviour-consistent-with-other-applications/idi-p/1162219">gathering dust</a> on the ‚Äúforum for the exchange of ideas‚Äù since 2010, <a href="https://forums.ni.com/t5/LabVIEW-Idea-Exchange/Make-Alt-Tab-behaviour-consistent-with-other-applications/idi-p/1162219">forums.ni.com/t5/LabVIEW-Idea-Exchange/Make-Alt -Tab-behavior-consistent-with-other-applications / idi-p / 1162219</a> , asking National Instruments is useless.  However, you can still do something. <br><a name="habracut"></a><br><h4>  Part 1. Quit Labview with one click. </h4><br>  First, I wrote this python <a href="https://github.com/axil/labview-switcher">script</a> with which you can switch between, for example, the browser and the current LV window in one click, say, Alt-`: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ctypes EnumWindows = ctypes.windll.user32.EnumWindows EnumWindowsProc = ctypes.WINFUNCTYPE(ctypes.c_bool, ctypes.POINTER(ctypes.c_int), ctypes.POINTER(ctypes.c_int)) GetWindowText = ctypes.windll.user32.GetWindowTextW GetWindowTextLength = ctypes.windll.user32.GetWindowTextLengthW IsWindowVisible = ctypes.windll.user32.IsWindowVisible GetClassName = ctypes.windll.user32.GetClassNameW SwitchToThisWindow = ctypes.windll.user32.SwitchToThisWindow we_are_in_labview = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_title</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(hwnd)</span></span></span><span class="hljs-function">:</span></span> length = GetWindowTextLength(hwnd) buff = ctypes.create_unicode_buffer(length + <span class="hljs-number"><span class="hljs-number">1</span></span>) GetWindowText(hwnd, buff, length + <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> buff.value <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_cls</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(hwnd)</span></span></span><span class="hljs-function">:</span></span> buff = ctypes.create_unicode_buffer(<span class="hljs-number"><span class="hljs-number">100</span></span>) GetClassName(hwnd, buff, <span class="hljs-number"><span class="hljs-number">99</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> buff.value <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foreach_window</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(hwnd, lParam)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> we_are_in_labview title, cls = get_title(hwnd), get_cls(hwnd) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> IsWindowVisible(hwnd): title, cls = get_title(hwnd), get_cls(hwnd) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (title, cls) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ((<span class="hljs-string"><span class="hljs-string">'Start'</span></span>, <span class="hljs-string"><span class="hljs-string">'Button'</span></span>), (<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'Shell_TrayWnd'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> \ cls == <span class="hljs-string"><span class="hljs-string">'TeamViewer_TitleBarButtonClass'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> we_are_in_labview <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: we_are_in_labview = cls.startswith(<span class="hljs-string"><span class="hljs-string">'LV'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> we_are_in_labview <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> cls.startswith(<span class="hljs-string"><span class="hljs-string">'LV'</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> SwitchToThisWindow(hwnd, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> EnumWindows(EnumWindowsProc(foreach_window), <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  In general, I wrote in parallel on c and on python, here I give the version in python because this way the code is a bit more readable and can be run without visual studio (only installed python of any version: 2.x or 3.x is required). <br>  Hanging up the script on the shortcut key is also possible in python, but with the help of autohotkey, it is easier to do: <br><br><pre> <code class="hljs css"><span class="hljs-selector-id"><span class="hljs-selector-id">#IfWinNotActive</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ahk_class</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">PuTTY</span></span> !`:: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Run</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">C</span></span>:\<span class="hljs-selector-tag"><span class="hljs-selector-tag">alttab</span></span>\<span class="hljs-selector-tag"><span class="hljs-selector-tag">switch</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.py</span></span>,,<span class="hljs-selector-tag"><span class="hljs-selector-tag">Hide</span></span></code> </pre><br>  (here the binding is disabled in a single putty program) <br><br><h4>  Part 2. Switch to vi by clicking on its icon </h4><br>  Secondly, I modified the appropriate quickqrop <a href="https://decibel.ni.com/content/docs/DOC-31302">Show Open VIs plugin</a> to give it a divine look and added keyboard navigation. <br><br><img src="https://habrastorage.org/files/e37/728/44c/e3772844c2634907bb6d0ad4b88270c1.png" alt="image" align="left"><br><img src="https://habrastorage.org/files/fd1/594/986/fd159498605a496fa42e15d294ffe68f.png" alt="image" align="right"><br><br><br clear="all">  Compared to the existing Show Open VIs navigation tools: <br>  - Better Project Explorer that shows only open files, but not all files in the project, plus does not take up too much space on the taskbar and in the Alt-Tab list (Fig. Left); <br>  - Better than the built-in LV window manager (Ctrl-Alt-W) by the presence of icons (Fig. Right); <br>  - Better than the system Alt-Tab in that these are exactly vi icons and not a multiple NI logo. <br><br>  By pressing the right mouse button, you can choose whether to switch to the Front Panel or Block Diagram. <br><br>  In the original, this plugin looked very raw and sloppy.  Everything fit each other, and when you reduce the window size to a size comparable to the usual alt-tab window, it stopped working altogether. <br><br>  I put the plugin code on a <a href="https://github.com/axil/show-open-vis">githaba</a> .  Checked in LV 2011 and 2014, x32 and x64.  To install, you need to copy several files to the "correct" subdirectory of My Documents, restarting Labview is not required.  Depends on the OpenG File Library.  Details in the readme. <br><br>  Control from the keyboard did this: Ctrl-Space Ctrl-4 to launch (so that there were no conflicts with other plugins), [Ctrl-] Tab or the right arrow the next item, [Ctrl-] Shift-Tab or the left arrow - the previous one Enter or Space - switch, Esc - exit. <br><br>  In order not to press this extra Ctrl-Space (enter the quickdrop menu), you can use this script on autohotkey to start it, for example, by pressing Ctrl-`: <br><br><pre> <code class="hljs rust">#IfWinActive ahk_class LVDChild ^`b:: <span class="hljs-built_in"><span class="hljs-built_in">Send</span></span> ^{Space} WinWait Quick <span class="hljs-built_in"><span class="hljs-built_in">Drop</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Send</span></span> ^<span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre><br>  The time gap between the appearance of the quickdrop window and its closing after receiving the shortcut key was about 0.12 seconds.  In principle, this is not bad, but the eye manages to see the ‚Äúextra‚Äù window.  Those who, like me, quickdrop except for launching plug-ins do not use, may find this undocumented option in labview.ini useful: <br><br><pre> <code class="hljs">QuickDropTransparency=100</code> </pre><br>  It makes the QuickDrop window invisible (the parameter means 100%) with all the functionality preserved. <br><br>  I didn‚Äôt think up how to combine these two improvements (displaying vi icons and the usual alt-tab behavior) - all LabView windows are in the same window group and programmatically move within the z-order sequence in the same way as through the GUI: only as one unit, that is, information about what kind of switching it was from ‚Äî inside LabView or outside LabView ‚Äî is lost.  You can memorize the story when you press the alt-tab, but this method is not universal, because it does not catch switching using the mouse. <br><br><h4>  Eventually </h4><br>  By installing the described script and plugin, we get the following features: by pressing Alt-`it is very convenient to switch between, for example, the browser and some specific window in LabView, and by pressing Ctrl-` you can see the icons of open vi files and switch between them or mouse either from the keyboard. </div><p>Source: <a href="https://habr.com/ru/post/260723/">https://habr.com/ru/post/260723/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260713/index.html">Where to go to study as a programmer</a></li>
<li><a href="../260715/index.html">How to use Canvas to compile a clickable world map on Unity3d</a></li>
<li><a href="../260717/index.html">Quick Start Template for Arduino Due at QtCreator</a></li>
<li><a href="../260719/index.html">AJAX and performance</a></li>
<li><a href="../260721/index.html">Transceiver Signal Level via SNMP in Cisco</a></li>
<li><a href="../260727/index.html">Replacing HDD on NetUP tape drive and installing firmware</a></li>
<li><a href="../260733/index.html">The future of electronic signature</a></li>
<li><a href="../260735/index.html">Go as a language for learning programming</a></li>
<li><a href="../260737/index.html">Thunderstorm, lightning, and means of protection of the power grid on its own</a></li>
<li><a href="../260739/index.html">Sencha: About licenses and restrictions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>