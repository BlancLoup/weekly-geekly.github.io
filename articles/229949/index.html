<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implementation and testing of facial recognition algorithm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Content: 
 1. Search and analysis of the optimal color space for the construction of eye-catching objects on a given class of images 
 2. Determinatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implementation and testing of facial recognition algorithm</h1><div class="post__text post__text-html js-mediator-article"><h4>  Content: </h4><br>  1. <a href="http://habrahabr.ru/post/229757/">Search and analysis of the optimal color space for the construction of eye-catching objects on a given class of images</a> <br>  2. <a href="http://habrahabr.ru/post/229817/">Determination of the dominant signs of classification and the development of a mathematical model of facial expressions "</a> <br>  3. <a href="http://habrahabr.ru/post/229895/">Synthesis of optimal facial recognition algorithm</a> <br>  4. <a href="http://habrahabr.ru/post/229949/">Implementation and testing of facial recognition algorithm</a> <br>  5. <a href="http://habrahabr.ru/post/230053/">Creating a test database of images of users' lips in various states to increase the accuracy of the system</a> <br>  6. <a href="http://habrahabr.ru/post/230133">Search for the best open source audio speech recognition system</a> <br>  7. <a href="http://habrahabr.ru/post/231629/">Search for the optimal audio system of speech recognition with closed source code, but having open API, for the possibility of integration</a> <br>  8. <a href="http://habrahabr.ru/post/231821/">Experiment for integrating video extensions into audio speech recognition system with test report</a> <br><br><h4>  Goals: </h4><br><br>  Determine the most optimal algorithm for the recognition tasks of a human face, consider ways to implement it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Tasks: </h4><br><br>  To analyze the existing algorithms of recognition of facial expressions, taking into account the dominant signs of classification and a mathematical model that we have identified.  On the basis of the data obtained, select the optimal variant of the algorithm for its subsequent implementation and testing. <br><br><h4>  Introduction </h4><br><br>  In previous scientific reports, a mathematical model of facial expression recognition was developed, and an facial recognition algorithm was synthesized.  There are two approaches to recognizing facial expressions - using a deformable model on the lip area and picking up vector features of the lip area and then analyzing them using Gaussian mixture based algorithms.  To implement facial recognition it is necessary to choose the optimal algorithm. <br><br><h4>  1. Algorithms of recognition of a human face: <br><br>  1.1 Algorithms based on a deformable model. <br></h4><br><br>  A deformable model (model) is a pattern of some form (for a two-dimensional case, an open or closed curve, for a three-dimensional one, a surface).  Imposed on the image, the pattern is deformed under the influence of various forces, internal (defined for each specific template) and external (defined by the image on which the template is applied) - the model changes its shape, adjusting to the input data [1].  The original coarse lip model is deformed under the action of the force fields specified by the input image (Fig. 1). <br><img src="https://habrastorage.org/getpro/habr/post_images/3da/9c6/d2b/3da9c6d2b6de38c80b42904def77fa9c.png" alt="image"><br>  The main advantage over traditional search methods, such as Hough transform (Hough transform [2]), in which the search pattern is rigidly defined, is that deformable models can change their shape during operation, allowing for more flexible search for an object [3 ]. <br><br>  The main disadvantage of the deformable models [4] is the need to conduct a large number of iterations over a large number of frames, which significantly loads the system, but when making basic calculations to the cloud, you can unload the system. <br><br>  Deformable models can be classified according to the type of restrictions imposed on their shape into two types: deformable free-form models and parametric deformable models. <br><a name="habracut"></a><br><h4>  1.1.1 Deformable free-form models </h4><br><br>  Deformable free-form models are such deformable models on which only the general requirements of smoothness and continuity of the contour are imposed.  An example of such a model is the "snake" [5].  The classic ‚Äúsnake‚Äù is a deformable model defined by a spline.  The change of the deformable model is set by moving the control points of the spline along the lips image, energy is given by the weighted sum of two components: internal energy (given by the continuity and smoothness of the contour) and external energy (given by the details on the image to which the "snake" attracts).  It is also possible the third term - the additional energy that sets additional user restrictions.  Snakes are widely used in medical image processing [6], motion tracking, segmentation tasks [7]. <br><br>  Formally, a ‚Äúsnake‚Äù is a parametric given contour c (s) = (x (s), y (s)).  The energy of the "snake" is expressed by the sum <img src="https://habrastorage.org/getpro/habr/post_images/58d/580/652/58d5806520d777418ac58def5536015c.png" alt="image">  , <br><img src="https://habrastorage.org/getpro/habr/post_images/bb6/619/119/bb6619119f70286ce1d104a72896dd1f.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/296/92b/697/29692b6974854b0c3ea1ec44d5f76ffe.png" alt="image">  Here P is the potential associated with the image and rigidly connected with the lips.  For a ‚Äúsnake‚Äù that is configured to search for boundaries, it is possible <img src="https://habrastorage.org/getpro/habr/post_images/ec8/639/8d2/ec86398d2b8669a435d64db4e49b201c.png" alt="image">  where I is the brightness of the image. <br><br>  Minimizing energy, we obtain the desired parameters.  Minimization can be carried out, for example, by the branch and bound method.  For this purpose, the coordinates of each of the control points change iteratively;  the change that led to the lowest energy value is used in the next iteration step.  The minimization procedure finishes work, when at the next step no change can reduce the energy of the "snake" (Fig. 2). <br><img src="https://habrastorage.org/getpro/habr/post_images/83b/00c/78c/83b00c78c418a5159ea4c52eb32dae85.png" alt="image"><br>  The main drawback of the ‚Äúsnake‚Äù is that if there are no clearly defined details near the initialization position, the influence of internal energy, which determines the degree of smoothness of the object being sought, tends to over-pull the model, degenerating it into a straight line, since the zero derivative and the second) direct minimizes the energy of the "snake".  To avoid this effect, use a special kind of deformable models, the so-called balloon (balloon) [8]. <br><br>  The main advantages of the "snake" include the relative ease of implementation (in the case of not including the procedures of numerical optimization) and resistance to the variability of the input data. <br><br>  As a result, we can conclude that the use of the "snake" for the recognition of facial expressions will be associated with the need to use numerical optimization methods, which will complicate the already cumbersome algorithm. <br><br><h4>  1.1.2 Parametric deformable models </h4><br><br>  Parametric deformable models are models that have more stringent restrictions on the shape.  The model is initialized with a template of a strictly defined form, and with further deformations, the internal energy of the model controls its compliance with the form constraints [9].  Such models are widely used in face recognition [10], gestures and the human figure in the images. <br><br>  The energy equation E of a snake, expressed by the formula v (s), looks just like an ordinary ‚Äúsnake‚Äù: <br><img src="https://habrastorage.org/getpro/habr/post_images/eba/17b/de2/eba17bde25416e056cc9478dd9fc7fad.png" alt="image"><br>  The first two terms describe the regularity energy of a snake.  In our polar coordinate system, v (s) = [r (s), Œ∏ (s)], s from 0 to 1. The third term is the energy related to the external force obtained from the image, the fourth with the pressure force. <br><br>  External force is determined based on the above characteristics.  It is able to shift control points to a certain intensity value.  It is calculated as: <br><img src="https://habrastorage.org/getpro/habr/post_images/161/85f/33e/16185f33ea4df9d90760d30f612b9f7b.png" alt="image"><br>  Analytically defined parametric deformable models are described by a set of primitives, which are interconnected in some way [10].  Primitives and the links between them are involved in the calculation of internal energy, so that the shape of the deformable model cannot significantly deviate from the initializing shape (Fig. 3). <br><img src="https://habrastorage.org/getpro/habr/post_images/e37/651/80e/e3765180e415e9336a3aa3a4321491bc.png" alt="image"><br>  Another variant of parametric deformable models is based on a prototype model (prototype based deformable models [9]).  The initialization position and shape of the model based on the prototype is established by machine learning methods or high-level image processing. <br><br>  The advantages of the parametric model over the "snake" are that, in general, there is no need to apply constraining parameters, since the shape of the model varies within the specified limits.  Also, the need to use numerical optimization is often dropped.  based on experimental data [9], it works quite well. <br><br>  The main disadvantage of the parametric model is the need to compile training samples, and rebuilding the samples in case of a change in the model parameters. <br><br>  As a result of comparing the "snake" and the parametrically specified model, it was concluded that the parametric model is the best choice, since changing the training samples is more comfortable than changing and setting the parameters for optimizing the results of the "snake". <br><br><h4>  1.2 Algorithms based on Gaussian mixtures. </h4><br><br>  Gaussian mixtures are the totality of the distributions of the normal value [12].  The standard normal distribution is called the normal distribution with a mean of 0 and a standard deviation of 1. The sum of these quantities gives us a Gaussian mixture (Fig. 4). <br><img src="https://habrastorage.org/getpro/habr/post_images/6e1/ee7/43d/6e1ee743d12aa8d1efc471d238136a59.png" alt="image"><br>  The model of Gaussian mixtures is a weighted sum of M, a component and can be written by the expression <br><img src="https://habrastorage.org/getpro/habr/post_images/10d/1f1/225/10d1f1225c9477cfe6f86294a20eb1fc.png" alt="image">  (one) <br>  where x is a D -dimensional vector of random variables;  bi (x), i = 1, ..., M, are the density functions of the distribution of the components of the model and pi, i = 1, ..., M, are the weights of the components of the model.  Each component is a D-dimensional Gaussian distribution function of the form. <br><img src="https://habrastorage.org/getpro/habr/post_images/bba/a95/2f4/bbaa952f41f8ea674e79f6d3928f081d.png" alt="image">  (2) <br>  The complete model of a Gaussian mixture is determined by the expectation vectors, the covariance matrices and the weights of the mixtures for each component of the model.  These parameters are collectively written as <img src="https://habrastorage.org/getpro/habr/post_images/89a/8dc/b50/89a8dcb5010a95cfe90620bedce2b2c9.png" alt="image"><br><br>  In the problem of recognition of facial expressions, each image of the lips is represented by a model of Gaussian mixtures and is assigned to its own model, Œª.  The model of a Gaussian mixture can have several different forms, depending on the type of covariance matrix. <br><br>  The main advantage of using Gaussian mixtures is the intuitive assumption that the individual components of the model can simulate some set of acoustic features / events [12]. <br><br>  The second advantage of using Gaussian blend models to identify facial expressions is the empirical observation that a linear combination of Gaussian distributions can represent a large number of lip image classes.  One of the strengths of the mixture of Gaussian models is that these models can very accurately approximate arbitrary distributions. <br><br>  The disadvantage of using the model of Gaussian mixtures lies in the difficulty of extracting the feature vector from each frame, as well as in the analysis of the obtained data itself, since it is difficult to divide them into classes. <br><br>  Due to the complexity of the implementation and the large number of calculations, it is time-consuming to use Gaussian mixtures in the problem of recognizing facial expressions, and because of the ambiguity of the data obtained, it is difficult to get rid of the errors that occur. <br><br><h4>  Approbation and conclusion: </h4><br><br>  In this report, we considered mimicry recognition algorithms based on the properties of the deformable model (deformable free-form model and parametric model) and statistical characteristics (algorithms based on Gaussian mixtures).  Deformable models are based on changes in the properties of the original template, and Gaussian mixtures assume the use of the statistical characteristics of the region of interest. <br><br>  The use of Gaussian mixtures involves the processing of large amounts of data [13], which is resource intensive, and the use of a parametric deformable model requires preprocessing procedures that take at least 4 minutes of processor time [5].  That is why the choice fell on the use of the usual "snake", because  it is the most optimal in speed [3]. <br><img src="https://habrastorage.org/getpro/habr/post_images/ee5/514/293/ee5514293f6d2ee028eaee7c5cf8218c.png" alt="image"><br>  Fig.  5 Work of a deformable model from a previously binarized image of a person‚Äôs lips. <br><br>  According to the conducted research, with preliminary binarization of the lip area, it is possible to increase the quality of the active contour algorithm several times (Fig. 5).  At the same time, it is possible to get rid of the procedures for pre-setting the system and analyzing the reference images, as it would be if a parametric active model is used. <br><br>  Sure finding the contour of the lips will allow to continue to the implementation of the problem of direct analysis of micropauses, which will improve the currently existing systems of audio speech recognizers. <br><br><h4>  Bibliography </h4><br>  1) Demetri Terzopoulos, John Platt, Alan Barr, Kurt Fleischer.  Elastically Deformable Models.  Computer Graphics (Proceedings of ACM SIGGRAPH), Vol.  21, No.  4, pp.  205-214, July 1987. <br>  2) Linda Shapiro, John Stockman.  Computer vision.  Moscow: Basic Knowledge Laboratory, 2006. <br>  3) Michael Kass, Andrew Witkin and Demetri Terzopoulos.  Snakes: Active contour models.  Int.  Journal of Computer Vision, Vol.  1, No.  4, pp.  321-331, January 1988. <br>  4) Shu-Fai Wong, Kwan-Yee Kenneth Wong.  Robust Image Segmentation Under Sensitive Snake Under Low Contrast Environment.  In Proc.  Int.  Conference on Informatics in Control, Automation and Robotics, pp.430-434, August 2004. <br>  5) Michael Kass, Andrew Witkin and Demetri Terzopoulos.  Snakes: Active contour models.  Int.  Journal of Computer Vision, Vol.  1, No.  4, pp.  321-331, January 1988. <br>  6) Tim McInerney, Demetri Terzopoulos.  Deformable Models in Medical Image Analysis: A Survey.  Medical Image Analysis, 1 (2): pp.  91-108, 1996. <br>  7) Doug P. Perrin, Christopher E. Smith.  Rethinking Classical Internal Forces for Active Contour Models.  Computer Vision and Pattern Recognition, Vol.  2, pp.615-620, 2001. <br>  8) Laurent D. Cohen.  On Active Contour Models and Balloons.  Computer Vision, Graphics and Image Processing: Image Understanding, Vol.  53, No.  2, pp.  211-218, March 1991. <br>  9) Anil K. Jain, Yu Zhong, Sridan Lakshmanan.  Object Matching Using Deformable Templates.  IEEE Trans.  on Pattern Anal.  And Machine Intel.  Vol.  18, No.  3, pp.  267-278, March 1996. <br>  10) Alan L. Yuille, Peter W. Hallinan, David S. Cohen.  Feature extraction from faces using deformable templates.  Int.  Journal of Computer Vision, Vol.  8, No.  2, pp.  99-111, August 1992. <br>  11) Markel JD, Oshika BT, Gray AH // IEEE Trans.  On Acoustics, Speech, and Signal Processing.  1977. Vol.  25. P. 330‚Äì337. <br>  12) ‚ÄúIncremental Learning of Temporally-Coherent.  Gaussian Mixture Models ¬ªOgnjen Arandjelovic“ë, Roberto Cipolla, Department of Engineering, Cambridge. <br><br>  <i>To be continued</i> </div><p>Source: <a href="https://habr.com/ru/post/229949/">https://habr.com/ru/post/229949/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../229939/index.html">How to make friends with a hedgehog and a man: the experience of using PowerShell in web applications</a></li>
<li><a href="../229941/index.html">Facebook XHP. Object Templates</a></li>
<li><a href="../229943/index.html">The notorious programmer: Informal stories and frank conversations about the IT-industry</a></li>
<li><a href="../229945/index.html">WebCamp Special Rapporteur: Mobile Day - Andrian Budantsov, co-founder of Readdle</a></li>
<li><a href="../229947/index.html">Development of a payment system for the site using CyberSource Secure Acceptance</a></li>
<li><a href="../229953/index.html">Webinar "Using public clouds in retail"</a></li>
<li><a href="../229955/index.html">Spring and @Autowired for ENUM types. Optional</a></li>
<li><a href="../229957/index.html">How to discuss money with management or why sometimes careers stop?</a></li>
<li><a href="../229959/index.html">Lorentz's dynamic system and computational experiment</a></li>
<li><a href="../229961/index.html">Practical tips and tricks when working with DJI drones and their autopilot systems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>