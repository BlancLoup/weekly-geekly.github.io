<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Export events from email to Google Calendar in one click - pitfalls</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As one of the capabilities of the client pre-registration service, zabroniruy.com implemented the idea that the client received all the information ab...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Export events from email to Google Calendar in one click - pitfalls</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/451/a21/515/451a2151554d122aa3d38bf6dfb46fc6.png" alt="image"><br><br>  As one of the capabilities of the client pre-registration service, <a href="http://zabroniruy.com/">zabroniruy.com</a> implemented the idea that the client received all the information about upcoming events in a format that can be easily exported (preferably with a single click) to existing task schedulers.  In the course of the work, we faced the fact that not all planners are equally ‚Äúfriendly‚Äù to the developers. <br><a name="habracut"></a><br>  The iCalendar format was taken as a basis - this format is simple and is supported by many <a href="http://en.wikipedia.org/wiki/List_of_applications_with_iCalendar_support">applications</a> . <br><br>  There were no problems with the format itself.  Just added an attachment to the email and the Outlook or Evolution user (tested in these applications) can export the data to your calendar in one click.  But we wanted Gmail users to be able to just as easily add events to their Google calendar, instead of downloading the file and then exporting it to the calendar (very few people will do this). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And here the most interesting began.  Google displays a calendar icon for the letter with an ics file attached, but the attachment can only be downloaded.  But in Gmail there is an option ‚ÄúInsert Invitation‚Äù and in this case, the recipient will receive an email with an attachment that can be imported into your Google calendar in one click.  This is what we wanted to achieve.  Google‚Äôs search didn‚Äôt give anything, we had to search on our own for the reason that our attachment isn‚Äôt processed in the same way as the invitation letter created directly from Gmail. <br><br>  The code for attaching a file to a letter at this moment looked like this: <br><pre><code class="php hljs">$mailer-&gt;createAttachment( $data, Zend_Mime::TYPE_OCTETSTREAM, Zend_Mime::DISPOSITION_ATTACHMENT, Zend_Mime::ENCODING_BASE64, <span class="hljs-string"><span class="hljs-string">'icalendar-file.ics'</span></span> );</code> </pre> <br><br>  Before we received the first workable version, we tried different approaches, but the solution, as often happens, turned out to be very simple.  After examining the invitation letter from Gmail, we noticed that the Content-Disposition title was missing, i.e.  attachment added to the letter as inline.  We set the Content-disposition: inline header in the letter generated by our service, change the Content-type of the attachment to indicate the file type, add method = REQUEST so that Outlook accepts the letter as an invitation and ‚Äúa miracle happened‚Äù: the link ‚ÄúAdd to the calendar ‚Äù, and Outlook began to display the letter as an invitation to an event. <br><br>  ZendFramework Solution: <br><pre> <code class="php hljs">$mailer-&gt;createAttachment( $data, <span class="hljs-string"><span class="hljs-string">'text/calendar; charset=UTF-8; method=REQUEST'</span></span>, Zend_Mime::DISPOSITION_INLINE, Zend_Mime::ENCODING_BASE64, <span class="hljs-string"><span class="hljs-string">'icalendar-file.ics'</span></span> ); $mailer-&gt;setType(Zend_Mime::MULTIPART_ALTERNATIVE);</code> </pre><br>  multipart / alternative - indicates that different content / type types are used in parts of the message. <br><br>  This is what Evolution looks like: <br><img src="https://habrastorage.org/getpro/habr/post_images/035/d46/bef/035d46befc29893de67c75728dc3169a.png" alt="image"><br><br>  And so in Outlook: <br><img src="https://habrastorage.org/getpro/habr/post_images/fe8/2a3/183/fe82a318399bae5389cb9e144d4113d9.png" alt="image"><br><br>  The author of the solution, our programmer Dmitry, unfortunately, does not have an account in Habr√©, so I will answer the questions. </div><p>Source: <a href="https://habr.com/ru/post/115276/">https://habr.com/ru/post/115276/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../115269/index.html">Collection habrovchan - who goes to JavaOne and / or App Developer Days (2011)?</a></li>
<li><a href="../115270/index.html">Ukraine has sold Ukrtelecom OJSC</a></li>
<li><a href="../115271/index.html">What do they do in US prisons?</a></li>
<li><a href="../115274/index.html">I love UX design</a></li>
<li><a href="../115275/index.html">In Russia, they can toughen punishment for carders</a></li>
<li><a href="../115277/index.html">Canobuvosti, 82nd edition</a></li>
<li><a href="../115278/index.html">Aquafairy introduced a commercial fuel cell charger</a></li>
<li><a href="../115284/index.html">We invite March 19 to the Moscow final of the Imagine Cup</a></li>
<li><a href="../115285/index.html">Google started searching for missing people.</a></li>
<li><a href="../115287/index.html">Kutter-Jordan-Bossen steganographic method</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>