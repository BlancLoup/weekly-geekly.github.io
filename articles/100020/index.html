<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Architecture large projects: FaceBook</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Architecture large projects: Facebook 

 At the level at which Facebook works, traditional approaches to organizing the work of websites do not work a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Architecture large projects: FaceBook</h1><div class="post__text post__text-html js-mediator-article"><h4>  Architecture large projects: Facebook </h4><br><br>  At the level at which Facebook works, traditional approaches to organizing the work of websites do not work at all or, at a minimum, do not provide adequate performance.  The huge attendance of the project challenged Facebook engineers with the need to maintain the site‚Äôs performance with nearly half a billion active users.  This article describes the software and hardware that made this possible. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Tasks </h5><br><ul><li>  Facebook has about 570 billion page views per month (according to Google Ad Planner) </li><li>  There are more photos uploaded to Facebook than all other image sharing services combined (including sites like Flickr) </li><li>  More than three billion photos are uploaded to Facebook servers every month. </li><li>  Facebook servers give about 1.2 million photos per second to view (excluding photos from the Facebook content delivery network) </li><li>  Each month, users exchange more than 25 billion pieces of information (status updates, comments, etc.) </li><li>  For the month of May 2010, the Facebook project had over 30,000 servers online. </li></ul><br><br><h5>  Facebook software </h5><br>  In some ways, Facebook is still running on the LAMP stack, but the size of the project required the commissioning of many other elements and services.  As well as changes to existing work.  For example: <br><br><ul><li>  Facebook still uses PHP, but before execution, the scripts are compiled into native processor code, thus speeding up work </li><li>  Facebook servers run on Linux, but the Linux code has been optimized (mostly in its network part) </li><li>  Facebook uses MySQL, but mostly as a key-value store.  All data connections and business logic are moved to the script level, since it is much easier to perform optimization (on the other side of the Memcached level) </li></ul><br><br>  The project has a system written from scratch.  For example, Haystack is a highly scalable storage facility that is used to store photos.  Scribe is an example of another system that provides protocols on a Facebook scale. <br><br><h5>  So, first things first. </h5><br><h6>  Memcached </h6><br>  Memcached is one of the most widely known projects on the Internet.  Its distributed information caching system is used as a caching layer between web servers and MySQL (since access to databases is relatively slow).  Years passed and Facebook made a huge number of modifications of Memcached code and related software (for example, optimization of the network subsystem). <br>  Facebook has thousands of Memcached servers with dozens of terabytes of cached data at any given time.  This is probably the world's largest array of Memcached servers. <br><br><h6>  HipHop for PHP </h6><br>  PHP, because it is a scripting language, is rather slow when compared with the native processor code running on the server.  HipHop converts PHP scripts to C ++ source codes, which are then compiled for good performance.  This allows Facebook to get more value from fewer servers, since PHP is used almost everywhere on Facebook. <br>  A small group of engineers (at the beginning there were only three) developed HipHop for 18 months and now it works on project servers. <br><br><h6>  Haystack </h6><br>  Haystack is a high-performance photo storage / retrieval system (strictly speaking, Haystack is an object storage, so it can store any data, not just photos).  The share of this system falls a huge amount of work.  More than 20 billion photos are uploaded to Facebook and each is saved in four different resolutions, which ultimately gives us more than 80 billion photos. <br>  Haystack should not only be able to store photos, but also give them away very quickly.  As we mentioned earlier, Facebook gives out more than 1.2 million photos per second.  This number does not include photos that are delivered by the Facebook content delivery system and is constantly growing. <br><br><h6>  Big pipe </h6><br>  BigPipe is a dynamic web page delivery system developed by Facebook.  It is used to deliver each webpage in sections (called pagelets) to optimize performance. <br>  For example, the chat window, news feed and other parts of the page are requested separately.  They can be received in parallel, which increases productivity and allows users to use the website even if some part of it is disabled or faulty. <br><br><h6>  Cassandra </h6><br>  Cassandra is a distributed, fault-tolerant data warehouse.  This is one of the systems that is always mentioned when talking about NoSQL.  Cassandra became an open source project and even became a subsidiary of the Apache Foundation.  On Facebook, we use it to search the Inbox.  In principle, it is used by many projects.  For example, Digg.  It is planned to use it in the Pingdom project. <br><br><h6>  Scribe </h6><br>  Scribe is a convenient logging system that is used for several things at once.  It was designed to provide protocol-wide across Facebook and supports adding new event categories as they appear (there are hundreds on Facebook). <br><br><h6>  Hadoop and Hive </h6><br>  Hadoop is an open source implementation of the map-reduce algorithm that allows you to perform calculations on huge amounts of data.  In Facebook, we use it to analyze data (as you understand, Facebook has enough of them).  Hive was developed on Facebook and allows you to use SQL queries to get information from Hadoop, which facilitates the work of non-programmers. <br>  Both Hadoop and Hive are open source and are developed under the umbrella of the Apache Foundation.  They are used by a large number of other projects.  For example, Yahoo and Twitter. <br><br><h6>  Thrift </h6><br>  Facebook uses different programming languages ‚Äã‚Äãin various system components.  PHP is used as front-end, Erlang for chat, Java and C ++ are not left idle either.  Thrift is a cross-language framework that binds all parts of the system together, allowing them to communicate with each other.  Thrift is being developed as an open source project and has already added support for some other programming languages. <br><br><h6>  Varny </h6><br>  Varnish is an HTTP accelerator that can serve as a load balancer and content cache, which can then be delivered at high speed.  Facebook uses Varnish to deliver photos and images of profiles, withstanding loads of billions of requests per day.  Like everything that uses Facebook Varnish - open source software <br><br><h5>  Something else </h5><br>  We told you about some software complexes that allow Facebook to keep the load.  But managing such a large system is a difficult task.  Therefore, we will tell you about something else that allows the project to work stably. <br><br><h6>  Graded releases and implicit activation of new features </h6><br>  Facebook uses a system called GateKeeper, which allows you to serve different users with different versions of the source code of the system.  This allows you to release releases step by step, activate certain functions only for Facebook employees, and so on. <br>  GateKeeper also allows Facebook to implicitly activate new features to perform, for example, load testing and identify slow-moving system components.  Implicit activation includes some feature or feature, but does not show it in the user interface.  Usually, implicit activation is performed two weeks before a new opportunity is provided to users. <br><br><h6>  System performance test </h6><br>  Facebook carefully monitors system performance and, interestingly, monitors the performance performance of each PHP system function.  This is achieved using XHProf. <br><br><h6>  Partial Disable Functions </h6><br>  If the project starts to work slowly, we can disable some features (from a sufficiently large number) in order to improve the performance of key system components. <br><br><h5>  What we have not said </h5><br>  We did not mention the Facebook hardware in this article, but, of course, this is enough for scalable projects.  For example, Facebook uses a content delivery system to deliver its static elements.  Of course, there is still a large data center in Oregon to increase scalability by entering even more servers. <br>  In addition, we still have a lot of different software works.  But it seems to us that we managed to tell you about some interesting decisions that are involved in the project. <br>  Facebook loves open source projects <br>  This article would not be complete if we didn‚Äôt tell you how Facebook loves open source projects or would simply say that ‚Äúwe love open source projects‚Äù. <br>  Facebook is not only involved in the development of projects such as Linux, Memcached, MySQL, Hadoop and others, but also releases its internal development as open source software.  For example, HipHop, Cassandra, Thrift and Scribe.  Facebook also launched the Tornado project, a high-performance framework developed by the team that created FriendFeed (this project was purchased by Facebook in August 2009).  A list of projects in which Facebook is involved can be found on <a href="http://facebook.com/opensource">this page</a> . <br><br><h5>  More problems </h5><br>  Facebook is growing at a tremendous rate.  The user base is growing almost exponentially and is approaching half a billion active users and who knows what will happen at the end of the year.  The increase is almost 100 million users every six months. <br>  Facebook even has a special ‚Äúgrowth‚Äù team that is constantly trying to expand the project‚Äôs audience. <br>  The constant growth means that Facebook will face various problems in the field of productivity with an increase in the number of searches, views, uploaded images and so on.  But this is part of the daily work of the service.  Facebook engineers will look for new ways to increase the scalability of the project (and this is not just about adding more and more new servers).  For example, the Facebook photo storage system has been rewritten several times as the site grows. <br>  Let's see what Facebook engineers will have to face next time.  One can argue that with something very interesting.  In the end, they work with a value project, which can only be dreamed of, with a site that has more users than residents in most countries.  When you are dealing with a project, you better think creatively. <br><br>  Sources: <a href="http://www.infoq.com/presentations/Scale-at-Facebook">Facebook Engineer</a> <a href="http://www.infoq.com/presentations/Facebook-Moving-Fast-at-Scale">Presentations</a> and <a href="http://facebook.com/eblog">Facebook Engineers Blog</a> </div><p>Source: <a href="https://habr.com/ru/post/100020/">https://habr.com/ru/post/100020/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../100008/index.html">The Chipophone - 8-bit synthesizer</a></li>
<li><a href="../100009/index.html">Coasters of rare breed</a></li>
<li><a href="../100010/index.html">Magic numbers</a></li>
<li><a href="../100013/index.html">Code Quality Management</a></li>
<li><a href="../100016/index.html">Subjective comparison of PocketBook 301+ and B & N Nook</a></li>
<li><a href="../100024/index.html">foobar2000 v1.1 (beta)</a></li>
<li><a href="../100028/index.html">Sony is working on high-capacity optical media.</a></li>
<li><a href="../100033/index.html">Computer Science Student Project</a></li>
<li><a href="../100035/index.html">Serious Vulnerability Discovered in vBulletin</a></li>
<li><a href="../100038/index.html">Dreams about something bigger (open letter)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>