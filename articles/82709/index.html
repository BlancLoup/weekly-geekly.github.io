<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Generic Interfaces in Delphi</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A translation by Malcolm Groves, Generic Interfaces in Delphi. 

 Most generic use cases in Delphi use a generic type class. However, while working on...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Generic Interfaces in Delphi</h1><div class="post__text post__text-html js-mediator-article"> <i>A translation by Malcolm Groves, Generic Interfaces in Delphi.</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/822/0f6/287/8220f62870b037924218fc1134bb70a1.jpg" alt="image" align="left">  Most generic use cases in Delphi use a generic type class.  However, while working on my project, I decided that I needed an interface with a generic type. <br><br>  The project uses a built-in <a href="http://en.wikipedia.org/wiki/Publish/subscribe">publisher-subscriber</a> mechanism.  I wanted the subscriber to have a separate <i>Receive</i> method for each type of event, rather than a separate method with a huge <i>case</i> expression that chooses an action for each type of event.  Also, I did not want to define an interface for each type of event.  I needed a generic subscriber interface, which receives the event type as a parameter. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      However, I had no idea if I could define a generic interface, let alone implement it.  Even assuming that I can do this, can Delphi choose the right <i>Receive</i> method to call?  There is only one way to find out ... <br><a name="habracut"></a><br><br>  Please note: in this example, some parts of the code are removed, only those parts that are necessary to demonstrate the generic interfaces are left.  I will talk about other parts in my next posts. <br><br>  First, I described a few simple events.  Their content is not so interesting: <br><br> <code>TSomeEvent = class <br> // other stuff <br> end; <br> <br> TSomeOtherEvent = class <br> // other stuff <br> end;</code> <br> <br>  Then, I defined the generic interface <br><br> <code>ISubscriber&lt;T&gt; = interface <br> procedure Receive(Event : T); <br> end;</code> <br> <br>  This interface must be implemented by subscribers to receive different types of events.  Notice that the type of event is recorded as a generic type <i>T.</i> <br><br>  Subscribers must then implement an interface for each type of event they want to receive.  Since this is a generic interface - it is quite simple: <br><br> <code>TMySubscribingObject = class(TInterfacedObject, ISubscriber&lt;TSomeEvent&gt;, ISubscriber&lt;TSomeOtherEvent&gt;) <br> protected <br> procedure Receive(Event : TSomeEvent); overload; <br> procedure Receive(Event : TSomeOtherEvent); overload; <br> end;</code> <br> <br>  There is no description of the interfaces <i>ISomeEventSubscriber</i> and <i>ISomeOtherEventSubscriber</i> , we can simply use <i>ISubscriber &lt;T&gt;</i> and transfer the type in place.  To do this, you must implement the necessarily overloaded <i>Receive</i> method. <br><br>  The above code describes the basis of the idea.  You will find the rest of the code in the corresponding <a href="">test project</a> .  We implement several interfaces, each of which has strongly typed <i>Receive</i> events, without actually defining each of these interfaces. <br><br>  And does it work?  From the first attempt - no, it did not work out.  Regardless of what type of event and through which interface I transmitted, the last <i>Receive</i> method was always executed. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/457/44f/ced/45744fced57429ee4db3dc2ab64af3a4.jpg" alt="image" align="left"></a>  <i>dunit_generic_interfaces</i> Life Rule # 37: If it‚Äôs about choosing between the confusing Malcolm and the developers of the Delphi compiler, this is probably Malcolm‚Äôs mistake. <br><br>  Yes, my mistake.  <a href="http://barrkel.blogspot.com/">Barry Kelly</a> pointed out the mistakes of my approach.  I described a generic interface with a <i>GUID</i> .  Habit.  This means that <i>ISubscriber &lt;TSomeEvent&gt;</i> and <i>ISubscriber &lt;TSomeOtherEvent&gt;</i> , and any other interfaces defined by this generic will have the same <i>GUID</i> .  Together with using the " <i>as</i> " operator to get the reference from the <i>TMySubscribingObject</i> instance, this confused Delphi and always forced to return the same interface reference. <br><br>  Removed <i>GUID</i> and " <i>as</i> " - everything worked fine. <br><br>  In future posts I will show other parts: the publisher and the Broker of events.  An interesting side effect of the definition of events that the class introsses in is that the event broker can simply check the interfaces implemented by subscribers to find out which events they are subscribed to. <br><br><hr><br>  <b>You can help improve the translation.</b> <br>  <a href="http://translated.by/you/generic-interfaces-in-delphi/into-ru/trans/">translated.by/you/generic-interfaces-in-delphi/into-ru/trans</a> <br>  Translation: ¬© r3code. </div><p>Source: <a href="https://habr.com/ru/post/82709/">https://habr.com/ru/post/82709/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../82703/index.html">Downloading files from depositfiles.com from the console</a></li>
<li><a href="../82704/index.html">Intel is rapidly turning green</a></li>
<li><a href="../82705/index.html">Computer Science Student Project Updates</a></li>
<li><a href="../82706/index.html">Habraspolzovateli agreed and the whole composition did not go a week to work. Effects:</a></li>
<li><a href="../82707/index.html">Travel capsule</a></li>
<li><a href="../82711/index.html">Free paid software</a></li>
<li><a href="../82712/index.html">Specter is one of ten winners of student IGF 2010</a></li>
<li><a href="../82714/index.html">NTT DoCoMo is preparing a mobile phone with LTE</a></li>
<li><a href="../82715/index.html">DSL elements in PHP: making library APIs easier to use</a></li>
<li><a href="../82716/index.html">Does Facebook create a PHP compiler?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>