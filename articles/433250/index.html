<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>OpenVPN with Extended Authentication and Authorization</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article discusses the configuration of OpenVPN with additional features: 



- certificates on tokens for primary authentication (for example, Rut...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>OpenVPN with Extended Authentication and Authorization</h1><div class="post__text post__text-html js-mediator-article">  The article discusses the configuration of OpenVPN with additional features: <br><br><ul><li>  certificates on tokens for primary authentication (for example, Rutoken) </li><li>  LDAP backend for secondary authentication (using ActiveDirectory as an example) </li><li>  filtering internal resources available to the userx (via iptables) </li></ul><br>  The configuration of clients under Linux, Windows and MacOS is also described. <br><a name="habracut"></a><br><h3>  Server Tuning </h3><br><h4>  Install OpenVPN </h4><br>  Take the <a href="https://github.com/Nyr/openvpn-install">Nyr / openvpn-install</a> script, run as root. <br><br><pre><code class="plaintext hljs">git clone https://github.com/Nyr/openvpn-install.git cd openvpn-install</code> </pre> <br>  A few questions will be asked in the startup process. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  udp protocol </li><li>  port 1194 </li><li>  DNS servers - local </li><li>  external ip - the Internet gateway address through which the vpn-server will be available </li></ul><br>  There is also a security-enhanced version of the original script - <a href="https://github.com/Angristan/OpenVPN-install">github.com/Angristan/OpenVPN-install</a> .  It has more encryption settings with explanations why this is so. <br><br><h4>  user management </h4><br>  <b>Add</b> <br>  If tokens are not used, the user is added via the same script.  The script essentially generates a user ovpn-config and inserts a certificate signed by the root certificate. <br><br>  If tokens are used (see the section on tokens below) then the certificate is written out by hand based on a request for a certificate that is generated on the token.  The user config needs to be made by hands from the existing template (from the same one from which the config script generates).  The template here is <code>/etc/openvpn/client-common.txt</code> .  It is not included in the openvpn distribution and is generated by the script during the configuration process. <br><br>  <b>Deletion</b> <br>  Users are deleted through the same installation script.  The certificate is added to the <a href="https://en.wikipedia.org/wiki/Certificate_revocation_list">CRL</a> , the new CRL is being pushed to the vpn server.  All certificates that are in the CRL server are considered invalid and refuse to accept. <br><br>  How to revoke a certificate manually: <br><br><pre> <code class="plaintext hljs">cd /etc/openvpn/easyrsa #   ./easyrsa revoke $CLIENT #   crl ./easyrsa gen-crl #   crl rm -rf /etc/openvpn/crl.pem #    cp /etc/openvpn/easy-rsa/pki/crl.pem /etc/openvpn/crl.pem # openvpn    crl,       nobody chown nobody:nobody /etc/openvpn/crl.pem</code> </pre><br><h4>  Filtering available hosts for clients </h4><br>  Clients should be limited to those hosts that they can go inside the network when they connect to openvpn. <br><br>  <b>Manually</b> <br><br>  The idea is to catch packets even on the <code>tun0</code> interface, in which they come from clients and filter them before they get into NAT.  After NAT, filtering them will no longer be why - they all will have the ip-address of the openvpn server in the internal network.  Before getting into NAT, the packets for each user have their own unique ip-address (the correspondence of ip-addresses and users can be found in the <code>/etc/openvpn/ipp.txt</code> file). <br><br>  Packages that pass through the system (do not emanate directly from it and are not incoming, that is, they are essentially routed by the system) are processed by the FORWARD table.  Tables in iptables are processed from top to bottom, if none of the rules in the table lead to deciding the fate of the packet, then the default rule is triggered. <br><br>  FORWARD table preparation: <br><br><pre> <code class="plaintext hljs">#   iptables -F FORWARD #     FORWARD -    iptables -P FORWARD DROP #     iptables -I FORWARD -m state --state ESTABLISHED,RELATED -j ACCEPT</code> </pre><br>  An example of rules for a specific client.  Since the default rule for the table is DROP, it remains only to allow those host + port pairs to which you can.  Allow access to the port on the host + ping the host itself: <br><br><pre> <code class="plaintext hljs">iptables -I FORWARD -s 10.8.0.3 -i tun0 -d 10.0.2.3 -p tcp --dport 443 -j ACCEPT iptables -I FORWARD -s 10.8.0.3 -i tun0 -d 10.0.2.3 -p icmp --icmp-type echo-request -j ACCEPT</code> </pre><br>  In the example above, host 10.8.0.3 is allowed access to port 443 of host 10.0.2.3. <br><br>  How to close access: <br><br><pre> <code class="plaintext hljs">#         iptables -L FORWARD --line-numbers #     iptables -D FORWARD { }</code> </pre><br>  Then you need to find all the rules for a specific client and delete them. <br><br>  During debugging it is convenient to look at what rules work.  Each rule has a counter for processed packets. <br><br><pre> <code class="plaintext hljs">#  ,      watch iptables -nvL FORWARD #     iptables -Z FORWARD</code> </pre><br>  <b>Automatically</b> <br><br>  The openvpn server has the ability to execute scripts for certain actions.  In particular, when connecting and disconnecting clients.  Scripts can be written on anything, just to be executable.  Inside the script, the environment variables are passed all the parameters of the current connection.  We are interested in variables: <br><br><ul><li>  <code>common_name</code> (name of the owner of the certificate; what is driven into the common name field when creating a certificate) </li><li>  <code>ifconfig_pool_remote_ip</code> (ip address of the client on tun0) </li><li>  <code>script_type</code> (which event occurred - connection or disconnection). </li></ul><br>  Root privileges are required to manage iptables.  After connecting, Openvpn resets permissions to nobody and executes scripts from it.  It's bad to allow nobody to do something from under sudo, and it‚Äôs better not to use the asterisk in the rules, but somehow you need to allow the user to manage iptables. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># /etc/sudoers.d/50_openvpn # #    nobody ALL = NOPASSWD: /sbin/iptables -A FORWARD* #     nobody ALL = NOPASSWD: /sbin/iptables -L FORWARD* #    nobody ALL = NOPASSWD: /sbin/iptables -D FORWARD*</span></span></code> </pre><br>  In the server's configuration, you need to add permission to execute third-party files and enable two hooks responsible for connecting and disconnecting the user. <br><br><pre> <code class="bash hljs">script-security 2 client-connect /etc/openvpn/bin/hosts.rb client-disconnect /etc/openvpn/bin/hosts.rb</code> </pre><br>  The script itself, which reads configs and applies the rules for iptables.  The script works on the same principles as described in the previous section. <br><br><div class="spoiler">  <b class="spoiler_title">/openvpn/bin/hosts.rb</b> <div class="spoiler_text"><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/ruby # -*- coding: utf-8 -*- require 'pp' def log(string) puts 'hosts.rb: ' + string end def parse_config_file(name) config_path = "hosts/#{name}" unless File.exist?(config_path) puts "There is no specific configuration for #{name}." p name exit 0 end config_source = IO.read(config_path).split("\n") config = config_source.inject([]) do |result,line| ip, port, protocol = line.split(/\s+/) result &lt;&lt; { ip: ip, port: port, protocol: protocol || 'tcp' } end end def get_config(name) user_config = parse_config_file(name) if user_config everybody_config = parse_config_file('everybody') end everybody_config + user_config end def apply_rule(rule) command = "sudo iptables #{rule}" log(command) system(command) end def remove_rule(number) command = "sudo iptables -D FORWARD #{number}" log(command) system(command) end def allow_target(source_ip, options) #         . apply_rule("-A FORWARD -s #{source_ip} -i tun0 -d #{options[:ip]} -p #{options[:protocol]} --dport #{options[:port]} -j ACCEPT") #       apply_rule("-A FORWARD -s #{source_ip} -i tun0 -d #{options[:ip]} -p icmp --icmp-type echo-request -j ACCEPT") end def clear_targets(source_ip) #      FORWARD,  source_ip. rules_exist = true while rules_exist table = `sudo iptables -L FORWARD --line-number`.split("\n") the_line = table.find do |line| fields = line.split(/\s+/) ip = fields[4] ip == source_ip end if the_line number = the_line.split(/\s+/)[0] remove_rule(number) else rules_exist = false end end end ################################################################################ script_type = ENV['script_type'] log(script_type) name = ENV['common_name'] source_ip = ENV['ifconfig_pool_remote_ip'] case script_type when 'client-connect' config = get_config(name) config.each{|target| allow_target(source_ip, target)} when 'client-disconnect' clear_targets(source_ip) else puts "Unknown script type #{script_type}." end</span></span></code> </pre></div></div><br>  Rules are stored in files corresponding to the common name of certificates in the <code>/etc/openvpn/hosts</code> folder.  They are spelled out which IP addresses are available for a particular client.  Separator - an arbitrary number of spaces.  Separator records IP address, port and protocol (tcp or udp). <br><br><pre> <code class="bash hljs">10.0.0.24 53 udp 10.0.0.25 53 udp 10.0.2.3 443 tcp</code> </pre><br>  As a result, the following structure should <code>/etc/openvpn</code> in the <code>/etc/openvpn</code> folder <br><br>  Bin‚îÄ‚îÄ bin <br>  ‚îÇ ‚îî‚îÄ‚îÄ hosts.rb <br>  Hosts‚îÄ‚îÄ hosts <br>  ‚îÇ ‚îú‚îÄ‚îÄ user1 <br>  ‚îÇ ‚îú‚îÄ‚îÄ user2 <br>  Body ‚îî‚îÄ‚îÄ everybody <br>  Server‚îÄ‚îÄ server.conf <br>  ‚îî‚îÄ‚îÄ ... <br><br>  <code>User1</code> and <code>user2</code> are files in the above format.  They describe which hosts the user with the corresponding common name has access to. <br><br>  There is another additional file <code>everybody</code> , it contains rules that apply to all clients, provided that there is a separate configuration file for these clients.  That is, if the user is given a list of hosts where he can go, then this list and those hosts that are listed in <code>everybody</code> apply.  If not, then <code>everybody</code> does not apply.  In this file it is convenient to take out for example a DNS server. <br><br>  <b>Logging</b> <br><br>  The installation script only includes logging of current connections ( <code>status)</code> parameter <code>status)</code> .  For the usual log to appear, you need to add a line to the server config ( <code>/etc/openvpn/server.conf</code> ): <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">log</span></span>-append /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/openvpn.log</code> </pre> <br><br>  <b>Ldap</b> <br><br>  There is an <a href="https://github.com/threerings/openvpn-auth-ldap">openvpn-auth-ldap</a> plugin that allows you to re-authenticate the user via LDAP. <br><br>  Put the package: <br><br><pre> <code class="plaintext hljs">sudo yum install openvpn-auth-ldap</code> </pre> <br>  Add to server.conf: <br><br><pre> <code class="plaintext hljs">plugin /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so "/etc/openvpn/ldap.conf"</code> </pre> <br>  Create a config for ldap in <code>/etc/openvpn/ldap.conf</code> : <br><pre> <code class="plaintext hljs">&lt;LDAP&gt; URL ldaps://{LDAP_DOMAIN_HERE} Timeout 15 TLSEnable no FollowReferrals yes BindDN "BIND_DN_HERE" Password "BIND_PASSWORD_HERE" &lt;/LDAP&gt; &lt;Authorization&gt; BaseDN "{BASE_DN_HERE}" SearchFilter "(&amp;(sAMAccountName=%u)(objectClass=organizationalPerson)(objectCategory=person)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))" RequireGroup false &lt;/Authorization&gt;</code> </pre><br>  Add line to user ovpn-config: <br><br><pre> <code class="plaintext hljs">auth-user-pass</code> </pre> <br>  Thus, the user will first be asked for the username and password from the domain, then the PIN code from the token.  If one of these steps fails, the connection will not be established. <br><br>  Description of options for ldap.conf <a href="">is in the plugin repository</a> .  It supports group membership authentication, but I have not tested it. <br><br><h4>  Speed </h4><br>  The greatest increase in speed gives the inclusion of udp mode.  It is advised in all manuals.  The point is that there is no point in launching a client tcp connection in a tcp channel.  One tcp at the client is enough to make the correct delivery of packets.  If packets disappear in the udp channel, the delivery adjustment will be controlled by the client tcp connection. <br><br>  The speed will increase as a minimum because you do not have to wait for confirmation of the delivery of each packet in the channel.  There is a second problem with tcp - one client tcp packet most likely does not fit into one vpn channel packet.  The MTU is the same, but you still need to add headers to the client package.  As a result, one user packet has to send two packets inside the vpn channel. <br><br>  TCP makes sense when used differently.  For example, when vpn works through ssh channel. <br><br><h4>  Example of full server configuration </h4><br><div class="spoiler">  <b class="spoiler_title">example-server.conf</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">port 1194 proto tcp dev tun sndbuf 0 rcvbuf 0 ca ca.crt cert server.crt key server.key dh dh.pem tls-auth ta.key 0 topology subnet server 10.8.0.0 255.255.255.0 ifconfig-pool-persist ipp.txt push "redirect-gateway def1 bypass-dhcp" push "dhcp-option DNS 10.0.0.25" push "dhcp-option DNS 10.0.0.24" keepalive 10 120 cipher AES-256-CBC comp-lzo user nobody group nobody persist-key persist-tun status openvpn-status.log verb 3 crl-verify crl.pem log-append /var/log/openvpn.log script-security 2 client-connect /etc/openvpn/bin/hosts.rb client-disconnect /etc/openvpn/bin/hosts.rb</code> </pre><br></div></div><br><h3>  Setting tokens </h3><br><h4>  PKCS # 11 Library </h4><br>  To work with tokens need a special library.  The library is needed both to create key pairs, and for the actual connection.  <a href="https://www.rutoken.ru/support/download/pkcs/">Download under all platforms can be on the link</a> . <br><br>  Everywhere, where librtpkcs11ecp.so occurs further, this is the very library that needs to be downloaded and put somewhere in a convenient place. <br><br><h4>  Creating a certificate on a token </h4><br>  Generate a key pair on the token.  The id parameter here is the ordinal number of the slot on the token where the key pair is placed. <br><br><pre> <code class="plaintext hljs">pkcs11-tool --module /usr/lib64/librtpkcs11ecp.so --keypairgen --key-type rsa:2048 -l --id 01</code> </pre><br>  Make a certificate request for the public key.  In the process of creating a certificate request, the certificate‚Äôs lifetime and common name are set, which is used to filter available ip-addresses within the network.  Common name must match the login in ActiveDirectory so that there is no confusion. <br><br><pre> <code class="plaintext hljs">openssl openssl&gt; engine -t dynamic -pre SO_PATH:/usr/lib64/openssl/engines/pkcs11.so -pre ID:pkcs11 -pre LIST_ADD:1 -pre LOAD -pre MODULE_PATH:/usr/lib64/librtpkcs11ecp.so openssl&gt; req -engine pkcs11 -new -key slot_0-id_01 -keyform engine -out /home/john/good.req</code> </pre><br>  The received request must be moved to the <code>/etc/openvpn/easy-rsa/pki/reqs/</code> .  The file extension must be <code>req</code> . <br>  Convert request to certificate: <br><br><pre> <code class="plaintext hljs">cd /etc/openvpn/easy-rsa/ ./easyrsa sign-req client good</code> </pre><br>  After that, in the <code>/etc/openvpn/easy-rsa/pki/issued/</code> folder <code>/etc/openvpn/easy-rsa/pki/issued/</code> there will be a certificate with the same name, but with the extension <code>crt</code> . <br><br>  Before recording, the certificate must be converted to DER: <br><br><pre> <code class="plaintext hljs">openssl x509 -in /home/user/user-cert.pem -out /home/user/user-cert.crt -outform DER</code> </pre><br>  Token certificate entry: <br><br><pre> <code class="plaintext hljs">pkcs11-tool --module /usr/lib/librtpkcs11ecp.so -l -y cert -w /home/user/user-cert.crt --id 45 --label TEST</code> </pre> <br>  Written on the basis of the article <a href="https://dev.rutoken.ru/pages/viewpage.action%3FpageId%3D18055179">‚ÄúUsing Rutoken EDS with OpenSSL (RSA)‚Äù</a> . <br><br><h4>  Using Token for Authentication </h4><br>  Find the certificate id to show to the server: <br><br><pre> <code class="plaintext hljs">$ openvpn --show-pkcs11-ids /usr/lib64/librtpkcs11ecp.so The following objects are available for use. Each object shown below may be used as parameter to --pkcs11-id option please remember to use single quote mark. Certificate DN: /CN=User1 Serial: 490B82C4000000000075 Serialized id: aaaa/bbb/41545F5349474E415455524581D2A1A1B23C4AA4CB17FAF7A4600</code> </pre><br>  We are interested in serialized id here. <br><br>  Options that need to be entered in the ovpn-config to pick up tokens: <br><br><pre> <code class="plaintext hljs">pkcs11-providers /usr/lib64/librtpkcs11ecp.so pkcs11-id 'aaaa/bbb/41545F5349474E415455524581D2A1A1B23C4AA4CB17FAF7A4600'</code> </pre> <br>  The <code>pkcs11-id</code> option <b>must be enclosed in single quotes.</b> <br><br>  This instruction makes sense on all platforms.  You need to specify the path to the library and the id of the certificate on the token.  The library may be called a little differently, be <code>.dll</code> , not <code>.so</code> , but the meaning is the same. <br><br>  At the same time, the <code>cert</code> and <code>key</code> sections must be removed from the ovpn file, because the certificate and private key will be taken from the token. <br><br>  Fully client config (for windows) looks like this: <br><br><div class="spoiler">  <b class="spoiler_title">client.ovpn</b> <div class="spoiler_text"> <code>client <br> dev tun <br> proto tcp <br> sndbuf 0 <br> rcvbuf 0 <br> remote 78.47.37.247 22222 <br> resolv-retry infinite <br> nobind <br> persist-key <br> persist-tun <br> remote-cert-tls server <br> cipher AES-256-CBC <br> comp-lzo <br> setenv opt block-outside-dns <br> key-direction 1 <br> verb 3 <br> <br> pkcs11-providers "c://Windows//System32//rtPKCS11ECP.dll" <br> pkcs11-id 'Aktiv\x20Co\x2E/Rutoken\x20ECP/342b871d/Rutoken/01' <br> <br> -----BEGIN CERTIFICATE----- <br> {CERT_HERE} <br> -----END CERTIFICATE----- <br> <br> <br> &lt;tls-auth&gt; <br> # <br> # 2048 bit OpenVPN static key <br> # <br> -----BEGIN OpenVPN Static key V1----- <br> {KEY_HERE} <br> -----END OpenVPN Static key V1----- <br> &lt;/tls-auth&gt;</code> <br> </div></div><br>  Written on the basis of <a href="https://openvpn.net/index.php/open-source/documentation/howto.html">‚ÄúOpenVPN configuration using client-side smart cards‚Äù</a> . <br><br><h3>  Customer setup </h3><br><h4>  Linux </h4><br>  In openvpn there is a bug that does not allow the user to enter the PIN from the token, if the package is built with systemd support.  Since recently systemd is everywhere, all packages that are already available in the repositories are built with its support.  Linux customers need to build the package themselves.  Here is an example of the configuration that earned me on Arch Linux: <br><br><pre> <code class="plaintext hljs">./configure \ --prefix=/usr \ --sbindir=/usr/bin \ --enable-iproute2 \ --enable-pkcs11 \ --enable-plugins \ --enable-x509-alt-username</code> </pre><br>  You can check whether openvpn is built with or without systemd using the following command: <br><br><pre> <code class="plaintext hljs">openvpn --version | grep --color enable_systemd</code> </pre><br><h4>  Mas os </h4><br>  Under Mac OS, there is only one free client - <a href="https://tunnelblick.net/downloads.html">Tunnelblink</a> . <br><br>  He does not know how to enter a pin code from a token from gui.  The bug is described for example here - <a href="https://groups.google.com/forum/">https://groups.google.com/forum/#!topic/tunnelblick-discuss/f_Rp_2nV-x8 It is</a> circumvented by running openvpn from the console.  This is not surprising, given that the official client under windows is also not able to. <br><br>  Also under Mac OS (unlike windows) additional scripts are needed to configure the network.  If you just run openvpn from the console, then DNS will not work (maybe something else, only DNS is manifested). <br><br>  TunnelBlick has these network configuration scripts, they only need to be called when a connection is established and disconnected.  What you need to add in the ovpn-config: <br><br><pre> <code class="bash hljs">script-security 2 up <span class="hljs-string"><span class="hljs-string">"/Applications/Tunnelblick.app/Contents/Resources/client.up.tunnelblick.sh -9 -d -f -m -w -ptADGNWradsgnw"</span></span> down <span class="hljs-string"><span class="hljs-string">"/Applications/Tunnelblick.app/Contents/Resources/client.down.tunnelblick.sh -9 -d -f -m -w -ptADGNWradsgnw"</span></span></code> </pre> <br>  An example of a script for running an openvpn connection that can be put on the desktop and poking the mouse: <br><br><pre> <code class="plaintext hljs">#!/bin/bash tunnelblick=/Applications/Tunnelblick.app/Contents/Resources/openvpn/openvpn-2.4.2-openssl-1.0.2k sudo $tunnelblick/openvpn --config $tunnelblick/user.ovpn</code> </pre><br><h4>  Windows </h4><br>  Under windows everything seems to work.  The official client does not know how to enter the pin-code from the token, it costs by launching openvpn by hand from the console. <br><br>  The most important thing is to do everything from an administrator.  Run from the administrator installer client.  To start the terminal in which openvpn starts, also with the admin rights, otherwise it will not be able to control the network interface. <br><br>  Under Windows, the path to the library to work with tokens should be recorded through double slashes.  This applies to both the ovpn-config and the <code>--show-pkcs11-ids</code> option on the command line. <br><br><pre> <code class="bash hljs">pkcs11-providers <span class="hljs-string"><span class="hljs-string">"c://Windows//System32//rtPKCS11ECP.dll"</span></span> pkcs11-id <span class="hljs-string"><span class="hljs-string">'Aktiv\x20Co\x2E/Rutoken\x20ECP/342b871d/Rutoken/01'</span></span></code> </pre></div><p>Source: <a href="https://habr.com/ru/post/433250/">https://habr.com/ru/post/433250/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../433234/index.html">A perfect babysitter is required; be sure to go through an AI scan to evaluate respect and good manners</a></li>
<li><a href="../433236/index.html">The head of Google believes that the fear of AI "is completely justified"</a></li>
<li><a href="../433242/index.html">Toxic Mask</a></li>
<li><a href="../433246/index.html">Framework: analysis of DLT-systems</a></li>
<li><a href="../433248/index.html">Parsing Memory Forensics with OtterCTF and familiarity with the Volatility framework</a></li>
<li><a href="../433252/index.html">Dummy on turbojet-electric copter hybrid</a></li>
<li><a href="../433254/index.html">We only fight with death, and you? Or companies that develop fantastic medicine.</a></li>
<li><a href="../433256/index.html">Developing a UI with Flutter</a></li>
<li><a href="../433258/index.html">You can buy electronic components in Europe even on vacation. Shopping experience on Mouser in Bulgaria</a></li>
<li><a href="../433260/index.html">Reading for the weekend: materials about working with PD, reviews of iron in the data center and the ‚Äúkitchen‚Äù of an IaaS provider</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>