<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>√Öngstr√∂m Style System? The use of styles. S2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is the √Öngstr√∂m Style System? 
 In a typical mobile application, the interface is one of the most complex and most important parts. What users se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>√Öngstr√∂m Style System? The use of styles. S2</h1><div class="post__text post__text-html js-mediator-article"><h2>  What is the √Öngstr√∂m Style System? </h2><br>  In a typical mobile application, the interface is one of the most complex and most important parts.  What users see, what customers value in the first place, when accepting work. <br><br>  Even if the design is drawn before development, in the process of creating the first version anyway there will be a huge amount of changes.  Then repaint the button, move it, increase / decrease the font, because it does not fit, and so on.  Each of these changes needs some work.  Often there are several hundred or even thousands of such modifications if it is impossible to immediately find the right parameters. <br><br>  In such a situation, it is very advantageous to separate the design settings from the interface itself and configure them independently.  This problem should be solved by a style system, ideologically - like CSS for HTML. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the article I will show how I try to organize styles in the application, and by what means I use for this. <br><a name="habracut"></a><br><h2>  The structure of the style system in the application </h2><br>  When I develop an application, I usually get two layers of style settings.  <em>The first layer</em> contains the most basic: <br><br><ul><li>  application colors </li><li>  application fonts </li><li>  basic text styles of the application, </li><li>  basic parameters.  For example, the total radius of rounding corners, or some steps of indents for the grid. </li></ul><br>  These are the parameters that permeate the entire application.  If suddenly the designer decided that he chose a bad font and needed to change it, then you need to change it right away everywhere.  This layer is usually quite small and clear to everyone.  You can give to edit / build it to the designers or even, in especially trusted cases, to the customer. <br><br>  From these parameters, in a huge number of variations, a <em>second layer of</em> styles is created.  There are already described specific screens, specific interface components.  For example. <br><br><ul><li>  label times: font number two, red or three color, left alignment, </li><li>  button two: font five, color blue-active, centered. </li></ul><br>  The files of the second layer are usually bulky, it is convenient to split them into several, according to the screens or sections of the application. <br><br><h2>  Advantages of styles in the application </h2><br>  Styles, especially organized in two layers, very well <em>separate the interface settings from the code</em> .  It is easier to find in several style files where this font size setting is here than to search for hundreds of source codes or huge storyboards. <br><br>  In case you learn how to download styles from a remote source (from a file in DropBox), then <em>design customization is accelerated hundreds of times during remote development</em> .  It's one thing when a designer can sit down with a developer and try to quickly tune some parameter, and when is it impossible?  Each iteration can take hours and days.  In this case, I updated the file, restarted the application (or made a clever secret gesture), looked at the result. <br><br>  In some situations, it is convenient to use skins.  For book readers, for example, it is a necessity; it is convenient to read during the day with a light background, at night - with a dark one.  Sometimes the customer wants it, sometimes the design is required for a ‚Äúwow effect‚Äù.  If you make two versions of the first layer of styles, you can switch them, leaving the second layer the same.  As a result, <em>skins are almost free</em> . <br><br><h2>  When was the need for a style system? </h2><br>  The need for a style system appeared at once from two sides: <br><br><ul><li>  In the outsourcing company developed many applications.  It is nice to have a general scheme of their work so that one developer can correct the code of another.  And customers are constantly changing requirements - are also more common than we would like. </li><li>  In developing your applications, you always want to make "perfect."  When we were developing Angstrom with Ilya Birman, we needed a design adjustment mechanism that would allow Ilya to play with the settings of complex components, such as the <a href="http://ilyabirman.ru/meanwhile/all/ass/">custom cursor</a> . </li></ul><br>  I prefer to test new ideas on my own projects, rather than on customer projects, so Angstrom was lucky and I created <a href="https://alex-babaev.squarespace.com/blog-ru/2014/4/15/-">a style system</a> for him.  It used the JSON file to describe the styles, into which I added the possibility of including other files (including ‚Äúfrom Dropbox‚Äù).  The framework also implemented callbacks that reported that the style had changed.  I connected the update styles to the shaking of the iPhone, it turned out interesting.  Corrected the file in Sublime, saved, shook the iPhone, the styles were loaded and applied to the entire application. <br><br><h2>  Disadvantages of the existing system that ‚Äúdid not take off‚Äù? </h2><br>  In general, the idea was so successful that it quickly spread to all of our created applications.  In some cases, this made it possible to significantly reduce development time (when the customer‚Äôs designer, for example, wanted to adjust the fonts or colors), sometimes the design changed from design to release completely several times, almost completely without the participation of the developer (or with minimal participation to customize thin moments). <br><br>  But I didn't like a few moments. <br><br>  First, JSON.  It always happened that I accidentally forgot a comma or made another stupid mistake in the file, and all the styles broke.  JSON does not check the names of the lost ones (these are just strings and it doesn‚Äôt matter what‚Äôs written there), typing is artificially introduced, which also prevents early detection of errors, and so on. <br><br>  The same JSON made me encode data types right in the names.  My colors ended in color, the points on the center or point, and so on.  As a result, the names of the fields were much longer than required. <br><br>  After the first attempts to use the style system, it turned out that the most convenient option is when a class hierarchy is created according to JSON, which completely repeats the hierarchy of objects in JSON.  In the application, a strictly typed structure then appears, which can be conveniently referred to as ordinary code.  In principle, it was possible to tie UI components to an update of styles, so that the style knew that it was applied to this button, and if it was updated (a new style was downloaded from Dropbox), then the button itself would update.  But in fact, it turned out that such magic only interferes with living, it is better to prescribe the update rules explicitly. <br><br>  Thirdly, I did not create a console utility that would generate style classes.  And the styles themselves were recreated when the application was launched in the simulator.  This turned out to be a significant disadvantage, both when connecting styles to the project, and during their subsequent update. <br><br>  Objective-C also interfered a bit with the need to support older versions of iOS.  The generated class code was large and unpleasant, I would very much like to optimize it. <br><br><h2>  S2 - a simpler and more efficient style system. </h2><br>  Understanding the shortcomings, I tried to improve the system so that it was better suited for solving problems, in all respects: <br><br><ul><li>  Now the file format is <a href="https://habrahabr.ru/post/278763/">KTV</a> .  It supports both links, mixins, and types, including the base color type.  KTV can read JSON files without changes, so my old styles migrated to the new structure without changes. </li><li>  The style file is created from a ktv file in Swift.  At the same time, if you do not use Objective-C support (which is also possible), then you get a compact, convenient for both viewing and using class (hierarchy of nested classes) that do not clutter the global name space of the application. </li><li>  Thanks to the support of types in KTV, it became possible to abandon the suffixes in the names, which simplified the names of the groups and classes. </li><li>  A console utility has appeared that can create style classes using a ktv file (or several files). </li></ul><br>  For example, I will give a (very small) fragment of the original KTV: <br><br><pre><code class="hljs css">{ <span class="hljs-attribute"><span class="hljs-attribute">maxWidthForIPad</span></span>: <span class="hljs-number"><span class="hljs-number">600</span></span> darkTheme: false defaultFontName: HelveticaNeue-Light bolderFontName: HelveticaNeue boldFontName: HelveticaNeue-Medium defaultSymbolFontName: AngstromSymbols-Light bolderSymbolFontName: AngstromSymbols basicColors: { plateBackground: <span class="hljs-number"><span class="hljs-number">#edf5f4</span></span> separators: <span class="hljs-number"><span class="hljs-number">#00407020</span></span> } <span class="hljs-selector-tag"><span class="hljs-selector-tag">ilya</span></span>: { <span class="hljs-attribute"><span class="hljs-attribute">aboutBackground</span></span>: @basicColors.plateBackground listSeparator: @basicColors.separators } <span class="hljs-selector-tag"><span class="hljs-selector-tag">colors</span></span>: { <span class="hljs-attribute"><span class="hljs-attribute">about</span></span>: { background: @ilya.aboutBackgroundColor separator: @ilya.listSeparatorColor } } <span class="hljs-selector-tag"><span class="hljs-selector-tag">about</span></span>: { <span class="hljs-attribute"><span class="hljs-attribute">margins</span></span>: [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>] separatorSpacing: <span class="hljs-number"><span class="hljs-number">10</span></span> background: @colors.about.backgroundColor separator: @colors.about.separatorColor } }</code> </pre> <br>  And the corresponding fragment of the style file, which is obtained: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-type"><span class="hljs-type">S2</span></span> = <span class="hljs-type"><span class="hljs-type">CONStyle</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CONStyle</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">S2Object</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> _rootStyle = <span class="hljs-type"><span class="hljs-type">S2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BasicColors</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">S2Object</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> separators = <span class="hljs-type"><span class="hljs-type">UIColor</span></span>(colorLiteralRed:<span class="hljs-type"><span class="hljs-type">Float</span></span>(<span class="hljs-number"><span class="hljs-number">1.0</span></span>), green:<span class="hljs-type"><span class="hljs-type">Float</span></span>(<span class="hljs-number"><span class="hljs-number">1.0</span></span>), blue:<span class="hljs-type"><span class="hljs-type">Float</span></span>(<span class="hljs-number"><span class="hljs-number">1.0</span></span>), alpha:<span class="hljs-type"><span class="hljs-type">Float</span></span>(<span class="hljs-number"><span class="hljs-number">0.0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> plateBackground = <span class="hljs-type"><span class="hljs-type">UIColor</span></span>(colorLiteralRed:<span class="hljs-type"><span class="hljs-type">Float</span></span>(<span class="hljs-number"><span class="hljs-number">0.929411764705882</span></span>), green:<span class="hljs-type"><span class="hljs-type">Float</span></span>(<span class="hljs-number"><span class="hljs-number">0.929411764705882</span></span>), blue:<span class="hljs-type"><span class="hljs-type">Float</span></span>(<span class="hljs-number"><span class="hljs-number">0.929411764705882</span></span>), alpha:<span class="hljs-type"><span class="hljs-type">Float</span></span>(<span class="hljs-number"><span class="hljs-number">1.0</span></span>)) } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> basicColors = <span class="hljs-type"><span class="hljs-type">BasicColors</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Ilya</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">S2Object</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> aboutBackground = _rootStyle.basicColors.plateBackground <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> listSeparator = _rootStyle.basicColors.separators } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> ilya = <span class="hljs-type"><span class="hljs-type">Ilya</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Colors</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">S2Object</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">About</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">S2Object</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> background = _rootStyle.ilya.aboutBackgroundColor <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> separator = _rootStyle.ilya.listSeparatorColor } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> about = <span class="hljs-type"><span class="hljs-type">About</span></span>() } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">About</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">S2Object</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> margins = <span class="hljs-type"><span class="hljs-type">UIEdgeInsets</span></span>(top:<span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">left</span></span>:<span class="hljs-number"><span class="hljs-number">0.0</span></span>, bottom:<span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">right</span></span>:<span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> separatorSpacing = <span class="hljs-type"><span class="hljs-type">Int</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> background = _rootStyle.colors.about.backgroundColor <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> separator = _rootStyle.colors.about.separatorColor } }</code> </pre> <br>  Of course, using Swift would be inconvenient for fully Objective-C projects.  This will drag you into the Swift-runtime project, which can significantly increase the size of the application.  But, firstly, it is not very difficult to write a generator of purely Objective-C code, and secondly, everything now goes to the massive use of Swift in applications, so that the generated S2 code will be "in the subject." <br></div><p>Source: <a href="https://habr.com/ru/post/278787/">https://habr.com/ru/post/278787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278777/index.html">The digest of interesting materials for the mobile developer # 143 (February 29 - March 8)</a></li>
<li><a href="../278779/index.html">Why is ownership / borrowing in Rust so complicated?</a></li>
<li><a href="../278781/index.html">Adaptive Split View Controller and Popover in iOS 9 (Swift). Part 2</a></li>
<li><a href="../278783/index.html">Google fixed Android vulnerabilities</a></li>
<li><a href="../278785/index.html">Lessons from participation in the Dota Science hackathon in the framework of Data Fest 2</a></li>
<li><a href="../278789/index.html">Why I am NOT a TypeScript fan</a></li>
<li><a href="../278791/index.html">Microsoft ported SQL Server to Linux</a></li>
<li><a href="../278793/index.html">Do I need a JSON replacement? In the wake of an article about KTV</a></li>
<li><a href="../278797/index.html">In Google Summer of Code 2016 with KolibriOS</a></li>
<li><a href="../278801/index.html">Custom configuration file in Rails</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>