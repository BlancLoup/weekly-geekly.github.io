<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Clustering a nodejs web server using node-clusterize-cli</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For the last six months, I have been developing a fairly large web application, under the hood of which NodeJS is roaring and smoking. When it came to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Clustering a nodejs web server using node-clusterize-cli</h1><div class="post__text post__text-html js-mediator-article">  For the last six months, I have been developing a fairly large web application, under the hood of which NodeJS is roaring and smoking.  When it came to production deployments, I wondered: ‚Äúwhy don't I use several threads with the application instance?‚Äù. <br><br>  Having realized the cluster, I saw that the productivity from its use increased by <a href="https://gist.github.com/shuvalov-anton/8399476">1.5 times</a> , which is not very bad, given the small amount of effort spent.  But I decided not to dwell on this, and make a convenient CLI for working with a cluster in order to untie the code that is responsible for starting the cluster from a specific application.  In addition, I really wanted to demonize the cluster so that it hung in silence in the process, raised fallen workers, wrote to the logs, and did not distract anyone anymore. <br><br>  This is how <a href="https://github.com/shuvalov-anton/node-clusterize-cli">node-clusterize-cli appeared</a> - a command line utility that does not affect application code.  Based on the original ‚Äúcluster‚Äù NodeJS module. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Work mechanism </h5><br>  The module is simple - to start, it starts the master process, in which the number of workers you need (by default, two processes per core) starts, and then untie the master process from the CLI interface and leave it running like a daemon.  In addition, the master process listens to error messages that may occur in workers, and automatically restarts fallen comrades.  For each request to be processed by a random process, the module from the NodeJS API called ‚Äúcluster‚Äù is responsible. <br><br><h5>  Using </h5><br>  In general, everything is trivial: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#    $ npm i -g node-clusterize-cli #   $ clusterize --app ./app.js --workers 32 --log ./cluster.log</span></span></code> </pre> <br><br>  Also, for convenience, there is a method for getting a list of running clusters, and a method for killing them: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ,  `ps -eo pid,comm | grep "clusterize master"` $ clusterize list 53416 app.js #   `kill -9 CLUSTER_PID` $ clusterize kill 53416</span></span></code> </pre><br><br>  More details can be found in the hint - <code>clusterize -h</code> and readme on GitHub. <br><br>  <a href="https://github.com/shuvalov-anton/node-clusterize-cli">repository on github</a> <br>  <a href="https://gist.github.com/shuvalov-anton/8399476">Ab load test logs</a> </div><p>Source: <a href="https://habr.com/ru/post/208914/">https://habr.com/ru/post/208914/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208902/index.html">SmartCAT: cloud technologies for translators</a></li>
<li><a href="../208904/index.html">New kind of developers - Java Coder Framework?</a></li>
<li><a href="../208906/index.html">Classification of 3D printers (7 3D printing technologies)</a></li>
<li><a href="../208908/index.html">Reversing simulated time</a></li>
<li><a href="../208910/index.html">Torrent server Demonoid back to life</a></li>
<li><a href="../208918/index.html">Pure functional data structures</a></li>
<li><a href="../208920/index.html">Alternative to PVS-Studio for $ 250</a></li>
<li><a href="../208922/index.html">Javascript: check your intuition</a></li>
<li><a href="../208926/index.html">Original Apple iMac</a></li>
<li><a href="../208928/index.html">How to prepare and get a PMP certificate in two weeks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>