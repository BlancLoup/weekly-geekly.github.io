<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using Zend_Db_Table</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At work, I had to deal with my own production ORM, which I did not like very much. I began to make my own (well, is it not a fool, eh? :)), in 3 days ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using Zend_Db_Table</h1><div class="post__text post__text-html js-mediator-article">  At work, I had to deal with my own production ORM, which I did not like very much.  I began to make my own (well, is it not a fool, eh? :)), in 3 days I got a simple ORM displaying the structure of tables on objects without controlling the types.  The result was something like this: <br><ul><li>  database class (relate from mysqli, pdo was not allowed) </li><li>  the class of the table that stores the database and is responsible for the CRUD records </li><li>  write class redirecting CUD methods to a table class </li></ul><br><br><a name="habracut"></a><br><br>  Sample usage: <br><pre>  &lt;code class = "php"&gt; $ table = new ArticleTable ();
 $ record = $ table-&gt; fetchOneWhere ("slug = 'hello'");  // get the existing entry
 $ record-&gt; name = 'Fucking Article!';
 $ record-&gt; save ();  // calls insert / update depending on whether this is a new entry.
 $ record = $ table-&gt; create ();  // create a new record
 $ record-&gt; name = 'Fucking Article2!';
 $ record-&gt; slug = 'fucking_article';
 // ...
 $ record-&gt; save (); &lt;/ code&gt; </pre><br>  And something reminded me very much, namely - Zend_Db: Zend_Db_Table / Zend_Db_Table_Row.  Without thinking twice, I threw my system out of my nafig and uploaded a piece of Zend Framework to the project (if necessary, then I‚Äôll tell you exactly which files are needed to complete the work of the entire Zend_Db component), and also decided to read what now in general there is in this Zend_Db as it turned out - quite a lot: <br><ul><li>  Good abstraction work with DB </li><li>  Record / Table Classes </li><li>  Support for fetch related objects </li><li>  Support for many-to-many connections (this is not even in Propel) </li></ul><br>  In fact - there are still things that could be added to make them work automatically: <br><ul><li>  Validators depending on the types of table fields </li><li>  The ability to immediately fetch data from several tables (or rather, to obtain such data is quite easy, but now scatter them across different objects and link these objects now with pens, if I'm not mistaken, but again - this is no problem) </li></ul><br>  Look like that's it.  The overall impression is just a great system.  It is easy and pleasant to use.  :) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>Example:</strong> <br>  First my supertypes of the layer will go (who read <a href="http://www.amazon.com/Enterprise-Application-Architecture-Addison-Wesley-Signature/dp/0321127420">Patters of EAA</a> will understand): <br><pre>  &lt;code class = "php"&gt; class Db_Table extends Zend_Db_Table_Abstract {
   / **
    * @return Zend_Db_Table_Rowset_Abstract
    * /
   public function fetchAllBy ($ key, $ value) {
     $ where = $ this-&gt; getAdapter () -&gt; quoteInto ("$ key =?", $ value);
     return $ this-&gt; fetchAll ($ where);
   }

   / **
    * @return Zend_Db_Table_Row_Abstract
    * /
   public function fetchRowBy ($ key, $ value) {
     $ where = $ this-&gt; getAdapter () -&gt; quoteInto ("$ key =?", $ value);
     return $ this-&gt; fetchRow ($ where);
   }

   public function __call ($ name, $ arguments) {
     if (strpos ($ name, 'fetchRowBy') === 0) {
       array_unshift ($ arguments, substr ($ name, 10));
       return call_user_func_array (array ($ this, 'fetchRowBy'), $ arguments);
     }

     if (strpos ($ name, 'fetchAllBy') === 0) {
       array_unshift ($ arguments, substr ($ name, 10));
       return call_user_func_array (array ($ this, 'fetchAllBy'), $ arguments);
     }

     throw new Exception ("Undefined method $ name");
   }
 }

 class Db_Record extends Zend_Db_Table_Row_Abstract {
 } &lt;/ code&gt; </pre><br>  And now - an example of use: <br><pre>  &lt;code class = "php"&gt; class Item extends Db_Table {
   protected $ _name = 'items';
   protected $ _rowClass = 'ItemRecord';
   protected $ _referenceMap = array (
       'Group' =&gt; array (
         'columns' =&gt; 'groupid',
         'refTableClass' =&gt; 'Group',
         'refColumns' =&gt; 'groupid',
       )
     );
 }

 class ItemRecord extends Db_Record {
 }

 class Group extends Db_Table {
   protected $ _name = 'groups';
   protected $ _rowClass = 'GroupRecord';
   protected $ _dependentTables = array ('Item');
 }

 class GroupRecord extends Db_Record {
 }

 $ itemTable = new Item ();
 $ item = $ itemTable-&gt; fetchRowBySlug ('hello');
 $ group = $ item-&gt; findParentGroup (); &lt;/ code&gt; </pre><br>  The coordinator is simple and convenient, isn't it? <br><br>  For those interested, I strongly advise you to fully study the <a href="http://framework.zend.com/manual/en/zend.db.html">chapter on Zend_Db</a> from the documentation of Zend Framework.  And also - <a href="http://blog.fxposter.org/2007/05/07/zend-database-table/">my post about Zend_Db_Table</a> , dedicated to its improvement (although I do not know how relevant it is now, there is no time to check :(). <br><br>  Cross post from my <a href="http://blog.fxposter.org/2008/07/20/using-zend_db_table/">blog</a> </div><p>Source: <a href="https://habr.com/ru/post/29466/">https://habr.com/ru/post/29466/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../294650/index.html">Fintech companies can equalize rights and obligations with banks</a></li>
<li><a href="../294652/index.html">Citizens and the state: access to public services will be available through the bank</a></li>
<li><a href="../294654/index.html">100 ideas for A / B testing. Part one</a></li>
<li><a href="../294656/index.html">"Es like a dollar" // Saturday //</a></li>
<li><a href="../294658/index.html">Why is Yandex.Direct not a cure for all diseases?</a></li>
<li><a href="../294660/index.html">100 ideas for A / B testing. Part two</a></li>
<li><a href="../294662/index.html">‚ÄúStart or forget‚Äù: How defects impede your development</a></li>
<li><a href="../294664/index.html">Startup - one of the possible scenarios of the project development</a></li>
<li><a href="../294666/index.html">RSP Nikita Mikhalkov will receive permission to collect a "tax on the pig" for another 10 years</a></li>
<li><a href="../294668/index.html">After the merger, Aktion and MCFER will become the largest publisher on the Russian media market</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>