<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Re: Primitive phishing protection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A couple of nights ago, trying to overcome the missed 1000+ in Google Reader, I stumbled upon the topic " Primitive protection against phishing " of t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Re: Primitive phishing protection</h1><div class="post__text post__text-html js-mediator-article">  A couple of nights ago, trying to overcome the missed 1000+ in Google Reader, I stumbled upon the topic " <a href="http://habrahabr.ru/blogs/infosecurity/47313/">Primitive protection against phishing</a> " of the hooey <a href="https://geektimes.ru/users/hooey/" class="user_link">habrayuzer</a> .  And inspired. <br><br>  I wanted to implement the idea as an extension for Firefox, which I tried to do. <br><br>  I warn you, this is my first extension for Firefox, it was written in a couple of evenings, and I‚Äôm absolutely not trying to immediately give out any final product, but just want to show a certain prototype. <br><a name="habracut"></a><br><h4>  Idea </h4><br>  So briefly: <br><ol><li>  look for links whose text is a URL; </li><li>  check if the href value is a reference (it may turn out that there is an anchor); </li><li>  we compare hosts in the text and in href; </li><li>  if it doesn‚Äôt match, we shout loudly and don‚Äôt let the user go left. </li></ol><br><h4>  Code </h4><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> fishurl = { <br> onLoad: <font color="#0000ff">function</font> () { <br> <font color="#0000ff">var</font> appcontent = <font color="#0000ff">document</font> .getElementById( <font color="#A31515">"appcontent"</font> ); <br> <font color="#0000ff">if</font> (appcontent) <br> appcontent.addEventListener( <font color="#A31515">"DOMContentLoaded"</font> , <font color="#0000ff">this</font> .onDOMLoad, <font color="#0000ff">true</font> ); <br> }, <br> onDOMLoad: <font color="#0000ff">function</font> (e) { <br> <font color="#0000ff">if</font> (e.originalTarget instanceof HTMLDocument) { <br> fishurl._parseDocument(e.originalTarget); <br> } <br> }, <br> _parseDocument : <font color="#0000ff">function</font> (doc) { <br> <font color="#008000">//     </font> <br> <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0, l = doc.links.length, item, textUrl, hrefUrl; i &lt; l; i++) <br> { <br> item = doc.links[i]; <br> <br> textUrl = <font color="#0000ff">this</font> ._parseUrl(item.text); <br> <br> <font color="#008000">// ,      URL</font> <br> <font color="#0000ff">if</font> (!textUrl) <br> <font color="#0000ff">continue</font> ; <br> <br> hrefUrl = <font color="#0000ff">this</font> ._parseUrl(item.href); <br> <br> <font color="#008000">// ,  href   URL (,  ,   )</font> <br> <font color="#0000ff">if</font> (!hrefUrl) <br> <font color="#0000ff">continue</font> ; <br> <br> <font color="#008000">// ,   </font> <br> <font color="#0000ff">if</font> (textUrl.host != hrefUrl.host) <br> { <br> <font color="#008000">//     </font> <br> <font color="#0000ff">var</font> _href = item.href; <br> <br> <font color="#008000">//    click  </font> <br> item.addEventListener( <br> <font color="#A31515">"click"</font> , <br> <font color="#0000ff">function</font> () { <br> <font color="#008000">//     ,    </font> <br> <font color="#0000ff">if</font> (confirm ( <font color="#A31515">"     ?\n["</font> + _href + <font color="#A31515">"]"</font> )) <br> gBrowser.selectedTab = gBrowser.addTab(_href); <br> <br> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <br> }, <br> <font color="#0000ff">false</font> ); <br> <font color="#008000">//   URL   </font> <br> item.removeAttribute( <font color="#A31515">"href"</font> ); <br> item.setAttribute( <font color="#A31515">"rel"</font> , <font color="#A31515">"nohref"</font> ); <br> <font color="#008000">//    ¬´¬ª </font> <br> item.style.cursor = <font color="#A31515">"not-allowed"</font> ; <br> <font color="#008000">//       </font> <br> item.style.textDecoration = <font color="#A31515">"line-through"</font> ; <br> } <br> } <br> }, <br> _parseUrl: <font color="#0000ff">function</font> (data) { <br> <font color="#008000">//  regexp,  !..  URL ¬´¬ª,   ,  ‚Äî false</font> <br> <font color="#0000ff">return</font> data.match(/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?([\w.-]+)(:[0-9]+)?(\/([\w#!:.?+=&amp;%@!\-\/])*)?/) ? <br> { url: RegExp[ <font color="#A31515">'$&amp;'</font> ], schema: RegExp.$1, auth: RegExp.$2, host: RegExp.$3, port: RegExp.$4, path: RegExp.$5 } : <font color="#0000ff">false</font> ; <br> } <br> }; <br> <br> <font color="#008000">//    load</font> <br> window.addEventListener( <font color="#A31515">"load"</font> , <font color="#0000ff">function</font> () { fishurl.onLoad(); }, <font color="#0000ff">false</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Picture </h4><br>  So (disgusting) this, so far, looks in practice: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/035/57e/9e7/03557e9e7e6ea31cfe2a09736b8c12b3.png" alt="Fishurl"><br><br>  In the image this is not visible, but when you hover the cursor over a ‚Äúbad‚Äù link, it takes the form of a crossed circle, hinting that you should not press here. <br><br>  Also, ‚Äú#‚Äù is placed in the href (and starting with the svn11 version, the href is removed altogether), so that the user does not follow the link by dragging it (using some kind of extension like <a href="http://mozilla.ktechcomputing.com/quickdrag/">QuickDrag</a> ). <br><br>  Alternatively, you can still display a warning icon on the link. <br><br><h4>  What's next? </h4><br>  If anyone is interested, I will continue to do it.  Write what you want, what you do not like, and ask if something is not clear in the code or logic. <br><br>  Naturally, there is the problem of false positives, for example, with the same download from Narod.Disk. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/64d/73c/705/64d73c705487c4369dd7156662ba3e90.png" alt="False triggered fishurl when downloading from Narod.Disk"><br><br>  Therefore, it will probably be necessary to organize black- or white- lists. <br><br><h4>  Where to get? </h4><br>  You can download it here: <a href="http://narod.ru/disk/4812470000/fishurl-svn12.xpi.html">fishurl-svn12.xpi</a> <br><br>  I distribute under the BSD license, so if you are interested, open the xpi file (this is a ZIP archive) and do what it pleases. <br><br>  If the author of the idea ( <a href="https://geektimes.ru/users/hooey/" class="user_link">hooey</a> ) doesn‚Äôt like it in any way, I certainly will stop this business;) <br><br>  And a big thank you to him, for the idea, and for waking up my desire to play, and even for the exciting hours of reading <a href="https://developer.mozilla.org/">developer.mozilla.org</a> ! </div><p>Source: <a href="https://habr.com/ru/post/48494/">https://habr.com/ru/post/48494/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../48485/index.html">Tuning Firefox for Opera lovers</a></li>
<li><a href="../48487/index.html">MacHeist. New secret missions.</a></li>
<li><a href="../48489/index.html">Quake Live BETA</a></li>
<li><a href="../48491/index.html">When a programmer has nothing to do ...</a></li>
<li><a href="../48492/index.html">Our home-made all-terrain vehicle</a></li>
<li><a href="../48495/index.html">Grossing ...</a></li>
<li><a href="../48496/index.html">Treatment of dead files, download and resume</a></li>
<li><a href="../48498/index.html">How to quickly start and effectively continue to write the extension for the fox</a></li>
<li><a href="../48499/index.html">Question: What should be the translation of technical documentation and terms in it?</a></li>
<li><a href="../48502/index.html">Keynote speaker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>