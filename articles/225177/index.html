<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rule number N + 0: do not be afraid to dig deeper</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 
 Hello! My name is Zhenya and I am a programmer. Nothing special. For now. 

 Today I would like to share a story with a good ending, whic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rule number N + 0: do not be afraid to dig deeper</h1><div class="post__text post__text-html js-mediator-article"><h5>  Prehistory </h5><br>  Hello!  My name is Zhenya and I am a programmer.  Nothing special.  For now. <br><br>  Today I would like to share a story with a good ending, which convinced me that even if you don‚Äôt consider yourself to be above average programmers and solve trivial tasks, programming as a process can still be very exciting! <br><br>  Before me was one of the most typical tasks: output the data to a text file.  The file format is such that it opens on any desktop average device.  I was sure of the simplicity of this task.  But this week, fate decided to teach me a lesson ... <br><a name="habracut"></a><br><h5>  Story </h5><br>  It all started with choosing a library to make life easier and choosing a format.  The format was docx and the <a href="http://www.tinybutstrong.com/opentbs.php">OenTBS</a> library.  It seems that everything in it was as it should - and the format of the file and use the template can be.  But as shown by 3 days of work, if this thing can work with nested arrays, it is not in such an obvious way that it may be necessary to join some sect in order to comprehend this.  I decided to follow the path of least resistance and just shared my thoughts about this library with the monitor and started looking for another one. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Next was a simple tool called <a href="http://sourceforge.net/projects/odtphp/">odtPHP</a> .  Whose site does not seem to work so far.  As you have already guessed, along with the library, we had to change the format too - it became odt.  If you really want to even be glad - open format and all that. <br><br>  This is where the fun began.  The document is generated from the template.  If you make a template in LibreOffice (namely, it was my first hand), then in Word it will open only after the issue of restoration.  And if you create a template in Word `s?  Then without recovery.  But after minimal edits in the template, the odtPHP produced an error saying that the variable was not found in the template.  Furious yelling and poking a finger at the name of a variable in the template did not help the cause.  Strange.  That is, it turned out that the desired variable is, as it were, written in the template, but odtPHP cannot find this variable through a regular expression. <br><br>  Suspicions began to creep in that the space / dash / any-other-character in Word ªe in the source code itself could be designated somehow differently.  Since I knew that odt, like docx, this is a simple archived XML, I decided to delve into this issue and for greater certainty I created the same odt template via Google Drive.  After unzipping the odt-files from different ‚Äúcreators‚Äù, the following picture came out: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ec8/0a3/49b/ec80a349b5c93aeb908e0274cf998839.png" alt="image"></div><br><br>  It became obvious that the format is a format, but programs can have a different look on it.  As you can guess, the entire contents of the file is stored in content.xml.  I open it.  Looking for my variables.  And, lo and behold!  I'm on the right track!  This is how my variable looks in Word ªe (a variant created in Word ªe): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f22/887/c86/f22887c86ee7c1ede15a3aeb65c47cee.png" alt="image"></div><br><br>  And this is how this fragment looks in content.xml: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf9/678/5a3/bf96785a3dd05dd69cff3054b9e3a523.png" alt="image"></div><br><br>  And the regular expression was as simple as possible: <br><br> <code>$reg = '@\[!--\sBEGIN\s' . $string . '\s--\](.*)\[!--.+END\s' . $string . '\s--\]@smU';</code> <br> <br>  What is &lt;text: s /&gt; to learn and failed.  You may think that this is a space, but why did he get in right here, and in other places just a space?  Unclear.  It was not possible to predict the arrangement of such magical spaces in Word.  So it happened that Word somewhere inserts a space as a space, and somewhere as &lt;text: s /&gt;, which breaks off the finding of a variable according to the minimum pattern. <br><br>  This is how a trivial task turned into a fascinating journey through the structure of the odt format! <br><br><h5>  Morality </h5><br>  No matter what level of knowledge you have, and how low your own assessment of skills is, don't be afraid to dig deeper!  Unless, of course, you are an excavator driver and a visit is not near the sign "It is forbidden to dig." <br><br><h5>  <b>PS It would be very interesting to read such stories in the format of Prehistory-History-Moral from cool developers, which later could be told for educational purposes.</b> </h5></div><p>Source: <a href="https://habr.com/ru/post/225177/">https://habr.com/ru/post/225177/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225165/index.html">The development of STIX fonts version 2.0.0 has been announced, aimed at improving their textual component.</a></li>
<li><a href="../225167/index.html">In-Memory OLTP in SQL Server 2014. Part I</a></li>
<li><a href="../225169/index.html">Introducing Sencha Ext JS 5</a></li>
<li><a href="../225173/index.html">Designing the physical infrastructure of the data center - from science to art</a></li>
<li><a href="../225175/index.html">New invariant number. The study of the natural number series (NPS)</a></li>
<li><a href="../225179/index.html">Speech recognition in Asterisk using the Yandex SpeechKit HTTP API</a></li>
<li><a href="../225183/index.html">Non-obvious features of the storage</a></li>
<li><a href="../225187/index.html">Zetes: Java with a multi-platform GUI, but without an Oracle JVM</a></li>
<li><a href="../225189/index.html">Multimodule Java-project with Gradle. Step by step</a></li>
<li><a href="../225191/index.html">Chinese Internet: a brief overview of near-social services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>