<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WEB-page rendering: what the front-end developer should know about this</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings to you, dear habravchane! Today I would like to highlight the issue of rendering in web development. Of course, many articles have already b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WEB-page rendering: what the front-end developer should know about this</h1><div class="post__text post__text-html js-mediator-article">  Greetings to you, dear habravchane!  Today I would like to highlight the issue of rendering in web development.  Of course, many articles have already been written on this topic, but, as it seemed to me, all the information is rather fragmented and fragmentary.  At least, in order to collect the whole picture in my head and comprehend it, I had to analyze a lot of information (mostly English-speaking).  That is why I decided to formalize my knowledge into an article, and share the result with the Habr community.  I think the information will be useful for both novice web developers and more experienced ones to refresh and structure their knowledge. <br><br>  This direction can and should be optimized at the stage of layout / frontend-development, since, obviously, markup, styles and scripts are directly involved in rendering.  To do this, the relevant specialists must know some subtleties. <br><a name="habracut"></a><br>  I note that the article is not aimed at the exact transfer of the mechanics of browsers, but rather at understanding its general principles.  Moreover, different browser engines are very different in the algorithms of work, so it is not possible to cover all the nuances within one article. <br><br><h2>  The processing of the WEB-page browser </h2><br>  To begin, consider the sequence of the browser when displaying the document: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  From the HTML document received from the server, a DOM (Document Object Model) is formed. </li><li>  Styles are loaded and recognized, CSSOM (CSS Object Model) is formed. </li><li> On the basis of DOM and CSSOM, a rendering tree is formed, or render tree - a set of rendering objects (Webkit uses the term ‚Äúrenderer‚Äù or ‚Äúrender object‚Äù, and Gecko - ‚Äúframe‚Äù).  Render tree duplicates the DOM structure, but invisible elements do not fall here (for example, <code>&lt;head&gt;</code> , or elements with the <code>display:none;</code> style).  Also, each line of text is represented in the render tree as a separate renderer.  Each rendering object contains a corresponding DOM object (or a block of text), and a style calculated for this object.  Simply put, render tree describes the visual representation of the DOM. </li><li>  For each element of the render tree, the position on the page is calculated - layout occurs.  Browsers use the flow method, in which in most cases a single pass is enough to accommodate all the elements (more tables are required for the tables of passes). </li><li>  Finally, there is a drawing of all this stuff in the browser - painting. </li></ol><br>  In the process of user interaction with the page, as well as the execution of scripts, it changes, which requires repeated execution of some of the above operations. <br><br><h4>  Repaint </h4><br>  In the case of changing the styles of an element that do not affect its size and position on the page (for example, <code>background-color</code> , <code>border-color</code> , <code>visibility</code> ), the browser simply draws it again, taking into account the new style - repaint (or restyle) occurs. <br><br><h4>  Reflow </h4><br>  If the changes affect the content, the structure of the document, the position of the elements - reflow (or relayout) occurs.  The reasons for such changes are usually: <br><br><ul><li>  Manipulations with DOM (add, delete, modify, rearrange elements); </li><li>  Content change, incl.  text in form fields; </li><li>  Calculation or change of CSS properties; </li><li>  Add, remove style sheets; </li><li>  Manipulations with the attribute " <code>class</code> "; </li><li>  Manipulations with the browser window - resizing, scrolling; </li><li>  Activate pseudo-classes (for example <code>:hover</code> ). </li></ul><br><br><h2>  Browser optimization </h2><br>  Browsers, if possible, localize repaint and reflow within the elements that have undergone a change.  For example, resizing an absolutely or fixedly positioned element will affect only the element itself and its descendants, while changing a statically positioned element will result in reflow of all elements following it. <br><br>  Another feature is that during the execution of JavaScript, browsers cache changes that are made, and apply them in a single pass upon completion of the code block.  For example, during the execution of this code, only one reflow and repaint will occur: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $body = $(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); $body.css(<span class="hljs-string"><span class="hljs-string">'padding'</span></span>, <span class="hljs-string"><span class="hljs-string">'1px'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// reflow, repaint $body.css('color', 'red'); // repaint $body.css('margin', '2px'); // reflow, repaint //      1 reflow  repaint</span></span></code> </pre><br>  However, as described above, accessing the properties of the elements will force a reflow.  That is, if we add a reference to the property of the element to the above code block, it will cause an extra reflow: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $body = $(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); $body.css(<span class="hljs-string"><span class="hljs-string">'padding'</span></span>, <span class="hljs-string"><span class="hljs-string">'1px'</span></span>); $body.css(<span class="hljs-string"><span class="hljs-string">'padding'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   ,  reflow $body.css('color', 'red'); $body.css('margin', '2px');</span></span></code> </pre><br>  As a result, we get 2 reflow instead of one.  Therefore, references to the properties of elements should be grouped together in one place, if possible, in order to optimize performance (see a <a href="http://jsbin.com/duhah/2/edit">more detailed example on JSBin</a> ). <br><br>  But, in practice, there are situations when it is impossible to do without forced reflow.  Suppose we have a task: we need to apply the same property (take ‚Äú <code>margin-left</code> ‚Äù) to an element first without animation (set to <code>100px</code> ), and then to animate by means of transition to <code>50px</code> .  You can immediately see <a href="http://jsbin.com/qutev/1/edit">this example on JSBin</a> , but I will sign it here. <br>  First, let's get a class with transition: <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.has-transition</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">-webkit-transition</span></span>: margin-left <span class="hljs-number"><span class="hljs-number">1s</span></span> ease-out; <span class="hljs-attribute"><span class="hljs-attribute">-moz-transition</span></span>: margin-left <span class="hljs-number"><span class="hljs-number">1s</span></span> ease-out; <span class="hljs-attribute"><span class="hljs-attribute">-o-transition</span></span>: margin-left <span class="hljs-number"><span class="hljs-number">1s</span></span> ease-out; <span class="hljs-attribute"><span class="hljs-attribute">transition</span></span>: margin-left <span class="hljs-number"><span class="hljs-number">1s</span></span> ease-out; }</code> </pre><br>  Then, we will try to realize our plans as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $targetElem = $(<span class="hljs-string"><span class="hljs-string">'#targetElemId'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  ,       "has-transition" //    transition $targetElem.removeClass('has-transition'); //  , ,  transition ,     $targetElem.css('margin-left', 100); //    transition   $targetElem.addClass('has-transition'); //   $targetElem.css('margin-left', 50);</span></span></code> </pre><br>  This solution will not work as expected, since  changes are cached and applied only at the end of the code block.  We will be rescued by a forced reflow, as a result, the code will take the following form, and will exactly perform the task: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    transition $(this).removeClass('has-transition'); //   $(this).css('margin-left', 100); //   reflow,         $(this)[0].offsetHeight; //  ,       //    transition   $(this).addClass('has-transition'); //   $(this).css('margin-left', 50);</span></span></code> </pre><br><br><h2>  Practical Optimization Tips </h2><br>  On the basis of this article, as well as other articles on Harba, where the issue of client-side optimization is covered, the following tips can be derived, which will be useful in creating an effective frontend: <br><br><ul><li>  Write valid HTML and CSS, indicating the encoding.  Styles are best included in <code>&lt;head&gt;</code> , and scripts at the end of <code>&lt;body&gt;</code> . </li><li>  Strive to simplify and optimize CSS selectors (this is often neglected by developers using preprocessors).  The less nesting, the better.  By processing efficiency, selectors can be arranged in the following order (starting with the fastest): <br><ol><li>  ID: <code>#id</code> </li><li>  Class: <code>.class</code> </li><li>  Tag: <code>div</code> </li><li>  Nearby selector: <code>a + i</code> </li><li>  Child selector: <code>ul &gt; li</code> </li><li>  Universal selector: <code>*</code> </li><li>  Attribute selector: <code>input[type="text"]</code> </li><li>  All elements and pseudo-classes: <code>a:hover</code> </li></ol><br>  It should be remembered that the browser handles selectors from right to left, so it‚Äôs better to use the most efficient selector and the class as the key (rightmost) selector. <br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">div</span></span> * {...} //  <span class="hljs-selector-class"><span class="hljs-selector-class">.list</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> {...} //  <span class="hljs-selector-class"><span class="hljs-selector-class">.list-item</span></span> {...} //  <span class="hljs-selector-id"><span class="hljs-selector-id">#list</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.list-item</span></span> {...} // </code> </pre><br></li><li>  In scripts, minimize any work with the DOM.  Cache everything: properties, objects, if you intend to reuse them.  With complex manipulations, it is wise to work with an ‚Äúoffline‚Äù element (that is, which is not in the DOM, but in memory), and then placed in the DOM. <br></li><li>  When using jQuery to select items, follow the <a href="http://learn.jquery.com/performance/optimize-selectors/">guidelines for making selectors</a> . <br></li><li>  To change the styles of elements, it is better to modify only the ‚Äú <code>class</code> ‚Äù attribute, and as far as possible in the DOM tree, this is both more competent in terms of development and support (separating logic from presentation), and less expensive for the browser. </li><li>  It is desirable to animate only absolutely and fixedly positioned elements. </li><li>  You can disable complex: hover animations during scrolling (for example, adding the " <code>no-hover</code> " class to the body).  <a href="http://habrahabr.ru/post/204238/">An article on this topic</a> . </li></ul><br><br>  For a more detailed study of the issue I recommend to read the articles: <br><ul><li>  <a href="http://taligarsiel.com/Projects/howbrowserswork1.htm">How browsers work</a> </li><li>  <a href="http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/">Rendering: repaint, reflow / relayout, restyle</a> </li></ul><br><br>  I hope every reader has learned something useful from the article.  In any case - thank you for your attention! <br><br>  UPD: Thanks to <a href="https://habrahabr.ru/users/selenit2/" class="user_link">SelenIT2</a> and <a href="https://habrahabr.ru/users/piumosso/" class="user_link">piumosso</a> for correct comments on the effectiveness of processing CSS selectors. </div><p>Source: <a href="https://habr.com/ru/post/224187/">https://habr.com/ru/post/224187/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../224173/index.html">How I made a power control widget for my space flight browser simulator</a></li>
<li><a href="../224175/index.html">[libGDX] Writing a full game for Android. Part 1</a></li>
<li><a href="../224179/index.html">Dual boot ArchLinux and Windows 8 on UEFI without GRUB using rEFInd</a></li>
<li><a href="../224181/index.html">Why you should use Vim</a></li>
<li><a href="../224185/index.html">A tool to highlight the active item of a simple HTML menu.</a></li>
<li><a href="../224191/index.html">Minification of Ext JS and Sencha Touch applications using ASP.NET</a></li>
<li><a href="../224193/index.html">Through hardship to the stars. To the imperatives of cosmic colonialism</a></li>
<li><a href="../224195/index.html">Writing a Simple SailsJS Blog: Visual Practice for Beginners (Part 1)</a></li>
<li><a href="../224197/index.html">Sunduk or 10 seconds per name</a></li>
<li><a href="../224199/index.html">RESTful API on Yii framework with RBAC and tests</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>