<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Smart Redirects for Nuclear Pack</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We managed to capture an interesting wave of Carberp distribution using the latest version of Blackhole and later Nuclear Pack. Moreover, a similar st...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Smart Redirects for Nuclear Pack</h1><div class="post__text post__text-html js-mediator-article">  We managed to capture an interesting wave of Carberp distribution using the latest version of Blackhole and later Nuclear Pack.  Moreover, a similar <a href="http://blog.fox-it.com/2012/03/16/post-mortem-report-on-the-sinowallnu-nl-incident/">story</a> happened a month earlier in the Netherlands, but only Nuclear Pack version 2 participated in it, and another bank veteran <a href="http://www.eset.eu/encyclopaedia/mebroot_backdoor_sinowal_trojan_mebroot_stealth_mbr_trojan_backdoor_maosboot%3Flng%3Den">Sinowal / Mebroot was distributed</a> . <br><img src="https://habrastorage.org/getpro/habr/post_images/c3d/4a4/a2f/c3d4a4a2f26c231ae736a4b124e273e4.png" alt="image"><br><br>  Nuclear Pack is now gaining popularity again among exploit kits.  The actual migration from the Blackhole is due to its good detection by security software and the close attention of a large number of researchers from around the world. <br><br>  The most <a href="http://contagiodump.blogspot.com/2010/06/overview-of-exploit-packs-update.html">popular</a> exploit kits are the following: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Blackhole </li><li>  Eleonore </li><li>  Nuclear pack </li><li>  Incognito </li><li>  Phoenix </li><li>  Sakura </li></ul><br>  But let us return to our history, so this week there were recorded massive attacks from the network Leksim Ltd / RELNET-NET AS5577, or rather, it was here that the sets of exploits were hosted and redirected from legal web resources. <br><br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/25d/187/c82/25d187c82b75135fe584d0f982653aaf.png" alt="image"><br><br>  By the way, what is symbolic is this hosting has already been <a href="http://blog.dynamoo.com/2011/04/evil-network-leksim-ltd-relnet-net.html">seen</a> in illegal activities a year ago, and that is typical in April. <br><br>  But the discussion in this post is completely different, the fact is that most often active systems for collecting malicious samples and redirect searches are quite simple and not many of them can really understand the DOM model and create the illusion of a real user. <br><br>  We managed to fix a rather interesting attack using Nuclear Pack (first discovered in 2009), in which there are, albeit primitive, but the beginnings of detecting the presence of a real user and countering active sample collection systems. <br><br>  So, first things first.  At the first stage, when visiting an infected web page, the JS script is executed (in our example, hxxp: //winfield-oil.ru/javascript/script.js). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9a2/d89/a3c/9a2d89a3c58763665076ac53588cab0e.png" alt="image"><br><br>  Which already in turn contains a rather curious function in which there is an appeal to a strange domain (hxxp: //onj42a.qpoctushpm.is-an-actor.com/g/). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f08/dac/c6a/f08dacc6a729757b34e84034bce51e64.png" alt="image"><br><br>  As can be seen from the above code, <i>GetElementsByTagName ()</i> and some primitive mathematical calculations are called, and as a result, another script is launched for execution. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e81/039/50f/e8103950fb775c1cfd18bab095a48bf9.png" alt="image"><br><br>  This obfuscated monster only looks so scary at first glance, but in fact its task is only to generate the iFrame code that will redirect. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f8/313/921/5f8313921b1ddba7d4fcebfb1eac0cf5.png" alt="image"><br><br>  The iFrame code looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/349/55b/798/34955b79878017edf95baacd019b90e3.png" alt="image"><br><br>  This whole iterative operation aims to prevent various malicious web page detection systems from detecting the iFrame redirect.  In addition, a check for onmousemove events was also noticed, that is, so that the cursor moved on the web page, otherwise the redirection will not occur. <br><br>  After the redirection, various exploits are attacked, including CVE-2012-0507, which I already <a href="http://habrahabr.ru/company/eset/blog/141365/">wrote</a> about last time. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cf9/e2f/8c8/cf9e2f8c82d6adb0553a895f2258f013.png" alt="image"><br><br>  In the code above, you can see that Java applet is downloading (hxxp: //094t8g.qktsnwukvi.webhop.net //images/274e0118278c38ab7f4ef5f98b71d9dc.jar) and passing parameters for the MyStart method (String paramString).  The structure of Java / Exploit.CVE-2012-0507.J is as follows: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fab/d92/f0c/fabd92f0cb3ea87a91988c9855d09847.png" alt="image"><br><br>  The URL decoding algorithm for loading the payload is as follows: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/831/79b/cd9/83179bcd9cd947bb3d97dfe9d640983e.png" alt="image"><br><br>  The value of this parameter is further involved in the decoding process of the URL (hxxp: //094t8g.qktsnwukvi.webhop.net/server_privileges.php? 7e9f0e75503391ed492e5abe22e1989e = 2) from which the malware is being downloaded (in our case it was Win32 / TrojanDownloeradera2 2) which downloaded the malicious program (in our case, it was Win32 / TrojanDownloeraderau 2) which was downloaded by Win32 / TrojanDownloerau for a user (in our case, it was Win32 / TrojanDownloeraventra 2). for later launch. <br><br>  If it fails to exploit <a href="http://www.eset.eu/encyclopaedia/java-exploit-cve-2012-0507-a-c-cve2012">CVE-2012-0507</a> , an attempt is made to exploit PDF vulnerability CVE-2010-0188 (JS / Exploit.Pdfka.PJN). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/25d/23c/6af/25d23c6afddce5f2cef779dfc783492a.png" alt="image"><br><br>  An interesting anomaly was also noticed when the Blackhole hung there until 3.04, but on the third day it was changed to an updated Nuclear Pack with the CVE-2012-0507 exploit on board.  But in both cases, <a href="http://www.eset.eu/encyclopaedia/win32-trojandownloader-carberp-ah-backdoor-bredolab-xuf-trojan">Win32 / TrojanDownloader.Carberp.AH was loaded</a> . <br><br>  02 / Apr / 2012 GET hxxp: //dx6ts.yfwumdwyei.is-a-hunter.com/g/3854063525500425.js 62.122.79.32 <br>  02 / Apr / 2012 GET hxxp: //yfwumdwyei.is-a-hunter.com/main.php? Page = 4f086f0830a83d5f 62.122.79.32 [Blackhole] <br><br>  03 / Apr / 2012 GET hxxp: //094t8g.qktsnwukvi.webhop.net/g/017432546059324.js 62.122.79.41 <br>  03 / Apr / 2012 GET hxxp: //qktsnwukvi.webhop.net/main.php? Page = 4f086f0830a83d5f 62.122.79.41 [Blackhole] <br><br>  03 / Apr / 2012 GET hxxp: //pqiyoc.qktsnwukvi.webhop.net/g/697079368134578.js 62.122.79.41 <br>  03 / Apr / 2012 GET hxxp: //094t8g.qktsnwukvi.webhop.net/server_privileges.php? E843aac68e6c4d6126926e60a1781536 = 2 62.122.79.41 [Nuclear Pack] <br><br>  And just today Nuclear Pack was recorded at the following address and the fact of moving from Blackhole was also noticed: <br><br>  09 / Apr / 2012 GET hxxp: //lifenews-click2.org/server_privileges.php? 42afeed2b049dbda5fe177000c3787c5 = 2 [Nuclear Pack] <br><br>  In the future, opposition to various sandboxes and active systems for detecting malicious web pages will only get worse.  And I think that in the near future we will see many more interesting things in this direction. <br><br>  study author: <a href="http://habrahabr.ru/users/matrosov/" class="user_link">matrosov</a> </div><p>Source: <a href="https://habr.com/ru/post/141757/">https://habr.com/ru/post/141757/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141751/index.html">The most popular games and applications for Ubuntu for March 2012 (repository UALinux)</a></li>
<li><a href="../141753/index.html">Invitation to get acquainted with IBM's smart cloud</a></li>
<li><a href="../141754/index.html">SaaS & Workflow - Making workflow in Axxerion</a></li>
<li><a href="../141755/index.html">Contest results</a></li>
<li><a href="../141756/index.html">Parsing Python code using Flex and Bison</a></li>
<li><a href="../141759/index.html">PRUFFI Friends - how to sell a friend to make him like</a></li>
<li><a href="../141761/index.html">Quadcopter for 1 day and $ 120</a></li>
<li><a href="../141762/index.html">Rules for a startup during an investment boom</a></li>
<li><a href="../141765/index.html">Facebook has announced an Instagram acquisition agreement. Issue price - $ 1 billion</a></li>
<li><a href="../141766/index.html">Open control system "smart home" MajorDoMo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>