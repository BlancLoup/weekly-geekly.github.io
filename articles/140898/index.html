<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Apache POI 3.8 has been released.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On March 26, a new release of the Apache POI library - version 3.8 was released. 

 Apache POI is a Java language library for reading and writing Micr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Apache POI 3.8 has been released.</h1><div class="post__text post__text-html js-mediator-article">  On March 26, a new release of the Apache POI library - version 3.8 was released. <br><br>  Apache POI is a Java language library for reading and writing Microsoft Office documents. <br>  such as Excel, PowerPoint and Word.  With POI you can programmatically create new <br>  or modify existing documents, index text, process nested <br>  (embedded) objects (documents, pictures, etc.) and much more. <br><br>  The previous stable version of Apache POI was released a year and a half ago, in October 2010, <br>  therefore, changes have accumulated decently.  Fixed more than 200 bugs, added numerous <br>  new features and improved overall performance. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><h1>  What's new in POI 3.8? </h1><br><br><h4>  <a href="http://poi.apache.org/spreadsheet/how-to.html">SXSSF</a> Spreadsheet API implementation for creating large .xlsx files <br>  (&gt; 100K records) with limited memory. </h4><br><br>  The standard implementation of the .xlsx file generator (XSSF) builds a model of the entire document in memory, <br>  those.  For each record (row) and cell (cell) in the memory sits a model.  Because the .xlsx format is based <br>  on XML, for each model there is an XML bean, we get quite spreading structures and with <br>  generating large amounts of data is a chance to get an OutOfMemoryError. <br><br>  SXSSF solves this problem by storing only the last N entries in each memory. <br>  worksheet, and the rest as they accumulate are dropped into temporary files and when saving <br>  the contents of these temporary files are copied to the main document. <br><br>  A small example: when running with the -Xmx128M key, the code below crashes with an OutOfMemoryError approximately <br>  after generating 200,000 cells: <br><br><pre><code class="java hljs">Workbook workbook = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XSSFWorkbook(); <span class="hljs-comment"><span class="hljs-comment">// keep the whole model in memory Sheet sheet = workbook.createSheet(); // generate a grid of 1M rows x 256 columns for(int i = 0; i &lt; 1000000; i++) { Row row = sheet.createRow(i); for(int j = 0; j &lt; 256; j++){ Cell cell = row.createCell(j); cell.setCellValue(i*j); } } // the code never gets to this point because of OutOfMemoryError FileOutputStream out = new FileOutputStream("workbook.xlsx"); workbook.write(out); out.close();</span></span></code> </pre> <br><br>  the same, but using SXSSF works without problems even with the ‚ÄìXmx64M key: <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">// keep last 100 rows in memory, flush older rows to disk Workbook workbook = new SXSSFWorkbook(100); Sheet sheet = workbook.createSheet(); // generate a grid of 1M rows x 256 columns for(int i = 0; i &lt; 1000000; i++) { Row row = sheet.createRow(i); for(int j = 0; j &lt; 256; j++){ Cell cell = row.createCell(j); cell.setCellValue(i*j); } } // Voila! FileOutputStream out = new FileOutputStream("workbook.xlsx"); workbook.write(out); out.close();</span></span></code> </pre><br><br><h4>  Updates in the Formula Evaluator </h4><br><br><h6>  New features support: </h6><br> <code>IRR,NPV,MROUND,VAR,VARP,CLEAN,CHAR,ADDRESS,HOUR,MINUTE,SECOND,RATE,WORKDAY,NETWORKDAYS,SUMIFS,RANK</code> <br> <br>  Total POI supports 140 functions out of about 300 supported in Excel 2010. <br>  Full list of supported features can be found <a href="http://poi.apache.org/spreadsheet/eval-devguide.html">here.</a> <br><br><h6>  User-Defined Functions </h6><br>  What if the formula contains a function that is not supported? <br>  By default, the formula calculator throws NotImplementedException and this happens in two cases: <br><ul><li>  Function defined in Excel, but not implemented in POI </li><li>  The function is defined in a VBA macro or in an external add-in library. </li></ul><br><br>  POI 3.8 gives you the opportunity to programmatically implement the function you need. <br>  and register it in the calculator.  Like that: <br><br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">/** * CUBEMEMBER:   OLAP ,    POI-3.8 */</span></span> FreeRefFunction CUBEMEMBER = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FreeRefFunction() { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ValueEval </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evaluate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ValueEval[] args, OperationEvaluationContext ec)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(args.length != <span class="hljs-number"><span class="hljs-number">3</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  CUBEMEMBER  3  return ErrorEval.VALUE_INVALID; } // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> implement me //      #NUM! return ErrorEval.NUM_ERROR; } }; WorkbookEvaluator.registerFunction("CUBEMEMBER", CUBEMEMBER); //   NotImplementedException     </span></span></code> </pre><br><br><h6>  <a href="http://poi.apache.org/spreadsheet/excelant.html">Excel Ant tasks</a> </h6><br>  Ant extensions are designed to recalculate and test formulas without writing Java code. <br>  This functionality has an interesting story: it came from a scientific project in which Excel files <br>  Third-party software is created, not POI.  Files contain both the data itself and the formulas needed <br>  check their correctness on the server side, while the verifier is not a programmer <br>  in Java and knows only a little Ant syntax. <br>  Using Excel Ant tasks, a task is reduced to writing build files.  Target s interacting <br>  with POI look like this: <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Habratest"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">excelant</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fileName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"habratest.xls"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">test</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">evaluate</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cell</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"'Habratest'!$B$4"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">expectedValue</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"790.7936"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">precision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0e-4"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">test</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">excelant</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  at the output of Ant, we will see the following: <br><br><pre> <code class="xml hljs">Habratest: [excelant] Using input file: habratest.xls [test] setting globalPrecision to 0.0010 in the evaluator [evaluate] test precision = 1.0E-4 global precision = 0.0010 [evaluate] Using evaluate precision of 1.0E-4 over the global precision of 0.0010 [excelant] 1/1 tests passed.</code> </pre><br><br><h4>  <a href="http://poi.apache.org/slideshow/xslf-cookbook.html">XSLF</a> - Java API for working with .pptx files (PowerPoint 2007-2010) </h4><br><br>  POI now supports a full-featured User API for working with .pptx files. <br>  You can programmatically create new or edit existing .pptx files, <br>  insert or change slides, text, pictures, tables, and more. <br><br>  Below is a partial list of supported features: <br><br><ul><li>  Creating new slides, incl.  with a predefined design (Title, Title and Text, <br>  Title and Picture, etc.) </li><li>  Inserting pictures </li><li>  Inserting text blocks with support for paragraphs and formatting blocks </li><li>  Combine slides from multiple presentations </li><li>  Tables </li><li>  Full support for geometric objects defined in PowerPoint: <br>  from primitives (rectangle, ellipse) to objects with arbitrary geometry (freeforms) </li><li>  PPTX2PNG: Converting Slides to Pics </li></ul><br><br>  The last feature, PPTX2PNG, I would like to emphasize: this utility with Java main () interface <br>  converts slides into PNG pictures, but you can take this code as a basis and write a converter <br>  to other graphic formats (SVG, Flash, HTML5 Canvas, etc.).  All you need to do is pass <br>  a subclass from java.awt.Graphics2D to the slide.draw method (Graphics2D graphics); <br><br>  For example, <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/xslf/usermodel/PPTX2SVG.txt">this</a> example demonstrates how to convert .pptx slides to SVG using the SVGGraphics2D driver from <a href="http://xmlgraphics.apache.org/batik/">Apache Batik</a> <br><br><h4>  MS Word to .doc, xsl-fo and text converters .doc </h4><br>  This functionality was already <a href="http://habrahabr.ru/post/127361/">mentioned</a> on Habr√©, therefore I will note only the main thing: <br><br><ul><li>  Word-to-HTML Converter, which converts a Word document to HTML, can even be with pictures; </li><li>  Word-to-Text Converter, which is a replacement for the past WordExtractor, correctly processing <br>  embedded OLE-documents, splitting into paragraphs, field codes (including hyperlinks); </li><li>  A Word-to-FO Converter that converts a Word document to an XSL FO file is also possible with pictures. <br>  Then this file can be transferred to <a href="http://xmlgraphics.apache.org/fop/">Apache FOP</a> for conversion to convert Word to PDF. </li></ul><br><br><h4>  Bugfixes, bugfixes and even more bugfixes .... </h4><br>  <a href="http://poi.apache.org/changes.html">Much</a> work has been done to improve the stability of the library as a whole. <br>  - more than 250 changes from the previous version 3.7.  First of all it concerns the readability of documents. <br>  Bug-reports of the form "POI does not read my file and crashes c exception" is already a rarity and, I hope, will soon disappear completely :) <br><br>  Have you found a bug or want to share ideas on how to improve the project?  Visit us at <a href="http://poi.apache.org/">http://poi.apache.org/</a> , subscribe to the mailing lists and send <br>  patches in bagzilu.  You are always welcome! </div><p>Source: <a href="https://habr.com/ru/post/140898/">https://habr.com/ru/post/140898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140891/index.html">Exploring ways to attract software to the site</a></li>
<li><a href="../140893/index.html">Redis in production</a></li>
<li><a href="../140895/index.html">"Multilinearity" IP phone - why is it?</a></li>
<li><a href="../140896/index.html">GamaK - competition for game developers</a></li>
<li><a href="../140897/index.html">Report from the conference BlackHat EU 2012</a></li>
<li><a href="../140899/index.html">C ++ objects and QML, all by shelves</a></li>
<li><a href="../140900/index.html">BB-Mobile MicrON-1 headset</a></li>
<li><a href="../140901/index.html">Several alternative options for integrating the site with 1C</a></li>
<li><a href="../140902/index.html">Microsoft crossed SPDY and WebSockets</a></li>
<li><a href="../140903/index.html">Knowledge management, knowledge base creation. And what in practice?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>