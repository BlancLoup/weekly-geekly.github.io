<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using Zend GData in a symfony2 project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The lead developer of the Symfony framework, Fabien Potencier, in 2009, spoke at the Zend / PHP Conference with a report on how to benefit from sharin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using Zend GData in a symfony2 project</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage1/d235e887/abd3ba7e/765f046b/dfb21c13.jpg"><br><br>  The lead developer of the Symfony framework, Fabien Potencier, in 2009, spoke at the Zend / PHP Conference with a report on how to benefit from sharing Symfony 1.3 / 1.4 and Zend Framework.  The main theses of his speech are available <a href="http://fabien.potencier.org/media/talk/2009/symfony-and-zend-framework-together-2009.pdf">in the presentation</a> published on his personal website [1]. <br><br>  As you know, Symfony2 is almost a new framework, created using the latest features of the PHP language.  At the moment, the development went into the RC-cycle, and more and more developers with experience on the first branch of Symfony (and not only them) are looking towards the new flagship.  But, despite the significant number of components included in the standard edition, Symfony2 does not cover all the needs of a web developer, therefore, sooner or later, the question arises of connecting external libraries. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Obviously, in this light, the extensive set of Zend libraries (Gdata, Search_Lucene, Pdf, etc.) cannot be ignored.  In this post, I will look at the process of integrating Symfony2 and Zend using the example of Zend Gdata, a library for interacting with the <a href="http://code.google.com/apis/gdata/index.html">Google Data API</a> [2]. <br><br><a name="habracut"></a><br><h2>  Briefly about installing symfony2 </h2><br><br>  As stated in the README of the standard symfony2 distribution, developers no longer recommend using git, offering to download the archive from the official site instead.  At the time of writing the latest version of the post - RC4.  All of the following will work in earlier versions with some reservations, because a significant refactoring was made in Command that affected the names of classes, and code generators appeared.  I prefer to download the archive without vendors (without vendors), because when using GIT, the vendors directory <a href="http://symfony.com/doc/current/book/installation.html">will be added to .gitignore anyway</a> [3]. <br><br>  For development, the Apache and PHP 5.3.2 web server (and above) is sufficient.  Detailed requirements are detailed in the <a href="http://symfony.com/doc/current/reference/requirements.html">documentation</a> [4]. <br><br><h2>  Integration of Zend Gdata into the project </h2><br><br>  At the decision presented in this article, I was prompted by the presentation of Fabien, which was already mentioned above.  On the Internet, you can find quite insane solutions, like processing a Zend distribution with regular expressions.  I would be glad to hear other suggestions in the comments.  There is also a <a href="http://stackoverflow.com/questions/6235783/how-to-use-zend-gdata-in-a-symfony2-project">discussion on stackoverflow</a> [5]. <br><br>  Since making any changes to the distribution library of the plug-in library can lead to difficulties in updating (and generally considered bad form), and binding to server environment variables restricts the developer, the proposed solution uses only standard Symfony2 and php tools. <br><br>  First, follow the Zend Framework website and download <a href="http://framework.zend.com/download/gdata">the Gdata distribution</a> [6]. <br><br>  Create the following directory structure in the project: <br><br> <code>vendor/ <br> -&gt; zend/ <br> --&gt; lib/ <br> ---&gt; Zend/ <br> ----&gt; [Zend directory from Zend GData package] <br> --&gt; README <br> --&gt; LICENSE <br></code> <br><br>  The README and LICENSE files are copied from the Zend GData distribution.  Register the 'Zend_' prefix in app / autoload.php: <br><br><pre> <code class="php hljs"> $loader-&gt;registerPrefixes(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-comment"><span class="hljs-comment">// ...  ,   Twig  Twig_Extensions 'Zend_' =&gt; __DIR__.'/../vendor/zend/lib', ));</span></span></code> </pre><br><br>  Next, add to the end of the file (by analogy with Swift Mailer) the code from the Fabien presentation: <br><br><pre> <code class="php hljs"> <span class="hljs-comment"><span class="hljs-comment">// Zend Framework GData needs a special autoload fix too set_include_path(__DIR__.'/../vendor/zend/lib'.PATH_SEPARATOR.get_include_path());</span></span></code> </pre><br><br>  Now the classes included in Zend GData will be determined by the Symfony2 boot loader by the 'Zend_' prefix and all the numerous unlinked require in the Gdata distribution will work correctly, thanks to the changed include_path.  It is possible that on loaded servers it would be reasonable to specify the value of include_path in php.ini. <br><br><h2>  Services </h2><br><br>  Quoting a <a href="http://symfony.com/doc/current/glossary.html">glossary of Symfony2</a> [7], a <i>service</i> is a generic term for any PHP objects that perform any task used globally.  Examples include a database connection or an object sending emails. <br><br>  Based on this definition, it is easy enough to understand that, in our case, Zend_Gdata is a service. <br><br>  Next, we will develop a console command that, using the Google GData API service, will upload blog posts from blogspot.com to the database. <br><br>  First, create the GdataTestBundle bundle.  Now that the code generator has appeared, this is done very simply: <br><br><pre> <code class="bash hljs"> $ php app/console generate:bundle --namespace=Habr/GDataBundle --format=yml</code> </pre><br><br>  Now, add the following lines to the src / Habr / GDataBundle / Resources / config / services.yml configuration file (you must replace ~ in the lines marked with comments with real data to access the blog on blogger): <br><br><pre> <code class="hljs scala"> parameters: gdata.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>: <span class="hljs-type"><span class="hljs-type">Zend_Gdata</span></span> gdata.http_client.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>: <span class="hljs-type"><span class="hljs-type">Zend_Gdata_HttpClient</span></span> gdata.http_client_factory.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>: <span class="hljs-type"><span class="hljs-type">Zend_Gdata_ClientLogin</span></span> gdata.username: ~ # &lt;email_address<span class="hljs-meta"><span class="hljs-meta">@gmail</span></span>.com&gt; gdata.password: ~ # &lt;password&gt; gdata.blog_id: ~ # &lt;blog <span class="hljs-type"><span class="hljs-type">ID</span></span>&gt; gdata.service_name: blogger services: gdata_http_client: <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>: %gdata.http_client.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>% factory_class: %gdata.http_client_factory.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>% factory_method: getHttpClient arguments: - %gdata.username% - %gdata.password% - %gdata.service_name% gdata: <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>: %gdata.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>% arguments: [<span class="hljs-meta"><span class="hljs-meta">@gdata</span></span>_http_client]</code> </pre><br><br>  Let us dwell on the contents of this configuration file.  Symfony2 provides many ways to initialize services and resolve dependencies.  In the simplest case, based on the class name specified in the configuration, an object is created that is returned to the client code using the get () method from the ContainerInterface interface.  In reality, objects have complex dependencies among themselves and, often, the initialization of one service requires an instance of another, passed as an argument to the constructor.  This case can be observed above for the gdata service. <br><br>  Of much greater interest is the initialization of Zend_Gdata_HttpClient - an instance of an object of this class is created by calling the static method of the factory class (Zend_Gdata_ClientLogin), which is also passed arguments.  More details about using factory classes to initialize services are described in the <a href="http://symfony.com/doc/current/cookbook/service_container/factories.html">special chapter of the Symfony Cookbook</a> [8]. <br>  We will be able to test the resulting configuration when we create a console command using the service defined by us. <br><br><h2>  Model </h2><br><br>  Let's create a simple model for storing records uploaded from Blogger.com, which will also be helped by the built-in generator (if you don‚Äôt want to make your own changes to the model configuration, you can press enter on all subsequent questions interactively): <br><br><pre> <code class="bash hljs"> $ php app/console doctrine:generate:entity --entity=<span class="hljs-string"><span class="hljs-string">"HabrGDataBundle:Post"</span></span> --fields=<span class="hljs-string"><span class="hljs-string">"title:string(255) content:text remote_id:string(255) created_at:datetime"</span></span></code> </pre><br><br>  Now in the src / Habr / GDataBundle / Entity directory there is a generated Blog.php file, in which all necessary getters and setters are present.  Further, to reflect the changes made at the DBMS level, we need to first configure the connection to the database. <br><br>  To use MySQL, you need to change the corresponding part of app / config / parameters.ini as follows, using connection settings specific to you: <br><br><pre> <code class="hljs cs"> [<span class="hljs-meta"><span class="hljs-meta">parameters</span></span>] ; ... database_driver = pdo_mysql database_host = localhost database_name = habr database_user = root database_password = ; ‚Ä¶</code> </pre><br><br>  The next step is to create a database: <br><br><pre> <code class="bash hljs"> $ php app/console doctrine:database:create</code> </pre><br><br>  After we create tables based on models: <br><pre> <code class="bash hljs"> $ php app/console doctrine:schema:update --force</code> </pre><br><br>  You can check the result of the command in phpmyadmin or any other client for the database you are using. <br><br><h2>  Team </h2><br>  The entity that was called ‚Äútask‚Äù (task) in symfony 1.4 became a command in symfony2.  In the current release, there is not yet a generator for commands, therefore, inside the root directory of the bundle, manually create a Command sub-directory where we put the file FetchFeedCommand.php (the Command suffix is ‚Äã‚Äãrequired).  <a href="http://symfony.com/doc/current/cookbook/console.html">The implementation of commands</a> [9] (like most of the components of symfony2) is very simple, so I only provide source code with comments: <br><br><pre> <code class="php hljs"> <span class="hljs-comment"><span class="hljs-comment">// FetchFeedCommand.php </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?php</span></span></span><span class="hljs-comment"> namespace Habr\GDataBundle\Command; use Symfony\Bundle\FrameworkBundle\Command\ContainerAwareCommand; use Symfony\Component\Console\Input\InputDefinition; use Symfony\Component\Console\Input\InputOption; use Symfony\Component\Console\Input\InputArgument; use Symfony\Component\Console\Input\InputInterface; use Symfony\Component\Console\Output\OutputInterface; use Habr\GDataBundle\Entity\Post; /** * FetchFeedCommand * @author temochka &lt;http://temochka.habrahabr.ru&gt; * @package HabrGDataBundle * @subpackage command * @version 0.1 */ class FetchFeedCommand extends ContainerAwareCommand { /** *   */ protected function configure() { $this-&gt;setName('gdata:blogger:fetch-feed'); } /** * * @param InputInterface $input * @param OutputInterface $output */ protected function execute(InputInterface $input, OutputInterface $output) { //    gdata ( Zend_Gdata) $gdClient = $this-&gt;getContainer()-&gt;get('gdata'); //    $blogID = $this-&gt;getContainer()-&gt;getParameter('gdata.blog_id'); //    API $query = new \Zend_Gdata_Query('http://www.blogger.com/feeds/' . $blogID . '/posts/default'); $feed = $gdClient-&gt;getFeed($query); //   EntityManager'   doctrine $em = $this-&gt;getContainer()-&gt;get('doctrine')-&gt;getEntityManager(); foreach($feed-&gt;entries as $entry) { //   $post = new Post; $post-&gt;setTitle($entry-&gt;title-&gt;text); $post-&gt;setRemoteId($entry-&gt;id); $post-&gt;setContent($entry-&gt;content); $post-&gt;setCreatedAt(new \DateTime($entry-&gt;published-&gt;text)); $em-&gt;persist($post); $output-&gt;writeln(sprintf("\tNew post %s has been added.\n", $entry-&gt;title-&gt;text)); } //     $em-&gt;flush(); } }</span></span></code> </pre><br><br>  Now you can run the command by passing ./app/console its name, which is defined in the call to setName. <br><pre> <code class="bash hljs"> $ ./app/console gdata:blogger:fetch-feed</code> </pre><br><br>  The result should be all blog entries in the database post table. <br><br><h2>  Conclusion </h2><br><br>  This example is somewhat synthetic, since authentication is not required to obtain an open feed of posts from Blogger.com.  Those who want to practice and gain additional experience with Symfony2 can implement adding or deleting a new blog entry themselves.  The link to the detailed documentation has already been given above. <br><br>  In general, I want to add that now Symfony2 has already grown from the status of "impressive, but unstable thing."  The framework is ready for serious projects. <br>  PS I thank everyone who helped in the publication of this post. <br><br><h2>  Links </h2><br><ol><li>  <a href="http://fabien.potencier.org/media/talk/2009/symfony-and-zend-framework-together-2009.pdf">Symfony &amp; Zend Framework Together - 2009</a> </li><li>  <a href="http://code.google.com/apis/gdata/index.html">GData API</a> </li><li>  <a href="http://symfony.com/doc/current/book/installation.html">Ignoring the vendor directory</a> </li><li>  <a href="http://symfony.com/doc/current/reference/requirements.html">Requirements for running symfony2</a> </li><li>  <a href="http://stackoverflow.com/questions/6235783/how-to-use-zend-gdata-in-a-symfony2-project">Question about using Zend_GData in Symfony2 on Stackoverflow</a> </li><li>  <a href="http://framework.zend.com/download/gdata">Zend GData download page</a> </li><li>  <a href="http://symfony.com/doc/current/glossary.html">Symfony2 glossy</a> </li><li>  <a href="http://symfony.com/doc/current/cookbook/service_container/factories.html">How to Use Services</a> </li><li>  <a href="http://symfony.com/doc/current/cookbook/console.html">How to create Console / Command-Line Commands</a> </li></ol><br></div><p>Source: <a href="https://habr.com/ru/post/124266/">https://habr.com/ru/post/124266/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../124261/index.html">Brand reversion</a></li>
<li><a href="../124262/index.html">Where to get capital to budding entrepreneurs</a></li>
<li><a href="../124263/index.html">Automatic installation of FreeBSD 8.2-RELEASE on ZFS</a></li>
<li><a href="../124264/index.html">Mail-en agent in Linux</a></li>
<li><a href="../124265/index.html">Microsoft opened its social service?</a></li>
<li><a href="../124267/index.html">XSS vulnerability in Skype</a></li>
<li><a href="../124268/index.html">Smart switches based on the 8051 core, controlled by Ethernet, Part 1</a></li>
<li><a href="../124269/index.html">In the information systems of the Presidential Administration of the Russian Federation do not accept odf</a></li>
<li><a href="../124270/index.html">Haskell in the present project</a></li>
<li><a href="../124271/index.html">Parallel generation of plt files for Dialyzer (with depes and buns)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>