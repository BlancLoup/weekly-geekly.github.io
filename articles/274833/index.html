<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create a hardware random number generator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to bring to your attention the hardware and software version of obtaining random numbers. Looking ahead, I will say that this option is not the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create a hardware random number generator</h1><div class="post__text post__text-html js-mediator-article">  I want to bring to your attention the hardware and software version of obtaining random numbers.  Looking ahead, I will say that this option is not the only one, and this post opens up my small series of articles on getting, generating and studying random numbers, or, more precisely, just accidents. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/d30/3d5/b32/d303d5b32b669b8246d73b1a361f267b.jpg"><br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The magic of random numbers attracted me from early childhood.  Date of birth, death, giftedness, winning the lottery, exam ticket, etc. are all random events.  On the other hand, looking at our world, you understand that there are no coincidences.  Or, as scientists say: Accident is not a studied pattern.  I was always wondering why this particular event is coming, and not another?  Why is the coin, thrown now, fell headlong, and whether something can affect this event?  What are the mutual influences of randomness on each other, can we influence these random variables?  All these questions are still beyond science, but it is interesting to find the answer to them.  Unfortunately, at the institute, I did not appreciate the subject ‚ÄúTheory of Probability‚Äù well enough and just passed it, for which I received a minus of life karma.  By this, today I try my best to catch up. <br><br><h4>  Formulation of the problem </h4><br><br>  For various engineering and computational problems requires the search for random numbers.  Moreover, the higher the entropy of the number, the lower its regularity and predictability, the better.  We all used in programming the function of the generator of random numbers.  In fact, all these numbers are pseudo-random.  They can be calculated using a very complex algorithm, or even be a ‚Äúcast‚Äù of random system noise (such as <i>/ dev / random</i> and <i>/ dev / urandom</i> ).  Yet, oddly enough, these random numbers are predictable.  The most obvious way to get random numbers is to take them from the outside.  After all, our real world is a huge random variable generator.  Of course, all these quantities are also pseudo-random, but their patterns and interdependencies cannot be traced, due to the infinite number of variants of the events taking place.  It should also be understood that one cannot consider random numbers as numbers appearing in a closed system, since they are influenced by an infinite number of external factors.  Then, if you look, each event is completely non-random and has its own pattern.  It is impossible to simply take into account all the mutual influences (and there are infinitely many); therefore, for simplicity, many events are taken as random. <br><br>  The easiest way to get random numbers is to remove noise from a computer sound card.  With that, the worse the sound card, the better it makes noise.  As an additional source of noise, optionally, you can connect any radio tuned to noise to the line input of the sound card. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/cf0/bc0/9f5/cf0bc09f5d4be8fae2e8a6cac3d70df5.jpg">  <b>+</b> <img src="https://habrastorage.org/getpro/geektimes/post_images/829/7c3/edf/8297c3edf0dcfd836a1f248baae0bc7e.jpg">  <b>+ Sound card = Random generator</b> <br><br>  By the way, thermal noise in semiconductors, due to the thermal motion of atoms, is the most common source of random numbers, for example, when generating keys in SMART cards. <br><br>  True, I want to note that there are known cases of hacking of devices with built-in encryption (SMART cards), which use the principle of thermal noise in semiconductors to generate random numbers.  Hacking is quite simple - freezing in the liquid nitrogen of the chip itself, as a result of which the thermal noise drops to almost zero. <br><br><h4>  The histogram of the frequency of the number of observations of a random variable </h4><br><br>  Random variables oscillate around a single value (the expectation of this value).  We put, we remove a few thousand random points, find the maximum and minimum value, which takes a random variable.  Take the interval from the minimum value that a random variable takes to the maximum value that a random variable can take.  We divide this interval into equal intervals, for example, fifty.  Ololo pysch-pysch, no one reads.  And we calculate how many random variables fall into each interval, then we get a diagram of the distribution of a random variable.  It must be said, the magnitude of the scattering of a random event is determined, and it is measured by dispersion.  This method of constructing a scatterplot of a random variable is called interval.  It is based on splitting the original numerical values ‚Äã‚Äãinto intervals. <br>  If we imagine what a distribution is on our fingers, then it‚Äôs like we pour sand from a palm, in accordance with the change of the signal along the vertical axis. <br>  I will illustrate with an example.  Pendulum oscillations.  If we expand it in time, we get a sinusoid <i>f (x) = sin (x)</i> - this is the original graph, the distribution of which we are looking for.  If we add a salt shaker to this pendulum, which pours sand, then it will draw a distribution diagram.  Let's demonstrate how it looks. <br><br>  An example of a piece of code to build: <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { y=<span class="hljs-number"><span class="hljs-number">512</span></span>*<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(x)+<span class="hljs-number"><span class="hljs-number">512</span></span>; count=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n;i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( y&lt;count+deltay &amp;&amp; y &gt;=count) { a[i]=a[i]+<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } count=count+deltay; } x=x+deltax; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (x&lt;<span class="hljs-number"><span class="hljs-number">200</span></span>*<span class="hljs-number"><span class="hljs-number">3.14159265</span></span>);</code> </pre> <br><br>  And the graph <i>f (i) = a [i]</i> <br><br><img src="http://img-fotki.yandex.ru/get/5820/74270808.9/0_7af5a_c137a25a_XL.jpg"><br>  <b>Graph of the "distribution" of the sine.</b> <br><br>  If we talk about the salt shaker on the pendulum, it becomes clear why such a schedule has turned out.  At the highest point of the oscillation of the pendulum, which corresponds to the peaks of the sinusoid, the movement slows down and there the sand should form a "hill", and at the point of zero there should be a minimum amount of sand, because  This place the pendulum passes with a maximum speed. <br><br><h5>  Gaussian distribution or normal </h5><br><br>  This is best demonstrated in this video, using the Galton board <a href="http://ru.wikipedia.org/wiki/%25D0%2594%25D0%25BE%25D1%2581%25D0%25BA%25D0%25B0_%25D0%2593%25D0%25B0%25D0%25BB%25D1%258C%25D1%2582%25D0%25BE%25D0%25BD%25D0%25B0">ru.wikipedia.org/wiki/Doska_Galtona</a> , taken from the MEPhI lecture course <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/GANHXlMpVMc%3Ffeature%3Doembed&amp;xid=25657,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjvx29MugViUXMhgknW3JPq14gzCA" frameborder="0" allowfullscreen=""></iframe><br><br>  My institute also had a similar experience, and the teacher made a sacred phrase that made a big impression on me: I have been spending this experience for fifty years, and always get the same picture.  Formally, nothing prevents particles from lying down evenly, but we always get a Gaussian distribution. <br><br>  The Gauss distribution is subject to various quantities.  For example, shooting at a target - bullets will fall in the target for the Gauss distribution.  The most heap in the tens and least around the edges.  Of course, electrical noise (if it is not caused by interference from the electrical network) will also obey this distribution. <br><br><h5>  Poisson distribution </h5><br><br>  There are other types of random variable distributions.  For example, there is a Poisson distribution.  One of the features of the Poisson distribution is that the random variable is discrete.  The best illustration of the events of the Poisson distribution can be calls to any call-center.  The number of calls received per unit of time will be a random variable.  Or, while I was debugging a program, which I‚Äôll talk about below, I measured the intervals for pressing a key.  The intervals were measured by a microcontroller, counting the past number of cycles between each keystroke.  I did a few thousand clicks and got just such a chart. <br><br><img src="http://img-fotki.yandex.ru/get/5413/74270808.9/0_7af56_68d2377f_XL.jpg"><br>  <b>Chart of distribution of frequency of pressing the button.</b> <br><br>  By the way, I knowingly said that there are no random variables.  Here I press a button with my finger.  The randomness of the intervals of pressing is due to the fact that my brain is engaged in processing various signals, dreams of the "eternal", thoughts about the program, etc.  Plus, the signals from the brain reach the limbs also not at the speed of light, because  Ion exchange during signal transmission is caused by chemical processes in my body, etc.  etc.  As a result, we have a completely random intensity of clicks. <br><br>  It should be noted that the registration of radioactive particles using dosimeters is also subject to the Poisson distribution. <br><br><h5>  Uniform distribution </h5><br><br>  The most valuable distribution, from the programmer's point of view, is the uniform distribution.  When random numbers are of any length, they are found equally often on the entire given range.  An example from the life of such a distribution is the waiting time of transport at a bus stop, taking into account the fact that the transport runs at the same time intervals.  You can come and immediately sit in a minibus, then your waiting time will be zero, or this minibus will go right from under your nose.  Then your waiting time will be equal to the interval of minibuses.  But, as a rule, you have to wait.  And if we divide the waiting time into intervals dt and construct a histogram of the frequencies of hitting the minibus, say for several years, then it will be a line. <br><br><img src="http://img-fotki.yandex.ru/get/4418/74270808.9/0_7af54_a1c2305a_L.jpg"><br>  <b>The histogram of the frequencies of hitting your bus.</b> <br><br>  Vertically, the number of hits on a minibus was postponed, and horizontally, the waiting time for a minibus. <br><br>  For example, a histogram of the distribution of data received by / dev / random <br><br><img src="http://img-fotki.yandex.ru/get/4614/74270808.9/0_7af59_dea638c7_XL.jpg"><br>  <b>Histogram of the system random number generator</b> <br><br>  You can get this histogram yourself by replacing <i>/ dev / audio (/ dev / dsp)</i> with <i>/ dev / random</i> in my program (which we will discuss below <i>)</i> (initialization of the sound card does not affect the random number generator). <br>  It should be noted that I have restarted the program 15 times in order to get the histogram closest to the theoretical one.  This indicates the imperfection of this random number generator.  The blue line shows how this histogram should look ideally. <br><br>  Other types of distributions can be found in this figure. <br><br><img src="http://img-fotki.yandex.ru/get/4418/74270808.9/0_7af52_78735d91_XL.jpg"><br>  <b>The main types of distribution of random variables.</b> <br><br>  Taken from <a href="http://www.ievbras.ru/ecostat/Kiril/Library/Book1/Content350/Content351.htm">www.ievbras.ru/ecostat/Kiril/Library/Book1/Content350/Content351.htm</a> . <br><br><h4>  Less words and more deeds </h4><br><br>  Probably, I already managed to get bored with my amateur terver.  By this, we move from theory to practice.  My program is written under Linux, and tested on <b>Ubuntu 10.10</b> .  To build diagrams, the gnuplot package must be installed on the system; without it, the program will not work. <br>  By the way, I strongly recommend that all engineers deal with the cross-platform software package gnuplot.  This is the perfect package for building any graphs.  After working with him, I forgot what plotting in MS Excel is like a bad dream.  A day or two to figure out, and then at the laboratories at the institute or at work, you will delight yourself and others with original high-quality graphics.  The undoubted plus that this package can be used in programs for quick and easy graphing. <br>  I‚Äôll not dwell on this story about gnuplot, how did I build graphs.  It is better to write a separate post on this wonderful package. <br><br>  So what does my program do?  She within three seconds <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> LENGTH 3 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* how many seconds of speech to store */</span></span></span></span></code> </pre> <br><br>  With a sampling rate of 96,000 Hz <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> RATE 96000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* the sampling rate */</span></span></span></span></code> </pre> <br><br>  Writes data type signed short <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SIZE 16 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* sample size: 8 or 16 bits */</span></span></span></span></code> </pre> <br><br>  From one sound card input channel <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CHANNELS 1 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* 1 = mono 2 = stereo */</span></span></span></span></code> </pre> <br><br>  Data is saved to an array. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">short</span></span> buf[LENGTH*RATE*SIZE*CHANNELS/<span class="hljs-number"><span class="hljs-number">16</span></span>];</code> </pre> <br><br>  Then the sound card is initialized, and data is read for three seconds.  I honestly admit that I didn‚Äôt explore all the features of working with a sound card.  I did not try to read in stereo mode, to accept 24-bit data.  I tried to change only the sampling rate.  I also want to say that receiving data from a sound card is not always stable.  After rebooting the system, I restart this program several times to get a histogram.  Sometimes it produces completely incomprehensible values.  With what it is connected, I also do not know. <br>  After initializing the sound and reading all the data in the buf array, we find the minimum and maximum values ‚Äã‚Äãof the array.  After that, the non-sorted array is stored in array.dat (from which you can then build an oscillogram of the data to be removed).  Next, the array is sorted by the function <br><br><pre> <code class="cpp hljs">quickSortR(buf, lbuf);</code> </pre><br><br>  For debugging, the sorted array is saved to the error.log file. <br><br>  Next we find the delta - the interval of the cell in which we will add our values: <br><pre> <code class="cpp hljs">deltay=(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span>)((max-min)/n_rasp+<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br>  Allocate memory for the distribution array.  Memory allocation is made for versatility so that you can dynamically change the size of the distribution. <br><br><pre> <code class="cpp hljs">rasp = (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> *)(<span class="hljs-built_in"><span class="hljs-built_in">malloc</span></span>(n_rasp*<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)));</code> </pre> <br><br>  After that, we start to consider what values ‚Äã‚Äãfell into which interval, or in other words, build a distribution of random variables: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n;i++) { count=min; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">0</span></span>;j&lt;n_rasp;j++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((buf[i] &gt;=count) &amp;&amp; (buf[i]&lt;=count+deltay)) { rasp[j]++; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } count=count+deltay; } }</code> </pre><br>  Already on this graph, you can build a diagram of the distribution of a random variable.  But I want to compare the practical distribution with the theoretical schedule of the Normal distribution, which is based on the formula taken from Wikipedia <a href="http://ru.wikipedia.org/wiki/%25D0%259D%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">ru.wikipedia.org/wiki/Normal_distribution</a> : <br><br><img src="http://img-fotki.yandex.ru/get/4614/74270808.9/0_7af50_b4db7f6f_L.jpg"><br><br>  To build on this formula, we need to find two parameters: Expectation and variance.  As I said, mathematical expectation is a quantity around which random numbers fluctuate.  Dispersion is a measure of dispersion.  There are two ways to find these values ‚Äã‚Äã- from the original array and from the resulting diagram.  I find the mathematical expectation in two ways, but using the latter, I find the variance only in the last way. <br>  The mathematical expectation in our case is simply the average of all random variables.  We find it so <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n_rasp;i++) { summall=rasp[i]+summall; math_f+=rasp[i]*i; } <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"math_f = %3.5f sumall=%d\n"</span></span>,math_f,summall); math_f=math_f/summall; <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"  2 = %3.5f\n"</span></span>,math_f);</code> </pre><br><br>  Variance is defined as the square deviation of a random variable from the expectation.  We find it as follows: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n_rasp;i++) { dispers+=((<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)(i)-math_f)*((<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)(i)-math_f)*(rasp[i]); } dispers=dispers/summall; <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"  = %4.5Lf\n"</span></span>,dispers); ... <span class="hljs-comment"><span class="hljs-comment">//       for (i=0;i&lt;n_rasp;i++) { gausse=(long double)summall*exp(-((i-math_f)*(i-math_f))/(2*dispers))/(sqrt(2*3.14159265*dispers)); fprintf(logf, "%3ld %5d %+07.5Lf (%10d;%10d]\n",i,rasp[i], gausse ,dat, dat+deltay); //write to file } .... //         : gnuplot(outputfile, 0, 0); gnuplot("dat/array.dat", 1, 0);</span></span></code> </pre><br><br>  Here: <br><br>  <i>gausse = (long double) summall * exp (- ((i-math_f) * (i-math_f)) / (2 * dispers)) / (sqrt (2 * 3.14159265 * dispers));</i> <br><br>  This is the calculation of the Gaussian distribution, using the expectation and variance. <br><br>  The resulting program can be downloaded here: <a href="http://narod.ru/disk/32347266001/sound_distribution.tar.gz.html">narod.ru/disk/32347266001/sound_distribution.tar.gz.html</a> <br>  After we compile the program with the <i>make</i> command. <br><br>  For proper operation of the program you need to configure the sound card.  In Ubunt, this is done like this: <i>System-&gt;</i> Options- <i>&gt; Sound</i> .  Select the microphone input, set the volume to maximum and remove the checkbox ‚ÄúTurn off‚Äù.  Optionally, you can connect a radio receiver to the line input of the sound card, then instead of the microphone input you can use the line input. <br>  One note - the microphone must be disconnected from the sound card input.  They say that throwing the microphone input is not worth it, so in principle it is possible to shunt (for those who wish) its resistance equal to the resistance of the microphone. <br><br>  So, run the program "./sound_distribution" and admire the result after 3-4 seconds. <br><br><img src="http://img-fotki.yandex.ru/get/4714/74270808.9/0_7af4e_b346a48e_XL.jpg"><br>  <b>Histogram of the values ‚Äã‚Äãobtained</b> <br><br><img src="http://img-fotki.yandex.ru/get/4714/74270808.9/0_7af4f_4b3654f0_XL.jpg"><br>  <b>Oscillogram of the obtained values ‚Äã‚Äãfrom the microphone input.</b> <br><br>  The histogram turned out so successful that it can be inserted as an illustration in any textbook on the terver, although these are completely empirical values. <br><br><h4>  Practical application </h4><br><br>  As I have already described, the programmer needs numbers that are evenly distributed.  In this case, we have a normal distribution, where the number fluctuates around the expectation.  To get the numbers we need, we must take the lower four bits of the number.  These four bits will take a completely random value.  And these four bits are laid in the number of the required length.  For example, in order to fill a short number (2 bytes), we will need 4 numbers taken from the sound card, or rather their low-order bits.  Here is a sample code: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">short</span></span> random_num=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=n; i&lt;n+<span class="hljs-number"><span class="hljs-number">4</span></span>; i++) { random_num&lt;&lt;= <span class="hljs-number"><span class="hljs-number">4</span></span>; random_num+=buf[i]&amp;<span class="hljs-number"><span class="hljs-number">0x0F</span></span>; }</code> </pre><br><br>  Homework will be done so that the number can be generated in a given range and for different types of data.  Well, so is the construction of the distribution for these random numbers :). <br><br><h4>  Future plans </h4><br><br>  For the future, I wanted to make a program on <i>GTK +</i> so that the sliders can change the width of the intervals, the sampling rate, the amount of data received, the input data, etc. But alas, I have broken off my teeth for now.  I made only the oscillogram graph of the received signal, riveting it from several programs.  In this matter, I will be very grateful for all possible assistance. <br>  Alternatively, you can put a stationary receiver, put a second sound card, purely for a random number generator.  Write a daemon or driver that would have some sort of random data file, like / dev / random, from which data can be read.  In general, the applications of mass. <br><br><h4>  Notes and conclusions </h4><br><br>  I must say that the generation of random numbers in this way is relatively slow.  It slows down the speed of reading data from a sound card.  But in some, not critical to the speed of execution, tasks, it will be the most. <br><br>  In fact, obtaining random numbers from a sound card was a by-product of my personal little research, and in this case, serves me only for running in of my modest algorithms and data visualization. <br><br>  My program saves three files: <br>  array.dat - This is just the raw data of the captured array. <br>  error.log - this file was supposed (as the name implies) to save errors, but for the time being it is used to save an ordered array.  Which, in general, served me for debugging. <br>  sounddist.dat - The output file itself.  In the first column, the ordinal number of the column of the diagram, the second column is the value of the relative frequencies, the third is the Gaussian distribution calculated by the standard formula, the fourth is the range of values ‚Äã‚Äãthat fall into this column of the diagram. <br><br>  <s>I don't know why, but #define stopped working in this program.</s>  <s>Attempting to initialize a variable using define results in an error.</s>  <s>For example, if you replace: ‚Äúarg = 16;‚Äù (line 83) with ‚Äúarg = SIZE;‚Äù (comment out line 83 and uncomment line 79), the compiler will generate an error:</s> <s><br><br></s>  <s><i>sound_distribution.c: In function 'main':</i></s> <s><i><br></i></s>  <s><i>sound_distribution.c: 81: error: stray '\ 321' in program</i></s> <s><i><br></i></s>  <s><i>sound_distribution.c: 81: error: stray '\ 216' in program</i></s> <s><i><br></i></s>  <s><i>make: *** [sound_distribution] Error 1</i></s> <s><br><br></s>  <s>The funny thing is that in the original program, the initialization of variables goes through defines.</s>  <s>The lack of defaults makes the code not very convenient for editing, but a brief googling did not give an answer to this problem.</s> <br><br>  Error found and fixed, thanks <a href="http://geektimes.ru/users/galaxy/" class="user_link">galaxy</a> <br><br>  As a conclusion, I want to say that the hardware random number generator is very easy to get; you just have to look around :). <br><br>  I will appreciate any constructive criticism, ranging from the style of writing programs, ending with algorithms.  I would also be grateful for any feasible assistance in the continuation of the project on GTK +. <br><br>  I also want to say that this post is not the last on this topic. <br><br><h4>  Bibliography </h4><br><br>  1. <a href="http://ru.wikipedia.org/wiki/%25D0%259D%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">ru.wikipedia.org/wiki/Normal_distribution</a> <br>  2. <a href="http://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D1%2581%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%259F%25D1%2583%25D0%25B0%25D1%2581%25D1%2581%25D0%25BE%25D0%25BD%25D0%25B0">en.wikipedia.org/wiki/ Distribution_ Poisson</a> <br>  3. <a href="http://tegir.ru/ml/k66.html">tegir.ru/ml/k66.html</a> hardware random number generator. <br>  4. <a href="http://www.mtu-net.ru/aborovsky/articles/linsnd1.htm">www.mtu-net.ru/aborovsky/articles/linsnd1.htm</a> Sound Programming in Linux (rus) <br>  5. <a href="http://www.oreilly.de/catalog/multilinux/excerpt/ch14-05.htm">www.oreilly.de/catalog/multilinux/excerpt/ch14-05.htm</a> example of the Linux audio program that is used in my program. <br><br>  Added: <br>  6. N.S.  Markin "Fundamentals of the theory of processing measurement results" <br>  7. <a href="http://habrahabr.ru/blogs/python/62237/">habrahabr.ru/blogs/python/62237</a> Random numbers from a sound card <br><br>  The bibliography will still be supplemented and expanded, because now I don‚Äôt have all those books that I used when writing the program, understanding the server and writing this post. </div><p>Source: <a href="https://habr.com/ru/post/274833/">https://habr.com/ru/post/274833/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274821/index.html">How to predict a stock price: An adaptive filtering algorithm</a></li>
<li><a href="../274825/index.html">Algorithm Deflate for example PNG format</a></li>
<li><a href="../274827/index.html">Alternative memory allocators</a></li>
<li><a href="../274829/index.html">Take a step to the FPGA</a></li>
<li><a href="../274831/index.html">E-book as a display</a></li>
<li><a href="../274835/index.html">Create a hardware keyboard logger</a></li>
<li><a href="../274837/index.html">Installing Quartus II Web Edition for Linux</a></li>
<li><a href="../274839/index.html">MIPSfpga: outside of canon</a></li>
<li><a href="../274841/index.html">Minesweeper on FPGA</a></li>
<li><a href="../274843/index.html">‚ÄúStupid‚Äù watches on FPGA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>