<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reliable communication when using the Yota Street modem</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In a country house, I also want to have high-quality and fast Internet access. 

 Unfortunately, wired Internet in the country is not always possible ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Reliable communication when using the Yota Street modem</h1><div class="post__text post__text-html js-mediator-article">  In a country house, I also want to have high-quality and fast Internet access. <br><br>  Unfortunately, wired Internet in the country is not always possible due to the absence of wires (telephone and / or network from an Internet provider).  And even if there are telephone wires in the house and ADSL equipment installed on the PBX, the state of the ‚Äúlast mile‚Äù is such that data transfer using ADSL technology is impossible (or possible at such low speeds that the ADSL provider is not at all interesting). <br><br>  In this situation, wireless Internet access comes to the rescue. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But with him, everything is not so simple, as it should be. <br><br>  Some time ago, a few kilometers from my country house, Yota set up its base station and, judging by the coverage map, my house was in the ‚Äúreliable reception zone‚Äù of this network. <br><br>  Attempts to use a USB modem from Yota showed an unsatisfactory result: even on the third floor balcony facing the base station, the signal level is extremely low, the data exchange rate is 100‚Äì200 kilobits per second (that is, less than 25 kilobytes per second). <br><br>  Just at this time, Yota began selling its new device - the street modem "Yota Street". <br><br>  Pluses of this device: <br><ol><li>  Directional antenna - high gain and sensitivity by orders of magnitude superior USB modem (in winter, when the leaves on the trees do not stand in the way of radio waves, the reception rate is up to 5-6 megabits per second, and the transmission is slightly less than 2 in the summer megabit in both directions). </li><li>  Street performance - that is, it is possible and necessary to move the antenna to the mast high above the roof. </li><li>  Power over Ethernet is just one wire for data and power. </li><li>  It is connected to the WAN port of any router, the router receives all the information about the external network via DHCP. </li></ol><br>  It would seem just a fairy tale.  Turn on and enjoy.  But, short was happiness. <br><a name="habracut"></a><br>  As soon as the device went on sale, it was purchased and hoisted on the roof of the house. <br>  The new device did not prove to be from the best side: the connection to the Yota network periodically broke off and to restore it, you had to go into the web interface of the router and click on the "Connect" button until frenzy.  Sometimes the connection was resumed, sometimes not.  We had to turn off the power for both the modem and the router for 15-30 minutes. <br><br>  All calls to Yota technical support ended with the offer to show the modem to the service.  Some owners agreed and they sometimes even changed the device entirely.  However, it later turned out that a completely new device behaves exactly the same. <br><br>  Then rumors began to appear that Yota is preparing the Yota Street firmware update, however, this was never to be.  Yota simply turned off sales of ‚ÄúYota Street‚Äù and the owners of this wonderful device were left alone with their problems. <br><br>  However, as long as a lot of money was spent on the modem and the unlimited Yota tariff was more than fine for me, I decided on my own to try to get my modem working. <br><br>  My experience of using ‚ÄúYota Street‚Äù and discussions on the <a href="http://forum.yotatester.ru/">YotaTester forum</a> led me to the following 2 conclusions: <br><ol><li>  It is necessary periodically, for example once a day, to restart the modem so that it does not form too much uptime as a result of which the device ceased to work adequately. </li><li>  It is necessary to force the router to detect a broken connection and try to reconnect (as I previously did it with my hands from the web interface of the router). </li></ol><br><br>  The first task is solved simply: we buy an electric timer and program it to turn off the power at night from 3-00 to 3-15. <br>  The second problem is somewhat more complicated.  Fortunately, the router I was not simple, but well-known in narrow circles Asus Wl-500gp.  For some time he has been working under the control of ‚Äúfirmware from enthusiasts‚Äù. <br><br>  Searches on the Internet have shown that in this firmware (as well as in many other alternative firmware) it is possible to connect scripts for a set of events: <br><ul><li>  pre-boot - executed before the start of the boot </li><li>  post-boot - executed after the download is complete </li><li>  ‚Ä¶ and so on... </li></ul><br>  I just needed the ability to run my script after the full ‚Äúnormal‚Äù start of the router. <br><br>  It remains to write a script that monitors the connection. <br><br>  And again, searches on the Internet have brought results: the <a href="http://www.dd-wrt.com/wiki/index.php/Useful_Scripts">‚Äúalways_on‚Äù</a> script from the DD-WRT website turned out to be exactly what I was looking for. <br>  The router pings the default gateway and if there is no response, it sends new discovery requests from the DHCP client. <br><br>  However, I modified the script a bit so that the accidental loss of ping packets did not lead to the connection being dropped: only N consecutive failed pings lead to reconnection. <br><br>  The result turned out to be very encouraging - there is almost always access to the Internet, only sometimes the connection is lost so that it can recover in a couple of minutes. <br><br>  Well, if I started writing scripts, I added 2 more simple but very useful scripts: <br><ol><li>  The MTU setting is equal to the recommended Yota 1400 bytes.  It is difficult to say whether this has affected the speed and stability of work, but I want to believe that it did not get any worse. </li><li>  Forwarding the web interface of Yota-street to a local network.  The fact is that this same web interface is initially available when directly connected to the device at a fixed address: 192.168.1.1.  At the same time, via DHCP, the router from the modem receives an address in a completely different subnet (internal Yota subnet), that is, the modem's web interface is unavailable from the local network behind the router.  However, iptables can solve this problem. </li><li>  And to top it off for my convenience, I have issued a command in the form of a script for saving file system changes to the internal flash-memory. </li></ol><br>  So, I got 3 "combat" script and one service. <br><br>  For more flexibility and ability to further modify the set of scripts to run, I implemented a system like usual startup scripts in Linux: put all the scripts to run after loading into one folder "/ usr / local / sbin", called them with the prefixes "SXX" and more in one script I run them in ascending order of the index in the prefix. <br><br>  In short, now the configuration of the router is as follows: <br><ol><li>  Login to the router via telnet and go to the folder "/ usr / local / sbin" </li><li>  Put in the folder "/ usr / local / sbin /" "combat scripts": <a href="http://pastebin.com/TGYkm4bH">S10setmtu</a> , <a href="http://pastebin.com/zG3WemCe">S20alwayson</a> and <a href="http://pastebin.com/4JjxCkL5">S30yotadmin</a> </li><li>  There we put 2 service scripts: <a href="http://pastebin.com/WQ2Xssez">post-boot</a> , which runs the ‚Äúcombat scripts‚Äù;  and <a href="http://pastebin.com/zTPXKfkb">flash.sh</a> , with which we save the file system changes to the flash memory of the router. </li><li>  Run flash.sh: ./flash.sh </li><li>  Reboot the router: either with the reboot command in the terminal, or distort the power. </li></ol><br><br>  Voila, the Internet works and pleases users! </div><p>Source: <a href="https://habr.com/ru/post/126312/">https://habr.com/ru/post/126312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126303/index.html">Social Commerce day at SumIT</a></li>
<li><a href="../126304/index.html">The Firefox 8 system will block third-party add-ons</a></li>
<li><a href="../126305/index.html">Droider Show lite. Issue # 4, in which everyone got</a></li>
<li><a href="../126306/index.html">Proposal for the joint creation of a standard of security for Web applications (sites)</a></li>
<li><a href="../126308/index.html">Lightpack 5.5 published</a></li>
<li><a href="../126316/index.html">Work with SurfaceView in Android</a></li>
<li><a href="../126319/index.html">Http Parameter Contamination (more)</a></li>
<li><a href="../126322/index.html">Windows Phone Camp - a few days before the launch in Russia!</a></li>
<li><a href="../126327/index.html">Will Mars be as big as the full moon in August 2011?</a></li>
<li><a href="../126328/index.html">Digest Wanted.VC # 10</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>