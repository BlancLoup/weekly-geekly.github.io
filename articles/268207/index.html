<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What is the difference between Snort and Cisco FirePOWER?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I often hear that there is not much point in acquiring Cisco FirePOWER, it is the same Snort, only in a hardware shell. And after the recent release o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What is the difference between Snort and Cisco FirePOWER?</h1><div class="post__text post__text-html js-mediator-article">  I often hear that there is not much point in acquiring Cisco FirePOWER, it is the same Snort, only in a hardware shell.  And after the recent release of Snort on the Cisco ISR 4000 series routers, this question has again sounded with a new force.  Therefore, I would like in this article to briefly review the key differences between the free distributed <a href="http://www.snort.org/">Snort</a> intrusion detection <a href="http://www.snort.org/">system</a> and the Cisco solution family, united under the umbrella name FirePOWER (not to be confused with the Firepower 9300, which is a new Cisco high-performance hardware and modular security platform).  This issue has become particularly relevant recently, when a number of Russian developers began to use Snort as the basis for their own intrusion detection systems, after being certified by the FSTEC or the FSB. <br><a name="habracut"></a><br>  <b>Snort</b> <br><br>  Let's start with a brief background.  Snort was created by Martin Reshm in 1998 and very quickly gained popularity as a free intrusion detection system that allows you to write the rules for detecting attacks on your own and without much effort.  In fact, the Snort signature description language has become the de facto standard for many intrusion detection systems that have begun to use it in their engines. <br><br>  The basis of Snort is an engine consisting of five modules: <br><ul><li>  Sniffer packages.  As the name implies, this module is responsible for capturing the data transmitted over the network for subsequent transfer to the decoder.  He does this using the DAQ (Data AcQuisition) library.  This sniffer can work ‚Äúin a gap‚Äù, in a passive mode, or read network data from a previously prepared file. </li><li>  Packet decoder  This module is engaged in the analysis of the headers of captured packets, their analysis, the search for anomalies and deviations from the RFC, the analysis of TCP flags, the exclusion of individual protocols from further analysis and other similar work.  This decoder focuses on the TCP / IP stack. </li><li>  Preprocessors.  If the decoder parsed traffic on the 2nd and 3rd level of the reference model, the preprocessors are designed for more detailed analysis and normalization of protocols on the 3rd, 4th and 7th levels.  The most popular preprocessors include frag3 (working with fragmented traffic), stream5 (reconstructing TCP streams), http_inspect_ (normalizing HTTP traffic), DCE / RPC2, sfPortscan (used for detecting port scans) and various decoders for Telnet and FTP protocols , SMTP, SIP, SSL, SSH, IMAP, etc.  Some Russian developers write their preprocessors (for example, for industrial protocols) and add to their own intrusion detection systems (IDS), built on the basis of Snort. </li><li>  Attack detection engine.  This engine consists of two parts.  The rule designer assembles many different decision rules (attack signatures) into a single set optimized for subsequent use by the subsystem of inspection of captured and processed traffic in search of certain violations. </li><li>  Output module.  Upon detection of an attack, Snort can issue (record or display) a corresponding message in various formats - file, syslog, ASCII, PCAP, Unified2 (binary format for accelerated and lightweight processing). </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/ce7/88a/055/ce788a055e3b4da4b8784f81815b60a5.png"><br><br>  Both before and after Snort, attack detection systems appeared, but it was Snort that earned fame as a de facto standard, which is confirmed by over 4 million downloads of this software from <a href="http://www.snort.org/">www.snort.org</a> and over 500 thousand registered in the official user community.  What caused such a love for Snort?  Its language is a description of network security policy violations.  On the one hand, this language is very simple and the rule for detecting an attack or other violation of security policies can be written in just a couple of minutes (or even faster).  On the other hand, filters, complex queries, combining rules, setting thresholds, taking into account time intervals allow you to write really very complex network event handlers. <br><br>  At the end of 2014, an alpha version of Snort 3.0 (also known as Snort ++) was announced, in which many ideas that had previously been dusting on the shelf were implemented.  In particular, the design of systems has been redesigned, which has become more user-friendly.  There was also a mechanism for automatic identification of protocols on all ports, support for parallel packet processing, and the rule description language has become even simpler. <br><br>  At the end of 2014, another major change in Snort was made, which entered into the release of the 2.9.7 system, without waiting for Snort 3.0 to go into commercial operation.  We are talking about OpenAppID, that is, the language for recognition of application protocols and the implementation of what Cisco has called Application Visibility and Control.  In essence, we are talking about the mechanism (as a separate preprocessor) of signature description for own applications and their use in decision rules (attack signatures).  So far, Snort with OpenAppID is ahead of Cisco FirePOWER in this capability.  Now, to describe your applications in Cisco FirePOWER, you need to use either a HEX editor, or give the system a pre-recorded PCAP file with the traffic of the application of interest.  This is not very convenient and requires certain skills.  The OpenAppID language, which will be supported in Cisco solutions by the end of 2015, makes it easier to implement this task. <br><br>  <b>Firepower</b> <br><br>  Three years later, in 2001, Martin Resch founded the commercial company Sourcefire, within which a commercial version of Snort was created, called 3D Sensor, FirePOWER, etc. at various times. Martin Resch‚Äôs main goal was to offer customers a ready and automated solution, not requiring great effort on customization and implementation.  The second goal was to create a high-performance solution capable of detecting attacks at high speeds of tens of gigabits per second.  That was the first generation of Sourcefire devices.  Then came the second series of devices, in which the application identification function appeared (in Snort it appeared only last year), the FireAMP malicious code detection mechanism, firewalling, and a number of other functions.  In the third generation, a full-fledged ITU of the next generation (NGFW) appeared.  In 2011, Cisco announced its intention to acquire Sourcefire (several years earlier, Check Point did not succeed) and from that moment a new life began on the FirePOWER platform. <br><br><img src="https://habrastorage.org/files/792/946/13e/79294613e8b1463da23e646a5871cc49.png"><br><br>  Currently, this platform is presented in the form of 6 options for implementation: <br><ul><li>  Separate high-performance <a href="http://www.cisco.com/c/en/us/products/security/firepower-8000-series-appliances/index.html">Cisco FirePOWER Appliance</a> devices.  In fact, these are the same devices that Sourcefire produced. </li><li>  <a href="http://www.cisco.com/go/asafps">Cisco ASA with FirePOWER Services firewall</a> , which, in addition to traditional ITU and VPN functionality (Site-to-Site and Remote Access), received the capabilities of the next-generation ITU (NGFW), intrusion prevention systems (NGIPS), content filtering systems, malware neutralization systems and a number of other functions. </li><li>  <a href="http://www.cisco.com/c/en/us/products/collateral/security/router-security/datasheet-c78-735410.html">Cisco FirePOWER Threat Defense for ISR</a> router, which allows you to run all of the above features on the basis of the router. </li><li>  <a href="http://www.cisco.com/c/en/us/products/collateral/security/firepower-7000-series-appliances/datasheet-c78-733165.html">Virtual</a> versions of all the mentioned features, launched on the basis of VMware. </li><li>  New hardware platform <a href="http://www.cisco.com/c/en/us/support/security/firepower-9300-security-appliance/model.html">Firepower 9300</a> , capable of performing many network security tasks (from ITU and VPN to combat malicious code and DDoS reflection) at speeds of hundreds of gigabits </li><li>  Industrial firewalls and <a href="http://www.cisco.com/c/en/us/support/security/industrial-security-appliance-isa/tsd-products-support-series-home.html">Cisco ISA 3000</a> and Cisco ISA 4000 intrusion detection systems. </li></ul><br><br>  What is the difference between commercial software of these six platforms and Snort, which can be freely downloaded from the Internet? <br><br>  <b>What are the differences?</b> <br><br>  Let me try to highlight the key features that are present in FirePOWER technologies: <br><ul><li>  One of the major changes that emerged in 2007 was the RNA (Real-Time Network Awareness) technology, which allows you to build an active profile of everything that happens in a controlled network, builds a network map, identifies hosts, protocols and applications by passively analyzing traffic.  Later this information is compared with data on attacks and other violations of security policies. </li></ul><br><br><img src="https://habrastorage.org/files/5da/e49/fa6/5dae49fa6f02406895419f41fada5327.png"><br><br><ul><li>  Similar to RNA (RUA) technology (Real-Time User Awareness), which links user data with network activity.  It is always useful to see that the attack is implemented against the user ‚ÄúIvanov II.‚Äù, And not against an impersonal node with an IP address 192.168.1.34. </li><li>  In 2007, Sourcefire bought the rights to ClamAV, a free antivirus that was integrated with an intrusion prevention system to analyze not network packets and connections, but files transferred over the network.  Later, this decision, after the acquisition of Immunet in 2011, evolved into the AMP for Networks system, which allows identifying malicious code using seven different algorithms, as well as performing a retrospective analysis (post factum analysis) of files already in the network.  By the way, the identification and blocking of files by their types appeared in Snort, starting with version 2.9.7. </li></ul><br><br><img src="https://habrastorage.org/files/f1b/d8d/86c/f1bd8d86cc8846f1bb2f34bfb8c31f9b.png"><br><br><ul><li>  Martin Resch is skeptical about the idea of ‚Äã‚Äãfirewalling, believing that the attackers are just using open ports on the ITU to encapsulate their unauthorized actions.  Therefore, instead of the traditional firewall, the application-level firewall, also known as the next-generation firewall (NGFW), was implemented in Sourcefire solutions, which allows you to control violations in the use of applications, encapsulation of prohibited traffic in them, etc.  By the way, for this very reason, NGFW is almost impossible to certify according to the Russian requirements for ITU - NGFW simply do not have this functionality;  it is not their task. </li><li>  To implement the NGFW function, you must be able to identify applications running on the network.  This is done using the AppID technology, which essentially became the basis for the development of the previously mentioned OpenAppID technology.  In addition to the predefined application detectors, it is possible to describe your own applications (this is written above). </li></ul><br><br><img src="https://habrastorage.org/files/fa4/692/0c0/fa46920c0afb4e2ebfec2a349b104f3d.png"><br><br><ul><li>  But the implementation of the functions of the firewall in FirePOWER is still not done.  In particular, in any of the six platforms that use FirePOWER technologies, when creating security policies, you can use zones, VLANs, IP, ports, as well as users and groups in ITU rules. </li></ul><br><br><img src="https://habrastorage.org/files/f05/6c4/7c8/f056c47c82434f108dd778e58a5a6cd7.png"><br><br><ul><li> In addition to blocking traffic by IP addresses, URL filtering technology was implemented in FirePOWER.  In case of using SSL, its decryption is possible with subsequent inspection.  Currently, SSL inspection is only available on the FirePOWER Appliance, but by the end of 2015 it will be implemented on other platforms. </li></ul><br><br><img src="https://habrastorage.org/files/130/581/3e1/1305813e11f3442c9bfc79f9825acbea.png"><br><br><ul><li>  Having on board one sensor not only an intrusion detection system, but also a firewall, anti-malware system, URL filtering system and a number of other security technologies, it was logical to combine their capabilities in identifying indicators of compromise (IOC), which was done in one of the versions of FirePOWER. </li></ul><br><br><img src="https://habrastorage.org/files/369/35e/bcb/36935ebcb67642598f38f25d9999c844.png"><br><br><ul><li>  To reduce the load on the sensors, they implemented the so-called Security intelligence function, which consists in maintaining black and white lists of IP addresses.  This allows you not to handle trusted traffic and block it initially malicious.  This is done at the decoder level, which ultimately improves the performance of the entire system.  Another integrated feature is geolocation support, which allows geo-referencing of addresses recorded in network packets and sessions. </li><li>  FirePOWER has built-in detection of protected content by checksums (it also appeared in Snort 2.9.7), which can be used as a lightweight version of the DLP system. </li><li>  In terms of network capabilities, FirePOWER supports NAT and routing, which is not found in Snort, as well as device stacking for improved performance (only for the FirePOWER Appliance) and clustering (only for Cisco ASA with FirePOWER Services) - up to 16 devices.  In the case of clustering, the aggregate performance in the ITU mode will be 640 Gbit / s, and in the IPS mode - 160 Gbit / s. </li><li>  The commercial software code was optimized (instead of GCC. Intel C is used), and on the FirePOWER Appliance special network cards are also used, which allow to balance the load and processing of TCP flows between several cores on one device.  With their help stacking of several devices is carried out.  Support for multi-core processors should be implemented in Snort 3.0. </li></ul><br><br>  We could stop at this by completing a comparison of protective sensors based on Snort and FirePOWER.  But this is not all that is needed for a complete protection system, especially in a corporate environment.  Let's see which control functions, incl.  and centralized, offered along with Snort or FirePOWER. <br><br>  Snort itself has no control system.  However, the output module allows you to give the results of work to external systems, which the developers who offered the market several different systems to manage, generate reports, analyze and visualize Snort security events did not fail to take advantage of.  Among them, ACID (not updated for a long time), <a href="http://base.professionallyevil.com/">BASE</a> , <a href="https://github.com/Snorby/snorby">Snorby</a> , <a href="http://bammv.github.io/sguil/index.html">Sguil</a> , <a href="https://www.aanval.com/">Aanval</a> (commercial solution).  I worked with ACID very, very long time ago when I wrote the book ‚ÄúDetection of attacks‚Äù.  Moreover, like BASE, ACID does not have advanced analytical capabilities for working with data.  I didn‚Äôt work with Aanval, and commercial third-party management systems for free Snort are not exactly what you need (although in some cases it is possible).  But as for Snorby and Sguil, I can say that the second is more popular.  Let's try to compare it with the ‚Äúnative‚Äù sensor control system FirePOWER - <a href="http://www.cisco.com/c/en/us/products/security/firesight-management-center/index.html">FireSIGHT Management Center</a> (formerly called Defense Center). <br><br><img src="https://habrastorage.org/files/bf8/810/ede/bf8810ede7f64033bdb1cd11fdcf06bd.png"><br><br>  What is Sguil?  In essence, this is an event aggregation system from Snort that allows you to visualize that the output module of Snort issues externally ‚Äî an alarm, a packet's content, and other related information.  Next, Sguil allows you to run other tools through it for a more detailed investigation of recorded events.  These tools may include: <br><ul><li>  <a href="http://www.squertproject.org/">Squert</a> , a web application for organizing queries and displaying data stored in the Squil database. </li></ul><br><br><img src="https://habrastorage.org/files/aae/dfc/a67/aaedfca6737247cab239381af56e1c3d.png"><br><br><ul><li>  <a href="https://code.google.com/p/enterprise-log-search-and-archive/">ELSA</a> , a centralized log management system, a sort of lightweight SIEM. </li></ul><br><br><img src="https://habrastorage.org/files/e4c/fb8/5e0/e4cfb85e0d1243deaf602618e5710b71.png"><br><br><ul><li>  <a href="http://www.netresec.com/%3Fpage%3DNetworkMiner">NetworkMiner</a> , a network investigation tool based on the pcap file received from Snort. </li><li>  WireShark, which needs no introduction. </li></ul><br><br>  In principle, if you have the qualifications and time, you can build a good event management system that Snort gives us from a bunch of Sguil and other monitoring tools (for example, those included in Security Onion).  But only ... Rules management, sensor configuration, status tracking, updating, backing up the event database, role-based access control, hierarchical management system, report generation ... All this remains inaccessible to Sguil users. <br><br><img src="https://habrastorage.org/files/918/158/898/9181588987f449ac9c7242a574974506.png"><br><br>  The ‚Äúnative‚Äù FireSIGHT Management Center is devoid of these shortcomings.  Among its functions: <br><ul><li>  Centrally manage and configure multiple FirePOWER sensors. </li><li>  Updating sensors without having to recompile the code (don't forget to specify the correct parameters). </li><li>  Correlation of events not only from several IDS sensors, but also from different types of protection means and technologies - ITU, AMP, RNA, RUA, etc. </li></ul><br><br><img src="https://habrastorage.org/files/ec3/bfc/d2f/ec3bfcd2f92f4e76b9c8e5889d53fd11.png"><br><br><ul><li>  Creating security policies. </li><li>  Investigation of incidents. </li><li>  Manage profiles for each node (addresses, OS, applications, protocols, users). </li><li>  AD integration and centralized, hierarchical user management. </li><li>  Monitoring the status of remote sensors. </li><li>  Customizable dashboard to display various information. </li><li>  Report generation </li><li>  Backup database. </li><li>  Etc. </li></ul><br><br><img src="https://habrastorage.org/files/078/a93/550/078a93550b584b5cb8835eebf35b677f.png"><br><br>  In fact, FireSIGHT is a means of automating routine tasks that used to be so valuable when responding to incidents.  For example, in Snort and FirePOWER, there is a HAT (Host Attribute Table) - an XML file that associates with each IP address the operating systems used on it, as well as the ‚Äúservice port‚Äù associations.  Snort creates this file manually, which can present some difficulties on a large network.  In FirePOWER, this file is created automatically by the RNA and does not require manual work.  And there are many such examples. <br><br>  SGUIL has two advantages over the native management system of the FireSIGHT Management Center.  First, it is free.  And secondly, it displays data from the sensors in real time;  FireSIGHT has a maximum data refresh rate of once per minute.  But FireSIGHT allows you to integrate FirePOWER sensors with various external security systems used in the corporate segment ‚Äî security scanners, firewalls, routers and switches, packet capture systems, security event visualization systems, SIEM, etc.  This is done through special APIs that are also missing from the same Snort (although with the help of various scripts you can try to integrate it with a number of similar free protection tools). <br><br>  <b>Summary</b> <br><br>  As a conclusion, I would not like to draw any conclusions except one.  Statements that FirePOWER technologies, previously owned by Sourcefire, and later acquired by Cisco, and Snort‚Äôs free attack detection system, once the basis of Sourcefire solutions, are not the same thing.  Well, that is not the same at all.  Yes, Snort remains the de facto standard for attack detection systems, but Cisco FirePOWER is much more than just IDS.  Here you will find an application-level firewall, URL filtering, malicious code neutralization, built-in event correlation, incident investigation, integration with security scanners, and many other functions that automate routine security tasks. <br><br><img src="https://habrastorage.org/files/742/919/135/74291913508c4ee593c0b9339f60d230.png"></div><p>Source: <a href="https://habr.com/ru/post/268207/">https://habr.com/ru/post/268207/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268193/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ179 (September 28 - October 4, 2015)</a></li>
<li><a href="../268195/index.html">Blocks. The internal structure of the Cach√© database file. Part 2</a></li>
<li><a href="../268197/index.html">Home server on Intel Atom platform and Centos 7 OS</a></li>
<li><a href="../268199/index.html">Moscow metro map. SVG version</a></li>
<li><a href="../268203/index.html">PHP Digest number 71 - interesting news, materials and tools (September 21 - October 5, 2015)</a></li>
<li><a href="../268211/index.html">What I learned about interfaces in the real world in China</a></li>
<li><a href="../268215/index.html">Good day for code generation</a></li>
<li><a href="../268217/index.html">Amazon Web Services Infrastructure Inside. Part 1</a></li>
<li><a href="../268219/index.html">Insecure permissions in Android applications</a></li>
<li><a href="../268223/index.html">The publication in the incentive with minimal cost</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>