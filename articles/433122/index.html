<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>React-Hot-Loader v4.6</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About a month ago, React Hooks came out, and it immediately turned out that React-Hot-Loader spoils all the raspberries and not only is not very compa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>React-Hot-Loader v4.6</h1><div class="post__text post__text-html js-mediator-article"><p>  About a month ago, React Hooks came out, and it immediately turned out that React-Hot-Loader spoils all the raspberries and not only is not very compatible with them, so also the rest of the code breaks.  In general, it was a hot month ... </p><br><img src="https://habrastorage.org/getpro/habr/post_images/ded/f4c/580/dedf4c580aaf859a99afd5cec7cddbdd.png" alt="Hot"><br><br><h1 id="chto-vnutri">  What's inside? </h1><br><ul><li>  New API for HMR </li><li>  Full support for React 16.6 - React.lazy, React.memo and forwardRef </li><li>  Of course hooks </li><li>  React - dom (whatever that means) </li><li>  Webpack plugin </li><li>  Automagic ErrorBoundaries </li><li>  Pure render </li><li>  ‚ÄúPrinciples‚Äù </li></ul><a name="habracut"></a><br><h1 id="novyy-api-dlya-hmr">  New API for HMR </h1><br><p> Almost nothing has changed here - it was <code>hot</code> - <code>hot</code> remained.  Just got shorter and smarter: </p><br><blockquote>  Before <br><pre> <code class="plaintext hljs">import {hot} from 'react-hot-loader'; .... export default hot(module)(MyComponent)</code> </pre> <br><br>  Now <br><pre> <code class="plaintext hljs">import {hot} from 'react-hot-loader/root'; .... export default hot(MyComponent)</code> </pre> <br></blockquote><p>  In fact, the new <code>hot</code> is just old, divided into two parts.  As a result, situations can be detected when the first part was called, and the second one was not ( <a href="https://github.com/gaearon/react-hot-loader/issues/1078">details</a> ). </p><br><h1 id="react-166support">  React 16.6 support </h1><br><p>  <code>forwardRef</code> simply works (nobody said that they didn‚Äôt work before), the <code>memo</code> will be updated even though it is a <code>memo</code> , but <code>lazy</code> learned to re-import its insides. </p><br><p>  And of course, everything works right from the market. </p><br><h1 id="react-hookssupport">  React Hooks support </h1><br><p>  After the release of 16.7, it became clear that with the Hooks trouble.  Unfortunately, major projects such as the StoryBook ( <a href="https://github.com/storybooks/storybook/issues/4691">issue</a> ) and Gatsby ( <a href="https://github.com/gatsbyjs/gatsby/issues/9489">issue</a> ) were subject to this disaster. </p><br><p>  The problem flowed from the very nature of React-Hot-Loader ‚Äî in order to deceive React and prevent the destruction of the old version of the HotLoader tree, it wraps each component into a wrapper, which changes only the reference to the ‚Äúreal‚Äù component inside. <br>  Of course, the SFCs were wrapped in Components, and everything broke. </p><br><blockquote>  In fact, the SFCs turned around with the SFCs that returned an instance of the Class.  Very undocumented "factory" feature of React. </blockquote><p>  The community quickly found a way out (which I didn‚Äôt think of right <code>{pureSFC: true}</code> ), I only needed to change one option - <code>{pureSFC: true}</code> , and RHL would go into a simpler mode of operation, which had previously been turned off due to a problem with deep- force-update, which we have also updated. </p><br><h1 id="react-hot-dom">  React-Hot-Dom </h1><br><p>  Hot-Loader has always been about <em>hacking</em> React, and did it through the <code>createElement</code> overload and returning the "proxied" components to deceive the check inside <code>React-Dom</code> .  Now Hot-Loader will hack just this very check :) It works amazingly. </p><br><p>  Unfortunately, the API itself does not provide any API for this, because we have released a special package - <a href="https://github.com/hot-loader/react-dom">hot-loader / react-dom</a> with all the necessary patches. </p><br><p>  Putting "patch" is simple: </p><br><pre> <code class="plaintext hljs">// this would always work yarn add @hot-loader/react-dom@npm:react-dom // or change your webpack config alias: { 'react-dom': '@hot-loader/react-dom' } // or do the same with package.json to enable it in parcel</code> </pre> <br><p>  For those who don‚Äôt want to install the left packages, the package includes a webpack-loader which specifically patches your version of react-dom. </p><br><h1 id="webpack-loader">  Webpack-loader </h1><br><p>  The same webpack loader, which we nailed in version 4, came back to us again.  What for? </p><br><ul><li>  To quickly override node_modules and provide more code information. </li><li>  To patch react-dom </li><li>  For those who do not like babel </li></ul><br><h1 id="automagic-errorboundaries">  Automagic ErrorBoundaries </h1><br><p>  Errors during development are a favorite thing, but nobody liked the react-hot-loader errors ‚Äî it simply didn‚Äôt work very well, and sometimes it didn‚Äôt work at all. </p><br><p>  Starting from version 4.6, React-Hot-Loader will add to all components via <code>componentDidCatch</code> before the update, and then remove it after the update.  Errors can be caught and show "just-in-place". </p><br><p>  It seems like a trifle, but this trifle changes the whole development process.  And of course, everything is customized to your taste. <br><img src="https://habrastorage.org/webt/rj/mx/0h/rjmx0hevxbrs3hgst4-wsmraoyk.gif" alt="Error Reporter"></p><br><h1 id="pure-render">  "Pure" Render </h1><br><p>  This problem has always been with Hot-Loader.  While <a href="https://github.com/facebook/react-devtools/pull/1191">not poked his nose</a> .  In short - in React Dev Tools, you can right-click to open the menu, and jump directly to the component ... More precisely (it was) you cannot do it </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/adb/b4f/122/adbb4f12205909c2cdbc052105520136.gif" alt="dev tools"></p><br><p>  Now there is a <code>pureRender</code> option, as long as it is turned off by default, which removes a couple of side effects from the Component that lead to this byak. </p><br><p>  Unfortunately, this only works for "Class based" components, the SFC requires a patch in the react-dom, which was discussed above. </p><br><p>  In principle, it is now possible to practically hide the HotLoader in the system. </p><br><h1 id="principles">  Principles </h1><br><p>  Just a week ago, Dan Abramov published his <a href="https://overreacted.io/my-wishlist-for-hot-reloading/">wish list for the hot-loader</a> - 22 principles that a hot-loader must meet to be ‚Äúright‚Äù, if not white and fluffy. </p><br><p>  <a href="https://github.com/gaearon/react-hot-loader/issues/1118">Currently,</a> 14 points are 100% fulfilled, and another 4 are at 50%.  Total - 17 out of 22. In principle, not bad, and it is clear what needs to be done to finish the rest. <br>  Who knows, you can be after this Dan will return to the project. </p><br><h1 id="tak-chto">  So that </h1><br><ul><li>  just update the hot loader! </li><li>  replace the old <code>hot</code> with the new <code>hot</code> , I know - it sounds weird, but you understood me. </li><li>  try to patch react-dom somehow.  It is not necessary that everything will work well without this step - but it will be quite good with it. </li><li>  in theory everything.  Should work.  Just try it. </li></ul><br><p>  Has been with you Ô∏è </p><br><p>  <a href="https://github.com/gaearon/react-hot-loader">https://github.com/gaearon/react-hot-loader</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/433122/">https://habr.com/ru/post/433122/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../433110/index.html">Creating high-performance organizations: The strategic importance of collaboration software</a></li>
<li><a href="../433112/index.html">Entertaining JavaScript: Snowy Day</a></li>
<li><a href="../433114/index.html">PMP Certification: Commuter Style Exam Preparation</a></li>
<li><a href="../433116/index.html">Flamethrowers, Santa Claus on the tank, Bigfoot, Baba Yaga on Endurik (and, possibly, Jetpack) - all for the kids for the new year</a></li>
<li><a href="../433118/index.html">Benchmark testing and quick analysis of permutations algorithms</a></li>
<li><a href="../433126/index.html">Zabbix Review: how to organize code review for monitoring configuration</a></li>
<li><a href="../433128/index.html">What IT professionals play and do not play (summary 2018)</a></li>
<li><a href="../433130/index.html">May the force be with us: our own immunity against cancer</a></li>
<li><a href="../433132/index.html">"Calendar tester" for December. Try a different approach</a></li>
<li><a href="../433136/index.html">System.Transactions infrastructure in the .NET world</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>