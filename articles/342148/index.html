<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Digital Transformation: Lottery in the Cloud</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="While everyone is waiting for news, a resident of Voronezh will appear and take away his winnings, having broken the record jackpot of 506 million rub...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Digital Transformation: Lottery in the Cloud</h1><div class="post__text post__text-html js-mediator-article">  While everyone is waiting for news, a resident of Voronezh will appear and take away his winnings, having broken the record jackpot of 506 million rubles, we will tell you about the technical part of the solution, which allowed one of the largest companies selling lottery tickets in Russia to increase sales by 3 times. <br><br><img src="https://habrastorage.org/webt/k0/8s/av/k08savua2tivzf1vbyg4i1owaso.jpeg"><br><a name="habracut"></a><br><h2>  Introduction </h2><br>  Just imagine, the company has more than 40 thousand units in almost all locations in Russia.  At some point, the guys came up against the scalability of the scalability and realized that it was time to change something and use new technological solutions. <br><br>  After that, together with us, a solution was developed based on Azure services and Microsoft SQL Server DBMS.  Together with him, there was no need to install specialized software for data processing, and errors began to be detected at an early stage.  As a result, the number of offices working with lottery tickets increased from 8 to 22 thousand, and the volume of ticket sales grew three times. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>We hand over to Paul, the author of the article.</i> <br><br>  Today, cloud services are becoming more common.  I think many people ask the question ‚ÄúWhy are they so good?‚Äù I answer for myself: ‚ÄúFirst of all, with its scalability, high-quality infrastructure and abundance of services.‚Äù But sometimes things are not without nuances, knowledge of which will help save time and money.  This article will discuss just some of them that should be considered when developing in the Entity Framework + Azure SQL bundle. <br><br><h2>  Let's start with Azure SQL </h2><br>  From a developer‚Äôs point of view, this is almost the same as a modern Microsoft SQL Server.  The most important difference is the presence of artificial limitations in performance, on which the price of a ‚Äúcloud‚Äù DBMS depends. <br><br><ul><li>  In the on-premise server, you are limited by CPU power, HDD speed and RAM, and, as a rule, all this is bought with a good margin. </li><li>  In the cloud version, you do not know how much hardware resources you have, instead you have some calculated value of performance, called DTU (Data Transfer Unit). </li></ul><br>  Of course, the CPU also takes part in calculating this parameter, and the number of I / O operations with the disk and with the log, though the exact composition of the formula is unknown.  And most importantly - for reasonable money DTU is not so much.  And a lot of DTUs cost a lot of indecent money.  Obviously, they need to be saved and not wasted.  And, besides purely financial considerations, there is one more, very important: the DBMS does not scale well enough. <br><br>  "How so?" - you ask.  ‚ÄúWe are in the clouds and we are going to pay only for the resources we used and to be able to quickly scale our solution.  I can click the mouse at any time and increase the number of available DTUs by a factor of five. " <br><br>  You can, but consider how the transition to another category of performance occurs inside the platform. <br><br>  And it happens like <a href="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-service-tiers">this</a> : <br><br><ul><li>  database recovery from backup is done; </li><li>  replication between databases is configured; </li><li>  when the bases are synchronized, switching occurs (naturally, with a small gap in availability, it is stated that this time does not exceed 30 seconds). </li></ul><br>  The recovery and synchronization process takes a non-zero time, practice shows that for every 50 GB of the Standard database it takes about 1 hour, and this is for the database without any load.  This means that if your database weighs 150 GB and in the morning after the advertising campaign you have a 100% database load and everything slows down - you will be able to increase the number of DTUs at best for dinner.  Of course, your business department during this time will colorfully explain to you where he saw your magical clouds, and also ask where their praised scalability and resilience are. <br><br>  <b>The final conclusion is simple</b> : we always need a performance margin, and switching performance levels must be done in advance. <br><br>  Having understood the question of why we need to save DB resources, we will try to answer the question ‚ÄúHow?‚Äù. <br><br><h2>  Approach the first - we take only the necessary </h2><br>  First of all, we note that the modern approach to design almost completely eliminates the use of stored procedures.  No, nobody forbids, but this approach should not be the main one.  In the era of classic two-tier applications, the active use of stored procedures on the database server was a good tone.  But then, it was a means to implement the same application server, which today is implemented by your ASP.NET application.  Well, of course, transferring logic to the DBMS, we again quickly run into problems of scaling, which is called ‚Äúsee point one‚Äù. <br><br>  So, we have a web application based on ASP.NET + Entity Framework and LINQ to SQL for writing queries.  Convenient - as much horror.  You can forget about the database ... Yeah, that‚Äôs where the main danger lies.  Unfortunately, you can forget about the database only in simple cases.  And in the complex and highly loaded ....  Here is a specific example.  Suppose we need to pull out a few records by condition: <br><br><pre><code class="sql hljs">myContext.MyTable.Where(x=&gt;x.Amount&gt;100).ToList();</code> </pre> <br>  Everything is great, simple and clear.  It will execute the simplest query equivalent to: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> MyTable <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> amount&gt;<span class="hljs-number"><span class="hljs-number">100</span></span></code> </pre> <br>  Now let's imagine that in the following code we need to use only three of the 20 fields in this table - let it be Amount, ClientID, AccountID.  And we always pull out all 20. With decent loads, it quickly turns out that sampling all the fields creates a large number of disk accesses, even if you have an Amount index, and if not, then all the more complete the entire table is produced.  All such cases are solved from two sides - from the application side you select only those fields that you absolutely need: <br><br><pre> <code class="sql hljs"> myContext.MyTable.Where(x=&gt;x.Amount&gt;100) .Select(x=&gt;new MyTableViewModel{ ClientID = x.ClientID, AccountId = x.AccountID, Amount = x.Amount }) .ToList();</code> </pre> <br>  And if, as in our example, there are significantly fewer such fields than fields in the table, an index is created with the fields enabled: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> IX_AmountEx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> MyTable(Amount) <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(AccountID, ClientID)</code> </pre> <br>  If you look at the query plan - all data is taken from the index, disk access almost does not occur.  DTU is extremely economical. <br><br>  The most interesting thing is that the platform itself will prompt you with requests that require improvement in the described scenario.  On a working database, you need to carefully follow the recommendations for the indexes that the platform provides.  These recommendations are collected in the Perfomance Recommendations menu item: <br><br><img src="https://habrastorage.org/webt/0i/nr/em/0inremoirbvtilwo43qvvrtwxrm.jpeg"><br><br>  It is necessary to look at the request to create an index that the system offers.  And if it is proposed to create an index, where in the INCLUDE all fields of the table are listed with the exception of the key ones, then this is exactly the case described above! <br><br><h2>  Second approach - keep it simple </h2><br>  The cheapness of disk storage has given rise to a general trend towards data denormalization in a DBMS.  From here, NoSQL bases also began to appear, the work with which requires a specific approach, but gives a big gain in speed.  To some extent, a similar principle has to be applied today for ordinary relational DBMS. <br><br>  No matter how beautiful your 6-story join is, its implementation is quite a difficult task for the server.  Making the server ‚Äúshovel‚Äù half of the database to produce two digits is a worthy task, but it sharply limits you in scaling.  Practice shows that it is often easier to make two simple queries to the DBMS and then glue the result into memory, rather than force the server with one complex query.  Moreover, it is simpler and faster to simply get 5-7 thousand lines in a simple request and make improvements using the application server than to fill in a request that produces three lines, but at the same time consumes all the available resources.  Due to this, we transfer part of the logical load on the application server, the scaling of which takes 2 minutes and often happens automatically.  And about the complexity of scaling the DBMS, everything has already been said above. <br><br><h2>  Example </h2><br>  Suppose we are trying to choose some statistics of the total amount of orders of our customers, where each order was from 10 thousand.  You need to issue a total amount, the number of such orders and the name of the client.  Transactions are stored in a certain table <code>Transactions</code> , and clients, respectively, in <code>Clients</code> .  A typical query looks like this: <br><br><pre> <code class="sql hljs"> from t in dc.Transactions where t.Amount&gt;10000m group t by t.ClientID into tg join cli in dc.Clients on tg.Key equals cli.ID into resTable from xx in resTable <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { Amount = tg.Sum(x =&gt; x.Amount), ClientID = tg.Key, ClientName = xx.Name, ItemCount = tg.Count() };</code> </pre> <br>  Let's see what the Entity Framework turns it into: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> [Project2].[ClientID] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [ClientID], [Project2].[C1] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [C1], [Project2].[<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>], (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [A1] <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> [dbo].[Transactions] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [Extent4] <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ([Extent4].[Amount] &gt; <span class="hljs-keyword"><span class="hljs-keyword">cast</span></span>(<span class="hljs-number"><span class="hljs-number">10000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-built_in"><span class="hljs-built_in">decimal</span></span>(<span class="hljs-number"><span class="hljs-number">18</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> ([Project2].[ClientID] = [Extent4].[ClientID])) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [C2] <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> [Distinct1].[ClientID] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [ClientID], [Extent2].[<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>], (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>([Extent3].[Amount]) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [A1] <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> [dbo].[Transactions] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [Extent3] <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ([Extent3].[Amount] &gt; <span class="hljs-keyword"><span class="hljs-keyword">cast</span></span>(<span class="hljs-number"><span class="hljs-number">10000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-built_in"><span class="hljs-built_in">decimal</span></span>(<span class="hljs-number"><span class="hljs-number">18</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> ([Distinct1].[ClientID] = [Extent3].[ClientID])) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [C1] <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> [Extent1].[ClientID] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [ClientID] <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> [dbo].[Transactions] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [Extent1] <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> [Extent1].[Amount] &gt; <span class="hljs-keyword"><span class="hljs-keyword">cast</span></span>(<span class="hljs-number"><span class="hljs-number">10000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-built_in"><span class="hljs-built_in">decimal</span></span>(<span class="hljs-number"><span class="hljs-number">18</span></span>)) ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [Distinct1] <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> [dbo].[Clients] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [Extent2] <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [Distinct1].[ClientID] = [Extent2].[<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>] ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [Project2]</code> </pre> <br>  The query is not complicated, but a large number of such ‚Äúsimple‚Äù queries will generate quite a considerable load.  And if there are a lot of them, then it‚Äôs logical to keep a list of customers in the cache.  And then the sample code could be: <br><br><pre> <code class="sql hljs">var groupedTransactions= (from t in dc.Transactions where t.Amount &gt; 10000m group t by t.ClientID into tg <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { Amount = tg.Sum(x =&gt; x.Amount), ClientID = tg.Key, ItemCount = tg.Count() }).ToList();</code> </pre> <br>  Which turns the Entity Framework into a much simpler query: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> [GroupBy1].[K1] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [ClientID], [GroupBy1].[A1] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [C1], [GroupBy1].[A2] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [C2] <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> [Extent1].[ClientID] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [K1], <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>([Extent1].[Amount]) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [A1], <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [A2] <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> [dbo].[Transactions] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [Extent1] <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> [Extent1].[Amount] &gt; <span class="hljs-keyword"><span class="hljs-keyword">cast</span></span>(<span class="hljs-number"><span class="hljs-number">10000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-built_in"><span class="hljs-built_in">decimal</span></span>(<span class="hljs-number"><span class="hljs-number">18</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> [Extent1].[ClientID] ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [GroupBy1]</code> </pre> <br>  And after that, we finish building the sample with customer data: <br><br><pre> <code class="sql hljs">from tdata in groupedTransactions join client in clientCache on tdata.ClientID equals client.ID <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { Amount = tdata.Amount, ItemCount = tdata.ItemCount, ClientID = tdata.ClientID, ClientName = client.Name };</code> </pre> <br>  Even with the ‚Äúright‚Äù index: <br><br><pre> <code class="hljs pgsql">reate <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> IX_Amount <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> Transactions (Amount) <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(ClientID)</code> </pre> <br><br>  The request plan for the second case is half the Estimated Subtree Cost.  Pictures of query plans, respectively: <br><br><img src="https://habrastorage.org/webt/u1/31/y_/u131y_soxngslrovm69wh0gt7zk.jpeg"><br><br><img src="https://habrastorage.org/webt/j_/hm/xp/j_hmxpusnslq8jbfglodwf-rjta.png"><br><br><h2>  Summary </h2><br><ul><li>  When working with Azure SQL, it is necessary to spend DTU very efficiently in order not to run into exorbitant prices.  In this case, the performance margin should be, since the change in the limiting performance of your database can take several hours. </li><li>  To do this, carefully write requests to require only the necessary data.  We actively use indexes with INCLUDE fields. </li><li>  We simplify requests, we carry out the final data connection on the server side of the application - it is cheaper and scales faster. </li></ul><br>  The described approaches allow you to increase the speed of the system by 10-40 times, proportionally reducing the required level of performance of Azure SQL. <br><br><h2>  about the author </h2><br><img src="https://habrastorage.org/webt/d7/b8/w1/d7b8w1smilf8auuyexx2yr0-luw.jpeg" align="left" width="120">  <b>Pavel Kutakov</b> - over 15 years of experience as a developer and architect of software systems in various business areas.  The list of projects includes a banking information system operating worldwide from the USA to Papua New Guinea, as well as an integrated development environment for the Firebird DBMS.  Currently, he is leading the development of specialized transactional services for the national lottery operator. <br><br><hr><br>  We remind you that <a href="https://azure.microsoft.com/ru-ru/free/%3Fwt.mc_id%3DAID570629_QSG_BLOG_139069">you can try Azure for free</a> . <br><br>  <b>Minute advertising</b> .  If you want to try new technologies in your projects, but do not reach the hands, leave the application in the program <b><a href="https://www.tech-acceleration.com/">Tech Acceleration</a></b> from Microsoft.  Its main feature is that together with you we will select the required stack, we will help to realize the pilot and, if successful, we will spend maximum efforts so that the whole market will know about you. </div><p>Source: <a href="https://habr.com/ru/post/342148/">https://habr.com/ru/post/342148/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342134/index.html">Impressions of Angular Connect 2017</a></li>
<li><a href="../342136/index.html">Can VeraCrypt become the next TrueCrypt?</a></li>
<li><a href="../342138/index.html">Security Week 45: Ether has frozen in wallets, a million fake WhatsApps, useless protection of intellectual property</a></li>
<li><a href="../342140/index.html">Nostalgia post. Secrets of Internet prices: why megabits can cost from $ 0 to $ 200 or how to get 100 Gbit / s for a penny?</a></li>
<li><a href="../342146/index.html">Expansion of the menu functionality in nanoCAD 8.5: macros and LISP expressions</a></li>
<li><a href="../342152/index.html">Frontend distribution via CDN</a></li>
<li><a href="../342154/index.html">Simulator cars Breitenberg</a></li>
<li><a href="../342156/index.html">How self-taught programmers get jobs in reality</a></li>
<li><a href="../342158/index.html">How to legalize newsletter clients</a></li>
<li><a href="../342160/index.html">Operator << options for logger</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>