<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis of performance tasks with JBreak (part 1)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The first part is the analysis of the most holivarnogo task of the four: 



void forEach(List<Integer> values, PrintStream ps) { values.forEach(ps::p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analysis of performance tasks with JBreak (part 1)</h1><div class="post__text post__text-html js-mediator-article">  The first part is the analysis of the most holivarnogo task of the four: <br><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.forEach(ps::println); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.stream().forEach(ps::println); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.parallelStream().forEach(ps::println); }</code> </pre> <br>  Under the cut condition of tasks, the history of their appearance, as well as the analysis of the first task and the statistics of its correct solutions among the conference participants. <br><br>  Other publications series: <a href="https://habrahabr.ru/company/skbkontur/blog/351300/">Part 2</a> , <a href="https://habrahabr.ru/company/skbkontur/blog/351540/">Part 3</a> , <a href="https://habrahabr.ru/company/skbkontur/blog/351812/">Part 4</a> . <br><a name="habracut"></a><br><h2>  Foreword </h2><br>  A colleague ten days before the conference came up with a proposal to prepare tasks for the prize raffle, where several Effective Java books by Joshua Bloch (the last third edition) would become top prizes.  For such prizes need appropriate tasks.  And so, the challenge is accepted. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To begin, let's define what we want to get: <br><br><ul><li>  tasks should be on the code (I am not a master of inventing logical tasks, but I did not want to take ready ones) </li><li>  There must be an obvious wrong answer in the tasks. </li><li>  tasks don't have to be all simple or all complex </li><li>  If you code a task, then this should not give a 100% answer, but it can help in finding the right solution. </li><li>  ideally, tasks should be ‚Äúhooked‚Äù so that after the conference there is a desire to get to the bottom of the truth. </li></ul><br>  So I decided to prepare tasks about the performance in the following form: <br><ul><li>  several variants of algorithms that do something similar </li><li>  required to sort them by speed </li><li>  and explain why the algorithms are ordered in this way. </li></ul><br><h2>  Tasks </h2><br><div class="spoiler">  <b class="spoiler_title">How the condition of the problem in printed form looked</b> <div class="spoiler_text"> <a href=""><img src="https://habrastorage.org/webt/1v/cv/9j/1vcv9jvvi2_1vw1mmyopkydk-oc.png"></a> </div></div><br>  Comment to all tasks: <br><br><ul><li>  Sort the methods according to the speed of their work and enter the numbers of the methods in the appropriate cell. </li><li>  If the methods give slightly different results, then write them in one cell. </li><li>  For each task, write an explanation why some methods are faster than others. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Problem number 1</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.forEach(ps::println); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.stream().forEach(ps::println); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.parallelStream().forEach(ps::println); }</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Problem number 2</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">format</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String user, String grade, String company, String message)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> String.format( <span class="hljs-string"><span class="hljs-string">", %s,   %s .    %s    %s"</span></span>, user, grade, company, message); } <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">format</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String user, String grade, String company, String message)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">", "</span></span> + user + <span class="hljs-string"><span class="hljs-string">",   "</span></span> + grade + <span class="hljs-string"><span class="hljs-string">" .    "</span></span> + company + <span class="hljs-string"><span class="hljs-string">"    "</span></span> + message; } <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">format</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String user, String grade, String company, String message)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">", "</span></span>) .append(user) .append(<span class="hljs-string"><span class="hljs-string">",   "</span></span>) .append(grade) .append(<span class="hljs-string"><span class="hljs-string">" .    "</span></span>) .append(company) .append(<span class="hljs-string"><span class="hljs-string">"    "</span></span>) .append(message) .toString(); }</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Problem number 3</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> x = y1 * z2 - z1 * y2; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> y = z1 * x2 - x1 * z2; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> z = x1 * y2 - y1 * x2; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x * x + y * y + z * z; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z2)</span></span></span><span class="hljs-function"> </span></span>{ Vector v1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(x1, y1, z1); Vector v2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(x2, y2, z2); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v1.crossProduct(v2).squared(); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Vector</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> x, y, z; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Vector</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.x = x; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.y = y; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.z = z; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">squared</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x * x + y * y + z * z; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Vector </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">crossProduct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Vector v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector( y * vz - z * vy, z * vx - x * vz, x * vy - y * vx); } }</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Task number 4</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">octaPow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Math.pow(a, <span class="hljs-number"><span class="hljs-number">8</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">octaPow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a * a * a * a * a * a * a * a; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">octaPow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Math.pow(Math.pow(Math.pow(a, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">octaPow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a)</span></span></span><span class="hljs-function"> </span></span>{ a *= a; a *= a; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a * a; }</code> </pre></div></div><br>  It is assumed that the code runs in a HotSpot 64-bit VM (JRE 1.8.0_161).  There is nothing specific in the chosen JRE version, except that it is one of the last and I already had it - it goes without saying that I had to check all the problems in advance. <br><br>  It is implicitly assumed that the code runs on multi-core hardware with an intel 64 architecture (x86-64).  It may have been worth it to indicate this explicitly, but additional conditions could be misleading.  Moreover, if the explanation of the answer in the problem took into account the specifics of another iron, then the solution would be counted. <br><br><h3>  Problem number 1 </h3><br>  ‚ÄúForeach is fast‚Äù, ‚ÄúStream inhibited‚Äù, ‚ÄúParallel means fast‚Äù was often heard from discussions of the Stream API, which is already 4 years old (if you count from the date of the public release of Java 8).  So I <s>succumbed</s> to the provocation: <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.forEach(ps::println); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.stream().forEach(ps::println); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.parallelStream().forEach(ps::println); }</code> </pre><br><blockquote>  It was a mistake not to specify an explicit <code>List</code> implementation, for example, <code>ArrayList</code> .  The conference participants came up to clarify which implementations of the list in question.  Since all benchmarks were carried out for two standard implementations of <code>ArrayList</code> and <code>LinkedList</code> , the problem was proposed to be solved under these conditions. </blockquote><br>  <b>The obvious wrong answer:</b> option 3 is the fastest. <br><br>  Many triggered the ‚ÄúParallel means fast‚Äù trigger and they were trapped by <code>PrintStream</code> . <br><br>  PrintStream source code snippet: <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">println</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object x)</span></span></span><span class="hljs-function"> </span></span>{ String s = String.valueOf(x); <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) { print(s); newLine(); } }</code> </pre><br>  In practice, this means that we will not get any benefit from parallel execution, regardless of the size of the <code>values</code> list.  On the contrary, we will get a performance degradation, since the virtual machine will have to constantly resolve multiple locks on the <code>PrintStream</code> . <br><br><h4>  <code>List.stream().forEach()</code> vs <code>List.parallelStream().forEach()</code> </h4><br>  Below is a benchmark to compare the usual serial and parallel <code>Stream</code> . <br><br><div class="spoiler">  <b class="spoiler_title">Benchmark</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.gnkoshelev.jbreak2018.perf_tests.for_each; <span class="hljs-meta"><span class="hljs-meta">@Fork</span></span>(value = <span class="hljs-number"><span class="hljs-number">1</span></span>, warmups = <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Warmup</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">5</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@Measurement</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">10</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@OutputTimeUnit</span></span>(value = TimeUnit.MICROSECONDS) <span class="hljs-meta"><span class="hljs-meta">@BenchmarkMode</span></span>(Mode.AverageTime) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StreamDefaultBenchmark</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> N = <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> List&lt;Integer&gt; values; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> { Random rand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(<span class="hljs-number"><span class="hljs-number">12345</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = N; values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; size; i++) { values.add(rand.nextInt()); } } <span class="hljs-meta"><span class="hljs-meta">@State</span></span>(value = Scope.Benchmark) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PrintStreamHolder</span></span></span><span class="hljs-class"> </span></span>{ PrintStream ps; <span class="hljs-meta"><span class="hljs-meta">@Setup</span></span>(value = Level.Iteration) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ps = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PrintStream(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NullOutputStream()); } } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStreamBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PrintStreamHolder psh)</span></span></span><span class="hljs-function"> </span></span>{ forEachStream(values, psh.ps); } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachParallelStreamBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PrintStreamHolder psh)</span></span></span><span class="hljs-function"> </span></span>{ forEachParallelStream(values, psh.ps); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.stream().forEach(ps::println); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachParallelStream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.parallelStream().forEach(ps::println); } }</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">results</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"># JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamDefaultBenchmark.forEachParallelStreamBenchmark # Run progress: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">905</span></span>,<span class="hljs-number"><span class="hljs-number">302</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">876</span></span>,<span class="hljs-number"><span class="hljs-number">525</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">921</span></span>,<span class="hljs-number"><span class="hljs-number">153</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">898</span></span>,<span class="hljs-number"><span class="hljs-number">899</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">873</span></span>,<span class="hljs-number"><span class="hljs-number">496</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">920</span></span>,<span class="hljs-number"><span class="hljs-number">439</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">894</span></span>,<span class="hljs-number"><span class="hljs-number">216</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">917</span></span>,<span class="hljs-number"><span class="hljs-number">930</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">906</span></span>,<span class="hljs-number"><span class="hljs-number">970</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">929</span></span>,<span class="hljs-number"><span class="hljs-number">685</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">883</span></span>,<span class="hljs-number"><span class="hljs-number">136</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">883</span></span>,<span class="hljs-number"><span class="hljs-number">996</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">882</span></span>,<span class="hljs-number"><span class="hljs-number">597</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">921</span></span>,<span class="hljs-number"><span class="hljs-number">612</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">885</span></span>,<span class="hljs-number"><span class="hljs-number">576</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamDefaultBenchmark.forEachParallelStreamBenchmark": <span class="hljs-number"><span class="hljs-number">902</span></span>,<span class="hljs-number"><span class="hljs-number">616</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">296</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">882</span></span>,<span class="hljs-number"><span class="hljs-number">597</span></span>, <span class="hljs-number"><span class="hljs-number">902</span></span>,<span class="hljs-number"><span class="hljs-number">616</span></span>, <span class="hljs-number"><span class="hljs-number">929</span></span>,<span class="hljs-number"><span class="hljs-number">685</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">716</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">874</span></span>,<span class="hljs-number"><span class="hljs-number">320</span></span>, <span class="hljs-number"><span class="hljs-number">930</span></span>,<span class="hljs-number"><span class="hljs-number">911</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamDefaultBenchmark.forEachStreamBenchmark # Run progress: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">285</span></span>,<span class="hljs-number"><span class="hljs-number">837</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">265</span></span>,<span class="hljs-number"><span class="hljs-number">208</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">157</span></span>,<span class="hljs-number"><span class="hljs-number">321</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">157</span></span>,<span class="hljs-number"><span class="hljs-number">447</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">157</span></span>,<span class="hljs-number"><span class="hljs-number">689</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">157</span></span>,<span class="hljs-number"><span class="hljs-number">192</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">161</span></span>,<span class="hljs-number"><span class="hljs-number">511</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">161</span></span>,<span class="hljs-number"><span class="hljs-number">464</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">156</span></span>,<span class="hljs-number"><span class="hljs-number">948</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">158</span></span>,<span class="hljs-number"><span class="hljs-number">526</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">163</span></span>,<span class="hljs-number"><span class="hljs-number">035</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">159</span></span>,<span class="hljs-number"><span class="hljs-number">140</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">158</span></span>,<span class="hljs-number"><span class="hljs-number">476</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">158</span></span>,<span class="hljs-number"><span class="hljs-number">884</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">159</span></span>,<span class="hljs-number"><span class="hljs-number">072</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamDefaultBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">159</span></span>,<span class="hljs-number"><span class="hljs-number">425</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">976</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">156</span></span>,<span class="hljs-number"><span class="hljs-number">948</span></span>, <span class="hljs-number"><span class="hljs-number">159</span></span>,<span class="hljs-number"><span class="hljs-number">425</span></span>, <span class="hljs-number"><span class="hljs-number">163</span></span>,<span class="hljs-number"><span class="hljs-number">035</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">969</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">156</span></span>,<span class="hljs-number"><span class="hljs-number">448</span></span>, <span class="hljs-number"><span class="hljs-number">162</span></span>,<span class="hljs-number"><span class="hljs-number">401</span></span>] (assumes normal distribution) # Run complete. Total <span class="hljs-type"><span class="hljs-type">time</span></span>: <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> Benchmark Mode Cnt Score Error Units StreamDefaultBenchmark.forEachParallelStreamBenchmark avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">902</span></span>,<span class="hljs-number"><span class="hljs-number">616</span></span> ¬± <span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">296</span></span> us/op StreamDefaultBenchmark.forEachStreamBenchmark avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">159</span></span>,<span class="hljs-number"><span class="hljs-number">425</span></span> ¬± <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">976</span></span> us/op</code> </pre></div></div><br>  It is clear that with single-threaded execution, the lock does not go anywhere.  But a virtual machine can act rather cunningly, namely, not to make a real (at the OS level) blocking, but be limited to the so-called <b>biased locking</b> , if there is no contention on the resource. <br><br>  We can disable <b>biased locking</b> and see what happens: <br><br><div class="spoiler">  <b class="spoiler_title">Benchmark without biased locking</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.gnkoshelev.jbreak2018.perf_tests.for_each; <span class="hljs-meta"><span class="hljs-meta">@Fork</span></span>(value = <span class="hljs-number"><span class="hljs-number">1</span></span>, warmups = <span class="hljs-number"><span class="hljs-number">0</span></span>, jvmArgsAppend = <span class="hljs-string"><span class="hljs-string">"-XX:-UseBiasedLocking"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Warmup</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">5</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@Measurement</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">10</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@OutputTimeUnit</span></span>(value = TimeUnit.MICROSECONDS) <span class="hljs-meta"><span class="hljs-meta">@BenchmarkMode</span></span>(Mode.AverageTime) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StreamWithoutBiasedLockingBenchmark</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> N = <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> List&lt;Integer&gt; values; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> { Random rand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(<span class="hljs-number"><span class="hljs-number">12345</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = N; values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; size; i++) { values.add(rand.nextInt()); } } <span class="hljs-meta"><span class="hljs-meta">@State</span></span>(value = Scope.Benchmark) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PrintStreamHolder</span></span></span><span class="hljs-class"> </span></span>{ PrintStream ps; <span class="hljs-meta"><span class="hljs-meta">@Setup</span></span>(value = Level.Iteration) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ps = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PrintStream(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NullOutputStream()); } } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStreamBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PrintStreamHolder psh)</span></span></span><span class="hljs-function"> </span></span>{ forEachStream(values, psh.ps); } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachParallelStreamBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PrintStreamHolder psh)</span></span></span><span class="hljs-function"> </span></span>{ forEachParallelStream(values, psh.ps); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.stream().forEach(ps::println); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachParallelStream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.parallelStream().forEach(ps::println); } }</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">results</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"># JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: -XX:-UseBiasedLocking # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamWithoutBiasedLockingBenchmark.forEachParallelStreamBenchmark # Run progress: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">754</span></span>,<span class="hljs-number"><span class="hljs-number">310</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">723</span></span>,<span class="hljs-number"><span class="hljs-number">277</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">682</span></span>,<span class="hljs-number"><span class="hljs-number">845</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">696</span></span>,<span class="hljs-number"><span class="hljs-number">635</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">690</span></span>,<span class="hljs-number"><span class="hljs-number">811</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">702</span></span>,<span class="hljs-number"><span class="hljs-number">129</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">729</span></span>,<span class="hljs-number"><span class="hljs-number">542</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">689</span></span>,<span class="hljs-number"><span class="hljs-number">514</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">716</span></span>,<span class="hljs-number"><span class="hljs-number">482</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">734</span></span>,<span class="hljs-number"><span class="hljs-number">766</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">684</span></span>,<span class="hljs-number"><span class="hljs-number">455</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">682</span></span>,<span class="hljs-number"><span class="hljs-number">483</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">706</span></span>,<span class="hljs-number"><span class="hljs-number">857</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">690</span></span>,<span class="hljs-number"><span class="hljs-number">011</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">694</span></span>,<span class="hljs-number"><span class="hljs-number">427</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamWithoutBiasedLockingBenchmark.forEachParallelStreamBenchmark": <span class="hljs-number"><span class="hljs-number">703</span></span>,<span class="hljs-number"><span class="hljs-number">067</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">058</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">682</span></span>,<span class="hljs-number"><span class="hljs-number">483</span></span>, <span class="hljs-number"><span class="hljs-number">703</span></span>,<span class="hljs-number"><span class="hljs-number">067</span></span>, <span class="hljs-number"><span class="hljs-number">734</span></span>,<span class="hljs-number"><span class="hljs-number">766</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">559</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">675</span></span>,<span class="hljs-number"><span class="hljs-number">008</span></span>, <span class="hljs-number"><span class="hljs-number">731</span></span>,<span class="hljs-number"><span class="hljs-number">125</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: -XX:-UseBiasedLocking # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamWithoutBiasedLockingBenchmark.forEachStreamBenchmark # Run progress: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">271</span></span>,<span class="hljs-number"><span class="hljs-number">938</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">258</span></span>,<span class="hljs-number"><span class="hljs-number">261</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">257</span></span>,<span class="hljs-number"><span class="hljs-number">976</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">256</span></span>,<span class="hljs-number"><span class="hljs-number">103</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">255</span></span>,<span class="hljs-number"><span class="hljs-number">863</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">266</span></span>,<span class="hljs-number"><span class="hljs-number">376</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">258</span></span>,<span class="hljs-number"><span class="hljs-number">158</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">278</span></span>,<span class="hljs-number"><span class="hljs-number">038</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">271</span></span>,<span class="hljs-number"><span class="hljs-number">354</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">256</span></span>,<span class="hljs-number"><span class="hljs-number">021</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">254</span></span>,<span class="hljs-number"><span class="hljs-number">590</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">254</span></span>,<span class="hljs-number"><span class="hljs-number">944</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">255</span></span>,<span class="hljs-number"><span class="hljs-number">525</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">256</span></span>,<span class="hljs-number"><span class="hljs-number">339</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">257</span></span>,<span class="hljs-number"><span class="hljs-number">311</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamWithoutBiasedLockingBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">260</span></span>,<span class="hljs-number"><span class="hljs-number">866</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">366</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">254</span></span>,<span class="hljs-number"><span class="hljs-number">590</span></span>, <span class="hljs-number"><span class="hljs-number">260</span></span>,<span class="hljs-number"><span class="hljs-number">866</span></span>, <span class="hljs-number"><span class="hljs-number">278</span></span>,<span class="hljs-number"><span class="hljs-number">038</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">248</span></span>,<span class="hljs-number"><span class="hljs-number">499</span></span>, <span class="hljs-number"><span class="hljs-number">273</span></span>,<span class="hljs-number"><span class="hljs-number">232</span></span>] (assumes normal distribution) # Run complete. Total <span class="hljs-type"><span class="hljs-type">time</span></span>: <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> Benchmark Mode Cnt Score Error Units StreamWithoutBiasedLockingBenchmark.forEachParallelStreamBenchmark avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">703</span></span>,<span class="hljs-number"><span class="hljs-number">067</span></span> ¬± <span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">058</span></span> us/op StreamWithoutBiasedLockingBenchmark.forEachStreamBenchmark avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">260</span></span>,<span class="hljs-number"><span class="hljs-number">866</span></span> ¬± <span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">366</span></span> us/op</code> </pre></div></div><br>  The expected performance slipped through the performance of the usual <code>ArrayList.forEach()</code> .  At the same time, the acceleration is noticeable in the warm-up iterations in the previous benchmark, starting from the third iteration, this is not an accident.  The fact is that by default <b>biased locking is</b> turned on after <i>4000 ms</i> from the moment the virtual machine is started.  You can test this value and see what happens: <br><br><div class="spoiler">  <b class="spoiler_title">Benchmark with increased biased locking time</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.gnkoshelev.jbreak2018.perf_tests.for_each; <span class="hljs-meta"><span class="hljs-meta">@Fork</span></span>(value = <span class="hljs-number"><span class="hljs-number">1</span></span>, warmups = <span class="hljs-number"><span class="hljs-number">0</span></span>, jvmArgsAppend = <span class="hljs-string"><span class="hljs-string">"-XX:BiasedLockingStartupDelay=6000"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Warmup</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">5</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@Measurement</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">10</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@OutputTimeUnit</span></span>(value = TimeUnit.MICROSECONDS) <span class="hljs-meta"><span class="hljs-meta">@BenchmarkMode</span></span>(Mode.AverageTime) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StreamWithNewBiasedLockingStartupDelayBenchmark</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> N = <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> List&lt;Integer&gt; values; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> { Random rand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(<span class="hljs-number"><span class="hljs-number">12345</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = N; values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; size; i++) { values.add(rand.nextInt()); } } <span class="hljs-meta"><span class="hljs-meta">@State</span></span>(value = Scope.Benchmark) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PrintStreamHolder</span></span></span><span class="hljs-class"> </span></span>{ PrintStream ps; <span class="hljs-meta"><span class="hljs-meta">@Setup</span></span>(value = Level.Iteration) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ps = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PrintStream(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NullOutputStream()); } } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStreamBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PrintStreamHolder psh)</span></span></span><span class="hljs-function"> </span></span>{ forEachStream(values, psh.ps); } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachParallelStreamBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PrintStreamHolder psh)</span></span></span><span class="hljs-function"> </span></span>{ forEachParallelStream(values, psh.ps); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.stream().forEach(ps::println); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachParallelStream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.parallelStream().forEach(ps::println); } }</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">results</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"># JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: -XX:BiasedLockingStartupDelay=<span class="hljs-number"><span class="hljs-number">6000</span></span> # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamWithNewBiasedLockingStartupDelayBenchmark.forEachParallelStreamBenchmark # Run progress: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">954</span></span>,<span class="hljs-number"><span class="hljs-number">533</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">866</span></span>,<span class="hljs-number"><span class="hljs-number">854</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">907</span></span>,<span class="hljs-number"><span class="hljs-number">109</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">914</span></span>,<span class="hljs-number"><span class="hljs-number">717</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">924</span></span>,<span class="hljs-number"><span class="hljs-number">102</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">912</span></span>,<span class="hljs-number"><span class="hljs-number">619</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">947</span></span>,<span class="hljs-number"><span class="hljs-number">812</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">925</span></span>,<span class="hljs-number"><span class="hljs-number">730</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">933</span></span>,<span class="hljs-number"><span class="hljs-number">807</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">935</span></span>,<span class="hljs-number"><span class="hljs-number">927</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">852</span></span>,<span class="hljs-number"><span class="hljs-number">369</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">882</span></span>,<span class="hljs-number"><span class="hljs-number">498</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">852</span></span>,<span class="hljs-number"><span class="hljs-number">625</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">898</span></span>,<span class="hljs-number"><span class="hljs-number">787</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">1150</span></span>,<span class="hljs-number"><span class="hljs-number">831</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamWithNewBiasedLockingStartupDelayBenchmark.forEachParallelStreamBenchmark": <span class="hljs-number"><span class="hljs-number">929</span></span>,<span class="hljs-number"><span class="hljs-number">301</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">128</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">852</span></span>,<span class="hljs-number"><span class="hljs-number">369</span></span>, <span class="hljs-number"><span class="hljs-number">929</span></span>,<span class="hljs-number"><span class="hljs-number">301</span></span>, <span class="hljs-number"><span class="hljs-number">1150</span></span>,<span class="hljs-number"><span class="hljs-number">831</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">84</span></span>,<span class="hljs-number"><span class="hljs-number">783</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">801</span></span>,<span class="hljs-number"><span class="hljs-number">121</span></span>, <span class="hljs-number"><span class="hljs-number">1057</span></span>,<span class="hljs-number"><span class="hljs-number">480</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: -XX:BiasedLockingStartupDelay=<span class="hljs-number"><span class="hljs-number">6000</span></span> # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamWithNewBiasedLockingStartupDelayBenchmark.forEachStreamBenchmark # Run progress: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">346</span></span>,<span class="hljs-number"><span class="hljs-number">853</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">280</span></span>,<span class="hljs-number"><span class="hljs-number">643</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">264</span></span>,<span class="hljs-number"><span class="hljs-number">425</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">169</span></span>,<span class="hljs-number"><span class="hljs-number">200</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">167</span></span>,<span class="hljs-number"><span class="hljs-number">981</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">171</span></span>,<span class="hljs-number"><span class="hljs-number">230</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">169</span></span>,<span class="hljs-number"><span class="hljs-number">891</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">169</span></span>,<span class="hljs-number"><span class="hljs-number">124</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">167</span></span>,<span class="hljs-number"><span class="hljs-number">938</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">167</span></span>,<span class="hljs-number"><span class="hljs-number">471</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">176</span></span>,<span class="hljs-number"><span class="hljs-number">187</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">171</span></span>,<span class="hljs-number"><span class="hljs-number">791</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">170</span></span>,<span class="hljs-number"><span class="hljs-number">127</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">169</span></span>,<span class="hljs-number"><span class="hljs-number">563</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">169</span></span>,<span class="hljs-number"><span class="hljs-number">062</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.StreamWithNewBiasedLockingStartupDelayBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">170</span></span>,<span class="hljs-number"><span class="hljs-number">238</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">736</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">167</span></span>,<span class="hljs-number"><span class="hljs-number">471</span></span>, <span class="hljs-number"><span class="hljs-number">170</span></span>,<span class="hljs-number"><span class="hljs-number">238</span></span>, <span class="hljs-number"><span class="hljs-number">176</span></span>,<span class="hljs-number"><span class="hljs-number">187</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">471</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">166</span></span>,<span class="hljs-number"><span class="hljs-number">503</span></span>, <span class="hljs-number"><span class="hljs-number">173</span></span>,<span class="hljs-number"><span class="hljs-number">974</span></span>] (assumes normal distribution) # Run complete. Total <span class="hljs-type"><span class="hljs-type">time</span></span>: <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> Benchmark Mode Cnt Score Error Units StreamWithNewBiasedLockingStartupDelayBenchmark.forEachParallelStreamBenchmark avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">929</span></span>,<span class="hljs-number"><span class="hljs-number">301</span></span> ¬± <span class="hljs-number"><span class="hljs-number">128</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span> us/op StreamWithNewBiasedLockingStartupDelayBenchmark.forEachStreamBenchmark avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">170</span></span>,<span class="hljs-number"><span class="hljs-number">238</span></span> ¬± <span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">736</span></span> us/op</code> </pre></div></div><br>  As expected, the effect of <b>biased locking</b> came only after <i>6 seconds</i> from the beginning of the benchmark execution - this is evident from the difference in the execution times of the third and fourth warm-up iteration. <br><br><h4>  List.forEach () vs List.stream (). ForEach () </h4><br>  Now it's time to figure out what is faster: <code>List.forEach()</code> or <code>List.stream().forEach()</code> .  The correct answer is <i>"depends on"</i> .  The result is influenced by the size of the list, the type of list, the possibility of using inlinings and other optimizations by the JIT compiler.  Perhaps we will be able to identify the general rule.  Below is the result for <code>ArrayList</code> : <br><br><div class="spoiler">  <b class="spoiler_title">Benchmark</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.gnkoshelev.jbreak2018.perf_tests.for_each; <span class="hljs-meta"><span class="hljs-meta">@Fork</span></span>(value = <span class="hljs-number"><span class="hljs-number">1</span></span>, warmups = <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Warmup</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">5</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@Measurement</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">10</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@OutputTimeUnit</span></span>(value = TimeUnit.MICROSECONDS) <span class="hljs-meta"><span class="hljs-meta">@BenchmarkMode</span></span>(Mode.AverageTime) <span class="hljs-meta"><span class="hljs-meta">@State</span></span>(Scope.Benchmark) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArrayListVsStreamBenchmark</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Param</span></span>(value = {<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"10"</span></span>, <span class="hljs-string"><span class="hljs-string">"100"</span></span>, <span class="hljs-string"><span class="hljs-string">"1000"</span></span>, <span class="hljs-string"><span class="hljs-string">"10000"</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> N; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Integer&gt; values; <span class="hljs-meta"><span class="hljs-meta">@Setup</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Random rand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(<span class="hljs-number"><span class="hljs-number">12345</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = N; values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; size; i++) { values.add(rand.nextInt()); } } <span class="hljs-meta"><span class="hljs-meta">@State</span></span>(value = Scope.Benchmark) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PrintStreamHolder</span></span></span><span class="hljs-class"> </span></span>{ PrintStream ps; <span class="hljs-meta"><span class="hljs-meta">@Setup</span></span>(value = Level.Iteration) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ps = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PrintStream(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NullOutputStream()); } } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachListBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PrintStreamHolder psh)</span></span></span><span class="hljs-function"> </span></span>{ forEachList(values, psh.ps); } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStreamBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PrintStreamHolder psh)</span></span></span><span class="hljs-function"> </span></span>{ forEachStream(values, psh.ps); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.forEach(ps::println); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, PrintStream ps)</span></span></span><span class="hljs-function"> </span></span>{ values.stream().forEach(ps::println); } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">results</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"># JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">1</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">05</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">288</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">277</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">177</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">177</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">001</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">177</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">001</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">177</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">10</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">33</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">933</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">839</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">661</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">675</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">674</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">682</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">653</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">658</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">656</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">659</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">655</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">656</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">657</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">661</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">660</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">660</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">013</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">653</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">660</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">682</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">008</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">647</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">672</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">100</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">27</span></span>,<span class="hljs-number"><span class="hljs-number">633</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">27</span></span>,<span class="hljs-number"><span class="hljs-number">184</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">046</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">064</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">060</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">039</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">057</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">065</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">062</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">086</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">060</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">110</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">070</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">111</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">079</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">074</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">035</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">039</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">074</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">111</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">023</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">039</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">109</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">1000</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span>:<span class="hljs-number"><span class="hljs-number">32</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">291</span></span>,<span class="hljs-number"><span class="hljs-number">532</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">267</span></span>,<span class="hljs-number"><span class="hljs-number">136</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">170</span></span>,<span class="hljs-number"><span class="hljs-number">432</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">170</span></span>,<span class="hljs-number"><span class="hljs-number">388</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">169</span></span>,<span class="hljs-number"><span class="hljs-number">797</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">170</span></span>,<span class="hljs-number"><span class="hljs-number">036</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">176</span></span>,<span class="hljs-number"><span class="hljs-number">614</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">176</span></span>,<span class="hljs-number"><span class="hljs-number">396</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">175</span></span>,<span class="hljs-number"><span class="hljs-number">895</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">176</span></span>,<span class="hljs-number"><span class="hljs-number">984</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">172</span></span>,<span class="hljs-number"><span class="hljs-number">085</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">170</span></span>,<span class="hljs-number"><span class="hljs-number">193</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">171</span></span>,<span class="hljs-number"><span class="hljs-number">333</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">170</span></span>,<span class="hljs-number"><span class="hljs-number">293</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">171</span></span>,<span class="hljs-number"><span class="hljs-number">006</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">173</span></span>,<span class="hljs-number"><span class="hljs-number">084</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">518</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">170</span></span>,<span class="hljs-number"><span class="hljs-number">036</span></span>, <span class="hljs-number"><span class="hljs-number">173</span></span>,<span class="hljs-number"><span class="hljs-number">084</span></span>, <span class="hljs-number"><span class="hljs-number">176</span></span>,<span class="hljs-number"><span class="hljs-number">984</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">988</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">168</span></span>,<span class="hljs-number"><span class="hljs-number">566</span></span>, <span class="hljs-number"><span class="hljs-number">177</span></span>,<span class="hljs-number"><span class="hljs-number">601</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">10000</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">40</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">2890</span></span>,<span class="hljs-number"><span class="hljs-number">241</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">2784</span></span>,<span class="hljs-number"><span class="hljs-number">740</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">1725</span></span>,<span class="hljs-number"><span class="hljs-number">390</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">1726</span></span>,<span class="hljs-number"><span class="hljs-number">138</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">1733</span></span>,<span class="hljs-number"><span class="hljs-number">212</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">1726</span></span>,<span class="hljs-number"><span class="hljs-number">084</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">1712</span></span>,<span class="hljs-number"><span class="hljs-number">973</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">1715</span></span>,<span class="hljs-number"><span class="hljs-number">916</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">1750</span></span>,<span class="hljs-number"><span class="hljs-number">530</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">1721</span></span>,<span class="hljs-number"><span class="hljs-number">900</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">1711</span></span>,<span class="hljs-number"><span class="hljs-number">158</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">1709</span></span>,<span class="hljs-number"><span class="hljs-number">659</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">1726</span></span>,<span class="hljs-number"><span class="hljs-number">751</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">1737</span></span>,<span class="hljs-number"><span class="hljs-number">237</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">1734</span></span>,<span class="hljs-number"><span class="hljs-number">220</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">1724</span></span>,<span class="hljs-number"><span class="hljs-number">643</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">861</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">1709</span></span>,<span class="hljs-number"><span class="hljs-number">659</span></span>, <span class="hljs-number"><span class="hljs-number">1724</span></span>,<span class="hljs-number"><span class="hljs-number">643</span></span>, <span class="hljs-number"><span class="hljs-number">1750</span></span>,<span class="hljs-number"><span class="hljs-number">530</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">13</span></span>,<span class="hljs-number"><span class="hljs-number">137</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">1704</span></span>,<span class="hljs-number"><span class="hljs-number">782</span></span>, <span class="hljs-number"><span class="hljs-number">1744</span></span>,<span class="hljs-number"><span class="hljs-number">504</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">1</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">31</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">301</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">289</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">181</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">181</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">001</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">001</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">10</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">60</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">660</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">551</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">558</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">563</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">563</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">557</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">553</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">567</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">555</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">569</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">570</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">562</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">561</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">564</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">580</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">564</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">012</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">553</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">564</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">580</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">008</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">552</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">576</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">100</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">70</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">27</span></span>,<span class="hljs-number"><span class="hljs-number">754</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">26</span></span>,<span class="hljs-number"><span class="hljs-number">859</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">456</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">548</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">432</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">399</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">480</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">517</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">458</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">395</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">471</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">595</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">585</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">460</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">435</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">479</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">104</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">395</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">479</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">595</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">069</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">376</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">583</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">1000</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">80</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">291</span></span>,<span class="hljs-number"><span class="hljs-number">695</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">282</span></span>,<span class="hljs-number"><span class="hljs-number">896</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">185</span></span>,<span class="hljs-number"><span class="hljs-number">443</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">187</span></span>,<span class="hljs-number"><span class="hljs-number">851</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">184</span></span>,<span class="hljs-number"><span class="hljs-number">393</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">184</span></span>,<span class="hljs-number"><span class="hljs-number">584</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">185</span></span>,<span class="hljs-number"><span class="hljs-number">349</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">184</span></span>,<span class="hljs-number"><span class="hljs-number">803</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">184</span></span>,<span class="hljs-number"><span class="hljs-number">394</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">185</span></span>,<span class="hljs-number"><span class="hljs-number">371</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">186</span></span>,<span class="hljs-number"><span class="hljs-number">735</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">185</span></span>,<span class="hljs-number"><span class="hljs-number">945</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">188</span></span>,<span class="hljs-number"><span class="hljs-number">592</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">186</span></span>,<span class="hljs-number"><span class="hljs-number">581</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">187</span></span>,<span class="hljs-number"><span class="hljs-number">908</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">186</span></span>,<span class="hljs-number"><span class="hljs-number">026</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">142</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">184</span></span>,<span class="hljs-number"><span class="hljs-number">394</span></span>, <span class="hljs-number"><span class="hljs-number">186</span></span>,<span class="hljs-number"><span class="hljs-number">026</span></span>, <span class="hljs-number"><span class="hljs-number">188</span></span>,<span class="hljs-number"><span class="hljs-number">592</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">417</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">183</span></span>,<span class="hljs-number"><span class="hljs-number">884</span></span>, <span class="hljs-number"><span class="hljs-number">188</span></span>,<span class="hljs-number"><span class="hljs-number">168</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">10000</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">90</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">2896</span></span>,<span class="hljs-number"><span class="hljs-number">624</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">2816</span></span>,<span class="hljs-number"><span class="hljs-number">471</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">1732</span></span>,<span class="hljs-number"><span class="hljs-number">597</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">1798</span></span>,<span class="hljs-number"><span class="hljs-number">371</span></span> us/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">1758</span></span>,<span class="hljs-number"><span class="hljs-number">489</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">1615</span></span>,<span class="hljs-number"><span class="hljs-number">213</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">1518</span></span>,<span class="hljs-number"><span class="hljs-number">388</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">1513</span></span>,<span class="hljs-number"><span class="hljs-number">955</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">1520</span></span>,<span class="hljs-number"><span class="hljs-number">570</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">1525</span></span>,<span class="hljs-number"><span class="hljs-number">072</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">1527</span></span>,<span class="hljs-number"><span class="hljs-number">055</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">1547</span></span>,<span class="hljs-number"><span class="hljs-number">707</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">1532</span></span>,<span class="hljs-number"><span class="hljs-number">163</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">1519</span></span>,<span class="hljs-number"><span class="hljs-number">474</span></span> us/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">1529</span></span>,<span class="hljs-number"><span class="hljs-number">969</span></span> us/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.ArrayListVsStreamBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">1534</span></span>,<span class="hljs-number"><span class="hljs-number">957</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">44</span></span>,<span class="hljs-number"><span class="hljs-number">959</span></span> us/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">1513</span></span>,<span class="hljs-number"><span class="hljs-number">955</span></span>, <span class="hljs-number"><span class="hljs-number">1534</span></span>,<span class="hljs-number"><span class="hljs-number">957</span></span>, <span class="hljs-number"><span class="hljs-number">1615</span></span>,<span class="hljs-number"><span class="hljs-number">213</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">29</span></span>,<span class="hljs-number"><span class="hljs-number">737</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">1489</span></span>,<span class="hljs-number"><span class="hljs-number">998</span></span>, <span class="hljs-number"><span class="hljs-number">1579</span></span>,<span class="hljs-number"><span class="hljs-number">915</span></span>] (assumes normal distribution) # Run complete. Total <span class="hljs-type"><span class="hljs-type">time</span></span>: <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">05</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span> Benchmark (N) Mode Cnt Score Error Units ArrayListVsStreamBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">1</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">178</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">001</span></span> us/op ArrayListVsStreamBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">10</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">660</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">013</span></span> us/op ArrayListVsStreamBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">100</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">074</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">035</span></span> us/op ArrayListVsStreamBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">1000</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">173</span></span>,<span class="hljs-number"><span class="hljs-number">084</span></span> ¬± <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">518</span></span> us/op ArrayListVsStreamBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">10000</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">1724</span></span>,<span class="hljs-number"><span class="hljs-number">643</span></span> ¬± <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">861</span></span> us/op ArrayListVsStreamBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">1</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">179</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">001</span></span> us/op ArrayListVsStreamBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">10</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">564</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">012</span></span> us/op ArrayListVsStreamBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">100</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">479</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">104</span></span> us/op ArrayListVsStreamBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">1000</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">186</span></span>,<span class="hljs-number"><span class="hljs-number">026</span></span> ¬± <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">142</span></span> us/op ArrayListVsStreamBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">10000</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">1534</span></span>,<span class="hljs-number"><span class="hljs-number">957</span></span> ¬± <span class="hljs-number"><span class="hljs-number">44</span></span>,<span class="hljs-number"><span class="hljs-number">959</span></span> us/op</code> </pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In fact, the overhead of an iteration is much less than the overhead of a method call </font></font><code>PrintStream.println()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">To make sure of this, it is enough to replace the method call </font></font><code>PrintStrim.println()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with the call </font></font><code>Blackhole.consume()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(the latter ensures that the JIT compiler does not cut out the useless part of the code and the iteration will work). </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Please note that the result is not in microseconds, but in nanoseconds!</font></font></b> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benchmark with Blackhole.consume ()</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.gnkoshelev.jbreak2018.perf_tests.for_each; <span class="hljs-meta"><span class="hljs-meta">@Fork</span></span>(value = <span class="hljs-number"><span class="hljs-number">1</span></span>, warmups = <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Warmup</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">5</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@Measurement</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">10</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@OutputTimeUnit</span></span>(value = TimeUnit.NANOSECONDS) <span class="hljs-meta"><span class="hljs-meta">@BenchmarkMode</span></span>(Mode.AverageTime) <span class="hljs-meta"><span class="hljs-meta">@State</span></span>(Scope.Benchmark) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BlackholeConsumingBenchmark</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Param</span></span>(value = {<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"10"</span></span>, <span class="hljs-string"><span class="hljs-string">"100"</span></span>, <span class="hljs-string"><span class="hljs-string">"1000"</span></span>, <span class="hljs-string"><span class="hljs-string">"10000"</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> N; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Integer&gt; values; <span class="hljs-meta"><span class="hljs-meta">@Setup</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Random rand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(<span class="hljs-number"><span class="hljs-number">12345</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = N; values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; size; i++) { values.add(rand.nextInt()); } } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachListBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Blackhole bh)</span></span></span><span class="hljs-function"> </span></span>{ forEachList(values, bh); } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStreamBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Blackhole bh)</span></span></span><span class="hljs-function"> </span></span>{ forEachStream(values, bh); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, Blackhole bh)</span></span></span><span class="hljs-function"> </span></span>{ values.forEach(bh::consume); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values, Blackhole bh)</span></span></span><span class="hljs-function"> </span></span>{ values.stream().forEach(bh::consume); } }</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">results</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"># JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">1</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">05</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">866</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">865</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">528</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">524</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">521</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">519</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">542</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">608</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">590</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">678</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">658</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">756</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">933</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">939</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">811</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">703</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">230</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">519</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">703</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">939</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">152</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">474</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">933</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">10</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">32</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">51</span></span>,<span class="hljs-number"><span class="hljs-number">655</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">507</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">309</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">886</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">068</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">51</span></span>,<span class="hljs-number"><span class="hljs-number">218</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">108</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">52</span></span>,<span class="hljs-number"><span class="hljs-number">343</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">745</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">51</span></span>,<span class="hljs-number"><span class="hljs-number">461</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">366</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">49</span></span>,<span class="hljs-number"><span class="hljs-number">976</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">623</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">223</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">125</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">719</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">138</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">49</span></span>,<span class="hljs-number"><span class="hljs-number">976</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">719</span></span>, <span class="hljs-number"><span class="hljs-number">52</span></span>,<span class="hljs-number"><span class="hljs-number">343</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">753</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">49</span></span>,<span class="hljs-number"><span class="hljs-number">581</span></span>, <span class="hljs-number"><span class="hljs-number">51</span></span>,<span class="hljs-number"><span class="hljs-number">857</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">100</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">574</span></span>,<span class="hljs-number"><span class="hljs-number">874</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">557</span></span>,<span class="hljs-number"><span class="hljs-number">543</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">557</span></span>,<span class="hljs-number"><span class="hljs-number">260</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">556</span></span>,<span class="hljs-number"><span class="hljs-number">273</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">556</span></span>,<span class="hljs-number"><span class="hljs-number">025</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">555</span></span>,<span class="hljs-number"><span class="hljs-number">532</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">558</span></span>,<span class="hljs-number"><span class="hljs-number">421</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">564</span></span>,<span class="hljs-number"><span class="hljs-number">582</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">573</span></span>,<span class="hljs-number"><span class="hljs-number">368</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">576</span></span>,<span class="hljs-number"><span class="hljs-number">355</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">562</span></span>,<span class="hljs-number"><span class="hljs-number">087</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">565</span></span>,<span class="hljs-number"><span class="hljs-number">229</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">574</span></span>,<span class="hljs-number"><span class="hljs-number">557</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">561</span></span>,<span class="hljs-number"><span class="hljs-number">430</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">574</span></span>,<span class="hljs-number"><span class="hljs-number">486</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">566</span></span>,<span class="hljs-number"><span class="hljs-number">605</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-number"><span class="hljs-number">369</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">555</span></span>,<span class="hljs-number"><span class="hljs-number">532</span></span>, <span class="hljs-number"><span class="hljs-number">566</span></span>,<span class="hljs-number"><span class="hljs-number">605</span></span>, <span class="hljs-number"><span class="hljs-number">576</span></span>,<span class="hljs-number"><span class="hljs-number">355</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">7</span></span>,<span class="hljs-number"><span class="hljs-number">520</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">555</span></span>,<span class="hljs-number"><span class="hljs-number">236</span></span>, <span class="hljs-number"><span class="hljs-number">577</span></span>,<span class="hljs-number"><span class="hljs-number">974</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">1000</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span>:<span class="hljs-number"><span class="hljs-number">32</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">4782</span></span>,<span class="hljs-number"><span class="hljs-number">869</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">4920</span></span>,<span class="hljs-number"><span class="hljs-number">389</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">4845</span></span>,<span class="hljs-number"><span class="hljs-number">857</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">4847</span></span>,<span class="hljs-number"><span class="hljs-number">470</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">4857</span></span>,<span class="hljs-number"><span class="hljs-number">726</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">4850</span></span>,<span class="hljs-number"><span class="hljs-number">519</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">4852</span></span>,<span class="hljs-number"><span class="hljs-number">075</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">4907</span></span>,<span class="hljs-number"><span class="hljs-number">015</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">4859</span></span>,<span class="hljs-number"><span class="hljs-number">020</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">4879</span></span>,<span class="hljs-number"><span class="hljs-number">201</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">4832</span></span>,<span class="hljs-number"><span class="hljs-number">822</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">4831</span></span>,<span class="hljs-number"><span class="hljs-number">532</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">4829</span></span>,<span class="hljs-number"><span class="hljs-number">599</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">4878</span></span>,<span class="hljs-number"><span class="hljs-number">201</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">4826</span></span>,<span class="hljs-number"><span class="hljs-number">464</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">4854</span></span>,<span class="hljs-number"><span class="hljs-number">645</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">40</span></span>,<span class="hljs-number"><span class="hljs-number">238</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">4826</span></span>,<span class="hljs-number"><span class="hljs-number">464</span></span>, <span class="hljs-number"><span class="hljs-number">4854</span></span>,<span class="hljs-number"><span class="hljs-number">645</span></span>, <span class="hljs-number"><span class="hljs-number">4907</span></span>,<span class="hljs-number"><span class="hljs-number">015</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">26</span></span>,<span class="hljs-number"><span class="hljs-number">615</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">4814</span></span>,<span class="hljs-number"><span class="hljs-number">407</span></span>, <span class="hljs-number"><span class="hljs-number">4894</span></span>,<span class="hljs-number"><span class="hljs-number">883</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">10000</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">40</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">42925</span></span>,<span class="hljs-number"><span class="hljs-number">340</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">47991</span></span>,<span class="hljs-number"><span class="hljs-number">419</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">50854</span></span>,<span class="hljs-number"><span class="hljs-number">318</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">51251</span></span>,<span class="hljs-number"><span class="hljs-number">774</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">51756</span></span>,<span class="hljs-number"><span class="hljs-number">902</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">51102</span></span>,<span class="hljs-number"><span class="hljs-number">960</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">51420</span></span>,<span class="hljs-number"><span class="hljs-number">802</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">51744</span></span>,<span class="hljs-number"><span class="hljs-number">142</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">50985</span></span>,<span class="hljs-number"><span class="hljs-number">401</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">51125</span></span>,<span class="hljs-number"><span class="hljs-number">197</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">51223</span></span>,<span class="hljs-number"><span class="hljs-number">229</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">51424</span></span>,<span class="hljs-number"><span class="hljs-number">190</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">51457</span></span>,<span class="hljs-number"><span class="hljs-number">326</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">51410</span></span>,<span class="hljs-number"><span class="hljs-number">258</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">51419</span></span>,<span class="hljs-number"><span class="hljs-number">014</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">51331</span></span>,<span class="hljs-number"><span class="hljs-number">252</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">335</span></span>,<span class="hljs-number"><span class="hljs-number">358</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">50985</span></span>,<span class="hljs-number"><span class="hljs-number">401</span></span>, <span class="hljs-number"><span class="hljs-number">51331</span></span>,<span class="hljs-number"><span class="hljs-number">252</span></span>, <span class="hljs-number"><span class="hljs-number">51744</span></span>,<span class="hljs-number"><span class="hljs-number">142</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">221</span></span>,<span class="hljs-number"><span class="hljs-number">819</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">50995</span></span>,<span class="hljs-number"><span class="hljs-number">894</span></span>, <span class="hljs-number"><span class="hljs-number">51666</span></span>,<span class="hljs-number"><span class="hljs-number">610</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">1</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">31</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">963</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">840</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">882</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">081</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">513</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">411</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">856</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">049</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">891</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">136</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">116</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">490</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">251</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">767</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">607</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">357</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">607</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">856</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">357</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">116</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">401</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">751</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">964</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">10</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">60</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">59</span></span>,<span class="hljs-number"><span class="hljs-number">828</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">52</span></span>,<span class="hljs-number"><span class="hljs-number">901</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">44</span></span>,<span class="hljs-number"><span class="hljs-number">941</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">44</span></span>,<span class="hljs-number"><span class="hljs-number">833</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">44</span></span>,<span class="hljs-number"><span class="hljs-number">962</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">46</span></span>,<span class="hljs-number"><span class="hljs-number">032</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">45</span></span>,<span class="hljs-number"><span class="hljs-number">802</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">45</span></span>,<span class="hljs-number"><span class="hljs-number">018</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">45</span></span>,<span class="hljs-number"><span class="hljs-number">704</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">45</span></span>,<span class="hljs-number"><span class="hljs-number">788</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">46</span></span>,<span class="hljs-number"><span class="hljs-number">674</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">46</span></span>,<span class="hljs-number"><span class="hljs-number">588</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">48</span></span>,<span class="hljs-number"><span class="hljs-number">083</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">46</span></span>,<span class="hljs-number"><span class="hljs-number">862</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">47</span></span>,<span class="hljs-number"><span class="hljs-number">087</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">46</span></span>,<span class="hljs-number"><span class="hljs-number">364</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">321</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">45</span></span>,<span class="hljs-number"><span class="hljs-number">018</span></span>, <span class="hljs-number"><span class="hljs-number">46</span></span>,<span class="hljs-number"><span class="hljs-number">364</span></span>, <span class="hljs-number"><span class="hljs-number">48</span></span>,<span class="hljs-number"><span class="hljs-number">083</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">874</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">45</span></span>,<span class="hljs-number"><span class="hljs-number">042</span></span>, <span class="hljs-number"><span class="hljs-number">47</span></span>,<span class="hljs-number"><span class="hljs-number">685</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">100</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">70</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">31</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">382</span></span>,<span class="hljs-number"><span class="hljs-number">038</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">347</span></span>,<span class="hljs-number"><span class="hljs-number">846</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">337</span></span>,<span class="hljs-number"><span class="hljs-number">712</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">335</span></span>,<span class="hljs-number"><span class="hljs-number">078</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">344</span></span>,<span class="hljs-number"><span class="hljs-number">895</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">329</span></span>,<span class="hljs-number"><span class="hljs-number">577</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">328</span></span>,<span class="hljs-number"><span class="hljs-number">436</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">329</span></span>,<span class="hljs-number"><span class="hljs-number">517</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">330</span></span>,<span class="hljs-number"><span class="hljs-number">736</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">335</span></span>,<span class="hljs-number"><span class="hljs-number">464</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">338</span></span>,<span class="hljs-number"><span class="hljs-number">727</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">330</span></span>,<span class="hljs-number"><span class="hljs-number">996</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">330</span></span>,<span class="hljs-number"><span class="hljs-number">809</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">329</span></span>,<span class="hljs-number"><span class="hljs-number">599</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">330</span></span>,<span class="hljs-number"><span class="hljs-number">580</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">331</span></span>,<span class="hljs-number"><span class="hljs-number">444</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">800</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">328</span></span>,<span class="hljs-number"><span class="hljs-number">436</span></span>, <span class="hljs-number"><span class="hljs-number">331</span></span>,<span class="hljs-number"><span class="hljs-number">444</span></span>, <span class="hljs-number"><span class="hljs-number">338</span></span>,<span class="hljs-number"><span class="hljs-number">727</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">175</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">326</span></span>,<span class="hljs-number"><span class="hljs-number">645</span></span>, <span class="hljs-number"><span class="hljs-number">336</span></span>,<span class="hljs-number"><span class="hljs-number">244</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">1000</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">80</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">3734</span></span>,<span class="hljs-number"><span class="hljs-number">819</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">3534</span></span>,<span class="hljs-number"><span class="hljs-number">547</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">3201</span></span>,<span class="hljs-number"><span class="hljs-number">812</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">3151</span></span>,<span class="hljs-number"><span class="hljs-number">474</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">3136</span></span>,<span class="hljs-number"><span class="hljs-number">897</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">3138</span></span>,<span class="hljs-number"><span class="hljs-number">505</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">3137</span></span>,<span class="hljs-number"><span class="hljs-number">993</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">3141</span></span>,<span class="hljs-number"><span class="hljs-number">723</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">3225</span></span>,<span class="hljs-number"><span class="hljs-number">711</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">3127</span></span>,<span class="hljs-number"><span class="hljs-number">945</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">3129</span></span>,<span class="hljs-number"><span class="hljs-number">312</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">3141</span></span>,<span class="hljs-number"><span class="hljs-number">355</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">3137</span></span>,<span class="hljs-number"><span class="hljs-number">377</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">3149</span></span>,<span class="hljs-number"><span class="hljs-number">419</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">3243</span></span>,<span class="hljs-number"><span class="hljs-number">662</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">3157</span></span>,<span class="hljs-number"><span class="hljs-number">300</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">62</span></span>,<span class="hljs-number"><span class="hljs-number">671</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">3127</span></span>,<span class="hljs-number"><span class="hljs-number">945</span></span>, <span class="hljs-number"><span class="hljs-number">3157</span></span>,<span class="hljs-number"><span class="hljs-number">300</span></span>, <span class="hljs-number"><span class="hljs-number">3243</span></span>,<span class="hljs-number"><span class="hljs-number">662</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">41</span></span>,<span class="hljs-number"><span class="hljs-number">453</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">3094</span></span>,<span class="hljs-number"><span class="hljs-number">629</span></span>, <span class="hljs-number"><span class="hljs-number">3219</span></span>,<span class="hljs-number"><span class="hljs-number">972</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">10000</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">90</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">45988</span></span>,<span class="hljs-number"><span class="hljs-number">758</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">45331</span></span>,<span class="hljs-number"><span class="hljs-number">295</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">38213</span></span>,<span class="hljs-number"><span class="hljs-number">299</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">31233</span></span>,<span class="hljs-number"><span class="hljs-number">461</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">31321</span></span>,<span class="hljs-number"><span class="hljs-number">451</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">31470</span></span>,<span class="hljs-number"><span class="hljs-number">793</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">32267</span></span>,<span class="hljs-number"><span class="hljs-number">081</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">31619</span></span>,<span class="hljs-number"><span class="hljs-number">772</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">32155</span></span>,<span class="hljs-number"><span class="hljs-number">094</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">31304</span></span>,<span class="hljs-number"><span class="hljs-number">547</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">31484</span></span>,<span class="hljs-number"><span class="hljs-number">244</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">31709</span></span>,<span class="hljs-number"><span class="hljs-number">801</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">31297</span></span>,<span class="hljs-number"><span class="hljs-number">118</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">31305</span></span>,<span class="hljs-number"><span class="hljs-number">782</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">31320</span></span>,<span class="hljs-number"><span class="hljs-number">821</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.BlackholeConsumingBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">31593</span></span>,<span class="hljs-number"><span class="hljs-number">505</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">537</span></span>,<span class="hljs-number"><span class="hljs-number">786</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">31297</span></span>,<span class="hljs-number"><span class="hljs-number">118</span></span>, <span class="hljs-number"><span class="hljs-number">31593</span></span>,<span class="hljs-number"><span class="hljs-number">505</span></span>, <span class="hljs-number"><span class="hljs-number">32267</span></span>,<span class="hljs-number"><span class="hljs-number">081</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">355</span></span>,<span class="hljs-number"><span class="hljs-number">712</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">31055</span></span>,<span class="hljs-number"><span class="hljs-number">719</span></span>, <span class="hljs-number"><span class="hljs-number">32131</span></span>,<span class="hljs-number"><span class="hljs-number">292</span></span>] (assumes normal distribution) # Run complete. Total <span class="hljs-type"><span class="hljs-type">time</span></span>: <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">05</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span> Benchmark (N) Mode Cnt Score Error Units BlackholeConsumingBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">1</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">703</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">230</span></span> ns/op BlackholeConsumingBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">10</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">719</span></span> ¬± <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">138</span></span> ns/op BlackholeConsumingBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">100</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">566</span></span>,<span class="hljs-number"><span class="hljs-number">605</span></span> ¬± <span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-number"><span class="hljs-number">369</span></span> ns/op BlackholeConsumingBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">1000</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">4854</span></span>,<span class="hljs-number"><span class="hljs-number">645</span></span> ¬± <span class="hljs-number"><span class="hljs-number">40</span></span>,<span class="hljs-number"><span class="hljs-number">238</span></span> ns/op BlackholeConsumingBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">10000</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">51331</span></span>,<span class="hljs-number"><span class="hljs-number">252</span></span> ¬± <span class="hljs-number"><span class="hljs-number">335</span></span>,<span class="hljs-number"><span class="hljs-number">358</span></span> ns/op BlackholeConsumingBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">1</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">357</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">607</span></span> ns/op BlackholeConsumingBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">10</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">46</span></span>,<span class="hljs-number"><span class="hljs-number">364</span></span> ¬± <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">321</span></span> ns/op BlackholeConsumingBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">100</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">331</span></span>,<span class="hljs-number"><span class="hljs-number">444</span></span> ¬± <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">800</span></span> ns/op BlackholeConsumingBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">1000</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">3157</span></span>,<span class="hljs-number"><span class="hljs-number">300</span></span> ¬± <span class="hljs-number"><span class="hljs-number">62</span></span>,<span class="hljs-number"><span class="hljs-number">671</span></span> ns/op BlackholeConsumingBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">10000</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">31593</span></span>,<span class="hljs-number"><span class="hljs-number">505</span></span> ¬± <span class="hljs-number"><span class="hljs-number">537</span></span>,<span class="hljs-number"><span class="hljs-number">786</span></span> ns/op</code> </pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And it becomes more interesting: the difference between </font></font><code>ArrayList.forEach()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>ArrayList.stream().forEach()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">turned out to be quite large on long lists. </font><font style="vertical-align: inherit;">Moreover, warming does not accelerate in any way </font></font><code>ArrayList.forEach()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, whereas it is </font></font><code>ArrayList.stream().forEach()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">considerably accelerated. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The fact is that the creation overhead has </font></font><code>Stream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an effect only on small lists. </font><font style="vertical-align: inherit;">In the future, it all comes down to direct iteration. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It looks like this </font></font><code>ArrayList.forEach()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Consumer&lt;? </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">super</span></span></span></span><span class="hljs-function"><span class="hljs-params"> E&gt; action)</span></span></span><span class="hljs-function"> </span></span>{ Objects.requireNonNull(action); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> expectedModCount = modCount; <span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>(<span class="hljs-string"><span class="hljs-string">"unchecked"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> E[] elementData = (E[]) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.elementData; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.size; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; modCount == expectedModCount &amp;&amp; i &lt; size; i++) { action.accept(elementData[i]); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (modCount != expectedModCount) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentModificationException(); } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is what the code looks like </font></font><code>ArrayList.ArrayListSpliterator.forEachRemaining()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachRemaining</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Consumer&lt;? </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">super</span></span></span></span><span class="hljs-function"><span class="hljs-params"> E&gt; action)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i, hi, mc; <span class="hljs-comment"><span class="hljs-comment">// hoist accesses and checks from loop ArrayList&lt;E&gt; lst; Object[] a; if (action == null) throw new NullPointerException(); if ((lst = list) != null &amp;&amp; (a = lst.elementData) != null) { if ((hi = fence) &lt; 0) { mc = lst.modCount; hi = lst.size; } else mc = expectedModCount; if ((i = index) &gt;= 0 &amp;&amp; (index = hi) &lt;= a.length) { for (; i &lt; hi; ++i) { @SuppressWarnings("unchecked") E e = (E) a[i]; action.accept(e); } if (lst.modCount == mc) return; } } throw new ConcurrentModificationException(); }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you can see, the difference in the code is not significant (for loops inside methods): the JIT compiler comes into play later. </font><font style="vertical-align: inherit;">Andrew </font></font><a href="https://habrahabr.ru/users/apangin/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apangin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> helped to figure out what's the matter: it </font></font><code>Blackhole.consume()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">does not inline and the JIT compiler cannot properly optimize the code: in the end, both the field reading </font></font><code>modCount</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and the array boundaries </font><font style="vertical-align: inherit;">remain </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indeed, we will try to replace it </font></font><code>Blackhole.consume()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with our own homemade method:</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benchmark with another value consumer</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.gnkoshelev.jbreak2018.perf_tests.for_each; <span class="hljs-meta"><span class="hljs-meta">@Fork</span></span>(value = <span class="hljs-number"><span class="hljs-number">1</span></span>, warmups = <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Warmup</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">5</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@Measurement</span></span>(iterations = <span class="hljs-number"><span class="hljs-number">10</span></span>, time = <span class="hljs-number"><span class="hljs-number">2_000</span></span>, timeUnit = TimeUnit.MILLISECONDS) <span class="hljs-meta"><span class="hljs-meta">@OutputTimeUnit</span></span>(value = TimeUnit.NANOSECONDS) <span class="hljs-meta"><span class="hljs-meta">@BenchmarkMode</span></span>(Mode.AverageTime) <span class="hljs-meta"><span class="hljs-meta">@State</span></span>(Scope.Benchmark) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TrickyConsumingBenchmark</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Param</span></span>(value = {<span class="hljs-string"><span class="hljs-string">"100"</span></span>, <span class="hljs-string"><span class="hljs-string">"10000"</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> N; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Integer&gt; values; <span class="hljs-meta"><span class="hljs-meta">@Setup</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Random rand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(<span class="hljs-number"><span class="hljs-number">12345</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = N; values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; size; i++) { values.add(rand.nextInt()); } } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachListBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ forEachList(values); } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStreamBenchmark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ forEachStream(values); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values)</span></span></span><span class="hljs-function"> </span></span>{ values.forEach(TrickyConsumer::consume); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forEachStream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; values)</span></span></span><span class="hljs-function"> </span></span>{ values.stream().forEach(TrickyConsumer::consume); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TrickyConsumer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Integer value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">consume</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (! (value % <span class="hljs-number"><span class="hljs-number">100</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>)) { TrickyConsumer.value = value; } } } }</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">results</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"># JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.TrickyConsumingBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">100</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">205</span></span>,<span class="hljs-number"><span class="hljs-number">489</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">205</span></span>,<span class="hljs-number"><span class="hljs-number">514</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">216</span></span>,<span class="hljs-number"><span class="hljs-number">056</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">208</span></span>,<span class="hljs-number"><span class="hljs-number">956</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">204</span></span>,<span class="hljs-number"><span class="hljs-number">900</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">205</span></span>,<span class="hljs-number"><span class="hljs-number">535</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">210</span></span>,<span class="hljs-number"><span class="hljs-number">834</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">206</span></span>,<span class="hljs-number"><span class="hljs-number">050</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">205</span></span>,<span class="hljs-number"><span class="hljs-number">962</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">205</span></span>,<span class="hljs-number"><span class="hljs-number">285</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">205</span></span>,<span class="hljs-number"><span class="hljs-number">581</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">204</span></span>,<span class="hljs-number"><span class="hljs-number">991</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">209</span></span>,<span class="hljs-number"><span class="hljs-number">290</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">203</span></span>,<span class="hljs-number"><span class="hljs-number">927</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">204</span></span>,<span class="hljs-number"><span class="hljs-number">977</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.TrickyConsumingBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">206</span></span>,<span class="hljs-number"><span class="hljs-number">243</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">222</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">203</span></span>,<span class="hljs-number"><span class="hljs-number">927</span></span>, <span class="hljs-number"><span class="hljs-number">206</span></span>,<span class="hljs-number"><span class="hljs-number">243</span></span>, <span class="hljs-number"><span class="hljs-number">210</span></span>,<span class="hljs-number"><span class="hljs-number">834</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">131</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">203</span></span>,<span class="hljs-number"><span class="hljs-number">021</span></span>, <span class="hljs-number"><span class="hljs-number">209</span></span>,<span class="hljs-number"><span class="hljs-number">465</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.TrickyConsumingBenchmark.forEachListBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">10000</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">22733</span></span>,<span class="hljs-number"><span class="hljs-number">300</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">22197</span></span>,<span class="hljs-number"><span class="hljs-number">064</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">21640</span></span>,<span class="hljs-number"><span class="hljs-number">616</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">21411</span></span>,<span class="hljs-number"><span class="hljs-number">160</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">21702</span></span>,<span class="hljs-number"><span class="hljs-number">499</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">21921</span></span>,<span class="hljs-number"><span class="hljs-number">831</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">21970</span></span>,<span class="hljs-number"><span class="hljs-number">321</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">21409</span></span>,<span class="hljs-number"><span class="hljs-number">419</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">21171</span></span>,<span class="hljs-number"><span class="hljs-number">131</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">22011</span></span>,<span class="hljs-number"><span class="hljs-number">961</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">22063</span></span>,<span class="hljs-number"><span class="hljs-number">926</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">21825</span></span>,<span class="hljs-number"><span class="hljs-number">015</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">21820</span></span>,<span class="hljs-number"><span class="hljs-number">783</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">22089</span></span>,<span class="hljs-number"><span class="hljs-number">657</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">21626</span></span>,<span class="hljs-number"><span class="hljs-number">934</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.TrickyConsumingBenchmark.forEachListBenchmark": <span class="hljs-number"><span class="hljs-number">21791</span></span>,<span class="hljs-number"><span class="hljs-number">098</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">456</span></span>,<span class="hljs-number"><span class="hljs-number">511</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">21171</span></span>,<span class="hljs-number"><span class="hljs-number">131</span></span>, <span class="hljs-number"><span class="hljs-number">21791</span></span>,<span class="hljs-number"><span class="hljs-number">098</span></span>, <span class="hljs-number"><span class="hljs-number">22089</span></span>,<span class="hljs-number"><span class="hljs-number">657</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">301</span></span>,<span class="hljs-number"><span class="hljs-number">954</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">21334</span></span>,<span class="hljs-number"><span class="hljs-number">587</span></span>, <span class="hljs-number"><span class="hljs-number">22247</span></span>,<span class="hljs-number"><span class="hljs-number">609</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.TrickyConsumingBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">100</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">250</span></span>,<span class="hljs-number"><span class="hljs-number">480</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">247</span></span>,<span class="hljs-number"><span class="hljs-number">070</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">269</span></span>,<span class="hljs-number"><span class="hljs-number">745</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">269</span></span>,<span class="hljs-number"><span class="hljs-number">914</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">272</span></span>,<span class="hljs-number"><span class="hljs-number">912</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">269</span></span>,<span class="hljs-number"><span class="hljs-number">779</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">270</span></span>,<span class="hljs-number"><span class="hljs-number">502</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">269</span></span>,<span class="hljs-number"><span class="hljs-number">128</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">273</span></span>,<span class="hljs-number"><span class="hljs-number">862</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">275</span></span>,<span class="hljs-number"><span class="hljs-number">447</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">272</span></span>,<span class="hljs-number"><span class="hljs-number">090</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">271</span></span>,<span class="hljs-number"><span class="hljs-number">189</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">271</span></span>,<span class="hljs-number"><span class="hljs-number">714</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">269</span></span>,<span class="hljs-number"><span class="hljs-number">121</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">269</span></span>,<span class="hljs-number"><span class="hljs-number">913</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.TrickyConsumingBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">271</span></span>,<span class="hljs-number"><span class="hljs-number">275</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">144</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">269</span></span>,<span class="hljs-number"><span class="hljs-number">121</span></span>, <span class="hljs-number"><span class="hljs-number">271</span></span>,<span class="hljs-number"><span class="hljs-number">275</span></span>, <span class="hljs-number"><span class="hljs-number">275</span></span>,<span class="hljs-number"><span class="hljs-number">447</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">079</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">268</span></span>,<span class="hljs-number"><span class="hljs-number">131</span></span>, <span class="hljs-number"><span class="hljs-number">274</span></span>,<span class="hljs-number"><span class="hljs-number">418</span></span>] (assumes normal distribution) # JMH <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">1.20</span></span> # VM <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: JDK <span class="hljs-number"><span class="hljs-number">1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161, VM <span class="hljs-number"><span class="hljs-number">25.161</span></span>-b12 # VM <span class="hljs-keyword"><span class="hljs-keyword">invoker</span></span>: C:\Program Files\Java\jre1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_161\bin\java.exe # VM <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: &lt;<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>&gt; # Warmup: <span class="hljs-number"><span class="hljs-number">5</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Measurement: <span class="hljs-number"><span class="hljs-number">10</span></span> iterations, <span class="hljs-number"><span class="hljs-number">2000</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> # Timeout: <span class="hljs-number"><span class="hljs-number">10</span></span> min per iteration # Threads: <span class="hljs-number"><span class="hljs-number">1</span></span> thread, will synchronize iterations # Benchmark mode: Average <span class="hljs-type"><span class="hljs-type">time</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>/op # Benchmark: ru.gnkoshelev.jbreak2018.perf_tests.for_each.TrickyConsumingBenchmark.forEachStreamBenchmark # Parameters: (N = <span class="hljs-number"><span class="hljs-number">10000</span></span>) # Run progress: <span class="hljs-number"><span class="hljs-number">75</span></span>,<span class="hljs-number"><span class="hljs-number">00</span></span>% complete, ETA <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span> # Fork: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> # Warmup Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">22612</span></span>,<span class="hljs-number"><span class="hljs-number">079</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">24943</span></span>,<span class="hljs-number"><span class="hljs-number">260</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">23366</span></span>,<span class="hljs-number"><span class="hljs-number">453</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">23445</span></span>,<span class="hljs-number"><span class="hljs-number">251</span></span> ns/op # Warmup Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">23732</span></span>,<span class="hljs-number"><span class="hljs-number">635</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">23575</span></span>,<span class="hljs-number"><span class="hljs-number">011</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">23478</span></span>,<span class="hljs-number"><span class="hljs-number">581</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-number"><span class="hljs-number">23663</span></span>,<span class="hljs-number"><span class="hljs-number">154</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">23067</span></span>,<span class="hljs-number"><span class="hljs-number">535</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">23489</span></span>,<span class="hljs-number"><span class="hljs-number">020</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-number"><span class="hljs-number">23461</span></span>,<span class="hljs-number"><span class="hljs-number">241</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-number"><span class="hljs-number">23510</span></span>,<span class="hljs-number"><span class="hljs-number">542</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">23504</span></span>,<span class="hljs-number"><span class="hljs-number">541</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-number"><span class="hljs-number">24036</span></span>,<span class="hljs-number"><span class="hljs-number">074</span></span> ns/op Iteration <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">24081</span></span>,<span class="hljs-number"><span class="hljs-number">512</span></span> ns/op Result "ru.gnkoshelev.jbreak2018.perf_tests.for_each.TrickyConsumingBenchmark.forEachStreamBenchmark": <span class="hljs-number"><span class="hljs-number">23586</span></span>,<span class="hljs-number"><span class="hljs-number">721</span></span> ¬±(<span class="hljs-number"><span class="hljs-number">99.9</span></span>%) <span class="hljs-number"><span class="hljs-number">442</span></span>,<span class="hljs-number"><span class="hljs-number">736</span></span> ns/op [Average] (min, avg, max) = (<span class="hljs-number"><span class="hljs-number">23067</span></span>,<span class="hljs-number"><span class="hljs-number">535</span></span>, <span class="hljs-number"><span class="hljs-number">23586</span></span>,<span class="hljs-number"><span class="hljs-number">721</span></span>, <span class="hljs-number"><span class="hljs-number">24081</span></span>,<span class="hljs-number"><span class="hljs-number">512</span></span>), stdev = <span class="hljs-number"><span class="hljs-number">292</span></span>,<span class="hljs-number"><span class="hljs-number">843</span></span> CI (<span class="hljs-number"><span class="hljs-number">99.9</span></span>%): [<span class="hljs-number"><span class="hljs-number">23143</span></span>,<span class="hljs-number"><span class="hljs-number">985</span></span>, <span class="hljs-number"><span class="hljs-number">24029</span></span>,<span class="hljs-number"><span class="hljs-number">458</span></span>] (assumes normal distribution) # Run complete. Total <span class="hljs-type"><span class="hljs-type">time</span></span>: <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span> Benchmark (N) Mode Cnt Score Error Units TrickyConsumingBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">100</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">206</span></span>,<span class="hljs-number"><span class="hljs-number">243</span></span> ¬± <span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">222</span></span> ns/op TrickyConsumingBenchmark.forEachListBenchmark <span class="hljs-number"><span class="hljs-number">10000</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">21791</span></span>,<span class="hljs-number"><span class="hljs-number">098</span></span> ¬± <span class="hljs-number"><span class="hljs-number">456</span></span>,<span class="hljs-number"><span class="hljs-number">511</span></span> ns/op TrickyConsumingBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">100</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">271</span></span>,<span class="hljs-number"><span class="hljs-number">275</span></span> ¬± <span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">144</span></span> ns/op TrickyConsumingBenchmark.forEachStreamBenchmark <span class="hljs-number"><span class="hljs-number">10000</span></span> avgt <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">23586</span></span>,<span class="hljs-number"><span class="hljs-number">721</span></span> ¬± <span class="hljs-number"><span class="hljs-number">442</span></span>,<span class="hljs-number"><span class="hljs-number">736</span></span> ns/op</code> </pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Everything was back to square one, and how the JIT worked here is another story. </font></font><br><br><h3>  findings </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. What is the correct answer in the end? </font><font style="vertical-align: inherit;">methods </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the problem give slightly different results, and method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 is</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> significantly inferior in performance. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. The alternative answers were accepted as the correct answer, that 1 is faster than 2 and 2 is faster than 1, if that was rightly reasoned. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Personal conclusion: the rabbit hole is always deeper than you think. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benchmark code can be taken at github: </font></font><a href="https://github.com/gnkoshelev/jbreak2018-forEach-perf-tests"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jbreak2018-forEach-perf-tests</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h4>  Statistics </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of the 32 options submitted, there were 8 correct and 5 partially correct. </font><font style="vertical-align: inherit;">Another 7 people hit the </font></font><code>PrintStream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trap, considering the parallel </font></font><code>Stream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the fastest. </font><font style="vertical-align: inherit;">No one believed in consecutive streams and chose option 2 as the fastest.</font></font><br><br><h4>  Addition </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the comments below, a potential exploit using a 0-day vulnerability associated with arbitrary implementations </font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which was manually protected at the conference, </font><font style="vertical-align: inherit;">was discussed </font><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thanks to Tagir </font></font><a href="https://habrahabr.ru/users/lany/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lany</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> who implemented the version of such an exploit (in his </font></font><a href="https://habrahabr.ru/post/350808/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the exploit code, detailed description and examples).</font></font><br><br><h4>  PS </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I will try to prepare the next part next weekend. </font></font><br><br>  <b>UPD.</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Other publications series: </font></font><a href="https://habrahabr.ru/company/skbkontur/blog/351300/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://habrahabr.ru/company/skbkontur/blog/351540/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://habrahabr.ru/company/skbkontur/blog/351812/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div><p>Source: <a href="https://habr.com/ru/post/350800/">https://habr.com/ru/post/350800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350790/index.html">Lightning Network In Depth, part 2: HTLC And Payment Routing</a></li>
<li><a href="../350792/index.html">Goldman Sachs lured away Google‚Äôs lead engineer to develop an API for his services</a></li>
<li><a href="../350794/index.html">Hessian-Free Optimization with TensorFlow</a></li>
<li><a href="../350796/index.html">Compact varint - uniqueness and great values ‚Äã‚Äãfor the same value.</a></li>
<li><a href="../350798/index.html">FastTrack Training. "Network Basics". "The value of Cisco routers." Eddie Martin December 2012</a></li>
<li><a href="../350802/index.html">Parsing proposals for Russian language patterns</a></li>
<li><a href="../350804/index.html">Blockchain on Go. Part 2: Proof-of-Work</a></li>
<li><a href="../350806/index.html">About machine learning, history and life with Dmitry Vetrov</a></li>
<li><a href="../350808/index.html">Task about forEach (ps :: println) from SKB Kontur</a></li>
<li><a href="../350810/index.html">Suspended fuel tanks for aircraft</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>