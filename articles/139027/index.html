<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Extend the functionality of standard WinForms TabControl</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It happened recently that it was necessary to use the TabControl component in one project. Standard component, nothing unusual, quite convenient. The ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Extend the functionality of standard WinForms TabControl</h1><div class="post__text post__text-html js-mediator-article">  It happened recently that it was necessary to use the TabControl component in one project.  Standard component, nothing unusual, quite convenient.  The nuance was that you had to use your own type of tabs based on the overloaded TabPage.  In addition, it was necessary to allow the <b>user to</b> add tabs himself in the process.  It should look like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/f68/a73/3cb/f68a733cb2b2b4a405a0aebd169cb143.png" alt="image"><br><br>  I am glad that the standard components allow you to do quite a lot of perversions with them. <br><a name="habracut"></a><br><br>  <a href="">Link</a> to a test project with an example.  Under the <s>2011</s> 2010 studio. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Let's start with custom tabs</b> . <br>  Unfortunately, TabControl, unlike the DataGridViewColumn, does not allow you to specify the type of the nested element through an internal variable.  So it is done in the DataGridViewColumn: <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CustomDataGridViewColumn</span></span> : <span class="hljs-title"><span class="hljs-title">DataGridViewTextBoxColumn</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CustomDataGridViewColumn</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;CellTemplate = CustomDataGridViewCell; } }</code> </pre> <br><br>  The project should be changed to Net 4 Full profile, because  you need to connect two assemblies - System.Design and System.Drawing.Design. <br><br>  Alas, it is impossible to do the same in TabControl; you will have to override the type TabPageCollection declared inside TabControl.  So, we declare the class itself and the necessary methods, then we analyze in turn.  Yes, and I‚Äôll warn you right away that there was no line ‚Äúusing System.Windows.Forms;‚Äù inside the code file, so the reference to standard components in the sample code comes with the prefix ‚ÄúSystem.Windows.Forms.‚Äù.  And TabControl and TabPage are custom redefined types. <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Drawing.Design; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel.Design; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">WindowsFormsApplication1</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TabControl</span></span> : <span class="hljs-title"><span class="hljs-title">System</span></span>.<span class="hljs-title"><span class="hljs-title">Windows</span></span>.<span class="hljs-title"><span class="hljs-title">Forms</span></span>.<span class="hljs-title"><span class="hljs-title">TabControl</span></span> { <span class="hljs-comment"><span class="hljs-comment">//    . public new class TabPageCollection : System.Windows.Forms.TabControl.TabPageCollection { public TabPageCollection(TabControl owner) : base(owner) { } } public TabControl() { } private TabPageCollection mTabCollection = null; //      ,    Editor   . [Editor(typeof(TabPageCollectionEditor), typeof(UITypeEditor))] public new System.Windows.Forms.TabControl.TabPageCollection TabPages { get { if (mTabCollection == null) mTabCollection = new TabPageCollection(this); return mTabCollection; } } } //     .      . public class TabPageCollectionEditor : System.ComponentModel.Design.CollectionEditor { public TabPageCollectionEditor(Type type) : base(type) { } protected override Type CreateCollectionItemType() { return typeof(TabPage); } protected override Type[] CreateNewItemTypes() { return new Type[] { typeof(TabPage) }; } } }</span></span></code> </pre><br><br>  And a simple TabPage: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">WindowsFormsApplication1</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TabPage</span></span> : <span class="hljs-title"><span class="hljs-title">System</span></span>.<span class="hljs-title"><span class="hljs-title">Windows</span></span>.<span class="hljs-title"><span class="hljs-title">Forms</span></span>.<span class="hljs-title"><span class="hljs-title">TabPage</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TabPage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } } }</code> </pre><br><br>  I think everything is clear.  Go to the next step. <br><br>  <b>Add tabs by user.</b> <br>  To provide this opportunity, we went the easiest way: in TabControl there is always an additional empty tab with the title "+".  When it is pressed, a tab add event is generated. <br><br>  First, in the TabPageCollection type, we overload the Clear method - when clearing tabs, we do NOT need to delete the "+" tab. <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { System.Windows.Forms.TabPage page = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ContainsKey(TabControl.KeyPageAllowAddName)) page = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[TabControl.KeyPageAllowAddName]; <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Clear(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (page != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Add(page); }</code> </pre><br><br>  In the code TabControl declare a variable that stores the name of the tab "+". <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> KeyPageAllowAddName = <span class="hljs-string"><span class="hljs-string">"___page_allow_to_add_name___"</span></span>;</code> </pre><br><br>  We declare the AllowUserToAddTab property of the component in order to enable / disable the new operation mode.  Well, the actual method that checks for the presence of such a tab and, if necessary, adds / removes it. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TabControl</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Enter += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EventHandler((sender, e) =&gt; { CheckAllowUserToAddTab(); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Selecting += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> System.Windows.Forms.TabControlCancelEventHandler(TabControl_Selecting); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> mAllowUserToAddTab = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; [Browsable(<span class="hljs-literal"><span class="hljs-literal">true</span></span>), Description(<span class="hljs-string"><span class="hljs-string">"   .   +,       OnUserAddedTab."</span></span>), Category(<span class="hljs-string"><span class="hljs-string">"Action"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> AllowUserToAddTab { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mAllowUserToAddTab; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { mAllowUserToAddTab = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckAllowUserToAddTab</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mAllowUserToAddTab) { System.Windows.Forms.TabPage page_allow_to_add = TabPages[KeyPageAllowAddName]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mAllowUserToAddTab) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (page_allow_to_add == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { page_allow_to_add = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TabPage(); page_allow_to_add.Name = KeyPageAllowAddName; page_allow_to_add.Text = <span class="hljs-string"><span class="hljs-string">"+"</span></span>; TabPages.Insert(<span class="hljs-number"><span class="hljs-number">0</span></span>, page_allow_to_add); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (page_allow_to_add != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) TabPages.Remove(page_allow_to_add); } } }</code> </pre><br><br>  Describe the delegate for the tab add event: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TabPageAdding</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TabControl control, TabPage page</span></span></span><span class="hljs-function">)</span></span>;</code> </pre><br><br>  Event and method for adding a tab: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> TabPageAdding PageAdding; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TabControl_Selecting</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, System.Windows.Forms.TabControlCancelEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TabPages.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; e.TabPage.Name == KeyPageAllowAddName) { e.Cancel = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; TabPage page = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TabPage(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PageAdding != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (TabPageAdding _delegate <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> PageAdding.GetInvocationList()) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_delegate.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, page)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { System.Windows.Forms.MessageBox.Show(ex.Message); } } TabPages.Add(page); } }</code> </pre><br>  A list of all subscribers to the add event is searched, if at least one of them returns False - the add is canceled. <br><br>  In the TabPageCollectionEditor class, you must overload the GetItems and SetItems methods.  They are needed to transfer an array of tabs from the editor to the component and vice versa, while excluding the "+" tab. <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetItems</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> editValue</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[] values = <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.GetItems(editValue); List&lt;<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt; values2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> element <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> values) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (element.GetType() == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(TabPage)) { TabPage tp = (TabPage)element; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tp.Name == TabControl.KeyPageAllowAddName) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } values2.Add(element); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> values2.ToArray(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex){System.Windows.Forms.MessageBox.Show(ex.Message);} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.GetItems(editValue); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetItems</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> editValue, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { List&lt;<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt; values2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> element <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (element.GetType() == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(TabPage)) { TabPage tp = (TabPage)element; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tp.Name == TabControl.KeyPageAllowAddName) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } values2.Add(element); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.SetItems(editValue, values2.ToArray()); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { System.Windows.Forms.MessageBox.Show(ex.Message); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.SetItems(editValue, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); }</code> </pre><br><br>  <b>Further added another possibility: tracking the first opening of a tab (the first entry into the tab initialized the tins)</b> <br><br>  Here one more event is added, the list and the event handler SelectedIndexChanged / Enter / Click: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TabControl</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Enter += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EventHandler(TabControl_PageEvent); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Click += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EventHandler(TabControl_PageEvent); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SelectedIndexChanged += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EventHandler(TabControl_PageEvent); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Enter += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EventHandler((sender, e) =&gt; { CheckAllowUserToAddTab(); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Selecting += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> System.Windows.Forms.TabControlCancelEventHandler(TabControl_Selecting); } .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Dictionary&lt;System.Windows.Forms.TabPage, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt; mLoaded = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;System.Windows.Forms.TabPage, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TabPageLoadedEventHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TabControl control, System.Windows.Forms.TabPage page</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> TabPageLoadedEventHandler PageLoad; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TabControl_PageEvent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SelectedTab != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; !mLoaded.ContainsKey(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SelectedTab)) { mLoaded.Add(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SelectedTab, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PageLoad != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) PageLoad(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SelectedTab); } }</code> </pre><br><br>  Of course, you can refine a lot of things here - for example, in the TabPageControlCollection, overload methods to more accurately determine the tab number (to exclude the "+" tab). <br>  Unfortunately, I have not found a way to implement the functionality of the "+" tab through overloading the component's rendering methods, so do not blame the curved way.  IMHO as an alternative to installing DevExpress, for example - will come down. </div><p>Source: <a href="https://habr.com/ru/post/139027/">https://habr.com/ru/post/139027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../139022/index.html">Recommender systems: problem statement</a></li>
<li><a href="../139023/index.html">The second long-awaited Dropquest 2012 from Dropbox.com</a></li>
<li><a href="../139024/index.html">Twitter Screensaver</a></li>
<li><a href="../139025/index.html">How many laws do you need for happiness?</a></li>
<li><a href="../139026/index.html">Custom assembly of plugins - we will go the other way</a></li>
<li><a href="../139028/index.html">SPH based Cocos2D water</a></li>
<li><a href="../139029/index.html">Mobilization: OMAX, SmartPay and Opera Mobile Store</a></li>
<li><a href="../139030/index.html">Video of the seminar "Information technologies as tools for profitable growth of the company"</a></li>
<li><a href="../139031/index.html">Duracell has released a "charging card" for wireless charging of mobile devices</a></li>
<li><a href="../139032/index.html">Gameboy emulation on Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>