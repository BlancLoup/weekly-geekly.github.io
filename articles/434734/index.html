<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fourier transform. The fast and the furious</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Often, when developing algorithms, we run into the limit of computational complexity, which, it would seem, is impossible to overcome. Fourier transfo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fourier transform. The fast and the furious</h1><div class="post__text post__text-html js-mediator-article">  Often, when developing algorithms, we run into the limit of computational complexity, which, it would seem, is impossible to overcome.  Fourier transform has complexity <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">O</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.032ex" height="2.901ex" viewBox="0 -935.7 2596.9 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-32" x="849" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-29" x="2207" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> O (n ^ 2) </script>  , and a quick version proposed around 1805 by Gaus <sup>1</sup> (and reinvented in 1965 by James Cooley and John Tukey) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-8"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">O</span><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">g</span><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">n</span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.118ex" height="2.66ex" viewBox="0 -832 4787 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6C" x="1753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6F" x="2052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-67" x="2537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-28" x="3018" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6E" x="3407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-29" x="4008" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-29" x="4397" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> O (nlog (n)) </script>  .  In this article I want to show you that you can get the conversion results in linear time. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">O</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">n</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.977ex" height="2.66ex" viewBox="0 -832 2143 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-29" x="1753" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> O (n) </script>  or even reach constant difficulty <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">O</span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-27">1</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.66ex" viewBox="0 -832 2043 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-31" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-29" x="1653" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> O (1) </script>  under certain conditions that occur in real problems. <br><img src="https://habrastorage.org/webt/vh/bu/cx/vhbucxhhhhxex_incvhxxu1uway.png" title="Fourier analysis"><br><a name="habracut"></a><br>  When I was faced with the task of writing a program for analyzing the transfer functions of sound systems in real time, I, like everyone else, first turned to fast conversion.  Everything was fine, but with a large time window, the CPU load became indecently large and we had to do something about it.  It was decided to pause and study the transformation again, and at the same time to look for ways to solve the problem.  Returning to the original Joseph Fourier transform <sup>2</sup> : <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">f</span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">x</span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-35">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">m</span><span class="MJXp-mtext" id="MJXp-Span-39">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">t</span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46" style="margin-right: 0.05em;">s</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-55"><span class="MJXp-mo" id="MJXp-Span-56">+</span><span class="MJXp-mtext" id="MJXp-Span-57">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">y</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-47"><span class="MJXp-mo" id="MJXp-Span-48">−</span><span class="MJXp-mtext" id="MJXp-Span-49">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">y</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-65" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-68" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-69">2</span><span class="MJXp-mtext" id="MJXp-Span-70">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">x</span><span class="MJXp-mrow" id="MJXp-Span-76"><span class="MJXp-mo" id="MJXp-Span-77">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">T</span></span></span><span class="MJXp-mspace" id="MJXp-Span-79" style="width: 0em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-82" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-84">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">c</span><span class="MJXp-mrow" id="MJXp-Span-89"><span class="MJXp-mn" id="MJXp-Span-90">1</span></span><span class="MJXp-mrow" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">T</span></span><span class="MJXp-mtext" id="MJXp-Span-93">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">t</span><span class="MJXp-mtext" id="MJXp-Span-97">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">t</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">s</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-105">0</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">f</span><span class="MJXp-mo" id="MJXp-Span-108" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">x</span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-113" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-114">−</span><span class="MJXp-mn" id="MJXp-Span-115">2</span><span class="MJXp-mtext" id="MJXp-Span-116">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">x</span><span class="MJXp-mrow" id="MJXp-Span-122"><span class="MJXp-mo" id="MJXp-Span-123">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">T</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="7.72ex" viewBox="0 -1091.4 40358 3323.9" role="img" focusable="false" style="vertical-align: -5.185ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(12446,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-78" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-29" x="1512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-3D" x="2179" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-73" x="3486" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-75" x="3955" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6D" x="4528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6C" x="5656" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="5955" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6D" x="6300" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="7179" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-74" x="7524" y="0"></use><g transform="translate(7886,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,490)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-2B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="1132" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6E" x="1477" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-66" x="2078" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-74" x="2628" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-79" x="2990" y="0"></use></g><g transform="translate(469,-335)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="1132" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6E" x="1477" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-66" x="2078" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-74" x="2628" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-79" x="2990" y="0"></use></g></g><g transform="translate(10921,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6B" x="613" y="-213"></use></g><g transform="translate(11823,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-70" x="854" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="1357" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="1703" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6B" x="2048" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-78" x="2570" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-2F" x="3142" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-54" x="3643" y="0"></use></g></g></g><g transform="translate(11203,-1855)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6B" x="613" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-3D" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-66" x="2486" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-72" x="3036" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-61" x="3488" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-63" x="4017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-31" x="4451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-54" x="4951" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="5906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6E" x="6251" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-74" x="6852" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6C" x="7463" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="7762" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6D" x="8107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="8986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-74" x="9331" y="0"></use><g transform="translate(9693,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-54" x="663" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-30" x="663" y="-435"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-66" x="10760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-28" x="11311" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-78" x="11700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-29" x="12273" y="0"></use><g transform="translate(12662,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-32" x="778" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-70" x="1632" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="2136" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-69" x="2481" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6B" x="2827" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-78" x="3348" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMAIN-2F" x="3921" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-54" x="4421" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-64" x="16854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-78" x="17377" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> f (x) = \ sum \ limits _ {- \ infty} ^ {+ \ infty} c_ke ^ {2 \ pi ikx / T} \\ c_k = \ frac {1} {T} \ int \ limits_0 ^ Tf ( x) e ^ {- 2 \ pi ikx / T} dx </script></p><br><br>  Let's look carefully what is happening here.  Each output value in the frequency domain <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-127"><span class="MJXp-msubsup" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-130" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.096ex" height="1.817ex" viewBox="0 -520.7 902.3 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/434734/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjx-jB71ggYXTcFYp_o4i0zsTHviw#MJMATHI-6B" x="613" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> c_k </script>  is the sum of all input signal values <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">f</span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">x</span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> f (x) </script>  multiplied by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-msubsup" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-139" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-140">−</span><span class="MJXp-mn" id="MJXp-Span-141">2</span><span class="MJXp-mtext" id="MJXp-Span-142">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">x</span><span class="MJXp-mrow" id="MJXp-Span-148"><span class="MJXp-mo" id="MJXp-Span-149">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">T</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> e ^ {- 2 \ pi ikx / T} </script>  .  To calculate, we need to go through all input data for each output value, i.e.  perform those same <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-151"><span class="MJXp-msubsup" id="MJXp-Span-152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-154" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> n ^ 2 </script>  operations. <br><br><h2>  Getting rid of n </h2><br>  Let me remind you that initially there was the task of analyzing audio data in real time.  For this, the selected time window (essentially a buffer) of size N is filled with data with a frequency f <sub>d</sub> corresponding to the sampling frequency.  With the period T, the input data are converted from the time window to the frequency one.  If you look at real numbers, then N varies from 2 <sup>14</sup> (16 384) to 2 <sup>16</sup> (65 536) samples (the values ​​are inherited from the FFT, where the window size must be a power of two).  The time is T = 80ms (12.5 times per second), which allows you to see quite conveniently the changes and not overload the CPU and GPU.  The sampling frequency f <sub>d is</sub> standard and is 48 kHz.  Let's calculate how much data in the time window changes between measurements.  During T, the buffer enters. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-155"><span class="MJXp-mn" id="MJXp-Span-156">48</span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-158">000</span><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mn" id="MJXp-Span-160">0.08</span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-162"><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0em;">$</span></span><span class="MJXp-mn" id="MJXp-Span-164">384</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> 48,000 * 0.08 = $ 384</script>  samples  Thus, only 5% to 23% of the data is updated in the window.  In the worst case, 95% (and at best 73%, which is also quite a lot!) Processed samples will again and again get into the conversion, despite the fact that they were already processed in previous iterations. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At this moment, the attentive reader will raise his hand and say: “Wait, what about the coefficient <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-165"><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-168" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-169">−</span><span class="MJXp-mn" id="MJXp-Span-170">2</span><span class="MJXp-mtext" id="MJXp-Span-171">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">x</span><span class="MJXp-mrow" id="MJXp-Span-177"><span class="MJXp-mo" id="MJXp-Span-178">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">T</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> e ^ {- 2 \ pi ikx / T} </script>  ?  After all, with each new transformation, the same data will be located in the new positions of the series, and as a result will have different coefficients? ”For each five, for attentiveness, let us recall an important detail in the transformation that is often forgotten.  In the study of the values ​​of the function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">f</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">t</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> f (t) </script>  on the interval from 0 to t, the function is considered periodic, which allows you to safely shift the function to the left or right in time.  As a result, we have the full right not to insert a new value into the end and delete the old one from the beginning, but to cyclically replace the data in the buffer. <br><br>  For clarity, you can write in a table as the buffer will change: <br><table><tbody><tr><td>  t = 0 </td><td>  f (0) </td><td>  f (1) </td><td>  f (2) </td><td>  f (3) </td><td>  f (4) </td><td>  f (5) </td><td>  f (6) </td><td>  f (7) </td><td>  f (8) </td><td>  f (9) </td></tr><tr><td>  t = 1 </td><td>  <b>f (10)</b> </td><td>  f (1) </td><td>  f (2) </td><td>  f (3) </td><td>  f (4) </td><td>  f (5) </td><td>  f (6) </td><td>  f (7) </td><td>  f (8) </td><td>  f (9) </td></tr><tr><td>  t = 2 </td><td>  f (10) </td><td>  <b>f (11)</b> </td><td>  f (2) </td><td>  f (3) </td><td>  f (4) </td><td>  f (5) </td><td>  f (6) </td><td>  f (7) </td><td>  f (8) </td><td>  f (9) </td></tr><tr><td>  t = 3 </td><td>  f (10) </td><td>  f (11) </td><td>  <b>f (12)</b> </td><td>  f (3) </td><td>  f (4) </td><td>  f (5) </td><td>  f (6) </td><td>  f (7) </td><td>  f (8) </td><td>  f (9) </td></tr><tr><td>  t = 4 </td><td>  f (10) </td><td>  f (11) </td><td>  f (12) </td><td>  <b>f (13)</b> </td><td>  f (4) </td><td>  f (5) </td><td>  f (6) </td><td>  f (7) </td><td>  f (8) </td><td>  f (9) </td></tr></tbody></table><br>  You can write how the transformation in time changes from t <sub>1</sub> to t <sub>2</sub> : <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-185"><span class="MJXp-msubsup" id="MJXp-Span-186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-188" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-192" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">t</span><span class="MJXp-mo" id="MJXp-Span-194">−</span><span class="MJXp-mn" id="MJXp-Span-195">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-197">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">F</span><span class="MJXp-mspace" id="MJXp-Span-204" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-205">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">F</span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">a</span><span class="MJXp-msubsup" id="MJXp-Span-219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-221" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-223">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">c</span><span class="MJXp-mrow" id="MJXp-Span-228"><span class="MJXp-mn" id="MJXp-Span-229">1</span></span><span class="MJXp-mrow" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">T</span></span><span class="MJXp-mtext" id="MJXp-Span-232">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">t</span><span class="MJXp-mtext" id="MJXp-Span-236">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">t</span><span class="MJXp-msubsup" id="MJXp-Span-242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243" style="margin-right: 0.05em;">s</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-248"><span class="MJXp-msubsup" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-251" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-244"><span class="MJXp-msubsup" id="MJXp-Span-245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-247" style="vertical-align: -0.4em;">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-255" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">x</span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-262" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">t</span><span class="MJXp-mo" id="MJXp-Span-264">−</span><span class="MJXp-mn" id="MJXp-Span-265">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">x</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-272" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-273">−</span><span class="MJXp-mn" id="MJXp-Span-274">2</span><span class="MJXp-mtext" id="MJXp-Span-275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">x</span><span class="MJXp-mrow" id="MJXp-Span-281"><span class="MJXp-mo" id="MJXp-Span-282">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">T</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-13"> F_t = F_ {t-1} + \ Delta F \\ \ Delta F: \ Delta c_k = \ frac {1} {T} \ int \ limits_ {t_1} ^ {t_2} (f_t (x) - f_ { t-1} (x)) e ^ {- 2 \ pi ikx / T} dx </script></p><br>  Value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-msubsup" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-289" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">t</span><span class="MJXp-mo" id="MJXp-Span-291">−</span><span class="MJXp-mn" id="MJXp-Span-292">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">x</span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> F_ {t-1} (x) </script>  is the result of the previous conversion, and the complexity of the calculation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-296"><span class="MJXp-mtext" id="MJXp-Span-297">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">f</span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">x</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> \ Delta f (x) </script>  does not depend on the size of the time window and, therefore, is constant.  As a result, the conversion complexity will be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">O</span><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">n</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> O (n) </script>  <sup>*</sup> because  all we have to do is to go through the frequency window once and apply the changes to the samples that have changed during T.  Separately, I want to draw your attention that the coefficients <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-312"><span class="MJXp-msubsup" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-315" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-316">−</span><span class="MJXp-mn" id="MJXp-Span-317">2</span><span class="MJXp-mtext" id="MJXp-Span-318">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">x</span><span class="MJXp-mrow" id="MJXp-Span-324"><span class="MJXp-mo" id="MJXp-Span-325">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">T</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> e ^ {- 2 \ pi ikx / T} </script>  can be calculated in advance, which gives an additional gain in performance, and the cycle will only have two operations: subtracting real numbers and multiplying a real number by a complex one, in practice both of these operations are simple and cheap. <br><br>  For completeness, it remains only to indicate the initial state, but everything is simple: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-327"><span class="MJXp-msubsup" id="MJXp-Span-328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329" style="margin-right: 0.05em;">F</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-330" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">x</span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-335">0</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-18"> F_0 (x) = 0 </script></p><br>  * - of course, the ultimate complexity of the whole transformation will remain <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">O</span><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-341" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> O (n ^ 2) </script>  , but it will be executed gradually, over n iterations, until the buffer is updated. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">O</span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">n</span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> O (n) </script>  - this is the complexity of updating the data, but this is exactly what we need (when using FFT, the complexity of each transformation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">O</span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">g</span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">n</span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> O (nlog (n)) </script>  ). <br><br><h2>  And what if you dig deeper.  Or get rid of the second n </h2><br>  I just want to make a reservation that the further steps are applicable only if you do not plan to reverse the result for the result (in order to correct the signal or obtain an impulse response).  First of all, I want to remind you that as a result of the transformation, we get a symmetric array of data, which immediately reduces the number of transformations in half. <br><br>  Now let's analyze the resulting data set, taking into account the conditions of the problem.  We have a set of complex numbers, each of which describes the amplitude and phase of the oscillations at a certain frequency.  Frequency can be determined by the formula: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">f</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">j</span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">j</span><span class="MJXp-mtext" id="MJXp-Span-366">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">c</span><span class="MJXp-mrow" id="MJXp-Span-371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">d</span></span><span class="MJXp-mrow" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">N</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> f [j] = j \ frac {fd} {N} </script>  for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">j</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mtext" id="MJXp-Span-379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">c</span><span class="MJXp-mrow" id="MJXp-Span-384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">N</span></span><span class="MJXp-mrow" id="MJXp-Span-386"><span class="MJXp-mn" id="MJXp-Span-387">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> j <\ frac {N} {2} </script>  .  Let's estimate the frequency window step on our data: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-388"><span class="MJXp-mtext" id="MJXp-Span-389">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">f</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">c</span><span class="MJXp-mrow" id="MJXp-Span-402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">d</span></span><span class="MJXp-mrow" id="MJXp-Span-405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">N</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> \ Delta f = \ frac {fd} {N} </script>  For N = 2, <sup>14</sup> : 2.93 Hz (and for 2, <sup>16</sup> : 0.73 Hz).  Thus, in the range from 1 kHz to 2 kHz, we get 341 results.  Try to independently assess how much data will be in the range from 8 kHz to 16 kHz for N = 65536. A lot, right?  Lots of!  Do we need so much data?  Of course, in the tasks of displaying the frequency characteristics of sound systems, the answer is no.  On the other hand, for analysis in the low-frequency region, a small step is very useful.  Do not forget that there is still ahead of schedule, which should these volumes ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-407"><span class="MJXp-mtext" id="MJXp-Span-408">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">c</span><span class="MJXp-mrow" id="MJXp-Span-413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">N</span></span><span class="MJXp-mrow" id="MJXp-Span-415"><span class="MJXp-mn" id="MJXp-Span-416">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> \ frac {N} {2} </script>  ) convert to a human-readable form (averaging, spline or smoothing) and display them on the screen.  Even at high frequencies, even having a 4K screen and displaying the graph in full screen mode with a logarithmic frequency axis, the step size will quickly turn out to be much less than 1 pixel. <br><br>  Experimentally, you can find out that it is enough to have only 48 points per octave, and in order to have data a little more smooth and averaged, I suggest staying at 96. In the audio frequency range from 20 Hz to 20 kHz, it is easy to count only 10 octaves: 20, 40, 80 , 160, 320, 640, 1280, 2560, 5120, 10240, 20480, each of which can be divided into a given number of subranges (do not forget that the division should be performed geometrically, not arithmetically), therefore, it is more than enough to perform the conversion only for 960 frequencies to get  Performan that in 16 ... 65 times smaller than the original version. <br><br>  Thus, combining both approaches, we obtain the constant complexity of the execution of the data update algorithm. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">O</span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-420">1</span><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> O (1) </script>  . <br><br><h2>  Honey squared and fly in the ointment </h2><br>  Now we can safely say that the complexity <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">O</span><span class="MJXp-mo" id="MJXp-Span-424" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-427" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> O (n ^ 2) </script>  we came to difficulty <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">O</span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-432">1</span><span class="MJXp-mo" id="MJXp-Span-433" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> O (1) </script>  using two simple life hacking: <br><br><ul><li>  after analyzing the task, we noticed that the data is added gradually, and the period of complete updating of the time window is much higher than the period of transformations and went on to calculate the difference of the Fourier transform. </li><li>  left from the arithmetic step in the frequency window to limited only by given values, which allows to drastically reduce the number of conversions. </li></ul><br>  But, of course, life would really be a fairy tale, if not for one thing.  The use of these two approaches allowed us to really unload the CPU so that it guesses that it calculates the Fourier transform and displays the results on the screen even with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">N</span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-437"><span class="MJXp-mn" id="MJXp-Span-438" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-439" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-440">20</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> N = 2 ^ {20} </script>  it was difficult.  But the punishment did not keep itself waiting, when your signals are not periodic in reality (and this is necessary to get the correct conversion results) and finding the appropriate window size is not possible, there is a need to use various window functions, which no longer allows you to fully use the first step.  Practice has shown that the use of window functions is critical in the study of signals with a frequency less than <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-441"><span class="MJXp-mn" id="MJXp-Span-442">0</span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-444">1</span><span class="MJXp-msubsup" id="MJXp-Span-445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-447" style="vertical-align: -0.4em;">d</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> 0,1f_d </script>  .  At high frequencies, the number of periods trapped in the time window significantly and reduces the distortions arising due to the presence of a gap of the first kind (between f (0) and f (N-1)) in the original function. <br><br>  I also refused from the second step and returned to the FFT, since  the gain in this problem was already small. <br><br><h2>  Finally </h2><br>  The first approach can be used if your data has a pronounced periodic character and needs to be analyzed over time using a large time window, which, I recall, does not have to be a power of 2, i.e.  any natural number. <br>  The second approach is applicable (even taking into account window functions), if only a certain, small set of frequencies are analyzed in the data. <br><br>  Alas, for me in this problem, it remains only a little mathematical entertainment, but I hope that it will inspire you to study other algorithms on holidays in terms of input data changes over time :) <br><br><h2>  Literature </h2><br><ol><li>  <a href="https://en.wikipedia.org/wiki/Cooley%25E2%2580%2593Tukey_FFT_algorithm">Cooley – Tukey FFT algorithm</a> </li><li>  <a href="http://library.bmstu.ru/ECatalog/ViewDescription.aspx%3FDescriptionId%3D82089">E.A.Vlasova Rows.</a>  <a href="http://library.bmstu.ru/ECatalog/ViewDescription.aspx%3FDescriptionId%3D82089">Publishing House of Moscow State Technical University named after NE Bauman.</a>  <a href="http://library.bmstu.ru/ECatalog/ViewDescription.aspx%3FDescriptionId%3D82089">Moscow.</a>  <a href="http://library.bmstu.ru/ECatalog/ViewDescription.aspx%3FDescriptionId%3D82089">2002</a> </li></ol><br>  The image was taken from the manio of Michio Shibuya. “Entertaining mathematics.  ANALYSIS OF FOURIER </div><p>Source: <a href="https://habr.com/ru/post/434734/">https://habr.com/ru/post/434734/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../434724/index.html">Chinese farmers make live streaming</a></li>
<li><a href="../434726/index.html">Android device identification pitfalls</a></li>
<li><a href="../434728/index.html">People and processes: why is it not suitable for every company?</a></li>
<li><a href="../434730/index.html">In-memory databases: application, scaling and important additions</a></li>
<li><a href="../434732/index.html">Life at 6200 DPI. HyperX Pulsefire Core Review</a></li>
<li><a href="../434736/index.html">Using the Mikrotik log database to suppress brute force</a></li>
<li><a href="../434738/index.html">Learning with reinforcement in Python</a></li>
<li><a href="../434740/index.html">The neural network was taught to detect solar panels on satellite images and predict their level of distribution.</a></li>
<li><a href="../434742/index.html">Part 2: Using Cypress UDB PSoC Controllers to Reduce the Number of Interrupts in a 3D Printer</a></li>
<li><a href="../434744/index.html">Samsung SSD 860 QVO 1 TB and 4 TB: the first consumer SATA QLC (part 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>