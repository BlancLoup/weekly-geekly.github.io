<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We pass on Androidx or fascinating travel on a rake</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The theme of switching to Androidx is now in the air. There is already a short article in English from Daniel Lew , there is a report . But they all q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We pass on Androidx or fascinating travel on a rake</h1><div class="post__text post__text-html js-mediator-article">  The theme of switching to Androidx is now in the air.  There is already a <a href="https://blog.danlew.net/2018/11/14/the-reality-of-migrating-to-androidx/">short article in English from Daniel Lew</a> , there is a <a href="https://youtu.be/hZPlnIhKEzM%3Flist%3DPLpVeA1tdgfCCOxYPCPNGS10y6UyUyI_jv%26t%3D381">report</a> .  But they all quite superficially consider the transition scenario described in the <a href="https://developer.android.com/jetpack/androidx/migrate">Google documentation</a> . <br><br>  I want to share my experience.  In my project, Moxy and Cicerone are used, I find my experience interesting, because the official telegram channels of these libraries periodically raise the question of when they will be transferred to Androidx. <br><a name="habracut"></a><br><h3>  Just Migrate to AndroidX ... </h3><br>  In order to translate a project on Androidx, you need to follow a few simple steps: <br><br>  1. Install <i>compileSdkVersion 28</i> and <i>targetSdkVersion 28</i> , update all the support libraries to the latest versions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2. Add the following lines in the file <b>gradle.properties</b> : <br><br><pre><code class="java hljs">android.useAndroidX=<span class="hljs-keyword"><span class="hljs-keyword">true</span></span> android.enableJetifier=<span class="hljs-keyword"><span class="hljs-keyword">true</span></span></code> </pre> <br>  3. If you are already using Android Studio 3.2, then use refactoring: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wf/po/nl/wfponll56lhhbcwnjivi3kjmqjw.png"></div><br>  He will do more (or less) for you. <br><br>  If you, for some reason, do not use Git, or another version control system, then at this stage you will have a chance to make a project archive: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1e/li/f8/1elif8ewwv6zqp8bvanrehovr4k.png"></div><br>  Click the Migrate button, choose where to save the archive, and after a while, we get the result of checking the project before refactoring: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vg/af/4q/vgaf4qodaeif-k-364trpqna8dg.png"></div><br>  Here we see which dependencies in build.gradle and import directives are replaced.  On the example of the MainActivity class, as can be seen in the screenshot above, one dependency will be replaced: <i>android.support.v4.view.GravityCompat</i> , but if we open this class, we will see that there are actually three more dependencies that need to be replaced: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/az/6_/pw/az6_pwztikubna136ym0ytcpp08.png"></div><br>  I did not understand the reason for this selective behavior, but these dependencies will have to be corrected manually.  Click "Do Refactor". <br><br><div class="spoiler">  <b class="spoiler_title">If you are not using Android Studio 3.2, then all dependencies are manually edited.</b> <div class="spoiler_text">  It will be necessary to change the dependencies in <b>build.gradle</b> (for clarity, I commented out the old dependencies): <br><br><img src="https://habrastorage.org/webt/cz/bk/8b/czbk8bq-aqjhgnheueigg3uihv4.png"><br><br>  A complete list of replacements can be found <a href="https://developer.android.com/jetpack/androidx/migrate">here</a> . <br><br>  Then synchronize the project with Gradle, and get a bunch of errors.  These are import directives in your classes, they refer to old packages, you need to change them in accordance with <a href="https://developer.android.com/jetpack/androidx/migrate">this table</a> . </div></div><br>  So, since the studio could not replace all the dependencies (maybe you could, then you can be congratulated), when you try to build a project, you will see a similar list of errors: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lx/jq/6c/lxjq6cnbtmamvnucswhuu2uoizm.png"></div><br>  Having opened a class with errors, we will see something like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zn/2q/zk/zn2qzk5bfvbkxcd83rzirsgxyec.png"></div><br>  We delete outdated dependencies, and by the Alt + Enter hotkey we import classes from the <i>androidx</i> package <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jj/b8/9x/jjb89xdnwy3f-_zsk0bzavlplxo.png"></div><br>  Thus we fix all the classes.  If the error is not related to "import", do not pay attention to it, most likely it is due to the same problems in another class. <br><br>  For example: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ej/5a/e_/ej5ae_pnjax2vwvgo0wpxdtrx1a.png"></div><br>  Here the errors are due to the fact that the TimelineView class also needs to fix the problems with the import.  When all the errors are corrected, we build the project again, and perhaps we get a list of errors again, only in other classes, the process is iteratively continued. <br><br>  For errors with classes that are generated (Dagger or DataBinding), at this stage do not pay attention.  If there are no errors in your classes, and the studio swears only on the generated code, then you need to run the Clean Project and the Rebuild Project. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jq/6w/fa/jq6wfazm_1px_ufr0gt9krylx2c.png"></div><br>  If this does not help, you can try to clear the studio cache: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cp/qu/9k/cpqu9kvavad18ait-52xxnnv5fy.png"></div><br>  You will have to clear the cache at least once in order for the classes that generate DataBinding or Room to be created correctly. <br><br><h3>  External libraries </h3><br>  In general, we set the <i>android.enableJetifier = true</i> flag just so that at the project build stage, the external library dependencies are replaced with the corresponding AndroidX dependencies automatically, but for some reason this doesn't happen to me. <br><br>  In any case, before doing what is described below, make sure that you have this problem and that the latest versions of the libraries you use are not yet translated to AndroidX. <br><br><h4>  Moxy </h4><br>  <i>The MainActivity</i> in my project is inherited from <i>MvpAppCompatActivity</i> is a Moxy class, which, at the time of this writing, has not yet been translated to AndroidX.  To solve this problem, I copied the class to my project, into a separate <i>androidx</i> package, and fixed the dependencies in it.  The class name is best left unchanged, so it will be easier to update dependencies. <br><br>  The same procedure must be done for the fragments, for the class <i>MvpAppCompatFragment</i> . <br><br>  Please note that there is a generic in these classes, in the <b>mMvpDelegate</b> field, do not forget to correct the dependency in it, it is easy to miss, because it depends on the Moxy class, and not on the support library class. <br><br><h4>  Cicerone </h4><br>  To solve problems with Cicerone, I had to create a copy of the <i>SupportAppScreen</i> and <i>SupportAppNavigator</i> classes in my project.  Please note that the SupportAppNavigator class depends on SupportAppScreen.  Do not forget to correct this dependence on your copy. <br><br><h3>  findings </h3><br>  The transition to AndroidX, an exciting experience, and perhaps, if you do not have an urgent need, it is worth a little delay with it.  After all, then, when most of the rake is removed from your path, it will be easier and faster to do this.  But personally, I am pleased that I have gone this way, the bumps on my forehead will heal, and the useful experience will remain with me. </div><p>Source: <a href="https://habr.com/ru/post/430660/">https://habr.com/ru/post/430660/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../430648/index.html">The history of Pac-Man</a></li>
<li><a href="../430650/index.html">Sex - seller of classic arcade games. And who is the buyer?</a></li>
<li><a href="../430654/index.html">devleads meetup: we assemble an effective team, optimize development, discuss current issues</a></li>
<li><a href="../430656/index.html">Certified SAFe¬Æ Program</a></li>
<li><a href="../430658/index.html">How it started - the birth of video games</a></li>
<li><a href="../430662/index.html">Monitoring Windows servers on pure MS SQL, and how I secretly implemented it</a></li>
<li><a href="../430664/index.html">The role of team leader in recruiting</a></li>
<li><a href="../430666/index.html">How to evaluate the effectiveness of the team</a></li>
<li><a href="../430668/index.html">There is safety in numbers. The path to effective teamwork</a></li>
<li><a href="../430670/index.html">Contract Management</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>