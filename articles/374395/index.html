<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to connect the MD910 matrix printer from the cash register Minik</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my last publication I connected an LCD display from an old cash register. Let me remind you that I purchased 3 devices for ridiculous money, disass...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to connect the MD910 matrix printer from the cash register Minik</h1><div class="post__text post__text-html js-mediator-article">  In my <a href="https://geektimes.ru/post/297619/">last publication</a> I connected an LCD display from an old cash register.  Let me remind you that I purchased 3 devices for ridiculous money, disassembled them, and as a result I became the owner of cute electronic stuff: screens, printers, small things ....;) <br><br>  In the comments, people were interested in connecting a receipt printer.  Having found the time out of its range, I finally figured out the printer.  I started with the matrix.  Model MD910, below the photo. <br><br><img src="https://habrastorage.org/webt/fs/q4/hb/fsq4hbgduua_ert7ctt6ekmohle.jpeg"><br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/3n/5f/2m/3n5f2mjjzj9e0jmgge_lqfwwzpk.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Well, since Arduinka, a soldering iron, and other things, have long since been waiting for their appearance on the scene, I decided to connect it to an untouchable person and print something.  What is the most important thing in our life?  This is a manual!  And so I was puzzled by search of datasheet on this printer.  Nuggul, the truth of the very first edition.  There was a pinout pinout scheme, timings, a little about the printer device.  There were no parameters for connecting the optocoupler's LED and several more data.  The idea came to mind to ask this information in the cash register repair shops.  Here, I‚Äôll tell you, I was disappointed - these guys lazily stretched that they had no datasheets, service manuals or even cash registers, and in general they are busy here ...;) <br><br>  And if you ask this information directly from the manufacturers themselves (Citizen Business Machines)?  I did so ‚Äî I wrote an email to them ‚Äî so they say, and so, I'm a radio amateur, now I want to screw this printer and print leaflets on it, kindly and kindly provide a datasheet.  And Citizen Systems Europe sent me filled-in information in a couple of days! <br><br>  I assembled the sensor connection boards - there are two of them: Dot Pulse and Reset Pulse.  Soldered the driver to control the engine and print head. <br><br><div class="spoiler">  <b class="spoiler_title">Wiring diagrams sensors.</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/8z/p3/-g/8zp3-gc1cv9mapr6k5fardqjvww.png"><br>  The numbers indicate to which printer pins these points are connected.  Since the Arduino inputs are fed with inverted signals (for example, 1 if the switch is open), this point should be taken into account when writing the program. <br></div></div><br>  As for the drivers for the motor and the print head.  There were several <a href="https://github.com/alladin75/md910/blob/master/SMA4033">SMA4033</a> and <a href="https://github.com/alladin75/md910/blob/master/STA471A.pdf">STA471A</a> microcircuits <a href="https://github.com/alladin75/md910/blob/master/SMA4033">in the</a> <a href="https://github.com/alladin75/md910/blob/master/STA471A.pdf">zagashniki</a> , which were soldered out of the faulty Epson dot-matrix printer (of the FX800 type).  Here are the vicissitudes of the fate of the microcircuits - the old dot-matrix printer was disassembled for parts, so that after a few years it would reincarnate into the appearance of a new printer!  ;) <br>  The documentation was found at the first Google request (by the way, I posted them on <a href="https://github.com/alladin75/md910">GitHub</a> ).  These chips are 4 Darlington transistors in a single package, the difference between them (except for supply voltages) in the presence of protective diodes in SMA4033.  I really liked them - excellent parameters, you can glue on the radiator and just solder the wiring to the terminals, the case is relatively massive, so it can easily withstand the soldering with the help of a building dryer!  ;) <br><br><div class="spoiler">  <b class="spoiler_title">Motor and Printhead Drivers</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/iy/-h/g4/iy-hg4ttbbz7gom3pc68z1efhhy.png"><br>  Wiring diagram of the motor.  Only two channels of the four SMA4033 are used. <br><br><img src="https://habrastorage.org/webt/j_/rw/jl/j_rwjlhxtxf6dva6r6xvp_qrals.png"><br>  Wiring the print head to the chips STA471A (collectors).  It must be remembered that the print head consists of 2 blocks of 4 needles.  Therefore, we need 8 power outputs. <br><br>  Common to both ICs.  Output pins Arduino through resistors resistance (680 ohm - 1k) are connected to the base of Darlington transistors. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Printer pinout layout</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/2u/yc/hm/2uychmol08tuufh4imhegmp3g_0.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">How is all this connected to Arduine?</b> <div class="spoiler_text"><pre><code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> b1stHead_D 8 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> b1stHead_B 9 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> b1stHead_A 10 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> b1stHead_C 11 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> b2ndHead_H 4 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> b2ndHead_F 5 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> b2ndHead_E 6 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> b2ndHead_G 7 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Motor 13 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Feed 12 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DotPulse 3 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ResetPulse 2</span></span></code> </pre> <br></div></div><br>  <b>How does the printer work?</b> <br><img src="https://habrastorage.org/webt/6t/vr/ro/6tvrro_jiyvfcbmkoav_zlzkj6i.png"><br>  The print head consists of two identical parts.  Each part includes four vertically standing needles.  However, even and odd needles are slightly shifted relative to each other, I believe that they do not interfere with each other much - because the distance between them is quite tiny!  However, this slightly complicates the printing algorithm: you first need to print odd dots, then, after waiting for the head to move 0.5 points, print even dots. <br><br><img src="https://habrastorage.org/webt/yj/g7/ow/yjg7owhvqdcgrtcrrifilki44wm.png"><br>  As for the two halves.  The left part of the print head prints the first half of the line, the right - the second.  To print a line of 8 pixels in height, you need to make two passes.  Look, the first four columns of the letter A are printed for the first four bars. The first bar is typing points A and C, then 1 bar - the head is moved half a point, then B and D are printed, then it is shifted again by half a point.  Then again, in four measures, the next column of the letter A is printed. <br><br><img src="https://habrastorage.org/webt/7v/9e/gq/7v9egqkw9yvrjfgvhn428zaimtw.png"><br><br>  At the same time in the printer only 144 columns, 72 for each part of the print head.  If we use the 8x8 font, then we will be able to type 18 characters in each line. <br><br>  We found out how the printer prints.  Now this business needs to be issued in the form of a program code. <br><br>  What do we need to type the text? <br><br>  1) input information - a string of 18 characters; <br>  <a href="">2) font</a> <br>  3) program <br><br>  Most raster fonts are arranged as follows: each byte (or several bytes) describes one line of a character, the next one is the next line, and so on.  This is convenient for displaying on the screen - since the image is built by row.  In the case of printing, needles stand vertically.  Therefore, we would be comfortable font, which is described in Stobltsy.  However, I did not find this.  I had to proceed from the fact that there is. <br><br>  In addition, I decided to organize the printing as follows: the first step is to render the text lines to the buffer, the second step is to directly print the prepared information from the render buffer.  It also gives some assurance that print timings will be respected.  Writing the rendering code was the most difficult part of the program. <br><br>  <b>Let's see how rendering works.</b> <br><img src="https://habrastorage.org/webt/uc/rc/ai/ucrcai06p99ispwzodho5vlibzq.jpeg"><br>  Here, the bits and bytes of the screen font are highlighted in red, the bits and bytes of the font for the printer are highlighted in green.  The main task of rendering is to convert a screen font into a printer into a buffer.  Processing looks like this: <u>all D7th bits</u> (all 8 bytes of the font) must be <u>turned into bits D7-D0</u> (first column), <u>all D6th bits</u> need to be <u>turned into bits D7-D0</u> (second column).  Thus, the screen font for the Latin letter A (0x30, 0x78, 0xCC, 0xCC, 0xFC, 0xCC, 0xCC, 0x00) turns into a sequence (0x3E, 0x7E, 0xC8, 0xC8, 0x7E, 0x3E, 0x00, 0x00) for the render buffer.  I hope that the following piece of code will help to understand the rendering algorithm. <br><br>  I struggled with another big problem the whole evening: when I tried to work out the rendering code, garbage was thrown at the terminal, if I commented out this section, everything worked without problems.  It seemed to me that the memory is full / rewritten and therefore there is garbage in the issue.  After reading about the fact that Arduino stores all variables in RAM, I realized that all the fault is 2 kilobytes of font data.  I had to store it directly in the body of the program (flash) and apply through special functions.  It all worked.  <a href="http://www.nongnu.org/avr-libc/user-manual/pgmspace.html">Here</a> and <a href="https://www.arduino.cc/reference/en/language/variables/utilities/progmem/">here in</a> more detail about it. <br><br><div class="spoiler">  <b class="spoiler_title">Buffer Render Code</b> <div class="spoiler_text"><pre> <code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">/ FontData=pgm_read_byte(&amp;(CP1251Font[Address])); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/www.arduino.cc/reference</span></span><span class="hljs-regexp"><span class="hljs-regexp">/en/language</span></span><span class="hljs-regexp"><span class="hljs-regexp">/variables/utilities</span></span><span class="hljs-regexp"><span class="hljs-regexp">/progmem/</span></span> /<span class="hljs-regexp"><span class="hljs-regexp">/      1       /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ http:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/www.nongnu.org/avr</span></span>-libc/user-manual/pgmspace.html /<span class="hljs-regexp"><span class="hljs-regexp">/    18  (144 /</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>) +<span class="hljs-number"><span class="hljs-number">1</span></span>      = <span class="hljs-number"><span class="hljs-number">19</span></span>  void MD910_RenderPrintStr(char String2Print[<span class="hljs-number"><span class="hljs-number">19</span></span>]) { byte TmpVal[<span class="hljs-number"><span class="hljs-number">8</span></span>], MaskBit[<span class="hljs-number"><span class="hljs-number">8</span></span>]; byte i,j,k, Code, Column, Value; word FontStart; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>*************************************************************** Column=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   MD910_Buffer[] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(j=<span class="hljs-number"><span class="hljs-number">0</span></span>;j&lt;=<span class="hljs-number"><span class="hljs-number">17</span></span>;j++) /<span class="hljs-regexp"><span class="hljs-regexp">/    { Code=byte(String2Print[j]); FontStart=Code*8; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ ,       CP1251Font[] for (k=0; k&lt;=7; k++) { TmpVal[k]=pgm_read_byte(&amp;(CP1251Font[FontStart+k])); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    (0) }; for(i=0;i&lt;=7;i++) { for (k=0; k&lt;=7; k++) { MaskBit[k]=(TmpVal[k] &amp; 128) &gt;&gt; k; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/          (1) }; Value=0; for (k=0; k&lt;=7; k++) { Value=(Value | MaskBit[k]); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/       (2) }; MD910_Buffer[Column]=Value; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/      (3) for (k=0; k&lt;=7; k++) { TmpVal[k]=TmpVal[k] &lt;&lt; 1; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/     (4) }; Column++; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/      }; }; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/*************************************************************** };</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Print buffer code</b> <div class="spoiler_text"><pre> <code class="hljs lua">void MD910_PrintBuffer() { <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> PinA, PinB, PinC, PinD, PinE, PinF, PinG, PinH; Serial.println(<span class="hljs-string"><span class="hljs-string">"Printing...."</span></span>); //*********************************************************************************************************** DP_Count=<span class="hljs-number"><span class="hljs-number">0</span></span>; //     *************************** <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (RP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> j=<span class="hljs-number"><span class="hljs-number">0</span></span>;j&lt;=<span class="hljs-number"><span class="hljs-number">71</span></span>;j++) { PinA=MD910_Buffer[j] &amp; <span class="hljs-number"><span class="hljs-number">0x80</span></span>; PinB=MD910_Buffer[j] &amp; <span class="hljs-number"><span class="hljs-number">0x40</span></span>; PinC=MD910_Buffer[j] &amp; <span class="hljs-number"><span class="hljs-number">0x20</span></span>; PinD=MD910_Buffer[j] &amp; <span class="hljs-number"><span class="hljs-number">0x10</span></span>; PinE=MD910_Buffer[j+<span class="hljs-number"><span class="hljs-number">72</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0x80</span></span>; PinF=MD910_Buffer[j+<span class="hljs-number"><span class="hljs-number">72</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0x40</span></span>; PinG=MD910_Buffer[j+<span class="hljs-number"><span class="hljs-number">72</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0x20</span></span>; PinH=MD910_Buffer[j+<span class="hljs-number"><span class="hljs-number">72</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0x10</span></span>; // <span class="hljs-number"><span class="hljs-number">1</span></span>  //    A,C  E,G () <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinA&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b1stHead_A, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinC&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b1stHead_C, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinE&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b2ndHead_E, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinG&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b2ndHead_G, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) {}; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) {}; DP_Count++; digitalWrite(b1stHead_A, LOW); digitalWrite(b1stHead_C, LOW); digitalWrite(b2ndHead_E, LOW); digitalWrite(b2ndHead_G, LOW); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) {}; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) {}; DP_Count++; // <span class="hljs-number"><span class="hljs-number">2</span></span>  //    B,D  F,H () <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinB&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b1stHead_B, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinD&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b1stHead_D, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinF&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b2ndHead_F, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinH&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b2ndHead_H, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { }; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) { }; DP_Count++; digitalWrite(b1stHead_B, LOW); digitalWrite(b1stHead_D, LOW); digitalWrite(b2ndHead_F, LOW); digitalWrite(b2ndHead_H, LOW); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) {}; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) {}; DP_Count++; }; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (RP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) {}; //       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (RP_Status()==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) {}; //          //     *************************** <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (RP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> j=<span class="hljs-number"><span class="hljs-number">0</span></span>;j&lt;=<span class="hljs-number"><span class="hljs-number">71</span></span>;j++) { PinA=MD910_Buffer[j] &amp; <span class="hljs-number"><span class="hljs-number">0x08</span></span>; PinB=MD910_Buffer[j] &amp; <span class="hljs-number"><span class="hljs-number">0x04</span></span>; PinC=MD910_Buffer[j] &amp; <span class="hljs-number"><span class="hljs-number">0x02</span></span>; PinD=MD910_Buffer[j] &amp; <span class="hljs-number"><span class="hljs-number">0x01</span></span>; PinE=MD910_Buffer[j+<span class="hljs-number"><span class="hljs-number">72</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0x08</span></span>; PinF=MD910_Buffer[j+<span class="hljs-number"><span class="hljs-number">72</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0x04</span></span>; PinG=MD910_Buffer[j+<span class="hljs-number"><span class="hljs-number">72</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0x02</span></span>; PinH=MD910_Buffer[j+<span class="hljs-number"><span class="hljs-number">72</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0x01</span></span>; // <span class="hljs-number"><span class="hljs-number">1</span></span>  //    A,C  E,G () <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinA&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b1stHead_A, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinC&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b1stHead_C, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinE&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b2ndHead_E, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinG&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b2ndHead_G, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) {}; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) {}; DP_Count++; digitalWrite(b1stHead_A, LOW); digitalWrite(b1stHead_C, LOW); digitalWrite(b2ndHead_E, LOW); digitalWrite(b2ndHead_G, LOW); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) {}; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) {}; DP_Count++; // <span class="hljs-number"><span class="hljs-number">2</span></span>  //    B,D  F,H () <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinB&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b1stHead_B, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinD&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b1stHead_D, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinF&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b2ndHead_F, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PinH&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) digitalWrite(b2ndHead_H, HIGH); // <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { }; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) { }; DP_Count++; digitalWrite(b1stHead_B, LOW); digitalWrite(b1stHead_D, LOW); digitalWrite(b2ndHead_F, LOW); digitalWrite(b2ndHead_H, LOW); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) {}; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (DP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) {}; DP_Count++; }; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (RP_Status()==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) {}; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (RP_Status()==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) {}; //*********************************************************************************************************** Serial.println(<span class="hljs-string"><span class="hljs-string">"Done!"</span></span>); }</code> </pre><br></div></div><br>  Another interesting surprise was presented to me by Xiaom Power Bank, which I planned to use as a power source.  It simply did not turn on from the load in the form of Arduino, when forcibly turned on (by pressing the button) it turned on, fed the load for a couple of seconds, then was cut off.  The reason - I think one: Arduinka does not consume so much, the motors and the print head (the main consumer) pulls in pulses, but not constantly (the load jumps from tens of milliamperes to a pair of amps) ... <br><br>  I had to fence the power supply unit from the 12 volt 5 amp power supply unit for the LED strip + 2 DC-DC converters on the LM2596 folk.  I connected a Schottky diode + a 2.5 ohm resistor to limit the currents in the +5 volt output circuit. <br><br><img src="https://habrastorage.org/webt/pn/gu/th/pnguthplz4qu_zfrtxiq_vt6zk0.jpeg"><br><br>  Since the printer is a matrix printer, a tape cartridge is used for printing, yes, yes, as in the old days.  I tried to try to restore the native cartridge, soaked it in water for a week.  I tried to make out in order to soak the foam rubber with paint-mastic.  The foam just crumbled ... The closest cartridge from me is in Samara.  :( <br><br><img src="https://habrastorage.org/webt/tl/yc/ah/tlycaheftavmz-jewcp1jvlnjmo.jpeg"><br><br>  Then I decided to try to find a paper that is sensitive to shocks (when I bought it, the seller warned me a couple of times that this tape didn‚Äôt fit anywhere;) I had to reassure her that I understood everything, and then there would be no complaints from me ...;)) .  I found only a tape 80 mm wide, I had to cut it into pieces and reduce the width to 57 mm, in a good old tube way with a ballpoint pen and ruler ... But it prints!  ;) <br><br><img src="https://habrastorage.org/webt/wt/az/ns/wtaznsebehqta7gcfxtphenkgfs.jpeg"><br><br>  What does the final result look like?  20 mm plywood fixed printer and control boards.  At installation, ShVVP 2 * 0.5mm, WAGO connectors and a terminal block are used!  ;) MGTF ended a long time ago ... And I can not find it at all on sale in my city.  :( <br><br><img src="https://habrastorage.org/webt/zf/im/ak/zfimakzhmyvsxnez4skzgd3xd1k.jpeg"><br><br>  Video with a demonstration of the printer. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Qp8lzuz7ZmA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><div class="spoiler">  <b class="spoiler_title">Source text, fonts, useful utilities, documentation</b> <div class="spoiler_text">  <a href="">Source Code</a> <br>  <a href="https://github.com/alladin75/md910/blob/master/MD910SPE_103.pdf">MD910 DataSheet</a> <br>  <a href="http://old-dos.ru/index.php%3Fpage%3Dfiles%26mode%3Dfiles%26do%3Dshow%26id%3D6039">A set of monospace fonts from crackers.</a> <br>  <a href="http://tomeko.net/online_tools/file_to_hex.php%3Flang%3Den">File Converter in C, Asm, Pascal</a> <br></div></div><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/374395/">https://habr.com/ru/post/374395/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../374383/index.html">Unexpected meeting. Chapter 15</a></li>
<li><a href="../374385/index.html">What the Beatles, Radiohead, Doors and other musicians took from classical composers</a></li>
<li><a href="../374389/index.html">Possible future of optical media: 10 TB, 600 years, one disc</a></li>
<li><a href="../374391/index.html">Events in cities on Cosmonautics Day-2018</a></li>
<li><a href="../374393/index.html">Except Lego. What to collect with the child at your leisure: a selection of designers up to 1000 rubles</a></li>
<li><a href="../374397/index.html">This imperfect reality requires correction: a selection of AR-programs</a></li>
<li><a href="../374399/index.html">Smart home control system on the knee: Tarantool</a></li>
<li><a href="../374401/index.html">The story "Ambush"</a></li>
<li><a href="../374403/index.html">What does the Earth look like from space?</a></li>
<li><a href="../374405/index.html">Use Onion Omega2 to create devices with Linux and Wi-Fi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>