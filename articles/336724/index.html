<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>35-kilobyte post-nuclear caravan</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="35 kilobytes of minified code in regular JavaScript, seven cities, wastelands, radioactive geckos, edible cacti, oncoming caravans and gangsters. What...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>35-kilobyte post-nuclear caravan</h1><div class="post__text post__text-html js-mediator-article">  35 kilobytes of minified code in regular JavaScript, seven cities, wastelands, radioactive geckos, edible cacti, oncoming caravans and gangsters.  What is it?  This is a small game that runs in a browser.  Its principles are quite simple to repeat and in the most primitive version it can be recreated, probably, on any device, if there is an output device and a random number generator.  But today I want to tell you how I implemented it for modern browsers. <br><br>  In the current version, the player controls a caravan that travels between cities after a nuclear war.  Krotokrysy steal food stocks, and radioactive geckos kill the Brahmin.  Thieves can track down the caravan and steal some of the money, and in the desert, radioactive ghouls, raiders and other bandits can attack. <br><br>  The whole setting, the world and the logic can be modified as you like - the source code and graphics are distributed as a public domain, that is, without restrictions on copying and use. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/web/8dd/ea5/636/8ddea563615c4a37b96e68f6cd43094e.jpg"><a name="habracut"></a><br><br><h2>  Game features </h2><br>  Your trackers can find edible cactus or pre-war canned food.  In the desert you can find the corpses of other travelers, from which you can raise some money.  You can buy food or brahmins from oncoming caravans, as well as hire people.  And you can be joined by oncoming tramps, and sometimes - even gangsters, if you hit them with your charisma.  Joke.  In fact, the charisma in the game yet, it is emulated randomly. <br><br>  This game is, in fact, the next step in the evolution of text games, to which we added navigation around the world map, random encounters, and the ability to add any of our modules in JavaScript. <br><br>  The functionality can be easily expanded, charisma and other real role factors add themselves.  Even if you do not want to program - you can simply open files with a set of events in Notepad and add new events, change the balance or even completely rewrite the world and ENT, turning the journey through the post-nuclear desert into the adventures of Buttercup caravan in the land of elves.  Or in the wanderings of a spaceship between different star systems (although it is necessary to throw away edible cacti that come across on the way). <br><br>  The mechanics of this game are quite simple, and its graphic capabilities are dialogues, indicators and movement around the world map.  Her strength lies in the magic of text-based games, which are capable of using words to describe the most incredible adventures. <br><br><h2>  The main idea and logic of the program </h2><br>  The basic idea of ‚Äã‚Äãthe game is very simple - we run an infinite loop, inside which four basic operations are performed: <br><br><ol><li>  Movement to a given point </li><li>  Countdown days </li><li>  Food consumption </li><li>  Check for probability for the event that awaits us in the wasteland </li></ol><br>  The last operation is the same snuff box from which gangsters, ghouls, meetings with dead travelers, all other adventures that can be invented, jump out like devils. <br><br>  How does this happen?  Very simple - each event simply changes the numerical parameters of a caravan or the world, and then reports this to the log.  And here magic arises - the parameters can be the same, but you can report completely different reasons.  Minus a few units of food?  These could be rat attacks, fallout or hungry vagabonds.  Plus a few units of food?  So, your people found an edible cactus, excavated pre-war canned goods in roadside ruins, or found wonderful leather boots with soft soles on the road. <br><br>  The first version with which I started experimenting looked like a pure illustration of the algorithm described: <br><br><img src="https://habrastorage.org/web/2b3/1e4/af7/2b31e4af719d48aa8ffa7c86c4c279f8.png"><br><br>  I made this prototype as a remake of a game about the Oregon caravan from <a href="https://gamedevacademy.org/js13kgames-tutorial/">this tutorial</a> . <br><br><h2>  One-dimensional prototype - caravan for js13kGames </h2><br>  The game from the tutorial that I found was one-dimensional - the caravan left from one point and came to another.  On the way there were random events, meetings with gangsters and merchants. <br><br><img src="https://habrastorage.org/web/959/64c/a93/95964ca934264198ae436b78493ad350.png"><br><br>  The player in this version was very limited.  Basically, he had to admire the log with events.  Interactive came only from time to time, when a store or gangsters appeared.  At the same time, all events had an equal probability and were even stored in one array. <br><br>  When I looked at the result, I realized that the game can be expanded to a real sandbox.  It was necessary only to add freedom, make a modular code and post events on different modules.  I had to rework the code almost completely. <br><br><div class="spoiler">  <b class="spoiler_title">List of changes</b> <div class="spoiler_text"><ol><li>  Reusable journey - the game does not stop with the goal </li><li>  Two-dimensional map of the world and city </li><li>  Another setting of the world and no dysentery </li><li>  Gangsters can negotiate and engage </li><li>  Added products that are automatically sold and bought when reaching the city </li><li>  Modular system - plugin-based logic and event sets in separate files </li></ol><br></div></div><br><h2>  Caravan engine and architecture </h2><br>  The game, as already mentioned, is made in pure JavaScript without the use of third-party libraries (you can add them yourself if you see fit).  To display a map of the world and the interface using plain HTML and CSS.  To modify them, basic DOM operations and the classic document.getElementById operation are used. <br><br><div class="spoiler">  <b class="spoiler_title">An example of displaying the number of players in the caravan</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.view = {}; <span class="hljs-comment"><span class="hljs-comment">//     DOM this.view.crew = document.getElementById('game-stat-crew'); //      // ... this.view.crew.innerHTML = world.crew; //        html</span></span></code> </pre> <br></div></div><br><h2>  WorldState - a model of the world </h2><br>  The world in the game is a WorldState class.  It stores all the important parameters and does not contain any logic.  Logic we will tie later, at the expense of plug-ins. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WorldState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">stats</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.day = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  ,    this.crew = stats.crew; //   this.oxen = stats.oxen; //   this.food = stats.food; //   this.firepower = stats.firepower; //   this.cargo = stats.cargo; //    this.money = stats.money; // //  ,  ,    // { day: 1, message: " ", goodness: Goodness.positive} this.log = []; //  ,     this.caravan = { x: 0, y: 0}; this.from = {x: 0, y: 0}; this.to = {x: 0, y: 0}; this.distance = 0; //    this.gameover = false; // gameover this.stop = false; //    ,    this.uiLock = false; //     }</span></span></code> </pre><br><h2>  Game - the creation of the world and the game cycle </h2><br>  The game loop is started and controlled by the Game object.  The same object creates the world.  Notice the plugins field ‚Äî by default, this is an empty array.  Game knows nothing about plugins, except for two things - they must have the init (world) initialization function and the update update function. <br><br><pre> <code class="javascript hljs">Game = { <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [], <span class="hljs-comment"><span class="hljs-comment">//  , }; Game.init = function () { //           //   StartWorldState   data this.world = new WorldState(StartWorldState); var i; for (i = 0; i &lt; this.plugins.length; i++) { this.plugins[i].init(this.world); } }; //   Game.addPlugin = function (plugin) { this.plugins.push(plugin); }; //   Game.update = function () { if (this.world.gameover) return; //   var i; for (i = 0; i &lt; this.plugins.length; i++) { this.plugins[i].update(); } }; Game.resume = function () { this.interval = setInterval(this.update.bind(this), GameConstants.STEP_IN_MS); }; Game.stop = function () { clearInterval(this.interval); }; Game.restart = function () { this.init(); this.resume(); };</span></span></code> </pre><br>  To start a new game, you need to call the Game.restart function.  But before this happens, you need to add some plugin - otherwise nothing will happen, we just have a game cycle to idle. <br><br><h2>  Eat, live, move - CorePlugin </h2><br>  The most basic actions of the caravan - moving, counting down time and food consumption - are implemented in the CorePlugin object: <br><br><div class="spoiler">  <b class="spoiler_title">CorePlugin source code</b> <div class="spoiler_text"><pre> <code class="javascript hljs">CorePlugin = {}; CorePlugin.init = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">world</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.world = world; <span class="hljs-comment"><span class="hljs-comment">//  world this.time = 0; //     ,   this.dayDelta = GameConstants.STEP_IN_MS / GameConstants.DAY_IN_MS; //       this.lastDay = -1; //     this.speedDelta = Caravan.FULL_SPEED - Caravan.SLOW_SPEED; //       }; CorePlugin.update = function () { if (this.world.stop) return; //   -   this.time += GameConstants.STEP_IN_MS; //   this.world.day = Math.ceil(this.time / GameConstants.DAY_IN_MS); //  ,  //      ,    this.updateDistance(this.dayDelta, this.world); //       if (this.lastDay &lt; this.world.day) { this.consumeFood(this.world); this.lastDay = this.world.day; } }; //       CorePlugin.consumeFood = function (world) { world.food -= world.crew * Caravan.FOOD_PER_PERSON; if (world.food &lt; 0) { world.food = 0; } }; //           CorePlugin.updateDistance = function (dayDelta, world) { var maxWeight = getCaravanMaxWeight(world); var weight = getCaravanWeight(world); //   - Caravan.SLOW_SPEED //  0  - Caravan.FULL_SPEED var speed = Caravan.SLOW_SPEED + (this.speedDelta) * Math.max(0, 1 - weight/maxWeight); // ,        var distanceDelta = speed * dayDelta; //     var dx = world.to.x - world.caravan.x; var dy = world.to.y - world.caravan.y; //      -  if(areNearPoints(world.caravan, world.to, Caravan.TOUCH_DISTANCE)){ world.stop = true; return; } //     -    //      var angle = Math.atan2(dy, dx); world.caravan.x += Math.cos(angle) * distanceDelta; world.caravan.y += Math.sin(angle) * distanceDelta; world.distance += distanceDelta; }; //     Game.addPlugin(CorePlugin);</span></span></code> </pre><br></div></div><br>  It's all elementary.  At first, when we start the game, init is called for us, which will allow us to save the link to the model of the world.  Then, in the game cycle, we will be called update, which will change the world for the better, as the characters from the series ‚ÄúSilicon Valley‚Äù like to say.  Joke - the world will change in all directions. <br><br>  Our base plugin counts time in milliseconds, translates them into days, and then updates the distance and food reserves.  In principle, the plug-in object simply has to contain the functions init (world) and update (), and it can do anything.  You can even simply call up some other HTML5 game or create a dialog box. <br><br>  To connect a plugin, you need to add its code between the definition of the Game object and the first call to Game.restart ().  Approximately the way it is done now in index.html: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js/Game.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js/plugins/CorePlugin.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined"> Game.restart(); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h2>  So, how to make a game about a caravan </h2><br>  If you are an experienced programmer, you can certainly implement such a toy in any language and graphical level, simply starting from the very idea of ‚Äã‚Äã‚Äúa cycle in which movement and random selection from an array of events takes place‚Äù.  I think it will turn out well even a game for bash, especially since <a href="https://habrahabr.ru/post/335960/" title="Playfully bash'im">recent publications show</a> that there are some very interesting graphical features. <br><br>  If you are familiar with JavaScript at least at a basic level - you can download the source code for the game, which I did in this language, and freely modify and improve them.  You can use any architecture if you are not satisfied with the current one.  But the easiest option is to simply add a plugin, implemented according to the principle described above. <br><br>  Existing plugins can be disabled (by removing their source code from index.html or by commenting out the line from Game.addPlugin (SomePlugin) at the end of their code).  They know nothing about each other and simply change the model of the world or the interface of the game. <br><br>  And the last option, for writers, just open files in the data directory and edit event descriptions and constants.  Although these are the same javascript sources, they are content easy to change.  Especially the lyrics.  To prove this, I will briefly describe how the other plugins in the current version are arranged. <br><br><h2>  Random events </h2><br>  All primitive random events are in the data / RandomEvents.js file in the RandomEvents variable in the following format: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> RandomEvents = [ { <span class="hljs-attr"><span class="hljs-attr">goodness</span></span>: Goodness.negative, <span class="hljs-attr"><span class="hljs-attr">stat</span></span>: <span class="hljs-string"><span class="hljs-string">'crew'</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">'   ! : -$1'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">goodness</span></span>: Goodness.negative, <span class="hljs-attr"><span class="hljs-attr">stat</span></span>: <span class="hljs-string"><span class="hljs-string">'food'</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-number"><span class="hljs-number">-10</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">'     .  : -$1'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">goodness</span></span>: Goodness.positive, <span class="hljs-attr"><span class="hljs-attr">stat</span></span>: <span class="hljs-string"><span class="hljs-string">'money'</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">'    .    . : +$1'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">goodness</span></span>: Goodness.positive, <span class="hljs-attr"><span class="hljs-attr">stat</span></span>: <span class="hljs-string"><span class="hljs-string">'crew'</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">'   ,       . : +$1'</span></span> },</code> </pre><br>  Objects of random events are contained in curly braces.  In this example, I cited only four objects, but in general their number can be anything.  Just keep in mind that with an increase in the number of events, the probability of a particular individual falling out of them decreases. <br><br>  The first field, goodness, means positive, negative and neutral coloring of the message in the log.  The second field, stat, contains the name of the WorldState parameter, which should be changed.  Value is the average value for changing this parameter.  The last field should contain any arbitrary text describing what happened.  Instead of the symbol $ 1 in the text will be substituted for the actual change of the parameter, which will fall in the game. <br><br>  Random events are checked for a drop in the RandomEventPlugin object and delight the player in the log: <br><br><img src="https://habrastorage.org/web/97a/8b2/826/97a8b28265474f41a6a073a24b0826c8.png"><br><br>  One last note: in RandomEvents.js, you will find a variable with a probability constant for a random event.  It is set as the average number of events per game day of the caravan.  When I experimented with different values, I found out that too many random events, which cannot be influenced in any way, begin to annoy wildly.  The lack of interactive is the main disadvantage of these simple events.  That's why I scratched my head and decided to make a universal dialog module that can be called from other plugins. <br><br><h2>  How to write or edit a dialogue </h2><br>  The DialogWindow object is responsible for the dialog system.  If you look at its source code, you will see a mutant that finds the desired div element in the HTML code and binds to it the general click handler with the mouse.  The idea is that when we ask this object to show us a new dialogue, we give it an array of our dialogs.  And the handler for clicking on a particular choice is described in a specific dialog in this format: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> DeathDialogs = { <span class="hljs-string"><span class="hljs-string">"start"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">icon</span></span>: <span class="hljs-string"><span class="hljs-string">"images/pic_death.jpg"</span></span>, <span class="hljs-comment"><span class="hljs-comment">//   url  title: "  ", //   desc: "", //    desc_action: function (world, rule) { //       var desc = "  : "+rule.text+".    "+Math.floor(world.distance) + "    "+Math.floor(world.money) + " "; desc += " ,    ?" return desc; }, choices:[ //   { text: '  ', //    action: function () { return "stop"; } // ,     } ] }, };</span></span></code> </pre><br>  In the dialogues of death there is only one option, described as the "start" field.  But such options can be infinitely many.  For example, in the dialogues of bandits, I realized 12 forks.  How does the transition between them?  Our universal DialogWindow object, when calling the show function, keeps a list of the passed dialogs and shows the one defined in the "start" field. <br><br>  When the next dialog is displayed, its choices array is displayed as a set of buttons, in the attributes of which the selection number is written.  And all the action functions from choices are written to the internal array dialogActions.  When you click on the selection button with a mouse, the universal handler determines the function number in the dialogActions and calls it, passing in passing the two arguments that we decided to use in this dialog.  Thus, in dialogues with gangsters, the action function in a particular choice can assume the state of the world (world) and the description of current gangsters (bandits).  And in the dialogs to other plugins - other options.  Yes, you can and without them at all, especially if the point of choice is to simply end the dialogue, as with a game gem. <br><br><img src="https://habrastorage.org/web/754/640/18a/75464018ac404455bc0382355253a79b.png"><br><br>  In order for the dialog to end and the player return to the world map, it is necessary that the action function in the choice object returns one of the reserved tags ‚Äúfinish‚Äù, ‚Äúexit‚Äù, ‚Äústop‚Äù.  In general, the meaning of this function is to return the name of the next fork.  But before this cherished return-a, you can and sometimes you need to insert any logic, any calculations that will allow you to choose the next fork - ‚Äúrun‚Äù, ‚Äúfight‚Äù or, perhaps, even ‚Äúlove‚Äù. <br><br><h2>  How to call a dialog from the plugin </h2><br>  At any time in the update of any running plug-in, you can call the dialog as follows: <br><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... -   update  - //  ,   world.stop = true; //        DeathDialogs //      world  rule DialogWindow.show(DeathDialogs, world, rule, this);</span></span></code> </pre><br>  Also, the onDialogClose function must be implemented in the plugin - this callback will be called after the dialog is closed.  An example from a plugin defining death: <br><br><pre> <code class="javascript hljs">DeathCheck.onDialogClose = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ Game.restart(); };</code> </pre><br><h2>  Brief description of existing plugins </h2><br>  The current version of the game uses the following plugins: <br><br>  <b>Map2DPlugin</b> - move the caravan around the map.  Search for cities that are specified in index.html as regular divs with parameters top and left.  It also determines the arrival in the city and automatic trading takes place. <br><br>  <b>ShopPlugin</b> - generation of random oncoming caravans or other merchants.  Allows you to buy food, brahmins and hire mercenaries.  Or buy nothing and go on. <br><br>  <b>BanditPlugin</b> - meetings and dialogues with bandits.  Around the middle of this plugin, I realized that with the idea of ‚Äã‚Äãmaking a simple tutorial I got excited.  Simple did not work, sorry.  Gangsters can hire you, and if they die of hunger, they will be asked to accept them for free if you refuse to hire them for money. <br><br>  <b>DropPlugin</b> - plugin overload.  In the prototype from the tutorial about the Oregon caravan, the game itself automatically dropped things - first a weapon, and then a meal.  It was not very comfortable and puzzling - how is that?  After all, you can get food with weapons, but ‚Äúyou cannot kill the enemy with fried meat‚Äù (c) one famous stream in Fallout 4. So I decided to make a dialogue in which you simply choose what to get rid of. <br><br>  <b>DeathCheck</b> - death check plugin.  This is still a very simple plugin, and for sure there may be questions for it.  For example, why do people die immediately when food ends?  Well, I propose to answer this question yourself - or wait for the next version if everything goes well. <br><br>  <b>WorldViewPlugin</b> is an interface plugin.  It simply updates the interface, showing the current parameters of the world.  Perhaps this idea will seem strange to someone - an independent interface object that tracks changes in the update cycle.  But then, thanks to this strange idea, we got rid of numerous updateUi and gained independence between blocks of different logic. <br><br><h2>  Small tips on the current game and balance </h2><br>  The vital parameter now is the amount of food.  It can be replenished when meeting with other caravans - if they occur, it should be purchased to the maximum.  Of course, it would be reasonable to add a purchase in the cities, but we will assume that for the time being they all suffer from a lack of food. <br><br>  The second vital parameter is the number of people in the caravan.  They should be.  If all people are knocked out - the game ends. <br><br>  All changes in the balance sheet that increase the damage to food and the number of people dramatically increase the difficulty of the game. <br><br><h2>  Links and distributions </h2><br>  I used the Creative Common 0 license from pixabay.org and opengameart.org, so both the graphics and the code are distributed under these conditions - free to copy and use, without any obligations. <br><br>  You can get the source code from <a href="https://github.com/Kvisaz/nukecaravan">GitHub</a> or download the zip archive <a href="">from here</a> .  The first option is preferable, as it is often updated. <br><br>  To test, even on the local computer, it is enough to open index.html in the browser - there are no functions that necessarily require a server. <br><br>  Live build games can be <a href="http://skachat-besplatno.ru/gamelab/zoolander/">tested here</a> .  Layout is designed for regular monitors, not for mobile screens. </div><p>Source: <a href="https://habr.com/ru/post/336724/">https://habr.com/ru/post/336724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../336714/index.html">Unity 2017: an overview of new features</a></li>
<li><a href="../336716/index.html">We sculpt a toolbar on PyQt, export data to Excel and HTML</a></li>
<li><a href="../336718/index.html">Interview with Herbert Lin (CISAC): ‚ÄúCyber ‚Äã‚Äãsecurity is an endless battle‚Äù</a></li>
<li><a href="../336720/index.html">How to lead introverts without harm to health</a></li>
<li><a href="../336722/index.html">Inside the super-fast CSS engine: Quantum CSS (aka Stylo)</a></li>
<li><a href="../336726/index.html">How well are your SSH sessions secured?</a></li>
<li><a href="../336728/index.html">ARCore: Augmented Reality on Android</a></li>
<li><a href="../336730/index.html">Google Titan - New Chip Details Revealed</a></li>
<li><a href="../336732/index.html">Source Ripper and AST Spring Boot Tree</a></li>
<li><a href="../336738/index.html">CAA DNS record. Why do I need and how to use?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>