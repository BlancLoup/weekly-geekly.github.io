<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Setting up IPTV in OpenWRT</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Although I practically do not watch TV, sometimes there is an overwhelming desire to see what is now being broadcast in the news. Often this desire ar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Setting up IPTV in OpenWRT</h1><div class="post__text post__text-html js-mediator-article">  Although I practically do not watch TV, sometimes there is an overwhelming desire to see what is now being broadcast in the news.  Often this desire arises when the daughter is asleep, and the TV is already out of range.  As you understand the only way out is IPTV. <br><a name="habracut"></a><br>  By a happy coincidence, I have a tariff plan with a free IPTV package and a Netgear WNDR-3800 router.  The router has OpenWrt Backfire 10.03.1 firmware. <br>  Since comments have appeared in the comments about the fact that udpxy is not such a necessary thing, it should be noted separately that I watch IPTV exclusively over WiFi, and some devices do not support 802.11n and the picture crumbles when using multicast. <br>  On Habr√© there were many articles about OpenWrt, about <a href="http://habrahabr.ru/blogs/nix/128451/">setting up a network in OpenWrt</a> , setting up <a href="http://habrahabr.ru/blogs/sysadm/111317/">IPTV broadcasts</a> , and some others, but unfortunately in them the process of setting up IPTV itself, if described, then without any details.  And although this process is not complicated at all, I hope my topic will shorten the time for searching and reading the necessary manuals, which are plenty in the network.  I‚Äôm not making these settings for the first time, because sometimes in the process of experimenting with VPN, Wi-Fi and other buns, the router died and was restored in emergency mode.  Therefore, be careful and careful that you would not have to go to the recovery procedure. <br><br>  All settings will be made from the console, because  I have not trusted LuCI for some time now.  It is assumed that you are connected to the router via ssh under the root. <br><br>  First, install udpxy: <br><pre>  opkg update
 opkg install udpxy </pre><br>  After successful installation, check that udpxy starts: <br><pre>  / usr / bin / udpxy </pre><br>  This command will output the udpxy version and its main options.  By the way, a detailed description of all the options can be found <a href="http://cpansearch.perl.org/src/LEANDR/udp_proxy-0.02/udpxy-manual-RU.rtf">here</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's go to the actual setting.  In the /etc/init.d folder, create the udpxy file: <br><pre>  cd /etc/init.d
 vi udpxy </pre><br>  This file is the udpxy startup script.  Learn more about the startup scripts OpenWrt <a href="http://wiki.openwrt.org/doc/techref/initscripts">here</a> . <br>  The contents of our file will be something like this: <br><pre>  #! / bin / sh /etc/rc.common
 # Copyright (C) 2010 OpenWrt.org

 START = 99
 STOP = 10

 IGMP_OPTS = "- a br-lan -m eth1 -p 8888 -M 600"
 IGMP_BIN = "/ usr / bin / udpxy"
 PID_F = "/ var / run / udpxy.pid"

 start () {
         echo "Starting udpxy"
         start-stop-daemon -S -x $ IGMP_BIN -p $ PID_F -b -m - $ IGMP_OPTS
 }

 stop () {
         echo "Stopping udpxy"
         start-stop-daemon -K -x $ IGMP_BIN -q
 } </pre><br>  To start the service, use the start-stop-daemon - a utility to control the start and stop of system services.  In IGMP_BIN, we specify what to start from where, PID_F - where to write the PID so that it could be monitored for it later, IGMP_OPTS - the settings of the service being started. <br><br>  Before specifying the settings, I advise you to try to run udpxy with these settings, and only after that transfer them to the config, it will help you avoid becoming a victim of a typo, and it may save you some time. <br><br>  After all the settings are completed, close the udpxy file and start the service with the command <br><pre>  /etc/init.d/udpxy start </pre><br>  You can check whether udpxy started using the command <br><pre>  ps | grep udpxy </pre><br>  If you see only one line in the result, go back to the settings and check what you did wrong.  If everything is correct, it should be something like <br><pre>  1637 root 804 S / usr / bin / udpxy -a br-lan -m eth1 -p 8888 -M 600 
 29984 root 1372 S grep udpxy </pre><br>  You can also open the <a href="http://192.168.1.1:8888/status">http://192.168.1.1:8888/status</a> page in your browser to check that udpxy is working. <br>  Now you can set our startup script to autoload.  To do this, just run the command: <br><pre>  /etc/init.d/udpxy enable </pre><br>  after that, a symbolic link of the form S99udpxy should appear in the /etc/rc.d folder.  You can check whether the script was added to autoload by the same command <br><pre>  /etc/init.d/udpxy enabled &amp;&amp; echo "enabled" </pre><br>  if everything is ok, you will get ‚Äúenabled‚Äù in response. <br><br>  The case remains for the small - to create rules for traffic udp: <br><pre>  config rule
         option src wan
         option proto igmp
         option target ACCEPT
 config rule
         option src wan
         option proto udp
         option dest_ip 224.0.0.0/4
         option target ACCEPT </pre><br>  These rules must be added to / etc / config / firewall, and then restart the service with the command: <br><pre>  /etc/init.d/firewall restart </pre><br>  You can also restart the router itself to make sure that all the necessary services are running, and everything works exactly as we intended. <br>  Now we take the channel list from the provider, and convert all the links as described in the manual to udpxy: <br><pre>  http: // {address}: {port} / {protocol} / {channel_addr}: {channel_port} </pre><br>  that is, if you have indicated in the channel list <pre>  rtp: //@111.22.33.44: 1234 </pre>  then the output should be <pre>  http://192.168.1.1:8888/udp/111.22.33.44:1234 </pre><br><br>  After that, open the channel list with any suitable player and enjoy. <br></div><p>Source: <a href="https://habr.com/ru/post/138735/">https://habr.com/ru/post/138735/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138725/index.html">Trusted loading and data protection during remote work at graphic stations</a></li>
<li><a href="../138726/index.html">Youporn chat usernames, passwords and mail leak</a></li>
<li><a href="../138731/index.html">OpenGL Mathematics (GLM) Library Overview</a></li>
<li><a href="../138732/index.html">Autoscaling in Amazon Web Services: EC2 + CloudWatch</a></li>
<li><a href="../138734/index.html">ReactOS: Don't Stop Me Now!</a></li>
<li><a href="../138736/index.html">Password-protected iPhone cracked with a paper clip</a></li>
<li><a href="../138737/index.html">HyperDex is a new open source NoSQL key-value repository, sharpened to a very fast search.</a></li>
<li><a href="../138739/index.html">What additional information would you like to see when defining a city by IP?</a></li>
<li><a href="../138740/index.html">Paged navigation in XSLT</a></li>
<li><a href="../138741/index.html">] [ackQuest - NeoQuest 2012</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>