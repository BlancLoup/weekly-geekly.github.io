<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I made friends with the Quickbooks and PHP site using the Web Connector</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once, the client needed integration of Quickbooks (hereinafter QB) and the site, which we are doing to him. The first question that I had about this w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I made friends with the Quickbooks and PHP site using the Web Connector</h1><div class="post__text post__text-html js-mediator-article">  Once, the client needed integration of Quickbooks (hereinafter QB) and the site, which we are doing to him.  The first question that I had about this was: " <i>What is QB, and can it even be realized?</i> ". <br><br>  A little googling I found what I was looking for.  <b>Quickbooks</b> is an accounting program for small businesses (the main market for US use).  This is something like 1C, but only with a normal GUI and some cool buns.  QB is an application that the user puts on his computer ( <b>only for Windows</b> ) and with the help of a couple of clicks, develops a company in which he maintains bookkeeping. <br><br>  Well, now I, at least, know my enemy by sight, one less problem.  As for integration, everything is a little more complicated.  What can you integrate QB <a href="https://developer.intuit.com/docs/0025_quickbooksapi/0055_devkits">here</a> .  What we see there: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  .NET SDK </li><li>  Java sdk </li><li>  PHP SDK (Coming Soon) </li><li>  Windows Azure SDK </li><li>  QuickBooks QBXML v12 SDK (but <i>on desktop scenarios only</i> ) </li></ul><br><br>  Hmm, PHP SDK (Coming Soon) - the last hope ... I almost despaired, but <a href="http://wiki.consolibyte.com/wiki/doku.php/quickbooks_web_connector">it</a> saved me.  What is this thing like - <b>Web Connector</b> ?  On the off site for this there is a small <a href="https://developer.intuit.com/docs/0025_quickbooksapi/0055_devkits/0250_qb/0010_get_oriented/0080_quickbooks_web_connector">page</a> on which they offer to download <i>QuickBooks Web Connector Programmer's Guide</i> , and that's it (at least I‚Äôm tired of looking for information on the off site). <br><a name="habracut"></a><br><br>  What is Web Connector? <br>  Web Connector is a kind of intermediary between QB and the web server (it is installed along with QB).  By timeout or clicking the mouse, he knocks on a specific url on your site, receives a request from the site that needs to be asked from QB and transmits it;  waiting for a response from QB, and when it waits, it knocks on the site and sends you a response from QB. <br><br>  And so let's get started ... <br>  First we need to tell the Web Connector where to knock, and this is done with the help of the <b>* .QWC</b> file. <br><br><div class="spoiler">  <b class="spoiler_title">clients.QWC</b> <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">QBWCXML</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppName</span></span></span><span class="hljs-tag">&gt;</span></span>QuickBooks Integrator (clients)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppID</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppURL</span></span></span><span class="hljs-tag">&gt;</span></span>http://localhost/quickbooks/clients.php<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppURL</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppDescription</span></span></span><span class="hljs-tag">&gt;</span></span>Export Customers from QB to csv file<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppDescription</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppSupport</span></span></span><span class="hljs-tag">&gt;</span></span>http://localhost/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppSupport</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserName</span></span></span><span class="hljs-tag">&gt;</span></span>admin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OwnerID</span></span></span><span class="hljs-tag">&gt;</span></span>{90A44FB7-33D6-4815-AC85-AC86A7E7123B}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OwnerID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FileID</span></span></span><span class="hljs-tag">&gt;</span></span>{57F3B9B6-86F6-4FCC-B1FF-967DE1813123}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FileID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">QBType</span></span></span><span class="hljs-tag">&gt;</span></span>QBFS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">QBType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">IsReadOnly</span></span></span><span class="hljs-tag">&gt;</span></span>false<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">IsReadOnly</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">QBWCXML</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br><br><ul><li>  AppName - the name of the service that will be displayed in the Web Connector list </li><li>  AppID - why I need it, I still do not understand, but it does not work without it </li><li>  AppURL - here you can see the url on which the Web Connector will knock.  There is a reservation here, <b>http</b> can only be used for debugging purposes, those.  if the domain contains the word <i>localhost</i> (test-localhost-serv, localhost-admin ...) then you can use http.  But if it does not, then you need to use <b>https</b> and here without options. </li><li>  AppDescription - service description </li><li>  AppSupport - url for which will be displayed in the list of web connector'a, as a link to the help (here you can specify http) </li><li>  UserName is the name of the user from which we will communicate to the QB database (such user should be created in QB) </li><li>  OwnerID and FileID are unique sequences consisting of hexadecimal characters (for each service its own, I just changed one value and that's it) </li><li>  QBType is the type of Web Connector connection to QB (possible values ‚Äã‚Äãare <i>QBFS</i> or <i>QBPOS</i> ) </li><li>  IsReadOnly - if your service modifies, deletes, adds data to QB, then it must be <i>true</i> </li></ul><br><br>  If you need the service to start automatically every 5 minutes, you need to add the following: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Scheduler</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunEveryNMinutes</span></span></span><span class="hljs-tag">&gt;</span></span>5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunEveryNMinutes</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Scheduler</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  A short supplement to <b>AppURL</b> : if you do not have the ability to configure https (or no money for a real certificate) on the server, then there are 2 loopholes: <br><br>  1) <i>We set the server's IP and the domain name from <b>localhost to the</b> hosts on which QB is installed, do not forget to ask for this domain in the settings of Apache on the server</i> <br>  2) <i>We put a self-made certificate and add it to the list of trusted servers, otherwise it will not work ( <a href="http://www.botik.ru/2/abonents/faq/done/055-server-certificate.html">example</a> )</i> <br><br>  To add qwc you need: <br>  - enable QB and open a company with which the application will work <br>  - open Web Connector <br>  - in the Web Connector, click the <i>Add an application</i> button, specify the qwc file. <br>  - when you click OK, QB will ask you if you want to give access to this application to the QB database (you need to select a user, ‚Äúadmin‚Äù in our case) <br>  - when you click ‚ÄúDone‚Äù on the last dialog box, return to the Web Connector and enter the password for the user ‚Äúadmin‚Äù <br>  - to launch the application, you need to check the box and click the <i>Update Selected</i> button <br><br><img src="https://habrastorage.org/getpro/habr/post_images/718/35e/8ad/71835e8ad5539ceccc5b0590f62c6763.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/802/7c3/034/8027c3034f0bfe52084f3773b0d3fa7e.png"><br><br>  So, now it's the turn of preparing the site for receiving Web Connector. <br>  As you remember, we indicated <code><a href="http://localhost/quickbooks/clients.php"></a> localhost/quickbooks/clients.php</code>  <code><a href="http://localhost/quickbooks/clients.php"></a> localhost/quickbooks/clients.php</code> , now <code><a href="http://localhost/quickbooks/clients.php"></a> localhost/quickbooks/clients.php</code> 's create it.  Web Connector uses the SOAP protocol, so the site will have to raise the SOAP server. <br><br><div class="spoiler">  <b class="spoiler_title">clients.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * File for integration QB * QB Webconnector send soap request to this file * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> QB SOAP */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * Log function * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $mess */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($mess = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ $file_name = <span class="hljs-string"><span class="hljs-string">'./log/clients.log'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!file_exists(dirname($file_name))) mkdir(dirname($file_name), <span class="hljs-number"><span class="hljs-number">0777</span></span>); $f = fopen($file_name, <span class="hljs-string"><span class="hljs-string">"ab"</span></span>); fwrite($f, <span class="hljs-string"><span class="hljs-string">"==============================================\n"</span></span>); fwrite($f, <span class="hljs-string"><span class="hljs-string">"["</span></span> . date(<span class="hljs-string"><span class="hljs-string">"m/d/YH:i:s"</span></span>) . <span class="hljs-string"><span class="hljs-string">"] "</span></span>.$mess.<span class="hljs-string"><span class="hljs-string">"\n"</span></span>); fclose($f); } <span class="hljs-comment"><span class="hljs-comment">/** * Log function * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $mess */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">requestId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ $file_name = <span class="hljs-string"><span class="hljs-string">'./log/clients_id.log'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!file_exists(dirname($file_name))) mkdir(dirname($file_name), <span class="hljs-number"><span class="hljs-number">0777</span></span>); <span class="hljs-comment"><span class="hljs-comment">// save id into file if(trim($id) !== ''){ $f = fopen($file_name, "c+b"); fwrite($f, $id); fclose($f); } $id = trim(file_get_contents($file_name)); return $id; } /** * System variables */ define('QB_LOGIN', 'admin'); define('QB_PASSWORD', ''); define('QB_TICKET', '93f91a390fa604207f40e8a94d0d8fd11005de108ec1664234305e17e'); /** * Main class for SOAP SERVER */ require 'qb_clients.php'; /** * Create SOAP server */ $server = new SoapServer("qbwebconnectorsvc.wsdl", array('cache_wsdl' =&gt; WSDL_CACHE_NONE)); $server-&gt;setClass("Qb_Clients"); $server-&gt;handle();</span></span></code> </pre><br></div></div><br>  The function <b>requestId ()</b> is necessary to save the transaction id to a file.  In the example that will be discussed later, we want to get a list of all customers, and this may be more than one thousand companies.  Therefore, we will receive portions of 500, so it is safer and the server load is less.  What are the <i>'QB_LOGIN</i> , <i>QB_PASSWORD</i> and <i>QB_TICKET</i> see below.  The last 3 lines are the creation of a SOAP server.  <b>qbwebconnectorsvc.wsdl</b> I found this file on the <b>offsites of the</b> site, but I don‚Äôt remember where (I‚Äôve recently redesigned it). <br><br>  Forgot to say, Web Connector knows only 8 words: <i>clientVersion</i> , <i>serverVersion</i> , <i>authenticate</i> , <i>sendRequestXML</i> , <i>receiveResponseXML</i> , <i>connectionError</i> , <i>getLastError,</i> and <i>closeConnection</i> . <br><br><div class="spoiler">  <b class="spoiler_title">qb.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * File contain base QB class and Result class (empty class for Qb reaponse) */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * Response class (empty class) * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> QB SOAP * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Response</span></span></span></span>{ } <span class="hljs-comment"><span class="hljs-comment">/** * Base class for QuickBooks integration * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> QB SOAP * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Qb</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * Response object * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $response = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Constructor * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@access</span></span></span><span class="hljs-comment"> public * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Response(); } <span class="hljs-comment"><span class="hljs-comment">/** * Function return client version * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> object $param * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@access</span></span></span><span class="hljs-comment"> public * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clientVersion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($param = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ $response-&gt;clientVersionResult = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $response; } <span class="hljs-comment"><span class="hljs-comment">/** * Function return server version * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@access</span></span></span><span class="hljs-comment"> public * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serverVersion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response-&gt;serverVersionResult = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response; } <span class="hljs-comment"><span class="hljs-comment">/** * Function try authenticate user by username/password * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> object $param * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@access</span></span></span><span class="hljs-comment"> public * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">authenticate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($param = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(($param-&gt;strUserName == QB_LOGIN) &amp;&amp; ($param-&gt;strPassword == QB_PASSWORD)) <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response-&gt;authenticateResult = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(QB_TICKET, <span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response-&gt;authenticateResult = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"nvu"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response; } <span class="hljs-comment"><span class="hljs-comment">/** * Function return last error * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> object $param * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@access</span></span></span><span class="hljs-comment"> public * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connectionError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($param = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response-&gt;connectionErrorResult = <span class="hljs-string"><span class="hljs-string">"connectionError"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response; } <span class="hljs-comment"><span class="hljs-comment">/** * Function return last error * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> object $param * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@access</span></span></span><span class="hljs-comment"> public * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLastError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($param = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response-&gt;getLastErrorResult = <span class="hljs-string"><span class="hljs-string">"getLastError"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response; } <span class="hljs-comment"><span class="hljs-comment">/** * Function close connection * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> object $param * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@access</span></span></span><span class="hljs-comment"> public * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">closeConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($param = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response-&gt;closeConnectionResult = <span class="hljs-string"><span class="hljs-string">"Complete"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response; } }</code> </pre><br></div></div><br><ul><li>  <b>clientVersion</b> - here the Web Connector is knocking us with says: ‚ÄúHey, the Web Connector with version xxxxx will reflect to you.  What do you need?".  In response, you can tell which version you want, or you can say nothing, which I did </li><li>  <b>serverVersion</b> - see above. </li><li>  <b>authenticate</b> - here the Web Connector tells us that such a user with such a login (we specified the login in the qwc file, and the password in the Web Connector password box), we compare with valid and skip, or send an error.  If successful, we give the Web Connector a <b>QB_TICKET</b> ticket that will be used during the current session. </li><li>  <b>sendRequestXML</b> - here we form a request that the Web Connector will transmit to QB'y. </li><li>  <b>receiveResponseXML</b> - receive data in response to our request </li><li>  <b>connectionError</b> - if an error occurred during data transfer, this method will be called </li><li>  <b>getLastError</b> - if we wrote a wrong request, then this method will be called </li><li>  <b>closeConnection</b> - if everything went according to plan, and we successfully accepted the request </li></ul><br><br>  In the file below, you can see how the request is formed, and how the data is processed. <br><br><div class="spoiler">  <b class="spoiler_title">qb_clients.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * File contains class Qb_Clients() extends Qb() */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * Include base class for SOAP SERVER */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'qb.php'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Class for import all clients from Qb * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> QB SOAP * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Qb_Clients</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Qb</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * Function send request for Quickbooks * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> object $param * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@access</span></span></span><span class="hljs-comment"> public * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 2013-10-20 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequestXML</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($param = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ $id = requestId(); <span class="hljs-comment"><span class="hljs-comment">// &lt;!-- ActiveStatus may have one of the following values: ActiveOnly [DEFAULT], InactiveOnly, All --&gt; if($param-&gt;ticket == QB_TICKET){ $request = '</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">xml version="1.0" encoding="utf-8"</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">qbxml version="12.0"</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment"> &lt;QBXML&gt; &lt;QBXMLMsgsRq onError="stopOnError"&gt; &lt;CustomerQueryRq requestID="'.time().'" metaData="NoMetaData" iterator="'.(($id != '')?'Continue':'Start').'" '.(($id != '')?'iteratorID="'.$id.'"':'').'&gt; &lt;MaxReturned&gt;500&lt;/MaxReturned&gt; &lt;ActiveStatus&gt;ActiveOnly&lt;/ActiveStatus&gt; &lt;/CustomerQueryRq&gt; &lt;/QBXMLMsgsRq&gt; &lt;/QBXML&gt;'; $this-&gt;response-&gt;sendRequestXMLResult = $request; } else $this-&gt;response-&gt;sendRequestXMLResult = "E: Invalid ticket."; return $this-&gt;response; } /** * Function get response from QB * * @return string * @param object $param * @access public * @version 2013-03-15 */ public function receiveResponseXML($param = '') { $response = simplexml_load_string($param-&gt;response); $iteratorID = trim($response-&gt;QBXMLMsgsRs-&gt;CustomerQueryRs-&gt;attributes()-&gt;iteratorID); // set new iteratorID requestId($iteratorID); if( ($param-&gt;ticket == QB_TICKET) &amp;&amp; isset($response-&gt;QBXMLMsgsRs-&gt;CustomerQueryRs-&gt;CustomerRet) ){ $rows = $response-&gt;QBXMLMsgsRs-&gt;CustomerQueryRs; settype($rows, 'array'); // if list contain only one item row if(isset($rows['CustomerRet']-&gt;ListID)) $rows = array($rows['CustomerRet']); else $rows = $rows['CustomerRet']; $data = array(); foreach ($rows as $i=&gt;$r) { settype($r, 'array'); $data[] = array( 'qb_id' =&gt; trim($r['ListID']), 'qb_es' =&gt; trim($r['EditSequence']), 'is_active' =&gt; trim($r['IsActive']), 'phone' =&gt; trim($r['Phone']), 'notes' =&gt; trim($r['Notes']), 'fax' =&gt; trim($r['Fax']), 'company_name' =&gt; trim($r['Name']), 'b_email' =&gt; trim($r['Email']), 'b_email_other' =&gt; trim($r['Cc']), 'b_phone' =&gt; trim($r['AltPhone']), 'b_salutation' =&gt; trim($r['Salutation']), 'b_fname' =&gt; trim($r['FirstName']), 'b_lname' =&gt; trim($r['LastName']), 'b_address' =&gt; trim($r['BillAddress']-&gt;Addr1), 'b_address2' =&gt; trim($r['BillAddress']-&gt;Addr2), 'b_address3' =&gt; trim($r['BillAddress']-&gt;Addr3), 'b_city' =&gt; trim($r['BillAddress']-&gt;City), 'b_state' =&gt; trim($r['BillAddress']-&gt;State), 'b_country' =&gt; trim($r['BillAddress']-&gt;Country), 'b_zip' =&gt; trim($r['BillAddress']-&gt;PostalCode), ); } // echo data into log file _log(print_r($data,1)); $this-&gt;response-&gt;receiveResponseXMLResult = '30'; } else $this-&gt;response-&gt;receiveResponseXMLResult = '100'; return $this-&gt;response; } }</span></span></code> </pre><br></div></div><br>  The string <code>&lt;?qbxml version="12.0"?&gt;</code> Indicates that I am using the 12th version of qbxml.  This is currently the latest available version (it is supported in the 13th and 14th QB).  The higher the qbxml version, the more QB features.  A list of all available requests can be found <a href="https://developer-static.intuit.com/qbSDK-current/Common/newOSR/index.html">here</a> .  Following the link you will see all possible requests that can be sent to QB (they will be displayed in the <b>Select Message</b> list).  The <b>Request</b> and <b>Response</b> tabs are generated depending on which request you have selected. <br><br>  Ps.  There is one ' <b>but</b> '.  If you select for example the request " <i>CustomerAdd</i> ", then you can see that this request supports the "Contacts" block, which is available from version 12 of qbxml.  But in fact, it is not implemented but only in the implementation process (why it was included in the dock is a mystery, I spent more than one hour of work on this problem, until I accidentally went to the forum where this feature was described).  Therefore, if something does not work in <b>qbxml v.12</b> , then it‚Äôs not a fact that it should :) <br><br>  Pss.  The source code is <a href="https://github.com/mamchyts/quickbooks">here.</a> </div><p>Source: <a href="https://habr.com/ru/post/200728/">https://habr.com/ru/post/200728/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../200708/index.html">November 6 the launch of the spacecraft on the ISS will be broadcast on Times Square in New York</a></li>
<li><a href="../200710/index.html">Wrestlers against ‚Äúpiracy‚Äù RIAA and BPI violated the copyright of the creators of popular jQuery scripts</a></li>
<li><a href="../200718/index.html">Content Extractor from Web Documents</a></li>
<li><a href="../200720/index.html">We write single-page web application framework in 60 lines of code</a></li>
<li><a href="../200726/index.html">Education Passport instead of a higher education diploma. Prototype from MyEducationPath.com</a></li>
<li><a href="../200730/index.html">SDL 2.0 Lesson Cycle: Lesson 2</a></li>
<li><a href="../200734/index.html">Growth Hacking: how to "crack" the problem of growth?</a></li>
<li><a href="../200736/index.html">Compaq LTE Lite</a></li>
<li><a href="../200740/index.html">What is "project efficiency" for IT person</a></li>
<li><a href="../200744/index.html">Caching in Windows Azure</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>