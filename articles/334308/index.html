<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JetBrains MPS for those interested # 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 


 Thank you all for the criticism in the comments under the first post , where I wanted to try to write about MPS, without touching on ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>JetBrains MPS for those interested # 1</h1><div class="post__text post__text-html js-mediator-article"><h2 id="vvedenie">  Introduction </h2><br><p>  Thank you all for the criticism in the comments under the <a href="https://habrahabr.ru/post/334108/">first post</a> , where I wanted to try to write about MPS, without touching on important topics, so that you can then begin to write better in order. </p><br><h2 id="zachem-nam-nuzhen-yazyk-weather">  Why do we need Weather? </h2><br><p>  In the comments to post 1 <a href="https://habrahabr.ru/post/334108/">was the following statement</a> </p><br><blockquote>  From this point of view, DSL is like a framework, only with a more user-friendly interface.  It's clear that no one will do the framework for a single project, except for very monstrous cases.  And to make it under a specific subject area - why not? .. </blockquote><p>  In principle, this is how it all works.  Good languages ‚Äã‚Äãare in fact similar to good frameworks: they allow you to write something important without bothering about what we don‚Äôt want to write.  In the course of the story, I will periodically refer to other languages ‚Äã‚Äãfor analogies and comparisons. </p><br><h2 id="sintaksis">  Syntax </h2><br><p>  The Weather language that we want to implement must fulfill the following task: we must be able to concisely express the conditions (the weather today, for example) and the consequences (the weather tomorrow, the day after tomorrow ...). <br>  In the Weather language, we will make our forecasts based on one factor: temperature today (an array of objects, time + weather conditions). </p><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Sample JS input array</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> weatherInput = [ { <span class="hljs-attr"><span class="hljs-attr">time</span></span>: <span class="hljs-number"><span class="hljs-number">1501179579253</span></span>, <span class="hljs-attr"><span class="hljs-attr">temperature</span></span>: { <span class="hljs-attr"><span class="hljs-attr">unit</span></span>: <span class="hljs-string"><span class="hljs-string">"celsius"</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-number"><span class="hljs-number">23.7</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">time</span></span>: <span class="hljs-number"><span class="hljs-number">1501185944759</span></span>, <span class="hljs-attr"><span class="hljs-attr">temperature</span></span>: { <span class="hljs-attr"><span class="hljs-attr">unit</span></span>: <span class="hljs-string"><span class="hljs-string">"fahrenheit"</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-number"><span class="hljs-number">15.3</span></span> } } ]</code> </pre> </div></div><br><p>  I think come down. </p><br><div class="spoiler">  <b class="spoiler_title">Implementation on Weather</b> <div class="spoiler_text"><pre> <code class="hljs haskell"><span class="hljs-type"><span class="hljs-type">Weather</span></span> prediction rules for <span class="hljs-type"><span class="hljs-type">Saint</span></span> <span class="hljs-type"><span class="hljs-type">Petersburg</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Today</span></span></span><span class="hljs-class">: [21:23]{ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">temperature</span></span></span><span class="hljs-class"> = 23.7 ¬∞</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class"> } [23:06]{ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">temperature</span></span></span><span class="hljs-class"> = 15.3 ¬∞</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">F</span></span></span><span class="hljs-class"> }</span></span></code> </pre> </div></div><br><p>  We have very simple data - time + temperature in units of measurement.  Let's create an abstract concept <em>WeatherTimedData</em> - we need it to store the measurement time and the temperature itself. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/cfe/87c/eb4/cfe87ceb473ae5ab2a396076479f07c7.png" alt="image"></p><br><p>  Now we need to determine what <em>Temperature</em> and <em>Time are</em> . </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b68/24b/6b4/b6824b6b4eef9fac6d45e806c771bd79.png" alt="image"></p><br><p>  <em>Time is</em> implemented very simply - we have time in hours and minutes, and it is displayed as <code>hh : mm</code> . </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/479/9d4/685/4799d4685907ff372ac3d9ee5ef04d16.png" alt="image"></p><br><p>  If everything is clear with <em>Time</em> , there is little with <em>Temperature</em> .  First, value is some kind of <code>_FPNumber_String</code> .  In fact, this is MPS'ovskih double, so do not worry.  But the question is how to make temperature implementations in different units of measure from the <em>Temperature</em> interface, so much so that it is also beautiful?  And in general, what is the interface concept? <br>  Such concepts can not be implemented in the AST.  That is, none at all.  Only if another concept expands it, and nothing else.  This is done, as in the PLO, in order to summarize several classes under one common beginning. </p><br><p>  Here is how I implemented the display in the editor for <em>Temperature</em> : </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d92/ad0/2db/d92ad02db035eafbc38fcde5b67fc623.png" alt="image"></p><br><p>  Here we have the first cell - a double value, a temperature value, and the second is a <em>Read-Only model access</em> .  Here we move away a bit from practice and move on to theory. </p><br><h2 id="teoriya">  Theory </h2><br><p>  In MPS, everything is built on concepts; if we draw a direct parallel with OOP, then concepts are classes.  They can extend other concepts, implement interfaces, but they can also have some kind of logic.  For example, if we describe an abstract temperature class, then we need to provide for the possibility of specifying our own units of measurement. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Temperature</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUnit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">override String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getUnit(); } }</code> </pre> <br><p>  It would be possible to set unit as a variable, and not to write an abstract method, but ... <br>  There is an aspect called <strong>Behavior</strong> .  All he can do is add new methods to the concept.  That is, we cannot add a variable, so we will use an abstract method. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b37/bf0/6fe/b37bf06feea870e0e8b6737bf4cc6026.png" alt="image"></p><br><p>  And after that we can call this method on every implementation of the <em>Temperature</em> concept.  But where is it to call?  How do you code in this MPS? .. </p><br><h2 id="snova-praktika">  Practice again </h2><br><p>  We stopped at the fact that we have an incomprehensible cell in the <strong>Editor</strong> aspect - ReadOnly model access.  It's very simple - if you need to somehow logically handle proeprty / children / reference before showing it, and the built-in jokes are not enough, then we can get the necessary string from the editor context and the concept implementation.  If it is simple - they give us the current object of the concept, that is, a realized one, and we can get from it everything that we have there.  In this case, we want to get a unit of measurement, so we click on the <em>R / O model access</em> cell and write </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/836/eb7/cad/836eb7cadc277aec197ca5f402350493.png" alt="image"></p><br><p>  By the way, anywhere in the code you can poke a little thing that interests you and press <em>Ctrl + Shift + T</em> and get information about the type of this thing.  For example, if we click on <strong>node</strong> in the screenshot above and find out its type, we will get </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b38/741/368/b38741368504b266e533bc5477dd9f55.png" alt="image"></p><br><p>  <code>node&lt; &gt;</code> = some kind of concept implementation <br>  <code>concept&lt; &gt;</code> = concept class <br>  So!  We already know how to compile temperature by value and unit of measurement, but where do we get from, what unit of measurement do we need?  From child implementations, naturally. <br>  Create an empty <em>CelsiusTemperature</em> concept, extend the Temperature, and create a behavior for it. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f9a/83a/21a/f9a83a21a358354a1081ca19051e85f8.png" alt="image"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d9d/7ef/743/d9d7ef743e4f363f0a04d837fabc4838.png" alt="image"></p><br><p>  As seen on the last screenshot, we override the <em>getUnit</em> method (it is in view of the fact that we inherit the concept from <em>Temperature</em> ) and return <code>"¬∞C"</code> .  It's simple! </p><br><p>  It remains only to put everything together in <em>WeatherTimedData</em> : </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c93/9ce/fb0/c939cefb05540e5d7a9b8e36b83a065b.png" alt="image"></p><br><p>  Putting the language and looking at the result: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/e94/7cb/710/e947cb7103ec5d4ed9778ba85ea84839.png" alt="image"></p><br><p>  It seems to be true.  Still, of course, there are no weather predictions themselves, no backlighting, besides, we can have more than 24 hours and less than zero, minutes are also not limited by anything except the integer dimension ... In the next post, wait for explanations on the new aspect - <strong>constraints</strong> and something someday  In the meantime, write feedback in the comments, everything is as usual, if the question is simple, I answer there, if it is extensive and more like a wish, then I will try to write with every post more qualitatively.  Thanks for attention! </p><br><p>  // UPDATE \ <br>  I got a curve repository with a project, where each branch is a new tutorial on Habr√©.  <a href="https://github.com/enchanting4/mps_weather">It's him!!!</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/334308/">https://habr.com/ru/post/334308/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../334298/index.html">Here you are not DevOps: the fate of a sysadmin in a small business</a></li>
<li><a href="../334300/index.html">Artificial stupidity: the art of intentional mistakes</a></li>
<li><a href="../334302/index.html">Translation of excerpts from Robert Heinlein‚Äôs book, Take Your Government Back - part 27</a></li>
<li><a href="../334304/index.html">EmerDNS - an alternative to DNSSEC</a></li>
<li><a href="../334306/index.html">Job search in the Czech Republic on their own experience</a></li>
<li><a href="../334314/index.html">Reduce the size of the application: proven methods</a></li>
<li><a href="../334316/index.html">‚ÄúAlex, please kill me already‚Äù: conversational interfaces</a></li>
<li><a href="../334318/index.html">Happy System Administrator</a></li>
<li><a href="../334320/index.html">The budget for the operation of the data center: instructions for compiling</a></li>
<li><a href="../334322/index.html">Configuring Authentication in Citrix XenDesktop 7.xc Using JaCarta PKI Smart Cards</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>