<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Network Attacks with Kali Linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article we will look at topical attacks on network equipment and tools available in the popular Kali Linux distribution for them. 
 We attack ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Network Attacks with Kali Linux</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/a30/c2d/676/a30c2d676b07070487c16f388a8cb659.png" alt="image"><br><p><br>  In this article we will look at topical attacks on network equipment and tools available in the popular Kali Linux distribution for them. </p><a name="habracut"></a><br><h2>  We attack CISCO router </h2><br><p>  Kali Linux contains several tools that can be used to audit CISCO hardware.  The list can be viewed in the section Vulnerability Analysis - Cisco Tools: </p><br><img src="https://habrastorage.org/files/8f3/24f/967/8f324f9674ef4ac6a0a560989e679006.png"><br><p>  <strong>Cisco Audit Tool or CAT</strong> <br>  Used to brute force the password when the aaa-mode is off, brute-force the SNMP community-strings and check for the IOS History bug vulnerability ( <a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-19981014-ios-hist">https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-19981014-ios- hist</a> ) </p><br><p>  Usage example: </p><br><pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">CAT</span></span> -h <span class="hljs-number"><span class="hljs-number">192.168.1.209</span></span> -w /root/cisco/wordlist/snmpcommunities -a /root/cisco/wordlist/password_list -i</code> </pre> <br><img src="https://habrastorage.org/files/174/0b4/d17/1740b4d172bc4edb8f8c8eab783fd596.png"><br><p>  <strong>Cisco Global Exploiter or CGE</strong> <br>  Used to expose known vulnerabilities.  We have 14 attacks available: </p><br><img src="https://habrastorage.org/files/794/a2d/5f1/794a2d5f1c0b4f1e8e7080bbbc464eb7.png"><br><p>  Usage example: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">cge</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.pl</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.201</span></span> 3</code> </pre> <br><img src="https://habrastorage.org/files/429/4ac/074/4294ac0749854e04abb0a677357c11c8.png"><br><p><br>  <strong>cisco-ocs</strong> <br>  A tool to automate the search for devices with standard password values ‚Äã‚Äãfor telnet and enable mode, which can search for devices in an address range.  Can be used when scanning large networks. </p><br><p>  Usage example: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">cisco-ocs</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.207</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.209</span></span></code> </pre> <br><img src="https://habrastorage.org/files/a02/13d/b00/a0213db009b04cf0ae5f8dd54862adca.png"><br><p><br>  <strong>cisco-torch</strong> <br>  Multi-functional vulnerability scanner for Cisco equipment.  It can scan multiple IP addresses at a time, loading from a text file.  Launch cisco-torch in Kali Linux should be in the working directory / usr / share / cisco-torch. </p><br><p>  Usage example: </p><br><p>  Search for available interfaces and protocols and determine the type of equipment. </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">cisco-torch</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-A</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.201</span></span></code> </pre> <br><img src="https://habrastorage.org/files/107/de9/053/107de905343949da846d69666c29a790.png"><br><p>  Can be used for brute force passwords and SNMP community strings. </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">cisco-torch</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-s</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-b</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.209</span></span></code> </pre> <br><p>  To use your dictionary, you need to put it in / usr / share / cisco-torch instead of password.txt </p><br><img src="https://habrastorage.org/files/4ff/fab/e5f/4fffabe5fed249ae923db4cfb0e943b1.png"><br><p><br>  <strong>copy-router-config.pl and merge-copy-config.pl</strong> <br>  Tools to download the current configuration of the router cisco with a well-known community-line on your tftp-server.  In the future, you can modify the configuration and upload it to the server again. </p><br><p>  Usage example: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">copy-router-config</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.pl</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.201</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.3</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">private</span></span></code> </pre> <br><p>  To automate such an attack, where we are only interested in downloading the configuration to your TFTP server, it is better to use the Metasploit auxiliary / scanner / snmp / cisco_config_tftp module <br>  Or NSE script <a href="https://nmap.org/nsedoc/scripts/snmp-ios-config.html">nmap snmp-ios-config</a> . </p><br><h2>  We attack L2 protocols </h2><br><img src="https://habrastorage.org/files/090/bef/b73/090befb733234bdd86c13ed93af1e00f.png"><br><p>  Yersinia is a multifunctional tool for attacks on L2 (Data Link) protocols of the OSI level. <br>  Able to conduct attacks on DHCP, STP, CDP, DTP, HSRP and others. </p><br><p>  You can work with Yersinia in several modes: </p><br><p>  Run in server mode and control using commands similar to cisco cli. </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">yersinia</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-D</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">telnet</span></span> 127<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span> 12000</code> </pre> <br><p>  Root and root login and password <br>  Password to enter enable mode - tomac </p><br><ol><li>  Run online </li></ol><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">yersinia</span></span> -I</code> </pre> <br><img src="https://habrastorage.org/files/34e/3a9/d93/34e3a9d93f244850bdec19ea9e7010a5.png"><br><p>  Control options are available by pressing the h key: </p><br><img src="https://habrastorage.org/files/59c/db8/ab1/59cdb8ab18c24783a39481a5accb380e.png"><br><ol><li>  GTK GUI </li></ol><br><img src="https://habrastorage.org/files/88d/404/8d8/88d4048d89624e069d156daaef32512d.png"><br><p>  The graphical user interface may be unstable.  In server mode, it does not support certain types of attacks, such as a DHCP Rogue server.  So, the main launch mode can be considered an interactive mode. </p><br><h2>  We attack the DHCP server </h2><br><p>  As an example, we will demonstrate an attack on overflowing the pool of IP addresses of a DHCP server.  This attack can be used to disable the corporate DHCP server and its subsequent replacement with a fake one, the configuration of which is configured in such a way that all the traffic of new clients will pass through the attacker's host.  Thus one of the MitM attacks will be carried out. </p><br><p>  On the attacker's side, you can run the nmap script to find a DHCP server on the local network. </p><br><pre> <code class="hljs pgsql">nmap -n <span class="hljs-comment"><span class="hljs-comment">--script=broadcast-dhcp-discover</span></span></code> </pre> <br><img src="https://habrastorage.org/files/f0a/519/5df/f0a5195dffa34aa6966f13168193ddb6.png"><br><p>  Now start Yersinia in interactive mode and go to DHCP mode by selecting it by pressing the g key. </p><br><img src="https://habrastorage.org/files/429/e2e/430/429e2e4302484cbc97b2b959069f1031.png"><br><p>  Now in this mode all DHCP packets received by Yersinia will be visible. <br>  Check the list of issued addresses of the DHCP server before the attack: </p><br><img src="https://habrastorage.org/files/b3b/331/96e/b3b33196e09f4245999aab5a37063226.png"><br><p>  Yersinia shows DHCP packets caught from the network: </p><br><img src="https://habrastorage.org/files/74b/9a0/f54/74b9a0f5468d4ecb9cf70825e29b7a4b.png"><br><p>  If you select a package and press Shift + L, then you can then use the RAW attack to send the package to the network, or modify it by pressing the e key to switch to the package editing mode. </p><br><p>  When you press the x key, we get a list of available attacks: </p><br><img src="https://habrastorage.org/files/21b/02a/372/21b02a3721724d0e8593c536251885ab.png"><br><p>  Choose 1 </p><br><p>  We see that it starts sending a huge amount of DHCP Discover requests: </p><br><img src="https://habrastorage.org/files/40e/fc2/809/40efc2809db246828488f3fd9bc2fea5.png"><br><p>  After a while, you can stop the attack by pressing the L key and then Enter: </p><br><img src="https://habrastorage.org/files/c2e/9a5/1ab/c2e9a51ab406414289177f461e527f62.png"><br><p>  Nmap no longer shows available DHCP servers on the network.  Corrupt DHCP server disabled. </p><br><img src="https://habrastorage.org/files/976/339/727/97633972754d41c3a12476c29b0c4a51.png"><br><p>  Check the table of issued IP-addresses on the router: </p><br><img src="https://habrastorage.org/files/bbe/859/0fd/bbe8590fd73b4a2e8cd43d8dd6d71ad8.png"><br><p>  You can then launch a Rogue DHCP attack in Yersinia, either using the Metasploit module or in any other way to conduct a MitM attack. </p><br><img src="https://habrastorage.org/files/eef/fe1/f84/eeffe1f848ab4beab498c8bd7d421913.png"><br><p>  The attack on the exhaustion of the pool of IP addresses of a DHCP server can also be carried out using the <a href="https://github.com/kamorin/DHCPig">DHCPig</a> tool.  With Yersinia, you can attack other popular protocols, such as Spanning Tree Protocol (STP) and Hot Standby Router Protocol (HSRP), which also allow you to listen to traffic on the network. </p><br><h2>  Attack on switch CAM table overflow. </h2><br><p>  Another attack that overflows the switch's CAM table, storing a list of MAC addresses running on a specific port.  When it overflows, some switches start working as hubs, sending packets to all ports, thereby creating ideal conditions for conducting MitM class attacks. </p><br><p>  Kali Linux has a macof tool for this attack. </p><br><p>  Usage example: </p><br><pre> <code class="hljs matlab">macof -<span class="hljs-built_in"><span class="hljs-built_in">i</span></span> eth0</code> </pre> <br><p>  Where eth0 is the interface to which the switch is connected to attack. </p><br><h2>  Protection </h2><br><p>  To protect against such attacks by manufacturers, various, usually proprietary technologies are used.  On Cisco switches, you should enable DHCP Snooping and PortSecutiy to avoid attacks on DHCP and CAM Overflow.  To protect against attacks on HSRP and other protocols, other technologies are used.  It must always be remembered that expensive network equipment, after properly configured, can significantly enhance the security of the network infrastructure, while at the same time, under-configured or incorrectly configured can itself become a tool in the hands of the attacker and a security risk.  Detection of network equipment vulnerabilities during <a href="https://www.pentestit.ru/audit/penetration-testing/">penetration testing</a> and application of audit recommendations helps to reduce the risk of hacking an information system by hackers. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/326968/">https://habr.com/ru/post/326968/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326958/index.html">From weekly sysadmin: unpack NetApp FAS 9000</a></li>
<li><a href="../326960/index.html">Duck says ‚Äúquack-krya‚Äù, the cow says ‚Äúmu-mu‚Äù, ‚ÄúRunn Me!‚Äù - another PHP framework * tells us. Part 1</a></li>
<li><a href="../326962/index.html">Reactive applications with the RxPM pattern. Goodbye MVP and MVVM</a></li>
<li><a href="../326964/index.html">Mobile Device Manager Plus - long-awaited perfection or is it still not?</a></li>
<li><a href="../326966/index.html">Hallucinate like Trump, or mini-analysis of Recurrent Neural Networks</a></li>
<li><a href="../326970/index.html">Domestic Linux distribution - ‚ÄúOS‚Äù for server and desktop systems: the new BolgenOS of the national scale?</a></li>
<li><a href="../326972/index.html">How to grow: 7 lessons, which gives the history of WeChat</a></li>
<li><a href="../326974/index.html">SAP Forum 2017: New Scenarios for the Future with the Internet of Things</a></li>
<li><a href="../326976/index.html">What we should build an application: the reasoning of the interface</a></li>
<li><a href="../326978/index.html">Huawei CloudEngine 6800: Overview and Experience</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>