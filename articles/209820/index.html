<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Validating Forms in a Declarative Style (C #)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think many of you have faced the challenge of validating data in forms. It is long, tedious and often requires considerable effort. Sometimes it see...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Validating Forms in a Declarative Style (C #)</h1><div class="post__text post__text-html js-mediator-article">  I think many of you have faced the challenge of validating data in forms.  It is long, tedious and often requires considerable effort.  Sometimes it seems to me that the guys from Redmont mock us, offering to carry out validation <a href="http://msdn.microsoft.com/en-us/library/ms229603(v%3Dvs.110).aspx">so</a> .  Just kidding, of course, but we will not use this method. <br><br>  We will validate the form data automatically, using the rules described in the declarative style.  Take the simplest form: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2d3/6b9/707/2d36b9707cd6455d1a0ef80b75092bc5.png"><br><a name="habracut"></a><br>  There are several regular text fields, a number input field and an e-mail field.  Let's set the following rules for our form: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Fields last name, first name and patronymic must be filled with at least one printed (not whitespace) symbol: <br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">txtSurname</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.ValidateControl</span></span>() <span class="hljs-selector-class"><span class="hljs-selector-class">.IsNotNullOrWhitespace</span></span>(); <span class="hljs-selector-tag"><span class="hljs-selector-tag">txtName</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.ValidateControl</span></span>() <span class="hljs-selector-class"><span class="hljs-selector-class">.IsNotNullOrWhitespace</span></span>(); <span class="hljs-selector-tag"><span class="hljs-selector-tag">txtMiddleName</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.ValidateControl</span></span>() <span class="hljs-selector-class"><span class="hljs-selector-class">.IsNotNullOrWhitespace</span></span>();</code> </pre> <br><br>  Age must be at least 16 years.  If the specified age is less than 21 years, you must display a warning, but allow the form to be saved: <br><pre> <code class="hljs javascript">nmAge .ValidateControl() .IsTrue(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ctl</span></span></span><span class="hljs-function"> =&gt;</span></span> ctl.Value &gt;= <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-string"><span class="hljs-string">"     16 ."</span></span>, ValidationType.Required) .IsTrue(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ctl</span></span></span><span class="hljs-function"> =&gt;</span></span> ctl.Value &gt;= <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-string"><span class="hljs-string">"  (21+)    ."</span></span>, ValidationType.Optional);</code> </pre><br><br>  The e-mail field must be filled with the correct value (or at least similar to the e-mail): <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">txtEMail</span></span> .ValidateControl() .IsValidEMail(<span class="hljs-literal"><span class="hljs-literal">false</span></span>);</code> </pre><br><br>  If all fields are filled in correctly, allow the ‚ÄúSave‚Äù button to be pressed, otherwise not: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">butSave</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.ValidateControl</span></span>() <span class="hljs-selector-class"><span class="hljs-selector-class">.EnableByValidationResult</span></span>();</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Class code form one sheet</b> <div class="spoiler_text"><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">frmMain</span></span> : <span class="hljs-title"><span class="hljs-title">Form</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">frmMain</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { InitializeComponent(); <span class="hljs-comment"><span class="hljs-comment">// ,     txtSurname .ValidateControl() .IsNotNullOrWhitespace(); txtName .ValidateControl() .IsNotNullOrWhitespace(); txtMiddleName .ValidateControl() .IsNotNullOrWhitespace(); //     16  //     (    )  21  nmAge .ValidateControl() .IsTrue(ctl =&gt; ctl.Value &gt;= 16, "     16 .", ValidationType.Required) .IsTrue(ctl =&gt; ctl.Value &gt;= 21, "  (21+)    .", ValidationType.Optional); //      e-mail'    txtEMail .ValidateControl() .IsValidEMail(false); //     /   butSave .ValidateControl() .EnableByValidationResult(); } }</span></span></code> </pre><br></div></div><br><br>  What do we get when we run the form?  First: we will get a convenient highlighting of each field, the value of which is filled with incorrect data.  Secondly: if you move the mouse cursor to the indicator, we will see what the form wants from us: <br><br><img src="https://habrastorage.org/storage3/99a/509/c03/99a509c03449881b46f119fa743caaa1.jpg"><br><br>  Thirdly: the ‚ÄúSave‚Äù button will be available for pressing only after successful data validation. <br><br>  Well, with a simple form, we figured out, but what about the form more complicated?  Let's complicate the task.  Let's make an improvised search form for articles for Habr: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26e/07d/26b/26e07d26b562e11a112ab2b17b1cb888.png"><br><br>  We have three filters, the selection of which should activate the checks for the specified conditions for each filter.  Plus activation controls that belong to the selected filter.  I would like to note that managing the state of controls does not really relate to data validation, but in this case we will not focus on this. <br><br>  Activating the controls will do so: <br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     var categoryCheckBoxes = pnlCategories.Controls.Cast&lt;CheckBox&gt;(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>         dtBegin.EnableByTimer(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> chkFilterByDate.Checked); dtEnd.EnableByTimer(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> chkFilterByDate.Checked); pnlCategories.EnableByTimer(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> chkFilterByCategory.Checked); pnlTextFilter.EnableByTimer(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> chkFilterByText.Checked);</code> </pre><br><br>  Now the validation rules.  If the filter by date is enabled, then the start date must be less than or equal to the final one.  The start date cannot be earlier than 1990.  Validation will occur in both DatePickers, but the display will only be displayed on dtEnd: <br><pre> <code class="hljs javascript">dtEnd .ValidateControl() .IsTrue(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ctl</span></span></span><span class="hljs-function"> =&gt;</span></span> !chkFilterByDate.Checked || dtBegin.Value &gt;= <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(<span class="hljs-number"><span class="hljs-number">1990</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-string"><span class="hljs-string">"       1990 "</span></span>) .IsTrue(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ctl</span></span></span><span class="hljs-function"> =&gt;</span></span> !chkFilterByDate.Checked || dtBegin.Value &lt;= dtEnd.Value, <span class="hljs-string"><span class="hljs-string">"       "</span></span>);</code> </pre><br><br>  If filtering by category is performed, then at least one category must be selected: <br><pre> <code class="hljs javascript">pnlCategories .ValidateControl() .IsTrue(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ctl</span></span></span><span class="hljs-function"> =&gt;</span></span> !chkFilterByCategory.Checked || categoryCheckBoxes.Any(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">c</span></span></span><span class="hljs-function"> =&gt;</span></span> c.Checked), <span class="hljs-string"><span class="hljs-string">"  "</span></span>);</code> </pre><br><br>  If you search for text, you must specify the text and select where to find it: <br><pre> <code class="hljs javascript">pnlTextFilter .ValidateControl() .IsTrue(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ctl</span></span></span><span class="hljs-function"> =&gt;</span></span> !chkFilterByText.Checked || chkSearchTextInBody.Checked || chkSearchTextInHeader.Checked, <span class="hljs-string"><span class="hljs-string">"    "</span></span>) .IsTrue(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ctl</span></span></span><span class="hljs-function"> =&gt;</span></span> !chkFilterByText.Checked || !string.IsNullOrWhiteSpace(txtSearchText.Text), <span class="hljs-string"><span class="hljs-string">"  "</span></span>);</code> </pre><br><br>  Also, for successful validation of the form, at least one of the filters must be specified for the search: <br><pre> <code class="hljs javascript">gbSearchParameters .ValidateControl() .IsTrue(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ctl</span></span></span><span class="hljs-function"> =&gt;</span></span> chkFilterByCategory.Checked || chkFilterByDate.Checked || chkFilterByText.Checked, <span class="hljs-string"><span class="hljs-string">"   ."</span></span>);</code> </pre><br><br>  Well, according to the results of form validation, we activate the main active button: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">butSearch</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.ValidateControl</span></span>() <span class="hljs-selector-class"><span class="hljs-selector-class">.EnableByValidationResult</span></span>();</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Full code of the second form</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.ComponentModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Data; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Drawing; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Forms; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Teleavtomatika.Forms; namespace Teleavtomatika_Form_Validation { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> partial <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> frmMain2 : Form { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> frmMain2() { InitializeComponent(); //     var categoryCheckBoxes = pnlCategories.Controls.<span class="hljs-keyword"><span class="hljs-keyword">Cast</span></span>&lt;CheckBox&gt;(); //         dtBegin.EnableByTimer(() =&gt; chkFilterByDate.Checked); dtEnd.EnableByTimer(() =&gt; chkFilterByDate.Checked); pnlCategories.EnableByTimer(() =&gt; chkFilterByCategory.Checked); pnlTextFilter.EnableByTimer(() =&gt; chkFilterByText.Checked); //   : //     ,          //       <span class="hljs-number"><span class="hljs-number">1990</span></span>  //      DatePicker<span class="hljs-string"><span class="hljs-string">',       dtEnd dtEnd .ValidateControl() .IsTrue(ctl =&gt; !chkFilterByDate.Checked || dtBegin.Value &gt;= new DateTime(1990, 1, 1), "       1990 ") .IsTrue(ctl =&gt; !chkFilterByDate.Checked || dtBegin.Value &lt;= dtEnd.Value, "       "); //      //        pnlCategories .ValidateControl() .IsTrue(ctl =&gt; !chkFilterByCategory.Checked || categoryCheckBoxes.Any(c =&gt; c.Checked), "  "); //     //     //      pnlTextFilter .ValidateControl() .IsTrue(ctl =&gt; !chkFilterByText.Checked || chkSearchTextInBody.Checked || chkSearchTextInHeader.Checked, "    ") .IsTrue(ctl =&gt; !chkFilterByText.Checked || !string.IsNullOrWhiteSpace(txtSearchText.Text), "  "); //    -      gbSearchParameters .ValidateControl() .IsTrue(ctl =&gt; chkFilterByCategory.Checked || chkFilterByDate.Checked || chkFilterByText.Checked, "   ."); //           "": butSearch .ValidateControl() .EnableByValidationResult(); } } }</span></span></code> </pre><br></div></div><br><br>  You can see how it works live on video: <br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Jd-j4IYLJWc%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700253&amp;usg=ALkJrhgZp-pYlv56Tww-3h-ZRzrvtOaocA" frameborder="0" allowfullscreen=""></iframe><br><br>  Sources <a href="https://github.com/teleavtomatika/Teleavtomatika_Form_Validation">here.</a> </div><p>Source: <a href="https://habr.com/ru/post/209820/">https://habr.com/ru/post/209820/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209810/index.html">Stock Market Tools: Derivatives</a></li>
<li><a href="../209812/index.html">Why are there so many Pythons?</a></li>
<li><a href="../209814/index.html">New payment method: Bitcoin and Litecoin</a></li>
<li><a href="../209816/index.html">Day-to-Day Service Plan - Part 2: Automatic Update of Statistics</a></li>
<li><a href="../209818/index.html">FORTH: nano-servers and nanoclients. Part 1</a></li>
<li><a href="../209822/index.html">Testers - a supporting role?</a></li>
<li><a href="../209824/index.html">Test boost :: lockfree on the speed and delay of message transmission</a></li>
<li><a href="../209826/index.html">The implementation of the shingle algorithm on Node.JS. Finding Fuzzy Duplicates for English Texts</a></li>
<li><a href="../209828/index.html">Hekslet: Erlang, logic, operating systems, Java 2</a></li>
<li><a href="../209830/index.html">Recognition of document images using the roulette algorithm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>