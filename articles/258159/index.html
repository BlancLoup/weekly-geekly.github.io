<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Install OpenCV 3.0.0-rc1 (using IPP and TBB) on Intel Edison Yocto. USB camera in OpenCV</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Intel Edison board has enough computing power, so it would be logical to use all of its capabilities. One of the demanding tasks is computer visio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Install OpenCV 3.0.0-rc1 (using IPP and TBB) on Intel Edison Yocto. USB camera in OpenCV</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/comment_images/82c/152/90f/82c15290f080bb21d0eb707ff8de7ae4.png" align="left">  The Intel Edison board has enough computing power, so it would be logical to use all of its capabilities.  One of the demanding tasks is computer vision. <br>  In this article we describe how to build and install the OpenCV library on the Intel Edison board and connect a USB camera.  We will build OpenCV with <abbr title="Intel Integrated Performance Primitives">IPP</abbr> and <abbr title="Intel Threading Building Blocks">TBB</abbr> enabled, which will allow the library to fully utilize both Intel Edison cores. <br><a name="habracut"></a><br><h2>  <font color="#0071c5">Note from the translator</font> </h2><br>  The original article describes how to work with the previous version of the image Yocto Intel Edison.  A new version of the image is now available (edison-image-ww05-15.zip), which is much easier to work with, since most of the necessary packages are already installed.  The new image already has cmake, UVC and sections have the correct size, so you can skip the description of these steps.  Additionally, the source code of two simple examples for working with OpenCV and with a USB camera in OpenCV has been added to the translation. <br><br>  Build OpenCV on Intel Edison will require at least 2 GB of additional memory, so you will need to install a microSD card of the required amount in the slot on the board. <br><br><h1>  <font color="#0071c5">Image preparation (old image)</font> </h1><br>  Prepare a standard (or special with optional packages) Edison image using the <a href="https://communities.intel.com/docs/DOC-23159">Board Support Package</a> and <a href="https://software.intel.com/en-us/articles/startup-guide-for-linux-intel-edison-users">Startup Guide</a> .  You can use the original image or customize your own with additional packages. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  <font color="#0071c5">Enable UVC (USB Video device Class) in Linux kernel (old image)</font> </h2><br>  If you want to use a regular USB camera, then you need to enable UVC in the Linux kernel.  If you have finished building your own image (made a 'bitbake edison-image'), now you are ready to configure the Linux kernel.  Enter on the host machine: <br><br><pre><code class="bash hljs">~/edison-src&gt; bitbake virtual/kernel -c menuconfig</code> </pre> <br>  Then find and activate Device Drivers -&gt; Multimedia support -&gt; Media USB Adapters.  When the configuration is complete, replace the defconfig with the contents of the .config that you just changed.  Enter: <br><br><pre> <code class="bash hljs">~/edison-src&gt; cp /build/tmp/work/edison-poky-linux/linuxyocto/3.10.17+gitAUTOINC+6ad20f049a_c03195ed6e-r0/linux-edison-standardbuild/.config build/tmp/work/edison-poky-linux/linuxyocto/3.10.17+gitAUTOINC+6ad20f049a_c03195ed6er0/defconfig</code> </pre> <br>  Finally, execute bitbake again: <br><br><pre> <code class="bash hljs">~/edison-src&gt; bitbake virtual/kernel -c configure -f ‚Äìv ~/edison-src&gt; bitbake edison-image</code> </pre> <br><h2>  <font color="#0071c5">Change sections (old image)</font> </h2><br>  If you have an old image, we recommend changing the standard partitioning, because the size of the root file system is only 512 MB, most of which will be occupied right away.  '/ home' - takes up all that remains after joining the specified sections, and usually it is more than 2 GB.  Therefore, the creation of both sections of 1.3 GB will be more reasonable. <br><br>  Look in the file 'edison-src / device-software / meta-edison-distro / recipes-bsp / u-boot / files / edison.env' (for a new source release this is the file 'edison-src / device-software / meta- edison / recipes-bsp / u-boot / files / edison.env ') change the size of Rootfs from 512 MB to 1312 MB.  As a result, the size of / home will be reduced automatically.  Another change will need to be made before re-recording the image.  This is the size of the rootfs, which is installed in 'edison-src / device-software / meta-edison-distro / recipes-core / images / edison-image.bb' and is also equal to 512 MB.  Resize the rootfs again and rebuild the image by executing 'bitbake edison-image'.  When the bitbake finishes, run: <br><br><pre> <code class="bash hljs">~/edison-src&gt; /device-software/utils/flash/postBuild.sh</code> </pre> <br>  Check if you have 'dfu-util'.  If not, install: <br><br><pre> <code class="bash hljs">~/edison-src&gt; sudo apt-get install dfu-util</code> </pre> <br>  Now we need to write the image twice to apply the settings section.  First, do: <br><br><pre> <code class="bash hljs">~/edison-src&gt; /build/toFlash/flashall.sh ‚Äìrecovery</code> </pre> <br>  And then write without '--recovery' <br><br><pre> <code class="bash hljs">~/edison-src&gt; /build/toFlash/flashall.sh</code> </pre> <br>  After successfully launching Edison, connect the USB cable to the serial port.  Check what USB device number your Edison received when connecting to a Linux computer.  Then connect via 'screen' (enter the appropriate number instead of 'X', for example, ttyUSBX -&gt; ttyUSB0) <br><br><pre> <code class="bash hljs">&gt; sudo screen /dev/ttyUSBX 115200</code> </pre> <br>  If you see that Edison has successfully booted, log in as 'root' and check the available space by running: <br><br><pre> <code class="bash hljs">root@edison:~<span class="hljs-comment"><span class="hljs-comment"># df ‚Äìh</span></span></code> </pre> <br><h1>  <font color="#0071c5">Configure WiFi, password for ssh and FTP</font> </h1><br>  After your host computer connects to Edison via the serial port, run: <br><br><pre> <code class="bash hljs">root@edison:~<span class="hljs-comment"><span class="hljs-comment"># configure_edison ‚Äìsetup</span></span></code> </pre> <br>  Follow the instructions and set up passwords and WiFi.  If you do not have a password, then ssh access will be denied.  Connect the host computer and Edison to the same access point.  To transfer files, you can use any type of FTP or SCP connection. <br><br>  Make sure that the Edison board has access to the Internet, as it will be needed during an automatic IPP installation. <br><br><h1>  <font color="#0071c5">Install CMake (old image)</font> </h1><br>  The old image of Edison does not come with 'cmake', but we will need it to build OpenCV.  We'll have to manually install it.  One way to use 'opkg'.  User AlexT from the Intel forum created the repository described <a href="https://communities.intel.com/message/254806">in the thread</a> . <br><br>  AlexT tells how to attach the repository via 'opkg'.  In order for Edison to receive packages from the repository, replace everything you have in /etc/opkg/base-feeds.conf with the following (you don‚Äôt need to change other opkg configuration files): <br><br><pre> <code class="bash hljs">===/etc/opkg/base-feeds.conf contents below=== src/gz all http://repo.opkg.net/edison/repo/all src/gz edison http://repo.opkg.net/edison/repo/edison src/gz core2-32 http://repo.opkg.net/edison/repo/core2-32 ===end of /etc/opkg/base-feeds.conf contents===</code> </pre> <br>  Enter 'opkg update'.  You should see the following lines indicating that you have successfully connected to the repository: <br><br><pre> <code class="bash hljs">root@edison:~<span class="hljs-comment"><span class="hljs-comment"># opkg update Downloading http://repo.opkg.net/edison/repo/all/Packages.gz. Inflating http://repo.opkg.net/edison/repo/all/Packages.gz. Updated list of available packages in /var/lib/opkg/all. Downloading http://repo.opkg.net/edison/repo/edison/Packages.gz. Inflating http://repo.opkg.net/edison/repo/edison/Packages.gz. Updated list of available packages in /var/lib/opkg/edison. Downloading http://repo.opkg.net/edison/repo/core2-32/Packages.gz. Inflating http://repo.opkg.net/edison/repo/core2-32/Packages.gz. Updated list of available packages in /var/lib/opkg/core2-32.</span></span></code> </pre> <br>  Now you are ready to install CMake.  Enter: <br><br><pre> <code class="bash hljs">root@edison:~<span class="hljs-comment"><span class="hljs-comment"># opkg install cmake-dev</span></span></code> </pre> <br>  Enter 'cmake' and you should see the help page. <br><br><h1>  <font color="#0071c5">OpenCV 3.0.0</font> </h1><br>  Before we go to the very OpenCV, we need a lot of free space to build it on Edison.  Therefore, we need additional external memory, at least 2 GB.  We will format the micro SD card and mount it to Edison.  The card can be formatted either directly on the board or on a Linux host machine.  To format a card on a Linux computer, type (block_device replace with your device, for example, / dev / mmcblk1) <br><br><pre> <code class="bash hljs">&gt; mkfs.ext4 block_device</code> </pre> <br>  Or: <br><br><pre> <code class="bash hljs">&gt; mke4fs -t ext4 block_device</code> </pre> <br>  Mark the section: <br><br><pre> <code class="bash hljs">&gt; e4label &lt;block_device&gt; new_label</code> </pre> <br>  Insert the SD card into Edison and mount it: <br><br><pre> <code class="bash hljs">root@edison:~<span class="hljs-comment"><span class="hljs-comment"># mkdir &lt;Desired_DIR&gt; root@edison:~# mount block_device &lt;Desired_DIR&gt;</span></span></code> </pre> <br>  Check that it was mounted without problems using 'df -h'.  For convenience, you can configure auto mount 'auto mount'.  Add / dev / block_device &lt;your folder&gt; 'in / etc / fstab. <br><br><pre> <code class="bash hljs">root@edison:~<span class="hljs-comment"><span class="hljs-comment"># vi /etc/fstab</span></span></code> </pre> <br>  And add '/ dev / mmcblk1 / home / ext' <br><br><img src="https://habrastorage.org/files/9c0/b12/dca/9c0b12dca7a74cbf97567b7f2d42164c.JPG"><br><br>  Download OpenCV for Linux 3.0 from the <a href="http://opencv.org/">official OpenCV page</a> .  Copy the resulting zip file to Edison via FTP or SCP.  It is better to immediately copy to an external SD card, since when OpenCV is built, it will take more than 1 GB.  Unzip the downloaded file with the 'unzip opencv-3.0.0-rc1.zip' command and check that the opencv-3.0.0-rc1 folder has been created.  Navigate to the &lt;OpenCV_DIR&gt; folder, enter 'cmake.'  and see what options there are. <br><br>  We will enable IPP and TBB for better performance.  The IPP library will be loaded automatically when the WITH_IPP flag is enabled.  This cannot be said about the TBB library.  It will need to be installed manually.  Therefore, install the TBB package on your host computer and copy the corresponding files to Edison.  If your host computer is Linux 64-bit, you need to specify i386 when you download via apt-get.  On your host computer, type: <br><br><pre> <code class="bash hljs">&gt; sudo apt-get install libtbb-dev:i386</code> </pre> <br>  And copy the files to the / usr / include / tbb folder on Edison with the same name.  You also need to copy the following files to Edison: <br><br><pre> <code class="bash hljs">/usr/lib/libtbb.so, /usr/lib/libtbbmalloc.so, /usr/lib/libtbbmalloc_proxy.so /usr/lib/pkgconfig/tbb.pc</code> </pre> <br>  On <a href="http://packages.ubuntu.com/trusty/i386/libtbb-dev/filelist">this page</a> , you can see a complete list of tbb library files. <br>  Now on Edison in &lt;OpenCV_DIR&gt; type (without forgetting the '.' Dot at the end of the command line) <br><br><pre> <code class="bash hljs">root@edison:&lt;OpenCV DIR&gt;<span class="hljs-comment"><span class="hljs-comment"># cmake -D WITH_IPP=ON -D WITH_TBB=ON -D WITH_CUDA=OFF -D WITH_OPENCL=OFF -D BUILD_SHARED_LIBS=OFF -D BUILD_PERF_TESTS=OFF -D BUILD_TESTS=OFF .</span></span></code> </pre> <br>  This command turns on IPP and TBB and turns off all unnecessary.  With the option 'BUILD_SHARED_LIBS = OFF' you can create executable programs to run without OpenCV installed.  This can be useful, for example, when distributing applications.  (If you do not need IPP and TBB, use WITH_TBB = OFF and WITH_IPP = OFF).  As a result of the configuration, you should see that IPP and TBB are enabled. <br><br><img src="https://habrastorage.org/files/ead/5b4/1da/ead5b41dadc54985b83a3204ff6d026c.jpg"><br><br>  If there are no problems, enter: <br><br><pre> <code class="bash hljs">root@edison:&lt;OpenCV DIR&gt;<span class="hljs-comment"><span class="hljs-comment"># make -j2</span></span></code> </pre> <br>  Full assembly will take from 30 minutes to one hour.  If you get an error <br><br><pre> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">'undefined reference to symbol '</span></span>v4l2_munmap<span class="hljs-string"><span class="hljs-string">' ... libv4l2.so.0 : error adding symbols: DSO missing from command line'</span></span></code> </pre> <br>  when creating OpenCV or OpenCV examples, then add '-lv4l2' after '-lv4l1' to the corresponding configuration files.  A similar error may appear in more than 50 files, so it would be better to make this replacement with the following command: <br><br><pre> <code class="bash hljs">root@edison:&lt;OpenCV_DIR&gt;<span class="hljs-comment"><span class="hljs-comment"># grep -rl -- -lv4l1 samples/* modules/* | xargs sed -i 's/-lv4l1/-lv4l1 -lv4l2/g'</span></span></code> </pre> <br>  When the build is complete, install what you built: <br><br><pre> <code class="bash hljs">root@edison:&lt;OpenCV_DIR&gt;<span class="hljs-comment"><span class="hljs-comment"># make install</span></span></code> </pre> <br><h1>  <font color="#0071c5">Installing TBB without a Linux computer</font> </h1><br>  You may not have a Linux machine available.  Here is a variant of such an installation TBB. <br>  Download TBB from <a href="http://www.threadingbuildingblocks.org/">www.threadingbuildingblocks.org</a> , this is a tgz archive.  Unpack.  We need two folders that need to be copied to Edison. <br><br><pre> <code class="bash hljs">&lt;DIR&gt;/include/tbb</code> </pre> <br>  All its contents will need to be copied to the Edison board in / usr / include / tbb <br><br><pre> <code class="bash hljs">&lt;DIR&gt;/lib/ia32/gcc4.4/</code> </pre> <br>  And its contents will need to be copied to the Edison board in / usr / lib by setting up the links to the library so-files correctly. <br><br><h1>  <font color="#0071c5">Creating applications using OpenCV 3.0.0-rc1</font> </h1><br>  The easiest way to create a simple OpenCV application is to use the examples that come with the library. <br>  Navigate to the '/ samples' folder and enter: <br><br><pre> <code class="bash hljs">root@edison:&lt;OpenCV DIR&gt;/samples<span class="hljs-comment"><span class="hljs-comment"># cmake .</span></span></code> </pre> <br>  everything will be configured and ready to compile the examples.  Now you can replace one of the sample files in 'samples / cpp' and build it through cmake.  For example, you can replace 'image.cpp' with your own code.  First back up the original file: <br><br><pre> <code class="bash hljs">root@edison:&lt;OpenCV DIR&gt;/samples/cpp<span class="hljs-comment"><span class="hljs-comment"># cp image.cpp image_orig.cpp</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Replace image.cpp with the following code:</b> <div class="spoiler_text"><pre> <code class="hljs kotlin">#include &lt;iostream&gt; #include &lt;opencv2/imgproc/imgproc.hpp&gt; #include &lt;opencv2/highgui/highgui.hpp&gt; using namespace cv; using namespace std; int main( int argc, char** argv ) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> char* imagename = <span class="hljs-string"><span class="hljs-string">"../data/lena.jpg"</span></span>; Mat img = imread(imagename); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(img.empty()) { cout&lt;&lt;<span class="hljs-string"><span class="hljs-string">"Can't load image "</span></span>&lt;&lt;imagename&lt;&lt;endl; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -<span class="hljs-number"><span class="hljs-number">1</span></span>; } cout&lt;&lt;<span class="hljs-string"><span class="hljs-string">"Image read ok"</span></span>&lt;&lt;endl; Mat gray_image; cvtColor( img, gray_image, CV_BGR2GRAY ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ! imwrite( <span class="hljs-string"><span class="hljs-string">"../data/test_gray_Image.jpg"</span></span>, gray_image ) ) { cout&lt;&lt;<span class="hljs-string"><span class="hljs-string">"Can't write image"</span></span>&lt;&lt;endl; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -<span class="hljs-number"><span class="hljs-number">1</span></span>; } cout&lt;&lt;<span class="hljs-string"><span class="hljs-string">"Write image ok"</span></span>&lt;&lt;endl; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br></div></div><br>  In this example, the image is read from the file 'lena.jpg', transferred to the gray scale mode, and written to the file 'test_gray_Image.jpg'.  Let's go up one level and compile an example: <br><br><pre> <code class="bash hljs">root@edison:&lt;OpenCV DIR&gt;/samples/cpp<span class="hljs-comment"><span class="hljs-comment"># cd .. root@edison:&lt;OpenCV DIR&gt;/samples# make example_image</span></span></code> </pre> <br>  If you get an error: <br><br><pre> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">'undefined reference to symbol '</span></span>v4l2_munmap<span class="hljs-string"><span class="hljs-string">' ... libv4l2.so.0 : error adding symbols: DSO missing from command line'</span></span></code> </pre> <br>  while building OpenCV or OpenCV examples, you will need to add '-lv4l2' after '-lv4l1' to the appropriate configuration files.  A similar error may appear in more than 50 files, so it would be better to make this replacement with the following command: <br><br><pre> <code class="bash hljs">root@edison:&lt;OpenCV_DIR&gt;<span class="hljs-comment"><span class="hljs-comment"># grep -rl -- -lv4l1 samples/* modules/* | xargs sed -i 's/-lv4l1/-lv4l1 -lv4l2/g'</span></span></code> </pre> <br>  Run: <br><br><pre> <code class="bash hljs">root@edison:&lt;OpenCV DIR&gt;/samples<span class="hljs-comment"><span class="hljs-comment"># cd cpp root@edison:&lt;OpenCV DIR&gt;/samples/cpp#./cpp-example-image</span></span></code> </pre> <br>  If everything is fine, the screen will appear: <br><br><pre> <code class="bash hljs">Write image ok</code> </pre> <br>  And in the folder: <br><br><pre> <code class="bash hljs">&lt;OPENCV_DIR&gt;/samples/data</code> </pre> <br>  A file should appear: <br><br><pre> <code class="bash hljs">test_gray_Image.jpg</code> </pre> <br>  Copy it to the host computer and see.  And, if you see that someone is looking at us from the picture, or a prince in an old raincoat ... But it's better if it is Lena in black and white, which means that OpenCV is working. <br><br>  And yet, since Edison does not have video output, there will be an error if the code has output to a graphical screen.  For example, it will not be possible to use 'imshow', which creates and displays an image or video. <br><br><h1>  <font color="#0071c5">Look at the world</font> </h1><br>  Check out OpenCV work with the camera.  The easiest way to use a camera that works in Linux and is compatible with UVC. <br>  To connect the camera via USB, switch SW1 on the board must be moved so that it is located on the side of the full-sized USB port where the camera will be connected. <br><br><img src="https://habrastorage.org/files/6f6/92e/403/6f692e4039b94fe394e5e00390ae3c37.jpg"><br><br>  By connecting the camera, you can display information about all USB devices: <br><br><pre> <code class="bash hljs">root@Edison:/<span class="hljs-comment"><span class="hljs-comment"># lsusb Bus 001 Device 002: ID 1a40:0101 Terminus Technology Inc. 4-Port HUB Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub Bus 001 Device 005: ID 1871:0141 Aveo Technology Corp.</span></span></code> </pre> <br>  The last line is our camera.  Check that it can work on UVC: <br><br><pre> <code class="bash hljs">root@Edison:/<span class="hljs-comment"><span class="hljs-comment"># lsusb -d 1871:0141 -v | grep "14 Video" bFunctionClass 14 Video bInterfaceClass 14 Video bInterfaceClass 14 Video bInterfaceClass 14 Video bInterfaceClass 14 Video bInterfaceClass 14 Video bInterfaceClass 14 Video bInterfaceClass 14 Video</span></span></code> </pre> <br>  If such strings are found, then the camera supports UVC and it can be used in OpenCV.  Enter the following code: <br><br><div class="spoiler">  <b class="spoiler_title">Replace image.cpp with the following code:</b> <div class="spoiler_text"><pre> <code class="hljs lua">#include &lt;iostream&gt; #include <span class="hljs-string"><span class="hljs-string">"opencv2/opencv.hpp"</span></span> using namespace cv; using namespace std; int main(int, <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>**) { VideoCapture cap(<span class="hljs-number"><span class="hljs-number">0</span></span>); // <span class="hljs-built_in"><span class="hljs-built_in">open</span></span> the default camera <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!cap.isOpened()) // check <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> we succeeded { cout&lt;&lt;<span class="hljs-string"><span class="hljs-string">"Can't open camera"</span></span>&lt;&lt;endl; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } cout&lt;&lt;<span class="hljs-string"><span class="hljs-string">"Camare init ok"</span></span>&lt;&lt;endl; Mat img,frame; cap &gt;&gt; frame; cvtColor(frame, img, CV_BGR2GRAY); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ! imwrite( <span class="hljs-string"><span class="hljs-string">"../data/test_camera_Image.jpg"</span></span>, img) ) { cout&lt;&lt;<span class="hljs-string"><span class="hljs-string">"Can't write image"</span></span>&lt;&lt;endl; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } cout&lt;&lt;<span class="hljs-string"><span class="hljs-string">"Camera image write OK"</span></span>&lt;&lt;endl; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br></div></div><br>  In this example, the camera is initialized, one image is obtained from it, translated into a black and white version and recorded into a file. <br>  If everything works, you can use the camera in OpenCV. <br><br><h1>  <font color="#0071c5">Additional links:</font> </h1><br>  <a href="">facedetect.zip (13.81 MB)</a> <br>  <a href="">mjpg-streamer-for-Edison.zip (957.36 KB)</a> <br>  <a href="">VTune-Result-Edison.zip (1.07 MB)</a> <br><br><h1>  <font color="#0071c5">Previous publications:</font> </h1><br>  <a href="http://habrahabr.ru/company/intel/blog/258157/">Audio playback on Intel Edison via Bluetooth using the Advanced Audio Distribution Profile (A2DP)</a> <br>  <a href="http://habrahabr.ru/company/intel/blog/249845/">Practice "Intel IoT".</a>  <a href="http://habrahabr.ru/company/intel/blog/249845/">Edison - the mighty "crumb"</a> </div><p>Source: <a href="https://habr.com/ru/post/258159/">https://habr.com/ru/post/258159/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258147/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ160 (May 11 - 17, 2015)</a></li>
<li><a href="../258151/index.html">5 tools to help analyst</a></li>
<li><a href="../258153/index.html">Coverage SQL in Postgres</a></li>
<li><a href="../258155/index.html">Energia Launchpad wireless electronic lock</a></li>
<li><a href="../258157/index.html">Audio playback on Intel Edison via Bluetooth using the Advanced Audio Distribution Profile (A2DP)</a></li>
<li><a href="../258163/index.html">Using the Intel Edison board to change the color of the Orbotix Sphero ball when new tweets appear</a></li>
<li><a href="../258165/index.html">How we do landings</a></li>
<li><a href="../258167/index.html">Own context menu using JavaScript</a></li>
<li><a href="../258169/index.html">NeoQUEST-2015: HeartBleed, Android and a little bit of reverse</a></li>
<li><a href="../258171/index.html">Secrets of the Madrid court. Part 2.5: Answers to readers' questions on the previous part</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>