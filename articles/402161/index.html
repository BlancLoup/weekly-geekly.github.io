<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Software manufacturers massively close the vulnerabilities enjoyed by the CIA</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apple, Google, Microsoft, Samsung and other companies quickly responded to the leak of CIA documents with detailed descriptions of hacking tools and d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Software manufacturers massively close the vulnerabilities enjoyed by the CIA</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/453/880/c9b/453880c9b846558ac846347e65764171.jpg"><br><br>  Apple, Google, Microsoft, Samsung and other companies quickly responded to the <a href="https://geektimes.ru/post/286702/">leak of CIA documents</a> with detailed descriptions of hacking tools and dozens of 0day vulnerabilities in popular programs and devices. <br><br>  One of the first to report last night was the developers of the text editor Notepad ++, which the CIA exploited through the <a href="https://wikileaks.org/ciav7p1/cms/page_26968090.html">substitution of a DLL</a> .  This editor supports syntax highlighting for different programming languages, so even <a href="https://habrahabr.ru/post/220081/">some developers</a> use it. <br><a name="habracut"></a><br>  In the Vault 7 documents there was a mention of replacing DLLs in Notepad ++.  More precisely, one of the developers or testers of the exploit complains about a small problem with the work of the finished exploit.  As mentioned in <a href="https://wikileaks.org/ciav7p1/cms/page_26968090.html">this note</a> , Notepad ++ downloads Scintilla, the ‚Äúcode editing component‚Äù (separate project) from the SciLexer.dll dynamic library adjacent to the executable file.  Only one function is exported from this library called <code>Scintilla_DirectFunction</code> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The expert quotes the open source code of Notepad ++ to determine the prototype of the exported function: <br><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">sptr_t</span></span> __<span class="hljs-function"><span class="hljs-function">stdcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Scintilla_DirectFunction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ScintillaWin * sci, UINT iMessage, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uptr_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> wParam, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">sptr_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lParam)</span></span></span></span></code> </pre> <br>  The programmer or tester admits that he is unable to access this function in any way, although he even installed additional plugins that should directly contact Scintilla.  At the same time, he makes it clear that the current prototype [with the replacement of the SciLexer.dll library] is working fine - and expresses the hope that colleagues will solve this problem too. <br><br>  The developers of Notepad ++ literally the next day after the leak of documents released a new version of <a href="https://notepad-plus-plus.org/download/v7.3.3.html">Notepad ++ 7.3.3</a> , where <a href="https://notepad-plus-plus.org/news/notepad-7.3.3-fix-cia-hacking-issue.html">they solved the problem of</a> replacing the original DLL with the SciLexer.dll library from the CIA, which is collecting data in the background. <br><br>  The problem was solved dramatically.  Now, from version 7.3.3, the editor will check the certificate of the SciLexer.dll library before loading it.  If the certificate is missing or invalid, the library will not be loaded - and Notepad ++ itself will not work. <br><br>  Certificate verification is not an absolute protection.  The developers of the program correctly notice that if an attacker gets access to a computer, then formally he can do anything with system components on it.  This protection simply does not allow the text editor to download a malicious library.  But no one bothers the CIA to replace, for example, not the library, but the entire executable file <code>notepad++.exe</code> , if the CIA controls the computer. <br><br>  The developers compare this protective measure with the installation of a lock on the entrance doors.  It is clear that the lock on the door does not protect against people who really need to get inside, but still it is customary to lock the door every time you leave the house. <br><br><h1>  Other popular programs </h1><br>  The hack for Notepad ++ was part of the Fine Dining operation, in which the CIA released exploits for various popular programs.  In total, the list of Fine Dining lists <a href="https://wikileaks.org/ciav7p1/cms/page_20251107.html">modules for 24 applications</a> .  For most of them, DLL substitution was carried out. <br><br><ul><li>  VLC Player Portable </li><li>  Irfan View </li><li>  Chrome Portable </li><li>  Opera Portable </li><li>  Firefox portable </li><li>  ClamWin Portable </li><li>  Kaspersky TDSS Killer Portable </li><li>  McAfee Stinger Portable </li><li>  Sophos Virus Removal </li><li>  Thunderbird Portable </li><li>  Opera Mail </li><li>  Foxit reader </li><li>  Libre Office Portable </li><li>  Prezi </li><li>  Babel pad </li><li>  Notepad ++ </li><li>  Skype </li><li>  Iperius backup </li><li>  Sandisk secure access </li><li>  U3 Software </li><li>  2048 </li><li>  Lbreakout2 </li><li>  7-Zip Portable </li><li>  Portable Linux CMD Prompt </li></ul><br>  Of course, the CIA has much more advanced exploits.  For example, with the introduction of a rootkit into the kernel of the operating system, infection of the BIOS, etc.  But this example shows that the intelligence officers did not refuse from simpler and less technological methods, such as DLL substitution.  Perhaps these simple exploits were developed by novice trainees or third-party contractors. <br><br>  It is clear that it is impossible to fully protect oneself from surveillance by the government - they have too many resources.  But if we are able to close some kind of vulnerability, we need to do this, despite the general uselessness of the process. <br><br>  One way or another, other software vendors also reported on the measures taken. <br><br>  <b>Apple</b> <a href="http://www.usatoday.com/story/tech/talkingtech/buzz/2017/03/08/apple-says-s-already-fixed-many-wikileaks-security-issues/98895170/">said</a> that many of the vulnerabilities in its devices and software that are mentioned in the documents are no longer relevant, that is, they are not in the latest version of iOS.  Obviously, the rest of the ‚Äúholes‚Äù will be patched in the next releases. <br><br>  <b>Microsoft</b> <a href="http://www.bbc.com/news/technology-39203724">commented</a> : "We are aware of the documents and study them." <br><br>  <b>Samsung</b> , whose CIA hacked into the F8000 series of televisions, <a href="http://www.bbc.com/news/technology-39203724">said</a> : "We are aware of the report and are urgently investigating this issue." <br><br>  The director of information security and privacy at <b>Google</b> <a href="http://mashable.com/2017/03/09/google-cia-wikileaks-hacking-tools/">has expressed confidence</a> that the latest security updates from Chrome and Android should protect users from most of the vulnerabilities mentioned in the documents: "Our analysis continues and we will implement any necessary protection measures." <br><br>  UPD: Julian Assange <a href="http://www.bbc.com/news/technology-39221421">said</a> today that technology companies will have exclusive access to CIA exploits before they are publicly available. </div><p>Source: <a href="https://habr.com/ru/post/402161/">https://habr.com/ru/post/402161/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../402151/index.html">Digital notary on the blockchain: Emercoin DPO Antifake</a></li>
<li><a href="../402153/index.html">"We disassemble" the printed house</a></li>
<li><a href="../402155/index.html">Powerful four-channel dimmer for LEDs</a></li>
<li><a href="../402157/index.html">Chris Kaspersky died. The memory of this hacker is dedicated</a></li>
<li><a href="../402159/index.html">February ranking of the most media scientific developments</a></li>
<li><a href="../402163/index.html">Steve Jobs updated story</a></li>
<li><a href="../402165/index.html">The greatest "Dome" of science from Istra</a></li>
<li><a href="../402167/index.html">12 volt X-flash LED bulbs</a></li>
<li><a href="../402169/index.html">Unexpected meeting. Chapter 8</a></li>
<li><a href="../402171/index.html">NES as a hardware platform for mining bitcoins</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>