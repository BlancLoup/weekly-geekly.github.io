<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kango - framework for creating cross-browser extensions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction  Kango allows you to create extensions for popular browsers using only JavaScript, and the code is the same for all browsers. Currently, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Kango - framework for creating cross-browser extensions</h1><div class="post__text post__text-html js-mediator-article"><h1>  Introduction </h1>  <a href="http://kangoextensions.com/">Kango</a> allows you to create extensions for popular browsers using only JavaScript, and the code is the same for all browsers.  Currently, Chrome, Firefox, Internet Explorer are supported (only the version with Chrome and Firefox support is publicly available), and work is underway on Opera and Safari support.  Below we will discuss how to quickly create a simple cross-browser Gmail Checker. <br><br>  What should be the result: <br><br><img src="https://habrastorage.org/storage/49119aa4/261f16b8/69e58046/570c7699.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><h1>  Preparing the environment for working with Kango </h1>  To get started with Kango, you need to complete a couple of actions: <ol><li>  Install Python version 2.7 ( <a href="http://www.python.org/download/">http://www.python.org/download/</a> ) </li><li>  Download the <a href="">link</a> and unpack the archive with the framework into any folder. </li></ol><br><h1>  Creating a new project </h1>  Create a folder for the project on the disk and launch it from the kango.py framework folder. <br><pre><code class="bash hljs">d:\dev\kango\kango.py create</code> </pre>  At the request of the project name, enter Gmail Checker. <br>  Now you can proceed to writing the code for your extension. <br>  In the future, the name and version of the extension can be set using the file common \ extension_info.json. <br><br><h1>  Writing Gmail Checker </h1>  The extension will periodically check the number of unread messages on Gmail and display this number on a button in the browser. <br><br>  After creating the project, go to the src \ common folder and see that the original template has already been created for us in the main.js file. <br><br><h1>  Initialization extension </h1><br>  Subscribe to the UI module readiness event.  You need to use it because  Our extension has visual components, namely a button in the browser. <br><pre> <code class="javascript hljs">kango.ui.addEventListener(kango.ui.event.Ready, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyExtension(); });</code> </pre><br><h1>  We get the number of unread letters </h1><br>  The number of unread messages can be obtained via the link <a href="https://mail.google.com/mail/feed/atom">https://mail.google.com/mail/feed/atom</a> in <a href="http://en.wikipedia.org/wiki/Atom_%2528standard%2529">Atom 0.3</a> format (for correct work, the user must be logged in to Gmail in the current browser). <br><br>  For AJAX requests, use the <a href="http://kangoextensions.com/docs/symbols/KangoXHR.html">kango.xhr.send</a> method. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> details = { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'https://mail.google.com/mail/feed/atom'</span></span>, <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">'GET'</span></span>, <span class="hljs-attr"><span class="hljs-attr">async</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">contentType</span></span>: <span class="hljs-string"><span class="hljs-string">'xml'</span></span> }; kango.xhr.send(details, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(data.status == <span class="hljs-number"><span class="hljs-number">200</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doc = data.response; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count = doc.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'fullcount'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>].childNodes[<span class="hljs-number"><span class="hljs-number">0</span></span>].nodeValue; } });</code> </pre><br><h1>  Display the number of messages on the button </h1>  Button properties are controlled using the <a href="http://kangoextensions.com/docs/symbols/kango.ui.html">kango.ui.browserButton</a> object. <br><br><pre> <code class="javascript hljs">_setUnreadCount: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">count</span></span></span><span class="hljs-function">) </span></span>{ kango.ui.browserButton.setTooltipText(<span class="hljs-string"><span class="hljs-string">'Unread count: '</span></span> + count); kango.ui.browserButton.setIcon(<span class="hljs-string"><span class="hljs-string">'icons/icon16.png'</span></span>); kango.ui.browserButton.setBadge((count != <span class="hljs-number"><span class="hljs-number">0</span></span>) ? {<span class="hljs-attr"><span class="hljs-attr">text</span></span>: count} : <span class="hljs-literal"><span class="hljs-literal">null</span></span>); }</code> </pre><br><h1>  Putting it all together </h1>  Add a timer, which will check the number of new messages and error handling with a given frequency, in the end you will get something like this code: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GmailChecker</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; self.refresh(); kango.ui.browserButton.addEventListener(kango.ui.browserButton.event.Command, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ self.refresh(); }); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{self.refresh()}, self._refreshTimeout); } GmailChecker.prototype = { <span class="hljs-attr"><span class="hljs-attr">_refreshTimeout</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">1000</span></span>*<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-comment"><span class="hljs-comment">// 15 minutes _feedUrl: 'https://mail.google.com/mail/feed/atom', _setOffline: function() { kango.ui.browserButton.setTooltipText('Offline'); kango.ui.browserButton.setIcon('icons/icon16_gray.png'); kango.ui.browserButton.setBadge(null); }, _setUnreadCount: function(count) { kango.ui.browserButton.setTooltipText('Unread count: ' + count); kango.ui.browserButton.setIcon('icons/icon16.png'); kango.ui.browserButton.setBadge((count != 0) ? {text: count} : null); }, refresh: function() { var details = { url: this._feedUrl, method: 'GET', async: true, contentType: 'xml' }; var self = this; kango.xhr.send(details, function(data) { if(data.status == 200) { var doc = data.response; var count = doc.getElementsByTagName('fullcount')[0].childNodes[0].nodeValue; self._setUnreadCount(count); } else { // something went wrong self._setOffline(); } }); } }; kango.ui.addEventListener(kango.ui.event.Ready, function() { return new GmailChecker(); });</span></span></code> </pre><br>  A total of 50 lines of code for the extension, which will work under all popular browsers. <br><br><h1>  Icons </h1>  In the common / icons folder, you need to put icons in PNG format under the names of icon16.png, icon32.png, icon48.png, icon128.png 16x16, 32x32, 48x48, 128x128 pixels respectively, as well as the icon16_gray.png icon to display inactive status . <br><br><h1>  Build project </h1>  To build the project, run kango.py with the build argument and the path to the project folder <br><pre> <code class="bash hljs">d:\dev\kango\kango.py build ./</code> </pre><br><blockquote>  To build the Chromov extension, you need Google Chrome installed on Windows or Chromium on Linux. </blockquote><br>  The output should be gmailchecker_0.1.0.xpi and gmailchecker_0.1.0.crx, which are ready-made extension files.  For Chrome, the gmailchecker.pem file will also be generated so that the extension can be updated later. <br><br><h1>  Further prospects </h1>  Most of the API is in the closed beta testing phase and soon a version with the ability to modify the content of the pages (full access to the DOM) and the ability to open HTML pop-up windows by clicking on the button will be available for public access. <br><br><h1>  Links </h1><ul><li>  Full <a href="http://code.google.com/p/kango-examples/source/browse/">source for the</a> Gmail Checker sample </li><li>  <a href="">Freymovrk</a> himself </li><li>  <a href="http://kangoextensions.com/docs/index.html">Framework Documentation</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/120430/">https://habr.com/ru/post/120430/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../120425/index.html">Sberbank ATM interface 4 months later</a></li>
<li><a href="../120426/index.html">From the USA to Russia in a week ... Russian Post can!</a></li>
<li><a href="../120427/index.html">Will they play social games outside of social networks?</a></li>
<li><a href="../120428/index.html">Browser Strategy "Paths of History." Architecture and project evolution</a></li>
<li><a href="../120429/index.html">Creating real-time applications using Server-Sent Events</a></li>
<li><a href="../120432/index.html">Work with KVM virtual machines. Introduction</a></li>
<li><a href="../120433/index.html">New service from PRUFFI: ‚Äúwe sell‚Äù ready start-up teams</a></li>
<li><a href="../120434/index.html">PowerShell: machine vs man</a></li>
<li><a href="../120437/index.html">Himself a PR man. Writers and Speakers</a></li>
<li><a href="../120438/index.html">Developing games using Cocos2d in Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>